const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.es-VlFfCSRe.js","assets/index-KUKmkUtJ.js","assets/index-DeIXMNoV.css"])))=>i.map(i=>d[i]);
var Du=Object.defineProperty;var zc=_t=>{throw TypeError(_t)};var Gu=(_t,e,n)=>e in _t?Du(_t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):_t[e]=n;var qr=(_t,e,n)=>Gu(_t,typeof e!="symbol"?e+"":e,n),Fu=(_t,e,n)=>e.has(_t)||zc("Cannot "+n);var ic=(_t,e,n)=>e.has(_t)?zc("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(_t):e.set(_t,n);var ea=(_t,e,n)=>(Fu(_t,e,"access private method"),n);import{ac as containsExtent,ad as forEachCorner,ae as extendFlatCoordinates,af as intersects$1,ag as intersectsSegment,ah as createEmpty,ai as getTopLeft,aj as createOrUpdate$2,ak as clamp$1,al as ceil,am as floor,an as get$3,ao as METERS_PER_UNIT,ap as getHeight,aq as getWidth,ar as containsCoordinate,as as getCorner,at as modulo,au as buffer,av as equivalent$1,aw as transformExtent,ax as getIntersection,ay as fromUserResolution,az as fromUserExtent,aA as toUserExtent,aB as createOrUpdateFromFlatCoordinates,aC as lerp,aD as squaredSegmentDistance,aE as createOrUpdateEmpty,aF as returnOrUpdate,aG as getTransform,aH as getCenter,aI as closestSquaredDistanceXY,aJ as extend$4,aK as squaredDistance,aL as createOrUpdateFromCoordinate,aM as containsXY,aN as isEmpty$1,aO as offset,aP as equals$1,aQ as wrapAndSliceX,aR as transform$1,aS as getPointResolution,aT as solveLinearSystem,aU as createTransformFromCoordinateTransform,aV as getTopRight,aW as getBottomRight,aX as getBottomLeft,aY as getArea,aZ as boundingExtent,a_ as extendCoordinate,a$ as getForViewAndSize,b0 as round,b1 as scale$3,b2 as rotate$1,b3 as toRadians,b4 as toFixed,b5 as coordinateRelationship,b6 as Relationship,b7 as clone$1,b8 as getTransformFromProjections,b9 as getUserProjection,ba as wrapX$1,bb as wrapX$2,bc as createProjection,bd as fromUserCoordinate,be as add$1,bf as toUserCoordinate,bg as equals$2,bh as disableCoordinateWarning,bi as distance,bj as squaredDistance$1,bk as closestOnSegment,bl as squaredDistanceToSegment,bm as commonjsGlobal,g as getDefaultExportFromCjs$1,bn as getRotatedViewport,bo as applyTransform,bp as Projection$1,bq as warn,br as identityTransform,bs as fromLonLat,bt as addProjection,bu as get$4,bv as addEquivalentProjections,bw as addCoordinateTransforms,bx as getArea$1,by as getDistance,bz as scaleFromCenter,c as useMapStore,a9 as provide,t as onMounted,o as openBlock,h as createElementBlock,r as renderSlot,q as ref$1,x as inject,bA as toLonLat,bB as onBeforeUpdate,S as onUpdated,E as nextTick,bC as __vitePreload,_ as _export_sfc,a as useCssVars,X as useEulerian,bD as reactive,bE as useElementSize,K as createBlock,k as withCtx,i as createBaseVNode,j as createVNode,bF as DsfrSegmentedSet_default,A as isRef,b as unref,l as createTextVNode,bG as DsfrSelect_default,L as DsfrInput_default,$ as DsfrCheckbox_default,D as DsfrButton_default,J as toDisplayString,m as createCommentVNode,a0 as DsfrModal_default,e as computed,F as distExports$1,bH as shallowRef,a1 as useMatchMedia,R as watch,bI as defineStore,C as push$1,u as useServiceStore,Y as useRouter,a7 as useBaseUrl,B as DsfrButtonGroup_default,M as Fragment,s as useDomStore,bJ as useControls,bK as useControlsExtensionPosition,bL as onUnmounted,bM as useUrlParams,P as renderList,bN as toRaw,bO as withAsyncContext}from"./index-KUKmkUtJ.js";function padNumber(_t,e,n){const ei=""+_t;let ti=ei.indexOf(".");return ti=ti===-1?ei.length:ti,ti>e?ei:new Array(1+e-ti).join("0")+ei}function compareVersions(_t,e){const n=(""+_t).split("."),ei=(""+e).split(".");for(let ti=0;ti<Math.max(n.length,ei.length);ti++){const ii=parseInt(n[ti]||"0",10),ri=parseInt(ei[ti]||"0",10);if(ii>ri)return 1;if(ri>ii)return-1}return 0}function clear$1(_t){for(const e in _t)delete _t[e]}function isEmpty(_t){let e;for(e in _t)return!1;return!e}const version$2="1.0.0-beta.7-478",Pkg$1={version:version$2},MapEventType={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},ObjectEventType={PROPERTYCHANGE:"propertychange"},EventType={CHANGE:"change",ERROR:"error",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",TOUCHMOVE:"touchmove",WHEEL:"wheel"};class Disposable{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function binarySearch$1(_t,e,n){let ei,ti;n=n||ascending;let ii=0,ri=_t.length,ni=!1;for(;ii<ri;)ei=ii+(ri-ii>>1),ti=+n(_t[ei],e),ti<0?ii=ei+1:(ri=ei,ni=!ti);return ni?ii:~ii}function ascending(_t,e){return _t>e?1:_t<e?-1:0}function descending(_t,e){return _t<e?1:_t>e?-1:0}function linearFindNearest(_t,e,n){if(_t[0]<=e)return 0;const ei=_t.length;if(e<=_t[ei-1])return ei-1;if(typeof n=="function"){for(let ti=1;ti<ei;++ti){const ii=_t[ti];if(ii===e)return ti;if(ii<e)return n(e,_t[ti-1],ii)>0?ti-1:ti}return ei-1}if(n>0){for(let ti=1;ti<ei;++ti)if(_t[ti]<e)return ti-1;return ei-1}if(n<0){for(let ti=1;ti<ei;++ti)if(_t[ti]<=e)return ti;return ei-1}for(let ti=1;ti<ei;++ti){if(_t[ti]==e)return ti;if(_t[ti]<e)return _t[ti-1]-e<e-_t[ti]?ti-1:ti}return ei-1}function reverseSubArray(_t,e,n){for(;e<n;){const ei=_t[e];_t[e]=_t[n],_t[n]=ei,++e,--n}}function extend$3(_t,e){const n=Array.isArray(e)?e:[e],ei=n.length;for(let ti=0;ti<ei;ti++)_t[_t.length]=n[ti]}function equals(_t,e){const n=_t.length;if(n!==e.length)return!1;for(let ei=0;ei<n;ei++)if(_t[ei]!==e[ei])return!1;return!0}function isSorted(_t,e,n){const ei=e||ascending;return _t.every(function(ti,ii){if(ii===0)return!0;const ri=ei(_t[ii-1],ti);return!(ri>0||ri===0)})}function TRUE(){return!0}function FALSE(){return!1}function VOID(){}function memoizeOne(_t){let e,n,ei;return function(){const ti=Array.prototype.slice.call(arguments);return(!n||this!==ei||!equals(ti,n))&&(ei=this,n=ti,e=_t.apply(this,arguments)),e}}function toPromise(_t){function e(){let n;try{n=_t()}catch(ei){return Promise.reject(ei)}return n instanceof Promise?n:Promise.resolve(n)}return e()}class BaseEvent{constructor(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}class Target extends Disposable{constructor(e){super(),this.eventTarget_=e,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(e,n){if(!e||!n)return;const ei=this.listeners_||(this.listeners_={}),ti=ei[e]||(ei[e]=[]);ti.includes(n)||ti.push(n)}dispatchEvent(e){const n=typeof e=="string",ei=n?e:e.type,ti=this.listeners_&&this.listeners_[ei];if(!ti)return;const ii=n?new BaseEvent(e):e;ii.target||(ii.target=this.eventTarget_||this);const ri=this.dispatching_||(this.dispatching_={}),ni=this.pendingRemovals_||(this.pendingRemovals_={});ei in ri||(ri[ei]=0,ni[ei]=0),++ri[ei];let si;for(let ai=0,oi=ti.length;ai<oi;++ai)if("handleEvent"in ti[ai]?si=ti[ai].handleEvent(ii):si=ti[ai].call(this,ii),si===!1||ii.propagationStopped){si=!1;break}if(--ri[ei]===0){let ai=ni[ei];for(delete ni[ei];ai--;)this.removeEventListener(ei,VOID);delete ri[ei]}return si}disposeInternal(){this.listeners_&&clear$1(this.listeners_)}getListeners(e){return this.listeners_&&this.listeners_[e]||void 0}hasListener(e){return this.listeners_?e?e in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(e,n){if(!this.listeners_)return;const ei=this.listeners_[e];if(!ei)return;const ti=ei.indexOf(n);ti!==-1&&(this.pendingRemovals_&&e in this.pendingRemovals_?(ei[ti]=VOID,++this.pendingRemovals_[e]):(ei.splice(ti,1),ei.length===0&&delete this.listeners_[e]))}}function listen(_t,e,n,ei,ti){if(ti){const ri=n;n=function(ni){return _t.removeEventListener(e,n),ri.call(ei??this,ni)}}else ei&&ei!==_t&&(n=n.bind(ei));const ii={target:_t,type:e,listener:n};return _t.addEventListener(e,n),ii}function listenOnce(_t,e,n,ei){return listen(_t,e,n,ei,!0)}function unlistenByKey(_t){_t&&_t.target&&(_t.target.removeEventListener(_t.type,_t.listener),clear$1(_t))}class Observable extends Target{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(EventType.CHANGE)}getRevision(){return this.revision_}onInternal(e,n){if(Array.isArray(e)){const ei=e.length,ti=new Array(ei);for(let ii=0;ii<ei;++ii)ti[ii]=listen(this,e[ii],n);return ti}return listen(this,e,n)}onceInternal(e,n){let ei;if(Array.isArray(e)){const ti=e.length;ei=new Array(ti);for(let ii=0;ii<ti;++ii)ei[ii]=listenOnce(this,e[ii],n)}else ei=listenOnce(this,e,n);return n.ol_key=ei,ei}unInternal(e,n){const ei=n.ol_key;if(ei)unByKey(ei);else if(Array.isArray(e))for(let ti=0,ii=e.length;ti<ii;++ti)this.removeEventListener(e[ti],n);else this.removeEventListener(e,n)}}Observable.prototype.on;Observable.prototype.once;Observable.prototype.un;function unByKey(_t){if(Array.isArray(_t))for(let e=0,n=_t.length;e<n;++e)unlistenByKey(_t[e]);else unlistenByKey(_t)}function abstract(){throw new Error("Unimplemented abstract method.")}let uidCounter_$1=0;function getUid(_t){return _t.ol_uid||(_t.ol_uid=String(++uidCounter_$1))}class ObjectEvent extends BaseEvent{constructor(e,n,ei){super(e),this.key=n,this.oldValue=ei}}class BaseObject extends Observable{constructor(e){super(),this.on,this.once,this.un,getUid(this),this.values_=null,e!==void 0&&this.setProperties(e)}get(e){let n;return this.values_&&this.values_.hasOwnProperty(e)&&(n=this.values_[e]),n}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(e,n){let ei;ei=`change:${e}`,this.hasListener(ei)&&this.dispatchEvent(new ObjectEvent(ei,e,n)),ei=ObjectEventType.PROPERTYCHANGE,this.hasListener(ei)&&this.dispatchEvent(new ObjectEvent(ei,e,n))}addChangeListener(e,n){this.addEventListener(`change:${e}`,n)}removeChangeListener(e,n){this.removeEventListener(`change:${e}`,n)}set(e,n,ei){const ti=this.values_||(this.values_={});if(ei)ti[e]=n;else{const ii=ti[e];ti[e]=n,ii!==n&&this.notify(e,ii)}}setProperties(e,n){for(const ei in e)this.set(ei,e[ei],n)}applyProperties(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}unset(e,n){if(this.values_&&e in this.values_){const ei=this.values_[e];delete this.values_[e],isEmpty(this.values_)&&(this.values_=null),n||this.notify(e,ei)}}}const CLASS_HIDDEN="ol-hidden",CLASS_SELECTABLE="ol-selectable",CLASS_UNSELECTABLE="ol-unselectable",CLASS_UNSUPPORTED="ol-unsupported",CLASS_CONTROL="ol-control",CLASS_COLLAPSED="ol-collapsed",fontRegEx=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),fontRegExMatchIndex=["style","variant","weight","size","lineHeight","family"],fontWeights$1={normal:400,bold:700},getFontParameters=function(_t){const e=_t.match(fontRegEx);if(!e)return null;const n={lineHeight:"normal",size:"1.2em",style:"normal",weight:"400",variant:"normal"};for(let ei=0,ti=fontRegExMatchIndex.length;ei<ti;++ei){const ii=e[ei+1];ii!==void 0&&(n[fontRegExMatchIndex[ei]]=typeof ii=="string"?ii.trim():ii)}return isNaN(Number(n.weight))&&n.weight in fontWeights$1&&(n.weight=fontWeights$1[n.weight]),n.families=n.family.split(/,\s?/).map(ei=>ei.trim().replace(/^['"]|['"]$/g,"")),n},ua=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",SAFARI=ua.includes("safari")&&!ua.includes("chrom");SAFARI&&(ua.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(ua));const WEBKIT=ua.includes("webkit")&&!ua.includes("edge"),MAC=ua.includes("macintosh"),DEVICE_PIXEL_RATIO=typeof devicePixelRatio<"u"?devicePixelRatio:1,WORKER_OFFSCREEN_CANVAS=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,IMAGE_DECODE=typeof Image<"u"&&Image.prototype.decode,CREATE_IMAGE_BITMAP=typeof createImageBitmap=="function",PASSIVE_EVENT_LISTENERS=(function(){let _t=!1;try{const e=Object.defineProperty({},"passive",{get:function(){_t=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return _t})();function createCanvasContext2D(_t,e,n,ei){let ti;return n&&n.length?ti=n.shift():WORKER_OFFSCREEN_CANVAS?ti=new class extends OffscreenCanvas{constructor(){super(...arguments);qr(this,"style",{})}}(_t??300,e??150):ti=document.createElement("canvas"),_t&&(ti.width=_t),e&&(ti.height=e),ti.getContext("2d",ei)}let sharedCanvasContext;function getSharedCanvasContext2D(){return sharedCanvasContext||(sharedCanvasContext=createCanvasContext2D(1,1)),sharedCanvasContext}function releaseCanvas(_t){const e=_t.canvas;e.width=1,e.height=1,_t.clearRect(0,0,1,1)}function outerWidth(_t){let e=_t.offsetWidth;const n=getComputedStyle(_t);return e+=parseInt(n.marginLeft,10)+parseInt(n.marginRight,10),e}function outerHeight(_t){let e=_t.offsetHeight;const n=getComputedStyle(_t);return e+=parseInt(n.marginTop,10)+parseInt(n.marginBottom,10),e}function replaceNode(_t,e){const n=e.parentNode;n&&n.replaceChild(_t,e)}function removeChildren(_t){for(;_t.lastChild;)_t.lastChild.remove()}function replaceChildren(_t,e){const n=_t.childNodes;for(let ei=0;;++ei){const ti=n[ei],ii=e[ei];if(!ti&&!ii)break;if(ti!==ii){if(!ti){_t.appendChild(ii);continue}if(!ii){_t.removeChild(ti),--ei;continue}_t.insertBefore(ii,ti)}}}function createMockDiv(){return new Proxy({childNodes:[],appendChild:function(e){return this.childNodes.push(e),e},remove:function(){},removeChild:function(e){const n=this.childNodes.indexOf(e);if(n===-1)throw new Error("Node to remove was not found");return this.childNodes.splice(n,1),e},insertBefore:function(e,n){const ei=this.childNodes.indexOf(n);if(ei===-1)throw new Error("Reference node not found");return this.childNodes.splice(ei,0,e),e},style:{}},{get(e,n,ei){return n==="firstElementChild"?e.childNodes.length>0?e.childNodes[0]:null:Reflect.get(e,n,ei)}})}function isCanvas(_t){return typeof HTMLCanvasElement<"u"&&_t instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&_t instanceof OffscreenCanvas}const Property$4={ELEMENT:"element",MAP:"map",OFFSET:"offset",POSITION:"position",POSITIONING:"positioning"};class Overlay extends BaseObject{constructor(e){super(),this.on,this.once,this.un,this.options=e,this.id=e.id,this.insertFirst=e.insertFirst!==void 0?e.insertFirst:!0,this.stopEvent=e.stopEvent!==void 0?e.stopEvent:!0,this.element=document.createElement("div"),this.element.className=e.className!==void 0?e.className:"ol-overlay-container "+CLASS_SELECTABLE,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.autoPan=e.autoPan===!0?{}:e.autoPan||void 0,this.rendered={transform_:"",visible:!0},this.mapPostrenderListenerKey=null,this.addChangeListener(Property$4.ELEMENT,this.handleElementChanged),this.addChangeListener(Property$4.MAP,this.handleMapChanged),this.addChangeListener(Property$4.OFFSET,this.handleOffsetChanged),this.addChangeListener(Property$4.POSITION,this.handlePositionChanged),this.addChangeListener(Property$4.POSITIONING,this.handlePositioningChanged),e.element!==void 0&&this.setElement(e.element),this.setOffset(e.offset!==void 0?e.offset:[0,0]),this.setPositioning(e.positioning||"top-left"),e.position!==void 0&&this.setPosition(e.position)}getElement(){return this.get(Property$4.ELEMENT)}getId(){return this.id}getMap(){return this.get(Property$4.MAP)||null}getOffset(){return this.get(Property$4.OFFSET)}getPosition(){return this.get(Property$4.POSITION)}getPositioning(){return this.get(Property$4.POSITIONING)}handleElementChanged(){removeChildren(this.element);const e=this.getElement();e&&this.element.appendChild(e)}handleMapChanged(){var n;this.mapPostrenderListenerKey&&((n=this.element)==null||n.remove(),unlistenByKey(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);const e=this.getMap();if(e){this.mapPostrenderListenerKey=listen(e,MapEventType.POSTRENDER,this.render,this),this.updatePixelPosition();const ei=this.stopEvent?e.getOverlayContainerStopEvent():e.getOverlayContainer();this.insertFirst?ei.insertBefore(this.element,ei.childNodes[0]||null):ei.appendChild(this.element),this.performAutoPan()}}render(){this.updatePixelPosition()}handleOffsetChanged(){this.updatePixelPosition()}handlePositionChanged(){this.updatePixelPosition(),this.performAutoPan()}handlePositioningChanged(){this.updatePixelPosition()}setElement(e){this.set(Property$4.ELEMENT,e)}setMap(e){this.set(Property$4.MAP,e)}setOffset(e){this.set(Property$4.OFFSET,e)}setPosition(e){this.set(Property$4.POSITION,e)}performAutoPan(){this.autoPan&&this.panIntoView(this.autoPan)}panIntoView(e){const n=this.getMap();if(!n||!n.getTargetElement()||!this.get(Property$4.POSITION))return;const ei=this.getRect(n.getTargetElement(),n.getSize()),ti=this.getElement(),ii=this.getRect(ti,[outerWidth(ti),outerHeight(ti)]);e=e||{};const ri=e.margin===void 0?20:e.margin;if(!containsExtent(ei,ii)){const ni=ii[0]-ei[0],si=ei[2]-ii[2],ai=ii[1]-ei[1],oi=ei[3]-ii[3],li=[0,0];if(ni<0?li[0]=ni-ri:si<0&&(li[0]=Math.abs(si)+ri),ai<0?li[1]=ai-ri:oi<0&&(li[1]=Math.abs(oi)+ri),li[0]!==0||li[1]!==0){const ci=n.getView().getCenterInternal(),ui=n.getPixelFromCoordinateInternal(ci);if(!ui)return;const di=[ui[0]+li[0],ui[1]+li[1]],fi=e.animation||{};n.getView().animateInternal({center:n.getCoordinateFromPixelInternal(di),duration:fi.duration,easing:fi.easing})}}}getRect(e,n){const ei=e.getBoundingClientRect(),ti=ei.left+window.pageXOffset,ii=ei.top+window.pageYOffset;return[ti,ii,ti+n[0],ii+n[1]]}setPositioning(e){this.set(Property$4.POSITIONING,e)}setVisible(e){this.rendered.visible!==e&&(this.element.style.display=e?"":"none",this.rendered.visible=e)}updatePixelPosition(){const e=this.getMap(),n=this.getPosition();if(!e||!e.isRendered()||!n){this.setVisible(!1);return}const ei=e.getPixelFromCoordinate(n),ti=e.getSize();this.updateRenderedPosition(ei,ti)}updateRenderedPosition(e,n){const ei=this.element.style,ti=this.getOffset(),ii=this.getPositioning();this.setVisible(!0);const ri=`${e[0]+ti[0]}px`,ni=`${e[1]+ti[1]}px`;let si="0%",ai="0%";ii=="bottom-right"||ii=="center-right"||ii=="top-right"?si="-100%":(ii=="bottom-center"||ii=="center-center"||ii=="top-center")&&(si="-50%"),ii=="bottom-left"||ii=="bottom-center"||ii=="bottom-right"?ai="-100%":(ii=="center-left"||ii=="center-center"||ii=="center-right")&&(ai="-50%");const oi=`translate(${si}, ${ai}) translate(${ri}, ${ni})`;this.rendered.transform_!=oi&&(this.rendered.transform_=oi,ei.transform=oi)}getOptions(){return this.options}}const TileState={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function easeIn(_t){return Math.pow(_t,3)}function easeOut(_t){return 1-easeIn(1-_t)}function inAndOut(_t){return 3*_t*_t-2*_t*_t*_t}function linear(_t){return _t}class Tile extends Target{constructor(e,n,ei){super(),ei=ei||{},this.tileCoord=e,this.state=n,this.key="",this.transition_=ei.transition===void 0?250:ei.transition,this.transitionStarts_={},this.interpolate=!!ei.interpolate}changed(){this.dispatchEvent(EventType.CHANGE)}release(){this.setState(TileState.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(e){if(this.state!==TileState.EMPTY){if(this.state!==TileState.ERROR&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()}}load(){abstract()}getAlpha(e,n){if(!this.transition_)return 1;let ei=this.transitionStarts_[e];if(!ei)ei=n,this.transitionStarts_[e]=ei;else if(ei===-1)return 1;const ti=n-ei+1e3/60;return ti>=this.transition_?1:easeIn(ti/this.transition_)}inTransition(e){return this.transition_?this.transitionStarts_[e]!==-1:!1}endTransition(e){this.transition_&&(this.transitionStarts_[e]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}const canvasPool$2=[];class VectorRenderTile extends Tile{constructor(e,n,ei,ti,ii){super(e,n,{transition:0}),this.context_=null,this.executorGroups={},this.loadingSourceTiles=0,this.hitDetectionImageData={},this.replayState_={},this.sourceTiles=[],this.errorTileKeys={},this.wantedResolution,this.getSourceTiles=ti.bind(void 0,this),this.removeSourceTiles_=ii,this.wrappedTileCoord=ei}getContext(){return this.context_||(this.context_=createCanvasContext2D(1,1,canvasPool$2)),this.context_}hasContext(){return!!this.context_}getImage(){return this.hasContext()?this.getContext().canvas:null}getReplayState(e){const n=getUid(e);return n in this.replayState_||(this.replayState_[n]={dirty:!1,renderedRenderOrder:null,renderedResolution:NaN,renderedRevision:-1,renderedTileResolution:NaN,renderedTileRevision:-1,renderedTileZ:-1}),this.replayState_[n]}load(){this.getSourceTiles()}release(){this.context_&&(releaseCanvas(this.context_),canvasPool$2.push(this.context_.canvas),this.context_=null),this.removeSourceTiles_(this),this.sourceTiles.length=0,super.release()}}let VectorTile$1=class extends Tile{constructor(e,n,ei,ti,ii,ri){super(e,n,ri),this.extent=null,this.format_=ti,this.features_=null,this.loader_,this.projection=null,this.resolution,this.tileLoadFunction_=ii,this.url_=ei,this.key=ei}getTileUrl(){return this.url_}getFormat(){return this.format_}getFeatures(){return this.features_}load(){this.state==TileState.IDLE&&(this.setState(TileState.LOADING),this.tileLoadFunction_(this,this.url_),this.loader_&&this.loader_(this.extent,this.resolution,this.projection))}onLoad(e,n){this.setFeatures(e)}onError(){this.setState(TileState.ERROR)}setFeatures(e){this.features_=e,this.setState(TileState.LOADED)}setLoader(e){this.loader_=e}},withCredentials=!1;function loadFeaturesXhr(_t,e,n,ei,ti,ii,ri){const ni=new XMLHttpRequest;ni.open("GET",typeof _t=="function"?_t(n,ei,ti):_t,!0),e.getType()=="arraybuffer"&&(ni.responseType="arraybuffer"),ni.withCredentials=withCredentials,ni.onload=function(si){if(!ni.status||ni.status>=200&&ni.status<300){const ai=e.getType();try{let oi;ai=="text"||ai=="json"?oi=ni.responseText:ai=="xml"?oi=ni.responseXML||ni.responseText:ai=="arraybuffer"&&(oi=ni.response),oi?ii(e.readFeatures(oi,{extent:n,featureProjection:ti}),e.readProjection(oi)):ri()}catch{ri()}}else ri()},ni.onerror=ri,ni.send()}function xhr(_t,e){return function(n,ei,ti,ii,ri){loadFeaturesXhr(_t,e,n,ei,ti,(ni,si)=>{this.addFeatures(ni),ii!==void 0&&ii(ni)},()=>{this.changed(),ri!==void 0&&ri()})}}function hasArea(_t){return _t[0]>0&&_t[1]>0}function scale$2(_t,e,n){return n===void 0&&(n=[0,0]),n[0]=_t[0]*e+.5|0,n[1]=_t[1]*e+.5|0,n}function toSize(_t,e){return Array.isArray(_t)?_t:(e===void 0?e=[_t,_t]:(e[0]=_t,e[1]=_t),e)}class TileRange{constructor(e,n,ei,ti){this.minX=e,this.maxX=n,this.minY=ei,this.maxY=ti}contains(e){return this.containsXY(e[1],e[2])}containsTileRange(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}containsXY(e,n){return this.minX<=e&&e<=this.maxX&&this.minY<=n&&n<=this.maxY}equals(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}extend(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}}function createOrUpdate$1(_t,e,n,ei,ti){return ti!==void 0?(ti.minX=_t,ti.maxX=e,ti.minY=n,ti.maxY=ei,ti):new TileRange(_t,e,n,ei)}function assert(_t,e){if(!_t)throw new Error(e)}function linearRingContainsExtent(_t,e,n,ei,ti){return!forEachCorner(ti,function(ri){return!linearRingContainsXY(_t,e,n,ei,ri[0],ri[1])})}function linearRingContainsXY(_t,e,n,ei,ti,ii){let ri=0,ni=_t[n-ei],si=_t[n-ei+1];for(;e<n;e+=ei){const ai=_t[e],oi=_t[e+1];si<=ii?oi>ii&&(ai-ni)*(ii-si)-(ti-ni)*(oi-si)>0&&ri++:oi<=ii&&(ai-ni)*(ii-si)-(ti-ni)*(oi-si)<0&&ri--,ni=ai,si=oi}return ri!==0}function linearRingsContainsXY(_t,e,n,ei,ti,ii){if(n.length===0||!linearRingContainsXY(_t,e,n[0],ei,ti,ii))return!1;for(let ri=1,ni=n.length;ri<ni;++ri)if(linearRingContainsXY(_t,n[ri-1],n[ri],ei,ti,ii))return!1;return!0}function linearRingssContainsXY(_t,e,n,ei,ti,ii){if(n.length===0)return!1;for(let ri=0,ni=n.length;ri<ni;++ri){const si=n[ri];if(linearRingsContainsXY(_t,e,si,ei,ti,ii))return!0;e=si[si.length-1]}return!1}function forEach(_t,e,n,ei,ti){let ii;for(e+=ei;e<n;e+=ei)if(ii=ti(_t.slice(e-ei,e),_t.slice(e,e+ei)),ii)return ii;return!1}function intersectsLineString(_t,e,n,ei,ti,ii){return ii=ii??extendFlatCoordinates(createEmpty(),_t,e,n,ei),intersects$1(ti,ii)?ii[0]>=ti[0]&&ii[2]<=ti[2]||ii[1]>=ti[1]&&ii[3]<=ti[3]?!0:forEach(_t,e,n,ei,function(ri,ni){return intersectsSegment(ti,ri,ni)}):!1}function intersectsLineStringArray(_t,e,n,ei,ti){for(let ii=0,ri=n.length;ii<ri;++ii){if(intersectsLineString(_t,e,n[ii],ei,ti))return!0;e=n[ii]}return!1}function intersectsLinearRing(_t,e,n,ei,ti){return!!(intersectsLineString(_t,e,n,ei,ti)||linearRingContainsXY(_t,e,n,ei,ti[0],ti[1])||linearRingContainsXY(_t,e,n,ei,ti[0],ti[3])||linearRingContainsXY(_t,e,n,ei,ti[2],ti[1])||linearRingContainsXY(_t,e,n,ei,ti[2],ti[3]))}function intersectsLinearRingArray(_t,e,n,ei,ti){if(!intersectsLinearRing(_t,e,n[0],ei,ti))return!1;if(n.length===1)return!0;for(let ii=1,ri=n.length;ii<ri;++ii)if(linearRingContainsExtent(_t,n[ii-1],n[ii],ei,ti)&&!intersectsLineString(_t,n[ii-1],n[ii],ei,ti))return!1;return!0}function intersectsLinearRingMultiArray(_t,e,n,ei,ti){for(let ii=0,ri=n.length;ii<ri;++ii){const ni=n[ii];if(intersectsLinearRingArray(_t,e,ni,ei,ti))return!0;e=ni[ni.length-1]}return!1}function createOrUpdate(_t,e,n,ei){return ei!==void 0?(ei[0]=_t,ei[1]=e,ei[2]=n,ei):[_t,e,n]}function getKeyZXY(_t,e,n){return _t+"/"+e+"/"+n}function getCacheKey$1(_t,e,n,ei,ti){return`${getUid(_t)},${e},${getKeyZXY(n,ei,ti)}`}function hash(_t){return hashZXY(_t[0],_t[1],_t[2])}function hashZXY(_t,e,n){return(e<<_t)+n}function withinExtentAndZ(_t,e){const n=_t[0],ei=_t[1],ti=_t[2];if(e.getMinZoom()>n||n>e.getMaxZoom())return!1;const ii=e.getFullTileRange(n);return ii?ii.containsXY(ei,ti):!0}const DEFAULT_MAX_ZOOM=42,DEFAULT_TILE_SIZE=256,tmpTileCoord=[0,0,0],DECIMALS$1=5;class TileGrid{constructor(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,assert(isSorted(this.resolutions_,(ti,ii)=>ii-ti),"`resolutions` must be sorted in descending order");let n;if(!e.origins){for(let ti=0,ii=this.resolutions_.length-1;ti<ii;++ti)if(!n)n=this.resolutions_[ti]/this.resolutions_[ti+1];else if(this.resolutions_[ti]/this.resolutions_[ti+1]!==n){n=void 0;break}}this.zoomFactor_=n,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,assert(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const ei=e.extent;ei!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=getTopLeft(ei)),assert(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,assert(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:DEFAULT_TILE_SIZE,assert(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=ei!==void 0?ei:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map((ti,ii)=>{const ri=new TileRange(Math.min(0,ti[0]),Math.max(ti[0]-1,-1),Math.min(0,ti[1]),Math.max(ti[1]-1,-1));if(ei){const ni=this.getTileRangeForExtentAndZ(ei,ii);ri.minX=Math.max(ni.minX,ri.minX),ri.maxX=Math.min(ni.maxX,ri.maxX),ri.minY=Math.max(ni.minY,ri.minY),ri.maxY=Math.min(ni.maxY,ri.maxY)}return ri}):ei&&this.calculateTileRanges_(ei)}forEachTileCoord(e,n,ei){const ti=this.getTileRangeForExtentAndZ(e,n);for(let ii=ti.minX,ri=ti.maxX;ii<=ri;++ii)for(let ni=ti.minY,si=ti.maxY;ni<=si;++ni)ei([n,ii,ni])}forEachTileCoordParentTileRange(e,n,ei,ti){let ii,ri,ni,si=null,ai=e[0]-1;for(this.zoomFactor_===2?(ri=e[1],ni=e[2]):si=this.getTileCoordExtent(e,ti);ai>=this.minZoom;){if(ri!==void 0&&ni!==void 0?(ri=Math.floor(ri/2),ni=Math.floor(ni/2),ii=createOrUpdate$1(ri,ri,ni,ni,ei)):ii=this.getTileRangeForExtentAndZ(si,ai,ei),n(ai,ii))return!0;--ai}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,n,ei){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){const ii=e[1]*2,ri=e[2]*2;return createOrUpdate$1(ii,ii+1,ri,ri+1,n)}const ti=this.getTileCoordExtent(e,ei||this.tmpExtent_);return this.getTileRangeForExtentAndZ(ti,e[0]+1,n)}return null}getTileRangeForTileCoordAndZ(e,n,ei){if(n>this.maxZoom||n<this.minZoom)return null;const ti=e[0],ii=e[1],ri=e[2];if(n===ti)return createOrUpdate$1(ii,ri,ii,ri,ei);if(this.zoomFactor_){const si=Math.pow(this.zoomFactor_,n-ti),ai=Math.floor(ii*si),oi=Math.floor(ri*si);if(n<ti)return createOrUpdate$1(ai,ai,oi,oi,ei);const li=Math.floor(si*(ii+1))-1,ci=Math.floor(si*(ri+1))-1;return createOrUpdate$1(ai,li,oi,ci,ei)}const ni=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(ni,n,ei)}getTileRangeForExtentAndZ(e,n,ei){this.getTileCoordForXYAndZ_(e[0],e[3],n,!1,tmpTileCoord);const ti=tmpTileCoord[1],ii=tmpTileCoord[2];this.getTileCoordForXYAndZ_(e[2],e[1],n,!0,tmpTileCoord);const ri=tmpTileCoord[1],ni=tmpTileCoord[2];return createOrUpdate$1(ti,ri,ii,ni,ei)}getTileCoordCenter(e){const n=this.getOrigin(e[0]),ei=this.getResolution(e[0]),ti=toSize(this.getTileSize(e[0]),this.tmpSize_);return[n[0]+(e[1]+.5)*ti[0]*ei,n[1]-(e[2]+.5)*ti[1]*ei]}getTileCoordExtent(e,n){const ei=this.getOrigin(e[0]),ti=this.getResolution(e[0]),ii=toSize(this.getTileSize(e[0]),this.tmpSize_),ri=ei[0]+e[1]*ii[0]*ti,ni=ei[1]-(e[2]+1)*ii[1]*ti,si=ri+ii[0]*ti,ai=ni+ii[1]*ti;return createOrUpdate$2(ri,ni,si,ai,n)}getTileCoordForCoordAndResolution(e,n,ei){return this.getTileCoordForXYAndResolution_(e[0],e[1],n,!1,ei)}getTileCoordForXYAndResolution_(e,n,ei,ti,ii){const ri=this.getZForResolution(ei),ni=ei/this.getResolution(ri),si=this.getOrigin(ri),ai=toSize(this.getTileSize(ri),this.tmpSize_);let oi=ni*(e-si[0])/ei/ai[0],li=ni*(si[1]-n)/ei/ai[1];return ti?(oi=ceil(oi,DECIMALS$1)-1,li=ceil(li,DECIMALS$1)-1):(oi=floor(oi,DECIMALS$1),li=floor(li,DECIMALS$1)),createOrUpdate(ri,oi,li,ii)}getTileCoordForXYAndZ_(e,n,ei,ti,ii){const ri=this.getOrigin(ei),ni=this.getResolution(ei),si=toSize(this.getTileSize(ei),this.tmpSize_);let ai=(e-ri[0])/ni/si[0],oi=(ri[1]-n)/ni/si[1];return ti?(ai=ceil(ai,DECIMALS$1)-1,oi=ceil(oi,DECIMALS$1)-1):(ai=floor(ai,DECIMALS$1),oi=floor(oi,DECIMALS$1)),createOrUpdate(ei,ai,oi,ii)}getTileCoordForCoordAndZ(e,n,ei){return this.getTileCoordForXYAndZ_(e[0],e[1],n,!1,ei)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,n){const ei=linearFindNearest(this.resolutions_,e,n||0);return clamp$1(ei,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,n){return intersectsLinearRing(n,0,n.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){const n=this.resolutions_.length,ei=new Array(n);for(let ti=this.minZoom;ti<n;++ti)ei[ti]=this.getTileRangeForExtentAndZ(e,ti);this.fullTileRanges_=ei}}class WMTSTileGrid extends TileGrid{constructor(e){super({extent:e.extent,origin:e.origin,origins:e.origins,resolutions:e.resolutions,tileSize:e.tileSize,tileSizes:e.tileSizes,sizes:e.sizes}),this.matrixIds_=e.matrixIds}getMatrixId(e){return this.matrixIds_[e]}getMatrixIds(){return this.matrixIds_}}function getForProjection(_t){let e=_t.getDefaultTileGrid();return e||(e=createForProjection(_t),_t.setDefaultTileGrid(e)),e}function wrapX(_t,e,n){const ei=e[0],ti=_t.getTileCoordCenter(e),ii=extentFromProjection(n);if(!containsCoordinate(ii,ti)){const ri=getWidth(ii),ni=Math.ceil((ii[0]-ti[0])/ri);return ti[0]+=ri*ni,_t.getTileCoordForCoordAndZ(ti,ei)}return e}function createForExtent(_t,e,n,ei){ei=ei!==void 0?ei:"top-left";const ti=resolutionsFromExtent(_t,e,n);return new TileGrid({extent:_t,origin:getCorner(_t,ei),resolutions:ti,tileSize:n})}function createXYZ(_t){const e=_t||{},n=e.extent||get$3("EPSG:3857").getExtent(),ei={extent:n,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:resolutionsFromExtent(n,e.maxZoom,e.tileSize,e.maxResolution)};return new TileGrid(ei)}function resolutionsFromExtent(_t,e,n,ei){e=e!==void 0?e:DEFAULT_MAX_ZOOM,n=toSize(n!==void 0?n:DEFAULT_TILE_SIZE);const ti=getHeight(_t),ii=getWidth(_t);ei=ei>0?ei:Math.max(ii/n[0],ti/n[1]);const ri=e+1,ni=new Array(ri);for(let si=0;si<ri;++si)ni[si]=ei/Math.pow(2,si);return ni}function createForProjection(_t,e,n,ei){const ti=extentFromProjection(_t);return createForExtent(ti,e,n,ei)}function extentFromProjection(_t){_t=get$3(_t);let e=_t.getExtent();if(!e){const n=180*METERS_PER_UNIT.degrees/_t.getMetersPerUnit();e=createOrUpdate$2(-n,-n,n,n)}return e}function appendParams(_t,e){const n=[];Object.keys(e).forEach(function(ti){e[ti]!==null&&e[ti]!==void 0&&n.push(ti+"="+encodeURIComponent(e[ti]))});const ei=n.join("&");return _t=_t.replace(/[?&]$/,""),_t+=_t.includes("?")?"&":"?",_t+ei}const zRegEx=/\{z\}/g,xRegEx=/\{x\}/g,yRegEx=/\{y\}/g,dashYRegEx=/\{-y\}/g;function renderXYZTemplate(_t,e,n,ei,ti){return _t.replace(zRegEx,e.toString()).replace(xRegEx,n.toString()).replace(yRegEx,ei.toString()).replace(dashYRegEx,function(){if(ti===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(ti-ei).toString()})}function expandUrl(_t){const e=[];let n=/\{([a-z])-([a-z])\}/.exec(_t);if(n){const ei=n[1].charCodeAt(0),ti=n[2].charCodeAt(0);let ii;for(ii=ei;ii<=ti;++ii)e.push(_t.replace(n[0],String.fromCharCode(ii)));return e}if(n=/\{(\d+)-(\d+)\}/.exec(_t),n){const ei=parseInt(n[2],10);for(let ti=parseInt(n[1],10);ti<=ei;ti++)e.push(_t.replace(n[0],ti.toString()));return e}return e.push(_t),e}function createFromTemplate(_t,e){return(function(n,ei,ti){if(!n)return;let ii;const ri=n[0];if(e){const ni=e.getFullTileRange(ri);ni&&(ii=ni.getHeight()-1)}return renderXYZTemplate(_t,ri,n[1],n[2],ii)})}function createFromTemplates(_t,e){const n=_t.length,ei=new Array(n);for(let ti=0;ti<n;++ti)ei[ti]=createFromTemplate(_t[ti],e);return createFromTileUrlFunctions(ei)}function createFromTileUrlFunctions(_t){return _t.length===1?_t[0]:(function(e,n,ei){if(!e)return;const ti=hash(e),ii=modulo(ti,_t.length);return _t[ii](e,n,ei)})}class Source extends BaseObject{constructor(e){super(),this.projection=get$3(e.projection),this.attributions_=adaptAttributions(e.attributions),this.attributionsCollapsible_=e.attributionsCollapsible??!0,this.loading=!1,this.state_=e.state!==void 0?e.state:"ready",this.wrapX_=e.wrapX!==void 0?e.wrapX:!1,this.interpolate_=!!e.interpolate,this.viewResolver=null,this.viewRejector=null;const n=this;this.viewPromise_=new Promise(function(ei,ti){n.viewResolver=ei,n.viewRejector=ti})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(e){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(e){this.attributions_=adaptAttributions(e),this.changed()}setState(e){this.state_=e,this.changed()}}function adaptAttributions(_t){return _t?typeof _t=="function"?_t:(Array.isArray(_t)||(_t=[_t]),e=>_t):null}class TileSource extends Source{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=e.tilePixelRatio!==void 0?e.tilePixelRatio:1,this.tileGrid=e.tileGrid!==void 0?e.tileGrid:null;const n=[256,256];this.tileGrid&&toSize(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),n),this.tmpSize=[0,0],this.key_=e.key||getUid(this),this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}getGutterForProjection(e){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getResolutions(e){const n=e?this.getTileGridForProjection(e):this.tileGrid;return n?n.getResolutions():null}getTile(e,n,ei,ti,ii,ri){return abstract()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:getForProjection(e)}getTilePixelRatio(e){return this.tilePixelRatio_}getTilePixelSize(e,n,ei){const ti=this.getTileGridForProjection(ei),ii=this.getTilePixelRatio(n),ri=toSize(ti.getTileSize(e),this.tmpSize);return ii==1?ri:scale$2(ri,ii,this.tmpSize)}getTileCoordForTileUrlFunction(e,n){const ei=n!==void 0?n:this.getProjection(),ti=n!==void 0?this.getTileGridForProjection(ei):this.tileGrid||this.getTileGridForProjection(ei);return this.getWrapX()&&ei.isGlobal()&&(e=wrapX(ti,e,ei)),withinExtentAndZ(e,ti)?e:null}clear(){}refresh(){this.clear(),super.refresh()}}class TileSourceEvent extends BaseEvent{constructor(e,n){super(e),this.tile=n}}const TileEventType={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class UrlTile extends TileSource{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===UrlTile.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){const n=e.target,ei=getUid(n),ti=n.getState();let ii;ti==TileState.LOADING?(this.tileLoadingKeys_[ei]=!0,ii=TileEventType.TILELOADSTART):ei in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[ei],ii=ti==TileState.ERROR?TileEventType.TILELOADERROR:ti==TileState.LOADED?TileEventType.TILELOADEND:void 0),ii!=null&&this.dispatchEvent(new TileSourceEvent(ii,n))}setTileLoadFunction(e){this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,n){this.tileUrlFunction=e,typeof n<"u"?this.setKey(n):this.changed()}setUrl(e){const n=expandUrl(e);this.urls=n,this.setUrls(n)}setUrls(e){this.urls=e;const n=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(createFromTemplates(e,this.tileGrid),n):this.setKey(n)}tileUrlFunction(e,n,ei){}}class VectorTile extends UrlTile{constructor(e){const n=e.projection||"EPSG:3857",ei=e.extent||extentFromProjection(n),ti=e.tileGrid||createXYZ({extent:ei,maxResolution:e.maxResolution,maxZoom:e.maxZoom!==void 0?e.maxZoom:22,minZoom:e.minZoom,tileSize:e.tileSize||512});super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,interpolate:!0,projection:n,state:e.state,tileGrid:ti,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:defaultLoadFunction,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX===void 0?!0:e.wrapX,transition:e.transition,zDirection:e.zDirection===void 0?1:e.zDirection}),this.format_=e.format?e.format:null,this.tileKeysBySourceTileUrl_={},this.sourceTiles_={},this.overlaps_=e.overlaps==null?!0:e.overlaps,this.tileClass=e.tileClass?e.tileClass:VectorTile$1,this.tileGrids_={}}getOverlaps(){return this.overlaps_}getSourceTiles(e,n,ei){if(ei.getState()===TileState.IDLE){ei.setState(TileState.LOADING);const ti=ei.wrappedTileCoord,ii=this.getTileGridForProjection(n);let ri=ii.getTileCoordExtent(ti);const ni=ti[0],si=ii.getResolution(ni);buffer(ri,-si,ri);const ai=this.projection;n&&this.projection&&!equivalent$1(n,ai)&&(ri=transformExtent(ri,n,ai));const oi=this.tileGrid,li=oi.getExtent();li&&getIntersection(ri,li,ri);let ci=si;n&&ai&&!equivalent$1(n,ai)&&(ci=si/ai.getMetersPerUnit()/n.getMetersPerUnit());const ui=oi.getZForResolution(ci,this.zDirection);oi.forEachTileCoord(ri,ui,di=>{const fi=this.tileUrlFunction(di,e,n);this.sourceTiles_[fi]||(this.sourceTiles_[fi]=new this.tileClass(di,fi?TileState.IDLE:TileState.EMPTY,fi,this.format_,this.tileLoadFunction));const hi=this.sourceTiles_[fi];ei.sourceTiles.push(hi),this.tileKeysBySourceTileUrl_[fi]||(this.tileKeysBySourceTileUrl_[fi]=[]),this.tileKeysBySourceTileUrl_[fi].push(ei.getKey());const pi=hi.getState();if(pi<TileState.LOADED){const gi=vi=>{this.handleTileChange(vi);const yi=hi.getState();if(yi===TileState.LOADED||yi===TileState.ERROR){const _i=hi.getKey();_i in ei.errorTileKeys?hi.getState()===TileState.LOADED&&delete ei.errorTileKeys[_i]:ei.loadingSourceTiles--,yi===TileState.ERROR?ei.errorTileKeys[_i]=!0:hi.removeEventListener(EventType.CHANGE,gi),ei.loadingSourceTiles===0&&ei.setState(isEmpty(ei.errorTileKeys)?TileState.LOADED:TileState.ERROR)}};hi.addEventListener(EventType.CHANGE,gi),ei.loadingSourceTiles++}pi===TileState.IDLE&&(hi.extent=oi.getTileCoordExtent(di),hi.projection=this.projection,hi.resolution=oi.getResolution(di[0]),hi.load())}),ei.loadingSourceTiles||ei.setState(ei.sourceTiles.some(di=>di.getState()===TileState.ERROR)?TileState.ERROR:TileState.LOADED)}return ei.sourceTiles}removeSourceTiles(e){const n=e.getKey(),ei=e.sourceTiles;for(let ti=0,ii=ei.length;ti<ii;++ti){const ri=ei[ti].getTileUrl();if(!this.tileKeysBySourceTileUrl_[ri])return;const ni=this.tileKeysBySourceTileUrl_[ri].indexOf(n);ni!==-1&&(this.tileKeysBySourceTileUrl_[ri].splice(ni,1),this.tileKeysBySourceTileUrl_[ri].length===0&&(delete this.tileKeysBySourceTileUrl_[ri],delete this.sourceTiles_[ri]))}}getTile(e,n,ei,ti,ii){const ri=[e,n,ei];let ni=this.getTileCoordForTileUrlFunction(ri,ii);const si=this.getTileGrid().getExtent(),ai=this.projection,oi=this.getTileGridForProjection(ii);if(ni&&si){const ui=oi.getTileCoordExtent(ni);buffer(ui,-oi.getResolution(e),ui),intersects$1(si,!ii||!ai||equivalent$1(ii,ai)?ui:transformExtent(ui,ii,ai))||(ni=null)}let li=!0;if(ni!==null){const ui=this.tileGrid,di=oi.getResolution(e);let fi=di;ii&&ai&&!equivalent$1(ii,ai)&&(fi=di/ai.getMetersPerUnit()/ii.getMetersPerUnit());const hi=ui.getZForResolution(fi,1),pi=oi.getTileCoordExtent(ni);buffer(pi,-di,pi),ui.forEachTileCoord(!ii||!ai||equivalent$1(ii,ai)?pi:transformExtent(pi,ii,ai),hi,gi=>{li=li&&!this.tileUrlFunction(gi,ti,ai)})}const ci=new VectorRenderTile(ri,li?TileState.EMPTY:TileState.IDLE,ni,this.getSourceTiles.bind(this,ti,ii),this.removeSourceTiles.bind(this));return ci.key=this.getKey(),ci}getTileGridForProjection(e){const n=e.getCode();let ei=this.tileGrids_[n];if(!ei){const ti=this.projection;if(ti!==null&&!equivalent$1(ti,e))return getForProjection(e);const ii=this.tileGrid,ri=ii.getResolutions().slice(),ni=ri.map(function(oi,li){return ii.getOrigin(li)}),si=ri.map(function(oi,li){return ii.getTileSize(li)}),ai=DEFAULT_MAX_ZOOM+1;for(let oi=ri.length;oi<ai;++oi)ri.push(ri[oi-1]/2),ni.push(ni[oi-1]),si.push(si[oi-1]);ei=new TileGrid({extent:ii.getExtent(),origins:ni,resolutions:ri,tileSizes:si}),this.tileGrids_[n]=ei}return ei}getTilePixelRatio(e){return e}getTilePixelSize(e,n,ei){const ti=this.getTileGridForProjection(ei),ii=toSize(ti.getTileSize(e),this.tmpSize);return[Math.round(ii[0]*n),Math.round(ii[1]*n)]}setOverlaps(e){this.overlaps_=e,this.changed()}}function defaultLoadFunction(_t,e){_t.setLoader(function(n,ei,ti){loadFeaturesXhr(e,_t.getFormat(),n,ei,ti,_t.onLoad.bind(_t),_t.onError.bind(_t))})}const CollectionEventType={ADD:"add",REMOVE:"remove"},Property$3={LENGTH:"length"};class CollectionEvent extends BaseEvent{constructor(e,n,ei){super(e),this.element=n,this.index=ei}}class Collection extends BaseObject{constructor(e,n){if(super(),this.on,this.once,this.un,n=n||{},this.unique_=!!n.unique,this.array_=e??[],this.unique_)for(let ei=1,ti=this.array_.length;ei<ti;++ei)this.assertUnique_(this.array_[ei],ei);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(e){for(let n=0,ei=e.length;n<ei;++n)this.push(e[n]);return this}forEach(e){const n=this.array_;for(let ei=0,ti=n.length;ei<ti;++ei)e(n[ei],ei,n)}getArray(){return this.array_}item(e){return this.array_[e]}getLength(){return this.get(Property$3.LENGTH)}insertAt(e,n){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(n),this.array_.splice(e,0,n),this.updateLength_(),this.dispatchEvent(new CollectionEvent(CollectionEventType.ADD,n,e))}pop(){return this.removeAt(this.getLength()-1)}push(e){const n=this.getLength();return this.insertAt(n,e),this.getLength()}remove(e){const n=this.array_;for(let ei=0,ti=n.length;ei<ti;++ei)if(n[ei]===e)return this.removeAt(ei)}removeAt(e){if(e<0||e>=this.getLength())return;const n=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new CollectionEvent(CollectionEventType.REMOVE,n,e)),n}setAt(e,n){const ei=this.getLength();if(e>=ei){this.insertAt(e,n);return}if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(n,e);const ti=this.array_[e];this.array_[e]=n,this.dispatchEvent(new CollectionEvent(CollectionEventType.REMOVE,ti,e)),this.dispatchEvent(new CollectionEvent(CollectionEventType.ADD,n,e))}updateLength_(){this.set(Property$3.LENGTH,this.array_.length)}assertUnique_(e,n){const ei=this.array_;for(let ti=0,ii=ei.length;ti<ii;++ti)if(ei[ti]===e&&ti!==n)throw new Error("Duplicate item added to a unique collection")}}function all$1(_t,e){return[[-1/0,-1/0,1/0,1/0]]}function bbox(_t,e){return[_t]}function tile(_t){return(function(e,n,ei){const ti=_t.getZForResolution(fromUserResolution(n)),ii=_t.getTileRangeForExtentAndZ(fromUserExtent(e),ti),ri=[],ni=[ti,0,0];for(ni[1]=ii.minX;ni[1]<=ii.maxX;++ni[1])for(ni[2]=ii.minY;ni[2]<=ii.maxY;++ni[2])ri.push(toUserExtent(_t.getTileCoordExtent(ni)));return ri})}class Feature extends BaseObject{constructor(e){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),e)if(typeof e.getSimplifiedGeometry=="function"){const n=e;this.setGeometry(n)}else{const n=e;this.setProperties(n)}}clone(){const e=new Feature(this.hasProperties()?this.getProperties():null);e.setGeometryName(this.getGeometryName());const n=this.getGeometry();n&&e.setGeometry(n.clone());const ei=this.getStyle();return ei&&e.setStyle(ei),e}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(unlistenByKey(this.geometryChangeKey_),this.geometryChangeKey_=null);const e=this.getGeometry();e&&(this.geometryChangeKey_=listen(e,EventType.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(e){this.set(this.geometryName_,e)}setStyle(e){this.style_=e,this.styleFunction_=e?createStyleFunction(e):void 0,this.changed()}setId(e){this.id_=e,this.changed()}setGeometryName(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}function createStyleFunction(_t){if(typeof _t=="function")return _t;let e;return Array.isArray(_t)?e=_t:(assert(typeof _t.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[_t]),function(){return e}}function linearRingss$1(_t,e,n,ei){const ti=[];let ii=createEmpty();for(let ri=0,ni=n.length;ri<ni;++ri){const si=n[ri];ii=createOrUpdateFromFlatCoordinates(_t,e,si[0],ei),ti.push((ii[0]+ii[2])/2,(ii[1]+ii[3])/2),e=si[si.length-1]}return ti}function getInteriorPointOfArray(_t,e,n,ei,ti,ii,ri){let ni,si,ai,oi,li,ci,ui;const di=ti[ii+1],fi=[];for(let gi=0,vi=n.length;gi<vi;++gi){const yi=n[gi];for(oi=_t[yi-ei],ci=_t[yi-ei+1],ni=e;ni<yi;ni+=ei)li=_t[ni],ui=_t[ni+1],(di<=ci&&ui<=di||ci<=di&&di<=ui)&&(ai=(di-ci)/(ui-ci)*(li-oi)+oi,fi.push(ai)),oi=li,ci=ui}let hi=NaN,pi=-1/0;for(fi.sort(ascending),oi=fi[0],ni=1,si=fi.length;ni<si;++ni){li=fi[ni];const gi=Math.abs(li-oi);gi>pi&&(ai=(oi+li)/2,linearRingsContainsXY(_t,e,n,ei,ai,di)&&(hi=ai,pi=gi)),oi=li}return isNaN(hi)&&(hi=ti[ii]),ri?(ri.push(hi,di,pi),ri):[hi,di,pi]}function getInteriorPointsOfMultiArray(_t,e,n,ei,ti){let ii=[];for(let ri=0,ni=n.length;ri<ni;++ri){const si=n[ri];ii=getInteriorPointOfArray(_t,e,si,ei,ti,2*ri,ii),e=si[si.length-1]}return ii}function interpolatePoint(_t,e,n,ei,ti,ii,ri){let ni,si;const ai=(n-e)/ei;if(ai===1)ni=e;else if(ai===2)ni=e,si=ti;else if(ai!==0){let oi=_t[e],li=_t[e+1],ci=0;const ui=[0];for(let hi=e+ei;hi<n;hi+=ei){const pi=_t[hi],gi=_t[hi+1];ci+=Math.sqrt((pi-oi)*(pi-oi)+(gi-li)*(gi-li)),ui.push(ci),oi=pi,li=gi}const di=ti*ci,fi=binarySearch$1(ui,di);fi<0?(si=(di-ui[-fi-2])/(ui[-fi-1]-ui[-fi-2]),ni=e+(-fi-2)*ei):ni=e+fi*ei}ri=ri>1?ri:2,ii=ii||new Array(ri);for(let oi=0;oi<ri;++oi)ii[oi]=ni===void 0?NaN:si===void 0?_t[ni+oi]:lerp(_t[ni+oi],_t[ni+ei+oi],si);return ii}function lineStringCoordinateAtM(_t,e,n,ei,ti,ii){if(n==e)return null;let ri;if(ti<_t[e+ei-1])return ii?(ri=_t.slice(e,e+ei),ri[ei-1]=ti,ri):null;if(_t[n-1]<ti)return ii?(ri=_t.slice(n-ei,n),ri[ei-1]=ti,ri):null;if(ti==_t[e+ei-1])return _t.slice(e,e+ei);let ni=e/ei,si=n/ei;for(;ni<si;){const ci=ni+si>>1;ti<_t[(ci+1)*ei-1]?si=ci:ni=ci+1}const ai=_t[ni*ei-1];if(ti==ai)return _t.slice((ni-1)*ei,(ni-1)*ei+ei);const oi=_t[(ni+1)*ei-1],li=(ti-ai)/(oi-ai);ri=[];for(let ci=0;ci<ei-1;++ci)ri.push(lerp(_t[(ni-1)*ei+ci],_t[ni*ei+ci],li));return ri.push(ti),ri}function lineStringsCoordinateAtM(_t,e,n,ei,ti,ii,ri){if(ri)return lineStringCoordinateAtM(_t,e,n[n.length-1],ei,ti,ii);let ni;if(ti<_t[ei-1])return ii?(ni=_t.slice(0,ei),ni[ei-1]=ti,ni):null;if(_t[_t.length-1]<ti)return ii?(ni=_t.slice(_t.length-ei),ni[ei-1]=ti,ni):null;for(let si=0,ai=n.length;si<ai;++si){const oi=n[si];if(e!=oi){if(ti<_t[e+ei-1])return null;if(ti<=_t[oi-1])return lineStringCoordinateAtM(_t,e,oi,ei,ti,!1);e=oi}}return null}function coordinates(_t,e,n,ei){for(;e<n-ei;){for(let ti=0;ti<ei;++ti){const ii=_t[e+ti];_t[e+ti]=_t[n-ei+ti],_t[n-ei+ti]=ii}e+=ei,n-=ei}}function linearRingIsClockwise(_t,e,n,ei){let ti=0,ii=_t[n-ei],ri=_t[n-ei+1];for(;e<n;e+=ei){const ni=_t[e],si=_t[e+1];ti+=(ni-ii)*(si+ri),ii=ni,ri=si}return ti===0?void 0:ti>0}function linearRingsAreOriented(_t,e,n,ei,ti){ti=ti!==void 0?ti:!1;for(let ii=0,ri=n.length;ii<ri;++ii){const ni=n[ii],si=linearRingIsClockwise(_t,e,ni,ei);if(ii===0){if(ti&&si||!ti&&!si)return!1}else if(ti&&!si||!ti&&si)return!1;e=ni}return!0}function linearRingssAreOriented(_t,e,n,ei,ti){for(let ii=0,ri=n.length;ii<ri;++ii){const ni=n[ii];if(!linearRingsAreOriented(_t,e,ni,ei,ti))return!1;ni.length&&(e=ni[ni.length-1])}return!0}function orientLinearRings(_t,e,n,ei,ti){ti=ti!==void 0?ti:!1;for(let ii=0,ri=n.length;ii<ri;++ii){const ni=n[ii],si=linearRingIsClockwise(_t,e,ni,ei);(ii===0?ti&&si||!ti&&!si:ti&&!si||!ti&&si)&&coordinates(_t,e,ni,ei),e=ni}return e}function orientLinearRingsArray(_t,e,n,ei,ti){for(let ii=0,ri=n.length;ii<ri;++ii)e=orientLinearRings(_t,e,n[ii],ei,ti);return e}function inflateEnds(_t,e){const n=[];let ei=0,ti=0,ii;for(let ri=0,ni=e.length;ri<ni;++ri){const si=e[ri],ai=linearRingIsClockwise(_t,ei,si,2);if(ii===void 0&&(ii=ai),ai===ii)n.push(e.slice(ti,ri+1));else{if(n.length===0)continue;n[n.length-1].push(e[ti])}ti=ri+1,ei=si}return n}function douglasPeucker(_t,e,n,ei,ti,ii,ri){const ni=(n-e)/ei;if(ni<3){for(;e<n;e+=ei)ii[ri++]=_t[e],ii[ri++]=_t[e+1];return ri}const si=new Array(ni);si[0]=1,si[ni-1]=1;const ai=[e,n-ei];let oi=0;for(;ai.length>0;){const li=ai.pop(),ci=ai.pop();let ui=0;const di=_t[ci],fi=_t[ci+1],hi=_t[li],pi=_t[li+1];for(let gi=ci+ei;gi<li;gi+=ei){const vi=_t[gi],yi=_t[gi+1],_i=squaredSegmentDistance(vi,yi,di,fi,hi,pi);_i>ui&&(oi=gi,ui=_i)}ui>ti&&(si[(oi-e)/ei]=1,ci+ei<oi&&ai.push(ci,oi),oi+ei<li&&ai.push(oi,li))}for(let li=0;li<ni;++li)si[li]&&(ii[ri++]=_t[e+li*ei],ii[ri++]=_t[e+li*ei+1]);return ri}function douglasPeuckerArray(_t,e,n,ei,ti,ii,ri,ni){for(let si=0,ai=n.length;si<ai;++si){const oi=n[si];ri=douglasPeucker(_t,e,oi,ei,ti,ii,ri),ni.push(ri),e=oi}return ri}function snap(_t,e){return e*Math.round(_t/e)}function quantize(_t,e,n,ei,ti,ii,ri){if(e==n)return ri;let ni=snap(_t[e],ti),si=snap(_t[e+1],ti);e+=ei,ii[ri++]=ni,ii[ri++]=si;let ai,oi;do if(ai=snap(_t[e],ti),oi=snap(_t[e+1],ti),e+=ei,e==n)return ii[ri++]=ai,ii[ri++]=oi,ri;while(ai==ni&&oi==si);for(;e<n;){const li=snap(_t[e],ti),ci=snap(_t[e+1],ti);if(e+=ei,li==ai&&ci==oi)continue;const ui=ai-ni,di=oi-si,fi=li-ni,hi=ci-si;if(ui*hi==di*fi&&(ui<0&&fi<ui||ui==fi||ui>0&&fi>ui)&&(di<0&&hi<di||di==hi||di>0&&hi>di)){ai=li,oi=ci;continue}ii[ri++]=ai,ii[ri++]=oi,ni=ai,si=oi,ai=li,oi=ci}return ii[ri++]=ai,ii[ri++]=oi,ri}function quantizeArray(_t,e,n,ei,ti,ii,ri,ni){for(let si=0,ai=n.length;si<ai;++si){const oi=n[si];ri=quantize(_t,e,oi,ei,ti,ii,ri),ni.push(ri),e=oi}return ri}function quantizeMultiArray(_t,e,n,ei,ti,ii,ri,ni){for(let si=0,ai=n.length;si<ai;++si){const oi=n[si],li=[];ri=quantizeArray(_t,e,oi,ei,ti,ii,ri,li),ni.push(li),e=oi[oi.length-1]}return ri}function transform2D(_t,e,n,ei,ti,ii,ri){ii=ii||[],ri=ri||2;let ni=0;for(let si=e;si<n;si+=ei){const ai=_t[si],oi=_t[si+1];ii[ni++]=ti[0]*ai+ti[2]*oi+ti[4],ii[ni++]=ti[1]*ai+ti[3]*oi+ti[5];for(let li=2;li<ri;li++)ii[ni++]=_t[si+li]}return ii&&ii.length!=ni&&(ii.length=ni),ii}function rotate(_t,e,n,ei,ti,ii,ri){ri=ri||[];const ni=Math.cos(ti),si=Math.sin(ti),ai=ii[0],oi=ii[1];let li=0;for(let ci=e;ci<n;ci+=ei){const ui=_t[ci]-ai,di=_t[ci+1]-oi;ri[li++]=ai+ui*ni-di*si,ri[li++]=oi+ui*si+di*ni;for(let fi=ci+2;fi<ci+ei;++fi)ri[li++]=_t[fi]}return ri&&ri.length!=li&&(ri.length=li),ri}function scale$1(_t,e,n,ei,ti,ii,ri,ni){ni=ni||[];const si=ri[0],ai=ri[1];let oi=0;for(let li=e;li<n;li+=ei){const ci=_t[li]-si,ui=_t[li+1]-ai;ni[oi++]=si+ti*ci,ni[oi++]=ai+ii*ui;for(let di=li+2;di<li+ei;++di)ni[oi++]=_t[di]}return ni&&ni.length!=oi&&(ni.length=oi),ni}function translate$1(_t,e,n,ei,ti,ii,ri){ri=ri||[];let ni=0;for(let si=e;si<n;si+=ei){ri[ni++]=_t[si]+ti,ri[ni++]=_t[si+1]+ii;for(let ai=si+2;ai<si+ei;++ai)ri[ni++]=_t[ai]}return ri&&ri.length!=ni&&(ri.length=ni),ri}const tmp_=new Array(6);function create(){return[1,0,0,1,0,0]}function reset(_t){return set(_t,1,0,0,1,0,0)}function multiply(_t,e){const n=_t[0],ei=_t[1],ti=_t[2],ii=_t[3],ri=_t[4],ni=_t[5],si=e[0],ai=e[1],oi=e[2],li=e[3],ci=e[4],ui=e[5];return _t[0]=n*si+ti*ai,_t[1]=ei*si+ii*ai,_t[2]=n*oi+ti*li,_t[3]=ei*oi+ii*li,_t[4]=n*ci+ti*ui+ri,_t[5]=ei*ci+ii*ui+ni,_t}function set(_t,e,n,ei,ti,ii,ri){return _t[0]=e,_t[1]=n,_t[2]=ei,_t[3]=ti,_t[4]=ii,_t[5]=ri,_t}function setFromArray(_t,e){return _t[0]=e[0],_t[1]=e[1],_t[2]=e[2],_t[3]=e[3],_t[4]=e[4],_t[5]=e[5],_t}function apply(_t,e){const n=e[0],ei=e[1];return e[0]=_t[0]*n+_t[2]*ei+_t[4],e[1]=_t[1]*n+_t[3]*ei+_t[5],e}function scale(_t,e,n){return multiply(_t,set(tmp_,e,0,0,n,0,0))}function translate(_t,e,n){return multiply(_t,set(tmp_,1,0,0,1,e,n))}function compose(_t,e,n,ei,ti,ii,ri,ni){const si=Math.sin(ii),ai=Math.cos(ii);return _t[0]=ei*ai,_t[1]=ti*si,_t[2]=-ei*si,_t[3]=ti*ai,_t[4]=ri*ei*ai-ni*ei*si+e,_t[5]=ri*ti*si+ni*ti*ai+n,_t}function makeInverse(_t,e){const n=determinant(e);assert(n!==0,"Transformation matrix cannot be inverted");const ei=e[0],ti=e[1],ii=e[2],ri=e[3],ni=e[4],si=e[5];return _t[0]=ri/n,_t[1]=-ti/n,_t[2]=-ii/n,_t[3]=ei/n,_t[4]=(ii*si-ri*ni)/n,_t[5]=-(ei*si-ti*ni)/n,_t}function determinant(_t){return _t[0]*_t[3]-_t[1]*_t[2]}const matrixPrecision=[1e5,1e5,1e5,1e5,2,2];function toString$2(_t){return"matrix("+_t.join(", ")+")"}function fromString$1(_t){return _t.substring(7,_t.length-1).split(",").map(parseFloat)}function equivalent(_t,e){const n=fromString$1(_t),ei=fromString$1(e);for(let ti=0;ti<6;++ti)if(Math.round((n[ti]-ei[ti])*matrixPrecision[ti])!==0)return!1;return!0}const tmpTransform$1=create(),tmpPoint=[NaN,NaN];class Geometry extends BaseObject{constructor(){super(),this.extent_=createEmpty(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=memoizeOne((e,n,ei)=>{if(!ei)return this.getSimplifiedGeometry(n);const ti=this.clone();return ti.applyTransform(ei),ti.getSimplifiedGeometry(n)})}simplifyTransformed(e,n){return this.simplifyTransformedInternal(this.getRevision(),e,n)}clone(){return abstract()}closestPointXY(e,n,ei,ti){return abstract()}containsXY(e,n){return this.closestPointXY(e,n,tmpPoint,Number.MIN_VALUE)===0}getClosestPoint(e,n){return n=n||[NaN,NaN],this.closestPointXY(e[0],e[1],n,1/0),n}intersectsCoordinate(e){return this.containsXY(e[0],e[1])}computeExtent(e){return abstract()}getExtent(e){if(this.extentRevision_!=this.getRevision()){const n=this.computeExtent(this.extent_);(isNaN(n[0])||isNaN(n[1]))&&createOrUpdateEmpty(n),this.extentRevision_=this.getRevision()}return returnOrUpdate(this.extent_,e)}rotate(e,n){abstract()}scale(e,n,ei){abstract()}simplify(e){return this.getSimplifiedGeometry(e*e)}getSimplifiedGeometry(e){return abstract()}getType(){return abstract()}applyTransform(e){abstract()}intersectsExtent(e){return abstract()}translate(e,n){abstract()}transform(e,n){const ei=get$3(e),ti=ei.getUnits()=="tile-pixels"?function(ii,ri,ni){const si=ei.getExtent(),ai=ei.getWorldExtent(),oi=getHeight(ai)/getHeight(si);compose(tmpTransform$1,ai[0],ai[3],oi,-oi,0,0,0);const li=transform2D(ii,0,ii.length,ni,tmpTransform$1,ri),ci=getTransform(ei,n);return ci?ci(li,li,ni):li}:getTransform(ei,n);return this.applyTransform(ti),this}}class SimpleGeometry extends Geometry{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(e){return createOrUpdateFromFlatCoordinates(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinates(){return abstract()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const n=this.getSimplifiedGeometryInternal(e);return n.getFlatCoordinates().length<this.flatCoordinates.length?n:(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getSimplifiedGeometryInternal(e){return this}getStride(){return this.stride}setFlatCoordinates(e,n){this.stride=getStrideForLayout(e),this.layout=e,this.flatCoordinates=n}setCoordinates(e,n){abstract()}setLayout(e,n,ei){let ti;if(e)ti=getStrideForLayout(e);else{for(let ii=0;ii<ei;++ii){if(n.length===0){this.layout="XY",this.stride=2;return}n=n[0]}ti=n.length,e=getLayoutForStride(ti)}this.layout=e,this.stride=ti}applyTransform(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(e,n){const ei=this.getFlatCoordinates();if(ei){const ti=this.getStride();rotate(ei,0,ei.length,ti,e,n,ei),this.changed()}}scale(e,n,ei){n===void 0&&(n=e),ei||(ei=getCenter(this.getExtent()));const ti=this.getFlatCoordinates();if(ti){const ii=this.getStride();scale$1(ti,0,ti.length,ii,e,n,ei,ti),this.changed()}}translate(e,n){const ei=this.getFlatCoordinates();if(ei){const ti=this.getStride();translate$1(ei,0,ei.length,ti,e,n,ei),this.changed()}}}function getLayoutForStride(_t){let e;return _t==2?e="XY":_t==3?e="XYZ":_t==4&&(e="XYZM"),e}function getStrideForLayout(_t){let e;return _t=="XY"?e=2:_t=="XYZ"||_t=="XYM"?e=3:_t=="XYZM"&&(e=4),e}function transformGeom2D(_t,e,n){const ei=_t.getFlatCoordinates();if(!ei)return null;const ti=_t.getStride();return transform2D(ei,0,ei.length,ti,e,n)}function deflateCoordinate(_t,e,n,ei){for(let ti=0,ii=n.length;ti<ii;++ti)_t[e++]=n[ti];return e}function deflateCoordinates(_t,e,n,ei){for(let ti=0,ii=n.length;ti<ii;++ti){const ri=n[ti];for(let ni=0;ni<ei;++ni)_t[e++]=ri[ni]}return e}function deflateCoordinatesArray(_t,e,n,ei,ti){ti=ti||[];let ii=0;for(let ri=0,ni=n.length;ri<ni;++ri){const si=deflateCoordinates(_t,e,n[ri],ei);ti[ii++]=si,e=si}return ti.length=ii,ti}function deflateMultiCoordinatesArray(_t,e,n,ei,ti){ti=ti||[];let ii=0;for(let ri=0,ni=n.length;ri<ni;++ri){const si=deflateCoordinatesArray(_t,e,n[ri],ei,ti[ii]);si.length===0&&(si[0]=e),ti[ii++]=si,e=si[si.length-1]}return ti.length=ii,ti}class Circle extends SimpleGeometry{constructor(e,n,ei){super(),ei!==void 0&&n===void 0?this.setFlatCoordinates(ei,e):(n=n||0,this.setCenterAndRadius(e,n,ei))}clone(){const e=new Circle(this.flatCoordinates.slice(),void 0,this.layout);return e.applyProperties(this),e}closestPointXY(e,n,ei,ti){const ii=this.flatCoordinates,ri=e-ii[0],ni=n-ii[1],si=ri*ri+ni*ni;if(si<ti){if(si===0)for(let ai=0;ai<this.stride;++ai)ei[ai]=ii[ai];else{const ai=this.getRadius()/Math.sqrt(si);ei[0]=ii[0]+ai*ri,ei[1]=ii[1]+ai*ni;for(let oi=2;oi<this.stride;++oi)ei[oi]=ii[oi]}return ei.length=this.stride,si}return ti}containsXY(e,n){const ei=this.flatCoordinates,ti=e-ei[0],ii=n-ei[1];return ti*ti+ii*ii<=this.getRadiusSquared_()}getCenter(){return this.flatCoordinates.slice(0,this.stride)}computeExtent(e){const n=this.flatCoordinates,ei=n[this.stride]-n[0];return createOrUpdate$2(n[0]-ei,n[1]-ei,n[0]+ei,n[1]+ei,e)}getRadius(){return Math.sqrt(this.getRadiusSquared_())}getRadiusSquared_(){const e=this.flatCoordinates[this.stride]-this.flatCoordinates[0],n=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return e*e+n*n}getType(){return"Circle"}intersectsExtent(e){const n=this.getExtent();if(intersects$1(e,n)){const ei=this.getCenter();return e[0]<=ei[0]&&e[2]>=ei[0]||e[1]<=ei[1]&&e[3]>=ei[1]?!0:forEachCorner(e,this.intersectsCoordinate.bind(this))}return!1}setCenter(e){const n=this.stride,ei=this.flatCoordinates[n]-this.flatCoordinates[0],ti=e.slice();ti[n]=ti[0]+ei;for(let ii=1;ii<n;++ii)ti[n+ii]=e[ii];this.setFlatCoordinates(this.layout,ti),this.changed()}setCenterAndRadius(e,n,ei){this.setLayout(ei,e,0),this.flatCoordinates||(this.flatCoordinates=[]);const ti=this.flatCoordinates;let ii=deflateCoordinate(ti,0,e,this.stride);ti[ii++]=ti[0]+n;for(let ri=1,ni=this.stride;ri<ni;++ri)ti[ii++]=ti[ri];ti.length=ii,this.changed()}getCoordinates(){return null}setCoordinates(e,n){}setRadius(e){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+e,this.changed()}rotate(e,n){const ei=this.getCenter(),ti=this.getStride();this.setCenter(rotate(ei,0,ei.length,ti,e,n,ei)),this.changed()}}Circle.prototype.transform;class GeometryCollection extends Geometry{constructor(e){super(),this.geometries_=e,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(unlistenByKey),this.changeEventsKeys_.length=0}listenGeometriesChange_(){const e=this.geometries_;for(let n=0,ei=e.length;n<ei;++n)this.changeEventsKeys_.push(listen(e[n],EventType.CHANGE,this.changed,this))}clone(){const e=new GeometryCollection(cloneGeometries(this.geometries_));return e.applyProperties(this),e}closestPointXY(e,n,ei,ti){if(ti<closestSquaredDistanceXY(this.getExtent(),e,n))return ti;const ii=this.geometries_;for(let ri=0,ni=ii.length;ri<ni;++ri)ti=ii[ri].closestPointXY(e,n,ei,ti);return ti}containsXY(e,n){const ei=this.geometries_;for(let ti=0,ii=ei.length;ti<ii;++ti)if(ei[ti].containsXY(e,n))return!0;return!1}computeExtent(e){createOrUpdateEmpty(e);const n=this.geometries_;for(let ei=0,ti=n.length;ei<ti;++ei)extend$4(e,n[ei].getExtent());return e}getGeometries(){return cloneGeometries(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let e=[];const n=this.geometries_;for(let ei=0,ti=n.length;ei<ti;++ei)n[ei].getType()===this.getType()?e=e.concat(n[ei].getGeometriesArrayRecursive()):e.push(n[ei]);return e}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const n=[],ei=this.geometries_;let ti=!1;for(let ii=0,ri=ei.length;ii<ri;++ii){const ni=ei[ii],si=ni.getSimplifiedGeometry(e);n.push(si),si!==ni&&(ti=!0)}return ti?new GeometryCollection(n):(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getType(){return"GeometryCollection"}intersectsExtent(e){const n=this.geometries_;for(let ei=0,ti=n.length;ei<ti;++ei)if(n[ei].intersectsExtent(e))return!0;return!1}isEmpty(){return this.geometries_.length===0}rotate(e,n){const ei=this.geometries_;for(let ti=0,ii=ei.length;ti<ii;++ti)ei[ti].rotate(e,n);this.changed()}scale(e,n,ei){ei||(ei=getCenter(this.getExtent()));const ti=this.geometries_;for(let ii=0,ri=ti.length;ii<ri;++ii)ti[ii].scale(e,n,ei);this.changed()}setGeometries(e){this.setGeometriesArray(cloneGeometries(e))}setGeometriesArray(e){this.unlistenGeometriesChange_(),this.geometries_=e,this.listenGeometriesChange_(),this.changed()}applyTransform(e){const n=this.geometries_;for(let ei=0,ti=n.length;ei<ti;++ei)n[ei].applyTransform(e);this.changed()}translate(e,n){const ei=this.geometries_;for(let ti=0,ii=ei.length;ti<ii;++ti)ei[ti].translate(e,n);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function cloneGeometries(_t){return _t.map(e=>e.clone())}function linearRing(_t,e,n,ei){let ti=0;const ii=_t[n-ei],ri=_t[n-ei+1];let ni=0,si=0;for(;e<n;e+=ei){const ai=_t[e]-ii,oi=_t[e+1]-ri;ti+=si*ai-ni*oi,ni=ai,si=oi}return ti/2}function linearRings(_t,e,n,ei){let ti=0;for(let ii=0,ri=n.length;ii<ri;++ii){const ni=n[ii];ti+=linearRing(_t,e,ni,ei),e=ni}return ti}function linearRingss(_t,e,n,ei){let ti=0;for(let ii=0,ri=n.length;ii<ri;++ii){const ni=n[ii];ti+=linearRings(_t,e,ni,ei),e=ni[ni.length-1]}return ti}function assignClosest(_t,e,n,ei,ti,ii,ri){const ni=_t[e],si=_t[e+1],ai=_t[n]-ni,oi=_t[n+1]-si;let li;if(ai===0&&oi===0)li=e;else{const ci=((ti-ni)*ai+(ii-si)*oi)/(ai*ai+oi*oi);if(ci>1)li=n;else if(ci>0){for(let ui=0;ui<ei;++ui)ri[ui]=lerp(_t[e+ui],_t[n+ui],ci);ri.length=ei;return}else li=e}for(let ci=0;ci<ei;++ci)ri[ci]=_t[li+ci];ri.length=ei}function maxSquaredDelta(_t,e,n,ei,ti){let ii=_t[e],ri=_t[e+1];for(e+=ei;e<n;e+=ei){const ni=_t[e],si=_t[e+1],ai=squaredDistance(ii,ri,ni,si);ai>ti&&(ti=ai),ii=ni,ri=si}return ti}function arrayMaxSquaredDelta(_t,e,n,ei,ti){for(let ii=0,ri=n.length;ii<ri;++ii){const ni=n[ii];ti=maxSquaredDelta(_t,e,ni,ei,ti),e=ni}return ti}function multiArrayMaxSquaredDelta(_t,e,n,ei,ti){for(let ii=0,ri=n.length;ii<ri;++ii){const ni=n[ii];ti=arrayMaxSquaredDelta(_t,e,ni,ei,ti),e=ni[ni.length-1]}return ti}function assignClosestPoint(_t,e,n,ei,ti,ii,ri,ni,si,ai,oi){if(e==n)return ai;let li,ci;if(ti===0){if(ci=squaredDistance(ri,ni,_t[e],_t[e+1]),ci<ai){for(li=0;li<ei;++li)si[li]=_t[e+li];return si.length=ei,ci}return ai}oi=oi||[NaN,NaN];let ui=e+ei;for(;ui<n;)if(assignClosest(_t,ui-ei,ui,ei,ri,ni,oi),ci=squaredDistance(ri,ni,oi[0],oi[1]),ci<ai){for(ai=ci,li=0;li<ei;++li)si[li]=oi[li];si.length=ei,ui+=ei}else ui+=ei*Math.max((Math.sqrt(ci)-Math.sqrt(ai))/ti|0,1);if(ii&&(assignClosest(_t,n-ei,e,ei,ri,ni,oi),ci=squaredDistance(ri,ni,oi[0],oi[1]),ci<ai)){for(ai=ci,li=0;li<ei;++li)si[li]=oi[li];si.length=ei}return ai}function assignClosestArrayPoint(_t,e,n,ei,ti,ii,ri,ni,si,ai,oi){oi=oi||[NaN,NaN];for(let li=0,ci=n.length;li<ci;++li){const ui=n[li];ai=assignClosestPoint(_t,e,ui,ei,ti,ii,ri,ni,si,ai,oi),e=ui}return ai}function assignClosestMultiArrayPoint(_t,e,n,ei,ti,ii,ri,ni,si,ai,oi){oi=oi||[NaN,NaN];for(let li=0,ci=n.length;li<ci;++li){const ui=n[li];ai=assignClosestArrayPoint(_t,e,ui,ei,ti,ii,ri,ni,si,ai,oi),e=ui[ui.length-1]}return ai}function inflateCoordinates(_t,e,n,ei,ti){ti=ti!==void 0?ti:[];let ii=0;for(let ri=e;ri<n;ri+=ei)ti[ii++]=_t.slice(ri,ri+ei);return ti.length=ii,ti}function inflateCoordinatesArray(_t,e,n,ei,ti){ti=ti!==void 0?ti:[];let ii=0;for(let ri=0,ni=n.length;ri<ni;++ri){const si=n[ri];ti[ii++]=inflateCoordinates(_t,e,si,ei,ti[ii]),e=si}return ti.length=ii,ti}function inflateMultiCoordinatesArray(_t,e,n,ei,ti){ti=ti!==void 0?ti:[];let ii=0;for(let ri=0,ni=n.length;ri<ni;++ri){const si=n[ri];ti[ii++]=si.length===1&&si[0]===e?[]:inflateCoordinatesArray(_t,e,si,ei,ti[ii]),e=si[si.length-1]}return ti.length=ii,ti}class LinearRing extends SimpleGeometry{constructor(e,n){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,n!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(n,e):this.setCoordinates(e,n)}clone(){return new LinearRing(this.flatCoordinates.slice(),this.layout)}closestPointXY(e,n,ei,ti){return ti<closestSquaredDistanceXY(this.getExtent(),e,n)?ti:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(maxSquaredDelta(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),assignClosestPoint(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,n,ei,ti))}getArea(){return linearRing(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return inflateCoordinates(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(e){const n=[];return n.length=douglasPeucker(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,n,0),new LinearRing(n,"XY")}getType(){return"LinearRing"}intersectsExtent(e){return!1}setCoordinates(e,n){this.setLayout(n,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=deflateCoordinates(this.flatCoordinates,0,e,this.stride),this.changed()}}function lineStringLength(_t,e,n,ei){let ti=_t[e],ii=_t[e+1],ri=0;for(let ni=e+ei;ni<n;ni+=ei){const si=_t[ni],ai=_t[ni+1];ri+=Math.sqrt((si-ti)*(si-ti)+(ai-ii)*(ai-ii)),ti=si,ii=ai}return ri}class LineString extends SimpleGeometry{constructor(e,n){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,n!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(n,e):this.setCoordinates(e,n)}appendCoordinate(e){extend$3(this.flatCoordinates,e),this.changed()}clone(){const e=new LineString(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,n,ei,ti){return ti<closestSquaredDistanceXY(this.getExtent(),e,n)?ti:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(maxSquaredDelta(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),assignClosestPoint(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,e,n,ei,ti))}forEachSegment(e){return forEach(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinateAtM(e,n){return this.layout!="XYM"&&this.layout!="XYZM"?null:(n=n!==void 0?n:!1,lineStringCoordinateAtM(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,n))}getCoordinates(){return inflateCoordinates(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(e,n){return interpolatePoint(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,n,this.stride)}getLength(){return lineStringLength(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(e){const n=[];return n.length=douglasPeucker(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,n,0),new LineString(n,"XY")}getType(){return"LineString"}intersectsExtent(e){return intersectsLineString(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,this.getExtent())}setCoordinates(e,n){this.setLayout(n,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=deflateCoordinates(this.flatCoordinates,0,e,this.stride),this.changed()}}class MultiLineString extends SimpleGeometry{constructor(e,n,ei){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(e[0]))this.setCoordinates(e,n);else if(n!==void 0&&ei)this.setFlatCoordinates(n,e),this.ends_=ei;else{const ti=e,ii=[],ri=[];for(let si=0,ai=ti.length;si<ai;++si){const oi=ti[si];extend$3(ii,oi.getFlatCoordinates()),ri.push(ii.length)}const ni=ti.length===0?this.getLayout():ti[0].getLayout();this.setFlatCoordinates(ni,ii),this.ends_=ri}}appendLineString(e){extend$3(this.flatCoordinates,e.getFlatCoordinates().slice()),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new MultiLineString(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,n,ei,ti){return ti<closestSquaredDistanceXY(this.getExtent(),e,n)?ti:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(arrayMaxSquaredDelta(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),assignClosestArrayPoint(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,e,n,ei,ti))}getCoordinateAtM(e,n,ei){return this.layout!="XYM"&&this.layout!="XYZM"||this.flatCoordinates.length===0?null:(n=n!==void 0?n:!1,ei=ei!==void 0?ei:!1,lineStringsCoordinateAtM(this.flatCoordinates,0,this.ends_,this.stride,e,n,ei))}getCoordinates(){return inflateCoordinatesArray(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(e){return e<0||this.ends_.length<=e?null:new LineString(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLineStrings(){const e=this.flatCoordinates,n=this.ends_,ei=this.layout,ti=[];let ii=0;for(let ri=0,ni=n.length;ri<ni;++ri){const si=n[ri],ai=new LineString(e.slice(ii,si),ei);ti.push(ai),ii=si}return ti}getLength(){const e=this.ends_;let n=0,ei=0;for(let ti=0,ii=e.length;ti<ii;++ti)ei+=lineStringLength(this.flatCoordinates,n,e[ti],this.stride),n=e[ti];return ei}getFlatMidpoints(){const e=[],n=this.flatCoordinates;let ei=0;const ti=this.ends_,ii=this.stride;for(let ri=0,ni=ti.length;ri<ni;++ri){const si=ti[ri],ai=interpolatePoint(n,ei,si,ii,.5);extend$3(e,ai),ei=si}return e}getSimplifiedGeometryInternal(e){const n=[],ei=[];return n.length=douglasPeuckerArray(this.flatCoordinates,0,this.ends_,this.stride,e,n,0,ei),new MultiLineString(n,"XY",ei)}getType(){return"MultiLineString"}intersectsExtent(e){return intersectsLineStringArray(this.flatCoordinates,0,this.ends_,this.stride,e)}setCoordinates(e,n){this.setLayout(n,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const ei=deflateCoordinatesArray(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=ei.length===0?0:ei[ei.length-1],this.changed()}}let Point$1=class qc extends SimpleGeometry{constructor(e,n){super(),this.setCoordinates(e,n)}clone(){const e=new qc(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,n,ei,ti){const ii=this.flatCoordinates,ri=squaredDistance(e,n,ii[0],ii[1]);if(ri<ti){const ni=this.stride;for(let si=0;si<ni;++si)ei[si]=ii[si];return ei.length=ni,ri}return ti}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(e){return createOrUpdateFromCoordinate(this.flatCoordinates,e)}getType(){return"Point"}intersectsExtent(e){return containsXY(e,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(e,n){this.setLayout(n,e,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=deflateCoordinate(this.flatCoordinates,0,e,this.stride),this.changed()}};class MultiPoint extends SimpleGeometry{constructor(e,n){super(),n&&!Array.isArray(e[0])?this.setFlatCoordinates(n,e):this.setCoordinates(e,n)}appendPoint(e){extend$3(this.flatCoordinates,e.getFlatCoordinates()),this.changed()}clone(){const e=new MultiPoint(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,n,ei,ti){if(ti<closestSquaredDistanceXY(this.getExtent(),e,n))return ti;const ii=this.flatCoordinates,ri=this.stride;for(let ni=0,si=ii.length;ni<si;ni+=ri){const ai=squaredDistance(e,n,ii[ni],ii[ni+1]);if(ai<ti){ti=ai;for(let oi=0;oi<ri;++oi)ei[oi]=ii[ni+oi];ei.length=ri}}return ti}getCoordinates(){return inflateCoordinates(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(e){const n=this.flatCoordinates.length/this.stride;return e<0||n<=e?null:new Point$1(this.flatCoordinates.slice(e*this.stride,(e+1)*this.stride),this.layout)}getPoints(){const e=this.flatCoordinates,n=this.layout,ei=this.stride,ti=[];for(let ii=0,ri=e.length;ii<ri;ii+=ei){const ni=new Point$1(e.slice(ii,ii+ei),n);ti.push(ni)}return ti}getType(){return"MultiPoint"}intersectsExtent(e){const n=this.flatCoordinates,ei=this.stride;for(let ti=0,ii=n.length;ti<ii;ti+=ei){const ri=n[ti],ni=n[ti+1];if(containsXY(e,ri,ni))return!0}return!1}setCoordinates(e,n){this.setLayout(n,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=deflateCoordinates(this.flatCoordinates,0,e,this.stride),this.changed()}}class Polygon extends SimpleGeometry{constructor(e,n,ei){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,n!==void 0&&ei?(this.setFlatCoordinates(n,e),this.ends_=ei):this.setCoordinates(e,n)}appendLinearRing(e){this.flatCoordinates?extend$3(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new Polygon(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,n,ei,ti){return ti<closestSquaredDistanceXY(this.getExtent(),e,n)?ti:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(arrayMaxSquaredDelta(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),assignClosestArrayPoint(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,n,ei,ti))}containsXY(e,n){return linearRingsContainsXY(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,n)}getArea(){return linearRings(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(e){let n;return e!==void 0?(n=this.getOrientedFlatCoordinates().slice(),orientLinearRings(n,0,this.ends_,this.stride,e)):n=this.flatCoordinates,inflateCoordinatesArray(n,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const e=getCenter(this.getExtent());this.flatInteriorPoint_=getInteriorPointOfArray(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new Point$1(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(e){return e<0||this.ends_.length<=e?null:new LinearRing(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLinearRings(){const e=this.layout,n=this.flatCoordinates,ei=this.ends_,ti=[];let ii=0;for(let ri=0,ni=ei.length;ri<ni;++ri){const si=ei[ri],ai=new LinearRing(n.slice(ii,si),e);ti.push(ai),ii=si}return ti}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;linearRingsAreOriented(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=orientLinearRings(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const n=[],ei=[];return n.length=quantizeArray(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(e),n,0,ei),new Polygon(n,"XY",ei)}getType(){return"Polygon"}intersectsExtent(e){return intersectsLinearRingArray(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)}setCoordinates(e,n){this.setLayout(n,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const ei=deflateCoordinatesArray(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=ei.length===0?0:ei[ei.length-1],this.changed()}}function circular(_t,e,n,ei){n=n||32;const ti=[];for(let ii=0;ii<n;++ii)extend$3(ti,offset(_t,e,2*Math.PI*ii/n,ei));return ti.push(ti[0],ti[1]),new Polygon(ti,"XY",[ti.length])}function fromExtent(_t){if(isEmpty$1(_t))throw new Error("Cannot create polygon from empty extent");const e=_t[0],n=_t[1],ei=_t[2],ti=_t[3],ii=[e,n,e,ti,ei,ti,ei,n,e,n];return new Polygon(ii,"XY",[ii.length])}class MultiPolygon extends SimpleGeometry{constructor(e,n,ei){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!ei&&!Array.isArray(e[0])){const ti=e,ii=[],ri=[];for(let ni=0,si=ti.length;ni<si;++ni){const ai=ti[ni],oi=ii.length,li=ai.getEnds();for(let ci=0,ui=li.length;ci<ui;++ci)li[ci]+=oi;extend$3(ii,ai.getFlatCoordinates()),ri.push(li)}n=ti.length===0?this.getLayout():ti[0].getLayout(),e=ii,ei=ri}n!==void 0&&ei?(this.setFlatCoordinates(n,e),this.endss_=ei):this.setCoordinates(e,n)}appendPolygon(e){let n;if(!this.flatCoordinates)this.flatCoordinates=e.getFlatCoordinates().slice(),n=e.getEnds().slice(),this.endss_.push();else{const ei=this.flatCoordinates.length;extend$3(this.flatCoordinates,e.getFlatCoordinates()),n=e.getEnds().slice();for(let ti=0,ii=n.length;ti<ii;++ti)n[ti]+=ei}this.endss_.push(n),this.changed()}clone(){const e=this.endss_.length,n=new Array(e);for(let ti=0;ti<e;++ti)n[ti]=this.endss_[ti].slice();const ei=new MultiPolygon(this.flatCoordinates.slice(),this.layout,n);return ei.applyProperties(this),ei}closestPointXY(e,n,ei,ti){return ti<closestSquaredDistanceXY(this.getExtent(),e,n)?ti:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(multiArrayMaxSquaredDelta(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),assignClosestMultiArrayPoint(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,e,n,ei,ti))}containsXY(e,n){return linearRingssContainsXY(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e,n)}getArea(){return linearRingss(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(e){let n;return e!==void 0?(n=this.getOrientedFlatCoordinates().slice(),orientLinearRingsArray(n,0,this.endss_,this.stride,e)):n=this.flatCoordinates,inflateMultiCoordinatesArray(n,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const e=linearRingss$1(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=getInteriorPointsOfMultiArray(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new MultiPoint(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;linearRingssAreOriented(e,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=orientLinearRingsArray(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const n=[],ei=[];return n.length=quantizeMultiArray(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(e),n,0,ei),new MultiPolygon(n,"XY",ei)}getPolygon(e){if(e<0||this.endss_.length<=e)return null;let n;if(e===0)n=0;else{const ii=this.endss_[e-1];n=ii[ii.length-1]}const ei=this.endss_[e].slice(),ti=ei[ei.length-1];if(n!==0)for(let ii=0,ri=ei.length;ii<ri;++ii)ei[ii]-=n;return new Polygon(this.flatCoordinates.slice(n,ti),this.layout,ei)}getPolygons(){const e=this.layout,n=this.flatCoordinates,ei=this.endss_,ti=[];let ii=0;for(let ri=0,ni=ei.length;ri<ni;++ri){const si=ei[ri].slice(),ai=si[si.length-1];if(ii!==0)for(let li=0,ci=si.length;li<ci;++li)si[li]-=ii;const oi=new Polygon(n.slice(ii,ai),e,si);ti.push(oi),ii=ai}return ti}getType(){return"MultiPolygon"}intersectsExtent(e){return intersectsLinearRingMultiArray(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e)}setCoordinates(e,n){this.setLayout(n,e,3),this.flatCoordinates||(this.flatCoordinates=[]);const ei=deflateMultiCoordinatesArray(this.flatCoordinates,0,e,this.stride,this.endss_);if(ei.length===0)this.flatCoordinates.length=0;else{const ti=ei[ei.length-1];this.flatCoordinates.length=ti.length===0?0:ti[ti.length-1]}this.changed()}}const tmpTransform=create();class RenderFeature{constructor(e,n,ei,ti,ii,ri){this.styleFunction,this.extent_,this.id_=ri,this.type_=e,this.flatCoordinates_=n,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=ei||null,this.properties_=ii,this.squaredTolerance_,this.stride_=ti,this.simplifiedGeometry_}get(e){return this.properties_[e]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?createOrUpdateFromCoordinate(this.flatCoordinates_):createOrUpdateFromFlatCoordinates(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const e=getCenter(this.getExtent());this.flatInteriorPoints_=getInteriorPointOfArray(this.flatCoordinates_,0,this.ends_,2,e,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const e=inflateEnds(this.flatCoordinates_,this.ends_),n=linearRingss$1(this.flatCoordinates_,0,e,2);this.flatInteriorPoints_=getInteriorPointsOfMultiArray(this.flatCoordinates_,0,e,2,n)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=interpolatePoint(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const e=this.flatCoordinates_;let n=0;const ei=this.ends_;for(let ti=0,ii=ei.length;ti<ii;++ti){const ri=ei[ti],ni=interpolatePoint(e,n,ri,2,.5);extend$3(this.flatMidpoints_,ni),n=ri}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(e){return this}simplifyTransformed(e,n){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(e){e=get$3(e);const n=e.getExtent(),ei=e.getWorldExtent();if(n&&ei){const ti=getHeight(ei)/getHeight(n);compose(tmpTransform,ei[0],ei[3],ti,-ti,0,0,0),transform2D(this.flatCoordinates_,0,this.flatCoordinates_.length,2,tmpTransform,this.flatCoordinates_)}}applyTransform(e){e(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){var e;return new RenderFeature(this.type_,this.flatCoordinates_.slice(),(e=this.ends_)==null?void 0:e.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=memoizeOne((e,n)=>{if(e===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),n&&this.simplifiedGeometry_.applyTransform(n);const ei=this.simplifiedGeometry_.getFlatCoordinates();let ti;switch(this.type_){case"LineString":ei.length=douglasPeucker(ei,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,e,ei,0),ti=[ei.length];break;case"MultiLineString":ti=[],ei.length=douglasPeuckerArray(ei,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,e,ei,0,ti);break;case"Polygon":ti=[],ei.length=quantizeArray(ei,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(e),ei,0,ti);break}return ti&&(this.simplifiedGeometry_=new RenderFeature(this.type_,ei,ti,2,this.properties_,this.id_)),this.squaredTolerance_=e,this.simplifiedGeometry_}),this}}RenderFeature.prototype.getFlatCoordinates=RenderFeature.prototype.getOrientedFlatCoordinates;function quickselect(_t,e,n=0,ei=_t.length-1,ti=defaultCompare){for(;ei>n;){if(ei-n>600){const si=ei-n+1,ai=e-n+1,oi=Math.log(si),li=.5*Math.exp(2*oi/3),ci=.5*Math.sqrt(oi*li*(si-li)/si)*(ai-si/2<0?-1:1),ui=Math.max(n,Math.floor(e-ai*li/si+ci)),di=Math.min(ei,Math.floor(e+(si-ai)*li/si+ci));quickselect(_t,e,ui,di,ti)}const ii=_t[e];let ri=n,ni=ei;for(swap(_t,n,e),ti(_t[ei],ii)>0&&swap(_t,n,ei);ri<ni;){for(swap(_t,ri,ni),ri++,ni--;ti(_t[ri],ii)<0;)ri++;for(;ti(_t[ni],ii)>0;)ni--}ti(_t[n],ii)===0?swap(_t,n,ni):(ni++,swap(_t,ni,ei)),ni<=e&&(n=ni+1),e<=ni&&(ei=ni-1)}}function swap(_t,e,n){const ei=_t[e];_t[e]=_t[n],_t[n]=ei}function defaultCompare(_t,e){return _t<e?-1:_t>e?1:0}let RBush$1=class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let n=this.data;const ei=[];if(!intersects(e,n))return ei;const ti=this.toBBox,ii=[];for(;n;){for(let ri=0;ri<n.children.length;ri++){const ni=n.children[ri],si=n.leaf?ti(ni):ni;intersects(e,si)&&(n.leaf?ei.push(ni):contains$1(e,si)?this._all(ni,ei):ii.push(ni))}n=ii.pop()}return ei}collides(e){let n=this.data;if(!intersects(e,n))return!1;const ei=[];for(;n;){for(let ti=0;ti<n.children.length;ti++){const ii=n.children[ti],ri=n.leaf?this.toBBox(ii):ii;if(intersects(e,ri)){if(n.leaf||contains$1(e,ri))return!0;ei.push(ii)}}n=ei.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let ei=0;ei<e.length;ei++)this.insert(e[ei]);return this}let n=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=n;else if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){const ei=this.data;this.data=n,n=ei}this._insert(n,this.data.height-n.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=createNode([]),this}remove(e,n){if(!e)return this;let ei=this.data;const ti=this.toBBox(e),ii=[],ri=[];let ni,si,ai;for(;ei||ii.length;){if(ei||(ei=ii.pop(),si=ii[ii.length-1],ni=ri.pop(),ai=!0),ei.leaf){const oi=findItem(e,ei.children,n);if(oi!==-1)return ei.children.splice(oi,1),ii.push(ei),this._condense(ii),this}!ai&&!ei.leaf&&contains$1(ei,ti)?(ii.push(ei),ri.push(ni),ni=0,si=ei,ei=ei.children[0]):si?(ni++,ei=si.children[ni],ai=!1):ei=null}return this}toBBox(e){return e}compareMinX(e,n){return e.minX-n.minX}compareMinY(e,n){return e.minY-n.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,n){const ei=[];for(;e;)e.leaf?n.push(...e.children):ei.push(...e.children),e=ei.pop();return n}_build(e,n,ei,ti){const ii=ei-n+1;let ri=this._maxEntries,ni;if(ii<=ri)return ni=createNode(e.slice(n,ei+1)),calcBBox(ni,this.toBBox),ni;ti||(ti=Math.ceil(Math.log(ii)/Math.log(ri)),ri=Math.ceil(ii/Math.pow(ri,ti-1))),ni=createNode([]),ni.leaf=!1,ni.height=ti;const si=Math.ceil(ii/ri),ai=si*Math.ceil(Math.sqrt(ri));multiSelect(e,n,ei,ai,this.compareMinX);for(let oi=n;oi<=ei;oi+=ai){const li=Math.min(oi+ai-1,ei);multiSelect(e,oi,li,si,this.compareMinY);for(let ci=oi;ci<=li;ci+=si){const ui=Math.min(ci+si-1,li);ni.children.push(this._build(e,ci,ui,ti-1))}}return calcBBox(ni,this.toBBox),ni}_chooseSubtree(e,n,ei,ti){for(;ti.push(n),!(n.leaf||ti.length-1===ei);){let ii=1/0,ri=1/0,ni;for(let si=0;si<n.children.length;si++){const ai=n.children[si],oi=bboxArea(ai),li=enlargedArea(e,ai)-oi;li<ri?(ri=li,ii=oi<ii?oi:ii,ni=ai):li===ri&&oi<ii&&(ii=oi,ni=ai)}n=ni||n.children[0]}return n}_insert(e,n,ei){const ti=ei?e:this.toBBox(e),ii=[],ri=this._chooseSubtree(ti,this.data,n,ii);for(ri.children.push(e),extend$2(ri,ti);n>=0&&ii[n].children.length>this._maxEntries;)this._split(ii,n),n--;this._adjustParentBBoxes(ti,ii,n)}_split(e,n){const ei=e[n],ti=ei.children.length,ii=this._minEntries;this._chooseSplitAxis(ei,ii,ti);const ri=this._chooseSplitIndex(ei,ii,ti),ni=createNode(ei.children.splice(ri,ei.children.length-ri));ni.height=ei.height,ni.leaf=ei.leaf,calcBBox(ei,this.toBBox),calcBBox(ni,this.toBBox),n?e[n-1].children.push(ni):this._splitRoot(ei,ni)}_splitRoot(e,n){this.data=createNode([e,n]),this.data.height=e.height+1,this.data.leaf=!1,calcBBox(this.data,this.toBBox)}_chooseSplitIndex(e,n,ei){let ti,ii=1/0,ri=1/0;for(let ni=n;ni<=ei-n;ni++){const si=distBBox(e,0,ni,this.toBBox),ai=distBBox(e,ni,ei,this.toBBox),oi=intersectionArea(si,ai),li=bboxArea(si)+bboxArea(ai);oi<ii?(ii=oi,ti=ni,ri=li<ri?li:ri):oi===ii&&li<ri&&(ri=li,ti=ni)}return ti||ei-n}_chooseSplitAxis(e,n,ei){const ti=e.leaf?this.compareMinX:compareNodeMinX,ii=e.leaf?this.compareMinY:compareNodeMinY,ri=this._allDistMargin(e,n,ei,ti),ni=this._allDistMargin(e,n,ei,ii);ri<ni&&e.children.sort(ti)}_allDistMargin(e,n,ei,ti){e.children.sort(ti);const ii=this.toBBox,ri=distBBox(e,0,n,ii),ni=distBBox(e,ei-n,ei,ii);let si=bboxMargin(ri)+bboxMargin(ni);for(let ai=n;ai<ei-n;ai++){const oi=e.children[ai];extend$2(ri,e.leaf?ii(oi):oi),si+=bboxMargin(ri)}for(let ai=ei-n-1;ai>=n;ai--){const oi=e.children[ai];extend$2(ni,e.leaf?ii(oi):oi),si+=bboxMargin(ni)}return si}_adjustParentBBoxes(e,n,ei){for(let ti=ei;ti>=0;ti--)extend$2(n[ti],e)}_condense(e){for(let n=e.length-1,ei;n>=0;n--)e[n].children.length===0?n>0?(ei=e[n-1].children,ei.splice(ei.indexOf(e[n]),1)):this.clear():calcBBox(e[n],this.toBBox)}};function findItem(_t,e,n){if(!n)return e.indexOf(_t);for(let ei=0;ei<e.length;ei++)if(n(_t,e[ei]))return ei;return-1}function calcBBox(_t,e){distBBox(_t,0,_t.children.length,e,_t)}function distBBox(_t,e,n,ei,ti){ti||(ti=createNode(null)),ti.minX=1/0,ti.minY=1/0,ti.maxX=-1/0,ti.maxY=-1/0;for(let ii=e;ii<n;ii++){const ri=_t.children[ii];extend$2(ti,_t.leaf?ei(ri):ri)}return ti}function extend$2(_t,e){return _t.minX=Math.min(_t.minX,e.minX),_t.minY=Math.min(_t.minY,e.minY),_t.maxX=Math.max(_t.maxX,e.maxX),_t.maxY=Math.max(_t.maxY,e.maxY),_t}function compareNodeMinX(_t,e){return _t.minX-e.minX}function compareNodeMinY(_t,e){return _t.minY-e.minY}function bboxArea(_t){return(_t.maxX-_t.minX)*(_t.maxY-_t.minY)}function bboxMargin(_t){return _t.maxX-_t.minX+(_t.maxY-_t.minY)}function enlargedArea(_t,e){return(Math.max(e.maxX,_t.maxX)-Math.min(e.minX,_t.minX))*(Math.max(e.maxY,_t.maxY)-Math.min(e.minY,_t.minY))}function intersectionArea(_t,e){const n=Math.max(_t.minX,e.minX),ei=Math.max(_t.minY,e.minY),ti=Math.min(_t.maxX,e.maxX),ii=Math.min(_t.maxY,e.maxY);return Math.max(0,ti-n)*Math.max(0,ii-ei)}function contains$1(_t,e){return _t.minX<=e.minX&&_t.minY<=e.minY&&e.maxX<=_t.maxX&&e.maxY<=_t.maxY}function intersects(_t,e){return e.minX<=_t.maxX&&e.minY<=_t.maxY&&e.maxX>=_t.minX&&e.maxY>=_t.minY}function createNode(_t){return{children:_t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function multiSelect(_t,e,n,ei,ti){const ii=[e,n];for(;ii.length;){if(n=ii.pop(),e=ii.pop(),n-e<=ei)continue;const ri=e+Math.ceil((n-e)/ei/2)*ei;quickselect(_t,ri,e,n,ti),ii.push(e,ri,ri,n)}}class RBush{constructor(e){this.rbush_=new RBush$1(e),this.items_={}}insert(e,n){const ei={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:n};this.rbush_.insert(ei),this.items_[getUid(n)]=ei}load(e,n){const ei=new Array(n.length);for(let ti=0,ii=n.length;ti<ii;ti++){const ri=e[ti],ni=n[ti],si={minX:ri[0],minY:ri[1],maxX:ri[2],maxY:ri[3],value:ni};ei[ti]=si,this.items_[getUid(ni)]=si}this.rbush_.load(ei)}remove(e){const n=getUid(e),ei=this.items_[n];return delete this.items_[n],this.rbush_.remove(ei)!==null}update(e,n){const ei=this.items_[getUid(n)],ti=[ei.minX,ei.minY,ei.maxX,ei.maxY];equals$1(ti,e)||(this.remove(n),this.insert(e,n))}getAll(){return this.rbush_.all().map(function(n){return n.value})}getInExtent(e){const n={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this.rbush_.search(n).map(function(ti){return ti.value})}forEach(e){return this.forEach_(this.getAll(),e)}forEachInExtent(e,n){return this.forEach_(this.getInExtent(e),n)}forEach_(e,n){let ei;for(let ti=0,ii=e.length;ti<ii;ti++)if(ei=n(e[ti]),ei)return ei;return ei}isEmpty(){return isEmpty(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(e){const n=this.rbush_.toJSON();return createOrUpdate$2(n.minX,n.minY,n.maxX,n.maxY,e)}concat(e){this.rbush_.load(e.rbush_.all());for(const n in e.items_)this.items_[n]=e.items_[n]}}const VectorEventType={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};class VectorSourceEvent extends BaseEvent{constructor(e,n,ei){super(e),this.feature=n,this.features=ei}}class VectorSource extends Source{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:e.wrapX!==void 0?e.wrapX:!0}),this.on,this.once,this.un,this.loader_=VOID,this.format_=e.format||null,this.overlaps_=e.overlaps===void 0?!0:e.overlaps,this.url_=e.url,e.loader!==void 0?this.loader_=e.loader:this.url_!==void 0&&(assert(this.format_,"`format` must be set when `url` is set"),this.loader_=xhr(this.url_,this.format_)),this.strategy_=e.strategy!==void 0?e.strategy:all$1;const n=e.useSpatialIndex!==void 0?e.useSpatialIndex:!0;this.featuresRtree_=n?new RBush:null,this.loadedExtentsRtree_=new RBush,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let ei,ti;Array.isArray(e.features)?ti=e.features:e.features&&(ei=e.features,ti=ei.getArray()),!n&&ei===void 0&&(ei=new Collection(ti)),ti!==void 0&&this.addFeaturesInternal(ti),ei!==void 0&&this.bindFeaturesCollection_(ei)}addFeature(e){this.addFeatureInternal(e),this.changed()}addFeatureInternal(e){const n=getUid(e);if(!this.addToIndex_(n,e)){this.featuresCollection_&&this.featuresCollection_.remove(e);return}this.setupChangeEvents_(n,e);const ei=e.getGeometry();if(ei){const ti=ei.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(ti,e)}else this.nullGeometryFeatures_[n]=e;this.dispatchEvent(new VectorSourceEvent(VectorEventType.ADDFEATURE,e))}setupChangeEvents_(e,n){n instanceof RenderFeature||(this.featureChangeKeys_[e]=[listen(n,EventType.CHANGE,this.handleFeatureChange_,this),listen(n,ObjectEventType.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(e,n){let ei=!0;if(n.getId()!==void 0){const ti=String(n.getId());if(!(ti in this.idIndex_))this.idIndex_[ti]=n;else if(n instanceof RenderFeature){const ii=this.idIndex_[ti];ii instanceof RenderFeature?Array.isArray(ii)?ii.push(n):this.idIndex_[ti]=[ii,n]:ei=!1}else ei=!1}return ei&&(assert(!(e in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[e]=n),ei}addFeatures(e){this.addFeaturesInternal(e),this.changed()}addFeaturesInternal(e){const n=[],ei=[],ti=[];for(let ii=0,ri=e.length;ii<ri;ii++){const ni=e[ii],si=getUid(ni);this.addToIndex_(si,ni)&&ei.push(ni)}for(let ii=0,ri=ei.length;ii<ri;ii++){const ni=ei[ii],si=getUid(ni);this.setupChangeEvents_(si,ni);const ai=ni.getGeometry();if(ai){const oi=ai.getExtent();n.push(oi),ti.push(ni)}else this.nullGeometryFeatures_[si]=ni}if(this.featuresRtree_&&this.featuresRtree_.load(n,ti),this.hasListener(VectorEventType.ADDFEATURE))for(let ii=0,ri=ei.length;ii<ri;ii++)this.dispatchEvent(new VectorSourceEvent(VectorEventType.ADDFEATURE,ei[ii]))}bindFeaturesCollection_(e){let n=!1;this.addEventListener(VectorEventType.ADDFEATURE,function(ei){n||(n=!0,e.push(ei.feature),n=!1)}),this.addEventListener(VectorEventType.REMOVEFEATURE,function(ei){n||(n=!0,e.remove(ei.feature),n=!1)}),e.addEventListener(CollectionEventType.ADD,ei=>{n||(n=!0,this.addFeature(ei.element),n=!1)}),e.addEventListener(CollectionEventType.REMOVE,ei=>{n||(n=!0,this.removeFeature(ei.element),n=!1)}),this.featuresCollection_=e}clear(e){if(e){for(const ei in this.featureChangeKeys_)this.featureChangeKeys_[ei].forEach(unlistenByKey);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(ei=>{this.removeFeatureInternal(ei)});for(const ei in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[ei])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const n=new VectorSourceEvent(VectorEventType.CLEAR);this.dispatchEvent(n),this.changed()}forEachFeature(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureAtCoordinateDirect(e,n){const ei=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(ei,function(ti){const ii=ti.getGeometry();if(ii instanceof RenderFeature||ii.intersectsCoordinate(e))return n(ti)})}forEachFeatureInExtent(e,n){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,n);this.featuresCollection_&&this.featuresCollection_.forEach(n)}forEachFeatureIntersectingExtent(e,n){return this.forEachFeatureInExtent(e,function(ei){const ti=ei.getGeometry();if(ti instanceof RenderFeature||ti.intersectsExtent(e)){const ii=n(ei);if(ii)return ii}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let e;return this.featuresCollection_?e=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(e=this.featuresRtree_.getAll(),isEmpty(this.nullGeometryFeatures_)||extend$3(e,Object.values(this.nullGeometryFeatures_))),e}getFeaturesAtCoordinate(e){const n=[];return this.forEachFeatureAtCoordinateDirect(e,function(ei){n.push(ei)}),n}getFeaturesInExtent(e,n){if(this.featuresRtree_){if(!(n&&n.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(e);const ti=wrapAndSliceX(e,n);return[].concat(...ti.map(ii=>this.featuresRtree_.getInExtent(ii)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(e,n){const ei=e[0],ti=e[1];let ii=null;const ri=[NaN,NaN];let ni=1/0;const si=[-1/0,-1/0,1/0,1/0];return n=n||TRUE,this.featuresRtree_.forEachInExtent(si,function(ai){if(n(ai)){const oi=ai.getGeometry(),li=ni;if(ni=oi instanceof RenderFeature?0:oi.closestPointXY(ei,ti,ri,ni),ni<li){ii=ai;const ci=Math.sqrt(ni);si[0]=ei-ci,si[1]=ti-ci,si[2]=ei+ci,si[3]=ti+ci}}}),ii}getExtent(e){return this.featuresRtree_.getExtent(e)}getFeatureById(e){const n=this.idIndex_[e.toString()];return n!==void 0?n:null}getFeatureByUid(e){const n=this.uidIndex_[e];return n!==void 0?n:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(e){const n=e.target,ei=getUid(n),ti=n.getGeometry();if(!ti)ei in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(n),this.nullGeometryFeatures_[ei]=n);else{const ri=ti.getExtent();ei in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[ei],this.featuresRtree_&&this.featuresRtree_.insert(ri,n)):this.featuresRtree_&&this.featuresRtree_.update(ri,n)}const ii=n.getId();if(ii!==void 0){const ri=ii.toString();this.idIndex_[ri]!==n&&(this.removeFromIdIndex_(n),this.idIndex_[ri]=n)}else this.removeFromIdIndex_(n),this.uidIndex_[ei]=n;this.changed(),this.dispatchEvent(new VectorSourceEvent(VectorEventType.CHANGEFEATURE,n))}hasFeature(e){const n=e.getId();return n!==void 0?n in this.idIndex_:getUid(e)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&isEmpty(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(e,n,ei){const ti=this.loadedExtentsRtree_,ii=this.strategy_(e,n,ei);for(let ri=0,ni=ii.length;ri<ni;++ri){const si=ii[ri];ti.forEachInExtent(si,function(oi){return containsExtent(oi.extent,si)})||(++this.loadingExtentsCount_,this.dispatchEvent(new VectorSourceEvent(VectorEventType.FEATURESLOADSTART)),this.loader_.call(this,si,n,ei,oi=>{--this.loadingExtentsCount_,this.dispatchEvent(new VectorSourceEvent(VectorEventType.FEATURESLOADEND,void 0,oi))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new VectorSourceEvent(VectorEventType.FEATURESLOADERROR))}),ti.insert(si,{extent:si.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(e){const n=this.loadedExtentsRtree_,ei=n.forEachInExtent(e,function(ti){if(equals$1(ti.extent,e))return ti});ei&&n.remove(ei)}removeFeatures(e){let n=!1;for(let ei=0,ti=e.length;ei<ti;++ei)n=this.removeFeatureInternal(e[ei])||n;n&&this.changed()}removeFeature(e){if(!e)return;this.removeFeatureInternal(e)&&this.changed()}removeFeatureInternal(e){const n=getUid(e);if(!(n in this.uidIndex_))return!1;n in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[n]:this.featuresRtree_&&this.featuresRtree_.remove(e);const ei=this.featureChangeKeys_[n];ei==null||ei.forEach(unlistenByKey),delete this.featureChangeKeys_[n];const ti=e.getId();if(ti!==void 0){const ii=ti.toString(),ri=this.idIndex_[ii];ri===e?delete this.idIndex_[ii]:Array.isArray(ri)&&(ri.splice(ri.indexOf(e),1),ri.length===1&&(this.idIndex_[ii]=ri[0]))}return delete this.uidIndex_[n],this.hasListener(VectorEventType.REMOVEFEATURE)&&this.dispatchEvent(new VectorSourceEvent(VectorEventType.REMOVEFEATURE,e)),!0}removeFromIdIndex_(e){for(const n in this.idIndex_)if(this.idIndex_[n]===e){delete this.idIndex_[n];break}}setLoader(e){this.loader_=e}setUrl(e){assert(this.format_,"`format` must be set when `url` is set"),this.url_=e,this.setLoader(xhr(e,this.format_))}setOverlaps(e){this.overlaps_=e,this.changed()}}let brokenDiagonalRendering_;const canvasPool$1=[];function drawTestTriangle(_t,e,n,ei,ti){_t.beginPath(),_t.moveTo(0,0),_t.lineTo(e,n),_t.lineTo(ei,ti),_t.closePath(),_t.save(),_t.clip(),_t.fillRect(0,0,Math.max(e,ei)+1,Math.max(n,ti)),_t.restore()}function verifyBrokenDiagonalRendering(_t,e){return Math.abs(_t[e*4]-210)>2||Math.abs(_t[e*4+3]-.75*255)>2}function isBrokenDiagonalRendering(){if(brokenDiagonalRendering_===void 0){const _t=createCanvasContext2D(6,6,canvasPool$1);_t.globalCompositeOperation="lighter",_t.fillStyle="rgba(210, 0, 0, 0.75)",drawTestTriangle(_t,4,5,4,0),drawTestTriangle(_t,4,5,0,5);const e=_t.getImageData(0,0,3,3).data;brokenDiagonalRendering_=verifyBrokenDiagonalRendering(e,0)||verifyBrokenDiagonalRendering(e,4)||verifyBrokenDiagonalRendering(e,8),releaseCanvas(_t),canvasPool$1.push(_t.canvas)}return brokenDiagonalRendering_}function calculateSourceResolution(_t,e,n,ei){const ti=transform$1(n,e,_t);let ii=getPointResolution(e,ei,n);const ri=e.getMetersPerUnit();ri!==void 0&&(ii*=ri);const ni=_t.getMetersPerUnit();ni!==void 0&&(ii/=ni);const si=_t.getExtent();if(!si||containsCoordinate(si,ti)){const ai=getPointResolution(_t,ii,ti)/ii;isFinite(ai)&&ai>0&&(ii/=ai)}return ii}function calculateSourceExtentResolution(_t,e,n,ei){const ti=getCenter(n);let ii=calculateSourceResolution(_t,e,ti,ei);return(!isFinite(ii)||ii<=0)&&forEachCorner(n,function(ri){return ii=calculateSourceResolution(_t,e,ri,ei),isFinite(ii)&&ii>0}),ii}function render(_t,e,n,ei,ti,ii,ri,ni,si,ai,oi,li,ci,ui){const di=createCanvasContext2D(Math.round(n*_t),Math.round(n*e),canvasPool$1);if(li||(di.imageSmoothingEnabled=!1),si.length===0)return di.canvas;di.scale(n,n);function fi(_i){return Math.round(_i*n)/n}di.globalCompositeOperation="lighter";const hi=createEmpty();si.forEach(function(_i,Ai,Ei){extend$4(hi,_i.extent)});let pi;const gi=n/ei,vi=(li?1:1+Math.pow(2,-24))/gi;if(!ci||si.length!==1||ai!==0){if(pi=createCanvasContext2D(Math.round(getWidth(hi)*gi),Math.round(getHeight(hi)*gi),canvasPool$1),li||(pi.imageSmoothingEnabled=!1),ti&&ui){const _i=(ti[0]-hi[0])*gi,Ai=-(ti[3]-hi[3])*gi,Ei=getWidth(ti)*gi,Si=getHeight(ti)*gi;pi.rect(_i,Ai,Ei,Si),pi.clip()}si.forEach(function(_i,Ai,Ei){if(_i.image.width>0&&_i.image.height>0){if(_i.clipExtent){pi.save();const Li=(_i.clipExtent[0]-hi[0])*gi,Di=-(_i.clipExtent[3]-hi[3])*gi,Ni=getWidth(_i.clipExtent)*gi,$i=getHeight(_i.clipExtent)*gi;pi.rect(li?Li:Math.round(Li),li?Di:Math.round(Di),li?Ni:Math.round(Li+Ni)-Math.round(Li),li?$i:Math.round(Di+$i)-Math.round(Di)),pi.clip()}const Si=(_i.extent[0]-hi[0])*gi,wi=-(_i.extent[3]-hi[3])*gi,Oi=getWidth(_i.extent)*gi,Ii=getHeight(_i.extent)*gi;pi.drawImage(_i.image,ai,ai,_i.image.width-2*ai,_i.image.height-2*ai,li?Si:Math.round(Si),li?wi:Math.round(wi),li?Oi:Math.round(Si+Oi)-Math.round(Si),li?Ii:Math.round(wi+Ii)-Math.round(wi)),_i.clipExtent&&pi.restore()}})}const yi=getTopLeft(ri);return ni.getTriangles().forEach(function(_i,Ai,Ei){const Si=_i.source,wi=_i.target;let Oi=Si[0][0],Ii=Si[0][1],Li=Si[1][0],Di=Si[1][1],Ni=Si[2][0],$i=Si[2][1];const Ki=fi((wi[0][0]-yi[0])/ii),er=fi(-(wi[0][1]-yi[1])/ii),Vi=fi((wi[1][0]-yi[0])/ii),nr=fi(-(wi[1][1]-yi[1])/ii),zi=fi((wi[2][0]-yi[0])/ii),Wi=fi(-(wi[2][1]-yi[1])/ii),Ti=Oi,ki=Ii;Oi=0,Ii=0,Li-=Ti,Di-=ki,Ni-=Ti,$i-=ki;const xi=[[Li,Di,0,0,Vi-Ki],[Ni,$i,0,0,zi-Ki],[0,0,Li,Di,nr-er],[0,0,Ni,$i,Wi-er]],Mi=solveLinearSystem(xi);if(!Mi)return;if(di.save(),di.beginPath(),isBrokenDiagonalRendering()||!li){di.moveTo(Vi,nr);const Yi=4,sr=Ki-Vi,cr=er-nr;for(let ir=0;ir<Yi;ir++)di.lineTo(Vi+fi((ir+1)*sr/Yi),nr+fi(ir*cr/(Yi-1))),ir!=Yi-1&&di.lineTo(Vi+fi((ir+1)*sr/Yi),nr+fi((ir+1)*cr/(Yi-1)));di.lineTo(zi,Wi)}else di.moveTo(Vi,nr),di.lineTo(Ki,er),di.lineTo(zi,Wi);di.clip(),di.transform(Mi[0],Mi[2],Mi[1],Mi[3],Ki,er),di.translate(hi[0]-Ti,hi[3]-ki);let Ui;if(pi)Ui=pi.canvas,di.scale(vi,-vi);else{const Yi=si[0],sr=Yi.extent;Ui=Yi.image,di.scale(getWidth(sr)/Ui.width,-getHeight(sr)/Ui.height)}di.drawImage(Ui,0,0),di.restore()}),pi&&(releaseCanvas(pi),canvasPool$1.push(pi.canvas)),oi&&(di.save(),di.globalCompositeOperation="source-over",di.strokeStyle="black",di.lineWidth=1,ni.getTriangles().forEach(function(_i,Ai,Ei){const Si=_i.target,wi=(Si[0][0]-yi[0])/ii,Oi=-(Si[0][1]-yi[1])/ii,Ii=(Si[1][0]-yi[0])/ii,Li=-(Si[1][1]-yi[1])/ii,Di=(Si[2][0]-yi[0])/ii,Ni=-(Si[2][1]-yi[1])/ii;di.beginPath(),di.moveTo(Ii,Li),di.lineTo(wi,Oi),di.lineTo(Di,Ni),di.closePath(),di.stroke()}),di.restore()),di.canvas}const ImageState={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};class ImageWrapper extends Target{constructor(e,n,ei,ti){super(),this.extent=e,this.pixelRatio_=ei,this.resolution=n,this.state=typeof ti=="function"?ImageState.IDLE:ti,this.image_=null,this.loader=typeof ti=="function"?ti:null}changed(){this.dispatchEvent(EventType.CHANGE)}getExtent(){return this.extent}getImage(){return this.image_}getPixelRatio(){return this.pixelRatio_}getResolution(){return this.resolution}getState(){return this.state}load(){if(this.state==ImageState.IDLE&&this.loader){this.state=ImageState.LOADING,this.changed();const e=this.getResolution(),n=Array.isArray(e)?e[0]:e;toPromise(()=>this.loader(this.getExtent(),n,this.getPixelRatio())).then(ei=>{"image"in ei&&(this.image_=ei.image),"extent"in ei&&(this.extent=ei.extent),"resolution"in ei&&(this.resolution=ei.resolution),"pixelRatio"in ei&&(this.pixelRatio_=ei.pixelRatio),(ei instanceof HTMLImageElement||CREATE_IMAGE_BITMAP&&ei instanceof ImageBitmap||ei instanceof HTMLCanvasElement||ei instanceof HTMLVideoElement)&&(this.image_=ei),this.state=ImageState.LOADED}).catch(ei=>{this.state=ImageState.ERROR,console.error(ei)}).finally(()=>this.changed())}}setImage(e){this.image_=e}setResolution(e){this.resolution=e}}function listenImage(_t,e,n){const ei=_t;let ti=!0,ii=!1,ri=!1;const ni=[listenOnce(ei,EventType.LOAD,function(){ri=!0,ii||e()})];return ei.src&&IMAGE_DECODE?(ii=!0,ei.decode().then(function(){ti&&e()}).catch(function(si){ti&&(ri?e():n())})):ni.push(listenOnce(ei,EventType.ERROR,n)),function(){ti=!1,ni.forEach(unlistenByKey)}}function load(_t,e){return new Promise((n,ei)=>{function ti(){ri(),n(_t)}function ii(){ri(),ei(new Error("Image load error"))}function ri(){_t.removeEventListener("load",ti),_t.removeEventListener("error",ii)}_t.addEventListener("load",ti),_t.addEventListener("error",ii)})}function decodeFallback(_t,e){return e&&(_t.src=e),_t.src&&IMAGE_DECODE?new Promise((n,ei)=>_t.decode().then(()=>n(_t)).catch(ti=>_t.complete&&_t.width?n(_t):ei(ti))):load(_t)}function decode$2(_t,e){return e&&(_t.src=e),_t.src&&IMAGE_DECODE&&CREATE_IMAGE_BITMAP?_t.decode().then(()=>createImageBitmap(_t)).catch(n=>{if(_t.complete&&_t.width)return _t;throw n}):decodeFallback(_t)}class ImageTile extends Tile{constructor(e,n,ei,ti,ii,ri){super(e,n,ri),this.crossOrigin_=ti,this.src_=ei,this.key=ei,this.image_,WORKER_OFFSCREEN_CANVAS?this.image_=new OffscreenCanvas(1,1):(this.image_=new Image,ti!==null&&(this.image_.crossOrigin=ti)),this.unlisten_=null,this.tileLoadFunction_=ii}getImage(){return this.image_}setImage(e){this.image_=e,this.state=TileState.LOADED,this.unlistenImage_(),this.changed()}getCrossOrigin(){return this.crossOrigin_}handleImageError_(){this.state=TileState.ERROR,this.unlistenImage_(),this.image_=getBlankImage(),this.changed()}handleImageLoad_(){if(WORKER_OFFSCREEN_CANVAS)this.state=TileState.LOADED;else{const e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=TileState.LOADED:this.state=TileState.EMPTY}this.unlistenImage_(),this.changed()}load(){this.state==TileState.ERROR&&(this.state=TileState.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==TileState.IDLE&&(this.state=TileState.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=listenImage(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function getBlankImage(){const _t=createCanvasContext2D(1,1);return _t.fillStyle="rgba(0,0,0,0)",_t.fillRect(0,0,1,1),_t.canvas}const MAX_SUBDIVISION=10,MAX_TRIANGLE_WIDTH=.25;class Triangulation{constructor(e,n,ei,ti,ii,ri,ni){this.sourceProj_=e,this.targetProj_=n;let si={};const ai=ni?createTransformFromCoordinateTransform(vi=>apply(ni,transform$1(vi,this.targetProj_,this.sourceProj_))):getTransform(this.targetProj_,this.sourceProj_);this.transformInv_=function(vi){const yi=vi[0]+"/"+vi[1];return si[yi]||(si[yi]=ai(vi)),si[yi]},this.maxSourceExtent_=ti,this.errorThresholdSquared_=ii*ii,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!ti&&!!this.sourceProj_.getExtent()&&getWidth(ti)>=getWidth(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?getWidth(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?getWidth(this.targetProj_.getExtent()):null;const oi=getTopLeft(ei),li=getTopRight(ei),ci=getBottomRight(ei),ui=getBottomLeft(ei),di=this.transformInv_(oi),fi=this.transformInv_(li),hi=this.transformInv_(ci),pi=this.transformInv_(ui),gi=MAX_SUBDIVISION+(ri?Math.max(0,Math.ceil(Math.log2(getArea(ei)/(ri*ri*256*256)))):0);if(this.addQuad_(oi,li,ci,ui,di,fi,hi,pi,gi),this.wrapsXInSource_){let vi=1/0;this.triangles_.forEach(function(yi,_i,Ai){vi=Math.min(vi,yi.source[0][0],yi.source[1][0],yi.source[2][0])}),this.triangles_.forEach(yi=>{if(Math.max(yi.source[0][0],yi.source[1][0],yi.source[2][0])-vi>this.sourceWorldWidth_/2){const _i=[[yi.source[0][0],yi.source[0][1]],[yi.source[1][0],yi.source[1][1]],[yi.source[2][0],yi.source[2][1]]];_i[0][0]-vi>this.sourceWorldWidth_/2&&(_i[0][0]-=this.sourceWorldWidth_),_i[1][0]-vi>this.sourceWorldWidth_/2&&(_i[1][0]-=this.sourceWorldWidth_),_i[2][0]-vi>this.sourceWorldWidth_/2&&(_i[2][0]-=this.sourceWorldWidth_);const Ai=Math.min(_i[0][0],_i[1][0],_i[2][0]);Math.max(_i[0][0],_i[1][0],_i[2][0])-Ai<this.sourceWorldWidth_/2&&(yi.source=_i)}})}si={}}addTriangle_(e,n,ei,ti,ii,ri){this.triangles_.push({source:[ti,ii,ri],target:[e,n,ei]})}addQuad_(e,n,ei,ti,ii,ri,ni,si,ai){const oi=boundingExtent([ii,ri,ni,si]),li=this.sourceWorldWidth_?getWidth(oi)/this.sourceWorldWidth_:null,ci=this.sourceWorldWidth_,ui=this.sourceProj_.canWrapX()&&li>.5&&li<1;let di=!1;if(ai>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const hi=boundingExtent([e,n,ei,ti]);di=getWidth(hi)/this.targetWorldWidth_>MAX_TRIANGLE_WIDTH||di}!ui&&this.sourceProj_.isGlobal()&&li&&(di=li>MAX_TRIANGLE_WIDTH||di)}if(!di&&this.maxSourceExtent_&&isFinite(oi[0])&&isFinite(oi[1])&&isFinite(oi[2])&&isFinite(oi[3])&&!intersects$1(oi,this.maxSourceExtent_))return;let fi=0;if(!di&&(!isFinite(ii[0])||!isFinite(ii[1])||!isFinite(ri[0])||!isFinite(ri[1])||!isFinite(ni[0])||!isFinite(ni[1])||!isFinite(si[0])||!isFinite(si[1]))){if(ai>0)di=!0;else if(fi=(!isFinite(ii[0])||!isFinite(ii[1])?8:0)+(!isFinite(ri[0])||!isFinite(ri[1])?4:0)+(!isFinite(ni[0])||!isFinite(ni[1])?2:0)+(!isFinite(si[0])||!isFinite(si[1])?1:0),fi!=1&&fi!=2&&fi!=4&&fi!=8)return}if(ai>0){if(!di){const hi=[(e[0]+ei[0])/2,(e[1]+ei[1])/2],pi=this.transformInv_(hi);let gi;ui?gi=(modulo(ii[0],ci)+modulo(ni[0],ci))/2-modulo(pi[0],ci):gi=(ii[0]+ni[0])/2-pi[0];const vi=(ii[1]+ni[1])/2-pi[1];di=gi*gi+vi*vi>this.errorThresholdSquared_}if(di){if(Math.abs(e[0]-ei[0])<=Math.abs(e[1]-ei[1])){const hi=[(n[0]+ei[0])/2,(n[1]+ei[1])/2],pi=this.transformInv_(hi),gi=[(ti[0]+e[0])/2,(ti[1]+e[1])/2],vi=this.transformInv_(gi);this.addQuad_(e,n,hi,gi,ii,ri,pi,vi,ai-1),this.addQuad_(gi,hi,ei,ti,vi,pi,ni,si,ai-1)}else{const hi=[(e[0]+n[0])/2,(e[1]+n[1])/2],pi=this.transformInv_(hi),gi=[(ei[0]+ti[0])/2,(ei[1]+ti[1])/2],vi=this.transformInv_(gi);this.addQuad_(e,hi,gi,ti,ii,pi,vi,si,ai-1),this.addQuad_(hi,n,ei,gi,pi,ri,ni,vi,ai-1)}return}}if(ui){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(fi&11)==0&&this.addTriangle_(e,ei,ti,ii,ni,si),(fi&14)==0&&this.addTriangle_(e,ei,n,ii,ni,ri),fi&&((fi&13)==0&&this.addTriangle_(n,ti,e,ri,si,ii),(fi&7)==0&&this.addTriangle_(n,ti,ei,ri,si,ni))}calculateSourceExtent(){const e=createEmpty();return this.triangles_.forEach(function(n,ei,ti){const ii=n.source;extendCoordinate(e,ii[0]),extendCoordinate(e,ii[1]),extendCoordinate(e,ii[2])}),e}getTriangles(){return this.triangles_}}const ERROR_THRESHOLD=.5;class ReprojTile extends Tile{constructor(e,n,ei,ti,ii,ri,ni,si,ai,oi,li,ci){super(ii,TileState.IDLE,ci),this.renderEdges_=li!==void 0?li:!1,this.pixelRatio_=ni,this.gutter_=si,this.canvas_=null,this.sourceTileGrid_=n,this.targetTileGrid_=ti,this.wrappedTileCoord_=ri||ii,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=e.canWrapX()?e.getExtent():void 0;const ui=ti.getTileCoordExtent(this.wrappedTileCoord_),di=this.targetTileGrid_.getExtent();let fi=this.sourceTileGrid_.getExtent();const hi=di?getIntersection(ui,di):ui;if(getArea(hi)===0){this.state=TileState.EMPTY;return}const pi=e.getExtent();pi&&(fi?fi=getIntersection(fi,pi):fi=pi);const gi=ti.getResolution(this.wrappedTileCoord_[0]),vi=calculateSourceExtentResolution(e,ei,hi,gi);if(!isFinite(vi)||vi<=0){this.state=TileState.EMPTY;return}const yi=oi!==void 0?oi:ERROR_THRESHOLD;if(this.triangulation_=new Triangulation(e,ei,hi,fi,vi*yi,gi),this.triangulation_.getTriangles().length===0){this.state=TileState.EMPTY;return}this.sourceZ_=n.getZForResolution(vi);let _i=this.triangulation_.calculateSourceExtent();if(fi&&(e.canWrapX()?(_i[1]=clamp$1(_i[1],fi[1],fi[3]),_i[3]=clamp$1(_i[3],fi[1],fi[3])):_i=getIntersection(_i,fi)),!getArea(_i))this.state=TileState.EMPTY;else{let Ai=0,Ei=0;e.canWrapX()&&(Ai=getWidth(pi),Ei=Math.floor((_i[0]-pi[0])/Ai)),wrapAndSliceX(_i.slice(),e,!0).forEach(wi=>{const Oi=n.getTileRangeForExtentAndZ(wi,this.sourceZ_);for(let Ii=Oi.minX;Ii<=Oi.maxX;Ii++)for(let Li=Oi.minY;Li<=Oi.maxY;Li++){const Di=ai(this.sourceZ_,Ii,Li,ni);if(Di){const Ni=Ei*Ai;this.sourceTiles_.push({tile:Di,offset:Ni})}}++Ei}),this.sourceTiles_.length===0&&(this.state=TileState.EMPTY)}}getImage(){return this.canvas_}reproject_(){const e=[];if(this.sourceTiles_.forEach(n=>{var ti;const ei=n.tile;if(ei&&ei.getState()==TileState.LOADED){const ii=this.sourceTileGrid_.getTileCoordExtent(ei.tileCoord);ii[0]+=n.offset,ii[2]+=n.offset;const ri=(ti=this.clipExtent_)==null?void 0:ti.slice();ri&&(ri[0]+=n.offset,ri[2]+=n.offset),e.push({extent:ii,clipExtent:ri,image:ei.getImage()})}}),this.sourceTiles_.length=0,e.length===0)this.state=TileState.ERROR;else{const n=this.wrappedTileCoord_[0],ei=this.targetTileGrid_.getTileSize(n),ti=typeof ei=="number"?ei:ei[0],ii=typeof ei=="number"?ei:ei[1],ri=this.targetTileGrid_.getResolution(n),ni=this.sourceTileGrid_.getResolution(this.sourceZ_),si=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=render(ti,ii,this.pixelRatio_,ni,this.sourceTileGrid_.getExtent(),ri,si,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=TileState.LOADED}this.changed()}load(){if(this.state==TileState.IDLE){this.state=TileState.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:n})=>{const ei=n.getState();if(ei==TileState.IDLE||ei==TileState.LOADING){e++;const ti=listen(n,EventType.CHANGE,ii=>{const ri=n.getState();(ri==TileState.LOADED||ri==TileState.ERROR||ri==TileState.EMPTY)&&(unlistenByKey(ti),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(ti)}}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:n},ei,ti){n.getState()==TileState.IDLE&&n.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(unlistenByKey),this.sourcesListenerKeys_=null}release(){this.canvas_&&(releaseCanvas(this.canvas_.getContext("2d")),canvasPool$1.push(this.canvas_),this.canvas_=null),super.release()}}class TileImage extends UrlTile{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:defaultTileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate!==void 0?e.interpolate:!0,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,this.tileClass=e.tileClass!==void 0?e.tileClass:ImageTile,this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(e){return this.getProjection()&&e&&!equivalent$1(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getTileGridForProjection(e){const n=this.getProjection();if(this.tileGrid&&(!n||equivalent$1(n,e)))return this.tileGrid;const ei=getUid(e);return ei in this.tileGridForProjection||(this.tileGridForProjection[ei]=getForProjection(e)),this.tileGridForProjection[ei]}createTile_(e,n,ei,ti,ii,ri){const ni=[e,n,ei],si=this.getTileCoordForTileUrlFunction(ni,ii),ai=si?this.tileUrlFunction(si,ti,ii):void 0,oi=new this.tileClass(ni,ai!==void 0?TileState.IDLE:TileState.EMPTY,ai!==void 0?ai:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return oi.key=ri,oi.addEventListener(EventType.CHANGE,this.handleTileChange.bind(this)),oi}getTile(e,n,ei,ti,ii,ri){const ni=this.getProjection();if(!ni||!ii||equivalent$1(ni,ii))return this.getTileInternal(e,n,ei,ti,ni||ii);const si=[e,n,ei],ai=this.getKey(),oi=this.getTileGridForProjection(ni),li=this.getTileGridForProjection(ii),ci=this.getTileCoordForTileUrlFunction(si,ii),ui=new ReprojTile(ni,oi,ii,li,si,ci,this.getTilePixelRatio(ti),this.getGutter(),(di,fi,hi,pi)=>this.getTileInternal(di,fi,hi,pi,ni,ri),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return ui.key=ai,ui}getTileInternal(e,n,ei,ti,ii,ri){const ni=this.getKey(),si=getCacheKey$1(this,ni,e,n,ei);if(ri&&ri.containsKey(si))return ri.get(si);const ai=this.createTile_(e,n,ei,ti,ii,ni);return ri==null||ri.set(si,ai),ai}setRenderReprojectionEdges(e){this.renderReprojectionEdges_!=e&&(this.renderReprojectionEdges_=e,this.changed())}setTileGridForProjection(e,n){const ei=get$3(e);if(ei){const ti=getUid(ei);ti in this.tileGridForProjection||(this.tileGridForProjection[ti]=n)}}}function defaultTileLoadFunction(_t,e){if(WORKER_OFFSCREEN_CANVAS){const n=_t.getCrossOrigin();let ei="same-origin",ti="same-origin";n==="anonymous"||n===""?(ei="cors",ti="omit"):n==="use-credentials"&&(ei="cors",ti="include"),fetch(e,{mode:ei,credentials:ti}).then(ii=>{if(!ii.ok)throw new Error(`HTTP ${ii.status}`);return ii.blob()}).then(ii=>createImageBitmap(ii)).then(ii=>{var si;const ri=_t.getImage();ri.width=ii.width,ri.height=ii.height,ri.getContext("2d").drawImage(ii,0,0),(si=ii.close)==null||si.call(ii),ri.dispatchEvent(new Event("load"))}).catch(()=>{_t.getImage().dispatchEvent(new Event("error"))});return}_t.getImage().src=e}function fromResolutionLike(_t){return Array.isArray(_t)?Math.min(..._t):_t}class ReprojImage extends ImageWrapper{constructor(e,n,ei,ti,ii,ri,ni){let si=e.getExtent();si&&e.canWrapX()&&(si=si.slice(),si[0]=-1/0,si[2]=1/0);let ai=n.getExtent();ai&&n.canWrapX()&&(ai=ai.slice(),ai[0]=-1/0,ai[2]=1/0);const oi=ai?getIntersection(ei,ai):ei,li=getCenter(oi),ci=calculateSourceResolution(e,n,li,ti),ui=ERROR_THRESHOLD,di=new Triangulation(e,n,oi,si,ci*ui,ti),fi=di.calculateSourceExtent(),hi=isEmpty$1(fi)?null:ri(fi,ci,ii),pi=hi?ImageState.IDLE:ImageState.EMPTY,gi=hi?hi.getPixelRatio():1;super(ei,ti,gi,pi),this.targetProj_=n,this.maxSourceExtent_=si,this.triangulation_=di,this.targetResolution_=ti,this.targetExtent_=ei,this.sourceImage_=hi,this.sourcePixelRatio_=gi,this.interpolate_=ni,this.canvas_=null,this.sourceListenerKey_=null}disposeInternal(){this.state==ImageState.LOADING&&this.unlistenSource_(),super.disposeInternal()}getImage(){return this.canvas_}getProjection(){return this.targetProj_}reproject_(){const e=this.sourceImage_.getState();if(e==ImageState.LOADED){const n=getWidth(this.targetExtent_)/this.targetResolution_,ei=getHeight(this.targetExtent_)/this.targetResolution_;this.canvas_=render(n,ei,this.sourcePixelRatio_,fromResolutionLike(this.sourceImage_.getResolution()),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0,void 0,this.interpolate_,!0)}this.state=e,this.changed()}load(){if(this.state==ImageState.IDLE){this.state=ImageState.LOADING,this.changed();const e=this.sourceImage_.getState();e==ImageState.LOADED||e==ImageState.ERROR?this.reproject_():(this.sourceListenerKey_=listen(this.sourceImage_,EventType.CHANGE,n=>{const ei=this.sourceImage_.getState();(ei==ImageState.LOADED||ei==ImageState.ERROR)&&(this.unlistenSource_(),this.reproject_())}),this.sourceImage_.load())}}unlistenSource_(){unlistenByKey(this.sourceListenerKey_),this.sourceListenerKey_=null}}const DECIMALS=4,ImageSourceEventType={IMAGELOADSTART:"imageloadstart",IMAGELOADEND:"imageloadend",IMAGELOADERROR:"imageloaderror"};class ImageSourceEvent extends BaseEvent{constructor(e,n){super(e),this.image=n}}class ImageSource extends Source{constructor(e){super({attributions:e.attributions,projection:e.projection,state:e.state,interpolate:e.interpolate!==void 0?e.interpolate:!0}),this.on,this.once,this.un,this.loader=e.loader||null,this.resolutions_=e.resolutions!==void 0?e.resolutions:null,this.reprojectedImage_=null,this.reprojectedRevision_=0,this.image=null,this.wantedExtent_,this.wantedResolution_,this.static_=e.loader?e.loader.length===0:!1,this.wantedProjection_=null}getResolutions(){return this.resolutions_}setResolutions(e){this.resolutions_=e}findNearestResolution(e){const n=this.getResolutions();if(n){const ei=linearFindNearest(n,e,0);e=n[ei]}return e}getImage(e,n,ei,ti){const ii=this.getProjection();if(!ii||!ti||equivalent$1(ii,ti))return ii&&(ti=ii),this.getImageInternal(e,n,ei,ti);if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&equivalent$1(this.reprojectedImage_.getProjection(),ti)&&this.reprojectedImage_.getResolution()==n&&equals$1(this.reprojectedImage_.getExtent(),e))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new ReprojImage(ii,ti,e,n,ei,(ri,ni,si)=>this.getImageInternal(ri,ni,si,ii),this.getInterpolate()),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}getImageInternal(e,n,ei,ti){if(this.loader){const ii=getRequestExtent(e,n,ei,1),ri=this.findNearestResolution(n);if(this.image&&(this.static_||this.wantedProjection_===ti&&(this.wantedExtent_&&containsExtent(this.wantedExtent_,ii)||containsExtent(this.image.getExtent(),ii))&&(this.wantedResolution_&&fromResolutionLike(this.wantedResolution_)===ri||fromResolutionLike(this.image.getResolution())===ri)))return this.image;this.wantedProjection_=ti,this.wantedExtent_=ii,this.wantedResolution_=ri,this.image=new ImageWrapper(ii,ri,ei,this.loader),this.image.addEventListener(EventType.CHANGE,this.handleImageChange.bind(this))}return this.image}handleImageChange(e){const n=e.target;let ei;switch(n.getState()){case ImageState.LOADING:this.loading=!0,ei=ImageSourceEventType.IMAGELOADSTART;break;case ImageState.LOADED:this.loading=!1,ei=ImageSourceEventType.IMAGELOADEND;break;case ImageState.ERROR:this.loading=!1,ei=ImageSourceEventType.IMAGELOADERROR;break;default:return}this.hasListener(ei)&&this.dispatchEvent(new ImageSourceEvent(ei,n))}}function defaultImageLoadFunction(_t,e){_t.getImage().src=e}function getRequestExtent(_t,e,n,ei){const ti=e/n,ii=getCenter(_t),ri=ceil(getWidth(_t)/ti,DECIMALS),ni=ceil(getHeight(_t)/ti,DECIMALS),si=ceil((ei-1)*ri/2,DECIMALS),ai=ri+2*si,oi=ceil((ei-1)*ni/2,DECIMALS),li=ni+2*oi;return getForViewAndSize(ii,ti,0,[ai,li])}const DEFAULT_VERSION="1.3.0",GETFEATUREINFO_IMAGE_SIZE=[101,101];function getRequestUrl(_t,e,n,ei,ti){ti.WIDTH=n[0],ti.HEIGHT=n[1];const ii=ei.getAxisOrientation(),ri=compareVersions(ti.VERSION,"1.3")>=0;ti[ri?"CRS":"SRS"]=ei.getCode();const ni=ri&&ii.startsWith("ne")?[e[1],e[0],e[3],e[2]]:e;return ti.BBOX=ni.join(","),appendParams(_t,ti)}function getImageSrc(_t,e,n,ei,ti,ii,ri){ii=Object.assign({REQUEST:"GetMap"},ii);const ni=e/n,si=[round(getWidth(_t)/ni,DECIMALS),round(getHeight(_t)/ni,DECIMALS)];if(n!=1)switch(ri){case"geoserver":const oi=90*n+.5|0;"FORMAT_OPTIONS"in ii?ii.FORMAT_OPTIONS+=";dpi:"+oi:ii.FORMAT_OPTIONS="dpi:"+oi;break;case"mapserver":ii.MAP_RESOLUTION=90*n;break;case"carmentaserver":case"qgis":ii.DPI=90*n;break;default:throw new Error("Unknown `serverType` configured")}return getRequestUrl(ti,_t,si,ei,ii)}function getRequestParams(_t,e){return Object.assign({REQUEST:e,SERVICE:"WMS",VERSION:DEFAULT_VERSION,FORMAT:"image/png",STYLES:"",TRANSPARENT:"TRUE"},_t)}function createLoader(_t){const e=_t.hidpi===void 0?!0:_t.hidpi,n=get$3(_t.projection||"EPSG:3857"),ei=_t.ratio||1.5,ti=_t.load||decode$2,ii=_t.crossOrigin??null;return(ri,ni,si)=>{ri=getRequestExtent(ri,ni,si,ei),si!=1&&(!e||_t.serverType===void 0)&&(si=1);const ai=getImageSrc(ri,ni,si,n,_t.url,getRequestParams(_t.params,"GetMap"),_t.serverType),oi=new Image;return oi.crossOrigin=ii,ti(oi,ai).then(li=>({image:li,extent:ri,pixelRatio:si}))}}function getFeatureInfoUrl(_t,e,n){if(_t.url===void 0)return;const ei=get$3(_t.projection||"EPSG:3857"),ti=getForViewAndSize(e,n,0,GETFEATUREINFO_IMAGE_SIZE),ii={QUERY_LAYERS:_t.params.LAYERS,INFO_FORMAT:"application/json"};Object.assign(ii,getRequestParams(_t.params,"GetFeatureInfo"),_t.params);const ri=floor((e[0]-ti[0])/n,DECIMALS),ni=floor((ti[3]-e[1])/n,DECIMALS),si=compareVersions(ii.VERSION,"1.3")>=0;return ii[si?"I":"X"]=ri,ii[si?"J":"Y"]=ni,getRequestUrl(_t.url,ti,GETFEATUREINFO_IMAGE_SIZE,ei,ii)}function getLegendUrl(_t,e){if(_t.url===void 0)return;const n={SERVICE:"WMS",VERSION:DEFAULT_VERSION,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(e!==void 0){const ei=get$3(_t.projection||"EPSG:3857").getMetersPerUnit()||1,ti=28e-5;n.SCALE=e*ei/ti}if(Object.assign(n,_t.params),_t.params!==void 0&&n.LAYER===void 0){const ei=n.LAYERS;if(!(!Array.isArray(ei)||ei.length!==1))return;n.LAYER=ei}return appendParams(_t.url,n)}class TileWMS extends TileImage{constructor(e){e=e||{};const n=Object.assign({},e.params);super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:e.tileClass,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0,this.params_=n,this.v13_=!0,this.serverType_=e.serverType,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.tmpExtent_=createEmpty(),this.updateV13_(),this.setKey(this.getKeyForParams_())}getFeatureInfoUrl(e,n,ei,ti){const ii=get$3(ei),ri=this.getProjection()||ii;let ni=this.getTileGrid();ni||(ni=this.getTileGridForProjection(ri));const si=transform$1(e,ii,ri),ai=calculateSourceResolution(ri,ii,e,n),oi=ni.getZForResolution(ai,this.zDirection),li=ni.getResolution(oi),ci=ni.getTileCoordForCoordAndZ(si,oi);if(ni.getResolutions().length<=ci[0])return;let ui=ni.getTileCoordExtent(ci,this.tmpExtent_);const di=this.gutter_;di!==0&&(ui=buffer(ui,li*di,ui));const fi={QUERY_LAYERS:this.params_.LAYERS};Object.assign(fi,getRequestParams(this.params_,"GetFeatureInfo"),ti);const hi=Math.floor((si[0]-ui[0])/li),pi=Math.floor((ui[3]-si[1])/li);return fi[this.v13_?"I":"X"]=hi,fi[this.v13_?"J":"Y"]=pi,this.getRequestUrl_(ci,ui,1,ri||ii,fi)}getLegendUrl(e,n){if(this.urls[0]===void 0)return;const ei={SERVICE:"WMS",VERSION:DEFAULT_VERSION,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(n===void 0||n.LAYER===void 0){const ti=this.params_.LAYERS;if(!(!Array.isArray(ti)||ti.length===1))return;ei.LAYER=ti}if(e!==void 0){const ti=this.getProjection()?this.getProjection().getMetersPerUnit():1,ii=28e-5;ei.SCALE=e*ti/ii}return Object.assign(ei,n),appendParams(this.urls[0],ei)}getGutter(){return this.gutter_}getParams(){return this.params_}getRequestUrl_(e,n,ei,ti,ii){const ri=this.urls;if(!ri)return;let ni;if(ri.length==1)ni=ri[0];else{const si=modulo(hash(e),ri.length);ni=ri[si]}return getImageSrc(n,(this.tileGrid||this.getTileGridForProjection(ti)).getResolution(e[0]),ei,ti,ni,ii,this.serverType_)}getTilePixelRatio(e){return!this.hidpi_||this.serverType_===void 0?1:e}getKeyForParams_(){let e=0;const n=[];for(const ei in this.params_)n[e++]=ei+"-"+this.params_[ei];return n.join("/")}setParams_(e){this.params_=e,this.updateV13_(),this.setKey(this.getKeyForParams_())}setParams(e){this.setParams_(Object.assign({},e))}updateParams(e){this.setParams_(Object.assign(this.params_,e))}updateV13_(){const e=this.params_.VERSION||DEFAULT_VERSION;this.v13_=compareVersions(e,"1.3")>=0}tileUrlFunction(e,n,ei){let ti=this.getTileGrid();if(ti||(ti=this.getTileGridForProjection(ei)),ti.getResolutions().length<=e[0])return;n!=1&&(!this.hidpi_||this.serverType_===void 0)&&(n=1);const ii=ti.getResolution(e[0]);let ri=ti.getTileCoordExtent(e,this.tmpExtent_);const ni=this.gutter_;ni!==0&&(ri=buffer(ri,ii*ni,ri));const si=Object.assign({},getRequestParams(this.params_,"GetMap"));return this.getRequestUrl_(e,ri,n,ei,si)}}let WMTS$1=class extends TileImage{constructor(e){const n=e.requestEncoding!==void 0?e.requestEncoding:"KVP",ei=e.tileGrid;let ti=e.urls;ti===void 0&&e.url!==void 0&&(ti=expandUrl(e.url)),super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:e.tileClass,tileGrid:ei,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,urls:ti,wrapX:e.wrapX!==void 0?e.wrapX:!1,transition:e.transition,zDirection:e.zDirection}),this.version_=e.version!==void 0?e.version:"1.0.0",this.format_=e.format!==void 0?e.format:"image/jpeg",this.dimensions_=e.dimensions!==void 0?e.dimensions:{},this.layer_=e.layer,this.matrixSet_=e.matrixSet,this.style_=e.style,this.requestEncoding_=n,this.setKey(this.getKeyForDimensions_()),ti&&ti.length>0&&(this.tileUrlFunction=createFromTileUrlFunctions(ti.map(this.createFromWMTSTemplate.bind(this))))}setUrls(e){this.urls=e;const n=e.join(`
`);this.setTileUrlFunction(createFromTileUrlFunctions(e.map(this.createFromWMTSTemplate.bind(this))),n)}getDimensions(){return this.dimensions_}getFormat(){return this.format_}getLayer(){return this.layer_}getMatrixSet(){return this.matrixSet_}getRequestEncoding(){return this.requestEncoding_}getStyle(){return this.style_}getVersion(){return this.version_}getKeyForDimensions_(){const e=this.urls?this.urls.slice(0):[];for(const n in this.dimensions_)e.push(n+"-"+this.dimensions_[n]);return e.join("/")}updateDimensions(e){Object.assign(this.dimensions_,e),this.setKey(this.getKeyForDimensions_())}createFromWMTSTemplate(e){const n=this.requestEncoding_,ei={layer:this.layer_,style:this.style_,tilematrixset:this.matrixSet_};n=="KVP"&&Object.assign(ei,{Service:"WMTS",Request:"GetTile",Version:this.version_,Format:this.format_}),e=n=="KVP"?appendParams(e,ei):e.replace(/\{(\w+?)\}/g,function(ri,ni){return ni.toLowerCase()in ei?ei[ni.toLowerCase()]:ri});const ti=this.tileGrid,ii=this.dimensions_;return(function(ri,ni,si){if(!ri)return;const ai={TileMatrix:ti.getMatrixId(ri[0]),TileCol:ri[1],TileRow:ri[2]};Object.assign(ai,ii);let oi=e;return n=="KVP"?oi=appendParams(oi,ai):oi=oi.replace(/\{(\w+?)\}/g,function(li,ci){return encodeURIComponent(ai[ci])}),oi})}};class ImageWMS extends ImageSource{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:e.interpolate,projection:e.projection,resolutions:e.resolutions}),this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null,this.url_=e.url,this.imageLoadFunction_=e.imageLoadFunction!==void 0?e.imageLoadFunction:defaultImageLoadFunction,this.params_=Object.assign({},e.params),this.serverType_=e.serverType,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.renderedRevision_=0,this.ratio_=e.ratio!==void 0?e.ratio:1.5,this.loaderProjection_=null}getFeatureInfoUrl(e,n,ei,ti){const ii=get$3(ei),ri=this.getProjection();ri&&ri!==ii&&(n=calculateSourceResolution(ri,ii,e,n),e=transform$1(e,ii,ri));const ni={url:this.url_,params:{...this.params_,...ti},projection:ri||ii};return getFeatureInfoUrl(ni,e,n)}getLegendUrl(e,n){return getLegendUrl({url:this.url_,params:{...this.params_,...n}},e)}getParams(){return this.params_}getImageInternal(e,n,ei,ti){return this.url_===void 0?null:((!this.loader||this.loaderProjection_!==ti)&&(this.loaderProjection_=ti,this.loader=createLoader({crossOrigin:this.crossOrigin_,params:this.params_,projection:ti,serverType:this.serverType_,hidpi:this.hidpi_,url:this.url_,ratio:this.ratio_,load:(ii,ri)=>(this.image.setImage(ii),this.imageLoadFunction_(this.image,ri),decode$2(ii))})),super.getImageInternal(e,n,ei,ti))}getImageLoadFunction(){return this.imageLoadFunction_}getUrl(){return this.url_}setImageLoadFunction(e){this.imageLoadFunction_=e,this.changed()}setUrl(e){e!=this.url_&&(this.url_=e,this.loader=null,this.changed())}setParams(e){this.params_=Object.assign({},e),this.changed()}updateParams(e){Object.assign(this.params_,e),this.changed()}changed(){this.image=null,super.changed()}}const MapBrowserEventType={SINGLECLICK:"singleclick",CLICK:EventType.CLICK,DBLCLICK:EventType.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},InteractionProperty={ACTIVE:"active"};class Interaction extends BaseObject{constructor(e){super(),this.on,this.once,this.un,e&&e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(InteractionProperty.ACTIVE)}getMap(){return this.map_}handleEvent(e){return!0}setActive(e){this.set(InteractionProperty.ACTIVE,e)}setMap(e){this.map_=e}}function pan(_t,e,n){const ei=_t.getCenterInternal();if(ei){const ti=[ei[0]+e[0],ei[1]+e[1]];_t.animateInternal({duration:n!==void 0?n:250,easing:linear,center:_t.getConstrainedCenter(ti)})}}function zoomByDelta(_t,e,n,ei){const ti=_t.getZoom();if(ti===void 0)return;const ii=_t.getConstrainedZoom(ti+e),ri=_t.getResolutionForZoom(ii);_t.getAnimating()&&_t.cancelAnimations(),_t.animate({resolution:ri,anchor:n,duration:ei!==void 0?ei:250,easing:easeOut})}class DoubleClickZoom extends Interaction{constructor(e){super(),e=e||{},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:250}handleEvent(e){let n=!1;if(e.type==MapBrowserEventType.DBLCLICK){const ei=e.originalEvent,ti=e.map,ii=e.coordinate,ri=ei.shiftKey?-this.delta_:this.delta_,ni=ti.getView();zoomByDelta(ni,ri,ii,this.duration_),ei.preventDefault(),n=!0}return!n}}function all(_t){const e=arguments;return function(n){let ei=!0;for(let ti=0,ii=e.length;ti<ii&&(ei=ei&&e[ti](n),!!ei);++ti);return ei}}const altKeyOnly=function(_t){const e=_t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},altShiftKeysOnly=function(_t){const e=_t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},focus=function(_t){const e=_t.map.getTargetElement(),n=e.getRootNode(),ei=_t.map.getOwnerDocument().activeElement;return n instanceof ShadowRoot?n.host.contains(ei):e.contains(ei)},focusWithTabindex=function(_t){const e=_t.map.getTargetElement(),n=e.getRootNode();return(n instanceof ShadowRoot?n.host:e).hasAttribute("tabindex")?focus(_t):!0},always$1=TRUE,mouseActionButton=function(_t){const e=_t.originalEvent;return"pointerId"in e&&e.button==0&&!(WEBKIT&&MAC&&e.ctrlKey)},never=FALSE,pointerMove=function(_t){return _t.type=="pointermove"},singleClick=function(_t){return _t.type==MapBrowserEventType.SINGLECLICK},noModifierKeys=function(_t){const e=_t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},platformModifierKey=function(_t){const e=_t.originalEvent;return MAC?e.metaKey:e.ctrlKey},shiftKeyOnly=function(_t){const e=_t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},targetNotEditable=function(_t){const e=_t.originalEvent,n=e.target.tagName;return n!=="INPUT"&&n!=="SELECT"&&n!=="TEXTAREA"&&!e.target.isContentEditable},mouseOnly=function(_t){const e=_t.originalEvent;return"pointerId"in e&&e.pointerType=="mouse"},primaryAction=function(_t){const e=_t.originalEvent;return"pointerId"in e&&e.isPrimary&&e.button===0};class RenderBox extends Disposable{constructor(e){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const e=this.startPixel_,n=this.endPixel_,ei="px",ti=this.element_.style;ti.left=Math.min(e[0],n[0])+ei,ti.top=Math.min(e[1],n[1])+ei,ti.width=Math.abs(n[0]-e[0])+ei,ti.height=Math.abs(n[1]-e[1])+ei}setMap(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const n=this.element_.style;n.left="inherit",n.top="inherit",n.width="inherit",n.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(e,n){this.startPixel_=e,this.endPixel_=n,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const e=this.startPixel_,n=this.endPixel_,ti=[e,[e[0],n[1]],n,[n[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);ti[4]=ti[0].slice(),this.geometry_?this.geometry_.setCoordinates([ti]):this.geometry_=new Polygon([ti])}getGeometry(){return this.geometry_}}class PointerInteraction extends Interaction{constructor(e){e=e||{},super(e),e.handleDownEvent&&(this.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(this.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(this.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(this.handleUpEvent=e.handleUpEvent),e.stopDown&&(this.stopDown=e.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(e){return!1}handleDragEvent(e){}handleEvent(e){if(!e.originalEvent)return!0;let n=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==MapBrowserEventType.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==MapBrowserEventType.POINTERUP){const ei=this.handleUpEvent(e);this.handlingDownUpSequence=ei&&this.targetPointers.length>0}}else if(e.type==MapBrowserEventType.POINTERDOWN){const ei=this.handleDownEvent(e);this.handlingDownUpSequence=ei,n=this.stopDown(ei)}else e.type==MapBrowserEventType.POINTERMOVE&&this.handleMoveEvent(e);return!n}handleMoveEvent(e){}handleUpEvent(e){return!1}stopDown(e){return e}updateTrackedPointers_(e){e.activePointers&&(this.targetPointers=e.activePointers)}}function centroid(_t){const e=_t.length;let n=0,ei=0;for(let ti=0;ti<e;ti++)n+=_t[ti].clientX,ei+=_t[ti].clientY;return{clientX:n/e,clientY:ei/e}}const DragBoxEventType={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class DragBoxEvent extends BaseEvent{constructor(e,n,ei){super(e),this.coordinate=n,this.mapBrowserEvent=ei}}class DragBox extends PointerInteraction{constructor(e){super(),this.on,this.once,this.un,e=e??{},this.box_=new RenderBox(e.className||"ol-dragbox"),this.minArea_=e.minArea??64,e.onBoxEnd&&(this.onBoxEnd=e.onBoxEnd),this.startPixel_=null,this.condition_=e.condition??mouseActionButton,this.boxEndCondition_=e.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(e,n,ei){const ti=ei[0]-n[0],ii=ei[1]-n[1];return ti*ti+ii*ii>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(e){this.startPixel_&&(this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new DragBoxEvent(DragBoxEventType.BOXDRAG,e.coordinate,e)))}handleUpEvent(e){if(!this.startPixel_)return!1;const n=this.boxEndCondition_(e,this.startPixel_,e.pixel);return n&&this.onBoxEnd(e),this.dispatchEvent(new DragBoxEvent(n?DragBoxEventType.BOXEND:DragBoxEventType.BOXCANCEL,e.coordinate,e)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(e){return this.condition_(e)?(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new DragBoxEvent(DragBoxEventType.BOXSTART,e.coordinate,e)),!0):!1}onBoxEnd(e){}setActive(e){e||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new DragBoxEvent(DragBoxEventType.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(e)}setMap(e){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new DragBoxEvent(DragBoxEventType.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(e)}}class DragPan extends PointerInteraction{constructor(e){super({stopDown:FALSE}),e=e||{},this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const n=e.condition?e.condition:all(noModifierKeys,primaryAction);this.condition_=e.onFocusOnly?all(focusWithTabindex,n):n,this.noKinetic_=!1}handleDragEvent(e){const n=e.map;this.panning_||(this.panning_=!0,n.getView().beginInteraction());const ei=this.targetPointers,ti=n.getEventPixel(centroid(ei));if(ei.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(ti[0],ti[1]),this.lastCentroid){const ii=[this.lastCentroid[0]-ti[0],ti[1]-this.lastCentroid[1]],ni=e.map.getView();scale$3(ii,ni.getResolution()),rotate$1(ii,ni.getRotation()),ni.adjustCenterInternal(ii)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=ti,this.lastPointersCount_=ei.length,e.originalEvent.preventDefault()}handleUpEvent(e){const n=e.map,ei=n.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const ti=this.kinetic_.getDistance(),ii=this.kinetic_.getAngle(),ri=ei.getCenterInternal(),ni=n.getPixelFromCoordinateInternal(ri),si=n.getCoordinateFromPixelInternal([ni[0]-ti*Math.cos(ii),ni[1]-ti*Math.sin(ii)]);ei.animateInternal({center:ei.getConstrainedCenter(si),duration:500,easing:easeOut})}return this.panning_&&(this.panning_=!1,ei.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(e){if(this.targetPointers.length>0&&this.condition_(e)){const ei=e.map.getView();return this.lastCentroid=null,ei.getAnimating()&&ei.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}function disable(_t){if(_t!==void 0)return 0}function none$1(_t){if(_t!==void 0)return _t}function createSnapToN(_t){const e=2*Math.PI/_t;return(function(n,ei){if(ei)return n;if(n!==void 0)return n=Math.floor(n/e+.5)*e,n})}function createSnapToZero(_t){const e=toRadians(5);return(function(n,ei){return ei||n===void 0?n:Math.abs(n)<=e?0:n})}class DragRotate extends PointerInteraction{constructor(e){e=e||{},super({stopDown:FALSE}),this.condition_=e.condition?e.condition:altShiftKeysOnly,this.lastAngle_=void 0,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){if(!mouseOnly(e))return;const n=e.map,ei=n.getView();if(ei.getConstraints().rotation===disable)return;const ti=n.getSize(),ii=e.pixel,ri=Math.atan2(ti[1]/2-ii[1],ii[0]-ti[0]/2);if(this.lastAngle_!==void 0){const ni=ri-this.lastAngle_;ei.adjustRotationInternal(-ni)}this.lastAngle_=ri}handleUpEvent(e){return mouseOnly(e)?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){return mouseOnly(e)&&mouseActionButton(e)&&this.condition_(e)?(e.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class DragZoom extends DragBox{constructor(e){e=e||{};const n=e.condition?e.condition:shiftKeyOnly;super({condition:n,className:e.className||"ol-dragzoom",minArea:e.minArea}),this.duration_=e.duration!==void 0?e.duration:200,this.out_=e.out!==void 0?e.out:!1}onBoxEnd(e){const ei=this.getMap().getView();let ti=this.getGeometry();if(this.out_){const ii=ei.rotatedExtentForGeometry(ti),ri=ei.getResolutionForExtentInternal(ii),ni=ei.getResolution()/ri;ti=ti.clone(),ti.scale(ni*ni)}ei.fitInternal(ti,{duration:this.duration_,easing:easeOut})}}class MapEvent extends BaseEvent{constructor(e,n,ei){super(e),this.map=n,this.frameState=ei!==void 0?ei:null}}class MapBrowserEvent extends MapEvent{constructor(e,n,ei,ti,ii,ri){super(e,n,ii),this.originalEvent=ei,this.pixel_=null,this.coordinate_=null,this.dragging=ti!==void 0?ti:!1,this.activePointers=ri}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(e){this.pixel_=e}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(e){this.coordinate_=e}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const ViewHint={ANIMATING:0,INTERACTING:1},RenderEventType={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},NO_COLOR=[NaN,NaN,NaN,0];let colorParseContext;function getColorParseContext(){return colorParseContext||(colorParseContext=createCanvasContext2D(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),colorParseContext}const rgbModernRegEx=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,rgbLegacyAbsoluteRegEx=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,rgbLegacyPercentageRegEx=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,hexRegEx=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function toColorComponent(_t,e){return _t.endsWith("%")?Number(_t.substring(0,_t.length-1))/e:Number(_t)}function throwInvalidColor(_t){throw new Error('failed to parse "'+_t+'" as color')}function parseRgba(_t){if(_t.toLowerCase().startsWith("rgb")){const ii=_t.match(rgbLegacyAbsoluteRegEx)||_t.match(rgbModernRegEx)||_t.match(rgbLegacyPercentageRegEx);if(ii){const ri=ii[4],ni=100/255;return[clamp$1(toColorComponent(ii[1],ni)+.5|0,0,255),clamp$1(toColorComponent(ii[2],ni)+.5|0,0,255),clamp$1(toColorComponent(ii[3],ni)+.5|0,0,255),ri!==void 0?clamp$1(toColorComponent(ri,100),0,1):1]}throwInvalidColor(_t)}if(_t.startsWith("#")){if(hexRegEx.test(_t)){const ii=_t.substring(1),ri=ii.length<=4?1:2,ni=[0,0,0,255];for(let si=0,ai=ii.length;si<ai;si+=ri){let oi=parseInt(ii.substring(si,si+ri),16);ri===1&&(oi+=oi<<4),ni[si/ri]=oi}return ni[3]=ni[3]/255,ni}throwInvalidColor(_t)}const e=getColorParseContext();e.fillStyle="#abcdef";let n=e.fillStyle;e.fillStyle=_t,e.fillStyle===n&&(e.fillStyle="#fedcba",n=e.fillStyle,e.fillStyle=_t,e.fillStyle===n&&throwInvalidColor(_t));const ei=e.fillStyle;if(ei.startsWith("#")||ei.startsWith("rgba"))return parseRgba(ei);e.clearRect(0,0,1,1),e.fillRect(0,0,1,1);const ti=Array.from(e.getImageData(0,0,1,1).data);return ti[3]=toFixed(ti[3]/255,3),ti}function asString(_t){return typeof _t=="string"?_t:toString$1(_t)}const MAX_CACHE_SIZE=1024,cache={};let cacheSize=0;function withAlpha(_t){if(_t.length===4)return _t;const e=_t.slice();return e[3]=1,e}function b1(_t){return _t>.0031308?Math.pow(_t,1/2.4)*269.025-14.025:_t*3294.6}function b2(_t){return _t>.2068965?Math.pow(_t,3):(_t-4/29)*(108/841)}function a1(_t){return _t>10.314724?Math.pow((_t+14.025)/269.025,2.4):_t/3294.6}function a2(_t){return _t>.0088564?Math.pow(_t,1/3):_t/(108/841)+4/29}function rgbaToLcha(_t){const e=a1(_t[0]),n=a1(_t[1]),ei=a1(_t[2]),ti=a2(e*.222488403+n*.716873169+ei*.06060791),ii=500*(a2(e*.452247074+n*.399439023+ei*.148375274)-ti),ri=200*(ti-a2(e*.016863605+n*.117638439+ei*.865350722)),ni=Math.atan2(ri,ii)*(180/Math.PI);return[116*ti-16,Math.sqrt(ii*ii+ri*ri),ni<0?ni+360:ni,_t[3]]}function lchaToRgba(_t){const e=(_t[0]+16)/116,n=_t[1],ei=_t[2]*Math.PI/180,ti=b2(e),ii=b2(e+n/500*Math.cos(ei)),ri=b2(e-n/200*Math.sin(ei)),ni=b1(ii*3.021973625-ti*1.617392459-ri*.404875592),si=b1(ii*-.943766287+ti*1.916279586+ri*.027607165),ai=b1(ii*.069407491-ti*.22898585+ri*1.159737864);return[clamp$1(ni+.5|0,0,255),clamp$1(si+.5|0,0,255),clamp$1(ai+.5|0,0,255),_t[3]]}function fromString(_t){if(_t==="none")return NO_COLOR;if(cache.hasOwnProperty(_t))return cache[_t];if(cacheSize>=MAX_CACHE_SIZE){let n=0;for(const ei in cache)(n++&3)===0&&(delete cache[ei],--cacheSize)}const e=parseRgba(_t);e.length!==4&&throwInvalidColor(_t);for(const n of e)isNaN(n)&&throwInvalidColor(_t);return cache[_t]=e,++cacheSize,e}function asArray(_t){return Array.isArray(_t)?_t:fromString(_t)}function toString$1(_t){let e=_t[0];e!=(e|0)&&(e=e+.5|0);let n=_t[1];n!=(n|0)&&(n=n+.5|0);let ei=_t[2];ei!=(ei|0)&&(ei=ei+.5|0);const ti=_t[3]===void 0?1:Math.round(_t[3]*1e3)/1e3;return"rgba("+e+","+n+","+ei+","+ti+")"}class IconImageCache{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let e=0;for(const n in this.cache_){const ei=this.cache_[n];(e++&3)===0&&!ei.hasListener()&&(delete this.cache_[n],delete this.patternCache_[n],--this.cacheSize_)}}}get(e,n,ei){const ti=getCacheKey(e,n,ei);return ti in this.cache_?this.cache_[ti]:null}getPattern(e,n,ei){const ti=getCacheKey(e,n,ei);return ti in this.patternCache_?this.patternCache_[ti]:null}set(e,n,ei,ti,ii){const ri=getCacheKey(e,n,ei),ni=ri in this.cache_;this.cache_[ri]=ti,ii&&(ti.getImageState()===ImageState.IDLE&&ti.load(),ti.getImageState()===ImageState.LOADING?ti.ready().then(()=>{this.patternCache_[ri]=getSharedCanvasContext2D().createPattern(ti.getImage(1),"repeat")}):this.patternCache_[ri]=getSharedCanvasContext2D().createPattern(ti.getImage(1),"repeat")),ni||++this.cacheSize_}setSize(e){this.maxCacheSize_=e,this.expire()}}function getCacheKey(_t,e,n){const ei=n?asArray(n):"null";return e+":"+_t+":"+ei}const shared=new IconImageCache;let taintedTestContext=null;class IconImage extends Target{constructor(e,n,ei,ti,ii){super(),this.hitDetectionImage_=null,this.image_=e,this.crossOrigin_=ei,this.canvas_={},this.color_=ii,this.imageState_=ti===void 0?ImageState.IDLE:ti,this.size_=e&&e.width&&e.height?[e.width,e.height]:null,this.src_=n,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===ImageState.LOADED){taintedTestContext||(taintedTestContext=createCanvasContext2D(1,1,void 0,{willReadFrequently:!0})),taintedTestContext.drawImage(this.image_,0,0);try{taintedTestContext.getImageData(0,0,1,1),this.tainted_=!1}catch{taintedTestContext=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(EventType.CHANGE)}handleImageError_(){this.imageState_=ImageState.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=ImageState.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}getPixelRatio(e){return this.replaceColor_(e),this.canvas_[e]?e:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const e=this.size_[0],n=this.size_[1],ei=createCanvasContext2D(e,n);ei.fillRect(0,0,e,n),this.hitDetectionImage_=ei.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===ImageState.IDLE){this.image_||this.initializeImage_(),this.imageState_=ImageState.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&decodeFallback(this.image_,this.src_).then(e=>{this.image_=e,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(e){if(!this.color_||this.canvas_[e]||this.imageState_!==ImageState.LOADED)return;const n=this.image_,ei=createCanvasContext2D(Math.ceil(n.width*e),Math.ceil(n.height*e)),ti=ei.canvas;ei.scale(e,e),ei.drawImage(n,0,0),ei.globalCompositeOperation="multiply",ei.fillStyle=asString(this.color_),ei.fillRect(0,0,ti.width/e,ti.height/e),ei.globalCompositeOperation="destination-in",ei.drawImage(n,0,0),this.canvas_[e]=ti}ready(){return this.ready_||(this.ready_=new Promise(e=>{if(this.imageState_===ImageState.LOADED||this.imageState_===ImageState.ERROR)e();else{const n=()=>{(this.imageState_===ImageState.LOADED||this.imageState_===ImageState.ERROR)&&(this.removeEventListener(EventType.CHANGE,n),e())};this.addEventListener(EventType.CHANGE,n)}})),this.ready_}}function get$2(_t,e,n,ei,ti,ii){let ri=e===void 0?void 0:shared.get(e,n,ti);return ri||(ri=new IconImage(_t,_t&&"src"in _t?_t.src||void 0:e,n,ei,ti),shared.set(e,n,ti,ri,ii)),ii&&ri&&!shared.getPattern(e,n,ti)&&shared.set(e,n,ti,ri,ii),ri}function asColorLike(_t){return _t?Array.isArray(_t)?toString$1(_t):typeof _t=="object"&&"src"in _t?asCanvasPattern(_t):_t:null}function asCanvasPattern(_t){if(!_t.offset||!_t.size)return shared.getPattern(_t.src,"anonymous",_t.color);const e=_t.src+":"+_t.offset,n=shared.getPattern(e,void 0,_t.color);if(n)return n;const ei=shared.get(_t.src,"anonymous",null);if(ei.getImageState()!==ImageState.LOADED)return null;const ti=createCanvasContext2D(_t.size[0],_t.size[1]);return ti.drawImage(ei.getImage(1),_t.offset[0],_t.offset[1],_t.size[0],_t.size[1],0,0,_t.size[0],_t.size[1]),get$2(ti.canvas,e,void 0,ImageState.LOADED,_t.color,!0),shared.getPattern(e,void 0,_t.color)}class VectorContext{drawCustom(e,n,ei,ti,ii){}drawGeometry(e){}setStyle(e){}drawCircle(e,n,ei){}drawFeature(e,n,ei){}drawGeometryCollection(e,n,ei){}drawLineString(e,n,ei){}drawMultiLineString(e,n,ei){}drawMultiPoint(e,n,ei){}drawMultiPolygon(e,n,ei){}drawPoint(e,n,ei){}drawPolygon(e,n,ei){}drawText(e,n,ei){}setFillStrokeStyle(e,n){}setImageStyle(e,n){}setTextStyle(e,n){}}const defaultFont="10px sans-serif",defaultFillStyle="#000",defaultLineCap="round",defaultLineDash=[],defaultLineDashOffset=0,defaultLineJoin="round",defaultMiterLimit=10,defaultStrokeStyle="#000",defaultTextAlign="center",defaultTextBaseline="middle",defaultPadding=[0,0,0,0],defaultLineWidth=1,checkedFonts=new BaseObject;let measureContext$1=null,measureFont;const textHeights={},genericFontFamilies=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"]);function getFontKey(_t,e,n){return`${_t} ${e} 16px "${n}"`}const registerFont=(function(){let e,n;async function ei(ii){await n.ready;const ri=await n.load(ii);if(ri.length===0)return!1;const ni=getFontParameters(ii),si=ni.families[0].toLowerCase(),ai=ni.weight;return ri.some(oi=>{const li=oi.family.replace(/^['"]|['"]$/g,"").toLowerCase(),ci=fontWeights$1[oi.weight]||oi.weight;return li===si&&oi.style===ni.style&&ci==ai})}async function ti(){await n.ready;let ii=!0;const ri=checkedFonts.getProperties(),ni=Object.keys(ri).filter(si=>ri[si]<100);for(let si=ni.length-1;si>=0;--si){const ai=ni[si];let oi=ri[ai];oi<100&&(await ei(ai)?(clear$1(textHeights),checkedFonts.set(ai,100)):(oi+=10,checkedFonts.set(ai,oi,!0),oi<100&&(ii=!1)))}e=void 0,ii||(e=setTimeout(ti,100))}return async function(ii){n||(n=WORKER_OFFSCREEN_CANVAS?self.fonts:document.fonts);const ri=getFontParameters(ii);if(!ri)return;const ni=ri.families;let si=!1;for(const ai of ni){if(genericFontFamilies.has(ai))continue;const oi=getFontKey(ri.style,ri.weight,ai);checkedFonts.get(oi)===void 0&&(checkedFonts.set(oi,0,!0),si=!0)}si&&(clearTimeout(e),e=setTimeout(ti,100))}})(),measureTextHeight=(function(){let _t;return function(e){let n=textHeights[e];if(n==null){if(WORKER_OFFSCREEN_CANVAS){const ei=getFontParameters(e),ti=measureText$1(e,"g");n=(isNaN(Number(ei.lineHeight))?1.2:Number(ei.lineHeight))*(ti.actualBoundingBoxAscent+ti.actualBoundingBoxDescent)}else _t||(_t=document.createElement("div"),_t.innerHTML="M",_t.style.minHeight="0",_t.style.maxHeight="none",_t.style.height="auto",_t.style.padding="0",_t.style.border="none",_t.style.position="absolute",_t.style.display="block",_t.style.left="-99999px"),_t.style.font=e,document.body.appendChild(_t),n=_t.offsetHeight,document.body.removeChild(_t);textHeights[e]=n}return n}})();function measureText$1(_t,e){return measureContext$1||(measureContext$1=createCanvasContext2D(1,1)),_t!=measureFont&&(measureContext$1.font=_t,measureFont=measureContext$1.font),measureContext$1.measureText(e)}function measureTextWidth(_t,e){return measureText$1(_t,e).width}function measureAndCacheTextWidth(_t,e,n){if(e in n)return n[e];const ei=e.split(`
`).reduce((ti,ii)=>Math.max(ti,measureTextWidth(_t,ii)),0);return n[e]=ei,ei}function getTextDimensions(_t,e){const n=[],ei=[],ti=[];let ii=0,ri=0,ni=0,si=0;for(let ai=0,oi=e.length;ai<=oi;ai+=2){const li=e[ai];if(li===`
`||ai===oi){ii=Math.max(ii,ri),ti.push(ri),ri=0,ni+=si,si=0;continue}const ci=e[ai+1]||_t.font,ui=measureTextWidth(ci,li);n.push(ui),ri+=ui;const di=measureTextHeight(ci);ei.push(di),si=Math.max(si,di)}return{width:ii,height:ni,widths:n,heights:ei,lineWidths:ti}}function drawImageOrLabel(_t,e,n,ei,ti,ii,ri,ni,si,ai,oi){_t.save(),n!==1&&(_t.globalAlpha===void 0?_t.globalAlpha=li=>li.globalAlpha*=n:_t.globalAlpha*=n),e&&_t.transform.apply(_t,e),ei.contextInstructions?(_t.translate(si,ai),_t.scale(oi[0],oi[1]),executeLabelInstructions(ei,_t)):oi[0]<0||oi[1]<0?(_t.translate(si,ai),_t.scale(oi[0],oi[1]),_t.drawImage(ei,ti,ii,ri,ni,0,0,ri,ni)):_t.drawImage(ei,ti,ii,ri,ni,si,ai,ri*oi[0],ni*oi[1]),_t.restore()}function executeLabelInstructions(_t,e){const n=_t.contextInstructions;for(let ei=0,ti=n.length;ei<ti;ei+=2)Array.isArray(n[ei+1])?e[n[ei]].apply(e,n[ei+1]):e[n[ei]]=n[ei+1]}const Instruction={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},fillInstruction=[Instruction.FILL],strokeInstruction=[Instruction.STROKE],beginPathInstruction=[Instruction.BEGIN_PATH],closePathInstruction=[Instruction.CLOSE_PATH];class CanvasBuilder extends VectorContext{constructor(e,n,ei,ti){super(),this.tolerance=e,this.maxExtent=n,this.pixelRatio=ti,this.maxLineWidth=0,this.resolution=ei,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(e){const n=this.pixelRatio;return n==1?e:e.map(function(ei){return ei*n})}appendFlatPointCoordinates(e,n){const ei=this.getBufferedMaxExtent(),ti=this.tmpCoordinate_,ii=this.coordinates;let ri=ii.length;for(let ni=0,si=e.length;ni<si;ni+=n)ti[0]=e[ni],ti[1]=e[ni+1],containsCoordinate(ei,ti)&&(ii[ri++]=ti[0],ii[ri++]=ti[1]);return ri}appendFlatLineCoordinates(e,n,ei,ti,ii,ri){const ni=this.coordinates;let si=ni.length;const ai=this.getBufferedMaxExtent();ri&&(n+=ti);let oi=e[n],li=e[n+1];const ci=this.tmpCoordinate_;let ui=!0,di,fi,hi;for(di=n+ti;di<ei;di+=ti)ci[0]=e[di],ci[1]=e[di+1],hi=coordinateRelationship(ai,ci),hi!==fi?(ui&&(ni[si++]=oi,ni[si++]=li,ui=!1),ni[si++]=ci[0],ni[si++]=ci[1]):hi===Relationship.INTERSECTING?(ni[si++]=ci[0],ni[si++]=ci[1],ui=!1):ui=!0,oi=ci[0],li=ci[1],fi=hi;return(ii&&ui||di===n+ti)&&(ni[si++]=oi,ni[si++]=li),si}drawCustomCoordinates_(e,n,ei,ti,ii){for(let ri=0,ni=ei.length;ri<ni;++ri){const si=ei[ri],ai=this.appendFlatLineCoordinates(e,n,si,ti,!1,!1);ii.push(ai),n=si}return n}drawCustom(e,n,ei,ti,ii){this.beginGeometry(e,n,ii);const ri=e.getType(),ni=e.getStride(),si=this.coordinates.length;let ai,oi,li,ci,ui;switch(ri){case"MultiPolygon":ai=e.getOrientedFlatCoordinates(),ci=[];const di=e.getEndss();ui=0;for(let fi=0,hi=di.length;fi<hi;++fi){const pi=[];ui=this.drawCustomCoordinates_(ai,ui,di[fi],ni,pi),ci.push(pi)}this.instructions.push([Instruction.CUSTOM,si,ci,e,ei,inflateMultiCoordinatesArray,ii]),this.hitDetectionInstructions.push([Instruction.CUSTOM,si,ci,e,ti||ei,inflateMultiCoordinatesArray,ii]);break;case"Polygon":case"MultiLineString":li=[],ai=ri=="Polygon"?e.getOrientedFlatCoordinates():e.getFlatCoordinates(),ui=this.drawCustomCoordinates_(ai,0,e.getEnds(),ni,li),this.instructions.push([Instruction.CUSTOM,si,li,e,ei,inflateCoordinatesArray,ii]),this.hitDetectionInstructions.push([Instruction.CUSTOM,si,li,e,ti||ei,inflateCoordinatesArray,ii]);break;case"LineString":case"Circle":ai=e.getFlatCoordinates(),oi=this.appendFlatLineCoordinates(ai,0,ai.length,ni,!1,!1),this.instructions.push([Instruction.CUSTOM,si,oi,e,ei,inflateCoordinates,ii]),this.hitDetectionInstructions.push([Instruction.CUSTOM,si,oi,e,ti||ei,inflateCoordinates,ii]);break;case"MultiPoint":ai=e.getFlatCoordinates(),oi=this.appendFlatPointCoordinates(ai,ni),oi>si&&(this.instructions.push([Instruction.CUSTOM,si,oi,e,ei,inflateCoordinates,ii]),this.hitDetectionInstructions.push([Instruction.CUSTOM,si,oi,e,ti||ei,inflateCoordinates,ii]));break;case"Point":ai=e.getFlatCoordinates(),this.coordinates.push(ai[0],ai[1]),oi=this.coordinates.length,this.instructions.push([Instruction.CUSTOM,si,oi,e,ei,void 0,ii]),this.hitDetectionInstructions.push([Instruction.CUSTOM,si,oi,e,ti||ei,void 0,ii]);break}this.endGeometry(n)}beginGeometry(e,n,ei){this.beginGeometryInstruction1_=[Instruction.BEGIN_GEOMETRY,n,0,e,ei],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[Instruction.BEGIN_GEOMETRY,n,0,e,ei],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const e=this.hitDetectionInstructions;e.reverse();let n;const ei=e.length;let ti,ii,ri=-1;for(n=0;n<ei;++n)ti=e[n],ii=ti[0],ii==Instruction.END_GEOMETRY?ri=n:ii==Instruction.BEGIN_GEOMETRY&&(ti[2]=n,reverseSubArray(this.hitDetectionInstructions,ri,n),ri=-1)}fillStyleToState(e,n={}){if(e){const ei=e.getColor();n.fillPatternScale=ei&&typeof ei=="object"&&"src"in ei?this.pixelRatio:1,n.fillStyle=asColorLike(ei||defaultFillStyle)}else n.fillStyle=void 0;return n}strokeStyleToState(e,n={}){if(e){const ei=e.getColor();n.strokeStyle=asColorLike(ei||defaultStrokeStyle);const ti=e.getLineCap();n.lineCap=ti!==void 0?ti:defaultLineCap;const ii=e.getLineDash();n.lineDash=ii?ii.slice():defaultLineDash;const ri=e.getLineDashOffset();n.lineDashOffset=ri||defaultLineDashOffset;const ni=e.getLineJoin();n.lineJoin=ni!==void 0?ni:defaultLineJoin;const si=e.getWidth();n.lineWidth=si!==void 0?si:defaultLineWidth;const ai=e.getMiterLimit();n.miterLimit=ai!==void 0?ai:defaultMiterLimit,n.lineWidth>this.maxLineWidth&&(this.maxLineWidth=n.lineWidth,this.bufferedMaxExtent_=null)}else n.strokeStyle=void 0,n.lineCap=void 0,n.lineDash=null,n.lineDashOffset=void 0,n.lineJoin=void 0,n.lineWidth=void 0,n.miterLimit=void 0;return n}setFillStrokeStyle(e,n){const ei=this.state;this.fillStyleToState(e,ei),this.strokeStyleToState(n,ei)}createFill(e){const n=e.fillStyle,ei=[Instruction.SET_FILL_STYLE,n];return typeof n!="string"&&ei.push(e.fillPatternScale),ei}applyStroke(e){this.instructions.push(this.createStroke(e))}createStroke(e){return[Instruction.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth*this.pixelRatio,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash?this.applyPixelRatio(e.lineDash):null,e.lineDashOffset*this.pixelRatio]}updateFillStyle(e,n){const ei=e.fillStyle;(typeof ei!="string"||e.currentFillStyle!=ei)&&(this.instructions.push(n.call(this,e)),e.currentFillStyle=ei)}updateStrokeStyle(e,n){const ei=e.strokeStyle,ti=e.lineCap,ii=e.lineDash,ri=e.lineDashOffset,ni=e.lineJoin,si=e.lineWidth,ai=e.miterLimit;(e.currentStrokeStyle!=ei||e.currentLineCap!=ti||ii!=e.currentLineDash&&!equals(e.currentLineDash,ii)||e.currentLineDashOffset!=ri||e.currentLineJoin!=ni||e.currentLineWidth!=si||e.currentMiterLimit!=ai)&&(n.call(this,e),e.currentStrokeStyle=ei,e.currentLineCap=ti,e.currentLineDash=ii,e.currentLineDashOffset=ri,e.currentLineJoin=ni,e.currentLineWidth=si,e.currentMiterLimit=ai)}endGeometry(e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const n=[Instruction.END_GEOMETRY,e];this.instructions.push(n),this.hitDetectionInstructions.push(n)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=clone$1(this.maxExtent),this.maxLineWidth>0)){const e=this.resolution*(this.maxLineWidth+1)/2;buffer(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class CanvasImageBuilder extends CanvasBuilder{constructor(e,n,ei,ti){super(e,n,ei,ti),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(e,n,ei){if(!this.image_||this.maxExtent&&!containsCoordinate(this.maxExtent,e.getFlatCoordinates()))return;this.beginGeometry(e,n,ei);const ti=e.getFlatCoordinates(),ii=e.getStride(),ri=this.coordinates.length,ni=this.appendFlatPointCoordinates(ti,ii);this.instructions.push([Instruction.DRAW_IMAGE,ri,ni,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Instruction.DRAW_IMAGE,ri,ni,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(n)}drawMultiPoint(e,n,ei){if(!this.image_)return;this.beginGeometry(e,n,ei);const ti=e.getFlatCoordinates(),ii=[];for(let si=0,ai=ti.length;si<ai;si+=e.getStride())(!this.maxExtent||containsCoordinate(this.maxExtent,ti.slice(si,si+2)))&&ii.push(ti[si],ti[si+1]);const ri=this.coordinates.length,ni=this.appendFlatPointCoordinates(ii,2);this.instructions.push([Instruction.DRAW_IMAGE,ri,ni,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Instruction.DRAW_IMAGE,ri,ni,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(n)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(e,n){const ei=e.getAnchor(),ti=e.getSize(),ii=e.getOrigin();this.imagePixelRatio_=e.getPixelRatio(this.pixelRatio),this.anchorX_=ei[0],this.anchorY_=ei[1],this.hitDetectionImage_=e.getHitDetectionImage(),this.image_=e.getImage(this.pixelRatio),this.height_=ti[1],this.opacity_=e.getOpacity(),this.originX_=ii[0],this.originY_=ii[1],this.rotateWithView_=e.getRotateWithView(),this.rotation_=e.getRotation(),this.scale_=e.getScaleArray(),this.width_=ti[0],this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=n}}class CanvasLineStringBuilder extends CanvasBuilder{constructor(e,n,ei,ti){super(e,n,ei,ti)}drawFlatCoordinates_(e,n,ei,ti){const ii=this.coordinates.length,ri=this.appendFlatLineCoordinates(e,n,ei,ti,!1,!1),ni=[Instruction.MOVE_TO_LINE_TO,ii,ri];return this.instructions.push(ni),this.hitDetectionInstructions.push(ni),ei}drawLineString(e,n,ei){const ti=this.state,ii=ti.strokeStyle,ri=ti.lineWidth;if(ii===void 0||ri===void 0)return;this.updateStrokeStyle(ti,this.applyStroke),this.beginGeometry(e,n,ei),this.hitDetectionInstructions.push([Instruction.SET_STROKE_STYLE,ti.strokeStyle,ti.lineWidth,ti.lineCap,ti.lineJoin,ti.miterLimit,defaultLineDash,defaultLineDashOffset],beginPathInstruction);const ni=e.getFlatCoordinates(),si=e.getStride();this.drawFlatCoordinates_(ni,0,ni.length,si),this.hitDetectionInstructions.push(strokeInstruction),this.endGeometry(n)}drawMultiLineString(e,n,ei){const ti=this.state,ii=ti.strokeStyle,ri=ti.lineWidth;if(ii===void 0||ri===void 0)return;this.updateStrokeStyle(ti,this.applyStroke),this.beginGeometry(e,n,ei),this.hitDetectionInstructions.push([Instruction.SET_STROKE_STYLE,ti.strokeStyle,ti.lineWidth,ti.lineCap,ti.lineJoin,ti.miterLimit,defaultLineDash,defaultLineDashOffset],beginPathInstruction);const ni=e.getEnds(),si=e.getFlatCoordinates(),ai=e.getStride();let oi=0;for(let li=0,ci=ni.length;li<ci;++li)oi=this.drawFlatCoordinates_(si,oi,ni[li],ai);this.hitDetectionInstructions.push(strokeInstruction),this.endGeometry(n)}finish(){const e=this.state;return e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&this.instructions.push(strokeInstruction),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(e){e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(strokeInstruction),e.lastStroke=this.coordinates.length),e.lastStroke=0,super.applyStroke(e),this.instructions.push(beginPathInstruction)}}class CanvasPolygonBuilder extends CanvasBuilder{constructor(e,n,ei,ti){super(e,n,ei,ti)}drawFlatCoordinatess_(e,n,ei,ti){const ii=this.state,ri=ii.fillStyle!==void 0,ni=ii.strokeStyle!==void 0,si=ei.length;this.instructions.push(beginPathInstruction),this.hitDetectionInstructions.push(beginPathInstruction);for(let ai=0;ai<si;++ai){const oi=ei[ai],li=this.coordinates.length,ci=this.appendFlatLineCoordinates(e,n,oi,ti,!0,!ni),ui=[Instruction.MOVE_TO_LINE_TO,li,ci];this.instructions.push(ui),this.hitDetectionInstructions.push(ui),ni&&(this.instructions.push(closePathInstruction),this.hitDetectionInstructions.push(closePathInstruction)),n=oi}return ri&&(this.instructions.push(fillInstruction),this.hitDetectionInstructions.push(fillInstruction)),ni&&(this.instructions.push(strokeInstruction),this.hitDetectionInstructions.push(strokeInstruction)),n}drawCircle(e,n,ei){const ti=this.state,ii=ti.fillStyle,ri=ti.strokeStyle;if(ii===void 0&&ri===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,n,ei),ti.fillStyle!==void 0&&this.hitDetectionInstructions.push([Instruction.SET_FILL_STYLE,defaultFillStyle]),ti.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Instruction.SET_STROKE_STYLE,ti.strokeStyle,ti.lineWidth,ti.lineCap,ti.lineJoin,ti.miterLimit,defaultLineDash,defaultLineDashOffset]);const ni=e.getFlatCoordinates(),si=e.getStride(),ai=this.coordinates.length;this.appendFlatLineCoordinates(ni,0,ni.length,si,!1,!1);const oi=[Instruction.CIRCLE,ai];this.instructions.push(beginPathInstruction,oi),this.hitDetectionInstructions.push(beginPathInstruction,oi),ti.fillStyle!==void 0&&(this.instructions.push(fillInstruction),this.hitDetectionInstructions.push(fillInstruction)),ti.strokeStyle!==void 0&&(this.instructions.push(strokeInstruction),this.hitDetectionInstructions.push(strokeInstruction)),this.endGeometry(n)}drawPolygon(e,n,ei){const ti=this.state,ii=ti.fillStyle,ri=ti.strokeStyle;if(ii===void 0&&ri===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,n,ei),ti.fillStyle!==void 0&&this.hitDetectionInstructions.push([Instruction.SET_FILL_STYLE,defaultFillStyle]),ti.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Instruction.SET_STROKE_STYLE,ti.strokeStyle,ti.lineWidth,ti.lineCap,ti.lineJoin,ti.miterLimit,defaultLineDash,defaultLineDashOffset]);const ni=e.getEnds(),si=e.getOrientedFlatCoordinates(),ai=e.getStride();this.drawFlatCoordinatess_(si,0,ni,ai),this.endGeometry(n)}drawMultiPolygon(e,n,ei){const ti=this.state,ii=ti.fillStyle,ri=ti.strokeStyle;if(ii===void 0&&ri===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,n,ei),ti.fillStyle!==void 0&&this.hitDetectionInstructions.push([Instruction.SET_FILL_STYLE,defaultFillStyle]),ti.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Instruction.SET_STROKE_STYLE,ti.strokeStyle,ti.lineWidth,ti.lineCap,ti.lineJoin,ti.miterLimit,defaultLineDash,defaultLineDashOffset]);const ni=e.getEndss(),si=e.getOrientedFlatCoordinates(),ai=e.getStride();let oi=0;for(let li=0,ci=ni.length;li<ci;++li)oi=this.drawFlatCoordinatess_(si,oi,ni[li],ai);this.endGeometry(n)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const e=this.tolerance;if(e!==0){const n=this.coordinates;for(let ei=0,ti=n.length;ei<ti;++ei)n[ei]=snap(n[ei],e)}return super.finish()}setFillStrokeStyles_(){const e=this.state;this.updateFillStyle(e,this.createFill),this.updateStrokeStyle(e,this.applyStroke)}}function lineChunk(_t,e,n,ei,ti){const ii=[];let ri=n,ni=0,si=e.slice(n,2);for(;ni<_t&&ri+ti<ei;){const[ai,oi]=si.slice(-2),li=e[ri+ti],ci=e[ri+ti+1],ui=Math.sqrt((li-ai)*(li-ai)+(ci-oi)*(ci-oi));if(ni+=ui,ni>=_t){const di=(_t-ni+ui)/ui,fi=lerp(ai,li,di),hi=lerp(oi,ci,di);si.push(fi,hi),ii.push(si),si=[fi,hi],ni==_t&&(ri+=ti),ni=0}else if(ni<_t)si.push(e[ri+ti],e[ri+ti+1]),ri+=ti;else{const di=ui-ni,fi=lerp(ai,li,di/ui),hi=lerp(oi,ci,di/ui);si.push(fi,hi),ii.push(si),si=[fi,hi],ni=0,ri+=ti}}return ni>0&&ii.push(si),ii}function matchingChunk(_t,e,n,ei,ti){let ii=n,ri=n,ni=0,si=0,ai=n,oi,li,ci,ui,di,fi,hi,pi,gi,vi;for(li=n;li<ei;li+=ti){const yi=e[li],_i=e[li+1];di!==void 0&&(gi=yi-di,vi=_i-fi,ui=Math.sqrt(gi*gi+vi*vi),hi!==void 0&&(si+=ci,oi=Math.acos((hi*gi+pi*vi)/(ci*ui)),oi>_t&&(si>ni&&(ni=si,ii=ai,ri=li),si=0,ai=li-ti)),ci=ui,hi=gi,pi=vi),di=yi,fi=_i}return si+=ui,si>ni?[ai,li]:[ii,ri]}const TEXT_ALIGN={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class CanvasTextBuilder extends CanvasBuilder{constructor(e,n,ei,ti){super(e,n,ei,ti),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[defaultFillStyle]={fillStyle:defaultFillStyle},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const e=super.finish();return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e}drawText(e,n,ei){const ti=this.textFillState_,ii=this.textStrokeState_,ri=this.textState_;if(this.text_===""||!ri||!ti&&!ii)return;const ni=this.coordinates;let si=ni.length;const ai=e.getType();let oi=null,li=e.getStride();if(ri.placement==="line"&&(ai=="LineString"||ai=="MultiLineString"||ai=="Polygon"||ai=="MultiPolygon")){if(!intersects$1(this.maxExtent,e.getExtent()))return;let ci;if(oi=e.getFlatCoordinates(),ai=="LineString")ci=[oi.length];else if(ai=="MultiLineString")ci=e.getEnds();else if(ai=="Polygon")ci=e.getEnds().slice(0,1);else if(ai=="MultiPolygon"){const hi=e.getEndss();ci=[];for(let pi=0,gi=hi.length;pi<gi;++pi)ci.push(hi[pi][0])}this.beginGeometry(e,n,ei);const ui=ri.repeat,di=ui?void 0:ri.textAlign;let fi=0;for(let hi=0,pi=ci.length;hi<pi;++hi){let gi;ui?gi=lineChunk(ui*this.resolution,oi,fi,ci[hi],li):gi=[oi.slice(fi,ci[hi])];for(let vi=0,yi=gi.length;vi<yi;++vi){const _i=gi[vi];let Ai=0,Ei=_i.length;if(di==null){const wi=matchingChunk(ri.maxAngle,_i,0,_i.length,2);Ai=wi[0],Ei=wi[1]}for(let wi=Ai;wi<Ei;wi+=li)ni.push(_i[wi],_i[wi+1]);const Si=ni.length;fi=ci[hi],this.drawChars_(si,Si),si=Si}}this.endGeometry(n)}else{let ci=ri.overflow?null:[];switch(ai){case"Point":case"MultiPoint":oi=e.getFlatCoordinates();break;case"LineString":oi=e.getFlatMidpoint();break;case"Circle":oi=e.getCenter();break;case"MultiLineString":oi=e.getFlatMidpoints(),li=2;break;case"Polygon":oi=e.getFlatInteriorPoint(),ri.overflow||ci.push(oi[2]/this.resolution),li=3;break;case"MultiPolygon":const yi=e.getFlatInteriorPoints();oi=[];for(let _i=0,Ai=yi.length;_i<Ai;_i+=3)ri.overflow||ci.push(yi[_i+2]/this.resolution),oi.push(yi[_i],yi[_i+1]);if(oi.length===0)return;li=2;break}const ui=this.appendFlatPointCoordinates(oi,li);if(ui===si)return;if(ci&&(ui-si)/2!==oi.length/li){let yi=si/2;ci=ci.filter((_i,Ai)=>{const Ei=ni[(yi+Ai)*2]===oi[Ai*li]&&ni[(yi+Ai)*2+1]===oi[Ai*li+1];return Ei||--yi,Ei})}this.saveTextStates_();const di=ri.backgroundFill?this.createFill(this.fillStyleToState(ri.backgroundFill)):null,fi=ri.backgroundStroke?this.createStroke(this.strokeStyleToState(ri.backgroundStroke)):null;this.beginGeometry(e,n,ei);let hi=ri.padding;if(hi!=defaultPadding&&(ri.scale[0]<0||ri.scale[1]<0)){let yi=ri.padding[0],_i=ri.padding[1],Ai=ri.padding[2],Ei=ri.padding[3];ri.scale[0]<0&&(_i=-_i,Ei=-Ei),ri.scale[1]<0&&(yi=-yi,Ai=-Ai),hi=[yi,_i,Ai,Ei]}const pi=this.pixelRatio;this.instructions.push([Instruction.DRAW_IMAGE,si,ui,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,hi==defaultPadding?defaultPadding:hi.map(function(yi){return yi*pi}),di,fi,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,ci]);const gi=1/pi,vi=di?di.slice(0):null;vi&&(vi[1]=defaultFillStyle),this.hitDetectionInstructions.push([Instruction.DRAW_IMAGE,si,ui,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[gi,gi],NaN,this.declutterMode_,this.declutterImageWithText_,hi,vi,fi,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?defaultFillStyle:this.fillKey_,this.textOffsetX_,this.textOffsetY_,ci]),this.endGeometry(n)}}saveTextStates_(){const e=this.textStrokeState_,n=this.textState_,ei=this.textFillState_,ti=this.strokeKey_;e&&(ti in this.strokeStates||(this.strokeStates[ti]={strokeStyle:e.strokeStyle,lineCap:e.lineCap,lineDashOffset:e.lineDashOffset,lineWidth:e.lineWidth,lineJoin:e.lineJoin,miterLimit:e.miterLimit,lineDash:e.lineDash}));const ii=this.textKey_;ii in this.textStates||(this.textStates[ii]={font:n.font,textAlign:n.textAlign||defaultTextAlign,justify:n.justify,textBaseline:n.textBaseline||defaultTextBaseline,scale:n.scale});const ri=this.fillKey_;ei&&(ri in this.fillStates||(this.fillStates[ri]={fillStyle:ei.fillStyle}))}drawChars_(e,n){const ei=this.textStrokeState_,ti=this.textState_,ii=this.strokeKey_,ri=this.textKey_,ni=this.fillKey_;this.saveTextStates_();const si=this.pixelRatio,ai=TEXT_ALIGN[ti.textBaseline],oi=this.textOffsetY_*si,li=this.text_,ci=ei?ei.lineWidth*Math.abs(ti.scale[0])/2:0;this.instructions.push([Instruction.DRAW_CHARS,e,n,ai,ti.overflow,ni,ti.maxAngle,si,oi,ii,ci*si,li,ri,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([Instruction.DRAW_CHARS,e,n,ai,ti.overflow,ni&&defaultFillStyle,ti.maxAngle,si,oi,ii,ci*si,li,ri,1/si,this.declutterMode_,this.textKeepUpright_])}setTextStyle(e,n){let ei,ti,ii;if(!e)this.text_="";else{const ri=e.getFill();ri?(ti=this.textFillState_,ti||(ti={},this.textFillState_=ti),ti.fillStyle=asColorLike(ri.getColor()||defaultFillStyle)):(ti=null,this.textFillState_=ti);const ni=e.getStroke();if(!ni)ii=null,this.textStrokeState_=ii;else{ii=this.textStrokeState_,ii||(ii={},this.textStrokeState_=ii);const fi=ni.getLineDash(),hi=ni.getLineDashOffset(),pi=ni.getWidth(),gi=ni.getMiterLimit();ii.lineCap=ni.getLineCap()||defaultLineCap,ii.lineDash=fi?fi.slice():defaultLineDash,ii.lineDashOffset=hi===void 0?defaultLineDashOffset:hi,ii.lineJoin=ni.getLineJoin()||defaultLineJoin,ii.lineWidth=pi===void 0?defaultLineWidth:pi,ii.miterLimit=gi===void 0?defaultMiterLimit:gi,ii.strokeStyle=asColorLike(ni.getColor()||defaultStrokeStyle)}ei=this.textState_;const si=e.getFont()||defaultFont;registerFont(si);const ai=e.getScaleArray();ei.overflow=e.getOverflow(),ei.font=si,ei.maxAngle=e.getMaxAngle(),ei.placement=e.getPlacement(),ei.textAlign=e.getTextAlign(),ei.repeat=e.getRepeat(),ei.justify=e.getJustify(),ei.textBaseline=e.getTextBaseline()||defaultTextBaseline,ei.backgroundFill=e.getBackgroundFill(),ei.backgroundStroke=e.getBackgroundStroke(),ei.padding=e.getPadding()||defaultPadding,ei.scale=ai===void 0?[1,1]:ai;const oi=e.getOffsetX(),li=e.getOffsetY(),ci=e.getRotateWithView(),ui=e.getKeepUpright(),di=e.getRotation();this.text_=e.getText()||"",this.textOffsetX_=oi===void 0?0:oi,this.textOffsetY_=li===void 0?0:li,this.textRotateWithView_=ci===void 0?!1:ci,this.textKeepUpright_=ui===void 0?!0:ui,this.textRotation_=di===void 0?0:di,this.strokeKey_=ii?(typeof ii.strokeStyle=="string"?ii.strokeStyle:getUid(ii.strokeStyle))+ii.lineCap+ii.lineDashOffset+"|"+ii.lineWidth+ii.lineJoin+ii.miterLimit+"["+ii.lineDash.join()+"]":"",this.textKey_=ei.font+ei.scale+(ei.textAlign||"?")+(ei.repeat||"?")+(ei.justify||"?")+(ei.textBaseline||"?"),this.fillKey_=ti&&ti.fillStyle?typeof ti.fillStyle=="string"?ti.fillStyle:"|"+getUid(ti.fillStyle):""}this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=n}}const BATCH_CONSTRUCTORS={Circle:CanvasPolygonBuilder,Default:CanvasBuilder,Image:CanvasImageBuilder,LineString:CanvasLineStringBuilder,Polygon:CanvasPolygonBuilder,Text:CanvasTextBuilder};class BuilderGroup{constructor(e,n,ei,ti){this.tolerance_=e,this.maxExtent_=n,this.pixelRatio_=ti,this.resolution_=ei,this.buildersByZIndex_={}}finish(){const e={};for(const n in this.buildersByZIndex_){e[n]=e[n]||{};const ei=this.buildersByZIndex_[n];for(const ti in ei){const ii=ei[ti].finish();e[n][ti]=ii}}return e}getBuilder(e,n){const ei=e!==void 0?e.toString():"0";let ti=this.buildersByZIndex_[ei];ti===void 0&&(ti={},this.buildersByZIndex_[ei]=ti);let ii=ti[n];if(ii===void 0){const ri=BATCH_CONSTRUCTORS[n];ii=new ri(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),ti[n]=ii}return ii}}function drawTextOnPath(_t,e,n,ei,ti,ii,ri,ni,si,ai,oi,li,ci=!0){let ui=_t[e],di=_t[e+1],fi=0,hi=0,pi=0,gi=0;function vi(){fi=ui,hi=di,e+=ei,ui=_t[e],di=_t[e+1],gi+=pi,pi=Math.sqrt((ui-fi)*(ui-fi)+(di-hi)*(di-hi))}do vi();while(e<n-ei&&gi+pi<ii);let yi=pi===0?0:(ii-gi)/pi;const _i=lerp(fi,ui,yi),Ai=lerp(hi,di,yi),Ei=e-ei,Si=gi,wi=ii+ni*si(ai,ti,oi);for(;e<n-ei&&gi+pi<wi;)vi();yi=pi===0?0:(wi-gi)/pi;const Oi=lerp(fi,ui,yi),Ii=lerp(hi,di,yi);let Li=!1;if(ci)if(li){const er=[_i,Ai,Oi,Ii];rotate(er,0,4,2,li,er,er),Li=er[0]>er[2]}else Li=_i>Oi;const Di=Math.PI,Ni=[],$i=Ei+ei===e;e=Ei,pi=0,gi=Si,ui=_t[e],di=_t[e+1];let Ki;if($i){vi(),Ki=Math.atan2(di-hi,ui-fi),Li&&(Ki+=Ki>0?-Di:Di);const er=(Oi+_i)/2,Vi=(Ii+Ai)/2;return Ni[0]=[er,Vi,(wi-ii)/2,Ki,ti],Ni}ti=ti.replace(/\n/g," ");for(let er=0,Vi=ti.length;er<Vi;){vi();let nr=Math.atan2(di-hi,ui-fi);if(Li&&(nr+=nr>0?-Di:Di),Ki!==void 0){let Mi=nr-Ki;if(Mi+=Mi>Di?-2*Di:Mi<-Di?2*Di:0,Math.abs(Mi)>ri)return null}Ki=nr;const zi=er;let Wi=0;for(;er<Vi;++er){const Mi=Li?Vi-er-1:er,Ui=ni*si(ai,ti[Mi],oi);if(e+ei<n&&gi+pi<ii+Wi+Ui/2)break;Wi+=Ui}if(er===zi)continue;const Ti=Li?ti.substring(Vi-zi,Vi-er):ti.substring(zi,er);yi=pi===0?0:(ii+Wi/2-gi)/pi;const ki=lerp(fi,ui,yi),xi=lerp(hi,di,yi);Ni.push([ki,xi,Wi/2,nr,Ti]),ii+=Wi}return Ni}class ZIndexContext{constructor(){qr(this,"pushMethodArgs_",(...e)=>(this.push_(e),this));this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(getSharedCanvasContext2D(),{get:(e,n)=>{if(typeof getSharedCanvasContext2D()[n]=="function")return this.push_(n),this.pushMethodArgs_},set:(e,n,ei)=>(this.push_(n,ei),!0)})}push_(...e){const n=this.instructions_,ei=this.zIndex+this.offset_;n[ei]||(n[ei]=[]),n[ei].push(...e)}pushFunction(e){this.push_(e)}getContext(){return this.context_}draw(e){this.instructions_.forEach(n=>{for(let ei=0,ti=n.length;ei<ti;++ei){const ii=n[ei];if(typeof ii=="function"){ii(e);continue}const ri=n[++ei];if(typeof e[ii]=="function")e[ii](...ri);else{if(typeof ri=="function"){e[ii]=ri(e);continue}e[ii]=ri}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const tmpExtent=createEmpty(),p1=[],p2=[],p3=[],p4=[];function getDeclutterBox(_t){return _t[3].declutterBox}const rtlRegEx=new RegExp("[-----]");function horizontalTextAlign(_t,e){return e==="start"?e=rtlRegEx.test(_t)?"right":"left":e==="end"&&(e=rtlRegEx.test(_t)?"left":"right"),TEXT_ALIGN[e]}function createTextChunks(_t,e,n){return n>0&&_t.push(`
`,""),_t.push(e,""),_t}function richTextToPlainText(_t,e,n){return n%2===0&&(_t+=e),_t}class Executor{constructor(e,n,ei,ti,ii){this.overlaps=ei,this.pixelRatio=n,this.resolution=e,this.alignAndScaleFill_,this.instructions=ti.instructions,this.coordinates=ti.coordinates,this.coordinateCache_={},this.renderedTransform_=create(),this.hitDetectionInstructions=ti.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=ti.fillStates||{},this.strokeStates=ti.strokeStates||{},this.textStates=ti.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=ii?new ZIndexContext:null}getZIndexContext(){return this.zIndexContext_}createLabel(e,n,ei,ti){const ii=e+n+ei+ti;if(this.labels_[ii])return this.labels_[ii];const ri=ti?this.strokeStates[ti]:null,ni=ei?this.fillStates[ei]:null,si=this.textStates[n],ai=this.pixelRatio,oi=[si.scale[0]*ai,si.scale[1]*ai],li=si.justify?TEXT_ALIGN[si.justify]:horizontalTextAlign(Array.isArray(e)?e[0]:e,si.textAlign||defaultTextAlign),ci=ti&&ri.lineWidth?ri.lineWidth:0,ui=Array.isArray(e)?e:String(e).split(`
`).reduce(createTextChunks,[]),{width:di,height:fi,widths:hi,heights:pi,lineWidths:gi}=getTextDimensions(si,ui),vi=di+ci,yi=[],_i=(vi+2)*oi[0],Ai=(fi+ci)*oi[1],Ei={width:_i<0?Math.floor(_i):Math.ceil(_i),height:Ai<0?Math.floor(Ai):Math.ceil(Ai),contextInstructions:yi};(oi[0]!=1||oi[1]!=1)&&yi.push("scale",oi),ti&&(yi.push("strokeStyle",ri.strokeStyle),yi.push("lineWidth",ci),yi.push("lineCap",ri.lineCap),yi.push("lineJoin",ri.lineJoin),yi.push("miterLimit",ri.miterLimit),yi.push("setLineDash",[ri.lineDash]),yi.push("lineDashOffset",ri.lineDashOffset)),ei&&yi.push("fillStyle",ni.fillStyle),yi.push("textBaseline","middle"),yi.push("textAlign","center");const Si=.5-li;let wi=li*vi+Si*ci;const Oi=[],Ii=[];let Li=0,Di=0,Ni=0,$i=0,Ki;for(let er=0,Vi=ui.length;er<Vi;er+=2){const nr=ui[er];if(nr===`
`){Di+=Li,Li=0,wi=li*vi+Si*ci,++$i;continue}const zi=ui[er+1]||si.font;zi!==Ki&&(ti&&Oi.push("font",zi),ei&&Ii.push("font",zi),Ki=zi),Li=Math.max(Li,pi[Ni]);const Wi=[nr,wi+Si*hi[Ni]+li*(hi[Ni]-gi[$i]),.5*(ci+Li)+Di];wi+=hi[Ni],ti&&Oi.push("strokeText",Wi),ei&&Ii.push("fillText",Wi),++Ni}return Array.prototype.push.apply(yi,Oi),Array.prototype.push.apply(yi,Ii),this.labels_[ii]=Ei,Ei}replayTextBackground_(e,n,ei,ti,ii,ri,ni){e.beginPath(),e.moveTo.apply(e,n),e.lineTo.apply(e,ei),e.lineTo.apply(e,ti),e.lineTo.apply(e,ii),e.lineTo.apply(e,n),ri&&(this.alignAndScaleFill_=ri[2],e.fillStyle=ri[1],this.fill_(e)),ni&&(this.setStrokeStyle_(e,ni),e.stroke())}calculateImageOrLabelDimensions_(e,n,ei,ti,ii,ri,ni,si,ai,oi,li,ci,ui,di,fi,hi){ni*=ci[0],si*=ci[1];let pi=ei-ni,gi=ti-si;const vi=ii+ai>e?e-ai:ii,yi=ri+oi>n?n-oi:ri,_i=di[3]+vi*ci[0]+di[1],Ai=di[0]+yi*ci[1]+di[2],Ei=pi-di[3],Si=gi-di[0];(fi||li!==0)&&(p1[0]=Ei,p4[0]=Ei,p1[1]=Si,p2[1]=Si,p2[0]=Ei+_i,p3[0]=p2[0],p3[1]=Si+Ai,p4[1]=p3[1]);let wi;return li!==0?(wi=compose(create(),ei,ti,1,1,li,-ei,-ti),apply(wi,p1),apply(wi,p2),apply(wi,p3),apply(wi,p4),createOrUpdate$2(Math.min(p1[0],p2[0],p3[0],p4[0]),Math.min(p1[1],p2[1],p3[1],p4[1]),Math.max(p1[0],p2[0],p3[0],p4[0]),Math.max(p1[1],p2[1],p3[1],p4[1]),tmpExtent)):createOrUpdate$2(Math.min(Ei,Ei+_i),Math.min(Si,Si+Ai),Math.max(Ei,Ei+_i),Math.max(Si,Si+Ai),tmpExtent),ui&&(pi=Math.round(pi),gi=Math.round(gi)),{drawImageX:pi,drawImageY:gi,drawImageW:vi,drawImageH:yi,originX:ai,originY:oi,declutterBox:{minX:tmpExtent[0],minY:tmpExtent[1],maxX:tmpExtent[2],maxY:tmpExtent[3],value:hi},canvasTransform:wi,scale:ci}}replayImageOrLabel_(e,n,ei,ti,ii,ri,ni){const si=!!(ri||ni),ai=ti.declutterBox,oi=ni?ni[2]*ti.scale[0]/2:0;return ai.minX-oi<=n[0]&&ai.maxX+oi>=0&&ai.minY-oi<=n[1]&&ai.maxY+oi>=0&&(si&&this.replayTextBackground_(e,p1,p2,p3,p4,ri,ni),drawImageOrLabel(e,ti.canvasTransform,ii,ei,ti.originX,ti.originY,ti.drawImageW,ti.drawImageH,ti.drawImageX,ti.drawImageY,ti.scale)),!0}fill_(e){const n=this.alignAndScaleFill_;if(n){const ei=apply(this.renderedTransform_,[0,0]),ti=512*this.pixelRatio;e.save(),e.translate(ei[0]%ti,ei[1]%ti),n!==1&&e.scale(n,n),e.rotate(this.viewRotation_)}e.fill(),n&&e.restore()}setStrokeStyle_(e,n){e.strokeStyle=n[1],n[1]&&(e.lineWidth=n[2],e.lineCap=n[3],e.lineJoin=n[4],e.miterLimit=n[5],e.lineDashOffset=n[7],e.setLineDash(n[6]))}drawLabelWithPointPlacement_(e,n,ei,ti){const ii=this.textStates[n],ri=this.createLabel(e,n,ti,ei),ni=this.strokeStates[ei],si=this.pixelRatio,ai=horizontalTextAlign(Array.isArray(e)?e[0]:e,ii.textAlign||defaultTextAlign),oi=TEXT_ALIGN[ii.textBaseline||defaultTextBaseline],li=ni&&ni.lineWidth?ni.lineWidth:0,ci=ri.width/si-2*ii.scale[0],ui=ai*ci+2*(.5-ai)*li,di=oi*ri.height/si+2*(.5-oi)*li;return{label:ri,anchorX:ui,anchorY:di}}execute_(e,n,ei,ti,ii,ri,ni,si){const ai=this.zIndexContext_;let oi;this.pixelCoordinates_&&equals(ei,this.renderedTransform_)?oi=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),oi=transform2D(this.coordinates,0,this.coordinates.length,2,ei,this.pixelCoordinates_),setFromArray(this.renderedTransform_,ei));let li=0;const ci=ti.length;let ui=0,di,fi,hi,pi,gi,vi,yi,_i,Ai,Ei,Si,wi,Oi,Ii=0,Li=0;const Di=this.coordinateCache_,Ni=this.viewRotation_,$i=Math.round(Math.atan2(-ei[1],ei[0])*1e12)/1e12,Ki={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:Ni},er=this.instructions!=ti||this.overlaps?0:200;let Vi,nr,zi,Wi;for(;li<ci;){const Ti=ti[li];switch(Ti[0]){case Instruction.BEGIN_GEOMETRY:Vi=Ti[1],Wi=Ti[3],Vi.getGeometry()?ni!==void 0&&!intersects$1(ni,Wi.getExtent())?li=Ti[2]+1:++li:li=Ti[2],ai&&(ai.zIndex=Ti[4]);break;case Instruction.BEGIN_PATH:Ii>er&&(this.fill_(e),Ii=0),Li>er&&(e.stroke(),Li=0),!Ii&&!Li&&(e.beginPath(),gi=NaN,vi=NaN),++li;break;case Instruction.CIRCLE:ui=Ti[1];const xi=oi[ui],Mi=oi[ui+1],Ui=oi[ui+2],Yi=oi[ui+3],sr=Ui-xi,cr=Yi-Mi,ir=Math.sqrt(sr*sr+cr*cr);e.moveTo(xi+ir,Mi),e.arc(xi,Mi,ir,0,2*Math.PI,!0),++li;break;case Instruction.CLOSE_PATH:e.closePath(),++li;break;case Instruction.CUSTOM:ui=Ti[1],di=Ti[2];const Zi=Ti[3],rr=Ti[4],ar=Ti[5];Ki.geometry=Zi,Ki.feature=Vi,li in Di||(Di[li]=[]);const pr=Di[li];ar?ar(oi,ui,di,2,pr):(pr[0]=oi[ui],pr[1]=oi[ui+1],pr.length=2),ai&&(ai.zIndex=Ti[6]),rr(pr,Ki),++li;break;case Instruction.DRAW_IMAGE:ui=Ti[1],di=Ti[2],Ai=Ti[3],fi=Ti[4],hi=Ti[5];let Gi=Ti[6];const gr=Ti[7],Br=Ti[8],Nr=Ti[9],mr=Ti[10];let Mr=Ti[11];const Er=Ti[12];let Fr=Ti[13];pi=Ti[14]||"declutter";const or=Ti[15];if(!Ai&&Ti.length>=20){Ei=Ti[19],Si=Ti[20],wi=Ti[21],Oi=Ti[22];const En=this.drawLabelWithPointPlacement_(Ei,Si,wi,Oi);Ai=En.label,Ti[3]=Ai;const Pn=Ti[23];fi=(En.anchorX-Pn)*this.pixelRatio,Ti[4]=fi;const Dn=Ti[24];hi=(En.anchorY-Dn)*this.pixelRatio,Ti[5]=hi,Gi=Ai.height,Ti[6]=Gi,Fr=Ai.width,Ti[13]=Fr}let yr;Ti.length>25&&(yr=Ti[25]);let _r,Ar,wr;Ti.length>17?(_r=Ti[16],Ar=Ti[17],wr=Ti[18]):(_r=defaultPadding,Ar=null,wr=null),mr&&$i?Mr+=Ni:!mr&&!$i&&(Mr-=Ni);let Rr=0;for(;ui<di;ui+=2){if(yr&&yr[Rr++]<Fr/this.pixelRatio)continue;const En=this.calculateImageOrLabelDimensions_(Ai.width,Ai.height,oi[ui],oi[ui+1],Fr,Gi,fi,hi,Br,Nr,Mr,Er,ii,_r,!!Ar||!!wr,Vi),Pn=[e,n,Ai,En,gr,Ar,wr];if(si){let Dn,Gn,Ur;if(or){const mn=di-ui;if(!or[mn]){or[mn]={args:Pn,declutterMode:pi};continue}const bn=or[mn];Dn=bn.args,Gn=bn.declutterMode,delete or[mn],Ur=getDeclutterBox(Dn)}let Tn,$n;if(Dn&&(Gn!=="declutter"||!si.collides(Ur))&&(Tn=!0),(pi!=="declutter"||!si.collides(En.declutterBox))&&($n=!0),Gn==="declutter"&&pi==="declutter"){const mn=Tn&&$n;Tn=mn,$n=mn}Tn&&(Gn!=="none"&&si.insert(Ur),this.replayImageOrLabel_.apply(this,Dn)),$n&&(pi!=="none"&&si.insert(En.declutterBox),this.replayImageOrLabel_.apply(this,Pn))}else this.replayImageOrLabel_.apply(this,Pn)}++li;break;case Instruction.DRAW_CHARS:const Sr=Ti[1],Gr=Ti[2],Or=Ti[3],nn=Ti[4];Oi=Ti[5];const en=Ti[6],Vr=Ti[7],Xr=Ti[8];wi=Ti[9];const tn=Ti[10];Ei=Ti[11],Array.isArray(Ei)&&(Ei=Ei.reduce(richTextToPlainText,"")),Si=Ti[12];const Dr=[Ti[13],Ti[13]];pi=Ti[14]||"declutter";const rn=Ti[15],jr=this.textStates[Si],$r=jr.font,un=[jr.scale[0]*Vr,jr.scale[1]*Vr];let sn;$r in this.widths_?sn=this.widths_[$r]:(sn={},this.widths_[$r]=sn);const Wr=lineStringLength(oi,Sr,Gr,2),an=Math.abs(un[0])*measureAndCacheTextWidth($r,Ei,sn);if(nn||an<=Wr){const En=this.textStates[Si].textAlign,Pn=(Wr-an)*horizontalTextAlign(Ei,En),Dn=drawTextOnPath(oi,Sr,Gr,2,Ei,Pn,en,Math.abs(un[0]),measureAndCacheTextWidth,$r,sn,$i?0:this.viewRotation_,rn);e:if(Dn){const Gn=[];let Ur,Tn,$n,mn,bn;if(wi)for(Ur=0,Tn=Dn.length;Ur<Tn;++Ur){bn=Dn[Ur],$n=bn[4],mn=this.createLabel($n,Si,"",wi),fi=bn[2]+(un[0]<0?-tn:tn),hi=Or*mn.height+(.5-Or)*2*tn*un[1]/un[0]-Xr;const yn=this.calculateImageOrLabelDimensions_(mn.width,mn.height,bn[0],bn[1],mn.width,mn.height,fi,hi,0,0,bn[3],Dr,!1,defaultPadding,!1,Vi);if(si&&pi==="declutter"&&si.collides(yn.declutterBox))break e;Gn.push([e,n,mn,yn,1,null,null])}if(Oi)for(Ur=0,Tn=Dn.length;Ur<Tn;++Ur){bn=Dn[Ur],$n=bn[4],mn=this.createLabel($n,Si,Oi,""),fi=bn[2],hi=Or*mn.height-Xr;const yn=this.calculateImageOrLabelDimensions_(mn.width,mn.height,bn[0],bn[1],mn.width,mn.height,fi,hi,0,0,bn[3],Dr,!1,defaultPadding,!1,Vi);if(si&&pi==="declutter"&&si.collides(yn.declutterBox))break e;Gn.push([e,n,mn,yn,1,null,null])}si&&pi!=="none"&&si.load(Gn.map(getDeclutterBox));for(let yn=0,Fn=Gn.length;yn<Fn;++yn)this.replayImageOrLabel_.apply(this,Gn[yn])}}++li;break;case Instruction.END_GEOMETRY:if(ri!==void 0){Vi=Ti[1];const En=ri(Vi,Wi,pi);if(En)return En}++li;break;case Instruction.FILL:er?Ii++:this.fill_(e),++li;break;case Instruction.MOVE_TO_LINE_TO:for(ui=Ti[1],di=Ti[2],nr=oi[ui],zi=oi[ui+1],e.moveTo(nr,zi),gi=nr+.5|0,vi=zi+.5|0,ui+=2;ui<di;ui+=2)nr=oi[ui],zi=oi[ui+1],yi=nr+.5|0,_i=zi+.5|0,(ui==di-2||yi!==gi||_i!==vi)&&(e.lineTo(nr,zi),gi=yi,vi=_i);++li;break;case Instruction.SET_FILL_STYLE:this.alignAndScaleFill_=Ti[2],Ii&&(this.fill_(e),Ii=0,Li&&(e.stroke(),Li=0)),e.fillStyle=Ti[1],++li;break;case Instruction.SET_STROKE_STYLE:Li&&(e.stroke(),Li=0),this.setStrokeStyle_(e,Ti),++li;break;case Instruction.STROKE:er?Li++:e.stroke(),++li;break;default:++li;break}}Ii&&this.fill_(e),Li&&e.stroke()}execute(e,n,ei,ti,ii,ri){this.viewRotation_=ti,this.execute_(e,n,ei,this.instructions,ii,void 0,void 0,ri)}executeHitDetection(e,n,ei,ti,ii){return this.viewRotation_=ei,this.execute_(e,[e.canvas.width,e.canvas.height],n,this.hitDetectionInstructions,!0,ti,ii)}}const ALL=["Polygon","Circle","LineString","Image","Text","Default"],DECLUTTER=["Image","Text"],NON_DECLUTTER=ALL.filter(_t=>!DECLUTTER.includes(_t));class ExecutorGroup{constructor(e,n,ei,ti,ii,ri,ni){this.maxExtent_=e,this.overlaps_=ti,this.pixelRatio_=ei,this.resolution_=n,this.renderBuffer_=ri,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=create(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(ii,ni)}clip(e,n){const ei=this.getClipCoords(n);e.beginPath(),e.moveTo(ei[0],ei[1]),e.lineTo(ei[2],ei[3]),e.lineTo(ei[4],ei[5]),e.lineTo(ei[6],ei[7]),e.clip()}createExecutors_(e,n){for(const ei in e){let ti=this.executorsByZIndex_[ei];ti===void 0&&(ti={},this.executorsByZIndex_[ei]=ti);const ii=e[ei];for(const ri in ii){const ni=ii[ri];ti[ri]=new Executor(this.resolution_,this.pixelRatio_,this.overlaps_,ni,n)}}}hasExecutors(e){for(const n in this.executorsByZIndex_){const ei=this.executorsByZIndex_[n];for(let ti=0,ii=e.length;ti<ii;++ti)if(e[ti]in ei)return!0}return!1}forEachFeatureAtCoordinate(e,n,ei,ti,ii,ri){ti=Math.round(ti);const ni=ti*2+1,si=compose(this.hitDetectionTransform_,ti+.5,ti+.5,1/n,-1/n,-ei,-e[0],-e[1]),ai=!this.hitDetectionContext_;ai&&(this.hitDetectionContext_=createCanvasContext2D(ni,ni));const oi=this.hitDetectionContext_;oi.canvas.width!==ni||oi.canvas.height!==ni?(oi.canvas.width=ni,oi.canvas.height=ni):ai||oi.clearRect(0,0,ni,ni);let li;this.renderBuffer_!==void 0&&(li=createEmpty(),extendCoordinate(li,e),buffer(li,n*(this.renderBuffer_+ti),li));const ci=getPixelIndexArray(ti);let ui;function di(_i,Ai,Ei){const Si=oi.getImageData(0,0,ni,ni).data;for(let wi=0,Oi=ci.length;wi<Oi;wi++)if(Si[ci[wi]]>0){if(!ri||Ei==="none"||ui!=="Image"&&ui!=="Text"||ri.includes(_i)){const Ii=(ci[wi]-3)/4,Li=ti-Ii%ni,Di=ti-(Ii/ni|0),Ni=ii(_i,Ai,Li*Li+Di*Di);if(Ni)return Ni}oi.clearRect(0,0,ni,ni);break}}const fi=Object.keys(this.executorsByZIndex_).map(Number);fi.sort(ascending);let hi,pi,gi,vi,yi;for(hi=fi.length-1;hi>=0;--hi){const _i=fi[hi].toString();for(gi=this.executorsByZIndex_[_i],pi=ALL.length-1;pi>=0;--pi)if(ui=ALL[pi],vi=gi[ui],vi!==void 0&&(yi=vi.executeHitDetection(oi,si,ei,di,li),yi))return yi}}getClipCoords(e){const n=this.maxExtent_;if(!n)return null;const ei=n[0],ti=n[1],ii=n[2],ri=n[3],ni=[ei,ti,ei,ri,ii,ri,ii,ti];return transform2D(ni,0,8,2,e,ni),ni}isEmpty(){return isEmpty(this.executorsByZIndex_)}execute(e,n,ei,ti,ii,ri,ni){const si=Object.keys(this.executorsByZIndex_).map(Number);si.sort(ni?descending:ascending),ri=ri||ALL;const ai=ALL.length;for(let oi=0,li=si.length;oi<li;++oi){const ci=si[oi].toString(),ui=this.executorsByZIndex_[ci];for(let di=0,fi=ri.length;di<fi;++di){const hi=ri[di],pi=ui[hi];if(pi!==void 0){const gi=ni===null?void 0:pi.getZIndexContext(),vi=gi?gi.getContext():e,yi=this.maxExtent_&&hi!=="Image"&&hi!=="Text";if(yi&&(vi.save(),this.clip(vi,ei)),!gi||hi==="Text"||hi==="Image"?pi.execute(vi,n,ei,ti,ii,ni):gi.pushFunction(_i=>pi.execute(_i,n,ei,ti,ii,ni)),yi&&vi.restore(),gi){gi.offset();const _i=si[oi]*ai+ALL.indexOf(hi);this.deferredZIndexContexts_[_i]||(this.deferredZIndexContexts_[_i]=[]),this.deferredZIndexContexts_[_i].push(gi)}}}}this.renderedContext_=e}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const e=this.deferredZIndexContexts_,n=Object.keys(e).map(Number).sort(ascending);for(let ei=0,ti=n.length;ei<ti;++ei)e[n[ei]].forEach(ii=>{ii.draw(this.renderedContext_),ii.clear()}),e[n[ei]].length=0}}const circlePixelIndexArrayCache={};function getPixelIndexArray(_t){if(circlePixelIndexArrayCache[_t]!==void 0)return circlePixelIndexArrayCache[_t];const e=_t*2+1,n=_t*_t,ei=new Array(n+1);for(let ii=0;ii<=_t;++ii)for(let ri=0;ri<=_t;++ri){const ni=ii*ii+ri*ri;if(ni>n)break;let si=ei[ni];si||(si=[],ei[ni]=si),si.push(((_t+ii)*e+(_t+ri))*4+3),ii>0&&si.push(((_t-ii)*e+(_t+ri))*4+3),ri>0&&(si.push(((_t+ii)*e+(_t-ri))*4+3),ii>0&&si.push(((_t-ii)*e+(_t-ri))*4+3))}const ti=[];for(let ii=0,ri=ei.length;ii<ri;++ii)ei[ii]&&ti.push(...ei[ii]);return circlePixelIndexArrayCache[_t]=ti,ti}class ImageStyle{constructor(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=toSize(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new ImageStyle({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return abstract()}getImage(e){return abstract()}getHitDetectionImage(){return abstract()}getPixelRatio(e){return 1}getImageState(){return abstract()}getImageSize(){return abstract()}getOrigin(){return abstract()}getSize(){return abstract()}setDisplacement(e){this.displacement_=e}setOpacity(e){this.opacity_=e}setRotateWithView(e){this.rotateWithView_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=toSize(e)}listenImageChange(e){abstract()}load(){abstract()}unlistenImageChange(e){abstract()}ready(){return Promise.resolve()}}class RegularShape extends ImageStyle{constructor(e){super({opacity:1,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,rotation:e.rotation!==void 0?e.rotation:0,scale:e.scale!==void 0?e.scale:1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=e.fill!==void 0?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius=e.radius,this.radius2_=e.radius2,this.angle_=e.angle!==void 0?e.angle:0,this.stroke_=e.stroke!==void 0?e.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?ImageState.LOADING:ImageState.LOADED,this.imageState_===ImageState.LOADING&&this.ready().then(()=>this.imageState_=ImageState.LOADED),this.render()}clone(){const e=this.getScale(),n=new RegularShape({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return n.setOpacity(this.getOpacity()),n}getAnchor(){const e=this.size_,n=this.getDisplacement(),ei=this.getScaleArray();return[e[0]/2-n[0]/ei[0],e[1]/2+n[1]/ei[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(e){this.fill_=e,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(e){var ii,ri;const n=(ii=this.fill_)==null?void 0:ii.getKey(),ei=`${e},${this.angle_},${this.radius},${this.radius2_},${this.points_},${n}`+Object.values(this.renderOptions_).join(",");let ti=(ri=shared.get(ei,null,null))==null?void 0:ri.getImage(1);if(!ti){const ni=this.renderOptions_,si=Math.ceil(ni.size*e),ai=createCanvasContext2D(si,si);this.draw_(ni,ai,e),ti=ai.canvas,shared.set(ei,null,null,new IconImage(ti,void 0,null,ImageState.LOADED,null))}return ti}getPixelRatio(e){return e}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e,this.render()}listenImageChange(e){}load(){}unlistenImageChange(e){}calculateLineJoinSize_(e,n,ei){if(n===0||this.points_===1/0||e!=="bevel"&&e!=="miter")return n;let ti=this.radius,ii=this.radius2_===void 0?ti:this.radius2_;if(ti<ii){const Ai=ti;ti=ii,ii=Ai}const ri=this.radius2_===void 0?this.points_:this.points_*2,ni=2*Math.PI/ri,si=ii*Math.sin(ni),ai=Math.sqrt(ii*ii-si*si),oi=ti-ai,li=Math.sqrt(si*si+oi*oi),ci=li/si;if(e==="miter"&&ci<=ei)return ci*n;const ui=n/2/ci,di=n/2*(oi/li),hi=Math.sqrt((ti+ui)*(ti+ui)+di*di)-ti;if(this.radius2_===void 0||e==="bevel")return hi*2;const pi=ti*Math.sin(ni),gi=Math.sqrt(ti*ti-pi*pi),vi=ii-gi,_i=Math.sqrt(pi*pi+vi*vi)/pi;if(_i<=ei){const Ai=_i*n/2-ii-ti;return 2*Math.max(hi,Ai)}return hi*2}createRenderOptions(){let e=defaultLineCap,n=defaultLineJoin,ei=0,ti=null,ii=0,ri,ni=0;this.stroke_&&(ri=asColorLike(this.stroke_.getColor()??defaultStrokeStyle),ni=this.stroke_.getWidth()??defaultLineWidth,ti=this.stroke_.getLineDash(),ii=this.stroke_.getLineDashOffset()??0,n=this.stroke_.getLineJoin()??defaultLineJoin,e=this.stroke_.getLineCap()??defaultLineCap,ei=this.stroke_.getMiterLimit()??defaultMiterLimit);const si=this.calculateLineJoinSize_(n,ni,ei),ai=Math.max(this.radius,this.radius2_||0),oi=Math.ceil(2*ai+si);return{strokeStyle:ri,strokeWidth:ni,size:oi,lineCap:e,lineDash:ti,lineDashOffset:ii,lineJoin:n,miterLimit:ei}}render(){this.renderOptions_=this.createRenderOptions();const e=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[e,e]}draw_(e,n,ei){if(n.scale(ei,ei),n.translate(e.size/2,e.size/2),this.createPath_(n),this.fill_){let ti=this.fill_.getColor();ti===null&&(ti=defaultFillStyle),n.fillStyle=asColorLike(ti),n.fill()}e.strokeStyle&&(n.strokeStyle=e.strokeStyle,n.lineWidth=e.strokeWidth,e.lineDash&&(n.setLineDash(e.lineDash),n.lineDashOffset=e.lineDashOffset),n.lineCap=e.lineCap,n.lineJoin=e.lineJoin,n.miterLimit=e.miterLimit,n.stroke())}createHitDetectionCanvas_(e){let n;if(this.fill_){let ei=this.fill_.getColor(),ti=0;typeof ei=="string"&&(ei=asArray(ei)),ei===null?ti=1:Array.isArray(ei)&&(ti=ei.length===4?ei[3]:1),ti===0&&(n=createCanvasContext2D(e.size,e.size),this.drawHitDetectionCanvas_(e,n))}return n?n.canvas:this.getImage(1)}createPath_(e){let n=this.points_;const ei=this.radius;if(n===1/0)e.arc(0,0,ei,0,2*Math.PI);else{const ti=this.radius2_===void 0?ei:this.radius2_;this.radius2_!==void 0&&(n*=2);const ii=this.angle_-Math.PI/2,ri=2*Math.PI/n;for(let ni=0;ni<n;ni++){const si=ii+ni*ri,ai=ni%2===0?ei:ti;e.lineTo(ai*Math.cos(si),ai*Math.sin(si))}e.closePath()}}drawHitDetectionCanvas_(e,n){n.translate(e.size/2,e.size/2),this.createPath_(n),n.fillStyle=defaultFillStyle,n.fill(),e.strokeStyle&&(n.strokeStyle=e.strokeStyle,n.lineWidth=e.strokeWidth,e.lineDash&&(n.setLineDash(e.lineDash),n.lineDashOffset=e.lineDashOffset),n.lineJoin=e.lineJoin,n.miterLimit=e.miterLimit,n.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class CircleStyle extends RegularShape{constructor(e){e=e||{radius:5},super({points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:e.scale!==void 0?e.scale:1,rotation:e.rotation!==void 0?e.rotation:0,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode})}clone(){const e=this.getScale(),n=new CircleStyle({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return n.setOpacity(this.getOpacity()),n}setRadius(e){this.radius=e,this.render()}}class Fill{constructor(e){e=e||{},this.patternImage_=null,this.color_=null,e.color!==void 0&&this.setColor(e.color)}clone(){const e=this.getColor();return new Fill({color:Array.isArray(e)?e.slice():e||void 0})}getColor(){return this.color_}setColor(e){if(e!==null&&typeof e=="object"&&"src"in e){const n=get$2(null,e.src,"anonymous",void 0,e.offset?null:e.color?e.color:null,!(e.offset&&e.size));n.ready().then(()=>{this.patternImage_=null}),n.getImageState()===ImageState.IDLE&&n.load(),n.getImageState()===ImageState.LOADING&&(this.patternImage_=n)}this.color_=e}getKey(){const e=this.getColor();return e?e instanceof CanvasPattern||e instanceof CanvasGradient?getUid(e):typeof e=="object"&&"src"in e?e.src+":"+e.offset:asArray(e).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}function calculateScale(_t,e,n,ei){return n!==void 0&&ei!==void 0?[n/_t,ei/e]:n!==void 0?n/_t:ei!==void 0?ei/e:1}class Icon extends ImageStyle{constructor(e){e=e||{};const n=e.opacity!==void 0?e.opacity:1,ei=e.rotation!==void 0?e.rotation:0,ti=e.scale!==void 0?e.scale:1,ii=e.rotateWithView!==void 0?e.rotateWithView:!1;super({opacity:n,rotation:ei,scale:ti,displacement:e.displacement!==void 0?e.displacement:[0,0],rotateWithView:ii,declutterMode:e.declutterMode}),this.anchor_=e.anchor!==void 0?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=e.anchorOrigin!==void 0?e.anchorOrigin:"top-left",this.anchorXUnits_=e.anchorXUnits!==void 0?e.anchorXUnits:"fraction",this.anchorYUnits_=e.anchorYUnits!==void 0?e.anchorYUnits:"fraction",this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null;const ri=e.img!==void 0?e.img:null;let ni=e.src;assert(!(ni!==void 0&&ri),"`image` and `src` cannot be provided at the same time"),(ni===void 0||ni.length===0)&&ri&&(ni=ri.src||getUid(ri)),assert(ni!==void 0&&ni.length>0,"A defined and non-empty `src` or `image` must be provided"),assert(!((e.width!==void 0||e.height!==void 0)&&e.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let si;if(e.src!==void 0?si=ImageState.IDLE:ri!==void 0&&("complete"in ri?ri.complete?si=ri.src?ImageState.LOADED:ImageState.IDLE:si=ImageState.LOADING:si=ImageState.LOADED),this.color_=e.color!==void 0?asArray(e.color):null,this.iconImage_=get$2(ri,ni,this.crossOrigin_,si,this.color_),this.offset_=e.offset!==void 0?e.offset:[0,0],this.offsetOrigin_=e.offsetOrigin!==void 0?e.offsetOrigin:"top-left",this.origin_=null,this.size_=e.size!==void 0?e.size:null,this.initialOptions_,e.width!==void 0||e.height!==void 0){let ai,oi;if(e.size)[ai,oi]=e.size;else{const li=this.getImage(1);if(li.width&&li.height)ai=li.width,oi=li.height;else if(li instanceof HTMLImageElement){this.initialOptions_=e;const ci=()=>{if(this.unlistenImageChange(ci),!this.initialOptions_)return;const ui=this.iconImage_.getSize();this.setScale(calculateScale(ui[0],ui[1],e.width,e.height))};this.listenImageChange(ci);return}}ai!==void 0&&this.setScale(calculateScale(ai,oi,e.width,e.height))}}clone(){let e,n,ei;return this.initialOptions_?(n=this.initialOptions_.width,ei=this.initialOptions_.height):(e=this.getScale(),e=Array.isArray(e)?e.slice():e),new Icon({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:e,width:n,height:ei,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let e=this.normalizedAnchor_;if(!e){e=this.anchor_;const ti=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!ti)return null;e=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(e[0]*=ti[0]),this.anchorYUnits_=="fraction"&&(e[1]*=ti[1])}if(this.anchorOrigin_!="top-left"){if(!ti)return null;e===this.anchor_&&(e=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(e[0]=-e[0]+ti[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(e[1]=-e[1]+ti[1])}this.normalizedAnchor_=e}const n=this.getDisplacement(),ei=this.getScaleArray();return[e[0]-n[0]/ei[0],e[1]+n[1]/ei[1]]}setAnchor(e){this.anchor_=e,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(e){return this.iconImage_.getImage(e)}getPixelRatio(e){return this.iconImage_.getPixelRatio(e)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let e=this.offset_;if(this.offsetOrigin_!="top-left"){const n=this.getSize(),ei=this.iconImage_.getSize();if(!n||!ei)return null;e=e.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(e[0]=ei[0]-n[0]-e[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(e[1]=ei[1]-n[1]-e[1])}return this.origin_=e,this.origin_}getSrc(){return this.iconImage_.getSrc()}setSrc(e){this.iconImage_=get$2(null,e,this.crossOrigin_,ImageState.IDLE,this.color_)}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const e=this.getScaleArray();if(this.size_)return this.size_[0]*e[0];if(this.iconImage_.getImageState()==ImageState.LOADED)return this.iconImage_.getSize()[0]*e[0]}getHeight(){const e=this.getScaleArray();if(this.size_)return this.size_[1]*e[1];if(this.iconImage_.getImageState()==ImageState.LOADED)return this.iconImage_.getSize()[1]*e[1]}setScale(e){delete this.initialOptions_,super.setScale(e)}listenImageChange(e){this.iconImage_.addEventListener(EventType.CHANGE,e)}load(){this.iconImage_.load()}unlistenImageChange(e){this.iconImage_.removeEventListener(EventType.CHANGE,e)}ready(){return this.iconImage_.ready()}}class Stroke{constructor(e){e=e||{},this.color_=e.color!==void 0?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=e.lineDash!==void 0?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}clone(){const e=this.getColor();return new Stroke({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(e){this.color_=e}setLineCap(e){this.lineCap_=e}setLineDash(e){this.lineDash_=e}setLineDashOffset(e){this.lineDashOffset_=e}setLineJoin(e){this.lineJoin_=e}setMiterLimit(e){this.miterLimit_=e}setWidth(e){this.width_=e}}let Style$1=class Vc{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=defaultGeometryFunction,e.geometry!==void 0&&this.setGeometry(e.geometry),this.fill_=e.fill!==void 0?e.fill:null,this.image_=e.image!==void 0?e.image:null,this.renderer_=e.renderer!==void 0?e.renderer:null,this.hitDetectionRenderer_=e.hitDetectionRenderer!==void 0?e.hitDetectionRenderer:null,this.stroke_=e.stroke!==void 0?e.stroke:null,this.text_=e.text!==void 0?e.text:null,this.zIndex_=e.zIndex}clone(){let e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new Vc({geometry:e??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(e){this.renderer_=e}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(e){this.fill_=e}getImage(){return this.image_}setImage(e){this.image_=e}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e}getText(){return this.text_}setText(e){this.text_=e}getZIndex(){return this.zIndex_}setGeometry(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(n){return n.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=defaultGeometryFunction,this.geometry_=e}setZIndex(e){this.zIndex_=e}};function toFunction(_t){let e;if(typeof _t=="function")e=_t;else{let n;Array.isArray(_t)?n=_t:(assert(typeof _t.getZIndex=="function","Expected an `Style` or an array of `Style`"),n=[_t]),e=function(){return n}}return e}let defaultStyles=null;function createDefaultStyle(_t,e){if(!defaultStyles){const n=new Fill({color:"rgba(255,255,255,0.4)"}),ei=new Stroke({color:"#3399CC",width:1.25});defaultStyles=[new Style$1({image:new CircleStyle({fill:n,stroke:ei,radius:5}),fill:n,stroke:ei})]}return defaultStyles}function createEditingStyle(){const _t={},e=[255,255,255,1],n=[0,153,255,1],ei=3;return _t.Polygon=[new Style$1({fill:new Fill({color:[255,255,255,.5]})})],_t.MultiPolygon=_t.Polygon,_t.LineString=[new Style$1({stroke:new Stroke({color:e,width:ei+2})}),new Style$1({stroke:new Stroke({color:n,width:ei})})],_t.MultiLineString=_t.LineString,_t.Circle=_t.Polygon.concat(_t.LineString),_t.Point=[new Style$1({image:new CircleStyle({radius:ei*2,fill:new Fill({color:n}),stroke:new Stroke({color:e,width:ei/2})}),zIndex:1/0})],_t.MultiPoint=_t.Point,_t.GeometryCollection=_t.Polygon.concat(_t.LineString,_t.Point),_t}function defaultGeometryFunction(_t){return _t.getGeometry()}const DEFAULT_FILL_COLOR="#333";class Text{constructor(e){e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.keepUpright_=e.keepUpright,this.scale_=e.scale,this.scaleArray_=toSize(e.scale!==void 0?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=e.fill!==void 0?e.fill:new Fill({color:DEFAULT_FILL_COLOR}),this.maxAngle_=e.maxAngle!==void 0?e.maxAngle:Math.PI/4,this.placement_=e.placement!==void 0?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=e.stroke!==void 0?e.stroke:null,this.offsetX_=e.offsetX!==void 0?e.offsetX:0,this.offsetY_=e.offsetY!==void 0?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=e.padding===void 0?null:e.padding,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new Text({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()instanceof Fill?this.getFill().clone():this.getFill(),stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(e){this.overflow_=e}setFont(e){this.font_=e}setMaxAngle(e){this.maxAngle_=e}setOffsetX(e){this.offsetX_=e}setOffsetY(e){this.offsetY_=e}setPlacement(e){this.placement_=e}setRepeat(e){this.repeat_=e}setRotateWithView(e){this.rotateWithView_=e}setKeepUpright(e){this.keepUpright_=e}setFill(e){this.fill_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=toSize(e!==void 0?e:1)}setStroke(e){this.stroke_=e}setText(e){this.text_=e}setTextAlign(e){this.textAlign_=e}setJustify(e){this.justify_=e}setTextBaseline(e){this.textBaseline_=e}setBackgroundFill(e){this.backgroundFill_=e}setBackgroundStroke(e){this.backgroundStroke_=e}setPadding(e){this.padding_=e}}class CanvasImmediateRenderer extends VectorContext{constructor(e,n,ei,ti,ii,ri,ni){super(),this.context_=e,this.pixelRatio_=n,this.extent_=ei,this.transform_=ti,this.transformRotation_=ti?toFixed(Math.atan2(ti[1],ti[0]),10):0,this.viewRotation_=ii,this.squaredTolerance_=ri,this.userTransform_=ni,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=create()}drawImages_(e,n,ei,ti){if(!this.image_)return;const ii=transform2D(e,n,ei,ti,this.transform_,this.pixelCoordinates_),ri=this.context_,ni=this.tmpLocalTransform_,si=ri.globalAlpha;this.imageOpacity_!=1&&(ri.globalAlpha=si*this.imageOpacity_);let ai=this.imageRotation_;this.transformRotation_===0&&(ai-=this.viewRotation_),this.imageRotateWithView_&&(ai+=this.viewRotation_);for(let oi=0,li=ii.length;oi<li;oi+=2){const ci=ii[oi]-this.imageAnchorX_,ui=ii[oi+1]-this.imageAnchorY_;if(ai!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const di=ci+this.imageAnchorX_,fi=ui+this.imageAnchorY_;compose(ni,di,fi,1,1,ai,-di,-fi),ri.save(),ri.transform.apply(ri,ni),ri.translate(di,fi),ri.scale(this.imageScale_[0],this.imageScale_[1]),ri.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),ri.restore()}else ri.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,ci,ui,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(ri.globalAlpha=si)}drawText_(e,n,ei,ti){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const ii=transform2D(e,n,ei,ti,this.transform_,this.pixelCoordinates_),ri=this.context_;let ni=this.textRotation_;for(this.transformRotation_===0&&(ni-=this.viewRotation_),this.textRotateWithView_&&(ni+=this.viewRotation_);n<ei;n+=ti){const si=ii[n]+this.textOffsetX_,ai=ii[n+1]+this.textOffsetY_;ni!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(ri.save(),ri.translate(si-this.textOffsetX_,ai-this.textOffsetY_),ri.rotate(ni),ri.translate(this.textOffsetX_,this.textOffsetY_),ri.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&ri.strokeText(this.text_,0,0),this.textFillState_&&ri.fillText(this.text_,0,0),ri.restore()):(this.textStrokeState_&&ri.strokeText(this.text_,si,ai),this.textFillState_&&ri.fillText(this.text_,si,ai))}}moveToLineTo_(e,n,ei,ti,ii){const ri=this.context_,ni=transform2D(e,n,ei,ti,this.transform_,this.pixelCoordinates_);ri.moveTo(ni[0],ni[1]);let si=ni.length;ii&&(si-=2);for(let ai=2;ai<si;ai+=2)ri.lineTo(ni[ai],ni[ai+1]);return ii&&ri.closePath(),ei}drawRings_(e,n,ei,ti){for(let ii=0,ri=ei.length;ii<ri;++ii)n=this.moveToLineTo_(e,n,ei[ii],ti,!0);return n}drawCircle(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!intersects$1(this.extent_,e.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const n=transformGeom2D(e,this.transform_,this.pixelCoordinates_),ei=n[2]-n[0],ti=n[3]-n[1],ii=Math.sqrt(ei*ei+ti*ti),ri=this.context_;ri.beginPath(),ri.arc(n[0],n[1],ii,0,2*Math.PI),this.fillState_&&ri.fill(),this.strokeState_&&ri.stroke()}this.text_!==""&&this.drawText_(e.getCenter(),0,2,2)}}setStyle(e){this.setFillStrokeStyle(e.getFill(),e.getStroke()),this.setImageStyle(e.getImage()),this.setTextStyle(e.getText())}setTransform(e){this.transform_=e}drawGeometry(e){switch(e.getType()){case"Point":this.drawPoint(e);break;case"LineString":this.drawLineString(e);break;case"Polygon":this.drawPolygon(e);break;case"MultiPoint":this.drawMultiPoint(e);break;case"MultiLineString":this.drawMultiLineString(e);break;case"MultiPolygon":this.drawMultiPolygon(e);break;case"GeometryCollection":this.drawGeometryCollection(e);break;case"Circle":this.drawCircle(e);break}}drawFeature(e,n){const ei=n.getGeometryFunction()(e);ei&&(this.setStyle(n),this.drawGeometry(ei))}drawGeometryCollection(e){const n=e.getGeometriesArray();for(let ei=0,ti=n.length;ei<ti;++ei)this.drawGeometry(n[ei])}drawPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const n=e.getFlatCoordinates(),ei=e.getStride();this.image_&&this.drawImages_(n,0,n.length,ei),this.text_!==""&&this.drawText_(n,0,n.length,ei)}drawMultiPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const n=e.getFlatCoordinates(),ei=e.getStride();this.image_&&this.drawImages_(n,0,n.length,ei),this.text_!==""&&this.drawText_(n,0,n.length,ei)}drawLineString(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!intersects$1(this.extent_,e.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const n=this.context_,ei=e.getFlatCoordinates();n.beginPath(),this.moveToLineTo_(ei,0,ei.length,e.getStride(),!1),n.stroke()}if(this.text_!==""){const n=e.getFlatMidpoint();this.drawText_(n,0,2,2)}}}drawMultiLineString(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const n=e.getExtent();if(intersects$1(this.extent_,n)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const ei=this.context_,ti=e.getFlatCoordinates();let ii=0;const ri=e.getEnds(),ni=e.getStride();ei.beginPath();for(let si=0,ai=ri.length;si<ai;++si)ii=this.moveToLineTo_(ti,ii,ri[si],ni,!1);ei.stroke()}if(this.text_!==""){const ei=e.getFlatMidpoints();this.drawText_(ei,0,ei.length,2)}}}drawPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!intersects$1(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const n=this.context_;n.beginPath(),this.drawRings_(e.getOrientedFlatCoordinates(),0,e.getEnds(),e.getStride()),this.fillState_&&n.fill(),this.strokeState_&&n.stroke()}if(this.text_!==""){const n=e.getFlatInteriorPoint();this.drawText_(n,0,2,2)}}}drawMultiPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!intersects$1(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const n=this.context_,ei=e.getOrientedFlatCoordinates();let ti=0;const ii=e.getEndss(),ri=e.getStride();n.beginPath();for(let ni=0,si=ii.length;ni<si;++ni){const ai=ii[ni];ti=this.drawRings_(ei,ti,ai,ri)}this.fillState_&&n.fill(),this.strokeState_&&n.stroke()}if(this.text_!==""){const n=e.getFlatInteriorPoints();this.drawText_(n,0,n.length,2)}}}setContextFillState_(e){const n=this.context_,ei=this.contextFillState_;ei?ei.fillStyle!=e.fillStyle&&(ei.fillStyle=e.fillStyle,n.fillStyle=e.fillStyle):(n.fillStyle=e.fillStyle,this.contextFillState_={fillStyle:e.fillStyle})}setContextStrokeState_(e){const n=this.context_,ei=this.contextStrokeState_;ei?(ei.lineCap!=e.lineCap&&(ei.lineCap=e.lineCap,n.lineCap=e.lineCap),equals(ei.lineDash,e.lineDash)||n.setLineDash(ei.lineDash=e.lineDash),ei.lineDashOffset!=e.lineDashOffset&&(ei.lineDashOffset=e.lineDashOffset,n.lineDashOffset=e.lineDashOffset),ei.lineJoin!=e.lineJoin&&(ei.lineJoin=e.lineJoin,n.lineJoin=e.lineJoin),ei.lineWidth!=e.lineWidth&&(ei.lineWidth=e.lineWidth,n.lineWidth=e.lineWidth),ei.miterLimit!=e.miterLimit&&(ei.miterLimit=e.miterLimit,n.miterLimit=e.miterLimit),ei.strokeStyle!=e.strokeStyle&&(ei.strokeStyle=e.strokeStyle,n.strokeStyle=e.strokeStyle)):(n.lineCap=e.lineCap,n.setLineDash(e.lineDash),n.lineDashOffset=e.lineDashOffset,n.lineJoin=e.lineJoin,n.lineWidth=e.lineWidth,n.miterLimit=e.miterLimit,n.strokeStyle=e.strokeStyle,this.contextStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle})}setContextTextState_(e){const n=this.context_,ei=this.contextTextState_,ti=e.textAlign?e.textAlign:defaultTextAlign;ei?(ei.font!=e.font&&(ei.font=e.font,n.font=e.font),ei.textAlign!=ti&&(ei.textAlign=ti,n.textAlign=ti),ei.textBaseline!=e.textBaseline&&(ei.textBaseline=e.textBaseline,n.textBaseline=e.textBaseline)):(n.font=e.font,n.textAlign=ti,n.textBaseline=e.textBaseline,this.contextTextState_={font:e.font,textAlign:ti,textBaseline:e.textBaseline})}setFillStrokeStyle(e,n){if(!e)this.fillState_=null;else{const ei=e.getColor();this.fillState_={fillStyle:asColorLike(ei||defaultFillStyle)}}if(!n)this.strokeState_=null;else{const ei=n.getColor(),ti=n.getLineCap(),ii=n.getLineDash(),ri=n.getLineDashOffset(),ni=n.getLineJoin(),si=n.getWidth(),ai=n.getMiterLimit(),oi=ii||defaultLineDash;this.strokeState_={lineCap:ti!==void 0?ti:defaultLineCap,lineDash:this.pixelRatio_===1?oi:oi.map(li=>li*this.pixelRatio_),lineDashOffset:(ri||defaultLineDashOffset)*this.pixelRatio_,lineJoin:ni!==void 0?ni:defaultLineJoin,lineWidth:(si!==void 0?si:defaultLineWidth)*this.pixelRatio_,miterLimit:ai!==void 0?ai:defaultMiterLimit,strokeStyle:asColorLike(ei||defaultStrokeStyle)}}}setImageStyle(e){let n;if(!e||!(n=e.getSize())){this.image_=null;return}const ei=e.getPixelRatio(this.pixelRatio_),ti=e.getAnchor(),ii=e.getOrigin();this.image_=e.getImage(this.pixelRatio_),this.imageAnchorX_=ti[0]*ei,this.imageAnchorY_=ti[1]*ei,this.imageHeight_=n[1]*ei,this.imageOpacity_=e.getOpacity(),this.imageOriginX_=ii[0],this.imageOriginY_=ii[1],this.imageRotateWithView_=e.getRotateWithView(),this.imageRotation_=e.getRotation();const ri=e.getScaleArray();this.imageScale_=[ri[0]*this.pixelRatio_/ei,ri[1]*this.pixelRatio_/ei],this.imageWidth_=n[0]*ei}setTextStyle(e){if(!e)this.text_="";else{const n=e.getFill();if(!n)this.textFillState_=null;else{const ui=n.getColor();this.textFillState_={fillStyle:asColorLike(ui||defaultFillStyle)}}const ei=e.getStroke();if(!ei)this.textStrokeState_=null;else{const ui=ei.getColor(),di=ei.getLineCap(),fi=ei.getLineDash(),hi=ei.getLineDashOffset(),pi=ei.getLineJoin(),gi=ei.getWidth(),vi=ei.getMiterLimit();this.textStrokeState_={lineCap:di!==void 0?di:defaultLineCap,lineDash:fi||defaultLineDash,lineDashOffset:hi||defaultLineDashOffset,lineJoin:pi!==void 0?pi:defaultLineJoin,lineWidth:gi!==void 0?gi:defaultLineWidth,miterLimit:vi!==void 0?vi:defaultMiterLimit,strokeStyle:asColorLike(ui||defaultStrokeStyle)}}const ti=e.getFont(),ii=e.getOffsetX(),ri=e.getOffsetY(),ni=e.getRotateWithView(),si=e.getRotation(),ai=e.getScaleArray(),oi=e.getText(),li=e.getTextAlign(),ci=e.getTextBaseline();this.textState_={font:ti!==void 0?ti:defaultFont,textAlign:li!==void 0?li:defaultTextAlign,textBaseline:ci!==void 0?ci:defaultTextBaseline},this.text_=oi!==void 0?Array.isArray(oi)?oi.reduce((ui,di,fi)=>ui+=fi%2?" ":di,""):oi:"",this.textOffsetX_=ii!==void 0?this.pixelRatio_*ii:0,this.textOffsetY_=ri!==void 0?this.pixelRatio_*ri:0,this.textRotateWithView_=ni!==void 0?ni:!1,this.textRotation_=si!==void 0?si:0,this.textScale_=[this.pixelRatio_*ai[0],this.pixelRatio_*ai[1]]}}}const HIT_DETECT_RESOLUTION=.5;function createHitDetectionImageData(_t,e,n,ei,ti,ii,ri,ni,si){const ai=si?toUserExtent(ti):ti,oi=_t[0]*HIT_DETECT_RESOLUTION,li=_t[1]*HIT_DETECT_RESOLUTION,ci=createCanvasContext2D(oi,li);ci.imageSmoothingEnabled=!1;const ui=ci.canvas,di=new CanvasImmediateRenderer(ci,HIT_DETECT_RESOLUTION,ti,null,ri,ni,si?getTransformFromProjections(getUserProjection(),si):null),fi=n.length,hi=Math.floor((256*256*256-1)/fi),pi={};for(let vi=1;vi<=fi;++vi){const yi=n[vi-1],_i=yi.getStyleFunction()||ei;if(!_i)continue;let Ai=_i(yi,ii);if(!Ai)continue;Array.isArray(Ai)||(Ai=[Ai]);const Si=(vi*hi).toString(16).padStart(7,"#00000");for(let wi=0,Oi=Ai.length;wi<Oi;++wi){const Ii=Ai[wi],Li=Ii.getGeometryFunction()(yi);if(!Li||!intersects$1(ai,Li.getExtent()))continue;const Di=Ii.clone(),Ni=Di.getFill();Ni&&Ni.setColor(Si);const $i=Di.getStroke();$i&&($i.setColor(Si),$i.setLineDash(null)),Di.setText(void 0);const Ki=Ii.getImage();if(Ki){const zi=Ki.getImageSize();if(!zi)continue;const Wi=createCanvasContext2D(zi[0],zi[1],void 0,{alpha:!1}),Ti=Wi.canvas;Wi.fillStyle=Si,Wi.fillRect(0,0,Ti.width,Ti.height),Di.setImage(new Icon({img:Ti,anchor:Ki.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:Ki.getOrigin(),opacity:1,size:Ki.getSize(),scale:Ki.getScale(),rotation:Ki.getRotation(),rotateWithView:Ki.getRotateWithView()}))}const er=Di.getZIndex()||0;let Vi=pi[er];Vi||(Vi={},pi[er]=Vi,Vi.Polygon=[],Vi.Circle=[],Vi.LineString=[],Vi.Point=[]);const nr=Li.getType();if(nr==="GeometryCollection"){const zi=Li.getGeometriesArrayRecursive();for(let Wi=0,Ti=zi.length;Wi<Ti;++Wi){const ki=zi[Wi];Vi[ki.getType().replace("Multi","")].push(ki,Di)}}else Vi[nr.replace("Multi","")].push(Li,Di)}}const gi=Object.keys(pi).map(Number).sort(ascending);for(let vi=0,yi=gi.length;vi<yi;++vi){const _i=pi[gi[vi]];for(const Ai in _i){const Ei=_i[Ai];for(let Si=0,wi=Ei.length;Si<wi;Si+=2){di.setStyle(Ei[Si+1]);for(let Oi=0,Ii=e.length;Oi<Ii;++Oi)di.setTransform(e[Oi]),di.drawGeometry(Ei[Si])}}}return ci.getImageData(0,0,ui.width,ui.height)}function hitDetect(_t,e,n){const ei=[];if(n){const ti=Math.floor(Math.round(_t[0])*HIT_DETECT_RESOLUTION),ii=Math.floor(Math.round(_t[1])*HIT_DETECT_RESOLUTION),ri=(clamp$1(ti,0,n.width-1)+clamp$1(ii,0,n.height-1)*n.width)*4,ni=n.data[ri],si=n.data[ri+1],oi=n.data[ri+2]+256*(si+256*ni),li=Math.floor((256*256*256-1)/e.length);oi&&oi%li===0&&ei.push(e[oi/li-1])}return ei}const SIMPLIFY_TOLERANCE=.5,GEOMETRY_RENDERERS={Point:renderPointGeometry,LineString:renderLineStringGeometry,Polygon:renderPolygonGeometry,MultiPoint:renderMultiPointGeometry,MultiLineString:renderMultiLineStringGeometry,MultiPolygon:renderMultiPolygonGeometry,GeometryCollection:renderGeometryCollectionGeometry,Circle:renderCircleGeometry};function defaultOrder(_t,e){return parseInt(getUid(_t),10)-parseInt(getUid(e),10)}function getSquaredTolerance(_t,e){const n=getTolerance(_t,e);return n*n}function getTolerance(_t,e){return SIMPLIFY_TOLERANCE*_t/e}function renderCircleGeometry(_t,e,n,ei,ti){const ii=n.getFill(),ri=n.getStroke();if(ii||ri){const si=_t.getBuilder(n.getZIndex(),"Circle");si.setFillStrokeStyle(ii,ri),si.drawCircle(e,ei,ti)}const ni=n.getText();if(ni&&ni.getText()){const si=_t.getBuilder(n.getZIndex(),"Text");si.setTextStyle(ni),si.drawText(e,ei)}}function renderFeature$1(_t,e,n,ei,ti,ii,ri,ni){const si=[],ai=n.getImage();if(ai){let ci=!0;const ui=ai.getImageState();ui==ImageState.LOADED||ui==ImageState.ERROR?ci=!1:ui==ImageState.IDLE&&ai.load(),ci&&si.push(ai.ready())}const oi=n.getFill();oi&&oi.loading()&&si.push(oi.ready());const li=si.length>0;return li&&Promise.all(si).then(()=>ti(null)),renderFeatureInternal(_t,e,n,ei,ii,ri,ni),li}function renderFeatureInternal(_t,e,n,ei,ti,ii,ri){const ni=n.getGeometryFunction()(e);if(!ni)return;const si=ni.simplifyTransformed(ei,ti);if(n.getRenderer())renderGeometry(_t,si,n,e,ri);else{const oi=GEOMETRY_RENDERERS[si.getType()];oi(_t,si,n,e,ri,ii)}}function renderGeometry(_t,e,n,ei,ti){if(e.getType()=="GeometryCollection"){const ri=e.getGeometries();for(let ni=0,si=ri.length;ni<si;++ni)renderGeometry(_t,ri[ni],n,ei,ti);return}_t.getBuilder(n.getZIndex(),"Default").drawCustom(e,ei,n.getRenderer(),n.getHitDetectionRenderer(),ti)}function renderGeometryCollectionGeometry(_t,e,n,ei,ti,ii){const ri=e.getGeometriesArray();let ni,si;for(ni=0,si=ri.length;ni<si;++ni){const ai=GEOMETRY_RENDERERS[ri[ni].getType()];ai(_t,ri[ni],n,ei,ti,ii)}}function renderLineStringGeometry(_t,e,n,ei,ti){const ii=n.getStroke();if(ii){const ni=_t.getBuilder(n.getZIndex(),"LineString");ni.setFillStrokeStyle(null,ii),ni.drawLineString(e,ei,ti)}const ri=n.getText();if(ri&&ri.getText()){const ni=_t.getBuilder(n.getZIndex(),"Text");ni.setTextStyle(ri),ni.drawText(e,ei,ti)}}function renderMultiLineStringGeometry(_t,e,n,ei,ti){const ii=n.getStroke();if(ii){const ni=_t.getBuilder(n.getZIndex(),"LineString");ni.setFillStrokeStyle(null,ii),ni.drawMultiLineString(e,ei,ti)}const ri=n.getText();if(ri&&ri.getText()){const ni=_t.getBuilder(n.getZIndex(),"Text");ni.setTextStyle(ri),ni.drawText(e,ei,ti)}}function renderMultiPolygonGeometry(_t,e,n,ei,ti){const ii=n.getFill(),ri=n.getStroke();if(ri||ii){const si=_t.getBuilder(n.getZIndex(),"Polygon");si.setFillStrokeStyle(ii,ri),si.drawMultiPolygon(e,ei,ti)}const ni=n.getText();if(ni&&ni.getText()){const si=_t.getBuilder(n.getZIndex(),"Text");si.setTextStyle(ni),si.drawText(e,ei,ti)}}function renderPointGeometry(_t,e,n,ei,ti,ii){const ri=n.getImage(),ni=n.getText(),si=ni&&ni.getText(),ai=ii&&ri&&si?{}:void 0;if(ri){if(ri.getImageState()!=ImageState.LOADED)return;const oi=_t.getBuilder(n.getZIndex(),"Image");oi.setImageStyle(ri,ai),oi.drawPoint(e,ei,ti)}if(si){const oi=_t.getBuilder(n.getZIndex(),"Text");oi.setTextStyle(ni,ai),oi.drawText(e,ei,ti)}}function renderMultiPointGeometry(_t,e,n,ei,ti,ii){const ri=n.getImage(),ni=ri&&ri.getOpacity()!==0,si=n.getText(),ai=si&&si.getText(),oi=ii&&ni&&ai?{}:void 0;if(ni){if(ri.getImageState()!=ImageState.LOADED)return;const li=_t.getBuilder(n.getZIndex(),"Image");li.setImageStyle(ri,oi),li.drawMultiPoint(e,ei,ti)}if(ai){const li=_t.getBuilder(n.getZIndex(),"Text");li.setTextStyle(si,oi),li.drawText(e,ei,ti)}}function renderPolygonGeometry(_t,e,n,ei,ti){const ii=n.getFill(),ri=n.getStroke();if(ii||ri){const si=_t.getBuilder(n.getZIndex(),"Polygon");si.setFillStrokeStyle(ii,ri),si.drawPolygon(e,ei,ti)}const ni=n.getText();if(ni&&ni.getText()){const si=_t.getBuilder(n.getZIndex(),"Text");si.setTextStyle(ni),si.drawText(e,ei,ti)}}class RenderEvent extends BaseEvent{constructor(e,n,ei,ti){super(e),this.inversePixelTransform=n,this.frameState=ei,this.context=ti}}const maxStaleKeys=5;class LayerRenderer extends Observable{constructor(e){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e,this.staleKeys_=new Array,this.maxStaleKeys=maxStaleKeys}getStaleKeys(){return this.staleKeys_}prependStaleKey(e){this.staleKeys_.unshift(e),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(e){return abstract()}getData(e){return null}prepareFrame(e){return abstract()}renderFrame(e,n){return abstract()}forEachFeatureAtCoordinate(e,n,ei,ti,ii){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(e){const n=e.target;(n.getState()===ImageState.LOADED||n.getState()===ImageState.ERROR)&&this.renderIfReadyAndVisible()}loadImage(e){let n=e.getState();return n!=ImageState.LOADED&&n!=ImageState.ERROR&&e.addEventListener(EventType.CHANGE,this.boundHandleImageChange_),n==ImageState.IDLE&&(e.load(),n=e.getState()),n==ImageState.LOADED}renderIfReadyAndVisible(){const e=this.getLayer();e&&e.getVisible()&&e.getSourceState()==="ready"&&e.changed()}renderDeferred(e){}disposeInternal(){delete this.layer_,super.disposeInternal()}}const canvasPool=[];let pixelContext=null;function createPixelContext(){pixelContext=createCanvasContext2D(1,1,void 0,{willReadFrequently:!0})}class CanvasLayerRenderer extends LayerRenderer{constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=create(),this.pixelTransform=create(),this.inversePixelTransform=create(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(e,n,ei){pixelContext||createPixelContext(),pixelContext.clearRect(0,0,1,1);let ti;try{pixelContext.drawImage(e,n,ei,1,1,0,0,1,1),ti=pixelContext.getImageData(0,0,1,1).data}catch{return pixelContext=null,null}return ti}getBackground(e){let ei=this.getLayer().getBackground();return typeof ei=="function"&&(ei=ei(e.viewState.resolution)),ei||void 0}useContainer(e,n,ei){const ti=this.getLayer().getClassName();let ii,ri;if(e&&e.className===ti&&(!ei||e&&e.style.backgroundColor&&equals(asArray(e.style.backgroundColor),asArray(ei)))){const ni=e.firstElementChild;isCanvas(ni)&&(ri=ni.getContext("2d"))}if(ri&&equivalent(ri.canvas.style.transform,n)?(this.container=e,this.context=ri,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){ii=WORKER_OFFSCREEN_CANVAS?createMockDiv():document.createElement("div"),ii.className=ti;let ni=ii.style;ni.position="absolute",ni.width="100%",ni.height="100%",ri=createCanvasContext2D();const si=ri.canvas;ii.appendChild(si),ni=si.style,ni.position="absolute",ni.left="0",ni.transformOrigin="top left",this.container=ii,this.context=ri}!this.containerReused&&ei&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=ei)}clipUnrotated(e,n,ei){const ti=getTopLeft(ei),ii=getTopRight(ei),ri=getBottomRight(ei),ni=getBottomLeft(ei);apply(n.coordinateToPixelTransform,ti),apply(n.coordinateToPixelTransform,ii),apply(n.coordinateToPixelTransform,ri),apply(n.coordinateToPixelTransform,ni);const si=this.inversePixelTransform;apply(si,ti),apply(si,ii),apply(si,ri),apply(si,ni),e.save(),e.beginPath(),e.moveTo(Math.round(ti[0]),Math.round(ti[1])),e.lineTo(Math.round(ii[0]),Math.round(ii[1])),e.lineTo(Math.round(ri[0]),Math.round(ri[1])),e.lineTo(Math.round(ni[0]),Math.round(ni[1])),e.clip()}prepareContainer(e,n){const ei=e.extent,ti=e.viewState.resolution,ii=e.viewState.rotation,ri=e.pixelRatio,ni=Math.round(getWidth(ei)/ti*ri),si=Math.round(getHeight(ei)/ti*ri);compose(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/ri,1/ri,ii,-ni/2,-si/2),makeInverse(this.inversePixelTransform,this.pixelTransform);const ai=toString$2(this.pixelTransform);if(this.useContainer(n,ai,this.getBackground(e)),!this.containerReused){const oi=this.context.canvas;oi.width!=ni||oi.height!=si?(oi.width=ni,oi.height=si):this.context.clearRect(0,0,ni,si),ai!==oi.style.transform&&(oi.style.transform=ai)}}dispatchRenderEvent_(e,n,ei){const ti=this.getLayer();if(ti.hasListener(e)){const ii=new RenderEvent(e,this.inversePixelTransform,ei,n);ti.dispatchEvent(ii)}}preRender(e,n){this.frameState=n,!n.declutter&&this.dispatchRenderEvent_(RenderEventType.PRERENDER,e,n)}postRender(e,n){n.declutter||this.dispatchRenderEvent_(RenderEventType.POSTRENDER,e,n)}renderDeferredInternal(e){}getRenderContext(e){return e.declutter&&!this.deferredContext_&&(this.deferredContext_=new ZIndexContext),e.declutter?this.deferredContext_.getContext():this.context}renderDeferred(e){e.declutter&&(this.dispatchRenderEvent_(RenderEventType.PRERENDER,this.context,e),e.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(e),this.dispatchRenderEvent_(RenderEventType.POSTRENDER,this.context,e))}getRenderTransform(e,n,ei,ti,ii,ri,ni){const si=ii/2,ai=ri/2,oi=ti/n,li=-oi,ci=-e[0]+ni,ui=-e[1];return compose(this.tempTransform,si,ai,oi,li,-ei,ci,ui)}disposeInternal(){delete this.frameState,super.disposeInternal()}}class CanvasVectorLayerRenderer extends CanvasLayerRenderer{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=createEmpty(),this.wrappedRenderedExtent_=createEmpty(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(e,n,ei){const ti=n.extent,ii=n.viewState,ri=ii.center,ni=ii.resolution,si=ii.projection,ai=ii.rotation,oi=si.getExtent(),li=this.getLayer().getSource(),ci=this.getLayer().getDeclutter(),ui=n.pixelRatio,di=n.viewHints,fi=!(di[ViewHint.ANIMATING]||di[ViewHint.INTERACTING]),hi=this.context,pi=Math.round(getWidth(ti)/ni*ui),gi=Math.round(getHeight(ti)/ni*ui),vi=li.getWrapX()&&si.canWrapX(),yi=vi?getWidth(oi):null,_i=vi?Math.ceil((ti[2]-oi[2])/yi)+1:1;let Ai=vi?Math.floor((ti[0]-oi[0])/yi):0;do{let Ei=this.getRenderTransform(ri,ni,0,ui,pi,gi,Ai*yi);n.declutter&&(Ei=Ei.slice(0)),e.execute(hi,[hi.canvas.width,hi.canvas.height],Ei,ai,fi,ei===void 0?ALL:ei?DECLUTTER:NON_DECLUTTER,ei?ci&&n.declutter[ci]:void 0)}while(++Ai<_i)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=createCanvasContext2D(this.context.canvas.width,this.context.canvas.height,canvasPool))}resetDrawContext_(){if(this.opacity_!==1&&this.targetContext_){const e=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=e,releaseCanvas(this.context),canvasPool.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(e){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,e,!0)}renderDeferredInternal(e){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(e,n){const ei=e.layerStatesArray[e.layerIndex];this.opacity_=ei.opacity;const ti=e.viewState;this.prepareContainer(e,n);const ii=this.context,ri=this.replayGroup_;let ni=ri&&!ri.isEmpty();if(!ni&&!(this.getLayer().hasListener(RenderEventType.PRERENDER)||this.getLayer().hasListener(RenderEventType.POSTRENDER)))return this.container;if(this.setDrawContext_(),this.preRender(ii,e),ti.projection,this.clipped_=!1,ni&&ei.extent&&this.clipping){const si=fromUserExtent(ei.extent);ni=intersects$1(si,e.extent),this.clipped_=ni&&!containsExtent(si,e.extent),this.clipped_&&this.clipUnrotated(ii,e,si)}return ni&&this.renderWorlds(ri,e,this.getLayer().getDeclutter()?!1:void 0),!e.declutter&&this.clipped_&&ii.restore(),this.postRender(ii,e),this.renderedRotation_!==ti.rotation&&(this.renderedRotation_=ti.rotation,this.hitDetectionImageData_=null),e.declutter||this.resetDrawContext_(),this.container}getFeatures(e){return new Promise(n=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const ei=this.frameState.size.slice(),ti=this.renderedCenter_,ii=this.renderedResolution_,ri=this.renderedRotation_,ni=this.renderedProjection_,si=this.wrappedRenderedExtent_,ai=this.getLayer(),oi=[],li=ei[0]*HIT_DETECT_RESOLUTION,ci=ei[1]*HIT_DETECT_RESOLUTION;oi.push(this.getRenderTransform(ti,ii,ri,HIT_DETECT_RESOLUTION,li,ci,0).slice());const ui=ai.getSource(),di=ni.getExtent();if(ui.getWrapX()&&ni.canWrapX()&&!containsExtent(di,si)){let fi=si[0];const hi=getWidth(di);let pi=0,gi;for(;fi<di[0];)--pi,gi=hi*pi,oi.push(this.getRenderTransform(ti,ii,ri,HIT_DETECT_RESOLUTION,li,ci,gi).slice()),fi+=hi;for(pi=0,fi=si[2];fi>di[2];)++pi,gi=hi*pi,oi.push(this.getRenderTransform(ti,ii,ri,HIT_DETECT_RESOLUTION,li,ci,gi).slice()),fi-=hi}this.hitDetectionImageData_=createHitDetectionImageData(ei,oi,this.renderedFeatures_,ai.getStyleFunction(),si,ii,ri,getSquaredTolerance(ii,this.renderedPixelRatio_),null)}n(hitDetect(e,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(e,n,ei,ti,ii){var ci,ui;if(!this.replayGroup_)return;const ri=n.viewState.resolution,ni=n.viewState.rotation,si=this.getLayer(),ai={},oi=function(di,fi,hi){const pi=getUid(di),gi=ai[pi];if(gi){if(gi!==!0&&hi<gi.distanceSq){if(hi===0)return ai[pi]=!0,ii.splice(ii.lastIndexOf(gi),1),ti(di,si,fi);gi.geometry=fi,gi.distanceSq=hi}}else{if(hi===0)return ai[pi]=!0,ti(di,si,fi);ii.push(ai[pi]={feature:di,layer:si,geometry:fi,distanceSq:hi,callback:ti})}},li=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(e,ri,ni,ei,oi,li?(ui=(ci=n.declutter)==null?void 0:ci[li])==null?void 0:ui.all().map(di=>di.value):null)}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}prepareFrame(e){const n=this.getLayer(),ei=n.getSource();if(!ei)return!1;const ti=e.viewHints[ViewHint.ANIMATING],ii=e.viewHints[ViewHint.INTERACTING],ri=n.getUpdateWhileAnimating(),ni=n.getUpdateWhileInteracting();if(this.ready&&!ri&&ti||!ni&&ii)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const si=e.extent,ai=e.viewState,oi=ai.projection,li=ai.resolution,ci=e.pixelRatio,ui=n.getRevision(),di=n.getRenderBuffer();let fi=n.getRenderOrder();fi===void 0&&(fi=defaultOrder);const hi=ai.center.slice(),pi=buffer(si,di*li),gi=pi.slice(),vi=[pi.slice()],yi=oi.getExtent();if(ei.getWrapX()&&oi.canWrapX()&&!containsExtent(yi,e.extent)){const Ni=getWidth(yi),$i=Math.max(getWidth(pi)/2,Ni);pi[0]=yi[0]-$i,pi[2]=yi[2]+$i,wrapX$1(hi,oi);const Ki=wrapX$2(vi[0],oi);Ki[0]<yi[0]&&Ki[2]<yi[2]?vi.push([Ki[0]+Ni,Ki[1],Ki[2]+Ni,Ki[3]]):Ki[0]>yi[0]&&Ki[2]>yi[2]&&vi.push([Ki[0]-Ni,Ki[1],Ki[2]-Ni,Ki[3]])}if(this.ready&&this.renderedResolution_==li&&this.renderedRevision_==ui&&this.renderedRenderOrder_==fi&&this.renderedFrameDeclutter_===!!e.declutter&&containsExtent(this.wrappedRenderedExtent_,pi))return equals(this.renderedExtent_,gi)||(this.hitDetectionImageData_=null,this.renderedExtent_=gi),this.renderedCenter_=hi,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const _i=new BuilderGroup(getTolerance(li,ci),pi,li,ci);let Ai;for(let Ni=0,$i=vi.length;Ni<$i;++Ni)ei.loadFeatures(vi[Ni],li,oi);const Ei=getSquaredTolerance(li,ci);let Si=!0;const wi=(Ni,$i)=>{let Ki;const er=Ni.getStyleFunction()||n.getStyleFunction();if(er&&(Ki=er(Ni,li)),Ki){const Vi=this.renderFeature(Ni,Ei,Ki,_i,Ai,this.getLayer().getDeclutter(),$i);Si=Si&&!Vi}},Oi=toUserExtent(pi),Ii=ei.getFeaturesInExtent(Oi);fi&&Ii.sort(fi);for(let Ni=0,$i=Ii.length;Ni<$i;++Ni)wi(Ii[Ni],Ni);this.renderedFeatures_=Ii,this.ready=Si;const Li=_i.finish(),Di=new ExecutorGroup(pi,li,ci,ei.getOverlaps(),Li,n.getRenderBuffer(),!!e.declutter);return this.renderedResolution_=li,this.renderedRevision_=ui,this.renderedRenderOrder_=fi,this.renderedFrameDeclutter_=!!e.declutter,this.renderedExtent_=gi,this.wrappedRenderedExtent_=pi,this.renderedCenter_=hi,this.renderedProjection_=oi,this.renderedPixelRatio_=ci,this.replayGroup_=Di,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(e,n,ei,ti,ii,ri,ni){if(!ei)return!1;let si=!1;if(Array.isArray(ei))for(let ai=0,oi=ei.length;ai<oi;++ai)si=renderFeature$1(ti,e,ei[ai],n,this.boundHandleStyleImageChange_,ii,ri,ni)||si;else si=renderFeature$1(ti,e,ei,n,this.boundHandleStyleImageChange_,ii,ri,ni);return si}}let numTypes=0;const BooleanType$1=1<<numTypes++,NumberType$1=1<<numTypes++,StringType$1=1<<numTypes++,ColorType$2=1<<numTypes++,NumberArrayType$1=1<<numTypes++,SizeType=1<<numTypes++,AnyType=Math.pow(2,numTypes)-1,typeNames={[BooleanType$1]:"boolean",[NumberType$1]:"number",[StringType$1]:"string",[ColorType$2]:"color",[NumberArrayType$1]:"number[]",[SizeType]:"size"},namedTypes=Object.keys(typeNames).map(Number).sort(ascending);function isSpecific(_t){return _t in typeNames}function typeName(_t){const e=[];for(const n of namedTypes)includesType(_t,n)&&e.push(typeNames[n]);return e.length===0?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function includesType(_t,e){return(_t&e)===e}function isType(_t,e){return _t===e}class LiteralExpression{constructor(e,n){if(!isSpecific(e))throw new Error(`literal expressions must have a specific type, got ${typeName(e)}`);this.type=e,this.value=n}}class CallExpression{constructor(e,n,...ei){this.type=e,this.operator=n,this.args=ei}}function newParsingContext(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function parse$2(_t,e,n){switch(typeof _t){case"boolean":{if(isType(e,StringType$1))return new LiteralExpression(StringType$1,_t?"true":"false");if(!includesType(e,BooleanType$1))throw new Error(`got a boolean, but expected ${typeName(e)}`);return new LiteralExpression(BooleanType$1,_t)}case"number":{if(isType(e,SizeType))return new LiteralExpression(SizeType,toSize(_t));if(isType(e,BooleanType$1))return new LiteralExpression(BooleanType$1,!!_t);if(isType(e,StringType$1))return new LiteralExpression(StringType$1,_t.toString());if(!includesType(e,NumberType$1))throw new Error(`got a number, but expected ${typeName(e)}`);return new LiteralExpression(NumberType$1,_t)}case"string":{if(isType(e,ColorType$2))return new LiteralExpression(ColorType$2,fromString(_t));if(isType(e,BooleanType$1))return new LiteralExpression(BooleanType$1,!!_t);if(!includesType(e,StringType$1))throw new Error(`got a string, but expected ${typeName(e)}`);return new LiteralExpression(StringType$1,_t)}}if(!Array.isArray(_t))throw new Error("expression must be an array or a primitive value");if(_t.length===0)throw new Error("empty expression");if(typeof _t[0]=="string")return parseCallExpression(_t,e,n);for(const ei of _t)if(typeof ei!="number")throw new Error("expected an array of numbers");if(isType(e,SizeType)){if(_t.length!==2)throw new Error(`expected an array of two values for a size, got ${_t.length}`);return new LiteralExpression(SizeType,_t)}if(isType(e,ColorType$2)){if(_t.length===3)return new LiteralExpression(ColorType$2,[..._t,1]);if(_t.length===4)return new LiteralExpression(ColorType$2,_t);throw new Error(`expected an array of 3 or 4 values for a color, got ${_t.length}`)}if(!includesType(e,NumberArrayType$1))throw new Error(`got an array of numbers, but expected ${typeName(e)}`);return new LiteralExpression(NumberArrayType$1,_t)}const Ops={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},parsers={[Ops.Get]:createCallExpressionParser(hasArgsCount(1,1/0),withGetArgs),[Ops.Var]:createCallExpressionParser(hasArgsCount(1,1),withVarArgs),[Ops.Has]:createCallExpressionParser(hasArgsCount(1,1/0),withGetArgs),[Ops.Id]:createCallExpressionParser(usesFeatureId,withNoArgs),[Ops.Concat]:createCallExpressionParser(hasArgsCount(2,1/0),withArgsOfType(StringType$1)),[Ops.GeometryType]:createCallExpressionParser(usesGeometryType,withNoArgs),[Ops.LineMetric]:createCallExpressionParser(withNoArgs),[Ops.Resolution]:createCallExpressionParser(usesMapState,withNoArgs),[Ops.Zoom]:createCallExpressionParser(usesMapState,withNoArgs),[Ops.Time]:createCallExpressionParser(usesMapState,withNoArgs),[Ops.Any]:createCallExpressionParser(hasArgsCount(2,1/0),withArgsOfType(BooleanType$1)),[Ops.All]:createCallExpressionParser(hasArgsCount(2,1/0),withArgsOfType(BooleanType$1)),[Ops.Not]:createCallExpressionParser(hasArgsCount(1,1),withArgsOfType(BooleanType$1)),[Ops.Equal]:createCallExpressionParser(hasArgsCount(2,2),withArgsOfType(AnyType)),[Ops.NotEqual]:createCallExpressionParser(hasArgsCount(2,2),withArgsOfType(AnyType)),[Ops.GreaterThan]:createCallExpressionParser(hasArgsCount(2,2),withArgsOfType(NumberType$1)),[Ops.GreaterThanOrEqualTo]:createCallExpressionParser(hasArgsCount(2,2),withArgsOfType(NumberType$1)),[Ops.LessThan]:createCallExpressionParser(hasArgsCount(2,2),withArgsOfType(NumberType$1)),[Ops.LessThanOrEqualTo]:createCallExpressionParser(hasArgsCount(2,2),withArgsOfType(NumberType$1)),[Ops.Multiply]:createCallExpressionParser(hasArgsCount(2,1/0),withArgsOfReturnType),[Ops.Coalesce]:createCallExpressionParser(hasArgsCount(2,1/0),withArgsOfReturnType),[Ops.Divide]:createCallExpressionParser(hasArgsCount(2,2),withArgsOfType(NumberType$1)),[Ops.Add]:createCallExpressionParser(hasArgsCount(2,1/0),withArgsOfType(NumberType$1)),[Ops.Subtract]:createCallExpressionParser(hasArgsCount(2,2),withArgsOfType(NumberType$1)),[Ops.Clamp]:createCallExpressionParser(hasArgsCount(3,3),withArgsOfType(NumberType$1)),[Ops.Mod]:createCallExpressionParser(hasArgsCount(2,2),withArgsOfType(NumberType$1)),[Ops.Pow]:createCallExpressionParser(hasArgsCount(2,2),withArgsOfType(NumberType$1)),[Ops.Abs]:createCallExpressionParser(hasArgsCount(1,1),withArgsOfType(NumberType$1)),[Ops.Floor]:createCallExpressionParser(hasArgsCount(1,1),withArgsOfType(NumberType$1)),[Ops.Ceil]:createCallExpressionParser(hasArgsCount(1,1),withArgsOfType(NumberType$1)),[Ops.Round]:createCallExpressionParser(hasArgsCount(1,1),withArgsOfType(NumberType$1)),[Ops.Sin]:createCallExpressionParser(hasArgsCount(1,1),withArgsOfType(NumberType$1)),[Ops.Cos]:createCallExpressionParser(hasArgsCount(1,1),withArgsOfType(NumberType$1)),[Ops.Atan]:createCallExpressionParser(hasArgsCount(1,2),withArgsOfType(NumberType$1)),[Ops.Sqrt]:createCallExpressionParser(hasArgsCount(1,1),withArgsOfType(NumberType$1)),[Ops.Match]:createCallExpressionParser(hasArgsCount(4,1/0),hasEvenArgs,withMatchArgs),[Ops.Between]:createCallExpressionParser(hasArgsCount(3,3),withArgsOfType(NumberType$1)),[Ops.Interpolate]:createCallExpressionParser(hasArgsCount(6,1/0),hasEvenArgs,withInterpolateArgs),[Ops.Case]:createCallExpressionParser(hasArgsCount(3,1/0),hasOddArgs,withCaseArgs),[Ops.In]:createCallExpressionParser(hasArgsCount(2,2),withInArgs),[Ops.Number]:createCallExpressionParser(hasArgsCount(1,1/0),withArgsOfType(AnyType)),[Ops.String]:createCallExpressionParser(hasArgsCount(1,1/0),withArgsOfType(AnyType)),[Ops.Array]:createCallExpressionParser(hasArgsCount(1,1/0),withArgsOfType(NumberType$1)),[Ops.Color]:createCallExpressionParser(hasArgsCount(1,4),withArgsOfType(NumberType$1)),[Ops.Band]:createCallExpressionParser(hasArgsCount(1,3),withArgsOfType(NumberType$1)),[Ops.Palette]:createCallExpressionParser(hasArgsCount(2,2),withPaletteArgs),[Ops.ToString]:createCallExpressionParser(hasArgsCount(1,1),withArgsOfType(BooleanType$1|NumberType$1|StringType$1|ColorType$2))};function withGetArgs(_t,e,n){const ei=_t.length-1,ti=new Array(ei);for(let ii=0;ii<ei;++ii){const ri=_t[ii+1];switch(typeof ri){case"number":{ti[ii]=new LiteralExpression(NumberType$1,ri);break}case"string":{ti[ii]=new LiteralExpression(StringType$1,ri);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${ri}`)}ii===0&&n.properties.add(String(ri))}return ti}function withVarArgs(_t,e,n){const ei=_t[1];if(typeof ei!="string")throw new Error("expected a string argument for var operation");return n.variables.add(ei),[new LiteralExpression(StringType$1,ei)]}function usesFeatureId(_t,e,n){n.featureId=!0}function usesGeometryType(_t,e,n){n.geometryType=!0}function usesMapState(_t,e,n){n.mapState=!0}function withNoArgs(_t,e,n){const ei=_t[0];if(_t.length!==1)throw new Error(`expected no arguments for ${ei} operation`);return[]}function hasArgsCount(_t,e){return function(n,ei,ti){const ii=n[0],ri=n.length-1;if(_t===e){if(ri!==_t){const ni=_t===1?"":"s";throw new Error(`expected ${_t} argument${ni} for ${ii}, got ${ri}`)}}else if(ri<_t||ri>e){const ni=e===1/0?`${_t} or more`:`${_t} to ${e}`;throw new Error(`expected ${ni} arguments for ${ii}, got ${ri}`)}}}function withArgsOfReturnType(_t,e,n){const ei=_t.length-1,ti=new Array(ei);for(let ii=0;ii<ei;++ii){const ri=parse$2(_t[ii+1],e,n);ti[ii]=ri}return ti}function withArgsOfType(_t){return function(e,n,ei){const ti=e.length-1,ii=new Array(ti);for(let ri=0;ri<ti;++ri){const ni=parse$2(e[ri+1],_t,ei);ii[ri]=ni}return ii}}function hasOddArgs(_t,e,n){const ei=_t[0],ti=_t.length-1;if(ti%2===0)throw new Error(`expected an odd number of arguments for ${ei}, got ${ti} instead`)}function hasEvenArgs(_t,e,n){const ei=_t[0],ti=_t.length-1;if(ti%2===1)throw new Error(`expected an even number of arguments for operation ${ei}, got ${ti} instead`)}function withMatchArgs(_t,e,n){const ei=_t.length-1,ti=StringType$1|NumberType$1|BooleanType$1,ii=parse$2(_t[1],ti,n),ri=parse$2(_t[_t.length-1],e,n),ni=new Array(ei-2);for(let si=0;si<ei-2;si+=2){try{const ai=parse$2(_t[si+2],ii.type,n);ni[si]=ai}catch(ai){throw new Error(`failed to parse argument ${si+1} of match expression: ${ai.message}`)}try{const ai=parse$2(_t[si+3],ri.type,n);ni[si+1]=ai}catch(ai){throw new Error(`failed to parse argument ${si+2} of match expression: ${ai.message}`)}}return[ii,...ni,ri]}function withInterpolateArgs(_t,e,n){const ei=_t[1];let ti;switch(ei[0]){case"linear":ti=1;break;case"exponential":const si=ei[1];if(typeof si!="number"||si<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(si)} instead`);ti=si;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(ei)}`)}const ii=new LiteralExpression(NumberType$1,ti);let ri;try{ri=parse$2(_t[2],NumberType$1,n)}catch(si){throw new Error(`failed to parse argument 1 in interpolate expression: ${si.message}`)}const ni=new Array(_t.length-3);for(let si=0;si<ni.length;si+=2){try{const ai=parse$2(_t[si+3],NumberType$1,n);ni[si]=ai}catch(ai){throw new Error(`failed to parse argument ${si+2} for interpolate expression: ${ai.message}`)}try{const ai=parse$2(_t[si+4],e,n);ni[si+1]=ai}catch(ai){throw new Error(`failed to parse argument ${si+3} for interpolate expression: ${ai.message}`)}}return[ii,ri,...ni]}function withCaseArgs(_t,e,n){const ei=parse$2(_t[_t.length-1],e,n),ti=new Array(_t.length-1);for(let ii=0;ii<ti.length-1;ii+=2){try{const ri=parse$2(_t[ii+1],BooleanType$1,n);ti[ii]=ri}catch(ri){throw new Error(`failed to parse argument ${ii} of case expression: ${ri.message}`)}try{const ri=parse$2(_t[ii+2],ei.type,n);ti[ii+1]=ri}catch(ri){throw new Error(`failed to parse argument ${ii+1} of case expression: ${ri.message}`)}}return ti[ti.length-1]=ei,ti}function withInArgs(_t,e,n){let ei=_t[2];if(!Array.isArray(ei))throw new Error('the second argument for the "in" operator must be an array');let ti;if(typeof ei[0]=="string"){if(ei[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(ei[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');ei=ei[1],ti=StringType$1}else ti=NumberType$1;const ii=new Array(ei.length);for(let ni=0;ni<ii.length;ni++)try{const si=parse$2(ei[ni],ti,n);ii[ni]=si}catch(si){throw new Error(`failed to parse haystack item ${ni} for "in" expression: ${si.message}`)}return[parse$2(_t[1],ti,n),...ii]}function withPaletteArgs(_t,e,n){let ei;try{ei=parse$2(_t[1],NumberType$1,n)}catch(ri){throw new Error(`failed to parse first argument in palette expression: ${ri.message}`)}const ti=_t[2];if(!Array.isArray(ti))throw new Error("the second argument of palette must be an array");const ii=new Array(ti.length);for(let ri=0;ri<ii.length;ri++){let ni;try{ni=parse$2(ti[ri],ColorType$2,n)}catch(si){throw new Error(`failed to parse color at index ${ri} in palette expression: ${si.message}`)}if(!(ni instanceof LiteralExpression))throw new Error(`the palette color at index ${ri} must be a literal value`);ii[ri]=ni}return[ei,...ii]}function createCallExpressionParser(..._t){return function(e,n,ei){const ti=e[0];let ii;for(let ri=0;ri<_t.length;ri++){const ni=_t[ri](e,n,ei);if(ri==_t.length-1){if(!ni)throw new Error("expected last argument validator to return the parsed args");ii=ni}}return new CallExpression(n,ti,...ii)}}function parseCallExpression(_t,e,n){const ei=_t[0],ti=parsers[ei];if(!ti)throw new Error(`unknown operator: ${ei}`);return ti(_t,e,n)}function computeGeometryType(_t){if(!_t)return"";const e=_t.getType();switch(e){case"Point":case"LineString":case"Polygon":return e;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return e.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return computeGeometryType(_t.getGeometries()[0]);default:return""}}function newEvaluationContext(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function buildExpression(_t,e,n){const ei=parse$2(_t,e,n);return compileExpression(ei)}function compileExpression(_t,e){if(_t instanceof LiteralExpression){if(_t.type===ColorType$2&&typeof _t.value=="string"){const ei=fromString(_t.value);return function(){return ei}}return function(){return _t.value}}const n=_t.operator;switch(n){case Ops.Number:case Ops.String:case Ops.Coalesce:return compileAssertionExpression(_t);case Ops.Get:case Ops.Var:case Ops.Has:return compileAccessorExpression(_t);case Ops.Id:return ei=>ei.featureId;case Ops.GeometryType:return ei=>ei.geometryType;case Ops.Concat:{const ei=_t.args.map(ti=>compileExpression(ti));return ti=>"".concat(...ei.map(ii=>ii(ti).toString()))}case Ops.Resolution:return ei=>ei.resolution;case Ops.Any:case Ops.All:case Ops.Between:case Ops.In:case Ops.Not:return compileLogicalExpression(_t);case Ops.Equal:case Ops.NotEqual:case Ops.LessThan:case Ops.LessThanOrEqualTo:case Ops.GreaterThan:case Ops.GreaterThanOrEqualTo:return compileComparisonExpression(_t);case Ops.Multiply:case Ops.Divide:case Ops.Add:case Ops.Subtract:case Ops.Clamp:case Ops.Mod:case Ops.Pow:case Ops.Abs:case Ops.Floor:case Ops.Ceil:case Ops.Round:case Ops.Sin:case Ops.Cos:case Ops.Atan:case Ops.Sqrt:return compileNumericExpression(_t);case Ops.Case:return compileCaseExpression(_t);case Ops.Match:return compileMatchExpression(_t);case Ops.Interpolate:return compileInterpolateExpression(_t);case Ops.ToString:return compileConvertExpression(_t);default:throw new Error(`Unsupported operator ${n}`)}}function compileAssertionExpression(_t,e){const n=_t.operator,ei=_t.args.length,ti=new Array(ei);for(let ii=0;ii<ei;++ii)ti[ii]=compileExpression(_t.args[ii]);switch(n){case Ops.Coalesce:return ii=>{for(let ri=0;ri<ei;++ri){const ni=ti[ri](ii);if(typeof ni<"u"&&ni!==null)return ni}throw new Error("Expected one of the values to be non-null")};case Ops.Number:case Ops.String:return ii=>{for(let ri=0;ri<ei;++ri){const ni=ti[ri](ii);if(typeof ni===n)return ni}throw new Error(`Expected one of the values to be a ${n}`)};default:throw new Error(`Unsupported assertion operator ${n}`)}}function compileAccessorExpression(_t,e){const ei=_t.args[0].value;switch(_t.operator){case Ops.Get:return ti=>{const ii=_t.args;let ri=ti.properties[ei];for(let ni=1,si=ii.length;ni<si;++ni){const oi=ii[ni].value;ri=ri[oi]}return ri};case Ops.Var:return ti=>ti.variables[ei];case Ops.Has:return ti=>{const ii=_t.args;if(!(ei in ti.properties))return!1;let ri=ti.properties[ei];for(let ni=1,si=ii.length;ni<si;++ni){const oi=ii[ni].value;if(!ri||!Object.hasOwn(ri,oi))return!1;ri=ri[oi]}return!0};default:throw new Error(`Unsupported accessor operator ${_t.operator}`)}}function compileComparisonExpression(_t,e){const n=_t.operator,ei=compileExpression(_t.args[0]),ti=compileExpression(_t.args[1]);switch(n){case Ops.Equal:return ii=>ei(ii)===ti(ii);case Ops.NotEqual:return ii=>ei(ii)!==ti(ii);case Ops.LessThan:return ii=>ei(ii)<ti(ii);case Ops.LessThanOrEqualTo:return ii=>ei(ii)<=ti(ii);case Ops.GreaterThan:return ii=>ei(ii)>ti(ii);case Ops.GreaterThanOrEqualTo:return ii=>ei(ii)>=ti(ii);default:throw new Error(`Unsupported comparison operator ${n}`)}}function compileLogicalExpression(_t,e){const n=_t.operator,ei=_t.args.length,ti=new Array(ei);for(let ii=0;ii<ei;++ii)ti[ii]=compileExpression(_t.args[ii]);switch(n){case Ops.Any:return ii=>{for(let ri=0;ri<ei;++ri)if(ti[ri](ii))return!0;return!1};case Ops.All:return ii=>{for(let ri=0;ri<ei;++ri)if(!ti[ri](ii))return!1;return!0};case Ops.Between:return ii=>{const ri=ti[0](ii),ni=ti[1](ii),si=ti[2](ii);return ri>=ni&&ri<=si};case Ops.In:return ii=>{const ri=ti[0](ii);for(let ni=1;ni<ei;++ni)if(ri===ti[ni](ii))return!0;return!1};case Ops.Not:return ii=>!ti[0](ii);default:throw new Error(`Unsupported logical operator ${n}`)}}function compileNumericExpression(_t,e){const n=_t.operator,ei=_t.args.length,ti=new Array(ei);for(let ii=0;ii<ei;++ii)ti[ii]=compileExpression(_t.args[ii]);switch(n){case Ops.Multiply:return ii=>{let ri=1;for(let ni=0;ni<ei;++ni)ri*=ti[ni](ii);return ri};case Ops.Divide:return ii=>ti[0](ii)/ti[1](ii);case Ops.Add:return ii=>{let ri=0;for(let ni=0;ni<ei;++ni)ri+=ti[ni](ii);return ri};case Ops.Subtract:return ii=>ti[0](ii)-ti[1](ii);case Ops.Clamp:return ii=>{const ri=ti[0](ii),ni=ti[1](ii);if(ri<ni)return ni;const si=ti[2](ii);return ri>si?si:ri};case Ops.Mod:return ii=>ti[0](ii)%ti[1](ii);case Ops.Pow:return ii=>Math.pow(ti[0](ii),ti[1](ii));case Ops.Abs:return ii=>Math.abs(ti[0](ii));case Ops.Floor:return ii=>Math.floor(ti[0](ii));case Ops.Ceil:return ii=>Math.ceil(ti[0](ii));case Ops.Round:return ii=>Math.round(ti[0](ii));case Ops.Sin:return ii=>Math.sin(ti[0](ii));case Ops.Cos:return ii=>Math.cos(ti[0](ii));case Ops.Atan:return ei===2?ii=>Math.atan2(ti[0](ii),ti[1](ii)):ii=>Math.atan(ti[0](ii));case Ops.Sqrt:return ii=>Math.sqrt(ti[0](ii));default:throw new Error(`Unsupported numeric operator ${n}`)}}function compileCaseExpression(_t,e){const n=_t.args.length,ei=new Array(n);for(let ti=0;ti<n;++ti)ei[ti]=compileExpression(_t.args[ti]);return ti=>{for(let ii=0;ii<n-1;ii+=2)if(ei[ii](ti))return ei[ii+1](ti);return ei[n-1](ti)}}function compileMatchExpression(_t,e){const n=_t.args.length,ei=new Array(n);for(let ti=0;ti<n;++ti)ei[ti]=compileExpression(_t.args[ti]);return ti=>{const ii=ei[0](ti);for(let ri=1;ri<n-1;ri+=2)if(ii===ei[ri](ti))return ei[ri+1](ti);return ei[n-1](ti)}}function compileInterpolateExpression(_t,e){const n=_t.args.length,ei=new Array(n);for(let ti=0;ti<n;++ti)ei[ti]=compileExpression(_t.args[ti]);return ti=>{const ii=ei[0](ti),ri=ei[1](ti);let ni,si;for(let ai=2;ai<n;ai+=2){const oi=ei[ai](ti);let li=ei[ai+1](ti);const ci=Array.isArray(li);if(ci&&(li=withAlpha(li)),oi>=ri)return ai===2?li:ci?interpolateColor(ii,ri,ni,si,oi,li):interpolateNumber$1(ii,ri,ni,si,oi,li);ni=oi,si=li}return si}}function compileConvertExpression(_t,e){const n=_t.operator,ei=_t.args.length,ti=new Array(ei);for(let ii=0;ii<ei;++ii)ti[ii]=compileExpression(_t.args[ii]);switch(n){case Ops.ToString:return ii=>{const ri=ti[0](ii);return _t.args[0].type===ColorType$2?toString$1(ri):ri.toString()};default:throw new Error(`Unsupported convert operator ${n}`)}}function interpolateNumber$1(_t,e,n,ei,ti,ii){const ri=ti-n;if(ri===0)return ei;const ni=e-n,si=_t===1?ni/ri:(Math.pow(_t,ni)-1)/(Math.pow(_t,ri)-1);return ei+si*(ii-ei)}function interpolateColor(_t,e,n,ei,ti,ii){if(ti-n===0)return ei;const ni=rgbaToLcha(ei),si=rgbaToLcha(ii);let ai=si[2]-ni[2];ai>180?ai-=360:ai<-180&&(ai+=360);const oi=[interpolateNumber$1(_t,e,n,ni[0],ti,si[0]),interpolateNumber$1(_t,e,n,ni[1],ti,si[1]),ni[2]+interpolateNumber$1(_t,e,n,0,ti,ai),interpolateNumber$1(_t,e,n,ei[3],ti,ii[3])];return lchaToRgba(oi)}function always(_t){return!0}function rulesToStyleFunction(_t){const e=newParsingContext(),n=buildRuleSet(_t,e),ei=newEvaluationContext();return function(ti,ii){if(ei.properties=ti.getPropertiesInternal(),ei.resolution=ii,e.featureId){const ri=ti.getId();ri!==void 0?ei.featureId=ri:ei.featureId=null}return e.geometryType&&(ei.geometryType=computeGeometryType(ti.getGeometry())),n(ei)}}function flatStylesToStyleFunction(_t){const e=newParsingContext(),n=_t.length,ei=new Array(n);for(let ri=0;ri<n;++ri)ei[ri]=buildStyle(_t[ri],e);const ti=newEvaluationContext(),ii=new Array(n);return function(ri,ni){if(ti.properties=ri.getPropertiesInternal(),ti.resolution=ni,e.featureId){const ai=ri.getId();ai!==void 0?ti.featureId=ai:ti.featureId=null}let si=0;for(let ai=0;ai<n;++ai){const oi=ei[ai](ti);oi&&(ii[si]=oi,si+=1)}return ii.length=si,ii}}function buildRuleSet(_t,e){const n=_t.length,ei=new Array(n);for(let ti=0;ti<n;++ti){const ii=_t[ti],ri="filter"in ii?buildExpression(ii.filter,BooleanType$1,e):always;let ni;if(Array.isArray(ii.style)){const si=ii.style.length;ni=new Array(si);for(let ai=0;ai<si;++ai)ni[ai]=buildStyle(ii.style[ai],e)}else ni=[buildStyle(ii.style,e)];ei[ti]={filter:ri,styles:ni}}return function(ti){const ii=[];let ri=!1;for(let ni=0;ni<n;++ni){const si=ei[ni].filter;if(si(ti)&&!(_t[ni].else&&ri)){ri=!0;for(const ai of ei[ni].styles){const oi=ai(ti);oi&&ii.push(oi)}}}return ii}}function buildStyle(_t,e){const n=buildFill(_t,"",e),ei=buildStroke(_t,"",e),ti=buildText(_t,e),ii=buildImage(_t,e),ri=numberEvaluator(_t,"z-index",e);if(!n&&!ei&&!ti&&!ii&&!isEmpty(_t))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(_t));const ni=new Style$1;return function(si){let ai=!0;if(n){const oi=n(si);oi&&(ai=!1),ni.setFill(oi)}if(ei){const oi=ei(si);oi&&(ai=!1),ni.setStroke(oi)}if(ti){const oi=ti(si);oi&&(ai=!1),ni.setText(oi)}if(ii){const oi=ii(si);oi&&(ai=!1),ni.setImage(oi)}return ri&&ni.setZIndex(ri(si)),ai?null:ni}}function buildFill(_t,e,n){let ei;if(e+"fill-pattern-src"in _t)ei=patternEvaluator(_t,e+"fill-",n);else{if(_t[e+"fill-color"]==="none")return ii=>null;ei=colorLikeEvaluator(_t,e+"fill-color",n)}if(!ei)return null;const ti=new Fill;return function(ii){const ri=ei(ii);return ri===NO_COLOR?null:(ti.setColor(ri),ti)}}function buildStroke(_t,e,n){const ei=numberEvaluator(_t,e+"stroke-width",n),ti=colorLikeEvaluator(_t,e+"stroke-color",n);if(!ei&&!ti)return null;const ii=stringEvaluator(_t,e+"stroke-line-cap",n),ri=stringEvaluator(_t,e+"stroke-line-join",n),ni=numberArrayEvaluator(_t,e+"stroke-line-dash",n),si=numberEvaluator(_t,e+"stroke-line-dash-offset",n),ai=numberEvaluator(_t,e+"stroke-miter-limit",n),oi=new Stroke;return function(li){if(ti){const ci=ti(li);if(ci===NO_COLOR)return null;oi.setColor(ci)}if(ei&&oi.setWidth(ei(li)),ii){const ci=ii(li);if(ci!=="butt"&&ci!=="round"&&ci!=="square")throw new Error("Expected butt, round, or square line cap");oi.setLineCap(ci)}if(ri){const ci=ri(li);if(ci!=="bevel"&&ci!=="round"&&ci!=="miter")throw new Error("Expected bevel, round, or miter line join");oi.setLineJoin(ci)}return ni&&oi.setLineDash(ni(li)),si&&oi.setLineDashOffset(si(li)),ai&&oi.setMiterLimit(ai(li)),oi}}function buildText(_t,e){const n="text-",ei=stringEvaluator(_t,n+"value",e);if(!ei)return null;const ti=buildFill(_t,n,e),ii=buildFill(_t,n+"background-",e),ri=buildStroke(_t,n,e),ni=buildStroke(_t,n+"background-",e),si=stringEvaluator(_t,n+"font",e),ai=numberEvaluator(_t,n+"max-angle",e),oi=numberEvaluator(_t,n+"offset-x",e),li=numberEvaluator(_t,n+"offset-y",e),ci=booleanEvaluator(_t,n+"overflow",e),ui=stringEvaluator(_t,n+"placement",e),di=numberEvaluator(_t,n+"repeat",e),fi=sizeLikeEvaluator(_t,n+"scale",e),hi=booleanEvaluator(_t,n+"rotate-with-view",e),pi=numberEvaluator(_t,n+"rotation",e),gi=stringEvaluator(_t,n+"align",e),vi=stringEvaluator(_t,n+"justify",e),yi=stringEvaluator(_t,n+"baseline",e),_i=booleanEvaluator(_t,n+"keep-upright",e),Ai=numberArrayEvaluator(_t,n+"padding",e),Ei=optionalDeclutterMode(_t,n+"declutter-mode"),Si=new Text({declutterMode:Ei});return function(wi){if(Si.setText(ei(wi)),ti&&Si.setFill(ti(wi)),ii&&Si.setBackgroundFill(ii(wi)),ri&&Si.setStroke(ri(wi)),ni&&Si.setBackgroundStroke(ni(wi)),si&&Si.setFont(si(wi)),ai&&Si.setMaxAngle(ai(wi)),oi&&Si.setOffsetX(oi(wi)),li&&Si.setOffsetY(li(wi)),ci&&Si.setOverflow(ci(wi)),ui){const Oi=ui(wi);if(Oi!=="point"&&Oi!=="line")throw new Error("Expected point or line for text-placement");Si.setPlacement(Oi)}if(di&&Si.setRepeat(di(wi)),fi&&Si.setScale(fi(wi)),hi&&Si.setRotateWithView(hi(wi)),pi&&Si.setRotation(pi(wi)),gi){const Oi=gi(wi);if(Oi!=="left"&&Oi!=="center"&&Oi!=="right"&&Oi!=="end"&&Oi!=="start")throw new Error("Expected left, right, center, start, or end for text-align");Si.setTextAlign(Oi)}if(vi){const Oi=vi(wi);if(Oi!=="left"&&Oi!=="right"&&Oi!=="center")throw new Error("Expected left, right, or center for text-justify");Si.setJustify(Oi)}if(yi){const Oi=yi(wi);if(Oi!=="bottom"&&Oi!=="top"&&Oi!=="middle"&&Oi!=="alphabetic"&&Oi!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");Si.setTextBaseline(Oi)}return Ai&&Si.setPadding(Ai(wi)),_i&&Si.setKeepUpright(_i(wi)),Si}}function buildImage(_t,e){return"icon-src"in _t?buildIcon(_t,e):"shape-points"in _t?buildShape(_t,e):"circle-radius"in _t?buildCircle(_t,e):null}function buildIcon(_t,e){const n="icon-",ei=n+"src",ti=requireString(_t[ei],ei),ii=coordinateEvaluator(_t,n+"anchor",e),ri=sizeLikeEvaluator(_t,n+"scale",e),ni=numberEvaluator(_t,n+"opacity",e),si=coordinateEvaluator(_t,n+"displacement",e),ai=numberEvaluator(_t,n+"rotation",e),oi=booleanEvaluator(_t,n+"rotate-with-view",e),li=optionalIconOrigin(_t,n+"anchor-origin"),ci=optionalIconAnchorUnits(_t,n+"anchor-x-units"),ui=optionalIconAnchorUnits(_t,n+"anchor-y-units"),di=optionalColorLike(_t,n+"color"),fi=optionalString(_t,n+"cross-origin"),hi=optionalNumberArray(_t,n+"offset"),pi=optionalIconOrigin(_t,n+"offset-origin"),gi=optionalNumber(_t,n+"width"),vi=optionalNumber(_t,n+"height"),yi=optionalSize(_t,n+"size"),_i=optionalDeclutterMode(_t,n+"declutter-mode"),Ai=new Icon({src:ti,anchorOrigin:li,anchorXUnits:ci,anchorYUnits:ui,color:di,crossOrigin:fi,offset:hi,offsetOrigin:pi,height:vi,width:gi,size:yi,declutterMode:_i});return function(Ei){return ni&&Ai.setOpacity(ni(Ei)),si&&Ai.setDisplacement(si(Ei)),ai&&Ai.setRotation(ai(Ei)),oi&&Ai.setRotateWithView(oi(Ei)),ri&&Ai.setScale(ri(Ei)),ii&&Ai.setAnchor(ii(Ei)),Ai}}function buildShape(_t,e){const n="shape-",ei=n+"points",ti=n+"radius",ii=requireNumber(_t[ei],ei),ri=requireNumber(_t[ti],ti),ni=buildFill(_t,n,e),si=buildStroke(_t,n,e),ai=sizeLikeEvaluator(_t,n+"scale",e),oi=coordinateEvaluator(_t,n+"displacement",e),li=numberEvaluator(_t,n+"rotation",e),ci=booleanEvaluator(_t,n+"rotate-with-view",e),ui=optionalNumber(_t,n+"radius2"),di=optionalNumber(_t,n+"angle"),fi=optionalDeclutterMode(_t,n+"declutter-mode"),hi=new RegularShape({points:ii,radius:ri,radius2:ui,angle:di,declutterMode:fi});return function(pi){return ni&&hi.setFill(ni(pi)),si&&hi.setStroke(si(pi)),oi&&hi.setDisplacement(oi(pi)),li&&hi.setRotation(li(pi)),ci&&hi.setRotateWithView(ci(pi)),ai&&hi.setScale(ai(pi)),hi}}function buildCircle(_t,e){const n="circle-",ei=buildFill(_t,n,e),ti=buildStroke(_t,n,e),ii=numberEvaluator(_t,n+"radius",e),ri=sizeLikeEvaluator(_t,n+"scale",e),ni=coordinateEvaluator(_t,n+"displacement",e),si=numberEvaluator(_t,n+"rotation",e),ai=booleanEvaluator(_t,n+"rotate-with-view",e),oi=optionalDeclutterMode(_t,n+"declutter-mode"),li=new CircleStyle({radius:5,declutterMode:oi});return function(ci){return ii&&li.setRadius(ii(ci)),ei&&li.setFill(ei(ci)),ti&&li.setStroke(ti(ci)),ni&&li.setDisplacement(ni(ci)),si&&li.setRotation(si(ci)),ai&&li.setRotateWithView(ai(ci)),ri&&li.setScale(ri(ci)),li}}function numberEvaluator(_t,e,n){if(!(e in _t))return;const ei=buildExpression(_t[e],NumberType$1,n);return function(ti){return requireNumber(ei(ti),e)}}function stringEvaluator(_t,e,n){if(!(e in _t))return null;const ei=buildExpression(_t[e],StringType$1,n);return function(ti){return requireString(ei(ti),e)}}function patternEvaluator(_t,e,n){const ei=stringEvaluator(_t,e+"pattern-src",n),ti=sizeEvaluator(_t,e+"pattern-offset",n),ii=sizeEvaluator(_t,e+"pattern-size",n),ri=colorLikeEvaluator(_t,e+"color",n);return function(ni){return{src:ei(ni),offset:ti&&ti(ni),size:ii&&ii(ni),color:ri&&ri(ni)}}}function booleanEvaluator(_t,e,n){if(!(e in _t))return null;const ei=buildExpression(_t[e],BooleanType$1,n);return function(ti){const ii=ei(ti);if(typeof ii!="boolean")throw new Error(`Expected a boolean for ${e}`);return ii}}function colorLikeEvaluator(_t,e,n){if(!(e in _t))return null;const ei=buildExpression(_t[e],ColorType$2,n);return function(ti){return requireColorLike(ei(ti),e)}}function numberArrayEvaluator(_t,e,n){if(!(e in _t))return null;const ei=buildExpression(_t[e],NumberArrayType$1,n);return function(ti){return requireNumberArray(ei(ti),e)}}function coordinateEvaluator(_t,e,n){if(!(e in _t))return null;const ei=buildExpression(_t[e],NumberArrayType$1,n);return function(ti){const ii=requireNumberArray(ei(ti),e);if(ii.length!==2)throw new Error(`Expected two numbers for ${e}`);return ii}}function sizeEvaluator(_t,e,n){if(!(e in _t))return null;const ei=buildExpression(_t[e],NumberArrayType$1,n);return function(ti){return requireSize(ei(ti),e)}}function sizeLikeEvaluator(_t,e,n){if(!(e in _t))return null;const ei=buildExpression(_t[e],NumberArrayType$1|NumberType$1,n);return function(ti){return requireSizeLike(ei(ti),e)}}function optionalNumber(_t,e){const n=_t[e];if(n!==void 0){if(typeof n!="number")throw new Error(`Expected a number for ${e}`);return n}}function optionalSize(_t,e){const n=_t[e];if(n!==void 0){if(typeof n=="number")return toSize(n);if(!Array.isArray(n))throw new Error(`Expected a number or size array for ${e}`);if(n.length!==2||typeof n[0]!="number"||typeof n[1]!="number")throw new Error(`Expected a number or size array for ${e}`);return n}}function optionalString(_t,e){const n=_t[e];if(n!==void 0){if(typeof n!="string")throw new Error(`Expected a string for ${e}`);return n}}function optionalIconOrigin(_t,e){const n=_t[e];if(n!==void 0){if(n!=="bottom-left"&&n!=="bottom-right"&&n!=="top-left"&&n!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return n}}function optionalIconAnchorUnits(_t,e){const n=_t[e];if(n!==void 0){if(n!=="pixels"&&n!=="fraction")throw new Error(`Expected pixels or fraction for ${e}`);return n}}function optionalNumberArray(_t,e){const n=_t[e];if(n!==void 0)return requireNumberArray(n,e)}function optionalDeclutterMode(_t,e){const n=_t[e];if(n!==void 0){if(typeof n!="string")throw new Error(`Expected a string for ${e}`);if(n!=="declutter"&&n!=="obstacle"&&n!=="none")throw new Error(`Expected declutter, obstacle, or none for ${e}`);return n}}function optionalColorLike(_t,e){const n=_t[e];if(n!==void 0)return requireColorLike(n,e)}function requireNumberArray(_t,e){if(!Array.isArray(_t))throw new Error(`Expected an array for ${e}`);const n=_t.length;for(let ei=0;ei<n;++ei)if(typeof _t[ei]!="number")throw new Error(`Expected an array of numbers for ${e}`);return _t}function requireString(_t,e){if(typeof _t!="string")throw new Error(`Expected a string for ${e}`);return _t}function requireNumber(_t,e){if(typeof _t!="number")throw new Error(`Expected a number for ${e}`);return _t}function requireColorLike(_t,e){if(typeof _t=="string")return _t;const n=requireNumberArray(_t,e),ei=n.length;if(ei<3||ei>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return n}function requireSize(_t,e){const n=requireNumberArray(_t,e);if(n.length!==2)throw new Error(`Expected an array of two numbers for ${e}`);return n}function requireSizeLike(_t,e){return typeof _t=="number"?_t:requireSize(_t,e)}const ViewProperty={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function createExtent(_t,e,n){return(function(ei,ti,ii,ri,ni){if(!ei)return;if(!ti&&!e)return ei;const si=e?0:ii[0]*ti,ai=e?0:ii[1]*ti,oi=ni?ni[0]:0,li=ni?ni[1]:0;let ci=_t[0]+si/2+oi,ui=_t[2]-si/2+oi,di=_t[1]+ai/2+li,fi=_t[3]-ai/2+li;ci>ui&&(ci=(ui+ci)/2,ui=ci),di>fi&&(di=(fi+di)/2,fi=di);let hi=clamp$1(ei[0],ci,ui),pi=clamp$1(ei[1],di,fi);if(ri&&n&&ti){const gi=30*ti;hi+=-gi*Math.log(1+Math.max(0,ci-ei[0])/gi)+gi*Math.log(1+Math.max(0,ei[0]-ui)/gi),pi+=-gi*Math.log(1+Math.max(0,di-ei[1])/gi)+gi*Math.log(1+Math.max(0,ei[1]-fi)/gi)}return[hi,pi]})}function none(_t){return _t}function getViewportClampedResolution(_t,e,n,ei){const ti=getWidth(e)/n[0],ii=getHeight(e)/n[1];return ei?Math.min(_t,Math.max(ti,ii)):Math.min(_t,Math.min(ti,ii))}function getSmoothClampedResolution(_t,e,n){let ei=Math.min(_t,e);const ti=50;return ei*=Math.log(1+ti*Math.max(0,_t/e-1))/ti+1,n&&(ei=Math.max(ei,n),ei/=Math.log(1+ti*Math.max(0,n/_t-1))/ti+1),clamp$1(ei,n/2,e*2)}function createSnapToResolutions(_t,e,n,ei){return e=e!==void 0?e:!0,(function(ti,ii,ri,ni){if(ti!==void 0){const si=_t[0],ai=_t[_t.length-1],oi=n?getViewportClampedResolution(si,n,ri,ei):si;if(ni)return e?getSmoothClampedResolution(ti,oi,ai):clamp$1(ti,ai,oi);const li=Math.min(oi,ti),ci=Math.floor(linearFindNearest(_t,li,ii));return _t[ci]>oi&&ci<_t.length-1?_t[ci+1]:_t[ci]}})}function createSnapToPower(_t,e,n,ei,ti,ii){return ei=ei!==void 0?ei:!0,n=n!==void 0?n:0,(function(ri,ni,si,ai){if(ri!==void 0){const oi=ti?getViewportClampedResolution(e,ti,si,ii):e;if(ai)return ei?getSmoothClampedResolution(ri,oi,n):clamp$1(ri,n,oi);const li=1e-9,ci=Math.ceil(Math.log(e/oi)/Math.log(_t)-li),ui=-ni*(.5-li)+.5,di=Math.min(oi,ri),fi=Math.floor(Math.log(e/di)/Math.log(_t)+ui),hi=Math.max(ci,fi),pi=e/Math.pow(_t,hi);return clamp$1(pi,n,oi)}})}function createMinMaxResolution(_t,e,n,ei,ti){return n=n!==void 0?n:!0,(function(ii,ri,ni,si){if(ii!==void 0){const ai=ei?getViewportClampedResolution(_t,ei,ni,ti):_t;return!n||!si?clamp$1(ii,e,ai):getSmoothClampedResolution(ii,ai,e)}})}const DEFAULT_MIN_ZOOM=0;class View extends BaseObject{constructor(e){super(),this.on,this.once,this.un,e=Object.assign({},e),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=createProjection(e.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,e.projection&&disableCoordinateWarning(),e.center&&(e.center=fromUserCoordinate(e.center,this.projection_)),e.extent&&(e.extent=fromUserExtent(e.extent,this.projection_)),this.applyOptions_(e)}applyOptions_(e){const n=Object.assign({},e);for(const ni in ViewProperty)delete n[ni];this.setProperties(n,!0);const ei=createResolutionConstraint(e);this.maxResolution_=ei.maxResolution,this.minResolution_=ei.minResolution,this.zoomFactor_=ei.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=ei.minZoom;const ti=createCenterConstraint(e),ii=ei.constraint,ri=createRotationConstraint(e);this.constraints_={center:ti,resolution:ii,rotation:ri},this.setRotation(e.rotation!==void 0?e.rotation:0),this.setCenterInternal(e.center!==void 0?e.center:null),e.resolution!==void 0?this.setResolution(e.resolution):e.zoom!==void 0&&this.setZoom(e.zoom)}get padding(){return this.padding_}set padding(e){let n=this.padding_;this.padding_=e;const ei=this.getCenterInternal();if(ei){const ti=e||[0,0,0,0];n=n||[0,0,0,0];const ii=this.getResolution(),ri=ii/2*(ti[3]-n[3]+n[1]-ti[1]),ni=ii/2*(ti[0]-n[0]+n[2]-ti[2]);this.setCenterInternal([ei[0]+ri,ei[1]-ni])}}getUpdatedOptions_(e){const n=this.getProperties();return n.resolution!==void 0?n.resolution=this.getResolution():n.zoom=this.getZoom(),n.center=this.getCenterInternal(),n.rotation=this.getRotation(),Object.assign({},n,e)}animate(e){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const n=new Array(arguments.length);for(let ei=0;ei<n.length;++ei){let ti=arguments[ei];ti.center&&(ti=Object.assign({},ti),ti.center=fromUserCoordinate(ti.center,this.getProjection())),ti.anchor&&(ti=Object.assign({},ti),ti.anchor=fromUserCoordinate(ti.anchor,this.getProjection())),n[ei]=ti}this.animateInternal.apply(this,n)}animateInternal(e){let n=arguments.length,ei;n>1&&typeof arguments[n-1]=="function"&&(ei=arguments[n-1],--n);let ti=0;for(;ti<n&&!this.isDef();++ti){const oi=arguments[ti];oi.center&&this.setCenterInternal(oi.center),oi.zoom!==void 0?this.setZoom(oi.zoom):oi.resolution&&this.setResolution(oi.resolution),oi.rotation!==void 0&&this.setRotation(oi.rotation)}if(ti===n){ei&&animationCallback(ei,!0);return}let ii=Date.now(),ri=this.targetCenter_.slice(),ni=this.targetResolution_,si=this.targetRotation_;const ai=[];for(;ti<n;++ti){const oi=arguments[ti],li={start:ii,complete:!1,anchor:oi.anchor,duration:oi.duration!==void 0?oi.duration:1e3,easing:oi.easing||inAndOut,callback:ei};if(oi.center&&(li.sourceCenter=ri,li.targetCenter=oi.center.slice(),ri=li.targetCenter),oi.zoom!==void 0?(li.sourceResolution=ni,li.targetResolution=this.getResolutionForZoom(oi.zoom),ni=li.targetResolution):oi.resolution&&(li.sourceResolution=ni,li.targetResolution=oi.resolution,ni=li.targetResolution),oi.rotation!==void 0){li.sourceRotation=si;const ci=modulo(oi.rotation-si+Math.PI,2*Math.PI)-Math.PI;li.targetRotation=si+ci,si=li.targetRotation}isNoopAnimation(li)?li.complete=!0:ii+=li.duration,ai.push(li)}this.animations_.push(ai),this.setHint(ViewHint.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[ViewHint.ANIMATING]>0}getInteracting(){return this.hints_[ViewHint.INTERACTING]>0}cancelAnimations(){this.setHint(ViewHint.ANIMATING,-this.hints_[ViewHint.ANIMATING]);let e;for(let n=0,ei=this.animations_.length;n<ei;++n){const ti=this.animations_[n];if(ti[0].callback&&animationCallback(ti[0].callback,!1),!e)for(let ii=0,ri=ti.length;ii<ri;++ii){const ni=ti[ii];if(!ni.complete){e=ni.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=e,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const e=Date.now();let n=!1;for(let ei=this.animations_.length-1;ei>=0;--ei){const ti=this.animations_[ei];let ii=!0;for(let ri=0,ni=ti.length;ri<ni;++ri){const si=ti[ri];if(si.complete)continue;const ai=e-si.start;let oi=si.duration>0?ai/si.duration:1;oi>=1?(si.complete=!0,oi=1):ii=!1;const li=si.easing(oi);if(si.sourceCenter){const ci=si.sourceCenter[0],ui=si.sourceCenter[1],di=si.targetCenter[0],fi=si.targetCenter[1];this.nextCenter_=si.targetCenter;const hi=ci+li*(di-ci),pi=ui+li*(fi-ui);this.targetCenter_=[hi,pi]}if(si.sourceResolution&&si.targetResolution){const ci=li===1?si.targetResolution:si.sourceResolution+li*(si.targetResolution-si.sourceResolution);if(si.anchor){const ui=this.getViewportSize_(this.getRotation()),di=this.constraints_.resolution(ci,0,ui,!0);this.targetCenter_=this.calculateCenterZoom(di,si.anchor)}this.nextResolution_=si.targetResolution,this.targetResolution_=ci,this.applyTargetState_(!0)}if(si.sourceRotation!==void 0&&si.targetRotation!==void 0){const ci=li===1?modulo(si.targetRotation+Math.PI,2*Math.PI)-Math.PI:si.sourceRotation+li*(si.targetRotation-si.sourceRotation);if(si.anchor){const ui=this.constraints_.rotation(ci,!0);this.targetCenter_=this.calculateCenterRotate(ui,si.anchor)}this.nextRotation_=si.targetRotation,this.targetRotation_=ci}if(this.applyTargetState_(!0),n=!0,!si.complete)break}if(ii){this.animations_[ei]=null,this.setHint(ViewHint.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const ri=ti[0].callback;ri&&animationCallback(ri,!0)}}this.animations_=this.animations_.filter(Boolean),n&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(e,n){let ei;const ti=this.getCenterInternal();return ti!==void 0&&(ei=[ti[0]-n[0],ti[1]-n[1]],rotate$1(ei,e-this.getRotation()),add$1(ei,n)),ei}calculateCenterZoom(e,n){let ei;const ti=this.getCenterInternal(),ii=this.getResolution();if(ti!==void 0&&ii!==void 0){const ri=n[0]-e*(n[0]-ti[0])/ii,ni=n[1]-e*(n[1]-ti[1])/ii;ei=[ri,ni]}return ei}getViewportSize_(e){const n=this.viewportSize_;if(e){const ei=n[0],ti=n[1];return[Math.abs(ei*Math.cos(e))+Math.abs(ti*Math.sin(e)),Math.abs(ei*Math.sin(e))+Math.abs(ti*Math.cos(e))]}return n}setViewportSize(e){this.viewportSize_=Array.isArray(e)?e.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const e=this.getCenterInternal();return e&&toUserCoordinate(e,this.getProjection())}getCenterInternal(){return this.get(ViewProperty.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(e){return e!==void 0?(e[0]=this.hints_[0],e[1]=this.hints_[1],e):this.hints_.slice()}calculateExtent(e){const n=this.calculateExtentInternal(e);return toUserExtent(n,this.getProjection())}calculateExtentInternal(e){e=e||this.getViewportSizeMinusPadding_();const n=this.getCenterInternal();assert(n,"The view center is not defined");const ei=this.getResolution();assert(ei!==void 0,"The view resolution is not defined");const ti=this.getRotation();return assert(ti!==void 0,"The view rotation is not defined"),getForViewAndSize(n,ei,ti,e)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))}setConstrainResolution(e){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:e}))}getProjection(){return this.projection_}getResolution(){return this.get(ViewProperty.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(e,n){return this.getResolutionForExtentInternal(fromUserExtent(e,this.getProjection()),n)}getResolutionForExtentInternal(e,n){n=n||this.getViewportSizeMinusPadding_();const ei=getWidth(e)/n[0],ti=getHeight(e)/n[1];return Math.max(ei,ti)}getResolutionForValueFunction(e){e=e||2;const n=this.getConstrainedResolution(this.maxResolution_),ei=this.minResolution_,ti=Math.log(n/ei)/Math.log(e);return(function(ii){return n/Math.pow(e,ii*ti)})}getRotation(){return this.get(ViewProperty.ROTATION)}getValueForResolutionFunction(e){const n=Math.log(e||2),ei=this.getConstrainedResolution(this.maxResolution_),ti=this.minResolution_,ii=Math.log(ei/ti)/n;return(function(ri){return Math.log(ei/ri)/n/ii})}getViewportSizeMinusPadding_(e){let n=this.getViewportSize_(e);const ei=this.padding_;return ei&&(n=[n[0]-ei[1]-ei[3],n[1]-ei[0]-ei[2]]),n}getState(){const e=this.getProjection(),n=this.getResolution(),ei=this.getRotation();let ti=this.getCenterInternal();const ii=this.padding_;if(ii){const ri=this.getViewportSizeMinusPadding_();ti=calculateCenterOn(ti,this.getViewportSize_(),[ri[0]/2+ii[3],ri[1]/2+ii[0]],n,ei)}return{center:ti.slice(0),projection:e!==void 0?e:null,resolution:n,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:ei,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let e;const n=this.getResolution();return n!==void 0&&(e=this.getZoomForResolution(n)),e}getZoomForResolution(e){let n=this.minZoom_||0,ei,ti;if(this.resolutions_){const ii=linearFindNearest(this.resolutions_,e,1);n=ii,ei=this.resolutions_[ii],ii==this.resolutions_.length-1?ti=2:ti=ei/this.resolutions_[ii+1]}else ei=this.maxResolution_,ti=this.zoomFactor_;return n+Math.log(ei/e)/Math.log(ti)}getResolutionForZoom(e){var n;if((n=this.resolutions_)!=null&&n.length){if(this.resolutions_.length===1)return this.resolutions_[0];const ei=clamp$1(Math.floor(e),0,this.resolutions_.length-2),ti=this.resolutions_[ei]/this.resolutions_[ei+1];return this.resolutions_[ei]/Math.pow(ti,clamp$1(e-ei,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,e-this.minZoom_)}fit(e,n){let ei;if(assert(Array.isArray(e)||typeof e.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(e)){assert(!isEmpty$1(e),"Cannot fit empty extent provided as `geometry`");const ti=fromUserExtent(e,this.getProjection());ei=fromExtent(ti)}else if(e.getType()==="Circle"){const ti=fromUserExtent(e.getExtent(),this.getProjection());ei=fromExtent(ti),ei.rotate(this.getRotation(),getCenter(ti))}else ei=e;this.fitInternal(ei,n)}rotatedExtentForGeometry(e){const n=this.getRotation(),ei=Math.cos(n),ti=Math.sin(-n),ii=e.getFlatCoordinates(),ri=e.getStride();let ni=1/0,si=1/0,ai=-1/0,oi=-1/0;for(let li=0,ci=ii.length;li<ci;li+=ri){const ui=ii[li]*ei-ii[li+1]*ti,di=ii[li]*ti+ii[li+1]*ei;ni=Math.min(ni,ui),si=Math.min(si,di),ai=Math.max(ai,ui),oi=Math.max(oi,di)}return[ni,si,ai,oi]}fitInternal(e,n){n=n||{};let ei=n.size;ei||(ei=this.getViewportSizeMinusPadding_());const ti=n.padding!==void 0?n.padding:[0,0,0,0],ii=n.nearest!==void 0?n.nearest:!1;let ri;n.minResolution!==void 0?ri=n.minResolution:n.maxZoom!==void 0?ri=this.getResolutionForZoom(n.maxZoom):ri=0;const ni=this.rotatedExtentForGeometry(e);let si=this.getResolutionForExtentInternal(ni,[ei[0]-ti[1]-ti[3],ei[1]-ti[0]-ti[2]]);si=isNaN(si)?ri:Math.max(si,ri),si=this.getConstrainedResolution(si,ii?0:1);const ai=this.getRotation(),oi=Math.sin(ai),li=Math.cos(ai),ci=getCenter(ni);ci[0]+=(ti[1]-ti[3])/2*si,ci[1]+=(ti[0]-ti[2])/2*si;const ui=ci[0]*li-ci[1]*oi,di=ci[1]*li+ci[0]*oi,fi=this.getConstrainedCenter([ui,di],si),hi=n.callback?n.callback:VOID;n.duration!==void 0?this.animateInternal({resolution:si,center:fi,duration:n.duration,easing:n.easing},hi):(this.targetResolution_=si,this.targetCenter_=fi,this.applyTargetState_(!1,!0),animationCallback(hi,!0))}centerOn(e,n,ei){this.centerOnInternal(fromUserCoordinate(e,this.getProjection()),n,ei)}centerOnInternal(e,n,ei){this.setCenterInternal(calculateCenterOn(e,n,ei,this.getResolution(),this.getRotation()))}calculateCenterShift(e,n,ei,ti){let ii;const ri=this.padding_;if(ri&&e){const ni=this.getViewportSizeMinusPadding_(-ei),si=calculateCenterOn(e,ti,[ni[0]/2+ri[3],ni[1]/2+ri[0]],n,ei);ii=[e[0]-si[0],e[1]-si[1]]}return ii}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(e){const n=toUserCoordinate(this.targetCenter_,this.getProjection());this.setCenter([n[0]+e[0],n[1]+e[1]])}adjustCenterInternal(e){const n=this.targetCenter_;this.setCenterInternal([n[0]+e[0],n[1]+e[1]])}adjustResolution(e,n){n=n&&fromUserCoordinate(n,this.getProjection()),this.adjustResolutionInternal(e,n)}adjustResolutionInternal(e,n){const ei=this.getAnimating()||this.getInteracting(),ti=this.getViewportSize_(this.getRotation()),ii=this.constraints_.resolution(this.targetResolution_*e,0,ti,ei);n&&(this.targetCenter_=this.calculateCenterZoom(ii,n)),this.targetResolution_*=e,this.applyTargetState_()}adjustZoom(e,n){this.adjustResolution(Math.pow(this.zoomFactor_,-e),n)}adjustRotation(e,n){n&&(n=fromUserCoordinate(n,this.getProjection())),this.adjustRotationInternal(e,n)}adjustRotationInternal(e,n){const ei=this.getAnimating()||this.getInteracting(),ti=this.constraints_.rotation(this.targetRotation_+e,ei);n&&(this.targetCenter_=this.calculateCenterRotate(ti,n)),this.targetRotation_+=e,this.applyTargetState_()}setCenter(e){this.setCenterInternal(e&&fromUserCoordinate(e,this.getProjection()))}setCenterInternal(e){this.targetCenter_=e,this.applyTargetState_()}setHint(e,n){return this.hints_[e]+=n,this.changed(),this.hints_[e]}setResolution(e){this.targetResolution_=e,this.applyTargetState_()}setRotation(e){this.targetRotation_=e,this.applyTargetState_()}setZoom(e){this.setResolution(this.getResolutionForZoom(e))}applyTargetState_(e,n){const ei=this.getAnimating()||this.getInteracting()||n,ti=this.constraints_.rotation(this.targetRotation_,ei),ii=this.getViewportSize_(ti),ri=this.constraints_.resolution(this.targetResolution_,0,ii,ei),ni=this.constraints_.center(this.targetCenter_,ri,ii,ei,this.calculateCenterShift(this.targetCenter_,ri,ti,ii));this.get(ViewProperty.ROTATION)!==ti&&this.set(ViewProperty.ROTATION,ti),this.get(ViewProperty.RESOLUTION)!==ri&&(this.set(ViewProperty.RESOLUTION,ri),this.set("zoom",this.getZoom(),!0)),(!ni||!this.get(ViewProperty.CENTER)||!equals$2(this.get(ViewProperty.CENTER),ni))&&this.set(ViewProperty.CENTER,ni),this.getAnimating()&&!e&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(e,n,ei){e=e!==void 0?e:200;const ti=n||0,ii=this.constraints_.rotation(this.targetRotation_),ri=this.getViewportSize_(ii),ni=this.constraints_.resolution(this.targetResolution_,ti,ri),si=this.constraints_.center(this.targetCenter_,ni,ri,!1,this.calculateCenterShift(this.targetCenter_,ni,ii,ri));if(e===0&&!this.cancelAnchor_){this.targetResolution_=ni,this.targetRotation_=ii,this.targetCenter_=si,this.applyTargetState_();return}ei=ei||(e===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==ni||this.getRotation()!==ii||!this.getCenterInternal()||!equals$2(this.getCenterInternal(),si))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:ii,center:si,resolution:ni,duration:e,easing:easeOut,anchor:ei}))}beginInteraction(){this.resolveConstraints(0),this.setHint(ViewHint.INTERACTING,1)}endInteraction(e,n,ei){ei=ei&&fromUserCoordinate(ei,this.getProjection()),this.endInteractionInternal(e,n,ei)}endInteractionInternal(e,n,ei){this.getInteracting()&&(this.setHint(ViewHint.INTERACTING,-1),this.resolveConstraints(e,n,ei))}getConstrainedCenter(e,n){const ei=this.getViewportSize_(this.getRotation());return this.constraints_.center(e,n||this.getResolution(),ei)}getConstrainedZoom(e,n){const ei=this.getResolutionForZoom(e);return this.getZoomForResolution(this.getConstrainedResolution(ei,n))}getConstrainedResolution(e,n){n=n||0;const ei=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(e,n,ei)}}function animationCallback(_t,e){setTimeout(function(){_t(e)},0)}function createCenterConstraint(_t){if(_t.extent!==void 0){const n=_t.smoothExtentConstraint!==void 0?_t.smoothExtentConstraint:!0;return createExtent(_t.extent,_t.constrainOnlyCenter,n)}const e=createProjection(_t.projection,"EPSG:3857");if(_t.multiWorld!==!0&&e.isGlobal()){const n=e.getExtent().slice();return n[0]=-1/0,n[2]=1/0,createExtent(n,!1,!1)}return none}function createResolutionConstraint(_t){let e,n,ei,ri=_t.minZoom!==void 0?_t.minZoom:DEFAULT_MIN_ZOOM,ni=_t.maxZoom!==void 0?_t.maxZoom:28;const si=_t.zoomFactor!==void 0?_t.zoomFactor:2,ai=_t.multiWorld!==void 0?_t.multiWorld:!1,oi=_t.smoothResolutionConstraint!==void 0?_t.smoothResolutionConstraint:!0,li=_t.showFullExtent!==void 0?_t.showFullExtent:!1,ci=createProjection(_t.projection,"EPSG:3857"),ui=ci.getExtent();let di=_t.constrainOnlyCenter,fi=_t.extent;if(!ai&&!fi&&ci.isGlobal()&&(di=!1,fi=ui),_t.resolutions!==void 0){const hi=_t.resolutions;n=hi[ri],ei=hi[ni]!==void 0?hi[ni]:hi[hi.length-1],_t.constrainResolution?e=createSnapToResolutions(hi,oi,!di&&fi,li):e=createMinMaxResolution(n,ei,oi,!di&&fi,li)}else{const pi=(ui?Math.max(getWidth(ui),getHeight(ui)):360*METERS_PER_UNIT.degrees/ci.getMetersPerUnit())/DEFAULT_TILE_SIZE/Math.pow(2,DEFAULT_MIN_ZOOM),gi=pi/Math.pow(2,28-DEFAULT_MIN_ZOOM);n=_t.maxResolution,n!==void 0?ri=0:n=pi/Math.pow(si,ri),ei=_t.minResolution,ei===void 0&&(_t.maxZoom!==void 0?_t.maxResolution!==void 0?ei=n/Math.pow(si,ni):ei=pi/Math.pow(si,ni):ei=gi),ni=ri+Math.floor(Math.log(n/ei)/Math.log(si)),ei=n/Math.pow(si,ni-ri),_t.constrainResolution?e=createSnapToPower(si,n,ei,oi,!di&&fi,li):e=createMinMaxResolution(n,ei,oi,!di&&fi,li)}return{constraint:e,maxResolution:n,minResolution:ei,minZoom:ri,zoomFactor:si}}function createRotationConstraint(_t){if(_t.enableRotation!==void 0?_t.enableRotation:!0){const n=_t.constrainRotation;return n===void 0||n===!0?createSnapToZero():n===!1?none$1:typeof n=="number"?createSnapToN(n):none$1}return disable}function isNoopAnimation(_t){return!(_t.sourceCenter&&_t.targetCenter&&!equals$2(_t.sourceCenter,_t.targetCenter)||_t.sourceResolution!==_t.targetResolution||_t.sourceRotation!==_t.targetRotation)}function calculateCenterOn(_t,e,n,ei,ti){const ii=Math.cos(-ti);let ri=Math.sin(-ti),ni=_t[0]*ii-_t[1]*ri,si=_t[1]*ii+_t[0]*ri;ni+=(e[0]/2-n[0])*ei,si+=(n[1]-e[1]/2)*ei,ri=-ri;const ai=ni*ii-si*ri,oi=si*ii+ni*ri;return[ai,oi]}const LayerProperty={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class BaseLayer extends BaseObject{constructor(e){super(),this.on,this.once,this.un,this.background_=e.background;const n=Object.assign({},e);typeof e.properties=="object"&&(delete n.properties,Object.assign(n,e.properties)),n[LayerProperty.OPACITY]=e.opacity!==void 0?e.opacity:1,assert(typeof n[LayerProperty.OPACITY]=="number","Layer opacity must be a number"),n[LayerProperty.VISIBLE]=e.visible!==void 0?e.visible:!0,n[LayerProperty.Z_INDEX]=e.zIndex,n[LayerProperty.MAX_RESOLUTION]=e.maxResolution!==void 0?e.maxResolution:1/0,n[LayerProperty.MIN_RESOLUTION]=e.minResolution!==void 0?e.minResolution:0,n[LayerProperty.MIN_ZOOM]=e.minZoom!==void 0?e.minZoom:-1/0,n[LayerProperty.MAX_ZOOM]=e.maxZoom!==void 0?e.maxZoom:1/0,this.className_=n.className!==void 0?n.className:"ol-layer",delete n.className,this.setProperties(n),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(e){const n=this.state_||{layer:this,managed:e===void 0?!0:e},ei=this.getZIndex();return n.opacity=clamp$1(Math.round(this.getOpacity()*100)/100,0,1),n.visible=this.getVisible(),n.extent=this.getExtent(),n.zIndex=ei===void 0&&!n.managed?1/0:ei,n.maxResolution=this.getMaxResolution(),n.minResolution=Math.max(this.getMinResolution(),0),n.minZoom=this.getMinZoom(),n.maxZoom=this.getMaxZoom(),this.state_=n,n}getLayersArray(e){return abstract()}getLayerStatesArray(e){return abstract()}getExtent(){return this.get(LayerProperty.EXTENT)}getMaxResolution(){return this.get(LayerProperty.MAX_RESOLUTION)}getMinResolution(){return this.get(LayerProperty.MIN_RESOLUTION)}getMinZoom(){return this.get(LayerProperty.MIN_ZOOM)}getMaxZoom(){return this.get(LayerProperty.MAX_ZOOM)}getOpacity(){return this.get(LayerProperty.OPACITY)}getSourceState(){return abstract()}getVisible(){return this.get(LayerProperty.VISIBLE)}getZIndex(){return this.get(LayerProperty.Z_INDEX)}setBackground(e){this.background_=e,this.changed()}setExtent(e){this.set(LayerProperty.EXTENT,e)}setMaxResolution(e){this.set(LayerProperty.MAX_RESOLUTION,e)}setMinResolution(e){this.set(LayerProperty.MIN_RESOLUTION,e)}setMaxZoom(e){this.set(LayerProperty.MAX_ZOOM,e)}setMinZoom(e){this.set(LayerProperty.MIN_ZOOM,e)}setOpacity(e){assert(typeof e=="number","Layer opacity must be a number"),this.set(LayerProperty.OPACITY,e)}setVisible(e){this.set(LayerProperty.VISIBLE,e)}setZIndex(e){this.set(LayerProperty.Z_INDEX,e)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}let Layer$1=class extends BaseLayer{constructor(e){const n=Object.assign({},e);delete n.source,super(n),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,e.render&&(this.render=e.render),e.map&&this.setMap(e.map),this.addChangeListener(LayerProperty.SOURCE,this.handleSourcePropertyChange_);const ei=e.source?e.source:null;this.setSource(ei)}getLayersArray(e){return e=e||[],e.push(this),e}getLayerStatesArray(e){return e=e||[],e.push(this.getLayerState()),e}getSource(){return this.get(LayerProperty.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const e=this.getSource();return e?e.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(unlistenByKey(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const e=this.getSource();e&&(this.sourceChangeKey_=listen(e,EventType.CHANGE,this.handleSourceChange_,this),e.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(e){return this.renderer_?this.renderer_.getFeatures(e):Promise.resolve([])}getData(e){return!this.renderer_||!this.rendered?null:this.renderer_.getData(e)}isVisible(e){let n;const ei=this.getMapInternal();!e&&ei&&(e=ei.getView()),e instanceof View?n={viewState:e.getState(),extent:e.calculateExtent()}:n=e,!n.layerStatesArray&&ei&&(n.layerStatesArray=ei.getLayerGroup().getLayerStatesArray());let ti;if(n.layerStatesArray){if(ti=n.layerStatesArray.find(ri=>ri.layer===this),!ti)return!1}else ti=this.getLayerState();const ii=this.getExtent();return inView(ti,n.viewState)&&(!ii||intersects$1(ii,n.extent))}getAttributions(e){var ii;if(!this.isVisible(e))return[];const n=(ii=this.getSource())==null?void 0:ii.getAttributions();if(!n)return[];const ei=e instanceof View?e.getViewStateAndExtent():e;let ti=n(ei);return Array.isArray(ti)||(ti=[ti]),ti}render(e,n){const ei=this.getRenderer();return ei.prepareFrame(e)?(this.rendered=!0,ei.renderFrame(e,n)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(e,n){}renderDeferred(e){const n=this.getRenderer();n&&n.renderDeferred(e)}setMapInternal(e){e||this.unrender(),this.set(LayerProperty.MAP,e)}getMapInternal(){return this.get(LayerProperty.MAP)}setMap(e){this.mapPrecomposeKey_&&(unlistenByKey(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(unlistenByKey(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=listen(e,RenderEventType.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=listen(this,EventType.CHANGE,e.render,e),this.changed())}handlePrecompose_(e){const n=e.frameState.layerStatesArray,ei=this.getLayerState(!1);assert(!n.some(ti=>ti.layer===ei.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),n.push(ei)}setSource(e){this.set(LayerProperty.SOURCE,e)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}};function inView(_t,e){if(!_t.visible)return!1;const n=e.resolution;if(n<_t.minResolution||n>=_t.maxResolution)return!1;const ei=e.zoom;return ei>_t.minZoom&&ei<=_t.maxZoom}const Property$2={RENDER_ORDER:"renderOrder"};class BaseVectorLayer extends Layer$1{constructor(e){e=e||{};const n=Object.assign({},e);delete n.style,delete n.renderBuffer,delete n.updateWhileAnimating,delete n.updateWhileInteracting,super(n),this.declutter_=e.declutter?String(e.declutter):void 0,this.renderBuffer_=e.renderBuffer!==void 0?e.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(e.style),this.updateWhileAnimating_=e.updateWhileAnimating!==void 0?e.updateWhileAnimating:!1,this.updateWhileInteracting_=e.updateWhileInteracting!==void 0?e.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(e){return super.getFeatures(e)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(Property$2.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(e,n){const ei=this.getDeclutter();ei in e.declutter||(e.declutter[ei]=new RBush$1(9)),this.getRenderer().renderDeclutter(e,n)}setRenderOrder(e){this.set(Property$2.RENDER_ORDER,e)}setStyle(e){this.style_=e===void 0?createDefaultStyle:e;const n=toStyleLike(e);this.styleFunction_=e===null?void 0:toFunction(n),this.changed()}setDeclutter(e){this.declutter_=e?String(e):void 0,this.changed()}}function toStyleLike(_t){if(_t===void 0)return createDefaultStyle;if(!_t)return null;if(typeof _t=="function"||_t instanceof Style$1)return _t;if(!Array.isArray(_t))return flatStylesToStyleFunction([_t]);if(_t.length===0)return[];const e=_t.length,n=_t[0];if(n instanceof Style$1){const ti=new Array(e);for(let ii=0;ii<e;++ii){const ri=_t[ii];if(!(ri instanceof Style$1))throw new Error("Expected a list of style instances");ti[ii]=ri}return ti}if("style"in n){const ti=new Array(e);for(let ii=0;ii<e;++ii){const ri=_t[ii];if(!("style"in ri))throw new Error("Expected a list of rules with a style property");ti[ii]=ri}return rulesToStyleFunction(ti)}return flatStylesToStyleFunction(_t)}class VectorLayer extends BaseVectorLayer{constructor(e){super(e)}createRenderer(){return new CanvasVectorLayerRenderer(this)}}function getCoordinate(_t,e){const n=_t.length;return e<0?_t[e+n]:e>=n?_t[e-n]:_t[e]}function interpolateCoordinate(_t,e){const n=_t.length;let ei=Math.floor(e);const ti=e-ei;ei>=n?ei-=n:ei<0&&(ei+=n);let ii=ei+1;ii>=n&&(ii-=n);const ri=_t[ei],ni=ri[0],si=ri[1],ai=_t[ii],oi=ai[0]-ni,li=ai[1]-si;return[ni+oi*ti,si+li*ti]}const sharedUpdateInfo={index:-1,endIndex:NaN,closestTargetDistance:1/0};function getTraceTargetUpdate(_t,e,n,ei){const ti=_t[0],ii=_t[1];let ri=1/0,ni=-1,si=NaN;for(let li=0;li<e.targets.length;++li){const ci=e.targets[li],ui=ci.coordinates;let di=1/0,fi;for(let hi=0;hi<ui.length-1;++hi){const pi=ui[hi],gi=ui[hi+1],vi=getPointSegmentRelationship(ti,ii,pi,gi);vi.squaredDistance<di&&(di=vi.squaredDistance,fi=hi+vi.along)}di<ri&&(ri=di,ci.ring&&e.targetIndex===li&&(ci.endIndex>ci.startIndex?fi<ci.startIndex&&(fi+=ui.length):ci.endIndex<ci.startIndex&&fi>ci.startIndex&&(fi-=ui.length)),si=fi,ni=li)}const ai=e.targets[ni];let oi=ai.ring;if(e.targetIndex===ni&&oi){const li=interpolateCoordinate(ai.coordinates,si),ci=n.getPixelFromCoordinate(li),ui=n.getPixelFromCoordinate(e.startCoord);distance(ci,ui)>ei&&(oi=!1)}if(oi){const li=ai.coordinates,ci=li.length,ui=ai.startIndex,di=si;if(ui<di){const fi=getCumulativeSquaredDistance(li,ui,di);getCumulativeSquaredDistance(li,ui,di-ci)<fi&&(si-=ci)}else{const fi=getCumulativeSquaredDistance(li,ui,di);getCumulativeSquaredDistance(li,ui,di+ci)<fi&&(si+=ci)}}return sharedUpdateInfo.index=ni,sharedUpdateInfo.endIndex=si,sharedUpdateInfo.closestTargetDistance=ri,sharedUpdateInfo}function getTraceTargets(_t,e){const n=[];for(let ei=0;ei<e.length;++ei){const ii=e[ei].getGeometry();appendGeometryTraceTargets(_t,ii,n)}return n}function appendGeometryTraceTargets(_t,e,n){if(e instanceof LineString){appendTraceTarget(_t,e.getCoordinates(),!1,n);return}if(e instanceof MultiLineString){const ei=e.getCoordinates();for(let ti=0,ii=ei.length;ti<ii;++ti)appendTraceTarget(_t,ei[ti],!1,n);return}if(e instanceof Polygon){const ei=e.getCoordinates();for(let ti=0,ii=ei.length;ti<ii;++ti)appendTraceTarget(_t,ei[ti],!0,n);return}if(e instanceof MultiPolygon){const ei=e.getCoordinates();for(let ti=0,ii=ei.length;ti<ii;++ti){const ri=ei[ti];for(let ni=0,si=ri.length;ni<si;++ni)appendTraceTarget(_t,ri[ni],!0,n)}return}if(e instanceof GeometryCollection){const ei=e.getGeometries();for(let ti=0;ti<ei.length;++ti)appendGeometryTraceTargets(_t,ei[ti],n);return}}function appendTraceTarget(_t,e,n,ei){const ti=_t[0],ii=_t[1];for(let ri=0,ni=e.length-1;ri<ni;++ri){const si=e[ri],ai=e[ri+1],oi=getPointSegmentRelationship(ti,ii,si,ai);if(oi.squaredDistance===0){const li=ri+oi.along;ei.push({coordinates:e,ring:n,startIndex:li,endIndex:li});return}}}function getSquaredDistance(_t,e){return squaredDistance(_t[0],_t[1],e[0],e[1])}function getCumulativeSquaredDistance(_t,e,n){let ei,ti;e<n?(ei=e,ti=n):(ei=n,ti=e);const ii=Math.ceil(ei),ri=Math.floor(ti);if(ii>ri){const si=interpolateCoordinate(_t,ei),ai=interpolateCoordinate(_t,ti);return getSquaredDistance(si,ai)}let ni=0;if(ei<ii){const si=interpolateCoordinate(_t,ei),ai=getCoordinate(_t,ii);ni+=getSquaredDistance(si,ai)}if(ri<ti){const si=getCoordinate(_t,ri),ai=interpolateCoordinate(_t,ti);ni+=getSquaredDistance(si,ai)}for(let si=ii;si<ri-1;++si){const ai=getCoordinate(_t,si),oi=getCoordinate(_t,si+1);ni+=getSquaredDistance(ai,oi)}return ni}const sharedRel={along:0,squaredDistance:0};function getPointSegmentRelationship(_t,e,n,ei){const ti=n[0],ii=n[1],ri=ei[0],ni=ei[1],si=ri-ti,ai=ni-ii;let oi=0,li=ti,ci=ii;return(si!==0||ai!==0)&&(oi=clamp$1(((_t-ti)*si+(e-ii)*ai)/(si*si+ai*ai),0,1),li+=si*oi,ci+=ai*oi),sharedRel.along=oi,sharedRel.squaredDistance=toFixed(squaredDistance(_t,e,li,ci),10),sharedRel}const DrawEventType={DRAWSTART:"drawstart",DRAWEND:"drawend",DRAWABORT:"drawabort"};class DrawEvent extends BaseEvent{constructor(e,n){super(e),this.feature=n}}class Draw extends PointerInteraction{constructor(e){const n=e;n.stopDown||(n.stopDown=FALSE),super(n),this.on,this.once,this.un,this.options_=e,this.shouldHandle_=!1,this.downPx_=null,this.downTimeout_,this.lastDragTime_,this.pointerType_,this.freehand_=!1,this.source_=e.source?e.source:null,this.features_=e.features?e.features:null,this.snapTolerance_=e.snapTolerance?e.snapTolerance:12,this.type_=e.type,this.mode_=getMode(this.type_),this.stopClick_=!!e.stopClick,this.ignoreNextUpEvent_=!1,this.minPoints_=e.minPoints?e.minPoints:this.mode_==="Polygon"?3:2,this.maxPoints_=this.mode_==="Circle"?2:e.maxPoints?e.maxPoints:1/0,this.finishCondition_=e.finishCondition?e.finishCondition:TRUE,this.geometryLayout_=e.geometryLayout?e.geometryLayout:"XY";let ei=e.geometryFunction;if(!ei){const ti=this.mode_;if(ti==="Circle")ei=(ii,ri,ni)=>{const si=ri||new Circle([NaN,NaN]),ai=fromUserCoordinate(ii[0]),oi=squaredDistance$1(ai,fromUserCoordinate(ii[ii.length-1]));return si.setCenterAndRadius(ai,Math.sqrt(oi),this.geometryLayout_),si};else{let ii;ti==="Point"?ii=Point$1:ti==="LineString"?ii=LineString:ti==="Polygon"&&(ii=Polygon),ei=(ri,ni,si)=>(ni?ti==="Polygon"?ri[0].length?ni.setCoordinates([ri[0].concat([ri[0][0]])],this.geometryLayout_):ni.setCoordinates([],this.geometryLayout_):ni.setCoordinates(ri,this.geometryLayout_):ni=new ii(ri,this.geometryLayout_),ni)}}this.geometryFunction_=ei,this.dragVertexDelay_=e.dragVertexDelay!==void 0?e.dragVertexDelay:500,this.finishCoordinate_=null,this.sketchFeature_=null,this.sketchPoint_=null,this.sketchCoords_=null,this.sketchLine_=null,this.sketchLineCoords_=null,this.squaredClickTolerance_=e.clickTolerance?e.clickTolerance*e.clickTolerance:36,this.overlay_=new VectorLayer({source:new VectorSource({useSpatialIndex:!1,wrapX:e.wrapX?e.wrapX:!1}),style:e.style?e.style:getDefaultStyleFunction$2(),updateWhileInteracting:!0}),this.geometryName_=e.geometryName,this.condition_=e.condition?e.condition:noModifierKeys,this.freehandCondition_,e.freehand?this.freehandCondition_=always$1:this.freehandCondition_=e.freehandCondition?e.freehandCondition:shiftKeyOnly,this.traceCondition_,this.setTrace(e.trace||!1),this.traceState_={active:!1},this.traceSource_=e.traceSource||e.source||null,this.addChangeListener(InteractionProperty.ACTIVE,this.updateState_)}setTrace(e){let n;e?e===!0?n=always$1:n=e:n=never,this.traceCondition_=n}setMap(e){super.setMap(e),this.updateState_()}setFreehand(e){this.freehand_=e,this.freehand_?this.freehandCondition_=always$1:this.freehandCondition_=this.options_&&this.options_.freehandCondition?this.options_.freehandCondition:shiftKeyOnly}getOverlay(){return this.overlay_}getFreehand(){return this.freehand_}handleEvent(e){e.originalEvent.type===EventType.CONTEXTMENU&&e.originalEvent.preventDefault(),this.freehand_=this.mode_!=="Point"&&this.freehandCondition_(e);let n=e.type===MapBrowserEventType.POINTERMOVE,ei=!0;return!this.freehand_&&this.lastDragTime_&&e.type===MapBrowserEventType.POINTERDRAG&&(Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=e.pixel,this.shouldHandle_=!this.freehand_,n=!0):this.lastDragTime_=void 0,this.shouldHandle_&&this.downTimeout_!==void 0&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0)),this.freehand_&&e.type===MapBrowserEventType.POINTERDRAG&&this.sketchFeature_!==null?(this.addToDrawing_(e.coordinate),ei=!1):this.freehand_&&e.type===MapBrowserEventType.POINTERDOWN?ei=!1:n&&this.getPointerCount()<2?(ei=e.type===MapBrowserEventType.POINTERMOVE,ei&&this.freehand_?(this.handlePointerMove_(e),this.shouldHandle_&&e.originalEvent.preventDefault()):(e.originalEvent.pointerType==="mouse"||e.type===MapBrowserEventType.POINTERDRAG&&this.downTimeout_===void 0)&&this.handlePointerMove_(e)):e.type===MapBrowserEventType.DBLCLICK&&(ei=!1),super.handleEvent(e)&&ei}handleDownEvent(e){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=e.pixel,this.finishCoordinate_||this.startDrawing_(e.coordinate),!0):this.condition_(e)?(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(()=>{this.handlePointerMove_(new MapBrowserEvent(MapBrowserEventType.POINTERMOVE,e.map,e.originalEvent,!1,e.frameState))},this.dragVertexDelay_),this.downPx_=e.pixel,!0):(this.lastDragTime_=void 0,!1)}deactivateTrace_(){this.traceState_={active:!1}}toggleTraceState_(e){if(!this.traceSource_||!this.traceCondition_(e))return;if(this.traceState_.active){this.deactivateTrace_();return}const n=this.getMap(),ei=n.getCoordinateFromPixel([e.pixel[0]-this.snapTolerance_,e.pixel[1]+this.snapTolerance_]),ti=n.getCoordinateFromPixel([e.pixel[0]+this.snapTolerance_,e.pixel[1]-this.snapTolerance_]),ii=boundingExtent([ei,ti]),ri=this.traceSource_.getFeaturesInExtent(ii);if(ri.length===0)return;const ni=getTraceTargets(e.coordinate,ri);ni.length&&(this.traceState_={active:!0,startCoord:e.coordinate.slice(),targets:ni,targetIndex:-1})}addOrRemoveTracedCoordinates_(e,n){const ei=e.startIndex<=e.endIndex,ti=e.startIndex<=n;ei===ti?ei&&n>e.endIndex||!ei&&n<e.endIndex?this.addTracedCoordinates_(e,e.endIndex,n):(ei&&n<e.endIndex||!ei&&n>e.endIndex)&&this.removeTracedCoordinates_(n,e.endIndex):(this.removeTracedCoordinates_(e.startIndex,e.endIndex),this.addTracedCoordinates_(e,e.startIndex,n))}removeTracedCoordinates_(e,n){if(e===n)return;let ei=0;if(e<n){const ti=Math.ceil(e);let ii=Math.floor(n);ii===n&&(ii-=1),ei=ii-ti+1}else{const ti=Math.floor(e);let ii=Math.ceil(n);ii===n&&(ii+=1),ei=ti-ii+1}ei>0&&this.removeLastPoints_(ei)}addTracedCoordinates_(e,n,ei){if(n===ei)return;const ti=[];if(n<ei){const ii=Math.ceil(n);let ri=Math.floor(ei);ri===ei&&(ri-=1);for(let ni=ii;ni<=ri;++ni)ti.push(getCoordinate(e.coordinates,ni))}else{const ii=Math.floor(n);let ri=Math.ceil(ei);ri===ei&&(ri+=1);for(let ni=ii;ni>=ri;--ni)ti.push(getCoordinate(e.coordinates,ni))}ti.length&&this.appendCoordinates(ti)}updateTrace_(e){const n=this.traceState_;if(!n.active)return;if(n.targetIndex===-1){const ni=e.map.getPixelFromCoordinate(n.startCoord);if(distance(ni,e.pixel)<this.snapTolerance_)return}const ei=getTraceTargetUpdate(e.coordinate,n,this.getMap(),this.snapTolerance_);if(n.targetIndex!==ei.index){if(n.targetIndex!==-1){const si=n.targets[n.targetIndex];this.removeTracedCoordinates_(si.startIndex,si.endIndex)}const ni=n.targets[ei.index];this.addTracedCoordinates_(ni,ni.startIndex,ei.endIndex)}else{const ni=n.targets[n.targetIndex];this.addOrRemoveTracedCoordinates_(ni,ei.endIndex)}n.targetIndex=ei.index;const ti=n.targets[n.targetIndex];ti.endIndex=ei.endIndex;const ii=interpolateCoordinate(ti.coordinates,ti.endIndex),ri=this.getMap().getPixelFromCoordinate(ii);e.coordinate=ii,e.pixel=[Math.round(ri[0]),Math.round(ri[1])]}handleDragEvent(e){this.ignoreNextUpEvent_=!0,super.handleDragEvent(e)}handleUpEvent(e){let n=!0;if(this.getPointerCount()===0){this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(e);const ei=this.traceState_.active;if(this.ignoreNextUpEvent_||this.toggleTraceState_(e),this.shouldHandle_){const ti=!this.finishCoordinate_;ti&&this.startDrawing_(e.coordinate),!ti&&this.freehand_?this.finishDrawing():!this.freehand_&&(!ti||this.mode_==="Point")&&(this.atFinish_(e.pixel,ei)?this.finishCondition_(e)&&this.finishDrawing():this.addToDrawing_(e.coordinate)),n=!1}else this.freehand_&&this.abortDrawing()}return this.ignoreNextUpEvent_=!1,!n&&this.stopClick_&&e.preventDefault(),n}handlePointerMove_(e){if(this.pointerType_=e.originalEvent.pointerType,this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){const n=this.downPx_,ei=e.pixel,ti=n[0]-ei[0],ii=n[1]-ei[1],ri=ti*ti+ii*ii;if(this.shouldHandle_=this.freehand_?ri>this.squaredClickTolerance_:ri<=this.squaredClickTolerance_,!this.shouldHandle_)return}if(!this.finishCoordinate_){this.createOrUpdateSketchPoint_(e.coordinate.slice());return}this.updateTrace_(e),this.modifyDrawing_(e.coordinate)}atFinish_(e,n){let ei=!1;if(this.sketchFeature_){let ti=!1,ii=[this.finishCoordinate_];const ri=this.mode_;if(ri==="Point")ei=!0;else if(ri==="Circle")ei=this.sketchCoords_.length===2;else if(ri==="LineString")ti=!n&&this.sketchCoords_.length>this.minPoints_;else if(ri==="Polygon"){const ni=this.sketchCoords_;ti=ni[0].length>this.minPoints_,ii=[ni[0][0],ni[0][ni[0].length-2]],n?ii=[ni[0][0]]:ii=[ni[0][0],ni[0][ni[0].length-2]]}if(ti){const ni=this.getMap();for(let si=0,ai=ii.length;si<ai;si++){const oi=ii[si],li=ni.getPixelFromCoordinate(oi),ci=e[0]-li[0],ui=e[1]-li[1],di=this.freehand_?1:this.snapTolerance_;if(ei=Math.sqrt(ci*ci+ui*ui)<=di,ei){this.finishCoordinate_=oi;break}}}}return ei}createOrUpdateSketchPoint_(e){this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(e):(this.sketchPoint_=new Feature(new Point$1(e)),this.updateSketchFeatures_())}createOrUpdateCustomSketchLine_(e){this.sketchLine_||(this.sketchLine_=new Feature);const n=e.getLinearRing(0);let ei=this.sketchLine_.getGeometry();ei?(ei.setFlatCoordinates(n.getLayout(),n.getFlatCoordinates()),ei.changed()):(ei=new LineString(n.getFlatCoordinates(),n.getLayout()),this.sketchLine_.setGeometry(ei))}startDrawing_(e){const n=this.getMap().getView().getProjection(),ei=getStrideForLayout(this.geometryLayout_);for(;e.length<ei;)e.push(0);this.finishCoordinate_=e,this.mode_==="Point"?this.sketchCoords_=e.slice():this.mode_==="Polygon"?(this.sketchCoords_=[[e.slice(),e.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[e.slice(),e.slice()],this.sketchLineCoords_&&(this.sketchLine_=new Feature(new LineString(this.sketchLineCoords_)));const ti=this.geometryFunction_(this.sketchCoords_,void 0,n);this.sketchFeature_=new Feature,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(ti),this.updateSketchFeatures_(),this.dispatchEvent(new DrawEvent(DrawEventType.DRAWSTART,this.sketchFeature_))}modifyDrawing_(e){const n=this.getMap(),ei=this.sketchFeature_.getGeometry(),ti=n.getView().getProjection(),ii=getStrideForLayout(this.geometryLayout_);let ri,ni;for(;e.length<ii;)e.push(0);this.mode_==="Point"?ni=this.sketchCoords_:this.mode_==="Polygon"?(ri=this.sketchCoords_[0],ni=ri[ri.length-1],this.atFinish_(n.getPixelFromCoordinate(e))&&(e=this.finishCoordinate_.slice())):(ri=this.sketchCoords_,ni=ri[ri.length-1]),ni[0]=e[0],ni[1]=e[1],this.geometryFunction_(this.sketchCoords_,ei,ti),this.sketchPoint_&&this.sketchPoint_.getGeometry().setCoordinates(e),ei.getType()==="Polygon"&&this.mode_!=="Polygon"?this.createOrUpdateCustomSketchLine_(ei):this.sketchLineCoords_&&this.sketchLine_.getGeometry().setCoordinates(this.sketchLineCoords_),this.updateSketchFeatures_()}addToDrawing_(e){const n=this.sketchFeature_.getGeometry(),ei=this.getMap().getView().getProjection();let ti,ii;const ri=this.mode_;return ri==="LineString"||ri==="Circle"?(this.finishCoordinate_=e.slice(),ii=this.sketchCoords_,ii.length>=this.maxPoints_&&(this.freehand_?ii.pop():ti=!0),ii.push(e.slice()),this.geometryFunction_(ii,n,ei)):ri==="Polygon"&&(ii=this.sketchCoords_[0],ii.length>=this.maxPoints_&&(this.freehand_?ii.pop():ti=!0),ii.push(e.slice()),ti&&(this.finishCoordinate_=ii[0]),this.geometryFunction_(this.sketchCoords_,n,ei)),this.createOrUpdateSketchPoint_(e.slice()),this.updateSketchFeatures_(),ti?this.finishDrawing():this.sketchFeature_}removeLastPoints_(e){if(!this.sketchFeature_)return;const n=this.sketchFeature_.getGeometry(),ei=this.getMap().getView().getProjection(),ti=this.mode_;for(let ii=0;ii<e;++ii){let ri;if(ti==="LineString"||ti==="Circle"){if(ri=this.sketchCoords_,ri.splice(-2,1),ri.length>=2){this.finishCoordinate_=ri[ri.length-2].slice();const ni=this.finishCoordinate_.slice();ri[ri.length-1]=ni,this.createOrUpdateSketchPoint_(ni)}this.geometryFunction_(ri,n,ei),n.getType()==="Polygon"&&this.sketchLine_&&this.createOrUpdateCustomSketchLine_(n)}else if(ti==="Polygon"){ri=this.sketchCoords_[0],ri.splice(-2,1);const ni=this.sketchLine_.getGeometry();if(ri.length>=2){const si=ri[ri.length-2].slice();ri[ri.length-1]=si,this.createOrUpdateSketchPoint_(si)}ni.setCoordinates(ri),this.geometryFunction_(this.sketchCoords_,n,ei)}if(ri.length===1){this.abortDrawing();break}}this.updateSketchFeatures_()}removeLastPoint(){this.removeLastPoints_(1)}finishDrawing(){const e=this.abortDrawing_();if(!e)return null;let n=this.sketchCoords_;const ei=e.getGeometry(),ti=this.getMap().getView().getProjection();return this.mode_==="LineString"?(n.pop(),this.geometryFunction_(n,ei,ti)):this.mode_==="Polygon"&&(n[0].pop(),this.geometryFunction_(n,ei,ti),n=ei.getCoordinates()),this.type_==="MultiPoint"?e.setGeometry(new MultiPoint([n])):this.type_==="MultiLineString"?e.setGeometry(new MultiLineString([n])):this.type_==="MultiPolygon"&&e.setGeometry(new MultiPolygon([n])),this.dispatchEvent(new DrawEvent(DrawEventType.DRAWEND,e)),this.features_&&this.features_.push(e),this.source_&&this.source_.addFeature(e),e}abortDrawing_(){this.finishCoordinate_=null;const e=this.sketchFeature_;return this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0),this.deactivateTrace_(),e}abortDrawing(){const e=this.abortDrawing_();e&&this.dispatchEvent(new DrawEvent(DrawEventType.DRAWABORT,e))}appendCoordinates(e){const n=this.mode_,ei=!this.sketchFeature_;ei&&this.startDrawing_(e[0]);let ti;if(n==="LineString"||n==="Circle")ti=this.sketchCoords_;else if(n==="Polygon")ti=this.sketchCoords_&&this.sketchCoords_.length?this.sketchCoords_[0]:[];else return;ei&&ti.shift(),ti.pop();for(let ri=0;ri<e.length;ri++)this.addToDrawing_(e[ri]);const ii=e[e.length-1];this.sketchFeature_=this.addToDrawing_(ii),this.modifyDrawing_(ii)}extend(e){const ei=e.getGeometry();this.sketchFeature_=e,this.sketchCoords_=ei.getCoordinates();const ti=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=ti.slice(),this.sketchCoords_.push(ti.slice()),this.sketchPoint_=new Feature(new Point$1(ti)),this.updateSketchFeatures_(),this.dispatchEvent(new DrawEvent(DrawEventType.DRAWSTART,this.sketchFeature_))}updateSketchFeatures_(){const e=[];this.sketchFeature_&&e.push(this.sketchFeature_),this.sketchLine_&&e.push(this.sketchLine_),this.sketchPoint_&&e.push(this.sketchPoint_);const n=this.overlay_.getSource();n.clear(!0),n.addFeatures(e)}updateState_(){const e=this.getMap(),n=this.getActive();(!e||!n)&&this.abortDrawing(),this.overlay_.setMap(n?e:null)}}function getDefaultStyleFunction$2(){const _t=createEditingStyle();return function(e,n){return _t[e.getGeometry().getType()]}}function getMode(_t){switch(_t){case"Point":case"MultiPoint":return"Point";case"LineString":case"MultiLineString":return"LineString";case"Polygon":case"MultiPolygon":return"Polygon";case"Circle":return"Circle";default:throw new Error("Invalid type: "+_t)}}const Key={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class KeyboardPan extends Interaction{constructor(e){super(),e=e||{},this.defaultCondition_=function(n){return noModifierKeys(n)&&targetNotEditable(n)},this.condition_=e.condition!==void 0?e.condition:this.defaultCondition_,this.duration_=e.duration!==void 0?e.duration:100,this.pixelDelta_=e.pixelDelta!==void 0?e.pixelDelta:128}handleEvent(e){let n=!1;if(e.type==EventType.KEYDOWN){const ei=e.originalEvent,ti=ei.key;if(this.condition_(e)&&(ti==Key.DOWN||ti==Key.LEFT||ti==Key.RIGHT||ti==Key.UP)){const ri=e.map.getView(),ni=ri.getResolution()*this.pixelDelta_;let si=0,ai=0;ti==Key.DOWN?ai=-ni:ti==Key.LEFT?si=-ni:ti==Key.RIGHT?si=ni:ai=ni;const oi=[si,ai];rotate$1(oi,ri.getRotation()),pan(ri,oi,this.duration_),ei.preventDefault(),n=!0}}return!n}}class KeyboardZoom extends Interaction{constructor(e){super(),e=e||{},this.condition_=e.condition?e.condition:function(n){return!platformModifierKey(n)&&targetNotEditable(n)},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:100}handleEvent(e){let n=!1;if(e.type==EventType.KEYDOWN||e.type==EventType.KEYPRESS){const ei=e.originalEvent,ti=ei.key;if(this.condition_(e)&&(ti==="+"||ti==="-")){const ii=e.map,ri=ti==="+"?this.delta_:-this.delta_,ni=ii.getView();zoomByDelta(ni,ri,void 0,this.duration_),ei.preventDefault(),n=!0}}return!n}}const CIRCLE_CENTER_INDEX=0,CIRCLE_CIRCUMFERENCE_INDEX=1,tempExtent=[0,0,0,0],tempSegment=[],ModifyEventType={MODIFYSTART:"modifystart",MODIFYEND:"modifyend"};function getCoordinatesArray(_t,e,n){let ei;switch(e){case"LineString":ei=_t;break;case"MultiLineString":case"Polygon":ei=_t[n[0]];break;case"MultiPolygon":ei=_t[n[1]][n[0]];break}return ei}class ModifyEvent extends BaseEvent{constructor(e,n,ei){super(e),this.features=n,this.mapBrowserEvent=ei}}class Modify extends PointerInteraction{constructor(e){super(e),this.on,this.once,this.un,this.boundHandleFeatureChange_=this.handleFeatureChange_.bind(this),this.condition_=e.condition?e.condition:primaryAction,this.defaultDeleteCondition_=function(ei){return altKeyOnly(ei)&&singleClick(ei)},this.deleteCondition_=e.deleteCondition?e.deleteCondition:this.defaultDeleteCondition_,this.insertVertexCondition_=e.insertVertexCondition?e.insertVertexCondition:always$1,this.vertexFeature_=null,this.vertexSegments_=null,this.lastCoordinate_=[0,0],this.ignoreNextSingleClick_=!1,this.featuresBeingModified_=null,this.rBush_=new RBush,this.pixelTolerance_=e.pixelTolerance!==void 0?e.pixelTolerance:10,this.snappedToVertex_=!1,this.changingFeature_=!1,this.dragSegments_=[],this.overlay_=new VectorLayer({source:new VectorSource({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.style?e.style:getDefaultStyleFunction$1(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.SEGMENT_WRITERS_={Point:this.writePointGeometry_.bind(this),LineString:this.writeLineStringGeometry_.bind(this),LinearRing:this.writeLineStringGeometry_.bind(this),Polygon:this.writePolygonGeometry_.bind(this),MultiPoint:this.writeMultiPointGeometry_.bind(this),MultiLineString:this.writeMultiLineStringGeometry_.bind(this),MultiPolygon:this.writeMultiPolygonGeometry_.bind(this),Circle:this.writeCircleGeometry_.bind(this),GeometryCollection:this.writeGeometryCollectionGeometry_.bind(this)},this.source_=null,this.traceSource_=e.traceSource||e.source||null,this.traceCondition_,this.setTrace(e.trace||!1),this.traceState_={active:!1},this.traceSegments_=null,this.hitDetection_=null;let n;if(e.features?n=e.features:e.source&&(this.source_=e.source,n=new Collection(this.source_.getFeatures()),this.source_.addEventListener(VectorEventType.ADDFEATURE,this.handleSourceAdd_.bind(this)),this.source_.addEventListener(VectorEventType.REMOVEFEATURE,this.handleSourceRemove_.bind(this))),!n)throw new Error("The modify interaction requires features, a source or a layer");e.hitDetection&&(this.hitDetection_=e.hitDetection),this.features_=n,this.features_.forEach(this.addFeature_.bind(this)),this.features_.addEventListener(CollectionEventType.ADD,this.handleFeatureAdd_.bind(this)),this.features_.addEventListener(CollectionEventType.REMOVE,this.handleFeatureRemove_.bind(this)),this.lastPointerEvent_=null,this.delta_=[0,0],this.snapToPointer_=e.snapToPointer===void 0?!this.hitDetection_:e.snapToPointer}setTrace(e){let n;e?e===!0?n=always$1:n=e:n=never,this.traceCondition_=n}addFeature_(e){const n=e.getGeometry();if(n){const ti=this.SEGMENT_WRITERS_[n.getType()];ti&&ti(e,n)}const ei=this.getMap();ei&&ei.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastCoordinate_),e.addEventListener(EventType.CHANGE,this.boundHandleFeatureChange_)}willModifyFeatures_(e,n){if(!this.featuresBeingModified_){this.featuresBeingModified_=new Collection;const ei=this.featuresBeingModified_.getArray();for(let ti=0,ii=n.length;ti<ii;++ti){const ri=n[ti].feature;ri&&!ei.includes(ri)&&this.featuresBeingModified_.push(ri)}this.featuresBeingModified_.getLength()===0?this.featuresBeingModified_=null:this.dispatchEvent(new ModifyEvent(ModifyEventType.MODIFYSTART,this.featuresBeingModified_,e))}}removeFeature_(e){this.removeFeatureSegmentData_(e),this.vertexFeature_&&this.features_.getLength()===0&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.removeEventListener(EventType.CHANGE,this.boundHandleFeatureChange_)}removeFeatureSegmentData_(e){const n=this.rBush_,ei=[];n.forEach(function(ti){e===ti.feature&&ei.push(ti)});for(let ti=ei.length-1;ti>=0;--ti){const ii=ei[ti];for(let ri=this.dragSegments_.length-1;ri>=0;--ri)this.dragSegments_[ri][0]===ii&&this.dragSegments_.splice(ri,1);n.remove(ii)}}setActive(e){this.vertexFeature_&&!e&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),super.setActive(e)}setMap(e){this.overlay_.setMap(e),super.setMap(e)}getOverlay(){return this.overlay_}handleSourceAdd_(e){e.feature&&this.features_.push(e.feature)}handleSourceRemove_(e){e.feature&&this.features_.remove(e.feature)}handleFeatureAdd_(e){this.addFeature_(e.element)}handleFeatureChange_(e){if(!this.changingFeature_){const n=e.target;this.removeFeature_(n),this.addFeature_(n)}}handleFeatureRemove_(e){this.removeFeature_(e.element)}writePointGeometry_(e,n){const ei=n.getCoordinates(),ti={feature:e,geometry:n,segment:[ei,ei]};this.rBush_.insert(n.getExtent(),ti)}writeMultiPointGeometry_(e,n){const ei=n.getCoordinates();for(let ti=0,ii=ei.length;ti<ii;++ti){const ri=ei[ti],ni={feature:e,geometry:n,depth:[ti],index:ti,segment:[ri,ri]};this.rBush_.insert(n.getExtent(),ni)}}writeLineStringGeometry_(e,n){const ei=n.getCoordinates();for(let ti=0,ii=ei.length-1;ti<ii;++ti){const ri=ei.slice(ti,ti+2),ni={feature:e,geometry:n,index:ti,segment:ri};this.rBush_.insert(boundingExtent(ri),ni)}}writeMultiLineStringGeometry_(e,n){const ei=n.getCoordinates();for(let ti=0,ii=ei.length;ti<ii;++ti){const ri=ei[ti];for(let ni=0,si=ri.length-1;ni<si;++ni){const ai=ri.slice(ni,ni+2),oi={feature:e,geometry:n,depth:[ti],index:ni,segment:ai};this.rBush_.insert(boundingExtent(ai),oi)}}}writePolygonGeometry_(e,n){const ei=n.getCoordinates();for(let ti=0,ii=ei.length;ti<ii;++ti){const ri=ei[ti];for(let ni=0,si=ri.length-1;ni<si;++ni){const ai=ri.slice(ni,ni+2),oi={feature:e,geometry:n,depth:[ti],index:ni,segment:ai};this.rBush_.insert(boundingExtent(ai),oi)}}}writeMultiPolygonGeometry_(e,n){const ei=n.getCoordinates();for(let ti=0,ii=ei.length;ti<ii;++ti){const ri=ei[ti];for(let ni=0,si=ri.length;ni<si;++ni){const ai=ri[ni];for(let oi=0,li=ai.length-1;oi<li;++oi){const ci=ai.slice(oi,oi+2),ui={feature:e,geometry:n,depth:[ni,ti],index:oi,segment:ci};this.rBush_.insert(boundingExtent(ci),ui)}}}}writeCircleGeometry_(e,n){const ei=n.getCenter(),ti={feature:e,geometry:n,index:CIRCLE_CENTER_INDEX,segment:[ei,ei]},ii={feature:e,geometry:n,index:CIRCLE_CIRCUMFERENCE_INDEX,segment:[ei,ei]},ri=[ti,ii];ti.featureSegments=ri,ii.featureSegments=ri,this.rBush_.insert(createOrUpdateFromCoordinate(ei),ti);let ni=n;this.rBush_.insert(ni.getExtent(),ii)}writeGeometryCollectionGeometry_(e,n){const ei=n.getGeometriesArray();for(let ti=0;ti<ei.length;++ti){const ii=ei[ti],ri=this.SEGMENT_WRITERS_[ii.getType()];ri(e,ii)}}createOrUpdateVertexFeature_(e,n,ei,ti){let ii=this.vertexFeature_;return ii?ii.getGeometry().setCoordinates(e):(ii=new Feature(new Point$1(e)),this.vertexFeature_=ii,this.overlay_.getSource().addFeature(ii)),ii.set("features",n),ii.set("geometries",ei),ii.set("existing",ti),ii}handleEvent(e){if(!e.originalEvent)return!0;this.lastPointerEvent_=e;let n;return!e.map.getView().getInteracting()&&e.type==MapBrowserEventType.POINTERMOVE&&!this.handlingDownUpSequence&&this.handlePointerMove_(e),this.vertexFeature_&&this.deleteCondition_(e)&&(e.type!=MapBrowserEventType.SINGLECLICK||!this.ignoreNextSingleClick_?n=this.removePoint():n=!0),e.type==MapBrowserEventType.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),super.handleEvent(e)&&!n}findInsertVerticesAndUpdateDragSegments_(e){if(this.handlePointerAtPixel_(e),this.dragSegments_.length=0,this.featuresBeingModified_=null,!this.vertexFeature_)return;this.getMap().getView().getProjection();const ei=[],ti=this.vertexFeature_.getGeometry().getCoordinates(),ii=boundingExtent([ti]),ri=this.rBush_.getInExtent(ii),ni={};ri.sort(compareIndexes);for(let si=0,ai=ri.length;si<ai;++si){const oi=ri[si],li=oi.segment;let ci=getUid(oi.geometry);const ui=oi.depth;if(ui&&(ci+="-"+ui.join("-")),ni[ci]||(ni[ci]=new Array(2)),oi.geometry.getType()==="Circle"&&oi.index===CIRCLE_CIRCUMFERENCE_INDEX){const di=closestOnSegmentData(e,oi);equals$2(di,ti)&&!ni[ci][0]&&(this.dragSegments_.push([oi,0]),ni[ci][0]=oi);continue}if(equals$2(li[0],ti)&&!ni[ci][0]){this.dragSegments_.push([oi,0]),ni[ci][0]=oi;continue}if(equals$2(li[1],ti)&&!ni[ci][1]){if(ni[ci][0]&&ni[ci][0].index===0){let di=oi.geometry.getCoordinates();switch(oi.geometry.getType()){case"LineString":case"MultiLineString":continue;case"MultiPolygon":di=di[ui[1]];case"Polygon":if(oi.index!==di[ui[0]].length-2)continue;break}}this.dragSegments_.push([oi,1]),ni[ci][1]=oi;continue}getUid(li)in this.vertexSegments_&&!ni[ci][0]&&!ni[ci][1]&&ei.push(oi)}return ei}deactivateTrace_(){this.traceState_={active:!1}}updateTrace_(e){const n=this.traceState_;if(!n.active)return;if(n.targetIndex===-1){const ii=e.map.getPixelFromCoordinate(n.startCoord);if(distance(ii,e.pixel)<this.pixelTolerance_)return}const ei=getTraceTargetUpdate(e.coordinate,n,e.map,this.pixelTolerance_);if(n.targetIndex===-1&&Math.sqrt(ei.closestTargetDistance)/e.map.getView().getResolution()>this.pixelTolerance_)return;if(n.targetIndex!==ei.index){if(n.targetIndex!==-1){const ri=n.targets[n.targetIndex];this.removeTracedCoordinates_(ri.startIndex,ri.endIndex)}else for(const ri of this.traceSegments_){const ni=ri[0],si=ni.geometry,ai=ri[1],oi=si.getCoordinates();getCoordinatesArray(oi,si.getType(),ni.depth).splice(ni.index+ai,1),si.setCoordinates(oi),ai===0&&(ni.index-=1)}const ii=n.targets[ei.index];this.addTracedCoordinates_(ii,ii.startIndex,ei.endIndex)}else{const ii=n.targets[n.targetIndex];this.addOrRemoveTracedCoordinates_(ii,ei.endIndex)}n.targetIndex=ei.index;const ti=n.targets[n.targetIndex];ti.endIndex=ei.endIndex}getTraceCandidates_(e){const n=this.getMap(),ei=this.pixelTolerance_,ti=n.getCoordinateFromPixel([e.pixel[0]-ei,e.pixel[1]+ei]),ii=n.getCoordinateFromPixel([e.pixel[0]+ei,e.pixel[1]-ei]),ri=boundingExtent([ti,ii]);return this.traceSource_.getFeaturesInExtent(ri)}toggleTraceState_(e){if(!this.traceSource_||!this.traceCondition_(e))return;if(this.traceState_.active){this.deactivateTrace_(),this.traceSegments_=null;return}const n=this.getTraceCandidates_(e);if(n.length===0)return;const ei=getTraceTargets(e.coordinate,n);ei.length&&(this.traceState_={active:!0,startCoord:e.coordinate.slice(),targets:ei,targetIndex:-1})}addOrRemoveTracedCoordinates_(e,n){const ei=e.startIndex<=e.endIndex,ti=e.startIndex<=n;ei===ti?ei&&n>e.endIndex||!ei&&n<e.endIndex?this.addTracedCoordinates_(e,e.endIndex,n):(ei&&n<e.endIndex||!ei&&n>e.endIndex)&&this.removeTracedCoordinates_(n,e.endIndex):(this.removeTracedCoordinates_(e.startIndex,e.endIndex),this.addTracedCoordinates_(e,e.startIndex,n))}removeTracedCoordinates_(e,n){if(e===n)return;let ei=0;if(e<n){const ti=Math.ceil(e);let ii=Math.floor(n);ii===n&&(ii-=1),ei=ii-ti+1}else{const ti=Math.floor(e);let ii=Math.ceil(n);ii===n&&(ii+=1),ei=ti-ii+1}if(ei>0)for(const ti of this.traceSegments_){const ii=ti[0],ri=ii.geometry,ni=ti[1];let si=ti[0].index+1;ni===1&&(si-=ei);const ai=ri.getCoordinates();getCoordinatesArray(ai,ri.getType(),ii.depth).splice(si,ei),ri.setCoordinates(ai),ni===1&&(ii.index-=ei)}}addTracedCoordinates_(e,n,ei){if(n===ei)return;const ti=[];if(n<ei){const ii=Math.ceil(n);let ri=Math.floor(ei);ri===ei&&(ri-=1);for(let ni=ii;ni<=ri;++ni)ti.push(getCoordinate(e.coordinates,ni))}else{const ii=Math.floor(n);let ri=Math.ceil(ei);ri===ei&&(ri+=1);for(let ni=ii;ni>=ri;--ni)ti.push(getCoordinate(e.coordinates,ni))}if(ti.length)for(const ii of this.traceSegments_){const ri=ii[0],ni=ri.geometry,si=ii[1],ai=ri.index+1;si===0&&ti.reverse();const oi=ni.getCoordinates();getCoordinatesArray(oi,ni.getType(),ri.depth).splice(ai,0,...ti),ni.setCoordinates(oi),si===1&&(ri.index+=ti.length)}}updateGeometry_(e,n){const ei=n[0],ti=ei.depth;let ii;const ri=ei.segment,ni=ei.geometry,si=n[1];for(;e.length<ni.getStride();)e.push(ri[si][e.length]);switch(ni.getType()){case"Point":ii=e,ri[0]=e,ri[1]=e;break;case"MultiPoint":ii=ni.getCoordinates(),ii[ei.index]=e,ri[0]=e,ri[1]=e;break;case"LineString":ii=ni.getCoordinates(),ii[ei.index+si]=e,ri[si]=e;break;case"MultiLineString":ii=ni.getCoordinates(),ii[ti[0]][ei.index+si]=e,ri[si]=e;break;case"Polygon":ii=ni.getCoordinates(),ii[ti[0]][ei.index+si]=e,ri[si]=e;break;case"MultiPolygon":ii=ni.getCoordinates(),ii[ti[1]][ti[0]][ei.index+si]=e,ri[si]=e;break;case"Circle":const ai=ni;if(ri[0]=e,ri[1]=e,ei.index===CIRCLE_CENTER_INDEX)this.changingFeature_=!0,ai.setCenter(e),this.changingFeature_=!1;else{this.changingFeature_=!0,this.getMap().getView().getProjection();let oi=distance(fromUserCoordinate(ai.getCenter()),fromUserCoordinate(e));ai.setRadius(oi),this.changingFeature_=!1}break}ii&&this.setGeometryCoordinates_(ni,ii)}handleDragEvent(e){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(e,this.dragSegments_.map(([ri])=>ri));const n=[e.coordinate[0]+this.delta_[0],e.coordinate[1]+this.delta_[1]],ei=[],ti=[],ii=this.traceState_.active&&!this.traceSegments_?this.traceState_.startCoord:null;if(ii){this.traceSegments_=[];for(const ri of this.dragSegments_){const ni=ri[0];distance(closestOnSegment(ii,ni.segment),ii)/e.map.getView().getResolution()<1&&this.traceSegments_.push(ri)}}for(let ri=0,ni=this.dragSegments_.length;ri<ni;++ri){const si=this.dragSegments_[ri],ai=si[0],oi=ai.feature;ei.includes(oi)||ei.push(oi);const li=ai.geometry;ti.includes(li)||ti.push(li),this.updateGeometry_(n,si)}this.updateTrace_(e),this.createOrUpdateVertexFeature_(n,ei,ti,!0)}handleDownEvent(e){if(!this.condition_(e))return!1;const n=e.coordinate,ei=this.findInsertVerticesAndUpdateDragSegments_(n);if(ei!=null&&ei.length&&this.insertVertexCondition_(e)&&(this.willModifyFeatures_(e,ei),this.vertexFeature_)){const ti=this.vertexFeature_.getGeometry().getCoordinates();for(let ii=ei.length-1;ii>=0;--ii)this.insertVertex_(ei[ii],ti);this.ignoreNextSingleClick_=!0}return!!this.vertexFeature_}handleUpEvent(e){for(let n=this.dragSegments_.length-1;n>=0;--n){const ei=this.dragSegments_[n][0],ti=ei.geometry;if(ti.getType()==="Circle"){const ii=ti,ri=ii.getCenter(),ni=ei.featureSegments[0],si=ei.featureSegments[1];ni.segment[0]=ri,ni.segment[1]=ri,si.segment[0]=ri,si.segment[1]=ri,this.rBush_.update(createOrUpdateFromCoordinate(ri),ni);let ai=ii;this.rBush_.update(ai.getExtent(),si)}else this.rBush_.update(boundingExtent(ei.segment),ei)}return this.featuresBeingModified_&&(this.toggleTraceState_(e),this.dispatchEvent(new ModifyEvent(ModifyEventType.MODIFYEND,this.featuresBeingModified_,e)),this.featuresBeingModified_=null),!1}handlePointerMove_(e){this.lastCoordinate_=e.coordinate,this.handlePointerAtPixel_(this.lastCoordinate_)}handlePointerAtPixel_(e){const n=this.getMap(),ei=n.getPixelFromCoordinate(e);n.getView().getProjection();const ti=function(ni,si){return projectedDistanceToSegmentDataSquared(e,ni)-projectedDistanceToSegmentDataSquared(e,si)};let ii,ri;if(this.hitDetection_){const ni=typeof this.hitDetection_=="object"?si=>si===this.hitDetection_:void 0;n.forEachFeatureAtPixel(ei,(si,ai,oi)=>{oi&&oi.getType()==="Point"&&(oi=new Point$1(toUserCoordinate(oi.getCoordinates())));const li=oi||si.getGeometry();if(li&&li.getType()==="Point"&&si instanceof Feature&&this.features_.getArray().includes(si)){ri=li;const ci=si.getGeometry().getFlatCoordinates().slice(0,2);ii=[{feature:si,geometry:ri,segment:[ci,ci]}]}return!0},{layerFilter:ni})}if(!ii){const ni=fromUserExtent(createOrUpdateFromCoordinate(e,tempExtent)),si=n.getView().getResolution()*this.pixelTolerance_,ai=toUserExtent(buffer(ni,si,tempExtent));ii=this.rBush_.getInExtent(ai)}if(ii&&ii.length>0){const ni=ii.sort(ti)[0],si=ni.segment;let ai=closestOnSegmentData(e,ni);const oi=n.getPixelFromCoordinate(ai);let li=distance(ei,oi);if(ri||li<=this.pixelTolerance_){const ci={};if(ci[getUid(si)]=!0,this.snapToPointer_||(this.delta_[0]=ai[0]-e[0],this.delta_[1]=ai[1]-e[1]),ni.geometry.getType()==="Circle"&&ni.index===CIRCLE_CIRCUMFERENCE_INDEX)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(ai,[ni.feature],[ni.geometry],this.snappedToVertex_);else{const ui=n.getPixelFromCoordinate(si[0]),di=n.getPixelFromCoordinate(si[1]),fi=squaredDistance$1(oi,ui),hi=squaredDistance$1(oi,di);if(li=Math.sqrt(Math.min(fi,hi)),this.snappedToVertex_=li<=this.pixelTolerance_,!this.snappedToVertex_&&!this.insertVertexCondition_(this.lastPointerEvent_)){this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null);return}this.snappedToVertex_&&(ai=fi>hi?si[1]:si[0]),this.createOrUpdateVertexFeature_(ai,[ni.feature],[ni.geometry],this.snappedToVertex_);const pi={};pi[getUid(ni.geometry)]=!0;for(let gi=1,vi=ii.length;gi<vi;++gi){const yi=ii[gi].segment;if(equals$2(si[0],yi[0])&&equals$2(si[1],yi[1])||equals$2(si[0],yi[1])&&equals$2(si[1],yi[0])){const _i=getUid(ii[gi].geometry);_i in pi||(pi[_i]=!0,ci[getUid(yi)]=!0)}else break}}this.vertexSegments_=ci;return}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)}insertVertex_(e,n){const ei=e.segment,ti=e.feature,ii=e.geometry,ri=e.depth,ni=e.index;let si;for(;n.length<ii.getStride();)n.push(0);switch(ii.getType()){case"MultiLineString":si=ii.getCoordinates(),si[ri[0]].splice(ni+1,0,n);break;case"Polygon":si=ii.getCoordinates(),si[ri[0]].splice(ni+1,0,n);break;case"MultiPolygon":si=ii.getCoordinates(),si[ri[1]][ri[0]].splice(ni+1,0,n);break;case"LineString":si=ii.getCoordinates(),si.splice(ni+1,0,n);break;default:return!1}this.setGeometryCoordinates_(ii,si);const ai=this.rBush_;ai.remove(e),this.updateSegmentIndices_(ii,ni,ri,1);const oi={segment:[ei[0],n],feature:ti,geometry:ii,depth:ri,index:ni};ai.insert(boundingExtent(oi.segment),oi),this.dragSegments_.push([oi,1]);const li={segment:[n,ei[1]],feature:ti,geometry:ii,depth:ri,index:ni+1};return ai.insert(boundingExtent(li.segment),li),this.dragSegments_.push([li,0]),!0}updatePointer_(e){var n;return e&&this.findInsertVerticesAndUpdateDragSegments_(e),(n=this.vertexFeature_)==null?void 0:n.getGeometry().getCoordinates()}getPoint(){var n;const e=(n=this.vertexFeature_)==null?void 0:n.getGeometry().getCoordinates();return e?toUserCoordinate(e,this.getMap().getView().getProjection()):null}canRemovePoint(){if(!this.vertexFeature_||this.vertexFeature_.get("geometries").every(ei=>ei.getType()==="Circle"||ei.getType().endsWith("Point")))return!1;const e=this.vertexFeature_.getGeometry().getCoordinates();return this.rBush_.getInExtent(boundingExtent([e])).some(({segment:ei})=>equals$2(ei[0],e)||equals$2(ei[1],e))}removePoint(e){if(e&&(e=fromUserCoordinate(e,this.getMap().getView().getProjection()),this.updatePointer_(e)),!this.lastPointerEvent_||this.lastPointerEvent_&&this.lastPointerEvent_.type!=MapBrowserEventType.POINTERDRAG){const n=this.lastPointerEvent_;this.willModifyFeatures_(n,this.dragSegments_.map(([ti])=>ti));const ei=this.removeVertex_();return this.featuresBeingModified_&&this.dispatchEvent(new ModifyEvent(ModifyEventType.MODIFYEND,this.featuresBeingModified_,n)),this.featuresBeingModified_=null,ei}return!1}removeVertex_(){const e=this.dragSegments_,n={};let ei=!1,ti,ii,ri,ni,si,ai,oi,li,ci,ui,di;for(si=e.length-1;si>=0;--si)ri=e[si],ui=ri[0],di=getUid(ui.feature),ui.depth&&(di+="-"+ui.depth.join("-")),di in n||(n[di]={}),ri[1]===0?(n[di].right=ui,n[di].index=ui.index):ri[1]==1&&(n[di].left=ui,n[di].index=ui.index+1);for(di in n){switch(ci=n[di].right,oi=n[di].left,ai=n[di].index,li=ai-1,oi!==void 0?ui=oi:ui=ci,li<0&&(li=0),ni=ui.geometry,ii=ni.getCoordinates(),ti=ii,ei=!1,ni.getType()){case"MultiLineString":ii[ui.depth[0]].length>2&&(ii[ui.depth[0]].splice(ai,1),ei=!0);break;case"LineString":ii.length>2&&(ii.splice(ai,1),ei=!0);break;case"MultiPolygon":ti=ti[ui.depth[1]];case"Polygon":ti=ti[ui.depth[0]],ti.length>4&&(ai==ti.length-1&&(ai=0),ti.splice(ai,1),ei=!0,ai===0&&(ti.pop(),ti.push(ti[0]),li=ti.length-1));break}if(ei){this.setGeometryCoordinates_(ni,ii);const fi=[];if(oi!==void 0&&(this.rBush_.remove(oi),fi.push(oi.segment[0])),ci!==void 0&&(this.rBush_.remove(ci),fi.push(ci.segment[1])),oi!==void 0&&ci!==void 0){const hi={depth:ui.depth,feature:ui.feature,geometry:ui.geometry,index:li,segment:fi};this.rBush_.insert(boundingExtent(hi.segment),hi)}this.updateSegmentIndices_(ni,ai,ui.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.length=0}}return ei}canInsertPoint(){if(!this.vertexFeature_||this.vertexFeature_.get("geometries").every(ei=>ei.getType()==="Circle"||ei.getType().endsWith("Point")))return!1;const e=this.vertexFeature_.getGeometry().getCoordinates();return this.rBush_.getInExtent(boundingExtent([e])).some(({segment:ei})=>!(equals$2(ei[0],e)||equals$2(ei[1],e)))}insertPoint(e){var ti;const n=e?fromUserCoordinate(e,this.getMap().getView().getProjection()):(ti=this.vertexFeature_)==null?void 0:ti.getGeometry().getCoordinates();return n?this.findInsertVerticesAndUpdateDragSegments_(n).reduce((ii,ri)=>ii||this.insertVertex_(ri,n),!1):!1}setGeometryCoordinates_(e,n){this.changingFeature_=!0,e.setCoordinates(n),this.changingFeature_=!1}updateSegmentIndices_(e,n,ei,ti){this.rBush_.forEachInExtent(e.getExtent(),function(ii){ii.geometry===e&&(ei===void 0||ii.depth===void 0||equals(ii.depth,ei))&&ii.index>n&&(ii.index+=ti)})}}function compareIndexes(_t,e){return _t.index-e.index}function projectedDistanceToSegmentDataSquared(_t,e,n){const ei=e.geometry;if(ei.getType()==="Circle"){let ii=ei;if(e.index===CIRCLE_CIRCUMFERENCE_INDEX){const ri=squaredDistance$1(ii.getCenter(),fromUserCoordinate(_t)),ni=Math.sqrt(ri)-ii.getRadius();return ni*ni}}const ti=fromUserCoordinate(_t);return tempSegment[0]=fromUserCoordinate(e.segment[0]),tempSegment[1]=fromUserCoordinate(e.segment[1]),squaredDistanceToSegment(ti,tempSegment)}function closestOnSegmentData(_t,e,n){const ei=e.geometry;if(ei.getType()==="Circle"&&e.index===CIRCLE_CIRCUMFERENCE_INDEX)return toUserCoordinate(ei.getClosestPoint(fromUserCoordinate(_t)));const ti=fromUserCoordinate(_t);return tempSegment[0]=fromUserCoordinate(e.segment[0]),tempSegment[1]=fromUserCoordinate(e.segment[1]),toUserCoordinate(closestOnSegment(ti,tempSegment))}function getDefaultStyleFunction$1(){const _t=createEditingStyle();return function(e,n){return _t.Point}}const DELTA_LINE_MULTIPLIER=40,DELTA_PAGE_MULTIPLIER=300;class MouseWheelZoom extends Interaction{constructor(e){e=e||{},super(e),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=e.maxDelta!==void 0?e.maxDelta:1,this.duration_=e.duration!==void 0?e.duration:250,this.timeout_=e.timeout!==void 0?e.timeout:80,this.useAnchor_=e.useAnchor!==void 0?e.useAnchor:!0,this.constrainResolution_=e.constrainResolution!==void 0?e.constrainResolution:!1;const n=e.condition?e.condition:always$1;this.condition_=e.onFocusOnly?all(focusWithTabindex,n):n,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const e=this.getMap();if(!e)return;e.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(e){if(!this.condition_(e)||e.type!==EventType.WHEEL)return!0;const ei=e.map,ti=e.originalEvent;ti.preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.pixel);let ii=ti.deltaY;switch(ti.deltaMode){case WheelEvent.DOM_DELTA_LINE:ii*=DELTA_LINE_MULTIPLIER;break;case WheelEvent.DOM_DELTA_PAGE:ii*=DELTA_PAGE_MULTIPLIER;break}if(ii===0)return!1;this.lastDelta_=ii;const ri=Date.now();this.startTime_===void 0&&(this.startTime_=ri),(!this.mode_||ri-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(ii)<4?"trackpad":"wheel");const ni=ei.getView();if(this.mode_==="trackpad"&&!(ni.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(ni.getAnimating()&&ni.cancelAnimations(),ni.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),ni.adjustZoom(-ii/this.deltaPerZoom_,this.lastAnchor_?ei.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=ri,!1;this.totalDelta_+=ii;const si=Math.max(this.timeout_-(ri-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,ei),si),!1}handleWheelZoom_(e){const n=e.getView();n.getAnimating()&&n.cancelAnimations();let ei=-clamp$1(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(n.getConstrainResolution()||this.constrainResolution_)&&(ei=ei?ei>0?1:-1:0),zoomByDelta(n,ei,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(e){this.useAnchor_=e,e||(this.lastAnchor_=null)}}class PinchRotate extends PointerInteraction{constructor(e){e=e||{};const n=e;n.stopDown||(n.stopDown=FALSE),super(n),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=e.threshold!==void 0?e.threshold:.3,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){let n=0;const ei=this.targetPointers[0],ti=this.targetPointers[1],ii=Math.atan2(ti.clientY-ei.clientY,ti.clientX-ei.clientX);if(this.lastAngle_!==void 0){const si=ii-this.lastAngle_;this.rotationDelta_+=si,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),n=si}this.lastAngle_=ii;const ri=e.map,ni=ri.getView();ni.getConstraints().rotation!==disable&&(this.anchor_=ri.getCoordinateFromPixelInternal(ri.getEventPixel(centroid(this.targetPointers))),this.rotating_&&(ri.render(),ni.adjustRotationInternal(n,this.anchor_)))}handleUpEvent(e){return this.targetPointers.length<2?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){if(this.targetPointers.length>=2){const n=e.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||n.getView().beginInteraction(),!0}return!1}}class PinchZoom extends PointerInteraction{constructor(e){e=e||{};const n=e;n.stopDown||(n.stopDown=FALSE),super(n),this.anchor_=null,this.duration_=e.duration!==void 0?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(e){let n=1;const ei=this.targetPointers[0],ti=this.targetPointers[1],ii=ei.clientX-ti.clientX,ri=ei.clientY-ti.clientY,ni=Math.sqrt(ii*ii+ri*ri);this.lastDistance_!==void 0&&(n=this.lastDistance_/ni),this.lastDistance_=ni;const si=e.map,ai=si.getView();n!=1&&(this.lastScaleDelta_=n),this.anchor_=si.getCoordinateFromPixelInternal(si.getEventPixel(centroid(this.targetPointers))),si.render(),ai.adjustResolutionInternal(n,this.anchor_)}handleUpEvent(e){if(this.targetPointers.length<2){const ei=e.map.getView(),ti=this.lastScaleDelta_>1?1:-1;return ei.endInteraction(this.duration_,ti),!1}return!0}handleDownEvent(e){if(this.targetPointers.length>=2){const n=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||n.getView().beginInteraction(),!0}return!1}}const SelectEventType={SELECT:"select"};class SelectEvent extends BaseEvent{constructor(e,n,ei,ti){super(e),this.selected=n,this.deselected=ei,this.mapBrowserEvent=ti}}const originalFeatureStyles={};class Select extends Interaction{constructor(e){super(),this.on,this.once,this.un,e=e||{},this.boundAddFeature_=this.addFeature_.bind(this),this.boundRemoveFeature_=this.removeFeature_.bind(this),this.condition_=e.condition?e.condition:singleClick,this.addCondition_=e.addCondition?e.addCondition:never,this.removeCondition_=e.removeCondition?e.removeCondition:never,this.toggleCondition_=e.toggleCondition?e.toggleCondition:shiftKeyOnly,this.multi_=e.multi?e.multi:!1,this.filter_=e.filter?e.filter:TRUE,this.hitTolerance_=e.hitTolerance?e.hitTolerance:0,this.style_=e.style!==void 0?e.style:getDefaultStyleFunction(),this.features_=e.features||new Collection;let n;if(e.layers)if(typeof e.layers=="function")n=e.layers;else{const ei=e.layers;n=function(ti){return ei.includes(ti)}}else n=TRUE;this.layerFilter_=n,this.featureLayerAssociation_={}}addFeatureLayerAssociation_(e,n){this.featureLayerAssociation_[getUid(e)]=n}getFeatures(){return this.features_}getHitTolerance(){return this.hitTolerance_}getLayer(e){return this.featureLayerAssociation_[getUid(e)]}setHitTolerance(e){this.hitTolerance_=e}setMap(e){this.getMap()&&this.style_&&this.features_.forEach(this.restorePreviousStyle_.bind(this)),super.setMap(e),e?(this.features_.addEventListener(CollectionEventType.ADD,this.boundAddFeature_),this.features_.addEventListener(CollectionEventType.REMOVE,this.boundRemoveFeature_),this.style_&&this.features_.forEach(this.applySelectedStyle_.bind(this))):(this.features_.removeEventListener(CollectionEventType.ADD,this.boundAddFeature_),this.features_.removeEventListener(CollectionEventType.REMOVE,this.boundRemoveFeature_))}addFeature_(e){const n=e.element;if(this.style_&&this.applySelectedStyle_(n),!this.getLayer(n)){const ei=this.findLayerOfFeature_(n);ei&&this.addFeatureLayerAssociation_(n,ei)}}removeFeature_(e){this.style_&&this.restorePreviousStyle_(e.element)}findLayerOfFeature_(e){return this.getMap().getAllLayers().find(function(ei){if(ei instanceof VectorLayer&&ei.getSource()&&ei.getSource().hasFeature(e))return ei})}getStyle(){return this.style_}applySelectedStyle_(e){const n=getUid(e);n in originalFeatureStyles||(originalFeatureStyles[n]=e.getStyle()),e.setStyle(this.style_)}restorePreviousStyle_(e){const n=this.getMap().getInteractions().getArray();for(let ti=n.length-1;ti>=0;--ti){const ii=n[ti];if(ii!==this&&ii instanceof Select&&ii.getStyle()&&ii.getFeatures().getArray().lastIndexOf(e)!==-1){e.setStyle(ii.getStyle());return}}const ei=getUid(e);e.setStyle(originalFeatureStyles[ei]),delete originalFeatureStyles[ei]}removeFeatureLayerAssociation_(e){delete this.featureLayerAssociation_[getUid(e)]}selectFeatureInternal_(e,n,ei){if(!(e instanceof Feature)||!this.filter_(e,n))return;const ti=this.getFeatures();return ti.getArray().includes(e)||(this.addFeatureLayerAssociation_(e,n),ti.push(e),ei==null||ei.push(e)),e}selectFeature(e){const n=this.findLayerOfFeature_(e);if(!this.layerFilter_(n))return!1;const ei=this.selectFeatureInternal_(e,n);return ei&&this.dispatchEvent(new SelectEvent(SelectEventType.SELECT,[ei],[],void 0)),!!ei}removeFeatureInternal_(e,n){const ei=this.getFeatures();if(!(!(e instanceof Feature)||!ei.getArray().includes(e)))return ei.remove(e),this.removeFeatureLayerAssociation_(e),n==null||n.push(e),e}deselectFeature(e){const n=this.removeFeatureInternal_(e);return n&&this.dispatchEvent(new SelectEvent(SelectEventType.SELECT,[],[n],void 0)),!!n}toggleFeature(e){this.deselectFeature(e)||this.selectFeature(e)}clearSelection(){clear$1(this.featureLayerAssociation_);const e=this.getFeatures(),n=e.getArray().slice();e.clear(),n.length!==0&&this.dispatchEvent(new SelectEvent(SelectEventType.SELECT,[],n,void 0))}handleEvent(e){if(!this.condition_(e))return!0;const n=this.addCondition_(e),ei=this.removeCondition_(e),ti=this.toggleCondition_(e),ii=!n&&!ei&&!ti,ri=e.map,ni=this.getFeatures(),si=[],ai=[];if(ii){let oi=!1;ri.forEachFeatureAtPixel(e.pixel,(li,ci)=>{if(oi=!0,!!this.selectFeatureInternal_(li,ci,ai))return!this.multi_},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let li=ni.getLength()-1;li>=0;--li){const ci=ni.item(li);(ai.length>0&&!ai.includes(ci)||!oi)&&this.removeFeatureInternal_(ci,si)}}else ri.forEachFeatureAtPixel(e.pixel,(oi,li)=>{let ci;if((ei||ti)&&(ci=this.removeFeatureInternal_(oi,si)),(n||ti)&&!ci&&(ci=this.selectFeatureInternal_(oi,li,ai)),!!ci)return!this.multi_},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});return(ai.length>0||si.length>0)&&this.dispatchEvent(new SelectEvent(SelectEventType.SELECT,ai,si,e)),!0}}function getDefaultStyleFunction(){const _t=createEditingStyle();return extend$3(_t.Polygon,_t.LineString),extend$3(_t.GeometryCollection,_t.LineString),function(e){return e.getGeometry()?_t[e.getGeometry().getType()]:null}}class Kinetic{constructor(e,n,ei){this.decay_=e,this.minVelocity_=n,this.delay_=ei,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(e,n){this.points_.push(e,n,Date.now())}end(){if(this.points_.length<6)return!1;const e=Date.now()-this.delay_,n=this.points_.length-3;if(this.points_[n+2]<e)return!1;let ei=n-3;for(;ei>0&&this.points_[ei+2]>e;)ei-=3;const ti=this.points_[n+2]-this.points_[ei+2];if(ti<1e3/60)return!1;const ii=this.points_[n]-this.points_[ei],ri=this.points_[n+1]-this.points_[ei+1];return this.angle_=Math.atan2(ri,ii),this.initialVelocity_=Math.sqrt(ii*ii+ri*ri)/ti,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}function defaults$3(_t){_t=_t||{};const e=new Collection,n=new Kinetic(-.005,.05,100);return(_t.altShiftDragRotate!==void 0?_t.altShiftDragRotate:!0)&&e.push(new DragRotate),(_t.doubleClickZoom!==void 0?_t.doubleClickZoom:!0)&&e.push(new DoubleClickZoom({delta:_t.zoomDelta,duration:_t.zoomDuration})),(_t.dragPan!==void 0?_t.dragPan:!0)&&e.push(new DragPan({onFocusOnly:_t.onFocusOnly,kinetic:n})),(_t.pinchRotate!==void 0?_t.pinchRotate:!0)&&e.push(new PinchRotate),(_t.pinchZoom!==void 0?_t.pinchZoom:!0)&&e.push(new PinchZoom({duration:_t.zoomDuration})),(_t.keyboard!==void 0?_t.keyboard:!0)&&(e.push(new KeyboardPan),e.push(new KeyboardZoom({delta:_t.zoomDelta,duration:_t.zoomDuration}))),(_t.mouseWheelZoom!==void 0?_t.mouseWheelZoom:!0)&&e.push(new MouseWheelZoom({onFocusOnly:_t.onFocusOnly,duration:_t.zoomDuration})),(_t.shiftDragZoom!==void 0?_t.shiftDragZoom:!0)&&e.push(new DragZoom({duration:_t.zoomDuration})),e}var loglevel$1={exports:{}},loglevel=loglevel$1.exports,hasRequiredLoglevel;function requireLoglevel(){return hasRequiredLoglevel||(hasRequiredLoglevel=1,(function(_t){(function(e,n){_t.exports?_t.exports=n():e.log=n()})(loglevel,function(){var e=function(){},n="undefined",ei=typeof window!==n&&typeof window.navigator!==n&&/Trident\/|MSIE /.test(window.navigator.userAgent),ti=["trace","debug","info","warn","error"],ii={},ri=null;function ni(fi,hi){var pi=fi[hi];if(typeof pi.bind=="function")return pi.bind(fi);try{return Function.prototype.bind.call(pi,fi)}catch{return function(){return Function.prototype.apply.apply(pi,[fi,arguments])}}}function si(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function ai(fi){return fi==="debug"&&(fi="log"),typeof console===n?!1:fi==="trace"&&ei?si:console[fi]!==void 0?ni(console,fi):console.log!==void 0?ni(console,"log"):e}function oi(){for(var fi=this.getLevel(),hi=0;hi<ti.length;hi++){var pi=ti[hi];this[pi]=hi<fi?e:this.methodFactory(pi,fi,this.name)}if(this.log=this.debug,typeof console===n&&fi<this.levels.SILENT)return"No console available for logging"}function li(fi){return function(){typeof console!==n&&(oi.call(this),this[fi].apply(this,arguments))}}function ci(fi,hi,pi){return ai(fi)||li.apply(this,arguments)}function ui(fi,hi){var pi=this,gi,vi,yi,_i="loglevel";typeof fi=="string"?_i+=":"+fi:typeof fi=="symbol"&&(_i=void 0);function Ai(Ii){var Li=(ti[Ii]||"silent").toUpperCase();if(!(typeof window===n||!_i)){try{window.localStorage[_i]=Li;return}catch{}try{window.document.cookie=encodeURIComponent(_i)+"="+Li+";"}catch{}}}function Ei(){var Ii;if(!(typeof window===n||!_i)){try{Ii=window.localStorage[_i]}catch{}if(typeof Ii===n)try{var Li=window.document.cookie,Di=encodeURIComponent(_i),Ni=Li.indexOf(Di+"=");Ni!==-1&&(Ii=/^([^;]+)/.exec(Li.slice(Ni+Di.length+1))[1])}catch{}return pi.levels[Ii]===void 0&&(Ii=void 0),Ii}}function Si(){if(!(typeof window===n||!_i)){try{window.localStorage.removeItem(_i)}catch{}try{window.document.cookie=encodeURIComponent(_i)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function wi(Ii){var Li=Ii;if(typeof Li=="string"&&pi.levels[Li.toUpperCase()]!==void 0&&(Li=pi.levels[Li.toUpperCase()]),typeof Li=="number"&&Li>=0&&Li<=pi.levels.SILENT)return Li;throw new TypeError("log.setLevel() called with invalid level: "+Ii)}pi.name=fi,pi.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},pi.methodFactory=hi||ci,pi.getLevel=function(){return yi??vi??gi},pi.setLevel=function(Ii,Li){return yi=wi(Ii),Li!==!1&&Ai(yi),oi.call(pi)},pi.setDefaultLevel=function(Ii){vi=wi(Ii),Ei()||pi.setLevel(Ii,!1)},pi.resetLevel=function(){yi=null,Si(),oi.call(pi)},pi.enableAll=function(Ii){pi.setLevel(pi.levels.TRACE,Ii)},pi.disableAll=function(Ii){pi.setLevel(pi.levels.SILENT,Ii)},pi.rebuild=function(){if(ri!==pi&&(gi=wi(ri.getLevel())),oi.call(pi),ri===pi)for(var Ii in ii)ii[Ii].rebuild()},gi=wi(ri?ri.getLevel():"WARN");var Oi=Ei();Oi!=null&&(yi=wi(Oi)),oi.call(pi)}ri=new ui,ri.getLogger=function(hi){if(typeof hi!="symbol"&&typeof hi!="string"||hi==="")throw new TypeError("You must supply a name when creating a logger.");var pi=ii[hi];return pi||(pi=ii[hi]=new ui(hi,ri.methodFactory)),pi};var di=typeof window!==n?window.log:void 0;return ri.noConflict=function(){return typeof window!==n&&window.log===ri&&(window.log=di),ri},ri.getLoggers=function(){return ii},ri.default=ri,ri})})(loglevel$1)),loglevel$1.exports}var loglevelExports=requireLoglevel(),LoggerByDefault$1={getLogger:function(_t){if(typeof e>"u"){var e={};e.env={VERBOSE:!1}}e.env.VERBOSE?loglevelExports.enableAll():loglevelExports.disableAll();var n=_t||"default";return loglevelExports.getLogger(n)}},MessagesResources={PARAM_MISSING:"Parameter(s) '%var%' missing",PARAM_EMPTY:"Parameter(s) '%var%' empty",PARAM_TYPE:"Wrong type(s) for parameter(s) '%var%'",PARAM_FORMAT:"Parameter(s) '%var%' not correctly formatted",PARAM_NOT_SUPPORT:"Value(s) for parameter(s) '%var%' not supported",PARAM_NOT_SUPPORT_NODEJS:"Value(s) for parameter(s) '%var%' not supported to NodeJS",PARAM_UNKNOWN:"Value(s) for parameter(s) '%var%' unknown",SERVICE_REQUEST_BUILD:"An error occurred during the request building of the service",SERVICE_REQUEST_EMPTY:"The request sent to the service is empty",SERVICE_RESPONSE_EXCEPTION:"The service returned an exception : '%var%'",SERVICE_RESPONSE_EXCEPTION_2:"The service returned an exception",SERVICE_RESPONSE_ANALYSE:"An error occurred while parsing the response '%var%' of the service",SERVICE_RESPONSE_ANALYSE_2:"An unknown error occurred while parsing the response",SERVICE_RESPONSE_EMPTY:"The response of the service is empty",SERVICE_RESPONSE_EMPTY_2:"The response from the service could not be analyzed or is empty",SERVICE_RESPONSE_FORMAT:"The format of the service response is not supported (handled format(s) : '%var%')",SERVICE_RESPONSE_FORMAT_2:"The format of the service response is not supported",SERVICE_RESPONSE_FORMAT_3:"No suggestion matching the search",CLASS_CONSTRUCTOR:"'%var%' constructor cannot be called as a function.",getMessage:function(_t,e){if(Object.keys(arguments).length===0)return"Message indefined !";var n=Array.prototype.slice.call(arguments),ei=n.shift(),ti=n,ii=this[ei];try{Array.isArray(ti)&&ti.length>0?ii=ii.replace("%var%",ti.join(" - ")):ii=ii.replace("%var%","%var% (not specified)")}catch{}return ii}},Helper$1={normalyzeParameters:function(_t){var e=null;if(_t){var n=[];for(var ei in _t)if(_t.hasOwnProperty(ei)){var ti=_t[ei];ti||(ti=""),n.push(ei+"="+ti)}e=n.join("&")}return e},normalyzeUrl:function(_t,e,n){var ei=_t;if(_t){if(_t.split("?").length-1>=2){var ti=_t.search(/\?/)+1;ei=_t.substring(0,ti)+_t.slice(ti).replace(/\?/g,"&")}var ii=_t.indexOf("?");ii===-1&&(ei+="?"),ii!==-1&&ii!==_t.length-1&&(ei+="&")}return e&&(typeof e=="string"?(e=e.replace("?",""),ei+=e):ei+=this.normalyzeParameters(e)),n&&(ei=encodeURIComponent(ei)),ei},indent:function(_t,e){var n=_t||0;return new Array(n+1).join("	")+e}};function commonjsRequire(_t){throw new Error('Could not dynamically require "'+_t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var es6Promise$1={exports:{}};/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */var es6Promise=es6Promise$1.exports,hasRequiredEs6Promise;function requireEs6Promise(){return hasRequiredEs6Promise||(hasRequiredEs6Promise=1,(function(_t,e){(function(n,ei){_t.exports=ei()})(es6Promise,(function(){function n(or){var yr=typeof or;return or!==null&&(yr==="object"||yr==="function")}function ei(or){return typeof or=="function"}var ti=void 0;Array.isArray?ti=Array.isArray:ti=function(or){return Object.prototype.toString.call(or)==="[object Array]"};var ii=ti,ri=0,ni=void 0,si=void 0,ai=function(yr,_r){Ai[ri]=yr,Ai[ri+1]=_r,ri+=2,ri===2&&(si?si(Ei):wi())};function oi(or){si=or}function li(or){ai=or}var ci=typeof window<"u"?window:void 0,ui=ci||{},di=ui.MutationObserver||ui.WebKitMutationObserver,fi=typeof self>"u"&&typeof process<"u"&&{}.toString.call(process)==="[object process]",hi=typeof Uint8ClampedArray<"u"&&typeof importScripts<"u"&&typeof MessageChannel<"u";function pi(){return function(){return process.nextTick(Ei)}}function gi(){return typeof ni<"u"?function(){ni(Ei)}:_i()}function vi(){var or=0,yr=new di(Ei),_r=document.createTextNode("");return yr.observe(_r,{characterData:!0}),function(){_r.data=or=++or%2}}function yi(){var or=new MessageChannel;return or.port1.onmessage=Ei,function(){return or.port2.postMessage(0)}}function _i(){var or=setTimeout;return function(){return or(Ei,1)}}var Ai=new Array(1e3);function Ei(){for(var or=0;or<ri;or+=2){var yr=Ai[or],_r=Ai[or+1];yr(_r),Ai[or]=void 0,Ai[or+1]=void 0}ri=0}function Si(){try{var or=Function("return this")().require("vertx");return ni=or.runOnLoop||or.runOnContext,gi()}catch{return _i()}}var wi=void 0;fi?wi=pi():di?wi=vi():hi?wi=yi():ci===void 0&&typeof commonjsRequire=="function"?wi=Si():wi=_i();function Oi(or,yr){var _r=this,Ar=new this.constructor(Di);Ar[Li]===void 0&&ar(Ar);var wr=_r._state;if(wr){var Rr=arguments[wr-1];ai(function(){return cr(wr,Ar,Rr,_r._result)})}else Yi(_r,Ar,or,yr);return Ar}function Ii(or){var yr=this;if(or&&typeof or=="object"&&or.constructor===yr)return or;var _r=new yr(Di);return ki(_r,or),_r}var Li=Math.random().toString(36).substring(2);function Di(){}var Ni=void 0,$i=1,Ki=2;function er(){return new TypeError("You cannot resolve a promise with itself")}function Vi(){return new TypeError("A promises callback cannot return that same promise.")}function nr(or,yr,_r,Ar){try{or.call(yr,_r,Ar)}catch(wr){return wr}}function zi(or,yr,_r){ai(function(Ar){var wr=!1,Rr=nr(_r,yr,function(Sr){wr||(wr=!0,yr!==Sr?ki(Ar,Sr):Mi(Ar,Sr))},function(Sr){wr||(wr=!0,Ui(Ar,Sr))},"Settle: "+(Ar._label||" unknown promise"));!wr&&Rr&&(wr=!0,Ui(Ar,Rr))},or)}function Wi(or,yr){yr._state===$i?Mi(or,yr._result):yr._state===Ki?Ui(or,yr._result):Yi(yr,void 0,function(_r){return ki(or,_r)},function(_r){return Ui(or,_r)})}function Ti(or,yr,_r){yr.constructor===or.constructor&&_r===Oi&&yr.constructor.resolve===Ii?Wi(or,yr):_r===void 0?Mi(or,yr):ei(_r)?zi(or,yr,_r):Mi(or,yr)}function ki(or,yr){if(or===yr)Ui(or,er());else if(n(yr)){var _r=void 0;try{_r=yr.then}catch(Ar){Ui(or,Ar);return}Ti(or,yr,_r)}else Mi(or,yr)}function xi(or){or._onerror&&or._onerror(or._result),sr(or)}function Mi(or,yr){or._state===Ni&&(or._result=yr,or._state=$i,or._subscribers.length!==0&&ai(sr,or))}function Ui(or,yr){or._state===Ni&&(or._state=Ki,or._result=yr,ai(xi,or))}function Yi(or,yr,_r,Ar){var wr=or._subscribers,Rr=wr.length;or._onerror=null,wr[Rr]=yr,wr[Rr+$i]=_r,wr[Rr+Ki]=Ar,Rr===0&&or._state&&ai(sr,or)}function sr(or){var yr=or._subscribers,_r=or._state;if(yr.length!==0){for(var Ar=void 0,wr=void 0,Rr=or._result,Sr=0;Sr<yr.length;Sr+=3)Ar=yr[Sr],wr=yr[Sr+_r],Ar?cr(_r,Ar,wr,Rr):wr(Rr);or._subscribers.length=0}}function cr(or,yr,_r,Ar){var wr=ei(_r),Rr=void 0,Sr=void 0,Gr=!0;if(wr){try{Rr=_r(Ar)}catch(Or){Gr=!1,Sr=Or}if(yr===Rr){Ui(yr,Vi());return}}else Rr=Ar;yr._state!==Ni||(wr&&Gr?ki(yr,Rr):Gr===!1?Ui(yr,Sr):or===$i?Mi(yr,Rr):or===Ki&&Ui(yr,Rr))}function ir(or,yr){try{yr(function(Ar){ki(or,Ar)},function(Ar){Ui(or,Ar)})}catch(_r){Ui(or,_r)}}var Zi=0;function rr(){return Zi++}function ar(or){or[Li]=Zi++,or._state=void 0,or._result=void 0,or._subscribers=[]}function pr(){return new Error("Array Methods must be provided an Array")}var Gi=(function(){function or(yr,_r){this._instanceConstructor=yr,this.promise=new yr(Di),this.promise[Li]||ar(this.promise),ii(_r)?(this.length=_r.length,this._remaining=_r.length,this._result=new Array(this.length),this.length===0?Mi(this.promise,this._result):(this.length=this.length||0,this._enumerate(_r),this._remaining===0&&Mi(this.promise,this._result))):Ui(this.promise,pr())}return or.prototype._enumerate=function(_r){for(var Ar=0;this._state===Ni&&Ar<_r.length;Ar++)this._eachEntry(_r[Ar],Ar)},or.prototype._eachEntry=function(_r,Ar){var wr=this._instanceConstructor,Rr=wr.resolve;if(Rr===Ii){var Sr=void 0,Gr=void 0,Or=!1;try{Sr=_r.then}catch(en){Or=!0,Gr=en}if(Sr===Oi&&_r._state!==Ni)this._settledAt(_r._state,Ar,_r._result);else if(typeof Sr!="function")this._remaining--,this._result[Ar]=_r;else if(wr===Er){var nn=new wr(Di);Or?Ui(nn,Gr):Ti(nn,_r,Sr),this._willSettleAt(nn,Ar)}else this._willSettleAt(new wr(function(en){return en(_r)}),Ar)}else this._willSettleAt(Rr(_r),Ar)},or.prototype._settledAt=function(_r,Ar,wr){var Rr=this.promise;Rr._state===Ni&&(this._remaining--,_r===Ki?Ui(Rr,wr):this._result[Ar]=wr),this._remaining===0&&Mi(Rr,this._result)},or.prototype._willSettleAt=function(_r,Ar){var wr=this;Yi(_r,void 0,function(Rr){return wr._settledAt($i,Ar,Rr)},function(Rr){return wr._settledAt(Ki,Ar,Rr)})},or})();function gr(or){return new Gi(this,or).promise}function Br(or){var yr=this;return ii(or)?new yr(function(_r,Ar){for(var wr=or.length,Rr=0;Rr<wr;Rr++)yr.resolve(or[Rr]).then(_r,Ar)}):new yr(function(_r,Ar){return Ar(new TypeError("You must pass an array to race."))})}function Nr(or){var yr=this,_r=new yr(Di);return Ui(_r,or),_r}function mr(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function Mr(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var Er=(function(){function or(yr){this[Li]=rr(),this._result=this._state=void 0,this._subscribers=[],Di!==yr&&(typeof yr!="function"&&mr(),this instanceof or?ir(this,yr):Mr())}return or.prototype.catch=function(_r){return this.then(null,_r)},or.prototype.finally=function(_r){var Ar=this,wr=Ar.constructor;return ei(_r)?Ar.then(function(Rr){return wr.resolve(_r()).then(function(){return Rr})},function(Rr){return wr.resolve(_r()).then(function(){throw Rr})}):Ar.then(_r,_r)},or})();Er.prototype.then=Oi,Er.all=gr,Er.race=Br,Er.resolve=Ii,Er.reject=Nr,Er._setScheduler=oi,Er._setAsap=li,Er._asap=ai;function Fr(){var or=void 0;if(typeof commonjsGlobal<"u")or=commonjsGlobal;else if(typeof self<"u")or=self;else try{or=Function("return this")()}catch{throw new Error("polyfill failed because global object is unavailable in this environment")}var yr=or.Promise;if(yr){var _r=null;try{_r=Object.prototype.toString.call(yr.resolve())}catch{}if(_r==="[object Promise]"&&!yr.cast)return}or.Promise=Er}return Er.polyfill=Fr,Er.Promise=Er,Er}))})(es6Promise$1)),es6Promise$1.exports}var es6PromiseExports=requireEs6Promise();const ES6Promise=getDefaultExportFromCjs$1(es6PromiseExports);var XHR={call:function(_t){var e=LoggerByDefault$1.getLogger("XHR");if(e.trace("[XHR::call()]"),ES6Promise.polyfill(),!_t.url)throw new Error("missing parameter : url is not defined !");if(!_t.method)throw new Error("missing parameter : method is not defined !");_t.format||(_t.format="text");var n={};switch(n.url=_t.url,n.data=_t.data?_t.data:null,n.method=_t.method,n.timeOut=_t.timeOut||0,n.scope=_t.scope||this,n.proxy=_t.proxy||null,n.content=_t.content||null,n.headers=_t.headers||{referer:"http://localhost"},_t.method){case"DELETE":case"GET":break;case"PUT":case"POST":n.content=_t.content?_t.content:"application/x-www-form-urlencoded",n.headers=_t.headers?_t.headers:{referer:"http://localhost"};break;case"HEAD":case"OPTIONS":throw new Error("HTTP method not yet supported !");default:throw new Error("HTTP method unknown !")}switch(_t.format){case"text":this.__call(n).then(function(ei){e.trace(ei),_t.onResponse.call(this,ei)}).catch(function(ei){_t.onFailure.call(this,ei)});break;case"json":this.__callJSON(n).then(function(ei){e.trace(ei),_t.onResponse.call(this,ei)}).catch(function(ei){_t.onFailure.call(this,ei)});break;case"xml":this.__callXML(n).then(function(ei){e.trace(ei),_t.onResponse.call(this,ei)}).catch(function(ei){_t.onFailure.call(this,ei)});break;default:throw new Error("This output Format is not yet supported !")}},__call:function(_t){var e=LoggerByDefault$1.getLogger("XHR");e.trace("[XHR::__call()]");var n=new Promise(function(ei,ti){var ii=_t.method==="POST"||_t.method==="PUT"?1:0;_t.data&&(typeof _t.data=="object"&&Object.keys(_t.data).length||typeof _t.data=="string"&&_t.data.length)&&!ii&&(_t.url=Helper$1.normalyzeUrl(_t.url,_t.data)),e.trace("URL = ",_t.url);var ri=null;if(typeof window>"u"){var ni=require("node-fetch"),si={headers:{Referer:"https://localhost"}};return _t.data&&typeof _t.data=="string"&&ii&&(si={method:_t.method,body:_t.data,headers:{"Content-Type":_t.content,Referer:"https://localhost"}}),ni(_t.url,si).then(function(ci){if(ci.ok)ei(ci.text());else{var ui="Errors Occured on Http Request (status : '"+ci.statusText+"' | url : '"+ci.url+"')",di=ci.status;ti({message:ui,status:di})}}).catch(function(ci){ti({message:ci,status:-1})})}else if(window.XMLHttpRequest){e.trace("XMLHttpRequest"),ri=new XMLHttpRequest,ri.open(_t.method,_t.url,!0),ri.overrideMimeType=_t.content;var ai=null;_t.timeOut>0&&(e.trace("XHR - TimeOut actif !"),ai=window.setTimeout(function(){var ci="TimeOut Occured on Http Request with XMLHttpRequest !";ti({message:ci,status:-1})},_t.timeOut)),ii&&(e.trace("data = ",_t.data),ri.setRequestHeader("Content-type",_t.content)),ri.onerror=function(ci){console.log(ci),ti(new Error("Errors Occured on Http Request with XMLHttpRequest !"))},ri.ontimeout=function(ci){console.log(ci),ti(new Error("TimeOut Occured on Http Request with XMLHttpRequest !"))},ri.onreadystatechange=function(ci){if(ri.readyState===4)if(ri.status===200)window.clearTimeout(ai),ei(ri.response);else{var ui="Errors Occured on Http Request (status : '"+ci.target.statusText+"' | url : '"+ci.target.responseURL+"' | response : '"+ci.target.response+"')",di=ci.target.status;ti({message:ui,status:di})}};var oi=_t.data&&ii?_t.data:null;ri.send(oi)}else if(window.XDomainRequest){e.trace("XDomainRequest"),ri=new XDomainRequest,ri.open(_t.method,_t.url),ri.overrideMimeType=_t.content,_t.timeOut>0&&(ri.timeout=_t.timeout,e.trace("XHR - TimeOut actif !")),ii&&ri.setRequestHeader("Content-type",_t.content),ri.onerror=function(){ti(new Error("Errors Occured on Http Request with XMLHttpRequest !"))},ri.ontimeout=function(){ti(new Error("TimeOut Occured on Http Request with XMLHttpRequest !"))},ri.onload=function(ci){if(ri.status===200)ei(ri.responseText);else{var ui="Errors Occured on Http Request (status : '"+ci.target.statusText+"' | url : '"+ci.target.responseURL+"')",di=ci.target.status;ti({message:ui,status:di})}};var li=_t.data&&ii?_t.data:null;ri.send(li)}else throw new Error("CORS not supported")});return n},__callJSON:function(_t){return this.__call(_t).then(JSON.parse).catch(function(e){console.log("_callJSON failed on : ",_t.url,e)})},__callXML:function(_t){return this.__call(_t).then(function(e){var n;if(typeof window>"u"){var ei=require("@xmldom/xmldom").DOMParser;n=new ei().parseFromString(e,"text/xml")}else if(window.DOMParser){var ti=new window.DOMParser;n=ti.parseFromString(e,"text/xml")}else n=new window.ActiveXObject("Microsoft.XMLDOM"),n.async=!1,n.loadXML(e);return n}).catch(function(e){console.log("__callXML failed on : ",_t.url,e)})}},JSONP={uuid:(function(){var _t=Math.floor(Date.now());return function(){return _t++}})(),call:function(_t){var e=LoggerByDefault$1.getLogger("JSONP");if(e.trace("[JSONP::call ()]"),!_t)throw e.error("missing parameter : options !"),new Error("missing parameter : options !");if(!_t.url)throw e.error("missing parameter : options.url !"),new Error("missing parameter : options.url !");if(_t.timeOut||(e.info("setting 'options.timeOut' default value"),_t.timeOut=0),!_t.onResponse)throw e.error("missing parameter : options.onResponse !"),new Error("missing parameter : options.onResponse !");var n=typeof _t.callbackSuffix=="string"?_t.callbackSuffix:this.uuid(),ei=!1,ti=!1,ii=_t.url.indexOf("callback=");if(ii!==-1){ei=!0;var ri=_t.url.indexOf("&",ii);ri===-1&&(ri=_t.url.length);var ni=_t.url.substring(ii+9,ri);ni&&(ti=!0,_t.callbackName=ni,e.info("setting 'options.callbackName' value ("+_t.callbackName+") from 'options.url' parameter"))}if(!ei){var si=_t.url.indexOf("?");si===-1?_t.url=_t.url+"?callback=":si===_t.url.length?_t.url=_t.url+"callback=":_t.url=_t.url+"&callback=",e.info("setting callback default key in 'options.url' : "+_t.url)}var ai=_t.callbackName?!0:ti;if(ti||(_t.callbackName||(e.info("setting 'options.callbackName' default value"),_t.callbackName="callback",(n||n==="")&&(_t.callbackName+=n)),_t.url=_t.url.replace("callback=","callback="+_t.callbackName),e.info("setting callback function name in 'options.url' : "+_t.url)),_t.onTimeOut||(e.info("setting 'options.onTimeOut' default value"),_t.onTimeOut=function(){console.log("TimeOut while invoking url : "+_t.url)}),!ai){var oi=this,li=null;_t.timeOut>0&&(li=window.setTimeout(function(){window[_t.callbackName]=function(){},_t.onTimeOut(),oi._deleteScript(n)},_t.timeOut)),window[_t.callbackName]=function(ci){window.clearTimeout(li),_t.onResponse(ci),oi._deleteScript(n)}}this._createScript(n,_t.url)},_createScript:function(_t,e){var n,ei=document.getElementById("results"+_t);n=document.createElement("script"),n.setAttribute("type","text/javascript"),n.setAttribute("src",e),n.setAttribute("charset","UTF-8"),n.setAttribute("id","results"+_t),n.setAttribute("async","true");var ti=document.documentElement||document.getElementsByTagName("head")[0];ei===null?ti.appendChild(n):ti.replaceChild(n,ei)},_deleteScript:function(_t){var e=document.getElementById("results"+_t);if(e){var n=e.parentNode||document.documentElement;if(!n)return;n.removeChild(e)}}},Protocol={send:function(_t){var e=_t||{method:"GET",protocol:"XHR",timeOut:0,format:null,wrap:!0,nocache:!0,output:"json",callback:null,callbackSuffix:null};if(typeof window>"u"&&_t.protocol==="JSONP"){console.log("Value (s) for parameter (s) 'protocol=JSONP (instead use XHR)' not supported to NodeJS");return}if(_t.protocol==="XHR"||_t.format==="json"?e.wrap=!1:_t.protocol==="JSONP"&&_t.format==="xml"&&(e.wrap=!0),e.callback=null,e.output=e.wrap?"json":null,e.wrap){var n={};n.output=e.output,n.callback=e.callback,delete n.callback,e.url=Helper$1.normalyzeUrl(_t.url,n)}switch(e.protocol){case"XHR":_t.method==="GET"&&_t.nocache&&(e.url=Helper$1.normalyzeUrl(e.url,{t:new Date().getTime()})),XHR.call(e);break;case"JSONP":e.data&&(e.url=Helper$1.normalyzeUrl(e.url,e.data)),JSONP.call(e);break;default:throw new Error("protocol not supported (XHR|JSONP) !")}}};function ErrorService(_t){if(!(this instanceof ErrorService))throw new TypeError("ErrorService constructor cannot be called as a function.");var e=_t;typeof _t=="string"||_t instanceof String?(this.message=_t,this.status=-1,this.type=ErrorService.TYPE_UNKERR):(this.message=e.message||"undefined!?",this.type=e.type,this.status=e.status||-1),this.name="ErrorService",this.stack=new Error().stack}ErrorService.TYPE_SRVERR="SERVICE_ERROR";ErrorService.TYPE_USEERR="USAGE_ERROR";ErrorService.TYPE_UNKERR="UNKNOWN_ERROR";ErrorService.prototype=Object.create(Error.prototype,{constructor:{value:ErrorService,writable:!0,configurable:!0}});const version$1="3.4.6",date="19/12/2024",Pkg={version:version$1,date};function CommonService(_t){if(!(this instanceof CommonService))throw new TypeError(MessagesResources.getMessage("CLASS_CONSTRUCTOR"));this.logger=LoggerByDefault$1.getLogger("CommonService"),this.logger.trace("[Constructeur CommonService (options)]"),this.options={protocol:"XHR",ssl:!0,proxyURL:"",callbackSuffix:null,httpMethod:"GET",timeOut:0,rawResponse:!1,scope:this,onSuccess:function(ei){console.log("onSuccess - la reponse est la suivante : ",ei)},onFailure:function(ei){ei.status===200||!ei.status?console.log("onFailure : ",ei.message):console.log("onFailure - Erreur (",ei.status,") : ",ei.message)}};for(var e in _t)_t.hasOwnProperty(e)&&(this.options[e]=_t[e]);this.options.rawResponse&&!this.options.onSuccess&&(this.options.onSuccess=function(ei){console.log("onSuccess - la rponse brute du service est la suivante : ",ei)});var n=this.options.onSuccess!==null&&typeof this.options.onSuccess=="function";if(!n)throw new Error(MessagesResources.getMessage("PARAM_MISSING","onSuccess()"));switch(this.options.httpMethod=typeof _t.httpMethod=="string"?_t.httpMethod.toUpperCase():"GET",this.options.httpMethod){case"POST":case"GET":break;case"PUT":case"DELETE":case"HEAD":case"OPTIONS":throw new Error(MessagesResources.getMessage("PARAM_NOT_SUPPORT","httpMethod"));default:throw new Error(MessagesResources.getMessage("PARAM_UNKNOWN","httpMethod"))}switch(this.options.protocol=typeof _t.protocol=="string"?_t.protocol.toUpperCase():"XHR",this.options.protocol){case"JSONP":case"XHR":break;default:throw new Error(MessagesResources.getMessage("PARAM_UNKNOWN","protocol"))}if(typeof window>"u"&&this.options.protocol==="JSONP")throw new Error(MessagesResources.getMessage("PARAM_NOT_SUPPORT_NODEJS","protocol=JSONP (instead use XHR)"));this.options.protocol==="JSONP"&&(this.options.httpMethod="GET"),this.options.nocache=_t.nocache||!1,this.options.outputFormat=null,this.request=null,this.response=null}CommonService.prototype={constructor:CommonService,call:function(){this.logger.trace("CommonService::call ()");var _t=this;function e(){this.logger.trace("CommonService::run ()"),this.buildRequest.call(_t,ii,n)}e.call(_t);function n(ri){this.logger.trace("CommonService::onBuildRequest : ",ri),this.callService.call(_t,ii,ei)}function ei(ri){this.logger.trace("CommonService::onCallService : ",ri),this.analyzeResponse.call(_t,ii,ti)}function ti(ri){if(this.logger.trace("CommonService::onAnalyzeResponse : ",ri),ri)this.options.onSuccess.call(this,ri);else return ii.call(this,new ErrorService("Analyse de la reponse en chec !?"))}function ii(ri){this.logger.trace("CommonService::onError()");var ni=ri;ni instanceof ErrorService||(ni=new ErrorService(ri.message)),this.options.onFailure.call(this,ni)}},buildRequest:function(_t,e){this.logger.error("overwritten method !"),_t&&_t.call(this,"This method must be overwritten !"),e.call(this,"This method must be overwritten !")},callService:function(_t,e){var n=null,ei=this.request,ti=!!(this.options.proxyURL&&this.options.protocol==="XHR"),ii={"gp-access-lib":Pkg.version};this.options.apiKey&&(ii.apiKey=this.options.apiKey),this.options.serverUrl=Helper$1.normalyzeUrl(this.options.serverUrl,ii,!1),ti&&(this.options.httpMethod==="GET"&&(n=this.options.proxyURL+Helper$1.normalyzeUrl(this.options.serverUrl,this.request,!0),ei=null),this.options.httpMethod==="POST"&&(n=this.options.proxyURL+Helper$1.normalyzeUrl(this.options.serverUrl,null,!0),ei=this.request));var ri=this,ni={url:n||this.options.serverUrl,method:this.options.httpMethod,protocol:this.options.protocol,timeOut:this.options.timeOut||0,format:this.options.outputFormat,nocache:this.options.nocache||!1,wrap:this.options.protocol!=="XHR",callbackSuffix:this.options.callbackSuffix,data:ei,headers:null,content:this.options.contentType||"application/xml",scope:this.options.scope||this,onResponse:function(si){ri.logger.trace("callService::onResponse()");var ai=null;if(ri.options.protocol==="XHR"&&(ri.logger.trace("Response XHR",si),ai=si),ri.options.protocol==="JSONP")if(ri.logger.trace("Response JSON",si),si)if(si.http)if(si.http.status!==200){_t.call(ri,new ErrorService({status:si.http.status,message:si.http.error,type:ErrorService.TYPE_SRVERR}));return}else ai=si.xml,ri.options.rawResponse&&(ai=si);else ai=si;else{_t.call(ri,new ErrorService("Le contenu de la reponse est vide !?"));return}if(typeof ri.options.onBeforeParse=="function"){var oi=ri.options.onBeforeParse(ai);typeof oi=="string"&&(ai=oi)}ri.response=ai,e.call(ri,ai)},onFailure:function(si){ri.logger.trace("callService::onFailure()"),si.type=ErrorService.TYPE_SRVERR,_t.call(ri,new ErrorService(si))},onTimeOut:function(){ri.logger.trace("callService::onTimeOut()"),_t.call(ri,new ErrorService("TimeOut!"))}};Protocol.send(ni)},analyzeResponse:function(_t,e){this.logger.error("overwritten method !"),_t&&_t.call(this,"This method must be overwritten !"),e.call(this,"This method must be overwritten !")}};var DefaultUrlService={ssl:!0,newUrl:function(_t){var e="data.geopf.fr",n;return DefaultUrlService.ssl===!1?n="http://":n="https://",n+e+_t},Alti:{new_key:{"elevation-json":"/altimetrie/1.0/calcul/alti/rest/elevation.json","elevation-xml":"/altimetrie/1.0/calcul/alti/rest/elevation.xml","profil-json":"/altimetrie/1.0/calcul/alti/rest/elevationLine.json","profil-xml":"/altimetrie/1.0/calcul/alti/rest/elevationLine.xml"},newUrl:function(){return{"elevation-json":DefaultUrlService.newUrl(this.new_key["elevation-json"]),"elevation-xml":DefaultUrlService.newUrl(this.new_key["elevation-xml"]),"profil-json":DefaultUrlService.newUrl(this.new_key["profil-json"]),"profil-xml":DefaultUrlService.newUrl(this.new_key["profil-xml"])}}},ProcessIsoCurve:{new_key:"/navigation/isochrone",newUrl:function(){return DefaultUrlService.newUrl(this.new_key)}},Config:{_key:"https://raw.githubusercontent.com/IGNF/geoportal-configuration/new-url/dist/",url:function(_t){Array.isArray(_t)||(_t=_t.split(","));for(var e=[],n=0;n<_t.length;n++)e[n]=this._key+_t[n]+"Config.json";return e}},AutoComplete:{new_key:"/geocodage/completion",newUrl:function(){return DefaultUrlService.newUrl(this.new_key)}},ReverseGeocode:{new_key:"/geocodage/reverse",newUrl:function(){return DefaultUrlService.newUrl(this.new_key)}},Geocode:{new_key:"/geocodage/search",newUrl:function(){return DefaultUrlService.newUrl(this.new_key)}},Route:{new_key:"/navigation/itineraire",newUrl:function(){return DefaultUrlService.newUrl(this.new_key)}}};function ConfigInterface(){if(!(this instanceof ConfigInterface))throw new TypeError("ConfigInterface constructor cannot be called as a function.");this.generalOptions={apiKeys:{},title:null,defaultGMLGFIStyle:null,theme:null,wgs84Resolutions:[]},this.layers={},this.tileMatrixSets={}}ConfigInterface.prototype={constructor:ConfigInterface,isKeyConfLoaded:function(_t){if(_t)return!!this.generalOptions.apiKeys[_t]},getLayersId:function(_t){return this.generalOptions.apiKeys[_t]},getLayerId:function(_t,e){if(!(!_t||!e)){var n=null;if(this.layers){var ei=this.layers;for(var ti in ei)if(ei.hasOwnProperty(ti)){var ii=ti.split("$");if(_t===ii[0]&&ii[1]){var ri=ii[1].split(":"),ni=ii[1].split(";");if(ni[1]===e.toUpperCase()){n=ti;break}if(ri[2]===e.toUpperCase()){n=ti;break}}}}if(n)return n}},getLayersConf:function(_t){var e={},n=this.getLayersId(_t);if(n)for(var ei=0;ei<n.length;ei++){var ti=n[ei];e[ti]=this.layers[ti]}return e},getLayerConf:function(_t){if(this.layers)return this.layers[_t]},getLayerParams:function(_t,e){var n={};if((e==="WMS"||Object.keys(this.tileMatrixSets).length!==0)&&Object.keys(this.layers).length!==0){var ei=this.getLayerId(_t,e);if(ei){var ti=this.getLayerConf(ei),ii=this.getLayerKey(ei);if(ii.length===0)return;for(var ri=0;ri<ii.length;ri++)ti.serviceParams.serverUrl[ii[ri]]&&(n.url=ti.serviceParams.serverUrl[ii[ri]]);if(e!=="WFS"&&(/\/v\//.test(n.url)?n.styles=" ":n.styles=ti.styles[0].name),n.version=ti.serviceParams.version,n.format=ti.formats&&ti.formats.length?ti.formats[0].name:"",n.projection=ti.defaultProjection,n.minScale=ti.globalConstraint.minScaleDenominator,n.maxScale=ti.globalConstraint.maxScaleDenominator,n.extent=ti.globalConstraint.bbox,n.legends=ti.legends,n.title=ti.title,n.description=ti.description,e==="WMS"&&(n.metadata=ti.metadata),ti.wmtsOptions){n.tileMatrixSetLimits=ti.wmtsOptions.tileMatrixSetLimits;var ni=ti.wmtsOptions.tileMatrixSetLink;if(ni){n.TMSLink=ni;var si=this.getTMSConf(ni);n.matrixIds=Object.keys(si.tileMatrices),n.tileMatrices=si.tileMatrices,n.nativeResolutions=si.nativeResolutions||this.getTMSConf("PM").nativeResolutions}}}}return n},getLayerKey:function(_t){var e=[];if(this.generalOptions&&this.generalOptions.apiKeys&&Object.keys(this.generalOptions.apiKeys).length!==0){var n=this.generalOptions.apiKeys;for(var ei in n){var ti=n[ei];ti.forEach(function(ii){ii===_t&&e.push(ei)})}}return e},getTileMatrixSets:function(){return this.tileMatrixSets},getTMSConf:function(_t){if(this.tileMatrixSets)return this.tileMatrixSets[_t]},getGlobalConstraints:function(_t){var e={};if(_t){var n=this.getLayerConf(_t);e.projection=n.defaultProjection,e.minScale=n.globalConstraint.minScaleDenominator,e.maxScale=n.globalConstraint.maxScaleDenominator,e.extent=n.globalConstraint.bbox}return e}};function Config$1(_t){if(!(this instanceof Config$1))throw new TypeError(MessagesResources.getMessage("CLASS_CONSTRUCTOR","Config"));this.CLASSNAME="Config",this.logger=LoggerByDefault$1.getLogger("Gp.Config"),this.logger.trace("[Constructeur Config (options)]");var e=_t.onSuccess!==null&&typeof _t.onSuccess=="function";if(!e)throw new Error(MessagesResources.getMessage("PARAM_MISSING","onSuccess()"));!_t.apiKey&&!_t.customConfigFile&&(_t.apiKey="full"),this.options={},this.options.onSuccess=_t.onSuccess,this.options.onFailure=_t.onFailure,this.options.sync=_t.sync||!1,this.options.listConfigUrls=_t.customConfigFile?[_t.customConfigFile]:Array.isArray(_t.apiKey)?DefaultUrlService.Config.url(_t.apiKey):DefaultUrlService.Config.url(_t.apiKey.split(","))}Config$1.prototype=Object.create(CommonService.prototype,{});Config$1.prototype.constructor=Config$1;Config$1.prototype.buildRequest=function(_t,e){if(this.listConfigUrls=this.options.listConfigUrls,!this.listConfigUrls){_t.call(this,new Error("url by default not found !"));return}e.call(this,this.listConfigUrls)};Config$1.prototype.callService=function(_t,e){this.options.sync?__callServiceSync.call(this,_t,e):__callService.call(this,_t,e)};var __callService=function(_t,e){this.listConfigResults=[];let n=null;if(typeof window>"u"){var ei=require("node-fetch");n=ei}else n=window.fetch;var ti=ri=>n(ri,{credentials:"same-origin"}).then(ni=>{if(ni.ok)return ni.json().then(si=>si).catch(si=>{throw new Error("Exception Json : "+si)});throw new Error("Exception HTTP : "+ni.status+" (status code) !")}).catch(ni=>new Promise((si,ai)=>{ai(ni)})),ii=[];for(let ri=0;ri<this.listConfigUrls.length;ri++){const ni=this.listConfigUrls[ri];ii.push(ti(ni))}Promise.all(ii).then(ri=>{if(!ri)throw new Error("results config empty !?");ri.forEach(ni=>{this.listConfigResults.push(ni)})}).then(()=>{e.call(this,this.listConfigResults)}).catch(ri=>{_t.call(this,ri)})},__callServiceSync=function(_t,e){this.listConfigResults=[];for(var n=0;n<this.listConfigUrls.length;n++){const ti=this.listConfigUrls[n],ii=new XMLHttpRequest;if(ii.open("GET",ti,!1),ii.send(null),ii.status===200){var ei=JSON.parse(ii.responseText);this.listConfigResults.push(ei)}}this.listConfigResults.length!==0?e.call(this,this.listConfigResults):_t.call(this,new Error("..."))};Config$1.prototype.analyzeResponse=function(_t,e){var n=function(ni){for(var si={},ai={},oi={},li=0;li<ni.length;li++){if(!ni[li].generalOptions||!ni[li].layers)return;ai={...ai,...ni[li].generalOptions.apiKeys},si={...si,...ni[li].layers},oi={...oi,...ni[li].tileMatrixSets}}var ci={generalOptions:{apiKeys:ai},layers:si,tileMatrixSets:oi};return ci},ei=n(this.listConfigResults);if(!ei){_t.call(this,new Error("configuration structure not conforme !"));return}var ti=new ConfigInterface;Object.assign(ti,ei);var ii=typeof window<"u"?window:{};if(ii.Gp||(ii.Gp={}),ii.Gp.Config){Object.assign(ii.Gp.Config,ti);for(var ri in ti)ii.Gp.Config[ri]=ti[ri]}else ii.Gp.Config=ti;e.call(this,ii.Gp.Config)};function AltiRequest(_t){if(!(this instanceof AltiRequest))throw new TypeError("AltiRequest constructor cannot be called as a function.");this.logger=LoggerByDefault$1.getLogger(),this.logger.trace("[Constructeur AltiRequest ()]"),this.options=_t||{},this.positions=this.options.positions||[],this.delimiter=this.options.delimiter||"|",this.indent=this.options.indent||!1,this.crs=this.options.crs||"CRS:84",this.format=this.options.format||"json",this.resource=this.options.resource,this.measures=this.options.measures||!1}AltiRequest.CLASSNAME="AltiRequest";AltiRequest.prototype={constructor:AltiRequest,setPositions:function(_t){for(var e=[],n=0;n<_t.length;n++){var ei=_t[n];ei.lon&&ei.lat&&e.push(ei)}this.positions=e},getPositions:function(_t){if(!_t)return this.positions;var e=this.positions.length-1;return _t>e||_t<e?(this.logger.warn("index out of range !"),this.positions):this.positions[_t]},addPositions:function(_t){for(var e=0;e<_t.length;e++){var n=_t[e];n.lon&&n.lat&&this.positions.push(_t[e])}},getLon:function(){for(var _t=[],e=0;e<this.positions.length;e++)_t.push(this.positions[e].lon);return this.logger.trace(_t),_t.join(this.delimiter)},getLat:function(){for(var _t=[],e=0;e<this.positions.length;e++)_t.push(this.positions[e].lat);return this.logger.trace(_t),_t.join(this.delimiter)}};AltiRequest.prototype.getData=function(){var _t=[];return _t.push({k:"lon",v:this.getLon()}),_t.push({k:"lat",v:this.getLat()}),_t.push({k:"delimiter",v:this.delimiter}),_t.push({k:"indent",v:this.indent}),_t.push({k:"crs",v:this.crs}),_t.push({k:"format",v:this.format}),_t};function AltiElevationRequest(_t){if(!(this instanceof AltiElevationRequest))throw new TypeError("AltiElevationRequest constructor cannot be called as a function.");this.CLASSNAME="AltiElevationRequest",AltiRequest.apply(this,arguments),this.logger=LoggerByDefault$1.getLogger(),this.logger.trace("[Constructeur AltiElevationRequest ()]"),this.zonly=this.options.zonly||!1}AltiElevationRequest.prototype=Object.create(AltiRequest.prototype,{zonly:{get:function(){return this._zonly},set:function(_t){this._zonly=_t}}});AltiElevationRequest.prototype.constructor=AltiElevationRequest;AltiElevationRequest.prototype.getData=function(){var _t=[];return _t.push({k:"lon",v:this.getLon()}),_t.push({k:"lat",v:this.getLat()}),_t.push({k:"indent",v:this.indent}),_t.push({k:"crs",v:this.crs}),_t.push({k:"zonly",v:this.zonly}),_t.push({k:"format",v:this.format}),_t.push({k:"resource",v:this.resource}),_t};function AltiProfilRequest(_t){if(!(this instanceof AltiProfilRequest))throw new TypeError("AltiProfilRequest constructor cannot be called as a function.");this.CLASSNAME="AltiProfilRequest",AltiRequest.apply(this,arguments),this.logger=LoggerByDefault$1.getLogger(),this.logger.trace("[Constructeur AltiProfilRequest ()]"),this.sampling=this.options.sampling||3}AltiProfilRequest.prototype=Object.create(AltiRequest.prototype,{sampling:{get:function(){return this._sampling},set:function(_t){this._sampling=_t}}});AltiProfilRequest.prototype.constructor=AltiProfilRequest;AltiProfilRequest.prototype.getData=function(){var _t=[];return _t.push({k:"lon",v:this.getLon()}),_t.push({k:"lat",v:this.getLat()}),_t.push({k:"indent",v:this.indent}),_t.push({k:"crs",v:this.crs}),_t.push({k:"sampling",v:this.sampling}),_t.push({k:"format",v:this.format}),_t.push({k:"resource",v:this.resource}),_t};function AltiRequestREST(_t){if(this.logger=LoggerByDefault$1.getLogger("AltiRequestREST"),this.logger.trace("[Constructeur AltiRequestREST ()]"),!(this instanceof AltiRequestREST))throw new TypeError("AltiRequestREST constructor cannot be called as a function.");if(this.options=_t||{},!this.options)throw new Error(MessagesResources.getMessage("PARAM_EMPTY","options"));if(!this.options.type)throw new Error(MessagesResources.getMessage("PARAM_EMPTY","type (Elevation or Profil)"));switch(this.DataObject=null,this.options.type){case"Elevation":this.DataObject=new AltiElevationRequest(this.options.param);break;case"Profil":this.DataObject=new AltiProfilRequest(this.options.param);break;default:throw new Error(MessagesResources.getMessage("PARAM_TYPE","type (Elevation or Profil)"))}this.method=this.options.method||"GET"}AltiRequestREST.prototype={requestString:null,constructor:AltiRequestREST,template:{get:{value:"lon=__LON__&lat=__LAT__&indent=__INDENT__&crs='__CRS__'&resource=__RESOURCE__&measures=__MEASURES__",input:{point:"&zonly=__ZONLY__",profil:"&sampling=__SAMPLING__"}},post:{value:`lon=__LON__
lat=__LAT__
indent=__INDENT__
crs='__CRS__'
resource='__RESOURCE__'
measures='__MEASURES__'
`,input:{point:`zonly=__ZONLY__
`,profil:"sampling=__SAMPLING__"}}},processRequestString:function(){this.logger.trace("AltiRequestREST::processRequestString ()");var _t="";return this.method==="POST"?_t=this.template.post.value:this.method==="GET"&&(_t=this.template.get.value),_t=_t.replace(/__LON__/g,this.DataObject.getLon()),_t=_t.replace(/__LAT__/g,this.DataObject.getLat()),_t=_t.replace(/__INDENT__/g,this.DataObject.indent),_t=_t.replace(/__CRS__/g,this.DataObject.crs),_t=_t.replace(/__RESOURCE__/g,this.DataObject.resource),_t=_t.replace(/__MEASURES__/g,this.DataObject.measures),_t=_t+this.__addDataInputs(),this.logger.trace("traduction tmpl",_t),this.requestString=_t,this.requestString},__addDataInputs:function(){this.logger.trace("AltiRequestREST::addDataInput ()");var _t;if(this.method==="POST")_t=this.template.post;else if(this.method==="GET")_t=this.template.get;else throw new Error("No other HTTP method supported by the service !");var e=null;if(this.DataObject.CLASSNAME==="AltiElevationRequest")return e=_t.input.point,e.replace(/__ZONLY__/g,this.DataObject.zonly.toString());if(this.DataObject.CLASSNAME==="AltiProfilRequest")return e=_t.input.profil,e.replace(/__SAMPLING__/g,this.DataObject.sampling);throw new Error("No other object supported than elevation or profil !?")}};function WPS(_t){if(this.logger=LoggerByDefault$1.getLogger(),this.logger.trace("[Constructeur WPS()]"),!(this instanceof WPS))throw new TypeError("WPS constructor cannot be called as a function.");if(this.options=_t||{},this.DataObject=this.options.data,!this.DataObject)throw new TypeError("This data object is not defined !");this.paramservice=this.options.param.service||"WPS",this.paramversion=this.options.param.version||"1.0.0",this.paramidentifier=this.options.param.identifier||"gs:WPS",this.paramrawdataoutput=this.options.param.rawdataoutput||"result",this.paramrequest=this.options.param.request||"Execute",this.method=this.options.method||"GET"}WPS.prototype={requestString:null,constructor:WPS,template:{get:{value:"service=__SERVICE__&version=__VERSION__&rawdataoutput=__RAWDATAOUTPUT__&identifier=__IDENTIFIER__&request=__REQUEST__&datainputs=<!-- __DATAINPUTS__ -->",input:"__KEY__=__DATA__"},post:{value:'<?xml version="1.0" encoding="UTF-8"?><wps:__REQUEST__ version="__VERSION__" service="__SERVICE__" __NAMESPACE__ __SCHEMALOCATION__><ows:Identifier>__IDENTIFIER__</ows:Identifier><wps:DataInputs><!-- __DATAINPUTS__ --></wps:DataInputs><wps:ResponseForm><wps:RawDataOutput><ows:Identifier>__RAWDATAOUTPUT__</ows:Identifier></wps:RawDataOutput></wps:ResponseForm></wps:__REQUEST__>',input:"<wps:Input><ows:Identifier>__KEY__</ows:Identifier><wps:Data><wps:LiteralData>__DATA__</wps:LiteralData></wps:Data></wps:Input>"}},namespaceByDefault:function(){var _t=['xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"','xmlns="http://www.opengis.net/wps/1.0.0"','xmlns:wfs="http://www.opengis.net/wfs"','xmlns:wps="http://www.opengis.net/wps/1.0.0"','xmlns:ows="http://www.opengis.net/ows/1.1"','xmlns:gml="http://www.opengis.net/gml"','xmlns:ogc="http://www.opengis.net/ogc"','xmlns:wcs="http://www.opengis.net/wcs/1.1.1"','xmlns:xlink="http://www.w3.org/1999/xlink"'];return _t.join(" ")},schemaLocationByDefault:function(){return'xsi:schemaLocation="http://www.opengis.net/wps/1.0.0 http://schemas.opengis.net/wps/1.0.0/wpsAll.xsd"'},processRequestString:function(){this.logger.trace("WPS::processRequestString ()");var _t="";if(this.method==="POST")_t=this.template.post.value;else if(this.method==="GET")_t=this.template.get.value;else return this.logger.error("No other method supported by the service !"),!1;return _t=_t.replace(/__SERVICE__/g,this.paramservice),_t=_t.replace(/__VERSION__/g,this.paramversion),_t=_t.replace(/__RAWDATAOUTPUT__/g,this.paramrawdataoutput),_t=_t.replace(/__IDENTIFIER__/g,this.paramidentifier),_t=_t.replace(/__REQUEST__/g,this.paramrequest),this.method==="POST"&&(_t=_t.replace(/__NAMESPACE__/g,this.namespaceByDefault),_t=_t.replace(/__SCHEMALOCATION__/g,this.schemaLocationByDefault)),_t=_t.replace(/<!-- __DATAINPUTS__ -->/g,this.__addDataInputs()),_t?(this.requestString=_t,this.logger.trace("traduction tmpl",_t),!0):(this.logger.warn("traduction tmpl : empty request !?"),!1)},__addDataInputs:function(){this.logger.trace("WPS::__addDataInputs ()");for(var _t=this.method==="GET"?this.template.get.input:this.template.post.input,e=this.method==="GET"?";":"",n="",ei=this,ti=this.DataObject.getData(),ii=0;ii<ti.length;ii++)(function(ri){e&&(e=ri===ti.length-1?"":";"),n=n.concat(ei.__addDataInput(_t,ti[ri].k,ti[ri].v),e)})(ii);return n},__addDataInput:function(_t,e,n){var ei=_t;return ei=ei.replace(/__KEY__/g,e),ei=ei.replace(/__DATA__/g,n),ei},setMethod:function(_t){_t==="GET"||_t==="POST"?this.method=_t:this.logger.warn("support only GET and POST method !")},getMethod:function(){return this.method}};var AltiRequestWPS={build:function(_t){var e=LoggerByDefault$1.getLogger("AltiRequestWPS");if(e.trace(["AltiRequestWPS::build()"]),!_t)throw new Error(MessagesResources.getMessage("PARAM_EMPTY","options"));if(!_t.type)throw new Error(MessagesResources.getMessage("PARAM_EMPTY","type (Elevation or Profil)"));var n=null;switch(_t.type){case"Elevation":_t.wps.identifier="gs:WPSElevation",n=new AltiElevationRequest(_t.param);break;case"Profil":_t.wps.identifier="gs:WPSLineElevation",n=new AltiProfilRequest(_t.param);break;default:throw new Error(MessagesResources.getMessage("PARAM_TYPE","type (Elevation or Profil)"))}var ei={data:n,method:_t.method,param:_t.wps},ti=new WPS(ei);if(!ti.processRequestString())throw new Error("Enable to process request !");return ti.requestString}},AltiRequestFactory={build:function(_t){var e=LoggerByDefault$1.getLogger("AltiRequestFactory");e.trace(["AltiRequestFactory::build()"]);var n=null,ei={type:_t.sampling?"Profil":"Elevation",method:_t.httpMethod,param:{positions:null,delimiter:null,indent:null,crs:null,format:null,sampling:null,zonly:null,measures:null}};ei.param.positions=_t.positions,ei.param.format=_t.outputFormat,ei.param.sampling=_t.sampling,ei.param.zonly=_t.zonly,ei.param.measures=_t.measures,ei.param.resource=_t.resource;var ti=_t.onError!==null&&typeof _t.onError=="function",ii=_t.onSuccess!==null&&typeof _t.onSuccess=="function",ri=null;switch(_t.api){case"REST":var ni=new AltiRequestREST(ei);if(!ni.processRequestString()){if(ri="Error in process request (rest) !",ti){_t.onError.call(_t.scope,new ErrorService(ri));return}throw new Error(ri)}n=ni.requestString;break;case"WPS":if(ei.wps={service:null,version:null,identifier:null,rawdataoutput:null,request:null},n=AltiRequestWPS.build(ei),!n){if(ri="Error in process request (wps) !",ti){_t.onError.call(_t.scope,new ErrorService(ri));return}throw new Error(ri)}break;default:if(ri="Type of API is not supported by service (REST or WPS) !",ti){_t.onError.call(_t.scope,new ErrorService(ri));return}throw new Error(ri)}return ii&&_t.onSuccess.call(_t.scope,n),n}};function XML$1(_t){if(!(this instanceof XML$1))throw new TypeError("XML constructor cannot be called as a function.");this.logger=LoggerByDefault$1.getLogger(),this.logger.trace("[Constructeur XML ()]"),this.xmlString=null,this.xmlDoc=null,this.reader=null,_t&&(_t.xmlString&&typeof _t.xmlString=="string"&&(this.xmlString=_t.xmlString,this.xmlDoc=__getXMLDOC(_t.xmlString)),_t.reader&&this.setReader(_t.reader))}XML$1.prototype={constructor:XML$1,getXMLString:function(){return this.xmlString},setXMLString:function(_t){_t&&typeof _t=="string"&&(this.xmlString=_t,this.xmlDoc=__getXMLDOC(_t))},getReader:function(){return this.reader},setReader:function(_t){_t&&_t.read&&typeof _t.read=="function"&&(this.reader=_t)},getXMLDoc:function(){return this.xmlDoc},setXMLDoc:function(_t){this.xmlDoc=_t},parse:function(){if(!this.xmlDoc&&this.xmlString&&(this.xmlDoc=__getXMLDOC(this.xmlString)),this.xmlDoc){var _t=__getRootNode(this.xmlDoc);if(_t){var e;return this.reader&&this.reader.read?e=this.reader.read(_t):(e={},e[_t.nodeName]=__readDefault(_t)),e}else return{}}}};function __getXMLDOC(_t){if(typeof window>"u"){var e=require("@xmldom/xmldom").DOMParser;return new e().parseFromString(_t,"text/xml")}else{var n,ei,ti="Erreur lors du parsing de la rponse du service : XML non conforme";if(window.ActiveXObject){ei=new window.ActiveXObject("Microsoft.XMLDOM"),ei.async=!1,ei.loadXML(_t);var ii=ei.parseError;if(ii.errorCode)throw ii.line&&ii.linepos&&(ti+="( ligne "+ii.line+", colonne "+ii.linepos),ii.reason&&(ti+=":  "+ii.reason+")"),new Error(ti);return ei}else if(window.DOMParser){n=new window.DOMParser;try{ei=n.parseFromString(_t,"text/xml")}catch(ai){throw ai.message==="SyntaxError"?new Error(ti):new Error("Erreur lors du parsing de la rponse du service : "+ai.message)}if(ei.getElementsByTagName("parsererror").length>0)for(var ri=ei.getElementsByTagName("parsererror"),ni=0;ni<ri.length;ni++){var si=ri[ni].innerHTML;if(si.indexOf("Huge input lookup")===-1)throw ti+="("+si+")",new Error(ti)}else if(!ei.documentElement)throw new Error(ti);return ei}else throw new Error("Incompatible DOM Parser pour ce navigateur !")}}function __getRootNode(_t){var e;return _t.nodeType===9?e=_t.documentElement:_t.nodeType===1&&(e=_t),e}function __readDefault(_t){var e={};if(_t.attributes.length>0){var n=__getAttributes(_t);e.attributes=n}if(_t.hasChildNodes()){for(var ei={},ti,ii=_t.childNodes,ri=0;ri<ii.length;ri++)if(ti=ii[ri],ti.nodeType===3)e.textContent=ti.nodeValue;else if(ti.nodeType===1)if(ei=__readDefault(ti),!e[ti.nodeName])e[ti.nodeName]=ei;else{if(!Array.isArray(e[ti.nodeName])){var ni=e[ti.nodeName];e[ti.nodeName]=[],e[ti.nodeName].push(ni)}e[ti.nodeName].push(ei)}}return e}function __getAttributes(_t){if(_t.attributes.length>0){for(var e={},n=_t.attributes,ei=0;ei<n.length;ei++){var ti=n[ei];e[ti.nodeName]=ti.nodeValue}return e}}function AltiResponse(){if(!(this instanceof AltiResponse))throw new TypeError("AltiResponse constructor cannot be called as a function.");this.elevations=[]}AltiResponse.prototype={constructor:AltiResponse};function Elevation(){if(!(this instanceof Elevation))throw new TypeError("Elevation constructor cannot be called as a function.");this.z=null}Elevation.prototype={constructor:Elevation};function Measure(){if(!(this instanceof Measure))throw new TypeError("Measure constructor cannot be called as a function.");this.source_name=null,this.source_measure=null,this.z=null,this.acc=null}Measure.prototype={constructor:Measure};var AltiResponseReader={};AltiResponseReader.READERS={elevations:function(_t){var e=new AltiResponse;if(_t.hasChildNodes())for(var n=_t.childNodes,ei,ti,ii=0;ii<n.length;ii++)ei=n[ii],AltiResponseReader.READERS[ei.nodeName]&&(ti=AltiResponseReader.READERS[ei.nodeName](ei),e.elevations.push(ti));return e},elevation:function(_t){var e=new Elevation;if(_t.hasChildNodes())for(var n=_t.childNodes,ei,ti=0;ti<n.length;ti++)ei=n[ti],AltiResponseReader.READERS[ei.nodeName]&&AltiResponseReader.READERS[ei.nodeName](ei,e);return e},lat:function(_t,e){var n=_t.firstChild;if(n&&n.nodeType===3)e.lat=parseFloat(n.nodeValue);else throw new Error("Erreur dans la lecture de la rponse du service : latitude attendue mais absente")},lon:function(_t,e){var n=_t.firstChild;if(n&&n.nodeType===3)e.lon=parseFloat(n.nodeValue);else throw new Error("Erreur dans la lecture de la rponse du service : longitude attendue mais absente")},z:function(_t,e){var n=_t.firstChild;if(n&&n.nodeType===3)if(e)e.z=parseFloat(n.nodeValue);else return e=new Elevation,e.z=parseFloat(n.nodeValue),e;else throw new Error("Erreur dans la lecture de la rponse du service : altitude attendue mais absente")},acc:function(_t,e){var n=_t.firstChild;if(n&&n.nodeType===3)e.acc=parseFloat(n.nodeValue);else throw new Error("Erreur dans la lecture de la rponse du service : prcision (acc) attendue mais absente")},source_name:function(_t,e){var n=_t.firstChild;if(n&&n.nodeType===3)e.source_name=n.nodeValue;else throw new Error("Erreur dans la lecture de la rponse du service : source_name attendue mais absente")},source_measure:function(_t,e){var n=_t.firstChild;if(n&&n.nodeType===3)e.source_measure=n.nodeValue;else throw new Error("Erreur dans la lecture de la rponse du service : source_measure attendue mais absente")},measures:function(_t,e){e.measures=[];var n;if(_t.hasChildNodes())for(var ei=_t.childNodes,ti,ii,ri=0;ri<ei.length;ri++){n=new Measure,ti=ei[ri],ii=ti.childNodes;for(var ni=0;ni<ii.length;ni++)if(AltiResponseReader.READERS[ii[ni].nodeName])AltiResponseReader.READERS[ii[ni].nodeName](ii[ni],n);else throw new Error("Erreur dans la lecture de la rponse du service : measures attendues mais absentes");e.measures.push(n)}},exceptionreport:function(_t){var e={};if(_t.hasChildNodes())for(var n=_t.childNodes,ei,ti=0;ti<n.length;ti++)ei=n[ti],ei.nodeName==="Exception"&&(e.exceptionReport=AltiResponseReader.READERS.exception(ei));return e},exception:function(_t){var e={},n=_t.getAttribute("exceptionCode");n&&(e.exceptionCode=n);var ei=_t.firstChild;return ei&&ei.nodeType===3&&(e.exception=ei.nodeValue),e},error:function(_t){var e={error:{}};if(_t.hasChildNodes())for(var n=_t.childNodes,ei,ti=0;ti<n.length;ti++){ei=n[ti];var ii;ei.nodeType===1&&ei.nodeName==="code"&&(ii=ei.firstChild,ii&&ii.nodeType===3&&(e.error.code=ii.nodeValue)),ei.nodeType===1&&ei.nodeName==="description"&&(ii=ei.firstChild,ii&&ii.nodeType===3&&(e.error.description=ii.nodeValue))}return e}};AltiResponseReader.read=function(_t){if(_t.nodeName==="elevations"){var e=AltiResponseReader.READERS.elevations(_t);return e}else if(_t.nodeName==="ExceptionReport"){var n=AltiResponseReader.READERS.exceptionreport(_t);return n}else if(_t.nodeName==="error"){var ei=AltiResponseReader.READERS.error(_t);return ei}else throw new Error("Erreur lors de la lecture de la rponse : elle n'est pas au format attendu.")};var AltiResponseFactory={build:function(_t){var e=LoggerByDefault$1.getLogger("AltiResponseFactory");e.trace(["AltiResponseFactory::build()"]);var n=null;if(_t.response)if(_t.rawResponse)e.trace("analyze response : raw"),n=_t.response;else{switch(_t.outputFormat){case"xml":e.trace("analyze response : xml");try{var ei=new XML$1({reader:AltiResponseReader});if(typeof _t.response=="string"?ei.setXMLString(_t.response):ei.setXMLDoc(_t.response),n=ei.parse(),!n)throw new Error(MessagesResources.getMessage("SERVICE_RESPONSE_EXCEPTION_2"))}catch(li){var ti=li.message;_t.onError.call(_t.scope,new ErrorService({message:MessagesResources.getMessage("SERVICE_RESPONSE_EXCEPTION",ti),status:200,type:ErrorService.TYPE_SRVERR}));return}break;case"json":e.trace("analyze response : json"),e.trace("analyze response : ",typeof _t.response);var ii=null;if(typeof _t.response=="string"?ii=JSON.parse(_t.response):ii=_t.response,ii&&ii.error){_t.onError.call(_t.scope,new ErrorService({message:MessagesResources.getMessage("SERVICE_RESPONSE_EXCEPTION",ii.error.description),status:200,type:ErrorService.TYPE_SRVERR}));return}if(ii){var ri=ii.elevations,ni=new AltiResponse,si;if(Array.isArray(ri)&&ri.length)for(var ai=0;ai<ri.length;ai++)si=new Elevation,typeof ri[ai]=="object"?(ri[ai].lon&&(si.lon=ri[ai].lon),ri[ai].lat&&(si.lat=ri[ai].lat),ri[ai].z&&(si.z=ri[ai].z),ri[ai].acc&&(si.acc=ri[ai].acc),ri[ai].measures&&(si.measures=ri[ai].measures)):typeof ri[ai]=="number"&&(si.z=ri[ai]),Array.isArray(ni.elevations)&&ni.elevations.push(si);n=ni}if(!n){_t.onError.call(_t.scope,new ErrorService({message:MessagesResources.getMessage("SERVICE_RESPONSE_ANALYSE_2"),type:ErrorService.TYPE_UNKERR,status:-1}));return}break;default:_t.onError.call(_t.scope,new ErrorService({message:MessagesResources.getMessage("SERVICE_RESPONSE_FORMAT_2"),type:ErrorService.TYPE_UNKERR,status:-1}));return}if(n.exceptionReport){_t.onError.call(_t.scope,new ErrorService({message:MessagesResources.getMessage("SERVICE_RESPONSE_EXCEPTION",n.exceptionReport),type:ErrorService.TYPE_SRVERR,status:200}));return}else if(n.error){var oi=n.error.description;_t.onError.call(_t.scope,new ErrorService({message:MessagesResources.getMessage("SERVICE_RESPONSE_EXCEPTION",oi),type:ErrorService.TYPE_SRVERR,status:200}));return}}else{_t.onError.call(_t.scope,new ErrorService(MessagesResources.getMessage("SERVICE_RESPONSE_EMPTY")));return}_t.onSuccess.call(_t.scope,n)}};function Alti(_t){if(!(this instanceof Alti))throw new TypeError(MessagesResources.getMessage("CLASS_CONSTRUCTOR","Alti"));if(this.CLASSNAME="Alti",CommonService.apply(this,arguments),this.logger=LoggerByDefault$1.getLogger("Gp.Services.Alti"),this.logger.trace("[Constructeur Alti (options)]"),!_t.positions)throw new Error(MessagesResources.getMessage("PARAM_MISSING","positions"));if(_t.positions.length===0)throw new Error(MessagesResources.getMessage("PARAM_EMPTY","positions"));if(this.options.positions=_t.positions,this.options.outputFormat=typeof _t.outputFormat=="string"?_t.outputFormat.toLowerCase():"xml",this.options.resource=_t.resource||"ign_rge_alti_wld",this.options.sampling=_t.sampling||null,this.options.api=typeof _t.api=="string"?_t.api.toUpperCase():"REST",this.options.api==="REST"&&(this.options.httpMethod="GET"),this.options.zonly=_t.zonly||!1,this.options.measures=_t.measures||!1,!this.options.serverUrl){var e=DefaultUrlService.Alti.newUrl(),n=null;switch(this.options.api){case"WPS":n=e.wps;break;case"REST":var ei=(_t.sampling?"profil":"elevation")+"-"+this.options.outputFormat;n=e[ei];break;default:throw new Error(MessagesResources.getMessage("PARAM_UNKNOWN","api"))}if(!n)throw new Error("Url by default not found !");this.options.serverUrl=n,this.logger.trace("Server URL by default : "+this.options.serverUrl)}var ti=this.options.serverUrl.lastIndexOf(".");if(ti!==-1){var ii=this.options.serverUrl.substring(ti+1);if(ii&&ii.length<5)switch(this.logger.trace("Server Extension URL : "+ii),ii.toLowerCase()){case"json":case"xml":this.options.outputFormat=ii.toLowerCase();break;default:throw new Error("type of service : unknown or unsupported (json or xml) !")}}}Alti.prototype=Object.create(CommonService.prototype,{});Alti.prototype.constructor=Alti;Alti.prototype.buildRequest=function(_t,e){var n={httpMethod:this.options.httpMethod,onSuccess:function(ei){this.request=ei,e.call(this,this.request)},onError:_t,scope:this,resource:this.options.resource,positions:this.options.positions,outputFormat:this.options.outputFormat,sampling:this.options.sampling,api:this.options.api,zonly:this.options.zonly,measures:this.options.measures};AltiRequestFactory.build(n)};Alti.prototype.analyzeResponse=function(_t,e){if(this.response){var n={response:this.response,outputFormat:this.options.outputFormat,rawResponse:this.options.rawResponse,onError:_t,onSuccess:e,scope:this};AltiResponseFactory.build(n)}else _t.call(this,new ErrorService(MessagesResources.getMessage("SERVICE_RESPONSE_EMPTY")))};function GeocodeParamREST(_t){if(!(this instanceof GeocodeParamREST))throw new TypeError("GeocodeParamREST constructor cannot be called as a function.");if(this.logger=LoggerByDefault$1.getLogger(),this.logger.trace("[Constructeur GeocodeParamREST ()]"),this.options=_t||{},!this.options.geocodeMethod||this.options.geocodeMethod!=="search"&&this.options.geocodeMethod!=="reverse")throw new Error("Error geocodeMethod not valid");this.geocodeMethod=this.options.geocodeMethod,this.query=typeof this.options<"u"?this.options.query:null,this.searchGeometry=this.options.searchGeometry||null,this.index=this.options.index||null,this.lon=this.options.position&&this.options.position.lon?this.options.position.lon:null,this.lat=this.options.position&&this.options.position.lat?this.options.position.lat:null,this.maxResp=this.options.maxResp||null,this.returnTrueGeometry=this.options.returnTrueGeometry||null,this.filters=this.options.filters||{}}GeocodeParamREST.CLASSNAME="GeocodeParamREST";GeocodeParamREST.prototype={constructor:GeocodeParamREST,getFilters:function(){var _t={};for(var e in this.filters)this.filters.hasOwnProperty(e)&&(_t[e]=this.filters[e]);return _t},getIndex:function(){return this.index===void 0?null:this.index==="StreetAddress"?"address":this.index==="CadastralParcel"?"parcel":this.index==="PositionOfInterest"?"poi":this.index==="location"?"location":this.index},getSearchGeometry:function(){return JSON.stringify(this.searchGeometry)}};GeocodeParamREST.prototype.getParams=function(){var _t=[];this.geocodeMethod==="search"&&_t.push({k:"q",v:this.query}),this.index&&_t.push({k:"index",v:this.getIndex()}),this.geocodeMethod==="reverse"&&this.searchGeometry&&_t.push({k:"searchgeom",v:this.getSearchGeometry()}),this.lon&&this.lat&&(_t.push({k:"lon",v:this.lon}),_t.push({k:"lat",v:this.lat})),this.maxResp&&_t.push({k:"limit",v:this.maxResp}),this.returnTrueGeometry&&_t.push({k:"returntruegeometry",v:this.returnTrueGeometry});const e=this.getFilters();for(var n in e)_t.push({k:n,v:e[n]});return _t};function GeocodeRequestREST(_t){if(this.logger=LoggerByDefault$1.getLogger("GeocodeRequestREST"),this.logger.trace("[Constructeur GeocodeRequestREST ()]"),!(this instanceof GeocodeRequestREST))throw new TypeError("GeocodeRequestREST constructor cannot be called as a function.");if(!_t)throw new Error(MessagesResources.getMessage("PARAM_EMPTY","options"));this.settings=_t}GeocodeRequestREST.prototype={requestString:null,constructor:GeocodeRequestREST,processRequestString:function(){var _t="";const n=new GeocodeParamREST(this.settings).getParams();for(var ei=0;ei<n.length;ei++){var ti=n[ei];_t&&(_t+="&"),_t+=ti.k+"="+ti.v}if(!this.settings.geocodeMethod||this.settings.geocodeMethod!=="search"&&this.settings.geocodeMethod!=="reverse")throw new Error("Error geocodeMethod not valid");return this.requestString="?"+_t,this.logger.trace(this.requestString),this.requestString}};var GeocodeRequestFactory={build:function(_t){var e=LoggerByDefault$1.getLogger("GeocodeRequestFactory");e.trace(["GeocodeRequestFactory::build()"]);var n=_t||{},ei=new GeocodeRequestREST(n);if(!ei.processRequestString())throw new Error("Error process request (rest) !");var ti=ei.requestString;return e.trace(ti),ti}};function GeocodeResponse(){if(!(this instanceof GeocodeResponse))throw new TypeError("GeocodeResponse constructor cannot be called as a function.");this.locations=[]}GeocodeResponse.prototype={constructor:GeocodeResponse};function GeocodedLocation(){if(!(this instanceof GeocodedLocation))throw new TypeError("GeocodedLocation constructor cannot be called as a function.");this.position=null,this.matchType=null,this.placeAttributes={},this.type=null,this.accuracy=null,this.CLASSNAME="GeocodedLocation"}GeocodedLocation.prototype={constructor:GeocodedLocation};function GeocodeResponseParser(){if(!(this instanceof GeocodeResponseParser))throw new TypeError("GeocodeResponseParser constructor cannot be called as a function.")}GeocodeResponseParser.prototype={constructor:GeocodeResponseParser,parse:function(_t){var e=new GeocodeResponse;const n=JSON.parse(_t);if(n.type==="FeatureCollection")for(var ei=0;ei<n.features.length;++ei)_parseFeature(n.features[ei],e);else if(n.type==="Feature")_parseFeature(n,e);else{if(n.type==="SERVICE_ERROR")return _parseError(n);var ti=MessagesResources.getMessage("SERVICE_RESPONSE_ANALYSE",n.type);throw new ErrorService({message:ti,type:ErrorService.TYPE_UNKERR,status:200})}return e}};function _parseFeature(_t,e){var n=new GeocodedLocation;if(_t.geometry&&_t.geometry.type==="Point"&&(n.position={lon:_t.geometry.coordinates[0],lat:_t.geometry.coordinates[1]}),_t.properties){for(var ei in _t.properties)ei==="score"?n.accuracy=_t.properties[ei]:ei==="_type"?_t.properties[ei]==="address"?n.type="StreetAddress":_t.properties[ei]==="poi"?n.type="PositionOfInterest":(_t.properties[ei]==="parcel"||_t.properties[ei]==="cadastral")&&(n.type="CadastralParcel"):n.placeAttributes[ei]=_t.properties[ei];_t.properties._type==="address"&&(n.matchType=_t.properties.number!==void 0&&_t.properties.number!==null?"street number":"street")}e.locations.push(n)}function _parseError(_t){return{exceptionReport:_t}}var GeocodeReponseFactory={build:function(_t){var e=null;if(_t.response)if(_t.rawResponse)e=_t.response;else{try{if(e=new GeocodeResponseParser().parse(_t.response),!e)throw new Error("L'analyse de la rponse du service !?")}catch(ei){var n=ei.message;typeof _t.response=="string"?n+="('"+_t.response+"')":n+="('"+_t.response.documentElement.innerHTML+"')",_t.onError.call(_t.scope,new ErrorService({message:MessagesResources.getMessage("SERVICE_RESPONSE_ANALYSE",n),type:ErrorService.TYPE_UNKERR,status:-1}));return}if(e.exceptionReport){_t.onError.call(_t.scope,new ErrorService({message:MessagesResources.getMessage("SERVICE_RESPONSE_EXCEPTION",e.exceptionReport),type:ErrorService.TYPE_SRVERR,status:200}));return}}else{_t.onError.call(_t.scope,new ErrorService({message:MessagesResources.getMessage("SERVICE_RESPONSE_EMPTY"),type:ErrorService.TYPE_SRVERR,status:-1}));return}_t.onSuccess.call(_t.scope,e)}};function Geocode(_t){if(!(this instanceof Geocode))throw new TypeError(MessagesResources.getMessage("CLASS_CONSTRUCTOR","Geocode"));this.CLASSNAME="Geocode",this.logger=LoggerByDefault$1.getLogger("Gp.Services.Geocode"),this.logger.trace("[Constructeur Geocode (options)]");var e=this.patchOptionConvertor(_t);if(e.serverUrl||(e.serverUrl=DefaultUrlService.Geocode.newUrl()),CommonService.apply(this,[e]),!e.hasOwnProperty("query"))throw new Error(MessagesResources.getMessage("PARAM_MISSING","query"));if(this.options.query=e.query,e.index||(this.options.index=e.index="StreetAddress"),e.filters)for(var n=Object.keys(e.filters),ei=0;ei<n.length;ei++){var ti=n[ei];(typeof e.filters[ti]>"u"||typeof e.filters[ti]=="object"&&Object.keys(e.filters[ti]).length===0||typeof e.filters[ti]=="string"&&e.filters[ti].length===0||Array.isArray(e.filters[ti])&&e.filters[ti].length===0)&&delete this.options.filters[ti]}this.options.index=e.index||"StreetAddress",this.options.maximumResponses=e.maximumResponses||20}Geocode.prototype=Object.create(CommonService.prototype,{});Geocode.prototype.constructor=Geocode;Geocode.prototype.patchOptionConvertor=function(_t){const e=_t;return e.hasOwnProperty("location")&&(this.logger.warn("The parameter 'location' is deprecated"),e.query||(e.query=e.location),delete e.location),e.filterOptions&&(this.logger.warn("The parameter 'filterOptions' is deprecated"),e.filters||(e.filters=e.filterOptions,e.filters.type&&(this.logger.warn("The parameter 'filterOptions.type' is deprecated"),e.index||(Array.isArray(e.filters.type)&&e.filters.type.length>0?e.index=e.filters.type[0]:e.index=e.filters.type),delete e.filters.type),e.filters.bbox&&(this.logger.warn("The parameter 'filterOptions.bbox' is deprecated"),delete e.filters.bbox)),delete e.filterOptions),e.position&&(e.position.x&&(this.logger.warn("The parameter 'position.x' is deprecated"),e.position.lon||(e.position.lon=e.position.x),delete e.position.x),e.position.y&&(this.logger.warn("The parameter 'position.y' is deprecated"),e.position.lat||(e.position.lat=e.position.y),delete e.position.y)),e.returnFreeForm&&(this.logger.warn("The parameter 'returnFreeForm' is deprecated"),delete e.returnFreeForm),e.srs&&(this.logger.warn("The parameter 'srs' is deprecated"),delete e.srs),e};Geocode.prototype.buildRequest=function(_t,e){var n={httpMethod:this.options.httpMethod,geocodeMethod:"search",query:this.options.query,index:this.options.index,returnTrueGeometry:this.options.returnTrueGeometry,position:this.options.position,maxResp:this.options.maximumResponses,filters:this.options.filters};this.request=GeocodeRequestFactory.build(n),this.request?e.call(this,this.request):_t.call(this,new ErrorService(MessagesResources.getMessage("SERVICE_REQUEST_BUILD")))};Geocode.prototype.analyzeResponse=function(_t,e){if(this.response){var n={response:this.response,rawResponse:this.options.rawResponse,onError:_t,onSuccess:e,scope:this};GeocodeReponseFactory.build(n)}else _t.call(this,new ErrorService(MessagesResources.getMessage("SERVICE_RESPONSE_EMPTY")))};function ReverseGeocode$1(_t){if(!(this instanceof ReverseGeocode$1))throw new TypeError(MessagesResources.getMessage("CLASS_CONSTRUCTOR","ReverseGeocode"));this.CLASSNAME="ReverseGeocode",this.logger=LoggerByDefault$1.getLogger("Gp.Services.ReverseGeocode"),this.logger.trace("[Constructeur ReverseGeocode (options)]");var e=this.patchOptionConvertor(_t);if(e.serverUrl||(e.serverUrl=DefaultUrlService.ReverseGeocode.newUrl()),CommonService.apply(this,[e]),e.searchGeometry)this.options.searchGeometry=e.searchGeometry;else if(!e.position)throw new Error(MessagesResources.getMessage("PARAM_MISSING","searchGeometry"));if(e.index||(this.options.index=e.index="StreetAddress"),e.filters)for(var n=Object.keys(e.filters),ei=0;ei<n.length;ei++){var ti=n[ei];(typeof e.filters[ti]>"u"||typeof e.filters[ti]=="object"&&Object.keys(e.filters[ti]).length===0||typeof e.filters[ti]=="string"&&e.filters[ti].length===0||Array.isArray(e.filters[ti])&&e.filters[ti].length===0)&&delete this.options.filters[ti]}this.options.position=e.position,this.options.index=e.index||"StreetAddress",this.options.maximumResponses=e.maximumResponses||20}ReverseGeocode$1.prototype=Object.create(CommonService.prototype,{});ReverseGeocode$1.prototype.constructor=ReverseGeocode$1;ReverseGeocode$1.prototype.patchOptionConvertor=function(_t){var e=_t;return e.filterOptions&&(this.logger.warn("The parameter 'filterOptions' is deprecated"),e.filterOptions.type&&(this.logger.warn("The parameter 'filterOptions.type' is deprecated"),e.index||(Array.isArray(e.filterOptions.type)&&e.filterOptions.type.length>0?e.index=e.filterOptions.type[0]:e.index=e.filterOptions.type),delete e.filterOptions.type),e.filterOptions.bbox&&(this.logger.warn("The parameter 'filterOptions.bbox' is deprecated"),e.searchGeometry||(e.searchGeometry=this.bbox2Json(e.filterOptions.bbox)),delete e.filterOptions.bbox),e.filterOptions.circle&&(this.logger.warn("The parameter 'filterOptions.circle' is deprecated"),e.searchGeometry||(e.searchGeometry=this.circle2Json(e.filterOptions.circle)),delete e.filterOptions.circle),e.filterOptions.polygon&&(this.logger.warn("The parameter 'filterOptions.polygon' is deprecated"),e.searchGeometry||(e.searchGeometry=this.polygon2Json(e.filterOptions.polygon)),delete e.filterOptions.polygon),!e.filters&&Object.keys(e.filterOptions).length>0&&(e.filters=e.filterOptions),delete e.filterOptions),e.position&&(e.position.x&&(this.logger.warn("The parameter 'position.x' is deprecated"),e.position.lon||(e.position.lon=e.position.x),delete e.position.x),e.position.y&&(this.logger.warn("The parameter 'position.y' is deprecated"),e.position.lat||(e.position.lat=e.position.y),delete e.position.y)),e.srs&&(this.logger.warn("The parameter 'srs' is deprecated"),delete e.srs),e};ReverseGeocode$1.prototype.buildRequest=function(_t,e){var n={httpMethod:this.options.httpMethod,geocodeMethod:"reverse",searchGeometry:this.options.searchGeometry,index:this.options.index,position:this.options.position,returnTrueGeometry:this.options.returnTrueGeometry,maxResp:this.options.maximumResponses,filters:this.options.filters};this.request=GeocodeRequestFactory.build(n),this.request?e.call(this,this.request):_t.call(this,new ErrorService(MessagesResources.getMessage("SERVICE_REQUEST_BUILD")))};ReverseGeocode$1.prototype.analyzeResponse=function(_t,e){if(this.response){var n={response:this.response,rawResponse:this.options.rawResponse,onError:_t,onSuccess:e,scope:this};GeocodeReponseFactory.build(n)}else _t.call(this,new ErrorService(MessagesResources.getMessage("SERVICE_RESPONSE_EMPTY")))};ReverseGeocode$1.prototype.bbox2Json=function(_t){return{type:"Polygon",coordinates:[[[_t.left,_t.top],[_t.right,_t.top],[_t.right,_t.bottom],[_t.left,_t.bottom],[_t.left,_t.top]]]}};ReverseGeocode$1.prototype.circle2Json=function(_t){return{type:"Circle",radius:_t.radius,coordinates:[_t.x,_t.y]}};ReverseGeocode$1.prototype.polygon2Json=function(_t){for(var e={type:"Polygon",coordinates:[[]]},n=0;n<_t.length;++n)e.coordinates[0].push([_t[n].x,_t[n].y]);return e};ReverseGeocode$1.geoEPSG=["EPSG:4326"];function AutoCompleteResponse(){if(!(this instanceof AutoCompleteResponse))throw new TypeError("AutoCompleteResponse constructor cannot be called as a function.");this.suggestedLocations=[]}AutoCompleteResponse.prototype={constructor:AutoCompleteResponse};function SuggestedLocation(){if(!(this instanceof SuggestedLocation))throw new TypeError("SuggestedLocation constructor cannot be called as a function.");this.type=null,this.position={x:null,y:null},this.commune=null,this.fullText=null,this.postalCode=null,this.classification=null,this.street=null,this.poi=null,this.kind=null}SuggestedLocation.prototype={constructor:SuggestedLocation};var AutoCompleteResponseFactory={build:function(_t){var e=LoggerByDefault$1.getLogger("AutoCompleteResponseFactory");e.trace(["AutoCompleteResponseFactory::build()"]);var n=null;if(_t.response)if(_t.rawResponse)e.trace("analyze response : raw"),n=_t.response;else{var ei=null;if(typeof _t.response=="string"?ei=JSON.parse(_t.response):ei=_t.response,ei){if(ei.error){_t.onError.call(_t.scope,new ErrorService({message:MessagesResources.getMessage("SERVICE_RESPONSE_EXCEPTION",ei.error.description),status:ei.error.code,type:ErrorService.TYPE_SRVERR}));return}if(n=new AutoCompleteResponse,ei.results&&Array.isArray(ei.results))for(var ti=null,ii=0;ii<ei.results.length;ii++){var ri=ei.results[ii];ti=new SuggestedLocation,ri&&(ri.country==="StreetAddress"?(ti.street=ri.street,ti.type="StreetAddress"):ri.country==="PositionOfInterest"&&(ti.poi=ri.street,ti.type="PositionOfInterest",ti.poiType=ri.poiType),ti.position&&(ti.position.x=ri.x,ti.position.y=ri.y),ti.kind=ri.kind,ti.commune=ri.city,ti.fullText=ri.fulltext,ti.postalCode=ri.zipcode,ti.classification=ri.classification),n.suggestedLocations.push(ti)}else{_t.onError.call(_t.scope,new ErrorService(MessagesResources.getMessage("SERVICE_RESPONSE_FORMAT_3")));return}if(!n.suggestedLocations.length){_t.onError.call(_t.scope,new ErrorService(MessagesResources.getMessage("SERVICE_RESPONSE_FORMAT_3")));return}}if(!n){_t.onError.call(_t.scope,new ErrorService({message:MessagesResources.getMessage("SERVICE_RESPONSE_ANALYSE_2"),type:ErrorService.TYPE_UNKERR,status:-1}));return}if(n.exceptionReport){_t.onError.call(_t.scope,new ErrorService({message:MessagesResources.getMessage("SERVICE_RESPONSE_EXCEPTION",n.exceptionReport),type:ErrorService.TYPE_SRVERR,status:200}));return}}else{_t.onError.call(_t.scope,new ErrorService(MessagesResources.getMessage("SERVICE_RESPONSE_EMPTY")));return}_t.onSuccess.call(_t.scope,n)}};function AutoComplete(_t){if(!(this instanceof AutoComplete))throw new TypeError(MessagesResources.getMessage("CLASS_CONSTRUCTOR","AutoComplete"));this.CLASSNAME="AutoComplete",this.logger=LoggerByDefault$1.getLogger("Gp.Services.AutoComplete"),this.logger.trace("[Constructeur AutoComplete (options)]");var e=this.patchOptionConvertor(_t);if(e.serverUrl||(e.serverUrl=DefaultUrlService.AutoComplete.newUrl()),CommonService.apply(this,arguments),!e.text)throw new Error(MessagesResources.getMessage("PARAM_MISSING","text"));this.options.text=e.text,e.type||(e.type=["StreetAddress,PositionOfInterest"]),this.options.type=e.type,this.options.territory=e.terr||"",this.options.maximumResponses=e.maximumResponses||10,this.options.protocol==="XHR"&&this.options.httpMethod==="POST"&&(this.logger.warn("Le service ne gre pas le mode d'interrogation en POST, on bascule sur du GET !"),this.options.httpMethod="GET"),this.options.outputFormat=this.options.rawResponse?"":"json"}AutoComplete.prototype=Object.create(CommonService.prototype,{});AutoComplete.prototype.constructor=AutoComplete;AutoComplete.prototype.patchOptionConvertor=function(_t){const e=_t;return e.filterOptions&&(this.logger.warn("The parameter 'filterOptions' is deprecated"),e.filterOptions.type&&(this.logger.warn("The parameter 'filterOptions.type' is deprecated"),e.type||(e.type=e.filterOptions.type)),e.filterOptions.territory&&(this.logger.warn("The parameter 'filterOptions.territory' is deprecated"),e.terr||(e.terr=e.filterOptions.territory)),delete e.filterOptions),e};AutoComplete.prototype.buildRequest=function(_t,e){var n="";this.options.territory&&(n=this.options.territory);var ei="";this.options.type&&(ei=this.options.type.join(",")),this.request=Helper$1.normalyzeParameters({text:encodeURIComponent(this.options.text),type:ei,terr:n,maximumResponses:this.options.maximumResponses}),this.request?e.call(this,this.request):_t.call(this,new ErrorService(MessagesResources.getMessage("SERVICE_REQUEST_BUILD")))};AutoComplete.prototype.analyzeResponse=function(_t,e){if(this.response){var n={response:this.response,rawResponse:this.options.rawResponse,onSuccess:e,onError:_t,scope:this};AutoCompleteResponseFactory.build(n)}else _t.call(this,new ErrorService(MessagesResources.getMessage("SERVICE_RESPONSE_EMPTY")))};function RouteParamREST(_t){if(!(this instanceof RouteParamREST))throw new TypeError("RouteParamREST constructor cannot be called as a function.");this.logger=LoggerByDefault$1.getLogger(),this.logger.trace("[Constructeur RouteParamREST ()]"),this.options=_t||{},this.resource=this.options.resource,this.start=this.options.startPoint.x+","+this.options.startPoint.y,this.end=this.options.endPoint.x+","+this.options.endPoint.y,this.intermediates=this.options.viaPoints,this.profile=this.options.graph,this.crs=this.options.srs,this.constraints=this.options.constraints,this.optimization=this.options.routePreference,this.getSteps=this.options.geometryInInstructions?"true":"false",this.distanceUnit=this.options.distanceUnit,this.timeUnit=this.options.timeUnit,this.waysAttributes=this.options.waysAttributes}RouteParamREST.CLASSNAME="RouteParamREST";RouteParamREST.prototype={constructor:RouteParamREST,getIntermediates:function(){var _t=[];if(this.intermediates.length!==0)for(var e=0;e<this.intermediates.length;e++){var n=this.intermediates[e];_t.push(n.x+","+n.y)}return _t.join("|")},getWaysAttributes:function(){return this.waysAttributes.join("|")},getProfile:function(){return this.profile},getDistanceUnit:function(){return this.distanceUnit==="m"?"meter":this.distanceUnit==="km"?"kilometer":""},getOptimization:function(){return this.optimization?this.optimization:""},getConstraints:function(){var _t=[];if(this.constraints.length!==0)for(var e=0;e<this.constraints.length;e++)_t.push(JSON.stringify(this.constraints[e]));return _t.join("|")}};RouteParamREST.prototype.getParams=function(){var _t=[];return _t.push({k:"resource",v:this.resource}),_t.push({k:"start",v:this.start}),_t.push({k:"end",v:this.end}),_t.push({k:"geometryFormat",v:"geojson"}),this.optimization&&_t.push({k:"optimization",v:this.getOptimization()}),this.intermediates&&_t.push({k:"intermediates",v:this.getIntermediates()}),this.profile&&_t.push({k:"profile",v:this.getProfile()}),this.constraints&&_t.push({k:"constraints",v:this.getConstraints()}),this.crs&&_t.push({k:"crs",v:this.crs}),this.distanceUnit&&_t.push({k:"distanceUnit",v:this.getDistanceUnit()}),this.timeUnit&&_t.push({k:"timeUnit",v:this.timeUnit}),this.waysAttributes&&_t.push({k:"waysAttributes",v:this.getWaysAttributes()}),_t};function RouteRequestREST(_t){if(this.logger=LoggerByDefault$1.getLogger("RouteRequestREST"),this.logger.trace("[Constructeur RouteRequestREST ()]"),!(this instanceof RouteRequestREST))throw new TypeError("RouteRequestREST constructor cannot be called as a function.");if(!_t)throw new Error(MessagesResources.getMessage("PARAM_EMPTY","options"));this.settings=_t}RouteRequestREST.prototype={requestString:null,constructor:RouteRequestREST,processRequestString:function(){this.logger.warn(" PROTOTYPE !");for(var _t=new RouteParamREST(this.settings),e=_t.getParams(),n="",ei=0;ei<e.length;ei++){var ti=e[ei];n&&(n+="&"),n+=ti.k+"="+ti.v}return this.logger.trace(n),this.requestString=n,this.requestString}};var RouteRequestFactory={build:function(_t){var e=LoggerByDefault$1.getLogger("RouteRequestFactory");e.trace(["RouteRequestFactory::build()"]);var n=null,ei=_t||{},ti=_t.onError!==null&&typeof _t.onError=="function",ii=null,ri=new RouteRequestREST(ei);if(!ri.processRequestString()){if(ii="Error process request (rest) !",ti){_t.onError.call(_t.scope,new ErrorService(ii));return}throw new Error(ii)}return n=ri.requestString,n}};function RouteResponse(){if(!(this instanceof RouteResponse))throw new TypeError("RouteResponse constructor cannot be called as a function.");this.totalTime=null,this.totalDistance=null,this.bbox={left:null,right:null,top:null,bottom:null},this.routeGeometry=null,this.routeInstructions=[]}RouteResponse.prototype={constructor:RouteResponse};function RouteInstruction(){if(!(this instanceof RouteInstruction))throw new TypeError("RouteInstruction constructor cannot be called as a function.");this.duration=null,this.distance=null,this.code=null,this.instruction=null,this.geometry=null}RouteInstruction.prototype={constructor:RouteInstruction};var RouteResponseFactory={build:function(_t){var e=LoggerByDefault$1.getLogger("RouteResponseFactory");e.trace("RouteResponseFactory::build()");var n=null;if(_t.response)if(_t.rawResponse)e.trace("analyze response : raw"),n=_t.response;else{e.trace("analyze response : json");var ei;if(typeof _t.response=="string"?ei=JSON.parse(_t.response):ei=_t.response,ei){if(ei.message){_t.onError.call(_t.scope,new ErrorService(MessagesResources.getMessage("SERVICE_RESPONSE_EXCEPTION",ei.message)));return}var ti=[],ii=[],ri=[];if(n=new RouteResponse,n.hasOwnProperty("totalTime")&&(n.totalTime=parseFloat(ei.duration)),n.hasOwnProperty("totalDistance")&&(n.totalDistance=parseFloat(ei.distance)),n.hasOwnProperty("bbox")&&(n.bbox.left=parseFloat(ei.bbox[0]),n.bbox.bottom=parseFloat(ei.bbox[1]),n.bbox.right=parseFloat(ei.bbox[2]),n.bbox.top=parseFloat(ei.bbox[3])),n.hasOwnProperty("routeGeometry")&&!_t.geometryInInstructions&&(n.routeGeometry=ei.geometry),n.hasOwnProperty("routeInstructions")&&_t.geometryInInstructions){var ni=ei.portions,si;if(Array.isArray(ni)&&ni.length)for(si=0;si<ni.length;si++)ti.push(ni[si]);if(ti.length)for(si=0;si<ti.length;si++)ii.push(ti[si].steps);if(ii.length)for(si=0;si<ii.length;si++)ri=ri.concat(ii[si]);ri.forEach(function(ai){switch(n.routeInstructions.push(new RouteInstruction),n.routeInstructions[n.routeInstructions.length-1].duration=ai.duration,n.routeInstructions[n.routeInstructions.length-1].distance=ai.distance,n.routeInstructions[n.routeInstructions.length-1].code="",n.routeInstructions[n.routeInstructions.length-1].instruction="",n.routeInstructions[n.routeInstructions.length-1].geometry=ai.geometry,ai.name==="Valeur non renseigne"&&(ai.name=""),ai.instruction.type){case"turn":n.routeInstructions[n.routeInstructions.length-1].instruction+="Tourner";break;case"new name":n.routeInstructions[n.routeInstructions.length-1].instruction+="Continuer tout droit";break;case"depart":n.routeInstructions[n.routeInstructions.length-1].instruction+="Dpart";break;case"arrive":n.routeInstructions[n.routeInstructions.length-1].instruction+="Arrive";break;case"merge":n.routeInstructions[n.routeInstructions.length-1].instruction+="Rejoindre";break;case"ramp":n.routeInstructions[n.routeInstructions.length-1].instruction+="Prendre la bretelle";break;case"on ramp":n.routeInstructions[n.routeInstructions.length-1].instruction+="Prendre la bretelle";break;case"off ramp":n.routeInstructions[n.routeInstructions.length-1].instruction+="Prendre la sortie";break;case"fork":n.routeInstructions[n.routeInstructions.length-1].instruction+="Sur la bifurcation, prendre";break;case"end of road":n.routeInstructions[n.routeInstructions.length-1].instruction+=" la fin de la route, prendre";break;case"use lane":n.routeInstructions[n.routeInstructions.length-1].instruction+="Utiliser la file";break;case"continue":n.routeInstructions[n.routeInstructions.length-1].instruction+="Continuer";break;case"roundabout":n.routeInstructions[n.routeInstructions.length-1].instruction+="Au rond-point";break;case"rotary":n.routeInstructions[n.routeInstructions.length-1].instruction+="Au rond-point";break;case"roundabout turn":n.routeInstructions[n.routeInstructions.length-1].instruction+="Au rond point, tourner";break;case"notification":n.routeInstructions[n.routeInstructions.length-1].instruction+="";break;default:n.routeInstructions[n.routeInstructions.length-1].instruction+="?"+ai.instruction.type+"?";break}if(ai.instruction.modifier)switch(ai.instruction.modifier){case"uturn":n.routeInstructions[n.routeInstructions.length-1].instruction="Faire demi-tour";break;case"sharp right":n.routeInstructions[n.routeInstructions.length-1].instruction+=" compltement  droite";break;case"right":n.routeInstructions[n.routeInstructions.length-1].instruction+="  droite";break;case"slight right":n.routeInstructions[n.routeInstructions.length-1].instruction+=" lgrement  droite";break;case"straight":n.routeInstructions[n.routeInstructions.length-1].instruction="Continuer tout droit";break;case"slight left":n.routeInstructions[n.routeInstructions.length-1].instruction+=" lgrement  gauche";break;case"left":n.routeInstructions[n.routeInstructions.length-1].instruction+="  gauche";break;case"sharp left":n.routeInstructions[n.routeInstructions.length-1].instruction+=" compltement  gauche";break;default:n.routeInstructions[n.routeInstructions.length-1].instruction+=" ?"+ai.instruction.modifier+"?";break}ai.instruction.exit&&(n.routeInstructions[n.routeInstructions.length-1].instruction+=`${ai.instruction.exit}e sortie`),ai.attributes.name&&((ai.attributes.name.nom_1_droite||ai.attributes.name.toponyme)&&(n.routeInstructions[n.routeInstructions.length-1].instruction+=" sur"),ai.attributes.name.nom_1_droite&&(n.routeInstructions[n.routeInstructions.length-1].instruction+=` ${ai.attributes.name.nom_1_droite}`),ai.attributes.name.toponyme&&(n.routeInstructions[n.routeInstructions.length-1].instruction+=` ${ai.attributes.name.toponyme}`))})}}if(!n){_t.onError.call(_t.scope,new ErrorService(MessagesResources.getMessage("SERVICE_RESPONSE_ANALYSE","json")));return}if(n.exceptionReport){_t.onError.call(_t.scope,new ErrorService(MessagesResources.getMessage("SERVICE_RESPONSE_EXCEPTION_2")));return}}else{_t.onError.call(_t.scope,new ErrorService(MessagesResources.getMessage("SERVICE_RESPONSE_EMPTY")));return}_t.onSuccess.call(_t.scope,n)}};function Route$1(_t){if(!(this instanceof Route$1))throw new TypeError(MessagesResources.getMessage("CLASS_CONSTRUCTOR","Route"));if(this.CLASSNAME="Route",CommonService.apply(this,arguments),this.logger=LoggerByDefault$1.getLogger("Gp.Services.Route"),this.logger.trace("[Constructeur Route (options)]"),!_t.startPoint)throw new Error(MessagesResources.getMessage("PARAM_MISSING","startPoint"));if(_t.startPoint.x===null)throw new Error(MessagesResources.getMessage("PARAM_MISSING","startPoint.x"));if(_t.startPoint.y===null)throw new Error(MessagesResources.getMessage("PARAM_MISSING","startPoint.y"));if(!_t.endPoint)throw new Error(MessagesResources.getMessage("PARAM_MISSING","endPoint"));if(_t.endPoint.x===null)throw new Error(MessagesResources.getMessage("PARAM_MISSING","endPoint.x"));if(_t.endPoint.y===null)throw new Error(MessagesResources.getMessage("PARAM_MISSING","endPoint.y"));if(_t.outputFormat&&_t.outputFormat!=="json"&&this.logger.warn("options.outputFormat could only be json"),this.options.outputFormat="json",this.options.resource=_t.resource||"bdtopo-osrm",this.options.startPoint=_t.startPoint,this.options.endPoint=_t.endPoint,this.options.viaPoints=_t.viaPoints||[],this.options.routePreference=_t.routePreference||"fastest",_t.graph?(_t.graph==="Voiture"&&(this.options.graph="car"),_t.graph==="Pieton"&&(this.options.graph="pedestrian")):this.options.graph="car",this.options.constraints=[],_t.constraints)if(Array.isArray(_t.constraints))for(var e=0;e<_t.constraints.length;e++)this.options.constraints.push(_t.constraints[e]);else throw new Error(MessagesResources.getMessage("PARAM_TYPE","constraints"));var n={},ei={},ti={};if(_t.exclusions&&_t.exclusions.length!==0){this.logger.warn("options.exclusions is DEPRECATED !!");for(var ii=0;ii<_t.exclusions.length;ii++){if(typeof _t.exclusions[ii]=="string")_t.exclusions[ii]=_t.exclusions[ii].toLowerCase();else continue;_t.exclusions[ii]==="toll"&&(ti.constraintType="banned",ti.key="wayType",ti.operator="=",ti.value="autoroute",this.options.constraints.push(ti)),_t.exclusions[ii]==="tunnel"&&(n.constraintType="banned",n.key="wayType",n.operator="=",n.value="tunnel",this.options.constraints.push(n)),_t.exclusions[ii]==="bridge"&&(ei.constraintType="banned",ei.key="wayType",ei.operator="=",ei.value="pont",this.options.constraints.push(ei))}}if(this.options.geometryInInstructions=_t.geometryInInstructions||!1,this.options.provideBbox=_t.provideBbox||!0,this.options.distanceUnit=_t.distanceUnit||"m",this.options.timeUnit=_t.timeUnit||"second",this.options.expectedStartTime=null,this.options.srs=_t.srs||"EPSG:4326",this.options.waysAttributes=_t.waysAttributes||[],!this.options.serverUrl){var ri=DefaultUrlService.Route.newUrl();if(!ri)throw new Error("Url by default not found !");this.options.serverUrl=ri,this.logger.trace("Serveur URL par defaut : "+this.options.serverUrl)}}Route$1.prototype=Object.create(CommonService.prototype,{});Route$1.prototype.constructor=Route$1;Route$1.prototype.buildRequest=function(_t,e){var n={resource:this.options.resource,startPoint:this.options.startPoint,endPoint:this.options.endPoint,viaPoints:this.options.viaPoints,provideBbox:this.options.provideBbox,constraints:this.options.constraints,distanceUnit:this.options.distanceUnit,timeUnit:this.options.timeUnit,graph:this.options.graph,geometryInInstructions:this.options.geometryInInstructions,routePreference:this.options.routePreference,srs:this.options.srs,waysAttributes:this.options.waysAttributes};this.request=RouteRequestFactory.build(n),this.request?e.call(this,this.request):_t.call(this,new ErrorService(MessagesResources.getMessage("SERVICE_REQUEST_BUILD")))};Route$1.prototype.analyzeResponse=function(_t,e){if(this.response){var n={distanceUnit:this.options.distanceUnit,timeUnit:this.options.timeUnit,response:this.response,outputFormat:this.options.outputFormat,rawResponse:this.options.rawResponse,onError:_t,onSuccess:e,scope:this,geometryInInstructions:this.options.geometryInInstructions};RouteResponseFactory.build(n)}else _t.call(this,new ErrorService(MessagesResources.getMessage("SERVICE_RESPONSE_EMPTY")))};function ProcessIsoCurveParam(_t){if(!(this instanceof ProcessIsoCurveParam))throw new TypeError("ProcessIsoCurveParam constructor cannot be called as a function.");this.logger=LoggerByDefault$1.getLogger(),this.logger.trace("[Constructeur ProcessIsoCurveParam ()]"),this.options=_t||{},this.id=this.options.id,this.resource=this.options.resource,this.point=this.options.position,this.crs=this.options.srs,this.profile=this.options.graph,this.constraints=this.options.constraints,this.reverse=this.options.reverse,this.timeUnit=this.options.timeUnit,this.distanceUnit=this.options.distanceUnit,this.options.method==="distance"?(this.costType="distance",this.costValue=this.options.distance,this.distanceUnit==="m"&&this.costValue>=5e4&&(this.distanceUnit="km",this.costValue/=1e3)):(this.costType="time",this.costValue=this.options.time)}ProcessIsoCurveParam.CLASSNAME="ProcessIsoCurveParam";ProcessIsoCurveParam.prototype={constructor:ProcessIsoCurveParam,getLocation:function(){return this.point.x+","+this.point.y},getDistanceUnit:function(){return this.distanceUnit==="m"?"meter":this.distanceUnit==="km"?"kilometer":""},getConstraints:function(){var _t=[];if(this.constraints.length!==0)for(var e=0;e<this.constraints.length;e++)_t.push(JSON.stringify(this.constraints[e]));return _t.join("|")},getDirection:function(){return this.reverse?"arrival":"departure"}};ProcessIsoCurveParam.prototype.getParams=function(){var _t=[];return _t.push({k:"resource",v:this.resource}),_t.push({k:"point",v:this.getLocation()}),_t.push({k:"direction",v:this.getDirection()}),_t.push({k:"costType",v:this.costType}),_t.push({k:"costValue",v:this.costValue}),_t.push({k:"profile",v:this.profile}),_t.push({k:"timeUnit",v:this.timeUnit}),_t.push({k:"distanceUnit",v:this.getDistanceUnit()}),this.crs&&_t.push({k:"crs",v:this.crs}),this.constraints&&_t.push({k:"constraints",v:this.getConstraints()}),_t};function ProcessIsoCurveRequest(_t){if(this.logger=LoggerByDefault$1.getLogger("ProcessIsoCurveRequest"),this.logger.trace("[Constructeur ProcessIsoCurveRequest ()]"),!(this instanceof ProcessIsoCurveRequest))throw new TypeError("ProcessIsoCurveRequest constructor cannot be called as a function.");if(!_t)throw new Error(MessagesResources.getMessage("PARAM_EMPTY","options"));this.settings=_t,this.mode=this.settings.httpMethod||"GET"}ProcessIsoCurveRequest.prototype={requestString:null,constructor:ProcessIsoCurveRequest,processRequestString:function(){var _t="",e=0;switch(this.mode){case"GET":this.logger.trace("Process GET Request");var n=new ProcessIsoCurveParam(this.settings),ei=n.getParams();for(e=0;e<ei.length;e++){var ti=ei[e];_t&&(_t+="&"),_t+=ti.k+"="+ti.v}break;case"POST":this.logger.trace("Process POST Request");var ii={};ii.resource=this.settings.resource,ii.point=this.settings.position.x+","+this.settings.position.y,this.settings.method==="distance"?(ii.costType="distance",ii.costValue=this.settings.distance):(ii.costType="time",ii.costValue=this.settings.time),ii.profile=this.settings.graph,this.settings.reverse?ii.direction="arrival":ii.direction="departure",ii.constraints=this.settings.constraints,ii.distanceUnit=this.settings.distanceUnit,ii.timeUnit=this.settings.timeUnit,ii.crs=this.settings.srs,_t=JSON.stringify(ii);break;default:this.logger.error("No other HTTP method supported by the service !")}return this.logger.trace(_t),this.requestString=_t,this.requestString}};function ProcessIsoCurveResponse(){if(!(this instanceof ProcessIsoCurveResponse))throw new TypeError("ProcessIsoCurveResponse constructor cannot be called as a function.");this.message=null,this.id=null,this.location={},this.location.x=null,this.location.y=null,this.srs=null,this.geometry=null,this.time=null,this.distance=null}ProcessIsoCurveResponse.prototype={constructor:ProcessIsoCurveResponse};var ProcessIsoCurveResponseFactory={build:function(_t){var e=LoggerByDefault$1.getLogger("ProcessIsoCurveResponseFactory");e.trace(["ProcessIsoCurveResponseFactory::build()"]);var n=null;if(_t.response)if(_t.rawResponse)e.trace("analyze response : raw"),n=_t.response;else{e.trace("analyze response : json");var ei;if(typeof _t.response=="string"?ei=JSON.parse(_t.response):ei=_t.response,n=new ProcessIsoCurveResponse,ei){ei.costType==="distance"?(n.time="",n.distance=ei.costValue):(n.time=ei.costValue,n.distance=""),n.message="",n.id="",n.srs=ei.crs,n.geometry=ei.geometry;var ti=ei.point.split(",");n.location&&(n.location.x=ti[0],n.location.y=ti[1])}else{_t.onError.call(_t.scope,new ErrorService(MessagesResources.getMessage("SERVICE_RESPONSE_ANALYSE",_t.response)));return}if(n.exceptionReport){_t.onError.call(_t.scope,new ErrorService({message:MessagesResources.getMessage("SERVICE_RESPONSE_EXCEPTION",n.exceptionReport),type:ErrorService.TYPE_SRVERR,status:200}));return}}else{_t.onError.call(_t.scope,new ErrorService(MessagesResources.getMessage("SERVICE_RESPONSE_EMPTY")));return}_t.onSuccess.call(_t.scope,n)}};function ProcessIsoCurve(_t){if(!(this instanceof ProcessIsoCurve))throw new TypeError(MessagesResources.getMessage("CLASS_CONSTRUCTOR","ProcessIsoCurve"));if(this.CLASSNAME="ProcessIsoCurve",CommonService.apply(this,arguments),this.logger=LoggerByDefault$1.getLogger("Gp.Services.ProcessIsoCurve"),this.logger.trace("[Constructeur ProcessIsoCurve (options)]"),!_t.position)throw new Error(MessagesResources.getMessage("PARAM_MISSING","position"));if(_t.position.x===null)throw new Error(MessagesResources.getMessage("PARAM_MISSING","position.x"));if(_t.position.y===null)throw new Error(MessagesResources.getMessage("PARAM_MISSING","position.y"));if(!_t.time&&!_t.distance)throw new Error("Parameter (s) 'distance' missing. Parameter time to calculate an isochrone, parameter distance for an isodistance");if(!_t.time&&_t.distance&&(this.options.method="distance",this.options.time&&delete this.options.time),_t.time&&!_t.distance&&(this.options.method="time",this.options.distance&&delete this.options.distance),this.options.method=this.options.method||"time",this.options.resource=_t.resource||"bdtopo-valhalla",this.options.exclusions=_t.exclusions||[],this.options.reverse=_t.reverse||!1,this.options.srs=_t.srs||"EPSG:4326",this.options.distanceUnit=_t.distanceUnit||"m",this.options.timeUnit=_t.timeUnit||"second",_t.smoothing&&this.logger.warn("options.smoothing is DEPRECATED"),this.options.smoothing=!1,_t.holes&&this.logger.warn("options.holes is DEPRECATED"),this.options.holes=!1,_t.graph?(_t.graph==="Voiture"&&(this.options.graph="car"),_t.graph==="Pieton"&&(this.options.graph="pedestrian")):this.options.graph="car",this.options.constraints=[],_t.constraints)if(Array.isArray(_t.constraints))for(var e=0;e<_t.constraints.length;e++)this.options.constraints.push(_t.constraints[e]);else throw new Error(MessagesResources.getMessage("PARAM_TYPE","constraints"));var n={},ei={},ti={};if(_t.exclusions&&_t.exclusions.length!==0){this.logger.warn("options.exclusions is DEPRECATED !!");for(var ii=0;ii<_t.exclusions.length;ii++){if(typeof _t.exclusions[ii]=="string")_t.exclusions[ii]=_t.exclusions[ii].toLowerCase();else continue;_t.exclusions[ii]==="toll"&&(ti.constraintType="banned",ti.key="wayType",ti.operator="=",ti.value="autoroute",this.options.constraints.push(ti)),_t.exclusions[ii]==="tunnel"&&(n.constraintType="banned",n.key="wayType",n.operator="=",n.value="tunnel",this.options.constraints.push(n)),_t.exclusions[ii]==="bridge"&&(ei.constraintType="banned",ei.key="wayType",ei.operator="=",ei.value="pont",this.options.constraints.push(ei))}}if(this.options.outputFormat=typeof _t.outputFormat=="string"?_t.outputFormat.toLowerCase():"json",_t.outputFormat&&_t.outputFormat!=="json")throw new Error(MessagesResources.getMessage("PARAM_NOT_SUPPORT","outputFormat"));if(this.options.outputFormat="json",!this.options.serverUrl){var ri=DefaultUrlService.ProcessIsoCurve.newUrl();if(!ri)throw new Error("Url by default not found !");this.options.serverUrl=ri,this.logger.trace("Serveur URL par defaut : "+this.options.serverUrl)}}ProcessIsoCurve.prototype=Object.create(CommonService.prototype,{});ProcessIsoCurve.prototype.constructor=ProcessIsoCurve;ProcessIsoCurve.prototype.buildRequest=function(_t,e){try{var n=new ProcessIsoCurveRequest(this.options);if(!n.processRequestString())throw new Error(MessagesResources.getMessage("SERVICE_REQUEST_BUILD"));this.request=n.requestString}catch(ei){_t.call(this,new ErrorService(ei.message));return}e.call(this,this.request)};ProcessIsoCurve.prototype.analyzeResponse=function(_t,e){if(this.response){var n={response:this.response,outputFormat:this.options.outputFormat,rawResponse:this.options.rawResponse,onSuccess:e,onError:_t,scope:this};ProcessIsoCurveResponseFactory.build(n)}else _t.call(this,new ErrorService(MessagesResources.getMessage("SERVICE_RESPONSE_EMPTY")))};var Services={getConfig:function(_t){var e=new Config$1(_t);e.call()},getAltitude:function(_t){var e=new Alti(_t);e.call()},geocode:function(_t){var e=new Geocode(_t);e.call()},reverseGeocode:function(_t){var e=new ReverseGeocode$1(_t);e.call()},autoComplete:function(_t){var e=new AutoComplete(_t);e.call()},route:function(_t){var e=new Route$1(_t);e.call()},isoCurve:function(_t){var e=new ProcessIsoCurve(_t);e.call()}};const servicesVersion=Pkg.version,servicesDate=Pkg.date;var Gp={};Gp.servicesVersion=servicesVersion;Gp.servicesDate=servicesDate;Gp.Protocols={};Gp.Protocols.XHR=XHR;Gp.Services=Services;Gp.Services.DefaultUrl=DefaultUrlService;Gp.Services.AltiResponse=AltiResponse;Gp.Services.Alti={};Gp.Services.Alti.Elevation=Elevation;Gp.Services.AutoCompleteResponse=AutoCompleteResponse;Gp.Services.AutoComplete={};Gp.Services.AutoComplete.SuggestedLocation=SuggestedLocation;Gp.Services.Config=Config$1;Gp.Services.IsoCurveResponse=ProcessIsoCurveResponse;Gp.Services.RouteResponse=RouteResponse;Gp.Services.Route={};Gp.Services.Route.RouteInstruction=RouteInstruction;Gp.Error=ErrorService;Gp.Helper=Helper$1;var LoggerByDefault={getLogger:function(_t){if(typeof e>"u"){var e={};e.env={VERBOSE:!1}}e.env.VERBOSE?loglevelExports.enableAll():loglevelExports.disableAll();var n=_t||"default";return loglevelExports.getLogger(n)},disableAll:function(){var _t=loglevelExports.getLoggers();for(const e in _t)Object.hasOwnProperty.call(_t,e)&&_t[e].disableAll()},enableAll:function(){var _t=loglevelExports.getLoggers();for(const e in _t)Object.hasOwnProperty.call(_t,e)&&_t[e].enableAll()}};window.Gp&&(window.Gp.Logger=LoggerByDefault);var ProxyUtils={proxifyUrl:function(_t,e){var n=LoggerByDefault.getLogger("proxifyUrl");if(!e||!e.hasOwnProperty("proxyUrl")||e.proxyUrl===null||e.proxyUrl.trim().length===0)return _t;if(e.noProxyDomains&&Array.isArray(e.noProxyDomains)&&e.noProxyDomains.length>0){for(var ei in e.noProxyDomains)if(n.trace("[ProxyUtils] proxifyUrl : analyzing "+e.noProxyDomains[ei]),_t.indexOf(e.noProxyDomains[ei])!==-1)return n.info("[ProxyUtils] proxifyUrl : "+_t+" found in noProxyDomains list ("+e.noProxyDomains[ei]+")."),_t}return e.proxyUrl+encodeURIComponent(_t)}},logger$H=LoggerByDefault.getLogger("GfiUtils"),Gfi={getLayerFormat:function(_t){var e=typeof _t.getType=="function"?_t.getType():null,n=_t.getSource();if(e){if(e==="VECTOR"||e==="VECTOR_TILE")return"vector";if(e==="TILE")return n.tileGrid?"wmts":"wms";if(e==="IMAGE")return"wms"}else{if(n instanceof TileWMS||n instanceof ImageWMS)return"wms";if(n instanceof WMTS$1)return"wmts";if(n instanceof VectorSource||n instanceof VectorTile)return"vector"}return"unknown"},displayInfo:function(_t,e,n,ei,ti){if(logger$H.trace("[Gfi] : displayInfo..."),ei||(ei="text/html"),n!==null){var ii=null,ri=null,ni=n;ni=ni.replace(/\n/g,""),ni=ni.replace(/(>)\s*(<)/g,"$1$2");var si=typeof window<"u"?window:null;if(typeof exports=="object"&&window===null){var ai=require("@xmldom/xmldom").DOMParser;ri=new ai,ii=ri.parseFromString(ni,ei)}else if(si.DOMParser)ri=new si.DOMParser,ii=ri.parseFromString(ni,ei);else if(si.ActiveXObject)ii=new si.ActiveXObject("Microsoft.XMLDOM"),ii.async=!1,ii.loadXML(ni);else return logger$H.log("Incompatible environment for DOM Parser !"),!1;var oi=ii.getElementsByTagName("body");if(oi&&oi.length===1&&!oi[0].hasChildNodes())return!1;var li=document.createElement("div");li.className="gp-feature-info-div";var ci=document.createElement("button");ci.className="gp-styling-button closer",ci.onclick=function(){return _t.featuresOverlay&&(_t.removeOverlay(_t.featuresOverlay),_t.featuresOverlay=null),!1};var ui=document.createElement("div");return ui.className="gp-features-content-div",ui.innerHTML=n,li.appendChild(ui),li.appendChild(ci),_t.featuresOverlay&&(_t.removeOverlay(_t.featuresOverlay),_t.featuresOverlay=null),_t.featuresOverlay=new Overlay({element:li,autoPan:ti.autoPan,autoPanAnimation:ti.autoPanAnimation,autoPanMargin:ti.autoPanMargin,positioning:"bottom-center",insertFirst:!1,stopEvent:!0}),_t.addOverlay(_t.featuresOverlay),_t.featuresOverlay.setPosition(e),_t.featuresOverlay.render(),!0}},features2html:function(_t,e){var n=document.createElement("div");return e.forEach(function(ei){var ti=ei.getProperties();if(ti.hasOwnProperty("render"))n.insertAdjacentHTML("beforeend",ti.render);else{if(ti.hasOwnProperty("name")){var ii=document.createElement("div");ii.className="gp-att-name-div",ii.insertAdjacentHTML("afterbegin",ti.name),n.appendChild(ii)}if(ti.hasOwnProperty("description")){var ri=document.createElement("div");ri.className="gp-att-description-div",ri.insertAdjacentHTML("afterbegin",ti.description),n.appendChild(ri)}var ni=null,si=!1,ai=null,oi=null,li=null,ci=["fill","fill-opacity","label-stroke","stroke","stroke-opacity","stroke-width","marker-symbol","marker-color","marker-size","geometry","value","name","description","styleUrl","extensionsNode_","icon"];for(ni in ti)if(ti[ni]!==void 0&&ci.indexOf(ni)===-1){si||(ai=document.createElement("div"),ai.className="gp-att-others-div",oi=document.createElement("ul"),si=!0),li=document.createElement("li");var ui=document.createElement("span");ui.className="gp-attname-others-span",ui.appendChild(document.createTextNode(ni+" : ")),li.appendChild(ui),li.appendChild(document.createTextNode(ti[ni])),oi.appendChild(li)}oi&&(ai.appendChild(oi),n.appendChild(ai))}},_t),n.hasChildNodes()||(n=null),n},layerGetFeatureAtCoordinates:function(_t,e,n){var ei=_t.getPixelFromCoordinate(n);return _t.hasFeatureAtPixel(ei,function(ti){return ti===e})},displayVectorFeatureInfo:function(_t,e,n,ei){var ti=_t.getPixelFromCoordinate(e),ii=[];if(_t.forEachFeatureAtPixel(ti,function(ni,si){(!n||n.indexOf(si)>-1)&&ii.push(ni)}),ii.length===0)return!1;var ri=this.features2html(_t,ii);return ri===null?!1:(this.displayInfo(_t,e,ri.innerHTML,"text/html",ei),!0)},displayFeatureInfo:function(_t,e,n,ei,ti){for(var ii={},ri=0;ri<n.length;ri++){var ni=n[ri],si=ni.obj.getZIndex();ii[si]||(ii[si]=[]),ii[si].push(ni)}var ai=[],oi=Object.keys(ii);oi.sort(function(Ei,Si){return Si-Ei});for(var li=0;li<oi.length;li++)for(var ci=oi[li],ui=0;ui<ii[ci].length;++ui){var di=ii[ci][ui].obj,fi=ii[ci][ui].infoFormat||"text/html",hi=!0;if(di.minResolution&&di.minResolution>_t.getResolution()&&(hi=!1),hi&&di.maxResolution&&di.maxResolution<_t.getResolution()&&(hi=!1),di.getVisible()&&hi){var pi=this.getLayerFormat(di);if(pi==="vector"){this.layerGetFeatureAtCoordinates(_t,di,e)&&ai.push({format:pi,scope:this,coordinate:e});continue}else if(pi!=="wms"&&pi!=="wmts"){logger$H.log("[ERROR] DisplayFeatureInfo - layer format '"+pi+"' not allowed");continue}var gi=_t.getView().getResolution(),vi=null;pi==="wmts"?vi=di.getSource().getFeatureInfoUrl.call(di.getSource(),e,gi,_t.getView().getProjection(),{INFOFORMAT:fi}):vi=di.getSource().getFeatureInfoUrl.call(di.getSource(),e,gi,_t.getView().getProjection(),{INFO_FORMAT:fi}),ai.push({format:fi,url:ProxyUtils.proxifyUrl(vi,ei),scope:this,coordinate:e})}}var yi=null;function _i(Ei,Si,wi){if(Ei.length===0)return;var Oi=0;function Ii(Li){Oi++,Li||Oi===Ei.length?wi():Si(Ei[Oi],Ii)}Si(Ei[0],Ii)}var Ai=this;_i(ai,function(Ei,Si){if(Ei.format==="vector"){if(!yi){yi=[];for(var wi=0;wi<oi.length;wi++)for(var Oi=oi[wi],Ii=0;Ii<ii[Oi].length;++Ii)yi.push(ii[Oi][Ii].obj)}Si(Ei.scope.displayVectorFeatureInfo(_t,Ei.coordinate,yi,ti))}else Gp.Protocols.XHR.call({url:Ei.url,method:"GET",scope:Ei.scope,onResponse:function(Li){var Di=!1;(Li.trim().length===0||Li.indexOf("ServiceExceptionReport")!==-1||Li.indexOf("java.lang.NullPointerException")!==-1||Li.indexOf("java.lang.OutOfMemoryError")!==-1||Li.indexOf("not queryable")!==-1)&&(Di=!0);var Ni=!Di&&Ai.displayInfo(_t,Ei.coordinate,Li,"text/html",ti);Si(Ni)},onFailure:function(Li){logger$H.log(Li),Si(!1)}})},function(){logger$H.trace("Finish sync to GFI !")})},getPosition:function(_t,e){if(_t.coordinate)return _t.coordinate;var n=[0,0];if(_t.offsetX||_t.offsetY)n[0]=_t.offsetX,n[1]=_t.offsetY;else if(_t.pointerType==="touch"){var ei=_t.pointers[0];n[0]=ei.pageX,n[1]=ei.pageY}var ti=e.getCoordinateFromPixel(n);return ti},onDisplayFeatureInfo:function(_t,e){if(e.isActive()){logger$H.trace(_t);var n=e.getMap();if(_t.type==="contextmenu"||_t.type==="dblclick")_t.preventDefault();else if(_t.type==="singleclick"){for(var ei=n.getInteractions().getArray(),ti=0;ti<ei.length;ti++)if(ei[ti].getActive()&&(ei[ti]instanceof Select||ei[ti]instanceof Modify||ei[ti]instanceof Draw))return}var ii={};e._proxyUrl&&(ii.proxyUrl=e._proxyUrl),e._noProxyDomains&&(ii.noProxyDomains=e._noProxyDomains);var ri={};e._autoPan&&(ri.autoPan=e._autoPan),e._autoPanAnimation&&(ri.autoPanAnimation=e._autoPanAnimation),e._autoPanMargin&&(ri.autoPanMargin=e._autoPanMargin);for(var ni=[],si=0;si<e._layers.length;++si){var ai=e._layers[si].event?e._layers[si].event:e._defaultEvent;if(ai===_t.type){var oi=ni.push(e._layers[si])-1;ni[oi].infoFormat||(ni[oi].infoFormat=e._defaultInfoFormat)}}var li=this.getPosition(_t,n);this.displayFeatureInfo(n,li,ni,ii,ri)}}};window.ol&&(window.ol.gp?window.ol.gp.GfiUtils=Gfi:window.ol.gp={GfiUtils:Gfi});class Control extends BaseObject{constructor(e){super();const n=e.element;n&&!e.target&&!n.style.pointerEvents&&(n.style.pointerEvents="auto"),this.element=n||null,this.target_=null,this.map_=null,this.listenerKeys=[],e.render&&(this.render=e.render),e.target&&this.setTarget(e.target)}disposeInternal(){var e;(e=this.element)==null||e.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(e){var n;this.map_&&((n=this.element)==null||n.remove());for(let ei=0,ti=this.listenerKeys.length;ei<ti;++ei)unlistenByKey(this.listenerKeys[ei]);if(this.listenerKeys.length=0,this.map_=e,e){const ei=this.target_??e.getOverlayContainerStopEvent();this.element&&ei.appendChild(this.element),this.render!==VOID&&this.listenerKeys.push(listen(e,MapEventType.POSTRENDER,this.render,this)),e.render()}}render(e){}setTarget(e){this.target_=typeof e=="string"?document.getElementById(e):e}}let uidCounter_=0;var Helper={detectSupport:function(){var _t=!0,e=window.navigator.userAgent.toLowerCase();return(e.indexOf("iphone")!==-1||e.indexOf("ipod")!==-1||e.indexOf("ipad")!==-1||e.indexOf("android")!==-1||e.indexOf("mobile")!==-1||e.indexOf("blackberry")!==-1||e.indexOf("tablet")!==-1||e.indexOf("phone")!==-1||e.indexOf("touch")!==-1)&&(_t=!1),(e.indexOf("msie")!==-1||e.indexOf("trident")!==-1)&&(_t=!0),_t},assign:function(_t,e){_t=_t||{};for(var n in e)e.hasOwnProperty(n)&&(_t[n]=e[n]);return _t},mergeParams:function(_t,e,n){if(!(typeof _t>"u"||typeof e>"u")){typeof n>"u"&&(n=!0);for(var ei in e)e.hasOwnProperty(ei)&&(typeof e[ei]=="object"?_t.hasOwnProperty(ei)?this.mergeParams(_t[ei],e[ei],n):_t[ei]=e[ei]:_t.hasOwnProperty(ei)?n&&(_t[ei]=e[ei]):_t[ei]=e[ei])}},getUid:function(_t,e){return e&&e.id?e.id:_t+ ++uidCounter_}},logger$G=LoggerByDefault.getLogger("interactions"),Interactions={_extensions:["Measures","ElevationPath","Drawing"],_options:{current:null,clean:null},unset:function(_t,e){logger$G.trace("unset()");var n={};Helper.mergeParams(n,this._options),Helper.mergeParams(n,e);for(var ei=_t.getInteractions().getArray(),ti=0;ti<ei.length;ti++)if(ei[ti].getActive()&&(ei[ti]instanceof Draw||ei[ti]instanceof Select||ei[ti]instanceof Modify)){var ii=ei[ti].getProperties(),ri=ii.name;if(typeof ri<"u"&&this._extensions.indexOf(ri)>-1){if(n.current&&n.current===ri)continue;ei[ti].setActive(!1);var ni=ii.source;if(typeof ni<"u"&&ni instanceof Control){for(var si in n)if(n.hasOwnProperty(si)){if(si==="current")continue;if(typeof ni[si]=="function"){var ai=Array.isArray(n[si])?n[si]:[n[si]];ni[si].apply(ni,ai)}}}}else ei[ti].setActive(!1)}}},Marker={lightOrange:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAgCAYAAAC/40AfAAASf3pUWHRSYXcgcHJvZmlsZSB0eXBlIGV4aWYAAHjapZpptuO4DYX/cxVZAsEBIJfD8ZzsIMvPB8mvpq5OupN6Xc8uW5Yo4OIOdIfzr3/e8A/+lNo1lGpNu2rkT+mlp8GTFt8/4/ktsTy/nz85f96Tn18P6fN6TLzkB30ObPo5/ut1+XaC92HwrP5worY+b8yf3+jlc/72y4k+F8q+Il/F/pyof06U0/uGfE4w3tuK2pv9eAvzvI/7607a+zf4r/tVE3sffv13Maq3K9fJKZ0sOfL7U6ycsv/NIQ+eVH6nXDhQsj3P31fssxIK8rs6ffvTWdH1pZbfHvRTV749+6Vbnwpwa790q6TPIfmXIuu3x9++HqT+vitP6X+4cmmfZ+nn10eVz4p+qf5T/Lvbfe6ZuxhFKbV+burrFp9nHDe5hF+6BZamdEfBUOPRfzo/jZtfQGHHFSc/S7ok2nWlyJYhV87zuGSxxJJOSMaTlFbKz4stW+ppZe9f8R+5yXLPOze6uJ62l5y+rUWey/a4wnO1xpW3cGgSTiZ85G//hL/7gXt9FES8luOtFetKyYvNMrxz/pvD6IjcT1HrU+Cvn1//eF8zHaxeZR+Rzqnne4r5NvPFVn4anTmw8vjOoNj+nIAScenKYiTTAbomuYpKtJRMhEI2GjRYus/MpANSa9osMpWcld605JfmIybPoakmXg68DpnRiZqVOWt0aNCsUir4sdLA0Ki5llqrVqut9jo0a9GqqqZOisOylWDV1MyadRstt9Jq02attd5GTz1DmhBpt95672NwzcGZB58eHDDGTDPPMmuYOm222edYwGeVVZcuW231NXbaecMfW7fttvseRw5QOuXUo8dOO/2MC9RuDrfcevXabbff8a1rn7b+4edvdE0+XUtPp/xA+9Y1XjX7OoU4nVTvGQ1LoQgdN28BgE7es9iklOSd857FDv3lmlhk9Z5t8Y7RwXIk1StfvQvp7ah37v/qW7DyU9/S/9q54K37m537Y99+17XtJLyejr1T6EWNmenjmJEa/zGtf3wMnycdEnrmgScKh+W2rFIB58FVtiU7CVaLdS1hHXPoPkvVW5b2oXDBZM5kyN7VVS1pzsLdAoljo1+6tE5b+ciweuqaTNwEgrpb3atwvSOzw3Aa7Git98o4VD3nq3Nz/50yiEw9MXMCh+hOfU+a3euZl0IjZX1tW/VQIF0lHO5kjFqF2hvlvCOvrEi+yhlzzHKu6fCXapZzFpUqw+TMUoU1TrM8K8eEt2CcvwpvlcXjErqqEPqJVIoz1cQ7CdQOB0qqW1QrkrCsK6Afva0R7pobdpd7pG47/Z7UpwDkCm4ql9Y8G2Oi4+S0rJ3LiVdtruM9Jb1Ja6ESIbdenfb7pXSsmRIcyTStcG9xoGh7gbLD1W/ra462dTTubFKUsWyMLTThhmZUszvGdgZEZizn7D1Pvb3VmlkuoOsHSOIrxmpt0EbpgB81ynTMBlDt4TB1Vq5U0EsVt3mfgfWpNiTznwumVxaPWHprbym/Svr9MfzZG/QkgrS9IGdlYQ6i4zdpbQ/m9sbCKqv0ZKwrI5D8c+V9b9uzAIzM/Z4lm07xdl/X4aOlTekLNI+orHQcAKRJpdnQM8CoBLRYV9plleJl8yJpa3OPe+a+2ljD2pnF7GnxzrzWZijn2Ke3SytrYTJHl3CK9lQgFlNNC3tc+vJx88VLOxAB9avWjwIU0L+9m61oK7lrkrd4DEFof16knx/5sM6pOzqQ89r9dFase7a2kvXApdQOnAIH5T1mG+BM+ikt1QrNMltZKx0fC2XliVbK2enAuDk5P93TQXSY4nS4IchETYYPGGuNXfPJe8dboIixZ13bJ3mSES4KnZel1RgaaOZA8OcESKbuDaQOmjUXww93t1szsyHSFGynylw7HKfe096ywI75p6qE/1AWLgx4tMx14z2j6kyisec64EDuBCwwy/Hkm8cNzHK6iw7YiNbnVQpjdjOH0neUT9rCo7fozG2DjiOBKQKQC/0ivclYZtIwF7fDPLR2xsKkM0cZc3h3ubjIPgBmOYr3S+fTa5Zz1mfVLToJjbVH2GgN1DhKaQuluyAVe7PRRMRsWBqIgqYBoNC+NuDliY1RKG/iF5V5dztbGlQLAybsk82qaE3fzPS1zo1n5ygmKC4wsUvbiNBGerilBnJoSE4DG6x13BXWzXBv4vYFstG1VoOoC6oGPXX/UIRoN9Ib52D6Juin06jZss0ksVys5ZihjGxtMgDdLmq0EzXjzAC3GYCBXfJmwiQVEFzdurMKcZKkpyctqt0wSD0I04f4UnjXutEEdDzPuPOKKFPiKejaATr81NlRGzDe3HRwNPkVbr8UG4ZhJjM8BolsXMthNArGnMEfadoZhuRvosTdXPLOb6A0JOrIp3/hv06r4ESq1wpWZVzvZn6y/7vgYoE/RL0HgLxUNSFWB62gtiN2hhEcIbWpICkUOvvAoA/4gwScv+C0v8MJXQ+Nhqg1bgvZyqdP8vWsKBV8RUCGpsq1Orzz87Z547iFBkQcRUQrWKA86w2AavJxAguRhd6xoAOTYog6816YrroLXcGYxwUwoyFHxbtxwRY8c6zO2TQAYZkL53DIRQdBfHU1oxhJNzYpyVhcSYrFDSNPjwSTWZx0C7pf0DkOS8j9rA2q42RUpIpREda6Y4OVDMScySKSXydzjIPsENagrkkhcCt4BqZhB/N2onoPdi7ctdN3/3Qrd4qgPo8DCaYdnU9QE0W7h/vF5XGz3/AdFCBL/iqDfzDxQUSMGzfioPgJEvYDInjPyQaugchuEgbt4iCQY5ZDnwpnKTiqgj3mLhg1NCq+QwLyYPY43chRPVrq0WriYlciCNXr9VZ3eICCMIBS4nhvGEAIw0qEhaAkDex6p7qYKmQHB1AbnfAkxigx1QyOzGYXWYL/CubfGEbWGIDhxA3eiL9PpQDHRUgAbReX0ZAINyI0tQyUgcVzKFiDBOCFjXMlQ6QIYkMb7saZZliZxQwEHn7o2G6Dw8gKBXCjW9HZ5/SKXUR+OGGzMloZaAvkmmvAMyBcC4kU4YA7WToAmhlidyGKa0VSxUljYxnPcmeRgXsRbqRzbRBckHloBPPrw4Zr9/nkeMzb5VrMpFf9AdVcbrK+uoGUwtqrX/d3dJMJxvohLt7qvV04IsR7p1zM26eJ1/k1x//g+d/H8D4BAfSL+aSxxKRFa8VwUdeY6QURKy/NDAFrToKxoZTYfM331eZeAgxflY4XBZ69YaDqBP0056yGHyqnI9Rm+K1p4rSSFV9wIQGusB4PwEsdXUP9DnZtZ94jN0xuBSPBvXtoV2+0IasUFkXDKp3lXoDfe5DX9kLTOsqO9cOHgM9dqcdiEIusVMgFQy508wSbpxADbn2mkuCEx6EsXBGIAZaI1QujONgyMWaU1cti1qaQEDl1Vj7vsZFkI2m+A1t7/N49QJhK5OIUe/mWkE5sXwYa+J+lLKYCuDVajRjq3pAsYg3SQnkfQcb5LTz7xuPjv3k+dmCWUDi39Gl2ps4dXcYVJ+59d99wRJHQ9LtAD2XCRjYYkN8YUkIsrfFM5Bua5BDFyIKdxluACNO7zFkGegGi99np8n9j/ehWp2oYY4SOQWj9XHz1WcHWQL0BTYasCIpgkjyEg2C5TjD10bCGFz/PM8b5+O4Qk/m+Q5382uG5+CN3633jvfzjO4W5+TohQ8+pxIiNEfMI6VGFDe3Vd7VByDt4j0ebGrIEM2FxoZRLB0ld8XEkKBgMwyDC7QsJysobUBnjBgjRwxnsynv/tfjqx2VNJC2GPT4rjSDBV4jDl/3nVG6B+hHJ/bY9TyerWAXsIZHtzugCQWRAOXCVZl5Xxtv3fWErmHaDtJp8l2EikIXuKSylj/uCveU2fazmTH53yCEnm+KTd2E8hu4qTrIvHDJGlUkZS4IXFcPl7A8fAbrNqGf3Qh0xQTZ0SOsbIwDBLK/x9DWhsopPIiRsgHCMYjfP9wzMjbM37G0lr8B9aaI3NOogBL6Xs2HMOSH289KUQKo/Buvw+9qVTK6UUwqBuBPJFVPro5AfXk+Hn4zJjMj3RBR5J8BC2PqEG63CIG16OTfx+pr5fu30UWcS0DFuDuKHtdFjnLuM6psYkD2+oF5CjVvhS0CnoHwa/WNusfqXim5qQpjM1ZuFIjyYKi4vxKw4DZoiVeu6o4ZKaXzoURuq4nOHt6Fa9ATnU7ncxo7g6UE+0kYg8fExDzwLcq3ErIGXRo5wH+cRiu336mjg3/3hG2IT6ohLvVXuTCXB0dhTZ+++gRgyV/xAITch2WCqEVVrzPAxLgXRI1voOfSbmnM3/CXgYh8rPhxfDFL225b2jePCd7J7H2GzAwgjZgFyJj8SfsUItFBpFvCwUUQDA4ArY0Ch61SNvFZ8rw4vVhHyw5p9f3bEFDt1PjrID05RjBzVgqbJUJXSLARoRkQCNSZf5olAkobc12LqI73yrQJsCI4mLYS/rubukwKjPDlOFkPFgSrnRyNwuAcbiRm94aPI9zdmLUkujYQqcYLjaGRIFnZ9jYRcLJlv/hX30BiQgE6j5A+dU2RwwDKwGdzTAYnH2f2ctN0O7I1HTtBURMBcroAlYgjM8GYBFvPdA+imolWmjWHi4gzYfRqHKRuMrUQIsUDygBhBxs1jo+CJ/IRoNDEAuvemMJCC/Xg00L/U+v7I1Ly3qnhB/Jnv36SmOB4fM0A35hihOAcqHpM4x/zAdUx8e02G/BVzGxEpEBsqKathzVgltlb3EfNtLcNVGPPt0TpvbA+eMs3SfMcK04ln8fXDhgIiSOwUm4lj8jugXZhmRg6AHMb9gijciwnTDnNhKBXDI9m3iD38ciZ0YLpbxWho2ISpAY66Q2ZZgwv9YyzHM2QkASaOBrCM9OP4q+8xXnvSaycEuDbB4cHeJeEM08EstvvA765nu7r4RjF5YxNiO742DawE9XUMghITWK87c1sOWHBLFCdbxFqYR1wcoI8cBOX6jFuFBLCGvrO4QGX1bQxLMyX1IOX6X7bSfq7geCNzFbDeFfsL4sAm9acvxwtCFjQCGbaQ5SXYzrfVaxzOdTr6hCG35oVdOc2NjGrlX48wehxksic+UH1zZFGbgTZ0K7g4w03xafwEKo3qmAT1ovmmWMLjkxQfaNJsfbCSfP/Bjam3D72Oor77aumCQix5g05JlNJPOM40mKCcXes2BgAqwbwjX9C6YD5GLvF1Btsafh9ONbfSezJDaSKHSLBCtccxqI9oQpBKdPOW8ElM6cLAUEp480Jj9F8ZWZlutjwrw34IF3Ru/nXGEPVdmdKGfy3h2xPSckwZ++JVZyTNxYgPu4Xr7t9dEwC884PvdGPaUoDyS8JT24R1WOfECBGsahPUmDtm+cTW6WDpaAjUzlyS1kncYJEIDAiZyxN0E5/siGdvg+9mUv9KxWpkpJZHQvPvaxZnxBcgaAiXh+X94PwInyIy3xvwy/LG3eRYB/K+3Rv/0tbkr5t1/t2Cf/2ywR63xthCV3sBUwghIvm+R2nAiiQx9m1ALsHxHN59A48pBKgBad+otn9vQ+k4H3eDprO46VGMaI8i2WtEMWRIDaGfMTZn+VEuSgW8+gwAObmZIcwd38EfjH/1vT7fEMfSUMtuvYNP3y02Lp8384OnnB5SE3yl2JVLXkupN8SeLMR0edpWPOdiYAzEoLsnU06ADN0M4jS0g3qw/pl6ie/3qbB8IAwhZKSSWdYi2UeyRcdX7oYRIJHqRg3ohnS35cvNC0hB48rizpKbfgIpJ4K8UTXsMyPJS8f3molSYALLgj3yJXXfIQUczfMrnTGm9vXmbqT9Cxm1gL0Av0xdB/GsoGePVRtqwDiU7NkOC5OoSHUj2313k5QM26h2luk7Bj3ZCNe/pU0Qy4KK4CUIssMEE7uGyWV2uHjb+uw+wh8kX2daUJevGzUyICdt1kJizKnhNN9fJdvgDiNkP/wLw3jTrngRHBUjR54lJbBuOeAjo47O6yybKKQ1+BYN9E7SdXSh7kg7fhkCp+XcFTAgpvpIdDeDnincsPl3LFAaQHpywRwhptNoKXGKHlun1+/eKorKDU6M+vPdy4TRM3hBqOByFyqMtsOze740DPsC8pAEAoG/Lv5/CMA8eARSjpFJ/D3fpm7bv13y/1/gYgKdVn1LkvDNrMDBe5OOZLrnE6TOLjSDqjEAmIBNMzyKH+RuFd8whbrQq0Eg9sSGkBz/Ho6Yxe0G6mANNHo8de/ikteZX99WyNEZrVJf5T6opO+8RJLMjhgqGLMdsOXbSlqCutkhdPhvUMPc/H7Tgqm9nnHDvwF6YngoNZcUVAAAAYRpQ0NQSUNDIHByb2ZpbGUAAHicfZE9SMNAHMVfU0tFKh3sUMUhQ3WyICriqFUoQoVSK7TqYHLpFzRpSFJcHAXXgoMfi1UHF2ddHVwFQfADxNXFSdFFSvxfUmgR48FxP97de9y9A4RmlalmzzigapaRSSbEXH5VDL4igCjCGERIYqY+l06n4Dm+7uHj612cZ3mf+3P0KwWTAT6ReJbphkW8QTy9aemc94kjrCwpxOfEYwZdkPiR67LLb5xLDgs8M2JkM/PEEWKx1MVyF7OyoRJPEccUVaN8IeeywnmLs1qts/Y9+QtDBW1lmes0h5HEIpaQhggZdVRQhYU4rRopJjK0n/DwDzn+NLlkclXAyLGAGlRIjh/8D353axYnJ9ykUAIIvNj2xwgQ3AVaDdv+Prbt1gngfwautI6/1gRmPklvdLTYERDeBi6uO5q8B1zuANEnXTIkR/LTFIpF4P2MvikPDNwCfWtub+19nD4AWeoqdQMcHAKjJcpe93h3b3dv/55p9/cDPGdykYtTXU4AAA0aaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/Pgo8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA0LjQuMC1FeGl2MiI+CiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIKICAgIHhtbG5zOnN0RXZ0PSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VFdmVudCMiCiAgICB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iCiAgICB4bWxuczpHSU1QPSJodHRwOi8vd3d3LmdpbXAub3JnL3htcC8iCiAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyIKICAgIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIKICAgeG1wTU06RG9jdW1lbnRJRD0iZ2ltcDpkb2NpZDpnaW1wOjkyYWVkNjM2LWY3MDMtNDAzOC1hNzM4LWZiYzYxYzZlMTljNCIKICAgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo5NWMzZWI3NC0zYWRmLTRkYzUtOWZjZS1iODQ4NTc3Nzg4ODQiCiAgIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo0NjI3ZDg3NC1lZDIyLTRiZTUtYTlkNS00NDlmMzVhZDIxYzgiCiAgIGRjOkZvcm1hdD0iaW1hZ2UvcG5nIgogICBHSU1QOkFQST0iMi4wIgogICBHSU1QOlBsYXRmb3JtPSJMaW51eCIKICAgR0lNUDpUaW1lU3RhbXA9IjE2ODQ5NDE5Mjc4OTUzMDYiCiAgIEdJTVA6VmVyc2lvbj0iMi4xMC4zMCIKICAgdGlmZjpPcmllbnRhdGlvbj0iMSIKICAgeG1wOkNyZWF0b3JUb29sPSJHSU1QIDIuMTAiPgogICA8eG1wTU06SGlzdG9yeT4KICAgIDxyZGY6U2VxPgogICAgIDxyZGY6bGkKICAgICAgc3RFdnQ6YWN0aW9uPSJzYXZlZCIKICAgICAgc3RFdnQ6Y2hhbmdlZD0iLyIKICAgICAgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDphM2U3ZWQ1MS0xNTI4LTRhYjAtODVjOS0zNzNkNzgxZGM2ZmMiCiAgICAgIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkdpbXAgMi4xMCAoTGludXgpIgogICAgICBzdEV2dDp3aGVuPSIyMDIzLTA1LTI0VDE3OjI1OjI3KzAyOjAwIi8+CiAgICA8L3JkZjpTZXE+CiAgIDwveG1wTU06SGlzdG9yeT4KICA8L3JkZjpEZXNjcmlwdGlvbj4KIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAKPD94cGFja2V0IGVuZD0idyI/PofUkY4AAAAGYktHRAD/AP8A/6C9p5MAAAAJcEhZcwAADdcAAA3XAUIom3gAAAAHdElNRQfnBRgPGRuA4VZTAAAFcElEQVRYw82YW2xbVRaGv7XP8bHjXByHQkNhWigdVX1AikRBMBoQ8wASl4fRqPDAAxIPKAVxeRqQRohHBEVCaoGKUBCl4qHcNKCZVKMRRQxtgTaACLRKqlwB14NzM2ni2D2XvXjgBFXQOnFiA1uy/HB89u9/7bX+vf4l1HnpK57hTNCE0AzqAS5gAAuEID5KiWSiLPf4tp7YUjcSu4yLZzdi2IJyNXANcBlwAdAKzAHTwDhwDKEPywC+GZWHbPi7IKOvZIWguAnlr8BtwJ+AxDJeDYCPgF6Ed0hkh+Weov5mZLTHJMDeBjwYk0itYJtKTOpZML3SbYNfnYz2SBr0buARYENcFytdFvga2AGyT7p14Vcjoz3ShOgdKDuAi+pUewpMIDyCypvSreWGk9HdroOEV2F4A1hfTxGJCX2D5U7U/UzuD6NaXq49NRJhBsOjwMVLEtE4gaL4W5cV3IsxPEoizDT0ZLTHcSH6M/BWLLlVwpQKuPzhb+i8sRkv04Y/e5rvPigxtnM9trKU2k0D28A5LN3RsmXbrbFOU8DtQLpqfJqu97nh6TydmzvwWpOI8VDbxqbrkmz62yk+/Ps6yoe8KkeV/hHHfgrMNyrNEkBX1SAktgRs3T7ApV1rSWayiEkDLmLSJDNZLu1ay9btAyS2BEsEuWuZ99WKyRhgHeCcn8wGw/qbOnAS3jmfOwmP9Td1kNhQDduJcUwjyciS0RJXMMkWkPPUo/z4XFxZRhZII8mEwFCsT+f5xXTE7FAOteduItVaZodyhNPVZDeKccJGkxmsChIMOvTt6aRSzIP+7A9rRKWYp29PJ8GgsyqcVauZSADaj+IDTecWvBlD4e01HKjM07XtOOuuy+A2X0BYmib/8SxfvLWRYm8LdqZaCvkI/SDBci6nld0ze7KCLa4F3gSurR4MB5x1FnMhiCeor9hJiPKmWpbGp3EU2IbJFuTe5XfStbczLxgP7K0IPcCFDWhnJoFuMAek2/oNbWdku/WxHATejT1JPZcPvINysFYiK+gAFkXTK6H+MyhXADeseJ9fmrVDM6X080/+p1M2/yFsD1zjEIauEeMAqNpQE16oaKiqwfjYeLk+fuYl10HDq7DsBTavxs8o6FzFKez/dM3rLx9LjUyVxcb7yVkfzmpXFbACJURHIxgyxkyu1ml6qL0Z4YX4xl7Jfrrgm9Ov9bX/e++x1tHCgkQ11lgELGA4sBp3iHRbH5GDwJPAFLXo6KJnDmTh/aG2w2/3t47VSGQxs1zAE9U2s9pEjx3hXuBloCa7G1rxv8o3f/7SkUz/UFFWMqGRWMpHAqsDbl00KGotIXM7MawF7gKSS5oJJRospI7v+rD96Ikp8aV2EgrkVPW4OnIy6SVL9ZubvZgyaOVyYDfwl2oNqVWiXNEb231oTe+/BrzvK9Gy01MFyoiOKzIEmqsEfjGf/39U1yHgosJFUXhlFMl+z9E/nkvhVNHZsjux+9Caf77RnyzMBaJLmW4RrWAlB3Y4Uh13HLOA4wQjo6O2IRPNxVV4JuG5Et2SSelzjtFLzsZQ0NIZ8/2rx7K9+/paxqbKvyh4Bc4AFQxzau23Dow7FS+nHmfEUz05OqINH8+evXJPJVOuE93XkY4eSziaXcQpB2b+vZNt7+/8IPPl2OxPRMJ4dDsLzIho3hpzamJ6aqJ0ei6qtZAasmZ2OS1RyOMd6egBIzSFVoKj4y1Hnvhv+8cD02ZOkEmgIKITVnXKWDs1ksvNrgbTbRSZ46cypY50aWcllIsyKXvr8GTyi9f6WvePFGVQhO8EPW2NzI+OfV2pF2bDTgbg8D/aJeVUspd1BK3/G24u7/skO3+iYP3h3LdhI/B+AGodUpo8WKwoAAAAAElFTkSuQmCC",darkOrange:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAgCAYAAAC/40AfAAAStXpUWHRSYXcgcHJvZmlsZSB0eXBlIGV4aWYAAHjapZpplmO5boT/cxVeAkeQWA4H8BzvwMv3B0pV7qou26/tyk5JeXXFAQgEIqgO9h//fsO/8a/2KKG2PkRFIv+qVs2TFyN+/s33mGJ9j+9fKd/30q/XQ/5ej5lLftP3xiHf+39cTz8H+DxNXrW/DDT294316xtav+OP3wb6TlR8Rb6K8x1IvwOV/HkjfQeYn21F0dH/uoVln+fzYyfj8xv84f6ISf88/f537UTvNOYpOVtJJfL4DVbJxX9LKJMXjcdcKjem0t/r9q7/2BIB+VOcfv5TVnR9qfWPN/2SlZ+vfsvWNwJs7bds1fy9pfwWZPn5/MfrIbU/Z+WF/i8z1/F9lX+9nkpKnxX9Fv0X/HvGfXtmF7MKoZbvpn5s8b3ivsUUPvUILE3IjoChwbP/KD+DzW+gcOKOi5+dNGXSdVNNJ810k73nnTZLrNlC7rzIeefyLo7Ss+ZdPH/Vf9LNvWg5ZZDL/dJeS/65lvSm1bjDm20w80ncmhODJT7yj3/CP/3AvV4KBHi81KdPfnP2YLMMz5w/chsZSfcb1PYC/OPn93+e10IGm0fZS0QZen2GWC39FxOUl+jCjY3nTw2mfr4DECKmbiwGBNRE1lJpSVLsOfeUCOQgQZOle80sMpBay4dF5lqKkJuRfWo+0tO7NbfM5cB1yIxMtCLU2SBDk2TV2sBPrwMMzVZaba1J6200bVOKVGki0sVJcfbSa+itS+99dO1zlFFHGzL6GEPH1KwF0mwq2nWo6pzMORl58unJDXOuvMqqq4Ulq6+xdM0NfHbdbcvue2zd8+RTDvxx5PQzjp5pyYCSVWsm1m2Y2rxA7ZZw621Xbr/j6p0/s/ZN699+/kHW0jdr+WXKb+w/s8bV3n8MkZxOmueMhOVQExnvngIAnT1ncaRas2fOcxYV+ists8jmOTvJM0YGq6XcbvqRu5A/GfXM/b/yFnr9JW/5/5q54Kn7h5n7e97+lLXjJLxfxj5V+BiwUH3cM/PgP6r178/h+2IWNXr3IZDKnG1YHtrtFtaVWu1ilevx7tYtr7VXOy3nSum0NHSeHSC4lcbIFUozk32J9iFdrXthMcaFq0z0Wlp6+qg7HfZer+Z0+zpjlQ5fRmKkS8fOua1j1CP7llovW7E816hHdHtUrZ5+oz0IDLDFuIMOT2Rma2CHreke6c5TYFqCY9puXmPuPRcL6KvoarLOvlBpNrRL37lJbySs733aav2UesPNIHA2O7WlZr3tW+ML4QSvXKsuLPpsgL0u/mbyXnZpdPGZjOttnz2khypsW2Jt5Fozqdl8qnedcofdunR20BHbANt15T1WAltjrZ53p6nfQqC6rqBWe6l0nMIi9+69RD0LYHu7WZT7SBuQzttKZNQmaIJGvHZZtrsC2T07siMATFvb7ja2C4/eLpMY6Y3jssO25l3SrxyZyBE7R4kTA+Zia60CIJVPnhkqFFtZ7lbmX7OMuH2OHEEBv42VEN66HZf+st21L32sSZIpaVIuvZie0Ge0B9BFHxzfMMd/8DzkZjNwFFdW4zWFApTWlpP3vCOzxUm1FWKkBtHMW+zI2iReZFFt7DcKsCld21qB8OQjdRDXQhXmKB1CEcC+q2c0bT7SjLbfG228GPk7hRnhmQNmEQOdQj6htHgI3AZ5KV/KSy5Qvz4ukCY1hWWM0YhnSa3Uk9dmzdAdoeYHkiPXuQbNHUoZk0+U1KEXyZnw7UUCFyAmnmlQI1tjE1u3fEp+abX5p+r/Iz2QS1Kc9umzQg1lt3Lhw1NuHXclsLDiGHcfUBnKZe/sIx0kz6JICFA+2cTpDpqVDFCytG0wMyxRxibwdjZ7Il4ytbdVoBED6TSBNCbLX7lBnKTOUXZxF2o2nAngN2KboX6uU13NKlAVjWsOwqVSAwGjKo22ARgudUtcr3jbr7JqqgS73qGbknEAGrMVbrKz7oxe06mx+Z3Ct8DT//JMvxjD+NC4EX461F1OUiEZ9Fo6PQak4+Q9cFXp/RXYwfqdetl701wUChFKMN42b+9HHuVV8vC2TBo2vXVGDSCqz6sQl2sSK9HIcSu0Boa7ZhMwb2bxhfVtCl19V/kBwlpSpmxq7XRkqEtPSbqTM/gr6VupkEZLO4fWYHXTxiKN58CCXNsCME6+O0Pc7LgEgroA87HqGzRqHg7g1iwoZdilXwZ1KQgjzcFdjZZAWs+iOv16vVkgmkBYdJF2PuA6s/DJnibdlxZzJwDhCu6LAGRQmeH6TpWowl4bxmBRWhagC2iAc05T0HOmEgY2Au9Qj3bpoMwJCCe7bsTXYPTvhMNbNy35wNACBQfebVUHW6cb07j9jtu4NhM6gGYFw2/BSEz7shWMncc+X1RAvc6jEiaCB4r2pC2MMTlBMZVELQMZ8sm87CGvc2yZLlbHzL5AGkM370hIm3UtpL4vKf2U9EEeSP1X6XGmaf1u5kU+BYRD0+6xqOhky2zr/PWGv79/S1EEBfVpo592XV3EGVjeB2AddoXuX/mwwVzp5WiI5K2oRm6nfGNeDSKS00DeGClvsFMQXpYCssEzwwNTL5wNayGwm/Z/EJA80jz7ukpsB3THWulMHV13IAfym+m+VAleRFOX4kRD6SEbCCQl4mKfAWCOJhC9AtoeUZMtbl7SD8aBayBoffyKhlwj0/zovihoCM2J6cwrkAYIoUEAvaO8n82lBUATNBjkBuFAz2jX69Gii1xgw/YFTl9mr6KFjXbxEih0lDTYKeQDaGlYWEA21FAdcME9yQnMc3hDivcvCX9w+QmbsVAVDI0MBeQQnLNu/lxhFsL3+SBgK+Gf4ebcDyzS32AR/jFu+gc3v8IG6fcDNwhHF3qHHr2JKxWOxa4GvSBc5MDZFQxAfgK1S3NJHLvz9aTBQRjBdTjkIZooUtwD+YcX9bWmaXD04mOOlQcfkghzo2hSvcz6GCkT/9bCKBEhhWrfyE6KFNm7EVoFtQCBILKAYro1Ge9EBFtVWGDZhCwaHNAQyAnJH8MtiKZVBxYBAYpEVEJZkQkoCMNQb2xFRX4AJ8iqpu7AqLZ9YXR/yB6mA/BBYR6iTfPcvZZ4yvTwcA3VjiY/9MkL6fVUNBu690BZQJXyQOShufFPKAW2dg6qJaPqaRfwIi2p+/pxEpdcokQK3RHJqILUAfKsNV1uRStfGq4e8Or4COhH4vE/IvJ3PCqY/hWNgDH8y2hcU3c+NAb0VY2If0FNd5zlrVtbph0h75BRgNL7LH/ePtT7LAouIZ6E5v/6rFs9Yo8NQaluBzGOrKGMHVkrFJe+bVOGy7B/GAhBBjJg75Wx8G/e6RgXkjmsCy14jXxw+63UNLEr04kNyoc4BNw3rJ0r0a7S3L/ebkgoIU3XOR/oYyHZFn+IkR8FYWQQfYgUa8hjrIJMUtkPsgHxr191N/JPtdzzIlqomkJs0dZIJ0rB1wCVQlNSLeBzyAw6N4vEM1B34oIfH5zBSOXNT4Mp+a8iHItfoMZdELWsAuILvO7QH/VNQo6rWzx9o4niuNx/Alw25XGqqBW8GS0x0TSN1TcuirqCbick1OFedZ+IZm00BUGeI6Iw5+7wwDNekAElOjrPoEAQ7vlaLndsJwZlnb25zTqYKdmUHgoVoW/TbQoQRyzdJ6egYhzH0x7R4sddUrh0GdT7wJTo0UAhkp5zgScViyGnkayJFFkIPW9+h05xySh/5Sdw8JFU/JvgRGjuWkxoyPeWx5SFsobrf+Nz3o0uOrgyBhFBfZHXtly3UTF9g4+Bw4iobQRTCahTcObjlt7co60nhwsZBdPNRKhMbYcFF39nVRsJk77A2qiMd8yPxDQUc8qtLjMhaH6n4s/cxkTEKvwwky/eF/Bx3lD7/INVCN8X0LRRg/vNekelk+FYGNfdY8IvYHUQXnZN7B5cyj2zAWqmX/idg86erDH7wYsiP5GtFcqPFEfCn70MQZ7AFbbod2La6ap4VgiTKoVgGoaku4ZMKOzW+TVv1V7KG4HMipBvtHCASd/Jxc+astMWOkDIOk0ZW1vOVZT5PrWESpfBRY423JcjvphjR0FHIPgorIt1VCrZGzjsbhQQ5EDFYudxaui3LJk1YPxw5fQVGo1+Gp47uF9F+R+dGKUKbcEHMIR1Cdk7Iu02D0X1WK4R4+7apqMdkDdMookuMgfea/phsvh3H8go/AOWFZZiQWWFjHhGiqSCUySO9FC6wXN41dWxHwSYPTG2l6cpDTYLzeNgMRqHoqKfdoJN53Syk04No6vmpGJKrscZchpwv8fe+U9EdomvwN1Pxh3Mi6LVtAFtaQitxVbBbSWOWKFnwA4suZPO5n+75os4exayDhZ83KN+ZnjdpGdaHAvut4Y5n/LGW7RKye3E/CiA5Qt87ANeWC14hAhGfLUIVEg+1oduAjaf1Apo9P/W9KFvcN2jEGpgDBoLPJz/puvRFGyNlWOhEhtxu9DRKNV0ozFB9xP1Y3WUTfFGRM+1om4xKgHeKeGMB2oEFje6CDRa0cBIJz/FchGAmHATTihQBojPgf5160WbqQpsN1IgDWFfup1Yd4KzMXjXpZQlbpWOIE+U1UkKqT+bTyXjre0dZ1U/Tft64hr/65nghzq2nw+q0zs0kw+2aMCBLR3UZZ2IMJQz0sUD0Zz9E5YS4vfmQTy2lwziI7RSITFofBE5qbGwBD/NOE8rUi/gqnk3AjzIJef0w/4+X58ISyh8hDQEQu1npzAGoCHoSE8IzskbcY76Wl9z/8HWH/JLInx7oUFd7APzRdOjJQgM7vYYyUTSucMPiunOIMij04t9FLqfV/81VuGXoH0VLjIL+d/84G/gxPMp3vAuQo6OFxH+Ha5Cd7k5Ue8bNUtwn1txU2cWDOIUJOeC7JSST8MPjXZVVAP9TEmddbQdoQX64PA08TZsxi82SzY2G95A/0CUbjSKwxIiq610mIy9IJmmH7AOQFE9KJQe8pgxyi4EAM6mC1HLSsshbMJO1Pzgjj6DWb906nvgnn7xBgoPQENyHul725zomKKEDXMMs0A/AitvQzdvNDVvmDMo5BCJd6e14c2Vhr4GmYGAzVHUq3+TMEv207ca/HAPoda7Vcyklg77X+9nFfXgehp7dyraEC1HyG8FTlOyOsSRlbGgWSjAFHCnAnfDZ2jq/NqAkGzsQETfUyaHlZXL6ogHrTopSECq09eoP4llyTvWC24H4NTNJhpcpAhXq09Wt+GYbnul7vb+nbF/TL0r9NcFqh8PrYoK2OHRb3QHiysgU2DERaHhACp967hQTKgmcN2JWUreSXNZHUshBZOCLnI7GlCFKArV+U7Vp94l5xB9MgRbH2gYGQOZOj46DQeF3tG9hrDU9mQOThdP8mTNfCrnwJwISKQPnT0uR7VNigXpWiEFP0Lxr98KaVRvvbFK9W99yFLG00LSEBRM6N9hdpSdn1v1xajAaNI5aoM1RvOvbtFmReiHev0we/lXd/QOdgDhk35za4XWdq2Kq0CLNKSaZSMmiFa3b52utEkcBgkaBtPuvCgUnUfhvWgjBioKqFKmzXuYpxTl/eQshPPO2ShJRza2dD8dmfb8nMrEf/mI9cczhuFgqAQhsyhVlS50UbeZhXJw12E90H4zEaXeyEpzm1hL9S8p8IDmB3Uoe0SMkyiamhaFiUZRkxc/jhjIoYNyQNaQfNBIVzUIyF2vZUKndnGxeMRUKB8atHpXwjJENI834Aua3xE9HrDApxJwLZAABnp544Cu6gTzDanTXSRBCgWnZa1TIFQX/aCR3IJnEahlwKxX5PoZ2xzJv1FDSTHR2I/yJ5bIE+PfISQqkGpHdqMYFqq1uu8F/1n8izQPIr5lhztexUKSUDfKYvHn8KA6E7wzR1wtru04SeGJVKUgRZzL9yofVU7H6QEpk7p/0zasYFQpSSG90K2fcl64K5m79bFoTBb91AYHjv+/uSLhYRe6bvajej/vvKkVHJ0TPF4buZAoev8WpEDemJctMADcTzd4GkafL0juiyEKwG0XETEBfR4bioCLBmZlDprvZuGtR/zHJPHinE9Ok5/YQ3yYCfrV8iOC1oAVOgDBDksbjH9wOmwIuBPo5icdgiwS1wbND9YU/UHbRZBMgo0IV1jpSUKhQlaYrnkehdAkrI/jgs7JwVWXutTfHbKGdLO6gSFyCyp2j738tB41BgTSDRFYZZQCTKx0bOZkVEiuHFbhtecqYjkv107p0VeeJ6GFqZ+UMrS5tr5BQKz3toOfxbe3a1dtvW+oRnvdOiOWQK+fRFWJgk9hWwgNBvX6peddODKw713i8VM+1Bw+zzXE80FMMd0LY9XoxN0P/Nty75bP4xRkTPHvFMwzuwKeBW3l38aB4uaPlBEG8s8HGwhv/x9y/hPOIdIfHx3GqQAAAYRpQ0NQSUNDIHByb2ZpbGUAAHicfZE9SMNQFIVPU0tFKh3sUMQhQ3WyIFrEUatQhAqhVmjVweSlf9CkJUlxcRRcCw7+LFYdXJx1dXAVBMEfEFcXJ0UXKfG+pNAixgeX93HeO4f77gOEVpVpZt8EoOmWkUklxVx+VQy+IoAowlQJmZn1OUlKw3N93cPH97s4z/K+9+caVAsmA3wi8SyrGxbxBvH0plXnvE8cYWVZJT4nHjeoQeJHrisuv3EuOSzwzIiRzcwTR4jFUg8rPczKhkacII6pmk75Qs5llfMWZ63aYJ0++QtDBX1lmetUI0hhEUuQIEJBAxVUYSFOu06KiQydJz38w45fIpdCrgoYORZQgwbZ8YP/we/ZmsWpSTcplAQCL7b9MQoEd4F207a/j227fQL4n4ErveuvtYCZT9KbXS12BIS3gYvrrqbsAZc7QPSpLhuyI/mphGIReD+jb8oDQ7fAwJo7t845Th+ALM0qfQMcHAJjJcpe93h3f+/c/r3Tmd8PnXByuOaabnkAAA0aaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/Pgo8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA0LjQuMC1FeGl2MiI+CiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIKICAgIHhtbG5zOnN0RXZ0PSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VFdmVudCMiCiAgICB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iCiAgICB4bWxuczpHSU1QPSJodHRwOi8vd3d3LmdpbXAub3JnL3htcC8iCiAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyIKICAgIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIKICAgeG1wTU06RG9jdW1lbnRJRD0iZ2ltcDpkb2NpZDpnaW1wOjIxNDZjMzUzLWIxZjItNGVjOC04NzQ3LTIwMGEyYWExM2ViMyIKICAgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo2NGViNmI2Ni03Y2I2LTRkZGUtYTI3OS01MGY0ZWFiZGFhODAiCiAgIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1ODRhM2VjZC1kNGFmLTQ3NjItYjA1ZS04ODk2MGQ4ZTk0Y2MiCiAgIGRjOkZvcm1hdD0iaW1hZ2UvcG5nIgogICBHSU1QOkFQST0iMi4wIgogICBHSU1QOlBsYXRmb3JtPSJMaW51eCIKICAgR0lNUDpUaW1lU3RhbXA9IjE2ODQ5NDE5MDM3ODI2MTQiCiAgIEdJTVA6VmVyc2lvbj0iMi4xMC4zMCIKICAgdGlmZjpPcmllbnRhdGlvbj0iMSIKICAgeG1wOkNyZWF0b3JUb29sPSJHSU1QIDIuMTAiPgogICA8eG1wTU06SGlzdG9yeT4KICAgIDxyZGY6U2VxPgogICAgIDxyZGY6bGkKICAgICAgc3RFdnQ6YWN0aW9uPSJzYXZlZCIKICAgICAgc3RFdnQ6Y2hhbmdlZD0iLyIKICAgICAgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDoxYzNjOGRkZi1kMjVkLTQ4YzQtYTAwYS0yMmU3ZDYwMzg1YjYiCiAgICAgIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkdpbXAgMi4xMCAoTGludXgpIgogICAgICBzdEV2dDp3aGVuPSIyMDIzLTA1LTI0VDE3OjI1OjAzKzAyOjAwIi8+CiAgICA8L3JkZjpTZXE+CiAgIDwveG1wTU06SGlzdG9yeT4KICA8L3JkZjpEZXNjcmlwdGlvbj4KIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAKPD94cGFja2V0IGVuZD0idyI/PuhCAHgAAAAGYktHRAD/AP8A/6C9p5MAAAAJcEhZcwAADdcAAA3XAUIom3gAAAAHdElNRQfnBRgPGQOTjc4FAAAFdklEQVRYw82YW2gcZRTHf+eb2dlkc9lsrFYr2notfSgWxKKiog8VvIFI9UFQEaWtYPFJfREfRRSEeqlttViLD/WGisYXrShWpfWC1WpSN5eN3cZumkuTzWY3c/mOD9lI0WSTTXbVA8M8zMz3n//5zvl/5xyhxqb3ewYvaERpAvUAFzCABUIQH6GAHyvKa76tJbbUjMRW4+LbC7GsQbgCWA+sAs4AWoA8MAxkgEMo32LoxDO98oIN/xdk9IGUYEYvRrgduAW4Gogt4NMA+BroQHkfm+qW3aP6n5HRTSYG9hZga5lEwyKWKZVJvQCmQ3bZ4F8no5skAXov8BiwspwXizUL9APPgOyVXTr5r5HRzdKI1TsRngHOqlHuKTCI8hhG3padWqw7GX3IddDwcixvAefXUkTKhH7HcBfifi8vh1E1H1cfGkGYxPI4cM68RGw5zf3y3S7IuedgeZwgTNZ1Z3Sz46LRNcA7Zcmd25yGgPWP/M7q65toTLZSHBvn6OcFDm07n6g0n9oNAxsR54DsjBYs2251QWAbgFuBREX/tF3rc9+zA6xa3U5jSxwxHmpbueyqOOvvOM7rj67g1JfedFTNagngVtR+B0zUK8xiwLqKTmhcE3Dblk4uXbecRDKFmATgIiZBIpni0nXLuW1LJ41rgnmcvG6B59WiyRhgBeDM+UZipWHthnbcmDf7b8Y81m5oJ7GyErZTxjH1JCPzesu4ghtvBpkjH2X6uXFlAVEg9SMjhEAamFsyp4Yjcuks1s6uXdZacuksU8OVZDcC0mW8OpFRQqBruvqdwwpdDh+9cjaF0QHQv/2wRhRGB6afdzkVkKZxtDoyVaqZBKCHEXygcXafjhi63l3G9tIEGzYe4ZKrksSbzmCqMEz6mzE+eedC+juaiUYqhZCPchgkqKB4SzxntqQEO7oceBu4srIzHIitsMTOBOMJ1leCkxAMmEpRWt6Vg8BGTConOxZeSVdfzmwxHmpvRtkJnFmHcuYksBkxH8tO69e1nJEd1sdhP/BBuUippfnA+3jsr5ZI9TnzV33mFcB/DuEi4LpFr/PPZu3LkanES08fOltWnxe2Ba5xCEPXiHEAVG2oMS9UNFTVINOXKdamn3nQdSC8HMMeYPVS+hkFzQdObl9m2Zu7+xt6hkKx5fXktGumdNXyZQUKiPZGkDbGnFxqp+kh9kaUHeUTezHr6WRkxt/oa/toT39Lby6QqMoci4BJDB8vpTtEdlkflf3A08AQ1ejoTM8cyeRnudYD72Zb+qokMhNZLuCJaqtZaqDLLi0i7EHYDVTV7oZW/J9PNf3wanfycLoki5nQSFnKewKrnW5NNMhtKRDlt6EsB+4G4vM2/UrUNd5w5Pl028FfiuJL9SQUyKrqEXXkaNyLF2o3N9vUYKB0AbAduKFSQWqVKFv0+rYfXdbx4aB3qqQLDk8VKCKaUSQNmi0F/ujAwB9RTYeAMwoXabg2QvZ5jl4ym8Ip6FjgDm7/bdl7bw3Ec/lItEJyWyAS0RJWsmC7I9WM45hJHCfo6e21dZlozlju3pjnSnRT0tMXHdFzT8dQ0EJoTr2eSXXs7W/uG/pnwiswBZQw5NXaYw5knJKXVY8p8VSP9vZo3cezp1v2nniDK9FD7V70RMxoaganGJmJT0+0frbtt+RPfVN/EQnLo9sxYEREB6wxxweHhwYL4/mo2kSqi43c5zRH8GS7Fz1shMZQJTg41PzVU7+2fdNZNHlBTgI5ER20qkPG2qGebHZsSTpULzJH8slCe6ywrWTlrGTM3tw9Ef/xjUzLvp6idIlwQtBxa2Sit6+/VCvMuu0MwIE726RBSqlViaDli6Gm4t6e1MQveet3Z4+F9cD7Ewo4WRJBbaaSAAAAAElFTkSuQmCC",red:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAgCAYAAAC/40AfAAATbHpUWHRSYXcgcHJvZmlsZSB0eXBlIGV4aWYAAHjapZppchuxEUb/4xQ5AvYGjgOgG1W5QY6f10NKtmW5EieiTVLDIQbo5VswCvavf97wD37qyD3UJqPP3iM/ddaZF29GfP2s5znF+jw/P6W8P0u/Hg/5fTxmDvlJ7xNHf5//cTx9DvB6WbxrPw00zvuD/esHs77HH18Gel+o+Ix8FvoeaL4HKvn1QXoPsF7Lin0O+XkJ216v+rGS8fof/Ol+xEReL19/r0L0tHGdkrOVVCLP72CVXPx/CWXxpvGcS+XEVOR5H3mu5SMmBOS7OH3+TGZ0far125N+ycrnuy/ZekeApX3JVs3vU8qXIPfP12+Ph9S+z8oT+p+uXMf7Xf71+NgpvWb0JfpP8K+O+6yZVazaCXV/L+ozak9Srm4u4Zcegal1stOpocGrPyaPweIPpaDxxM3jpJky6bqpJk0r3WTP60mHKdZsIQtvcj65PAdHkTzzKZ6/6o90s5RZtAxyeZ6015I/55Key854wnO1wZU1cWpODJb4yl8/wt9+4V5vBQI8ntSnV35z9mAzDc+cP3MaGUn3HdT2BPjj8fXH81rIYPMoe4tMht6vIXZLP5CgPIkunNh4ffVgEn0PQIi4dGMyqZABspZKSz1FyVlSIpCDBC2m7j2zyUBqLSuTzLWUTm5G9kvzFUnPqbllDgeOA2ZkopVOnw0ytEhWrY36kTqoodVKq6213qSNNtvqpdfeeu/SHRSXFKlBmnQRGTJljTLqaKMPGWPMsWaeBdBss0+ZY865FtdcjLz49uKEtXbeZdfdwu5b9thzr0P5nHra6UfOOPMszVoU/NCuokOnLktGKVm1Zt3Ehk1bl1K7Jdx62+1X7rjzrs+svdP62+MvspbeWctPpvxE+cwaR0U+hkgOJ81zRsJyqImMi6eAgs6eszhSrdkz5zmLE/grLTPJ5jnT5Bkjg9VSbjd95C7kV0Y9c/9X3oLUX/KW/9fMBU/dX2bu97x9lzV1ED5Pxl5d6EGNhe7jnJUH/+jW31/D+83KPiEmlrd0ZremEblUT7eZm0BzexaimmXYgubnuEPvkbQGa9wthiOWrraVZNfSbR0D3dM5e18pXeZJJmnLWKdvldHSuKUOsxOt3bbTboUw2gyslJWdOaVdy9qByFHOHqbkHGo8yhf7pMzaZaS57phW01Jel0mrG5SmjUNddDez7oydWuXyM2lNdiFWXboPJVg7FGLzCt/lNwpH8zahiOZobe1kVcJOl4zlA+HOkZfx6ZCqda7d110dOqk5j555J51FiWZST5Qtdd1klCVRBYFSJPLQBhVUm0uIVsH9rLkAPGR3mNdLnms6F9jxCstcglo/til6U1v7hJm27l3rQ7HE7SzZVqiFqgKlzQ0BSa17KIOX6mWnnHzLOfToTkNLH9lgkXjuufNIsdmoM5nGyaSbACl51ihnS4t7TBrI9uikqdFIpLPGdaGkO4e2QBHMZEe8Ls6U6DWk+dBZ9VLGu98lM11aIjXjakwmrUP6KF24IvLlTbBSMKXAz7ibZFg6JtIZFqmoicKJlpnItETwSSfBphrjGTYkkzzqgArxS9wA7/o/amHMG4VpUQ4naZO6llRb63b19J1i3g9Lqy/ptx4Jf2yej95JmyqnPp40nD1FZ6eEE5GkmCLLXyizGgweEiqMDJ59WrKiWnajjLNcFMFdh/WCApcKnDU3Ymiqex46z4jy0O5rCny1U8sU44naDrlFlpBoiqK2FSlQEkHj0YlVtbmq2OSJIt9n3XKPnkuWEFrHx1cmu67wCdWWb26RPgIq6cbWQSCh7ae1mavXCLiYj//UCeia5L5SWHfOUy1nmsah0qgDFAnlMSvhAGM7iEUB9aZX4xO7Zb2Agc/b+D4UPt78/jq64wBC6Jaup8vuDiT7JCo/slSKKILbA1xMusPOqh2o3McIKmivFJLa3bxx2ChgFek5k49tFcrJazxJPZAlqmxVaMSQfstACssdyhDQIDJr+rfDSzfXCzFsBrte200pvE5xAkmDNjbIohNm5klmgx9YnSeanMqY5A/FTwObIRibOeDRqguEXKfVlYUsDBao9WTlykDd1C2A/6v6HDLrn8L19fWACeBm7jfSqwkmzehsIIaOBraQNtfrp43aAEzqpEvhK1NPFeC4qG2jkWBXunMnuOISRcCYsAdsF3O7fUNnujpInQp4DZ8KwV2FmvtIOsh0MU0/t5EmSrcCsRpAyod4KFVKDYGfrdIxkSyVp42oJ1W+RLmRdmi0Esc0V7UIzJJ//A+4FBq6GJDSNahvqK0ceqdOtLOlCY7I3aUpxTsUdtOZL6m/rVwjKAPk2qwfngswTfY1DlqXBA1y3zIyIc/qRPHoW5SIy37KpWFJjHxD3I6/c2bOA3y2hQ4pYTZgbjokXWhk5NuoOmZiZwI/XVUnUEJFcawCmm1Ta/tw3ZnakHNtNGbUWEmVz6sXlxuq5lNV4lOqIJuQU5QHEMeyooAIrnXphlkdMea0QBdhgMjIKxu4ijyOJsAkNkSA4nW3zegoRhLwGvsiwsZFjaA+vJ+Pgl41LFqKTBzKJzeY4y4K5XoNc7nis0wgQnLKo12glDFaehPgz6/h64EaExPNTwJAe1DE3wFUMBxd4DV7naTKl3PCl5MMxeG/EgQoy39r+w5UIWwAZ7wmNqNo/ZhYKgiEmkMjJViEcWAN4ggPgzAdfloCgu4iHEgRDTcRcXnedsSBlODF7lLlgOpER4KNup9IZKHakS9TXDhct95PHzZaH3cFI3KsEcHSDhw4pxZUZEFXqYrF0L1DQXjKGS3CVVwx8nDWQ8lEU9eXCBiEat99LPSlgWplOVQDS2NDg3WSNSQYde+YyYCuVZNkYNUgND126YEyidh4loQEG2DBs/cx8KWQNz0yTgqCTkMLmclevB/oQSuswMNCWvYAHh277jmLiswGO2w9Q1IplD35KTr5Hkwr71QA1z9KYTfXDe9ie6JJUVGMgMsSH6YhBvcTN5Z+bw/6BkhdiOf4X0Pk+Qpv4YVvn/BmtOy3CPg+A8gw+v/J82EJl0ikfsma0i508WtNQFu6GJ5nsZ7sTacCgBfB1FmObYVEFLW3GkrRWXPP3mc5A+7fEinK4mqRU5D8gGpdNjZaTx7lfU3nAo5S7q6ZuzncQWjEbqGSyCJeBLuCbu5dB2B0NAvwQyBz0dO4KqIKUmzL6q2DRavRClhgVIC4xaAFJtpuxYBysKndvZhDL1fAUIGdSPVI1pj/IDsdOKzaO8oQp+O6V3E/4NI4XnZr1TBg9+zyic6BWbfzLUlOLB6VgvGd9dJlG2R3DQsnLrRb6tTGFEK3xB7SD1RT3S59Z7c2jisR42rokoQEIGggP4WMs4k1IYD3cOfVdnNjhiKwU8dM8YaSfVVYkKt2aOTuqsgBZY7jUazQPnqrocQgNSYPRF9E+SvLGIzVnyRDRzT5U7xUMb2wAFgAhqoHIja8Y7WQRurG2vHdnqeq6N53vShmnb5r4SmYj8L506vjGsLOMErgHKOchXNdCpdq3QKvrjCj24kXD1E11zUiyyQP1MMjC1GiLD4NtFbhbGXGdkY8i7TXDL5BETfhadPCzeugxtwL4lmKYfiQ+XpIzLxwA9hIky+ggMIqYFfDmiPa8AX7XMRUP+GAPciSQmZh4Q3ckRH3wIhZAsCijAbKl3J+pBtLw3pYK7n4IYHuIwk8Qdyjb+veV3i3lQFXjE95i470ifEZ34URpc53BJVKlIXJwbJgCB41Ag71DFpSqxtLXgf2MW3cvBmvhAaOZEiIFY4AVBNM8UITXn7AS1iF7J6pAoWAjmh4y5Wmx51o7qBVgkfol4MYBDQ6qnu60cLlwDyLZYLAnBUqs8u49IqKPjh1RKKDN4iOh8DC90kXJ3xR8Z3IXSKZY8wTHxaiwMkIazyh4r9Gh4PQgzQ5mi1l/HgDodGAEMOgPtzPUKjxDvqs3BfQ2QO0J2IC73XMhu3pL5h3OK0uF1GF9tgFiBzAEbEjPTfS0cXuhVAaV2toiWcgvopYcMpGI0r0rdl00vNRBbx+vXb6+do4CCDx7s8BhYZKAbGVsYEF33o6xfVwbB6PDhm42oxaeA0Pis6BgJjTlTqIdcdjI5CuK9YAEKmrYea3ZUCxeBgkMLVzXT48dD4WLX4TigKZ1x4yfWTZoIw5Yfj9Abj/j9QD9LCQRHR8r8ZAtosh4YsTZzwE6+t04rsoc2+g1h5gIHF4+O1J7Vg+NGbz7SfwOlPzvqVFhJCQ4mnAXHYqSrG5AGNBbEqAGmFR7CdXyA2PXUBbZDh04fz6OMUM3MHoVfGpA62Ch3LlCzVgC7l8h8oDzdHdYxXflJvm2zGM3fYpvodExdcdIZQVxzzLN/gLhzHDXBEgfgFpqgumRYc6Z2AyvCqVChakJ3UFShQaws6WkvrLRGBZ2vdBDT8fmO5ZrS1WV7AY6aEvuGNBCy6dENU+H7cj+IjURXxTlPiK5oBpiACdbw2ydEwhPeXgVeb0ZnPzCSk4aFIe3c7D+pQqdIRsEnklqk/0kTRiCrR5Cwx7NlvcKcK/+C842Hscz4SUBV8uHsfcFaHWDgNiVHyPq2tg2I0GwSGsCArBXY9aaonlIA/89/xSTMxu0YksrZC3USmjxhTd1OydAjy7HAWjs35LiSTJJGK+1fLY/jYha/Vtoc6KLD7NAwjBqov6ivQQKv+1N5Lit2LeX0kyrAOWwx4Y324Y6Ta1Pfe28KB+o20SyxGKged8rR68DLyOIPFZ8CylJuyKu1OIFtC7cUjNvv1wXNFyGgVX0BpryQgwPEYaTYyRPB4XzBaiaPdjDIqGRRW4knDdjsiAkxdzpWuOpxqgQMMzl0uLjOmW/UD7ziKzeymC3sVo9mXbwe1RmQix8c2+EFYJ2pqhsAx6apOdEn2fGXY9rvHJmE1Ae+fyqD0sH6o6dwh1wtUz6c6+XccvEf4MCg1gEJAu+DwazG+DVNf1RCkDYkgs37VXmFBbf21t9YRme7YS1HcXi284Q9kfNGWse323t0VlvTrImQsPsQe6oMLeHd2EbPNN6ub3aUuCjRDEcgcWHxX+kvCkf/xHvW1E1jcoJZxauvcKydiCv48V37kWZQxtw4qJNODPVsIU+R44zQtroi0Be+hQX63ZyRriAqWJJEBGzKI6HJPsdjpG3Vc3onja7pSJW3QaDu/lW8PjGISJQeEi9QZyj2GseK/BcVrkzo6CmB6a4tMCg2mQY5Ir7qkXBGGv51Yy496L2SD5l4UJHQG9D4NFJC5gLAA8HHMB1ULcWPqjb/FcfCK03wHQM64NAO9+x/lQNAHAAX2YIPJ5gjLOmy259gcgyvU7L8idDkJ2yr1iWAUkKo7aIk9uF+QrKQAFiq4u8yDdIZJNQ+Ts+x2oKKSDb5VtVDdyAHQi/ANtRPG4NK/Z8W1ilCdNK4egJtQD80GKITglgrcAvDm7GAgUvenMrdOOvrlEwcpEut/RfSe/eJeHm6vvwhdX3gi1lwnEsNAm/jZX13mIJM+UrhGdBlhhvig38IwcJ8W9zsAUzqpRN4VOZ6jfC6b+sS/Y0+VtHOmH6PwKZYMjbnwus9HtO0/IURgRkxFYTHJapCqYIzWFN4BpySEpeKAeD6PzeaflxfmdVkq7ynBzOtqlqAW/BkrR0Y7mINvwbWv4iO6GSDPJHdmbG+xH+UW+DEnHia4hqdQ2ohfBna6CR8CN+u0CFILsuJOLZ99dv72NlBM1hBDGM8IP5TFZ/QAQhDXKyVAIySckQWg/67gP6hDcqVNQlTt3Z3Bp5Ksj2JAxfs+OKrZqmi8nKzhDDVK6ie+cEli83+7BM4qzhKseI23xey7482t4xHg1VjMBA+zFo89895p+Rfr4Ni6Ek+j4+ayNAovkBd00m7iCQrQSvXB97wCkxqsPopP00DnR7zRQIHs2uowUsjA8dPG/jrjS/UYoEgyM9Xs/FSUpLaAjORmgMNyebyyd3G82egkJ4rfESLTf/Lfie7SAK4GFZyh/GrsDyRW3gxoNiJjVkPK++Ygp9T1h3BB4xirxqpZXj7YAtoUcBcCwBRv9j0xh9EFhGOyOMwoO4rmNW/1GTWx0/FnUAZN0P19SxougYiS7BzkOfe63MH3Nd29lMhC6UvG0g7Pwn4sCXag3v1t6XXfn5RrBnc4hwNv3CiYVAk75nhTtZy6QhgFusIEE1Gf1sTiISULf0Q1Ukd8PtZuzAzk1bA2fbRAJUoZT0iWiKGNFpKKLerkngI3DN5P83tEsCCValn5tCSSoAFZ8NE5iZCGOFvnI2+fc0hSMyOP6hgheBC/JqM0XtzPY4ff3CcRZGFPQp+eT9FGVEXZAx5l6MPfTxBAh6p9mAdsCes1v4slb46vGhDSdrI7iP3whocfnC9FXoxzU/6gk3T51NDqRmqXEDBZpfvMByw0xUJeUSzQ5viPcMHg1uzxlzOnc9szCN1b5NBH44/uD8eVHwoMzBAdw5t/eZ7uSp4CG3yd2DETwEdbr9O8QEP3Wg28roCeRYRkHdKL6HzKxMGDwGRf0vRjBi75j7X6nFNW/ckp20Z7t7ZL6fRp0CBMDCbLfwU4hteMuyDWR35qZvpvj1ZDwnfkxnjWhUnmmRRqK67v2d+On/kdI/wa+GQTprDiGjAAAAYRpQ0NQSUNDIHByb2ZpbGUAAHicfZE9SMNAHMVfU0tFKh0MUsQhQ3WyICriqFUoQoVQK7TqYD76BU0akhQXR8G14ODHYtXBxVlXB1dBEPwAcXVxUnSREv+XFFrEeHDcj3f3HnfvAK5ZVTSrZxzQdNvMpJJCLr8qhF8RQgxR8BiUFMuYE8U0fMfXPQJsvUuwLP9zf45+tWApQEAgnlUM0ybeIJ7etA3G+8S8UpZU4nPiMZMuSPzIdNnjN8YllzmWyZvZzDwxTyyUuljuYqVsasRTxHFV0ymfy3msMt5irFXrSvue7IWRgr6yzHSaw0hhEUsQIUBGHRVUYSNBq06KhQztJ338Q65fJJdMrgoUciygBg2S6wf7g9/dWsXJCS8pkgRCL47zMQKEd4FWw3G+jx2ndQIEn4ErveOvNYGZT9IbHS1+BES3gYvrjibvAZc7QOzJkEzJlYI0uWIReD+jb8oDA7dA35rXW3sfpw9AlrpK3wAHh8BoibLXfd7d293bv2fa/f0ASM5yljz/NiUAAA0aaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/Pgo8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA0LjQuMC1FeGl2MiI+CiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIKICAgIHhtbG5zOnN0RXZ0PSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VFdmVudCMiCiAgICB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iCiAgICB4bWxuczpHSU1QPSJodHRwOi8vd3d3LmdpbXAub3JnL3htcC8iCiAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyIKICAgIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIKICAgeG1wTU06RG9jdW1lbnRJRD0iZ2ltcDpkb2NpZDpnaW1wOmI5YjA2YTAwLWZkOTQtNDc5MC1hNzIzLTlkMGUwNGRiNTRlNyIKICAgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo1MTQ3ZGU5Yi1kOTA0LTRlNWYtYjIyYy0wZmMzOGRmMWI3ZGEiCiAgIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo4YzBjNTI2YS1lYTkyLTQxYWItODM5Yy05OWFhYTM0YjdlYzciCiAgIGRjOkZvcm1hdD0iaW1hZ2UvcG5nIgogICBHSU1QOkFQST0iMi4wIgogICBHSU1QOlBsYXRmb3JtPSJMaW51eCIKICAgR0lNUDpUaW1lU3RhbXA9IjE2ODQ5NDE2NDAxNTU0MjYiCiAgIEdJTVA6VmVyc2lvbj0iMi4xMC4zMCIKICAgdGlmZjpPcmllbnRhdGlvbj0iMSIKICAgeG1wOkNyZWF0b3JUb29sPSJHSU1QIDIuMTAiPgogICA8eG1wTU06SGlzdG9yeT4KICAgIDxyZGY6U2VxPgogICAgIDxyZGY6bGkKICAgICAgc3RFdnQ6YWN0aW9uPSJzYXZlZCIKICAgICAgc3RFdnQ6Y2hhbmdlZD0iLyIKICAgICAgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDowMjQ4MDc5ZS1kMTYyLTQxZmItOGViYS1lMzY2NTRiNGRjMjYiCiAgICAgIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkdpbXAgMi4xMCAoTGludXgpIgogICAgICBzdEV2dDp3aGVuPSIyMDIzLTA1LTI0VDE3OjIwOjQwKzAyOjAwIi8+CiAgICA8L3JkZjpTZXE+CiAgIDwveG1wTU06SGlzdG9yeT4KICA8L3JkZjpEZXNjcmlwdGlvbj4KIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAKPD94cGFja2V0IGVuZD0idyI/PkaovgIAAAAGYktHRAD/AP8A/6C9p5MAAAAJcEhZcwAADdcAAA3XAUIom3gAAAAHdElNRQfnBRgPFCiKn0kIAAAFfUlEQVRYw82YTWxc1RXHf+e+N2/GH+Px2IEEV02AgqIsIkwgoYS2ahepVGCBUOiCRRdsAAnECthErBBCICGFj4gqRQqBRSABUrVm1URtCSATJ5ASZCPHH0kGgx1/xJl5nvH7uIcFY4iIM/GzZyhHenqL994993/u+f/fOUeos+nNnkHCJoQWRD0UFzCARYhQCVB8NFWWTwNbT99SNxC3GZfIXg9sADYDWxCuRekEskARYQplFPgEOAr045ph6bXRzwKM3pEX5mduQLkHuAvYCqSW8GkIfAT0IBwknT8lH87o/w2M3mpSqL0LeLQKIrOMZSpVUC8hpkf6bPiTg9FbpBn0L8ATwLoqL5ZrFjgNPAeyV47p3E8GRjdLE6r3oTwHXF0n7ikwgfAEIvvlqJYbDkY3uw4a3YLyNrC2niJSBXQG4c+Ie0yORnGSj5OnRhzlUJ4ErrkikBAoAjPVe7ik4F6D8iRxlGvoyegmx4X4NwgHgM6a8fUyIfc8doZbf99Ca66N0uwF+v7tc3DnWoJK6gqep1C2g3NEjsdLlm03GXSbAe4GmmvGZ91vA3Y8P8aN6ztoyaYxxsPaNrbcnmbbvV/x9ONdnPnA+w71otaMcDfYPqDUmDQTUgjdNYPQsSHkgYf62di9mmwujzHNgIsxzWRzeTZ2r+aBh/rp2BDWDLLQjSzpf7VMMIpB6QKcy77Tuc6wdVsHbspbfJspj63bOuhcV8u3g9KFJtufWQbHakfLdQUv3YrI4qwQ+e65616Jr6mknE4KJgIGgctLZnEq5vRgAWsXLyKttZweLFCcqiW7cdVP1DgwQoQwUNPJxIDDG7vXMDszBvqjDWvM7MwYb+xew8SAUzNowgCSDEwyNVMJQU8AAdC06DvBtOG/76xirlLi3u0nufn2HJmWTir+FJ9+PMu7B66nr6eVYLpWCgUoJ0DCGoq3wv/MbXkhmlkN7Ad+XTMY4kBTl6XlKnA8IQ4U/xyUx8wlB3ZpKvcC23Hz49K79Ep6GeWM8VB7J8pfgasaUM6cAx5EzPvSZ4OGljNy1AYIh4C/L6lASWYBcBCHQ0mBJOfM94rk+WjwAsKvgN8te51LK7kPpm3zK89OrZH1v4zaQ9c4RJFrxDgAqjbSlBcpGqlqODoyWq5TP1OtnoU9wPqV9DMKWlRnfJ+/6q3XKpmhSRVbXU8uuhb6Hq1eVsBHdDiGQWPMuZV1mpuMB/aPCK8CXcsMjs6pufCm3/7PPZXs8LhKnJBjMTCH4f2VdIfIcRsgcgh4FpgkiY4u9Mwqc4fn2468M58dSQhkIbNcwBPVNrPSRJdjWgb2AK8BidrdSCX4PGw5/re53IlBK8uZ0EhVyodCq/1uXTTIzfrExZ0oq4H7gfQSmv54IMqcfNFv7/0ilkCSg1CgoKon1ZEv017ar9/cbEvGEFeuQ9mF8IdaBamFuBB7I7tKq3r+EXjnK0tPTxUoIzqqyCBooRIGM2NjX8d1HQIuKFys0cYY2eeJ3riYwinorHUndvmr3nt7Pj1eVNEa5LZALKIVrBTAnopVRx3HzOE44dDwsG3IRHPBxrtTnkv8p5yjLzvoLy72oaC+mvOvz+V79pZbRyYvJbwC80AFQ1GtPevAqFPxCuoxL57ql8ND2vDx7MVW2JTOuMQPdxDvSInmF/yU1ZT+Nd92eGcp97+RH4BE1XHHLDAtomPWmK8mpiYn/AvFOCmRGmLTm53WOOKpDhM/YqApQsLe+dYPnym1f9xvTVGQc8C4iE5Y1Ulj7eRQoTC7Ih1qFJiTQc7vwN9ZUbk6Z+ydp6L0Z2+Ws/uGrAyI8I2gF6yR0vDI6Uq9fDbsZACO3NQuGa3kr3XC7H+ClvJeP1/6IrbBqbNno0b4+xbMlmARngcRbAAAAABJRU5ErkJggg==",turquoiseBlue:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAgCAYAAAC/40AfAAAQDHpUWHRSYXcgcHJvZmlsZSB0eXBlIGV4aWYAAHjapZlrciO5joX/cxWzhCRB8LEckiAjZgez/PnAlD1drrpxu+/YUZJKSmWSwMF5pMP+n/8+4b/4yTHmkLW20kt5+Mk99zR40Z73Z9zH+OT7eH9EPp/FX98P6fP+k3jLD/oc2Mrn+K/34/cJ3qfBK/3Lidr6fDB//aDnz/nbjxN9LiS+Il+FfU7UPyeS9H4QPycY77ae0lv96xbmfp/tayft/Rf84XzVpL5PP/+fK9Uz5TqS0pYoD4+fYkkS/ydBBi+UxySZA6PU9/V9LJ+VUJA/1en7p7Oi40vNfzzol658v/rRrU8F2NqPbuX0OUR+FLl8P//x/RD1z125pf/LlXP7vEq/vr/k2e+KflT/Fv9YO3fP7GLkQqnLZ1NfW7yvOG5yCb90Cyyt0J0ChhrP/tv5bWx+AQV71jP5XbHHRLtOzNHiiCfu+7ziYok57ZAqL1JaSe6bTWrqifXSv+y/8aQqXUwaXVy37VnS91rivWx/VrhXa1zZIoemyMkiX/nHv+GffuEcH4UYvZbjrRXrSsmLzTK8c/7IYXQknk9R9Rb46/fnj/dV6KB6lX1EOqee7ymmxv9jArmNFg5Unt8ZjNU+J6BEXFpZTBQ6QNeiaCzxqSlVCEpSo0GDpfvMTDoQVZOxyJRFCr1pyS/NV2q8hyZNvB14HzKjEyqFOWt0aNCsnBX81NzA0FDRrKpFqzbtOoqUXLSUUouT4qhSc6haS6211V5Hk5abttJqa6230VMXSFN76bW33vsYXHNw5sG3BweMMdOUmaeGWWadbfY5FvBZeekqq662+hqWTAz+sGLVmnUbO26gtPPWXXbdbfc9DlA7Ek4+esqpp51+xnfXPm397fcfdC1+upZup/zA+t013q316xTR6US9ZzQshRzpePUWAOjkPXtazDl557xnT4f+RBOLVO+ZRe8YHcw7Jj3xq3chvR31zv2/+hZq/qVv6T/tXPDW/cPO/d63P3XNnITX7dg7hV7UR5g+Pt9tpDZc7H57Dl8vmBBZjQJKZuNivLe6qJ0KRa10Ri3sSNYUdlTSNhm2fHrW3q2WHUz5Uoy2+qhR1zpd42Kfqyg8pnJK5+GxtfY5jWIPR8pZTsbIJJvx55WD1SrglQsUYzWZesXZ6EkvyWy2BWNz5ii8eI4Oy0Oimkb6skc7bSy6pxpOdJYYfF/3mc9YVbJGen163LX5y4iCvNVAAtgR2sr6lTeca5byylbY04Zy0lkYmkRfF1ReNGUqriVaiyxjp7FhRh2DtvV1qia+03tuAKqzuDlD4XICE9HCqRXrsGVorgIPmcFOOteac6Su7GnsGruyokw9o4BjmR0ARLQ/jwP6BpXm2fXsKYML5BPnaTWtkxc79oIWNTBfe9+FB/A3Oe2s0XJfVYMAPuF6JY3l7goPEzen6iXzT9eoNnwSlc5YYkriFIq5D4N668YUQbg5qBuit6R/55niMfQdTow+0WNvrlaf1sLs3mChUH0c5PChozp06pmlnrJKn4+UbX1r7SOmvPuc0vZs2/wMjDgk0VtYqxjIM1dYscoJtGQYvTb2n5n30Tkf6BursV16Av77ZMB90ucZjDxYsOCHFZuw/1vDvlhJ2YKlPEbd6M9gX8Of00jJTeEY176YG8UDIkBnDqWu7YSyZCM+pjMmOzPXqic9Xsw0s7SV/vW4vs+h3T69/xsRhPcJA/Sdzz51OUPUep69F73eWyzNJidiM5NDYiJEZ04GNnB1WcvGinPN48iEv549+ZStTUt7SN8AY5cIG9bWk7bOPPaUgcRz+LSVmWDI8kBTtZh2O42TplnioNGx7n0YJGe0/MGpMZq1AeLCRxkQIcHZWtMZWkOYa88AP85ZhWvSFmu7zEatE3LewfssC3ZnGhI96iseCHaPafkLlUH/LhpjPVm8LgypZPNX44wGO2V4BWJzCQCLcAzitjMDL/VsLue27FlaJ3tjC3UIVH0aX20MX/5u6a6/UK2/lR05de6JOMTWtzzmBhEZYzQ5Tc+QRtkKC9YEqcF9A/RZKmUGwysy8sNYYWlXNWiILrihT3uAes1rQlP7OTTjHJGzo8IDA+YjV1BReKcFo2UGWgBGbZy/l2nQtwGauIVsUNEpOtFTNdaky7kYApqIyuqMhM7HAEsYYApVU0e+i1uMrCdDT3PpQT+o20OXgEPZwBKiy8REeBwv22wNhA5Bw0S4okzNG35mqDMMaVTl0jZunyl6QV/5IMFkSB8EhX0DGTOBi1E3FHh6YICd/fbZ4/06lbX8tzHBVIELRJmYhTI5dvUigxWcYq4Df0CDx70vPGi03hkp6OEsbTWM9+TQzpH22dKT0T0MjdSiEHJh5OJZggTYdLMzQTrDW3BGMmGpBZcF9X0z4AtKWwK71Mlw8mpfgj5HYVNo7UEJEzPBtxjkTEBt6xiDdAYsVyTggptVFBK7tJCwXhycUQBHmk9VZ/3J+pb3qKMXk1kDsJQHfRGmOO1mD64WS8OJ0Eeqv1D4zfekuw8Alrkkx9LjBMkc3TpyalBHtw5Xm1+VDScVdJByj0tUsFq2crIXUjrAbSZdLdHUDWjevuKdTvvuH+xOA8I2f1EAKCEsU6bqJ4QXzzao7UMTENho75h6mPnDc/jLGx7P0oco6u9EYdiMpB/YXNQAhxc37C0AG5j2d1zgmN99oAv7G39lrE2WwVFQSAFzbnfZdi/BBwI23hOlS9XNbWHOC2yaHOWQ9oTRCrS1eQCsRiZNyb0OeIoHcMQ9FRzlZgfXBoPgG/YqcPO5y4YO8EsTN94fJ4UOxYCqOfjFF1d8ImG042Oa7BbE+CgSfPkaACzizdHSzO8HQQSivWFjk/uYPAm08ML0Oxlj5EZNYNeJky5h4/oWxdnIP68xUhgQCmDb/TYGDPUfczW4nmnWYhgam4adQQ9nq24MODXIPlg1aQgIBmG4KYBBB/XDdGW3ZoYLVazkgYAIVFTlwK4oWesYQAwzSyS9Bwwc9beJo2LIKe9nhuPWn5j7E+S+ARf+NuJ+AI5xvnBboOjArMH78+INjoT6cnMQWNkJokBBi1tjvoBTcpOw0GLGKTvF6zLyB5RSqzEiWyhCQviNkiMvIpQOx4LrwlWnOuDTzs49wpNvcMOgHkfsdhrCByEJeJQAQAYxI/9cPgrQYWbsg7iGRgjlDKlb4Xckeidy0ioTqwt/kXRC58hFGsNjt4ovxYBjL5W8R/hT7XnW99wkrPYXxgYc+FmK293mkftBSbYluHaDfDay1ODagSwdcVET7CMc1zkXWy7L8wYA5IChD6II2pNLesCUUOmHHDST05V6iKiQq8PmoDmMeNcbZK6FWBVCpawscajPgdd3bJw/1UBI8UH1ysPGVCYlDDnj6tmki5t/5Jb7oL554rFh39P35a524lgrMIZUxqLORIcNkO7x/RXcZPyxGhIwZcMpmacKIm3vHoF2AEv6TCwP0XopjZ/uAeBiPC7ChlawzcowIPcoBGrObFFLl9TmbeE0fk8y/Abey4xQX2OPm2TjWefgu434eMCaE7EJlhrXcpAJ5sr1MLB+qkP21oEJngtlRWw20WXjJTHJfIOMRjlLYYc7ERNIxcL2ngjaKRDb3zm4D0JVkQ76ZejoBgasfHm8w+27PrWH/0ZoMvZ9PDrgEzzjEkOQzDnJbkQI1HJBrBNpg1bh54gCP57oSZoZzBG/1hJscm+5OwOcymQAn3kqafWSBWYU7/MR/H/57Gk5ne7UuGEn0+RqeW0SRBrZ8rM2bkQBoHtdbCbaCiHS3GevBXYqChEHkZM98k4io4Fq0ihehV0el5yi7vcsRCzHvmBbM4Oo4a4x9YohJUqwb6FgdoRVVSNIMP8kIi3drSHjMD0erTpCd1qn2+IAyR4Xn+OxoVV4EW9CcmBAS3FzARHEKOWgUXZ3TSn9Bpt/xqxBOeJI1a6CyMAwjRiF3/e/JahO+ALcwOUv1OKf3VvwF9jMhkhgPI3gb9uQQhJJzbXjfvMaxLbtaRxOwNgCb3X4uRYOiz7osgKpTT2ZiC2mA9JthP7l4XQXDvNIZH6Nx/1KvNcgGfl9pfVeY7x3uIN7qsn6VckwqA/DCE/hAwWjS0bT5PMFh6KIU2K5UgGJ/Ix+4YFxAUUpGO0Me16HlBLJ7N7AQusY3EcIWpSY/uKmPCBwIAFCvQYH4Sq0P7IYOMwnxzWcdIWHncQITB62vKWGnQbwwIIh89FHLkkihUyJojCjWwnCoSMnqNp+Ch1HL15exsqP9K8hT6ZgXSU7pmveB8AGGhsxIxlEyHRUR3cGFd8hfjvtNrz92ygnOfjoHMkd29zd1JwEFSO/SCM5lh17sqkGRs7usAhuExZRQktLhdkDmdiGOJg1RK3xBb/1jrvVxQA0D7/QbBloVoU3K/pM/Ohk1Qaj8QVcNmkrI0FV3QSH6Dcw8A5GhK24M4zXqUJ92Tk05ARIVVudK89Xbcltox5yHiNKxriMivWDmO/UTi/bMKIGLoOeM0TEp1z9htwS1HXZ5c5l8EYb+G+mFgEnw/UmWgJenLHN08Coma6DCSK7em/xWlxCM3XiubnDtT08jiIgBFVwljwbIIS6gjMmRtygIiwfowtA/G9kD21jsjGMrXa/fSBQYuxsTByznPXeSirOK3q7VisGrAOqjgQwRMAcYSSn5ERQfKN0QqVcZ5YyKPgX9sls0HlmaeJ8KromfhsYSNjoiZHmlExMo4iwUqrYCl+y3HtnfmNQi9f5yJWlV4OH5YUc0dd7/39TXvB8ovgND7Sdo/e9twbhx/fmZU7YeMcrEsCM0TDfzGyM9AxM+IgMBLI9JsPKaY+TeInkhPeW30IgFsQJbPrUODmW2UTFoTGuACs4sW1K0akJGvg1Cf/+ZtHnmbX67RbAU2uwXvYoDS8GzzKM5LRNYql+H/NQs4gJEjDb88GPp/sXRsyH39RdW+vohMhra6bf0T0EU4pL1EBKRvV8yMCw/e5BHtJwrJAeico3PhZTupL9jk71O511WcC+53vPadEifNmqD/6+Ca1a+B57arkpfxFk/S4oBApPH1aOizMC7lK/D7cCm8Gpmdv8LMsTKPbUoy1mXBbBt/uYUu7kt8X4iEBJVtkKezRr12rliBml/GgfMnphhinBrj0+tkwZfgmFOlagbcwpjomMXOgZY+i+WTBVpb6OMbB3ZnOgIMktAhxTMxLpZXCJvwYdgJdOAiLLEXEflQefJrV5ANNaUX5MRN1kPYPqoWe/TcPEkUmoDPyNRmNehZrh+bo7Yohe/P4KKbNMwW7XxCDD7hYmLI3RhiJ8hjBiC6vitzy3/9nFcwD2X+tecsqjzW1bh3oWs0z623xJIO5TgydMFMUaXh1X4RiCLcheaIZHJKDKqm4NMcBcTmjxGP3GAdIIVtIepjocEsqDaI07Tyi2npk9YovfGDpzY4E8CST/O91aOT5FPS24MRIS9Ze+hF+Ehmaa/4H7fwGCg3GYVGiblAAAAYRpQ0NQSUNDIHByb2ZpbGUAAHicfZE9SMNQFIVPW0tFKx3sUMQhQ3WyICriqFUoQoVQK7TqYPLSP2jSkKS4OAquBQd/FqsOLs66OrgKguAPiKuLk6KLlHhfUmgR44PL+zjvncN99wH+ZpWpZs84oGqWkUklhVx+VQi9IogYIlT9EjP1OVFMw3N93cPH97sEz/K+9+caUAomA3wC8SzTDYt4g3h609I57xNHWVlSiM+JxwxqkPiR67LLb5xLDvt5ZtTIZuaJo8RCqYvlLmZlQyWeIo4rqkb5/pzLCuctzmq1ztp98heGC9rKMtephpHCIpYgQoCMOiqowkKCdo0UExk6T3r4hxy/SC6ZXBUwciygBhWS4wf/g9+zNYuTE25SOAkEX2z7YwQI7QKthm1/H9t26wQIPANXWsdfawIzn6Q3Olr8CIhsAxfXHU3eAy53gNiTLhmSIwWo/MUi8H5G35QHBm+BvjV3bu1znD4AWZpV+gY4OARGS5S97vHu3u65/XunPb8fN2tyj8UDOK0AAA0aaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/Pgo8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA0LjQuMC1FeGl2MiI+CiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIKICAgIHhtbG5zOnN0RXZ0PSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VFdmVudCMiCiAgICB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iCiAgICB4bWxuczpHSU1QPSJodHRwOi8vd3d3LmdpbXAub3JnL3htcC8iCiAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyIKICAgIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIKICAgeG1wTU06RG9jdW1lbnRJRD0iZ2ltcDpkb2NpZDpnaW1wOjEwNGNlNWFhLTE1YzctNGI4Yi1iOGU1LTFmYWQyNWFiYzBhZCIKICAgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpkNDMyZTY1Zi0xOThhLTQxM2EtYWYyMy1jNzhlNzczNGRlN2QiCiAgIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDoyNzExODVkMi03MWZiLTRhZDMtYTJmMi1iNjM3OWU3MDc1OTEiCiAgIGRjOkZvcm1hdD0iaW1hZ2UvcG5nIgogICBHSU1QOkFQST0iMi4wIgogICBHSU1QOlBsYXRmb3JtPSJMaW51eCIKICAgR0lNUDpUaW1lU3RhbXA9IjE2ODQ5NDE4NjYyMzgzMjQiCiAgIEdJTVA6VmVyc2lvbj0iMi4xMC4zMCIKICAgdGlmZjpPcmllbnRhdGlvbj0iMSIKICAgeG1wOkNyZWF0b3JUb29sPSJHSU1QIDIuMTAiPgogICA8eG1wTU06SGlzdG9yeT4KICAgIDxyZGY6U2VxPgogICAgIDxyZGY6bGkKICAgICAgc3RFdnQ6YWN0aW9uPSJzYXZlZCIKICAgICAgc3RFdnQ6Y2hhbmdlZD0iLyIKICAgICAgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDo1NGFiYzNkYS1lZWJiLTRlZjctYjdjNS04ZDRjODY5OGVjODMiCiAgICAgIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkdpbXAgMi4xMCAoTGludXgpIgogICAgICBzdEV2dDp3aGVuPSIyMDIzLTA1LTI0VDE3OjI0OjI2KzAyOjAwIi8+CiAgICA8L3JkZjpTZXE+CiAgIDwveG1wTU06SGlzdG9yeT4KICA8L3JkZjpEZXNjcmlwdGlvbj4KIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAKPD94cGFja2V0IGVuZD0idyI/Pj0tlUwAAAAJcEhZcwAADdcAAA3XAUIom3gAAAAHdElNRQfnBRgPGBru/VeEAAAABmJLR0QA/wD/AP+gvaeTAAAFO0lEQVRYw9WYe2xTVRzHTx97dYS5B1UHa+/tY12dDoOKWyIGlfgHkCkSNTHGwHxA3NiAP/A5x4CMKEzdYL29YyAyBxKQZbI+NvYIaowaH9Ogi2GRbGjcFrbBNrq2a2/9nq5LCFnbbfSOeZJPTs/t6Tm/7/39zu+cU0IiXc7WSImNX0BsZiVYAhigmah5tHklsZrjSYtJSuZtaeSiiJU3gHUwfC9oARfBIHBP1DzaPH1eRuzmp0E6aTgSNX9EWMwSvOkMGPgG+CpguG8a0H7nA78zkMYqye0V0lYXDSHrYUw7cE5TxM04/b+38+vJ+RPRt0eIjVeAAhhyCQizFDKJEBjndaCY49Di4+CRlzFxfwSE3Ciol9i4DSBujoRUy7HIszFxdwSF3CioBy8qm1g5ufhirHwyJqwHrrDGWTlg8hFL1URN2+EF0XFPkyYuSWwhUVgnT2CygXBG3dFcM7bz1/au1u7OK9/93eWidUlHe1dCc810EsUAsXOPQZCI3rGZ6Wb4EXAEM0SCUFnZduz6T/09l4bHXYOCz+f0+XxeWg+7XYM/4vnKtlqHJHSIOrAHlYMFYmawRNCKycaDGZLVfMRdf/nPDpfXM+abotDnpy93dtzXfNgdZg+im2uimJ6h66UTeIMZsrat1jvkdPRRb/imLt4hl6N3DfqFEIPvOMzDJYspJsWfbUKEyFNttcKoyzkKo4UgYoRRt3OE9guT1br984nsmQ7gCWbIipaj4xeu9v/hFQTPlG7B89+u9v9O+4UQQ8f/BSlaVM8kgBOhji4p9mpvwQ+Wfwddjp6bQw2u8g44HT3535/tTUa/0Eccvg4sFDE1m2PBZkx2LVRqVcLQvG/PDDX1/tVxze38x+UZH6O1He28b764qgwtxOcf327eBGLFE9NikiD3qzDZhVBJgCJH3KubDnkfbD4s5Jw74qM1bcvDnxq8/vHt1SrS9InIJ2m7OQ4UYsKhCB9lJqHj0gPsHJzPvsS9w8rRRPDptI40M8PlH9fOJ5M5K008rsZmIwi5gc4QN9Zja8zn+5epch9PTFepU1iGuVunVqeyS9g0iv8zy96l0WiSjIsXx28iJEJhaONkMGB5YP14bkmI1SzIz1T0pRa9VKnNzCjUMcwWUAS2BtgWYLJN+xTo1OyrOhW7xsAwqnSGkd3i+uGjkT5Xw6DLt3AdEKQNB4YXbdtwQpuVuRtG7pwhxWA7vJgRib0nDuSDvtkIkjYcHE3aVWjRLL9/zyyETPK2Vq3OidAaOhiPDLcbxo3MRIik0eReWPnO15pHHiqbpYhS6hkNw7wAz0To6GM5hAzH3wkDa6b7x4bEwnkUfMnP6idX7Nex7GxElIDNerV6hU6jSdbp9RHck2w0w/FaGGoJm7KtnCfmWNlF1fOrK3Q6bekMRFABO7QM8yxewFLUi+5JSxPpAmcxy0gjt1Rytir4NcHKCfJTH/al5j1j1hr0pWEML55YD+x2GP6cVqNZZjQYEvUsG4vP4v8jKju5L1p6qnytxGKa6qogyOorBpVbXvxMe69xdxABb9I0DAGvIIRWp7NsBsJIoWVZKfaXuf+jMKp2b6z8+Adb4aErNwpCCh5J2pnfoH0ga08g7invBfaQjXjjuQifhyEgLdNolJP5UqR17y+QnSwvk1i565OZK6F8RzubvWwvDH8LvKZnmHXY8HKws+sNLJtI5muJ/7hYElOzJ1V+fN9R7CVDClPJOVXuqo06vS4HQjTwgDKDZRXk/1JiD7wrieFLk6T1lczCXUVK7aPZinS9XrTw+Q+Tql7SUmvGuQAAAABJRU5ErkJggg==",defaultOffset:[-25.5,-32]};const XML_SCHEMA_INSTANCE_URI="http://www.w3.org/2001/XMLSchema-instance";function createElementNS(_t,e){return getDocument().createElementNS(_t,e)}function getAllTextContent(_t,e){return getAllTextContent_(_t,e,[]).join("")}function getAllTextContent_(_t,e,n){if(_t.nodeType==Node.CDATA_SECTION_NODE||_t.nodeType==Node.TEXT_NODE)n.push(_t.nodeValue);else{let ei;for(ei=_t.firstChild;ei;ei=ei.nextSibling)getAllTextContent_(ei,e,n)}return n}function isDocument(_t){return"documentElement"in _t}function parse$1(_t){return new DOMParser().parseFromString(_t,"application/xml")}function makeArrayExtender(_t,e){return(function(n,ei){const ti=_t.call(e??this,n,ei);if(ti!==void 0){const ii=ei[ei.length-1];extend$3(ii,ti)}})}function makeArrayPusher(_t,e){return(function(n,ei){const ti=_t.call(e??this,n,ei);ti!==void 0&&ei[ei.length-1].push(ti)})}function makeReplacer(_t,e){return(function(n,ei){const ti=_t.call(this,n,ei);ti!==void 0&&(ei[ei.length-1]=ti)})}function makeObjectPropertyPusher(_t,e,n){return(function(ei,ti){const ii=_t.call(this,ei,ti);if(ii!==void 0){const ri=ti[ti.length-1],ni=ei.localName;let si;ni in ri?si=ri[ni]:(si=[],ri[ni]=si),si.push(ii)}})}function makeObjectPropertySetter(_t,e,n){return(function(ei,ti){const ii=_t.call(this,ei,ti);if(ii!==void 0){const ri=ti[ti.length-1],ni=e!==void 0?e:ei.localName;ri[ni]=ii}})}function makeChildAppender(_t,e){return(function(n,ei,ti){_t.call(this,n,ei,ti),ti[ti.length-1].node.appendChild(n)})}function makeArraySerializer(_t,e){let n,ei;return function(ti,ii,ri){if(n===void 0){n={};const ni={};ni[ti.localName]=_t,n[ti.namespaceURI]=ni,ei=makeSimpleNodeFactory(ti.localName)}serialize(n,ei,ii,ri)}}function makeSimpleNodeFactory(_t,e){return(function(n,ei,ti){const ri=ei[ei.length-1].node;let ni=_t;ni===void 0&&(ni=ti);const si=ri.namespaceURI;return createElementNS(si,ni)})}const OBJECT_PROPERTY_NODE_FACTORY=makeSimpleNodeFactory();function makeSequence(_t,e){const n=e.length,ei=new Array(n);for(let ti=0;ti<n;++ti)ei[ti]=_t[e[ti]];return ei}function makeStructureNS(_t,e,n){n=n!==void 0?n:{};let ei,ti;for(ei=0,ti=_t.length;ei<ti;++ei)n[_t[ei]]=e;return n}function parseNode(_t,e,n,ei){let ti;for(ti=e.firstElementChild;ti;ti=ti.nextElementSibling){const ii=_t[ti.namespaceURI];if(ii!==void 0){const ri=ii[ti.localName];ri!==void 0&&ri.call(ei,ti,n)}}}function pushParseAndPop(_t,e,n,ei,ti){return ei.push(_t),parseNode(e,n,ei,ti),ei.pop()}function serialize(_t,e,n,ei,ti,ii){const ri=(ti!==void 0?ti:n).length;let ni,si;for(let ai=0;ai<ri;++ai)ni=n[ai],ni!==void 0&&(si=e.call(ii,ni,ei,ti!==void 0?ti[ai]:void 0),si!==void 0&&_t[si.namespaceURI][si.localName].call(ii,si,ni,ei))}function pushSerializeAndPop(_t,e,n,ei,ti,ii,ri){return ti.push(_t),serialize(e,n,ei,ti,ii,ri),ti.pop()}let xmlSerializer_;function getXMLSerializer(){return xmlSerializer_===void 0&&typeof XMLSerializer<"u"&&(xmlSerializer_=new XMLSerializer),xmlSerializer_}let document_;function getDocument(){return document_===void 0&&typeof document<"u"&&(document_=document.implementation.createDocument("","",null)),document_}class FeatureFormat{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=Feature,this.supportedMediaTypes=null}getReadOptions(e,n){if(n){let ei=n.dataProjection?get$3(n.dataProjection):this.readProjection(e);n.extent&&ei&&ei.getUnits()==="tile-pixels"&&(ei=get$3(ei),ei.setWorldExtent(n.extent)),n={dataProjection:ei,featureProjection:n.featureProjection}}return this.adaptOptions(n)}adaptOptions(e){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},e)}getType(){return abstract()}readFeature(e,n){return abstract()}readFeatures(e,n){return abstract()}readGeometry(e,n){return abstract()}readProjection(e){return abstract()}writeFeature(e,n){return abstract()}writeFeatures(e,n){return abstract()}writeGeometry(e,n){return abstract()}}function transformGeometryWithOptions(_t,e,n){const ei=n?get$3(n.featureProjection):null,ti=n?get$3(n.dataProjection):null;let ii=_t;if(ei&&ti&&!equivalent$1(ei,ti)){e&&(ii=_t.clone());const ri=e?ei:ti,ni=e?ti:ei;ri.getUnits()==="tile-pixels"?ii.transform(ri,ni):ii.applyTransform(getTransform(ri,ni))}if(e&&n&&n.decimals!==void 0){const ri=Math.pow(10,n.decimals),ni=function(si){for(let ai=0,oi=si.length;ai<oi;++ai)si[ai]=Math.round(si[ai]*ri)/ri;return si};ii===_t&&(ii=_t.clone()),ii.applyTransform(ni)}return ii}const GeometryConstructor={Point:Point$1,LineString,Polygon,MultiPoint,MultiLineString,MultiPolygon};function orientFlatCoordinates(_t,e,n){return Array.isArray(e[0])?(linearRingssAreOriented(_t,0,e,n)||(_t=_t.slice(),orientLinearRingsArray(_t,0,e,n)),_t):(linearRingsAreOriented(_t,0,e,n)||(_t=_t.slice(),orientLinearRings(_t,0,e,n)),_t)}function createRenderFeature(_t,e){var ii;const n=_t.geometry;if(!n)return[];if(Array.isArray(n))return n.map(ri=>createRenderFeature({..._t,geometry:ri})).flat();const ei=n.type==="MultiPolygon"?"Polygon":n.type;if(ei==="GeometryCollection"||ei==="Circle")throw new Error("Unsupported geometry type: "+ei);const ti=n.layout.length;return transformGeometryWithOptions(new RenderFeature(ei,ei==="Polygon"?orientFlatCoordinates(n.flatCoordinates,n.ends,ti):n.flatCoordinates,(ii=n.ends)==null?void 0:ii.flat(),ti,_t.properties||{},_t.id).enableSimplifyTransformed(),!1,e)}function createGeometry(_t,e){if(!_t)return null;if(Array.isArray(_t)){const ei=_t.map(ti=>createGeometry(ti,e));return new GeometryCollection(ei)}const n=GeometryConstructor[_t.type];return transformGeometryWithOptions(new n(_t.flatCoordinates,_t.layout||"XY",_t.ends),!1,e)}class XMLFeature extends FeatureFormat{constructor(){super(),this.xmlSerializer_=getXMLSerializer()}getType(){return"xml"}readFeature(e,n){if(!e)return null;if(typeof e=="string"){const ei=parse$1(e);return this.readFeatureFromDocument(ei,n)}return isDocument(e)?this.readFeatureFromDocument(e,n):this.readFeatureFromNode(e,n)}readFeatureFromDocument(e,n){const ei=this.readFeaturesFromDocument(e,n);return ei.length>0?ei[0]:null}readFeatureFromNode(e,n){return null}readFeatures(e,n){if(!e)return[];if(typeof e=="string"){const ei=parse$1(e);return this.readFeaturesFromDocument(ei,n)}return isDocument(e)?this.readFeaturesFromDocument(e,n):this.readFeaturesFromNode(e,n)}readFeaturesFromDocument(e,n){const ei=[];for(let ti=e.firstChild;ti;ti=ti.nextSibling)ti.nodeType==Node.ELEMENT_NODE&&extend$3(ei,this.readFeaturesFromNode(ti,n));return ei}readFeaturesFromNode(e,n){return abstract()}readGeometry(e,n){if(!e)return null;if(typeof e=="string"){const ei=parse$1(e);return this.readGeometryFromDocument(ei,n)}return isDocument(e)?this.readGeometryFromDocument(e,n):this.readGeometryFromNode(e,n)}readGeometryFromDocument(e,n){return null}readGeometryFromNode(e,n){return null}readProjection(e){if(!e)return null;if(typeof e=="string"){const n=parse$1(e);return this.readProjectionFromDocument(n)}return isDocument(e)?this.readProjectionFromDocument(e):this.readProjectionFromNode(e)}readProjectionFromDocument(e){return this.dataProjection}readProjectionFromNode(e){return this.dataProjection}writeFeature(e,n){const ei=this.writeFeatureNode(e,n);return this.xmlSerializer_.serializeToString(ei)}writeFeatureNode(e,n){return null}writeFeatures(e,n){const ei=this.writeFeaturesNode(e,n);return this.xmlSerializer_.serializeToString(ei)}writeFeaturesNode(e,n){return null}writeGeometry(e,n){const ei=this.writeGeometryNode(e,n);return this.xmlSerializer_.serializeToString(ei)}writeGeometryNode(e,n){return null}}function readBoolean(_t){const e=getAllTextContent(_t,!1);return readBooleanString(e)}function readBooleanString(_t){const e=/^\s*(true|1)|(false|0)\s*$/.exec(_t);if(e)return e[1]!==void 0||!1}function readDateTime(_t){const e=getAllTextContent(_t,!1),n=Date.parse(e);return isNaN(n)?void 0:n/1e3}function readDecimal(_t){const e=getAllTextContent(_t,!1);return readDecimalString(e)}function readDecimalString(_t){const e=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(_t);if(e)return parseFloat(e[1])}function readPositiveInteger(_t){const e=getAllTextContent(_t,!1);return readNonNegativeIntegerString(e)}function readNonNegativeIntegerString(_t){const e=/^\s*(\d+)\s*$/.exec(_t);if(e)return parseInt(e[1],10)}function readString(_t){return getAllTextContent(_t,!1).trim()}function writeBooleanTextNode(_t,e){writeStringTextNode(_t,e?"1":"0")}function writeCDATASection(_t,e){_t.appendChild(getDocument().createCDATASection(e))}function writeDateTimeTextNode(_t,e){const n=new Date(e*1e3),ei=n.getUTCFullYear()+"-"+padNumber(n.getUTCMonth()+1,2)+"-"+padNumber(n.getUTCDate(),2)+"T"+padNumber(n.getUTCHours(),2)+":"+padNumber(n.getUTCMinutes(),2)+":"+padNumber(n.getUTCSeconds(),2)+"Z";_t.appendChild(getDocument().createTextNode(ei))}function writeDecimalTextNode(_t,e){const n=e.toPrecision();_t.appendChild(getDocument().createTextNode(n))}function writeNonNegativeIntegerTextNode(_t,e){const n=e.toString();_t.appendChild(getDocument().createTextNode(n))}const whiteSpaceStart=/^\s/,whiteSpaceEnd=/\s$/,cdataCharacters=/(\n|\t|\r|<|&| {2})/;function writeStringTextNode(_t,e){typeof e=="string"&&(whiteSpaceStart.test(e)||whiteSpaceEnd.test(e)||cdataCharacters.test(e))?e.split("]]>").forEach((n,ei,ti)=>{ei<ti.length-1&&(n+="]]"),ei>0&&(n=">"+n),writeCDATASection(_t,n)}):_t.appendChild(getDocument().createTextNode(e))}const GX_NAMESPACE_URIS=["http://www.google.com/kml/ext/2.2"],NAMESPACE_URIS$4=[null,"http://earth.google.com/kml/2.0","http://earth.google.com/kml/2.1","http://earth.google.com/kml/2.2","http://www.opengis.net/kml/2.2"],SCHEMA_LOCATION$1="http://www.opengis.net/kml/2.2 https://developers.google.com/kml/schema/kml22gx.xsd",ICON_ANCHOR_UNITS_MAP={fraction:"fraction",pixels:"pixels",insetPixels:"pixels"},PLACEMARK_PARSERS=makeStructureNS(NAMESPACE_URIS$4,{ExtendedData:extendedDataParser,Region:regionParser,MultiGeometry:makeObjectPropertySetter(readMultiGeometry,"geometry"),LineString:makeObjectPropertySetter(readLineString,"geometry"),LinearRing:makeObjectPropertySetter(readLinearRing,"geometry"),Point:makeObjectPropertySetter(readPoint,"geometry"),Polygon:makeObjectPropertySetter(readPolygon,"geometry"),Style:makeObjectPropertySetter(readStyle$2),StyleMap:placemarkStyleMapParser,address:makeObjectPropertySetter(readString),description:makeObjectPropertySetter(readString),name:makeObjectPropertySetter(readString),open:makeObjectPropertySetter(readBoolean),phoneNumber:makeObjectPropertySetter(readString),styleUrl:makeObjectPropertySetter(readStyleURL),visibility:makeObjectPropertySetter(readBoolean)},makeStructureNS(GX_NAMESPACE_URIS,{MultiTrack:makeObjectPropertySetter(readGxMultiTrack,"geometry"),Track:makeObjectPropertySetter(readGxTrack,"geometry")})),NETWORK_LINK_PARSERS=makeStructureNS(NAMESPACE_URIS$4,{ExtendedData:extendedDataParser,Region:regionParser,Link:linkParser,address:makeObjectPropertySetter(readString),description:makeObjectPropertySetter(readString),name:makeObjectPropertySetter(readString),open:makeObjectPropertySetter(readBoolean),phoneNumber:makeObjectPropertySetter(readString),visibility:makeObjectPropertySetter(readBoolean)}),LINK_PARSERS$1=makeStructureNS(NAMESPACE_URIS$4,{href:makeObjectPropertySetter(readURI)}),CAMERA_PARSERS=makeStructureNS(NAMESPACE_URIS$4,{Altitude:makeObjectPropertySetter(readDecimal),Longitude:makeObjectPropertySetter(readDecimal),Latitude:makeObjectPropertySetter(readDecimal),Tilt:makeObjectPropertySetter(readDecimal),AltitudeMode:makeObjectPropertySetter(readString),Heading:makeObjectPropertySetter(readDecimal),Roll:makeObjectPropertySetter(readDecimal)}),REGION_PARSERS=makeStructureNS(NAMESPACE_URIS$4,{LatLonAltBox:latLonAltBoxParser,Lod:lodParser}),KML_SEQUENCE=makeStructureNS(NAMESPACE_URIS$4,["Document","Placemark"]),KML_SERIALIZERS=makeStructureNS(NAMESPACE_URIS$4,{Document:makeChildAppender(writeDocument),Placemark:makeChildAppender(writePlacemark)});let DEFAULT_COLOR,DEFAULT_FILL_STYLE=null,DEFAULT_IMAGE_STYLE_ANCHOR,DEFAULT_IMAGE_STYLE_ANCHOR_X_UNITS,DEFAULT_IMAGE_STYLE_ANCHOR_Y_UNITS,DEFAULT_IMAGE_STYLE_SIZE,DEFAULT_IMAGE_STYLE_SRC,DEFAULT_IMAGE_STYLE=null,DEFAULT_NO_IMAGE_STYLE,DEFAULT_STROKE_STYLE=null,DEFAULT_TEXT_STROKE_STYLE,DEFAULT_TEXT_STYLE=null,DEFAULT_STYLE$1=null,DEFAULT_STYLE_ARRAY=null;function scaleForSize(_t){return 32/Math.min(_t[0],_t[1])}function createStyleDefaults(){DEFAULT_COLOR=[255,255,255,1],DEFAULT_FILL_STYLE=new Fill({color:DEFAULT_COLOR}),DEFAULT_IMAGE_STYLE_ANCHOR=[20,2],DEFAULT_IMAGE_STYLE_ANCHOR_X_UNITS="pixels",DEFAULT_IMAGE_STYLE_ANCHOR_Y_UNITS="pixels",DEFAULT_IMAGE_STYLE_SIZE=[64,64],DEFAULT_IMAGE_STYLE_SRC="https://maps.google.com/mapfiles/kml/pushpin/ylw-pushpin.png",DEFAULT_IMAGE_STYLE=new Icon({anchor:DEFAULT_IMAGE_STYLE_ANCHOR,anchorOrigin:"bottom-left",anchorXUnits:DEFAULT_IMAGE_STYLE_ANCHOR_X_UNITS,anchorYUnits:DEFAULT_IMAGE_STYLE_ANCHOR_Y_UNITS,crossOrigin:"anonymous",rotation:0,scale:scaleForSize(DEFAULT_IMAGE_STYLE_SIZE),size:DEFAULT_IMAGE_STYLE_SIZE,src:DEFAULT_IMAGE_STYLE_SRC}),DEFAULT_NO_IMAGE_STYLE="NO_IMAGE",DEFAULT_STROKE_STYLE=new Stroke({color:DEFAULT_COLOR,width:1}),DEFAULT_TEXT_STROKE_STYLE=new Stroke({color:[51,51,51,1],width:2}),DEFAULT_TEXT_STYLE=new Text({font:"bold 16px Helvetica",fill:DEFAULT_FILL_STYLE,stroke:DEFAULT_TEXT_STROKE_STYLE,scale:.8}),DEFAULT_STYLE$1=new Style$1({fill:DEFAULT_FILL_STYLE,image:DEFAULT_IMAGE_STYLE,text:DEFAULT_TEXT_STYLE,stroke:DEFAULT_STROKE_STYLE,zIndex:0}),DEFAULT_STYLE_ARRAY=[DEFAULT_STYLE$1]}let TEXTAREA;function defaultIconUrlFunction(_t){return _t}let KML$1=class extends XMLFeature{constructor(e){super(),e=e||{},DEFAULT_STYLE_ARRAY||createStyleDefaults(),this.dataProjection=get$3("EPSG:4326"),this.defaultStyle_=e.defaultStyle?e.defaultStyle:DEFAULT_STYLE_ARRAY,this.extractStyles_=e.extractStyles!==void 0?e.extractStyles:!0,this.writeStyles_=e.writeStyles!==void 0?e.writeStyles:!0,this.sharedStyles_={},this.showPointNames_=e.showPointNames!==void 0?e.showPointNames:!0,this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",this.iconUrlFunction_=e.iconUrlFunction?e.iconUrlFunction:defaultIconUrlFunction,this.supportedMediaTypes=["application/vnd.google-earth.kml+xml"]}readDocumentOrFolder_(e,n){const ei=makeStructureNS(NAMESPACE_URIS$4,{Document:makeArrayExtender(this.readDocumentOrFolder_,this),Folder:makeArrayExtender(this.readDocumentOrFolder_,this),Placemark:makeArrayPusher(this.readPlacemark_,this),Style:this.readSharedStyle_.bind(this),StyleMap:this.readSharedStyleMap_.bind(this)}),ti=pushParseAndPop([],ei,e,n,this);if(ti)return ti}readPlacemark_(e,n){const ei=pushParseAndPop({geometry:null},PLACEMARK_PARSERS,e,n,this);if(!ei)return;const ti=new Feature,ii=e.getAttribute("id");ii!==null&&ti.setId(ii);const ri=n[0],ni=ei.geometry;if(ni&&transformGeometryWithOptions(ni,!1,ri),ti.setGeometry(ni),delete ei.geometry,this.extractStyles_){const si=ei.Style,ai=ei.styleUrl,oi=createFeatureStyleFunction(si,ai,this.defaultStyle_,this.sharedStyles_,this.showPointNames_);ti.setStyle(oi)}return delete ei.Style,ti.setProperties(ei,!0),ti}readSharedStyle_(e,n){const ei=e.getAttribute("id");if(ei!==null){const ti=readStyle$2.call(this,e,n);if(ti){let ii,ri=e.baseURI;(!ri||ri=="about:blank")&&(ri=window.location.href),ri?ii=new URL("#"+ei,ri).href:ii="#"+ei,this.sharedStyles_[ii]=ti}}}readSharedStyleMap_(e,n){const ei=e.getAttribute("id");if(ei===null)return;const ti=readStyleMapValue.call(this,e,n);if(!ti)return;let ii,ri=e.baseURI;(!ri||ri=="about:blank")&&(ri=window.location.href),ri?ii=new URL("#"+ei,ri).href:ii="#"+ei,this.sharedStyles_[ii]=ti}readFeatureFromNode(e,n){if(!NAMESPACE_URIS$4.includes(e.namespaceURI))return null;const ei=this.readPlacemark_(e,[this.getReadOptions(e,n)]);return ei||null}readFeaturesFromNode(e,n){if(!NAMESPACE_URIS$4.includes(e.namespaceURI))return[];let ei;const ti=e.localName;if(ti=="Document"||ti=="Folder")return ei=this.readDocumentOrFolder_(e,[this.getReadOptions(e,n)]),ei||[];if(ti=="Placemark"){const ii=this.readPlacemark_(e,[this.getReadOptions(e,n)]);return ii?[ii]:[]}if(ti=="kml"){ei=[];for(let ii=e.firstElementChild;ii;ii=ii.nextElementSibling){const ri=this.readFeaturesFromNode(ii,n);ri&&extend$3(ei,ri)}return ei}return[]}readName(e){if(e){if(typeof e=="string"){const n=parse$1(e);return this.readNameFromDocument(n)}return isDocument(e)?this.readNameFromDocument(e):this.readNameFromNode(e)}}readNameFromDocument(e){for(let n=e.firstChild;n;n=n.nextSibling)if(n.nodeType==Node.ELEMENT_NODE){const ei=this.readNameFromNode(n);if(ei)return ei}}readNameFromNode(e){for(let n=e.firstElementChild;n;n=n.nextElementSibling)if(NAMESPACE_URIS$4.includes(n.namespaceURI)&&n.localName=="name")return readString(n);for(let n=e.firstElementChild;n;n=n.nextElementSibling){const ei=n.localName;if(NAMESPACE_URIS$4.includes(n.namespaceURI)&&(ei=="Document"||ei=="Folder"||ei=="Placemark"||ei=="kml")){const ti=this.readNameFromNode(n);if(ti)return ti}}}readNetworkLinks(e){const n=[];if(typeof e=="string"){const ei=parse$1(e);extend$3(n,this.readNetworkLinksFromDocument(ei))}else isDocument(e)?extend$3(n,this.readNetworkLinksFromDocument(e)):extend$3(n,this.readNetworkLinksFromNode(e));return n}readNetworkLinksFromDocument(e){const n=[];for(let ei=e.firstChild;ei;ei=ei.nextSibling)ei.nodeType==Node.ELEMENT_NODE&&extend$3(n,this.readNetworkLinksFromNode(ei));return n}readNetworkLinksFromNode(e){const n=[];for(let ei=e.firstElementChild;ei;ei=ei.nextElementSibling)if(NAMESPACE_URIS$4.includes(ei.namespaceURI)&&ei.localName=="NetworkLink"){const ti=pushParseAndPop({},NETWORK_LINK_PARSERS,ei,[]);n.push(ti)}for(let ei=e.firstElementChild;ei;ei=ei.nextElementSibling){const ti=ei.localName;NAMESPACE_URIS$4.includes(ei.namespaceURI)&&(ti=="Document"||ti=="Folder"||ti=="kml")&&extend$3(n,this.readNetworkLinksFromNode(ei))}return n}readRegion(e){const n=[];if(typeof e=="string"){const ei=parse$1(e);extend$3(n,this.readRegionFromDocument(ei))}else isDocument(e)?extend$3(n,this.readRegionFromDocument(e)):extend$3(n,this.readRegionFromNode(e));return n}readRegionFromDocument(e){const n=[];for(let ei=e.firstChild;ei;ei=ei.nextSibling)ei.nodeType==Node.ELEMENT_NODE&&extend$3(n,this.readRegionFromNode(ei));return n}readRegionFromNode(e){const n=[];for(let ei=e.firstElementChild;ei;ei=ei.nextElementSibling)if(NAMESPACE_URIS$4.includes(ei.namespaceURI)&&ei.localName=="Region"){const ti=pushParseAndPop({},REGION_PARSERS,ei,[]);n.push(ti)}for(let ei=e.firstElementChild;ei;ei=ei.nextElementSibling){const ti=ei.localName;NAMESPACE_URIS$4.includes(ei.namespaceURI)&&(ti=="Document"||ti=="Folder"||ti=="kml")&&extend$3(n,this.readRegionFromNode(ei))}return n}readCamera(e){const n=[];if(typeof e=="string"){const ei=parse$1(e);extend$3(n,this.readCameraFromDocument(ei))}else isDocument(e)?extend$3(n,this.readCameraFromDocument(e)):extend$3(n,this.readCameraFromNode(e));return n}readCameraFromDocument(e){const n=[];for(let ei=e.firstChild;ei;ei=ei.nextSibling)ei.nodeType===Node.ELEMENT_NODE&&extend$3(n,this.readCameraFromNode(ei));return n}readCameraFromNode(e){const n=[];for(let ei=e.firstElementChild;ei;ei=ei.nextElementSibling)if(NAMESPACE_URIS$4.includes(ei.namespaceURI)&&ei.localName==="Camera"){const ti=pushParseAndPop({},CAMERA_PARSERS,ei,[]);n.push(ti)}for(let ei=e.firstElementChild;ei;ei=ei.nextElementSibling){const ti=ei.localName;NAMESPACE_URIS$4.includes(ei.namespaceURI)&&(ti==="Document"||ti==="Folder"||ti==="Placemark"||ti==="kml")&&extend$3(n,this.readCameraFromNode(ei))}return n}writeFeaturesNode(e,n){n=this.adaptOptions(n);const ei=createElementNS(NAMESPACE_URIS$4[4],"kml"),ti="http://www.w3.org/2000/xmlns/";ei.setAttributeNS(ti,"xmlns:gx",GX_NAMESPACE_URIS[0]),ei.setAttributeNS(ti,"xmlns:xsi",XML_SCHEMA_INSTANCE_URI),ei.setAttributeNS(XML_SCHEMA_INSTANCE_URI,"xsi:schemaLocation",SCHEMA_LOCATION$1);const ii={node:ei},ri={};e.length>1?ri.Document=e:e.length==1&&(ri.Placemark=e[0]);const ni=KML_SEQUENCE[ei.namespaceURI],si=makeSequence(ri,ni);return pushSerializeAndPop(ii,KML_SERIALIZERS,OBJECT_PROPERTY_NODE_FACTORY,si,[n],ni,this),ei}};function createNameStyleFunction(_t,e){const n=[0,0];let ei="start";const ti=_t.getImage();if(ti){const ni=ti.getSize();if(ni&&ni.length==2){const si=ti.getScaleArray(),ai=ti.getAnchor();n[0]=si[0]*(ni[0]-ai[0]),n[1]=si[1]*(ni[1]/2-ai[1]),ei="left"}}let ii=_t.getText();return ii?(ii=ii.clone(),ii.setFont(ii.getFont()||DEFAULT_TEXT_STYLE.getFont()),ii.setScale(ii.getScale()||DEFAULT_TEXT_STYLE.getScale()),ii.setFill(ii.getFill()||DEFAULT_TEXT_STYLE.getFill()),ii.setStroke(ii.getStroke()||DEFAULT_TEXT_STROKE_STYLE)):ii=DEFAULT_TEXT_STYLE.clone(),ii.setText(e),ii.setOffsetX(n[0]),ii.setOffsetY(n[1]),ii.setTextAlign(ei),new Style$1({image:ti,text:ii})}function createFeatureStyleFunction(_t,e,n,ei,ti){return(function(ii,ri){let ni=ti,si="",ai=[];if(ni){const li=ii.getGeometry();if(li)if(li instanceof GeometryCollection)ai=li.getGeometriesArrayRecursive().filter(function(ci){const ui=ci.getType();return ui==="Point"||ui==="MultiPoint"}),ni=ai.length>0;else{const ci=li.getType();ni=ci==="Point"||ci==="MultiPoint"}}ni&&(si=ii.get("name"),ni=ni&&!!si,ni&&/&[^&]+;/.test(si)&&(TEXTAREA||(TEXTAREA=document.createElement("textarea")),TEXTAREA.innerHTML=si,si=TEXTAREA.value));let oi=n;if(_t?oi=_t:e&&(oi=findStyle(e,n,ei)),ni){const li=createNameStyleFunction(oi[0],si);if(ai.length>0){li.setGeometry(new GeometryCollection(ai));const ci=new Style$1({geometry:oi[0].getGeometry(),image:null,fill:oi[0].getFill(),stroke:oi[0].getStroke(),text:null});return[li,ci].concat(oi.slice(1))}return li}return oi})}function findStyle(_t,e,n){return Array.isArray(_t)?_t:typeof _t=="string"?findStyle(n[_t],e,n):e}function readColor(_t){const e=getAllTextContent(_t,!1),n=/^\s*#?\s*([0-9A-Fa-f]{8})\s*$/.exec(e);if(n){const ei=n[1];return[parseInt(ei.substr(6,2),16),parseInt(ei.substr(4,2),16),parseInt(ei.substr(2,2),16),parseInt(ei.substr(0,2),16)/255]}}function readFlatCoordinates(_t){let e=getAllTextContent(_t,!1);const n=[];e=e.replace(/\s*,\s*/g,",");const ei=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?),([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s+|,|$)(?:([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s+|$))?\s*/i;let ti;for(;ti=ei.exec(e);){const ii=parseFloat(ti[1]),ri=parseFloat(ti[2]),ni=ti[3]?parseFloat(ti[3]):0;n.push(ii,ri,ni),e=e.substr(ti[0].length)}if(e==="")return n}function readURI(_t){const e=getAllTextContent(_t,!1).trim();let n=_t.baseURI;return(!n||n=="about:blank")&&(n=window.location.href),n?new URL(e,n).href:e}function readStyleURL(_t){const e=getAllTextContent(_t,!1).trim().replace(/^(?!.*#)/,"#");let n=_t.baseURI;return(!n||n=="about:blank")&&(n=window.location.href),n?new URL(e,n).href:e}function readVec2(_t){const e=_t.getAttribute("xunits"),n=_t.getAttribute("yunits");let ei;return e!=="insetPixels"?n!=="insetPixels"?ei="bottom-left":ei="top-left":n!=="insetPixels"?ei="bottom-right":ei="top-right",{x:parseFloat(_t.getAttribute("x")),xunits:ICON_ANCHOR_UNITS_MAP[e],y:parseFloat(_t.getAttribute("y")),yunits:ICON_ANCHOR_UNITS_MAP[n],origin:ei}}function readScale(_t){return readDecimal(_t)}const STYLE_MAP_PARSERS=makeStructureNS(NAMESPACE_URIS$4,{Pair:pairDataParser});function readStyleMapValue(_t,e){return pushParseAndPop(void 0,STYLE_MAP_PARSERS,_t,e,this)}const ICON_STYLE_PARSERS=makeStructureNS(NAMESPACE_URIS$4,{Icon:makeObjectPropertySetter(readIcon),color:makeObjectPropertySetter(readColor),heading:makeObjectPropertySetter(readDecimal),hotSpot:makeObjectPropertySetter(readVec2),scale:makeObjectPropertySetter(readScale)});function iconStyleParser(_t,e){const n=pushParseAndPop({},ICON_STYLE_PARSERS,_t,e);if(!n)return;const ei=e[e.length-1],ti="Icon"in n?n.Icon:{},ii=!("Icon"in n)||Object.keys(ti).length>0;let ri;const ni=ti.href;ni?ri=ni:ii&&(ri=DEFAULT_IMAGE_STYLE_SRC);let si,ai,oi,li="bottom-left";const ci=n.hotSpot;ci?(si=[ci.x,ci.y],ai=ci.xunits,oi=ci.yunits,li=ci.origin):/^https?:\/\/maps\.(?:google|gstatic)\.com\//.test(ri)&&(ri.includes("pushpin")?(si=DEFAULT_IMAGE_STYLE_ANCHOR,ai=DEFAULT_IMAGE_STYLE_ANCHOR_X_UNITS,oi=DEFAULT_IMAGE_STYLE_ANCHOR_Y_UNITS):ri.includes("arrow-reverse")?(si=[54,42],ai=DEFAULT_IMAGE_STYLE_ANCHOR_X_UNITS,oi=DEFAULT_IMAGE_STYLE_ANCHOR_Y_UNITS):ri.includes("paddle")&&(si=[32,1],ai=DEFAULT_IMAGE_STYLE_ANCHOR_X_UNITS,oi=DEFAULT_IMAGE_STYLE_ANCHOR_Y_UNITS));let ui;const di=ti.x,fi=ti.y;di!==void 0&&fi!==void 0&&(ui=[di,fi]);let hi;const pi=ti.w,gi=ti.h;pi!==void 0&&gi!==void 0&&(hi=[pi,gi]);let vi;const yi=n.heading;yi!==void 0&&(vi=toRadians(yi));const _i=n.scale,Ai=n.color;if(ii){ri==DEFAULT_IMAGE_STYLE_SRC&&(hi=DEFAULT_IMAGE_STYLE_SIZE);const Ei=new Icon({anchor:si,anchorOrigin:li,anchorXUnits:ai,anchorYUnits:oi,crossOrigin:this.crossOrigin_,offset:ui,offsetOrigin:"bottom-left",rotation:vi,scale:_i,size:hi,src:this.iconUrlFunction_(ri),color:Ai}),Si=Ei.getScaleArray()[0],wi=Ei.getSize();if(wi===null){const Oi=Ei.getImageState();if(Oi===ImageState.IDLE||Oi===ImageState.LOADING){const Ii=function(){const Li=Ei.getImageState();if(!(Li===ImageState.IDLE||Li===ImageState.LOADING)){const Di=Ei.getSize();if(Di&&Di.length==2){const Ni=scaleForSize(Di);Ei.setScale(Si*Ni)}Ei.unlistenImageChange(Ii)}};Ei.listenImageChange(Ii),Oi===ImageState.IDLE&&Ei.load()}}else if(wi.length==2){const Oi=scaleForSize(wi);Ei.setScale(Si*Oi)}ei.imageStyle=Ei}else ei.imageStyle=DEFAULT_NO_IMAGE_STYLE}const LABEL_STYLE_PARSERS=makeStructureNS(NAMESPACE_URIS$4,{color:makeObjectPropertySetter(readColor),scale:makeObjectPropertySetter(readScale)});function labelStyleParser(_t,e){const n=pushParseAndPop({},LABEL_STYLE_PARSERS,_t,e);if(!n)return;const ei=e[e.length-1],ti=new Text({fill:new Fill({color:"color"in n?n.color:DEFAULT_COLOR}),scale:n.scale});ei.textStyle=ti}const LINE_STYLE_PARSERS=makeStructureNS(NAMESPACE_URIS$4,{color:makeObjectPropertySetter(readColor),width:makeObjectPropertySetter(readDecimal)});function lineStyleParser(_t,e){const n=pushParseAndPop({},LINE_STYLE_PARSERS,_t,e);if(!n)return;const ei=e[e.length-1],ti=new Stroke({color:"color"in n?n.color:DEFAULT_COLOR,width:"width"in n?n.width:1});ei.strokeStyle=ti}const POLY_STYLE_PARSERS=makeStructureNS(NAMESPACE_URIS$4,{color:makeObjectPropertySetter(readColor),fill:makeObjectPropertySetter(readBoolean),outline:makeObjectPropertySetter(readBoolean)});function polyStyleParser(_t,e){const n=pushParseAndPop({},POLY_STYLE_PARSERS,_t,e);if(!n)return;const ei=e[e.length-1],ti=new Fill({color:"color"in n?n.color:DEFAULT_COLOR});ei.fillStyle=ti;const ii=n.fill;ii!==void 0&&(ei.fill=ii);const ri=n.outline;ri!==void 0&&(ei.outline=ri)}const FLAT_LINEAR_RING_PARSERS=makeStructureNS(NAMESPACE_URIS$4,{coordinates:makeReplacer(readFlatCoordinates)});function readFlatLinearRing(_t,e){return pushParseAndPop(null,FLAT_LINEAR_RING_PARSERS,_t,e)}function gxCoordParser(_t,e){const ei=e[e.length-1].coordinates,ti=getAllTextContent(_t,!1),ri=/^\s*([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s*$/i.exec(ti);if(ri){const ni=parseFloat(ri[1]),si=parseFloat(ri[2]),ai=parseFloat(ri[3]);ei.push([ni,si,ai])}else ei.push([])}const GX_MULTITRACK_GEOMETRY_PARSERS=makeStructureNS(GX_NAMESPACE_URIS,{Track:makeArrayPusher(readGxTrack)});function readGxMultiTrack(_t,e){const n=pushParseAndPop([],GX_MULTITRACK_GEOMETRY_PARSERS,_t,e);if(n)return new MultiLineString(n)}const GX_TRACK_PARSERS=makeStructureNS(NAMESPACE_URIS$4,{when:whenParser},makeStructureNS(GX_NAMESPACE_URIS,{coord:gxCoordParser}));function readGxTrack(_t,e){const n=pushParseAndPop({coordinates:[],whens:[]},GX_TRACK_PARSERS,_t,e);if(!n)return;const ei=[],ti=n.coordinates,ii=n.whens;for(let ri=0,ni=Math.min(ti.length,ii.length);ri<ni;++ri)ti[ri].length==3&&ei.push(ti[ri][0],ti[ri][1],ti[ri][2],ii[ri]);return new LineString(ei,"XYZM")}const ICON_PARSERS=makeStructureNS(NAMESPACE_URIS$4,{href:makeObjectPropertySetter(readURI)},makeStructureNS(GX_NAMESPACE_URIS,{x:makeObjectPropertySetter(readDecimal),y:makeObjectPropertySetter(readDecimal),w:makeObjectPropertySetter(readDecimal),h:makeObjectPropertySetter(readDecimal)}));function readIcon(_t,e){const n=pushParseAndPop({},ICON_PARSERS,_t,e);return n||null}const GEOMETRY_FLAT_COORDINATES_PARSERS=makeStructureNS(NAMESPACE_URIS$4,{coordinates:makeReplacer(readFlatCoordinates)});function readFlatCoordinatesFromNode(_t,e){return pushParseAndPop(null,GEOMETRY_FLAT_COORDINATES_PARSERS,_t,e)}const EXTRUDE_AND_ALTITUDE_MODE_PARSERS=makeStructureNS(NAMESPACE_URIS$4,{extrude:makeObjectPropertySetter(readBoolean),tessellate:makeObjectPropertySetter(readBoolean),altitudeMode:makeObjectPropertySetter(readString)});function readLineString(_t,e){const n=pushParseAndPop({},EXTRUDE_AND_ALTITUDE_MODE_PARSERS,_t,e),ei=readFlatCoordinatesFromNode(_t,e);if(ei){const ti=new LineString(ei,"XYZ");return ti.setProperties(n,!0),ti}}function readLinearRing(_t,e){const n=pushParseAndPop({},EXTRUDE_AND_ALTITUDE_MODE_PARSERS,_t,e),ei=readFlatCoordinatesFromNode(_t,e);if(ei){const ti=new Polygon(ei,"XYZ",[ei.length]);return ti.setProperties(n,!0),ti}}const MULTI_GEOMETRY_PARSERS=makeStructureNS(NAMESPACE_URIS$4,{LineString:makeArrayPusher(readLineString),LinearRing:makeArrayPusher(readLinearRing),MultiGeometry:makeArrayPusher(readMultiGeometry),Point:makeArrayPusher(readPoint),Polygon:makeArrayPusher(readPolygon)});function readMultiGeometry(_t,e){const n=pushParseAndPop([],MULTI_GEOMETRY_PARSERS,_t,e);if(!n)return null;if(n.length===0)return new GeometryCollection(n);let ei,ti=!0;const ii=n[0].getType();let ri;for(let ni=1,si=n.length;ni<si;++ni)if(ri=n[ni],ri.getType()!=ii){ti=!1;break}if(ti){let ni,si;if(ii=="Point"){const ai=n[0];ni=ai.getLayout(),si=ai.getFlatCoordinates();for(let oi=1,li=n.length;oi<li;++oi)ri=n[oi],extend$3(si,ri.getFlatCoordinates());ei=new MultiPoint(si,ni),setCommonGeometryProperties(ei,n)}else if(ii=="LineString")ei=new MultiLineString(n),setCommonGeometryProperties(ei,n);else if(ii=="Polygon")ei=new MultiPolygon(n),setCommonGeometryProperties(ei,n);else if(ii=="GeometryCollection"||ii.startsWith("Multi"))ei=new GeometryCollection(n);else throw new Error("Unknown geometry type found")}else ei=new GeometryCollection(n);return ei}function readPoint(_t,e){const n=pushParseAndPop({},EXTRUDE_AND_ALTITUDE_MODE_PARSERS,_t,e),ei=readFlatCoordinatesFromNode(_t,e);if(ei){const ti=new Point$1(ei,"XYZ");return ti.setProperties(n,!0),ti}}const FLAT_LINEAR_RINGS_PARSERS=makeStructureNS(NAMESPACE_URIS$4,{innerBoundaryIs:innerBoundaryIsParser,outerBoundaryIs:outerBoundaryIsParser});function readPolygon(_t,e){const n=pushParseAndPop({},EXTRUDE_AND_ALTITUDE_MODE_PARSERS,_t,e),ei=pushParseAndPop([null],FLAT_LINEAR_RINGS_PARSERS,_t,e);if(ei&&ei[0]){const ti=ei[0],ii=[ti.length];for(let ni=1,si=ei.length;ni<si;++ni)extend$3(ti,ei[ni]),ii.push(ti.length);const ri=new Polygon(ti,"XYZ",ii);return ri.setProperties(n,!0),ri}}const STYLE_PARSERS$2=makeStructureNS(NAMESPACE_URIS$4,{IconStyle:iconStyleParser,LabelStyle:labelStyleParser,LineStyle:lineStyleParser,PolyStyle:polyStyleParser});function readStyle$2(_t,e){const n=pushParseAndPop({},STYLE_PARSERS$2,_t,e,this);if(!n)return null;let ei="fillStyle"in n?n.fillStyle:DEFAULT_FILL_STYLE;const ti=n.fill;ti!==void 0&&!ti&&(ei=null);let ii;"imageStyle"in n?n.imageStyle!=DEFAULT_NO_IMAGE_STYLE&&(ii=n.imageStyle):ii=DEFAULT_IMAGE_STYLE;const ri="textStyle"in n?n.textStyle:DEFAULT_TEXT_STYLE,ni="strokeStyle"in n?n.strokeStyle:DEFAULT_STROKE_STYLE,si=n.outline;return si!==void 0&&!si?[new Style$1({geometry:function(ai){const oi=ai.getGeometry(),li=oi.getType();if(li==="GeometryCollection"){const ci=oi;return new GeometryCollection(ci.getGeometriesArrayRecursive().filter(function(ui){const di=ui.getType();return di!=="Polygon"&&di!=="MultiPolygon"}))}if(li!=="Polygon"&&li!=="MultiPolygon")return oi},fill:ei,image:ii,stroke:ni,text:ri,zIndex:void 0}),new Style$1({geometry:function(ai){const oi=ai.getGeometry(),li=oi.getType();if(li==="GeometryCollection"){const ci=oi;return new GeometryCollection(ci.getGeometriesArrayRecursive().filter(function(ui){const di=ui.getType();return di==="Polygon"||di==="MultiPolygon"}))}if(li==="Polygon"||li==="MultiPolygon")return oi},fill:ei,stroke:null,zIndex:void 0})]:[new Style$1({fill:ei,image:ii,stroke:ni,text:ri,zIndex:void 0})]}function setCommonGeometryProperties(_t,e){const n=e.length,ei=new Array(e.length),ti=new Array(e.length),ii=new Array(e.length);let ri,ni,si;ri=!1,ni=!1,si=!1;for(let ai=0;ai<n;++ai){const oi=e[ai];ei[ai]=oi.get("extrude"),ti[ai]=oi.get("tessellate"),ii[ai]=oi.get("altitudeMode"),ri=ri||ei[ai]!==void 0,ni=ni||ti[ai]!==void 0,si=si||ii[ai]}ri&&_t.set("extrude",ei),ni&&_t.set("tessellate",ti),si&&_t.set("altitudeMode",ii)}const DATA_PARSERS=makeStructureNS(NAMESPACE_URIS$4,{displayName:makeObjectPropertySetter(readString),value:makeObjectPropertySetter(readString)});function dataParser(_t,e){const n=_t.getAttribute("name");parseNode(DATA_PARSERS,_t,e);const ei=e[e.length-1];n&&ei.displayName?ei[n]={value:ei.value,displayName:ei.displayName,toString:function(){return ei.value}}:n!==null?ei[n]=ei.value:ei.displayName!==null&&(ei[ei.displayName]=ei.value),delete ei.value}const EXTENDED_DATA_PARSERS=makeStructureNS(NAMESPACE_URIS$4,{Data:dataParser,SchemaData:schemaDataParser});function extendedDataParser(_t,e){parseNode(EXTENDED_DATA_PARSERS,_t,e)}function regionParser(_t,e){parseNode(REGION_PARSERS,_t,e)}const PAIR_PARSERS=makeStructureNS(NAMESPACE_URIS$4,{Style:makeObjectPropertySetter(readStyle$2),key:makeObjectPropertySetter(readString),styleUrl:makeObjectPropertySetter(readStyleURL)});function pairDataParser(_t,e){const n=pushParseAndPop({},PAIR_PARSERS,_t,e,this);if(!n)return;const ei=n.key;if(ei&&ei=="normal"){const ti=n.styleUrl;ti&&(e[e.length-1]=ti);const ii=n.Style;ii&&(e[e.length-1]=ii)}}function placemarkStyleMapParser(_t,e){const n=readStyleMapValue.call(this,_t,e);if(!n)return;const ei=e[e.length-1];if(Array.isArray(n))ei.Style=n;else if(typeof n=="string")ei.styleUrl=n;else throw new Error("`styleMapValue` has an unknown type")}const SCHEMA_DATA_PARSERS=makeStructureNS(NAMESPACE_URIS$4,{SimpleData:simpleDataParser});function schemaDataParser(_t,e){parseNode(SCHEMA_DATA_PARSERS,_t,e)}function simpleDataParser(_t,e){const n=_t.getAttribute("name");if(n!==null){const ei=readString(_t),ti=e[e.length-1];ti[n]=ei}}const LAT_LON_ALT_BOX_PARSERS=makeStructureNS(NAMESPACE_URIS$4,{altitudeMode:makeObjectPropertySetter(readString),minAltitude:makeObjectPropertySetter(readDecimal),maxAltitude:makeObjectPropertySetter(readDecimal),north:makeObjectPropertySetter(readDecimal),south:makeObjectPropertySetter(readDecimal),east:makeObjectPropertySetter(readDecimal),west:makeObjectPropertySetter(readDecimal)});function latLonAltBoxParser(_t,e){const n=pushParseAndPop({},LAT_LON_ALT_BOX_PARSERS,_t,e);if(!n)return;const ei=e[e.length-1],ti=[parseFloat(n.west),parseFloat(n.south),parseFloat(n.east),parseFloat(n.north)];ei.extent=ti,ei.altitudeMode=n.altitudeMode,ei.minAltitude=parseFloat(n.minAltitude),ei.maxAltitude=parseFloat(n.maxAltitude)}const LOD_PARSERS=makeStructureNS(NAMESPACE_URIS$4,{minLodPixels:makeObjectPropertySetter(readDecimal),maxLodPixels:makeObjectPropertySetter(readDecimal),minFadeExtent:makeObjectPropertySetter(readDecimal),maxFadeExtent:makeObjectPropertySetter(readDecimal)});function lodParser(_t,e){const n=pushParseAndPop({},LOD_PARSERS,_t,e);if(!n)return;const ei=e[e.length-1];ei.minLodPixels=parseFloat(n.minLodPixels),ei.maxLodPixels=parseFloat(n.maxLodPixels),ei.minFadeExtent=parseFloat(n.minFadeExtent),ei.maxFadeExtent=parseFloat(n.maxFadeExtent)}const INNER_BOUNDARY_IS_PARSERS=makeStructureNS(NAMESPACE_URIS$4,{LinearRing:makeArrayPusher(readFlatLinearRing)});function innerBoundaryIsParser(_t,e){const n=pushParseAndPop([],INNER_BOUNDARY_IS_PARSERS,_t,e);n.length>0&&e[e.length-1].push(...n)}const OUTER_BOUNDARY_IS_PARSERS=makeStructureNS(NAMESPACE_URIS$4,{LinearRing:makeReplacer(readFlatLinearRing)});function outerBoundaryIsParser(_t,e){const n=pushParseAndPop(void 0,OUTER_BOUNDARY_IS_PARSERS,_t,e);if(n){const ei=e[e.length-1];ei[0]=n}}function linkParser(_t,e){parseNode(LINK_PARSERS$1,_t,e)}function whenParser(_t,e){const ei=e[e.length-1].whens,ti=getAllTextContent(_t,!1),ii=Date.parse(ti);ei.push(isNaN(ii)?0:ii)}function writeColorTextNode(_t,e){const n=asArray(e),ti=[(n.length==4?n[3]:1)*255,n[2],n[1],n[0]];for(let ii=0;ii<4;++ii){const ri=Math.floor(ti[ii]).toString(16);ti[ii]=ri.length==1?"0"+ri:ri}writeStringTextNode(_t,ti.join(""))}function writeCoordinatesTextNode(_t,e,n){const ei=n[n.length-1],ti=ei.layout,ii=ei.stride;let ri;if(ti=="XY"||ti=="XYM")ri=2;else if(ti=="XYZ"||ti=="XYZM")ri=3;else throw new Error("Invalid geometry layout");const ni=e.length;let si="";if(ni>0){si+=e[0];for(let ai=1;ai<ri;++ai)si+=","+e[ai];for(let ai=ii;ai<ni;ai+=ii){si+=" "+e[ai];for(let oi=1;oi<ri;++oi)si+=","+e[ai+oi]}}writeStringTextNode(_t,si)}const EXTENDEDDATA_NODE_SERIALIZERS=makeStructureNS(NAMESPACE_URIS$4,{Data:makeChildAppender(writeDataNode),value:makeChildAppender(writeDataNodeValue),displayName:makeChildAppender(writeDataNodeName)});function writeDataNode(_t,e,n){_t.setAttribute("name",e.name);const ei={node:_t},ti=e.value;typeof ti=="object"?(ti!==null&&ti.displayName&&pushSerializeAndPop(ei,EXTENDEDDATA_NODE_SERIALIZERS,OBJECT_PROPERTY_NODE_FACTORY,[ti.displayName],n,["displayName"]),ti!==null&&ti.value&&pushSerializeAndPop(ei,EXTENDEDDATA_NODE_SERIALIZERS,OBJECT_PROPERTY_NODE_FACTORY,[ti.value],n,["value"])):pushSerializeAndPop(ei,EXTENDEDDATA_NODE_SERIALIZERS,OBJECT_PROPERTY_NODE_FACTORY,[ti],n,["value"])}function writeDataNodeName(_t,e){writeStringTextNode(_t,e)}function writeDataNodeValue(_t,e){writeStringTextNode(_t,e)}const DOCUMENT_SERIALIZERS=makeStructureNS(NAMESPACE_URIS$4,{Placemark:makeChildAppender(writePlacemark)}),DOCUMENT_NODE_FACTORY=function(_t,e,n){const ei=e[e.length-1].node;return createElementNS(ei.namespaceURI,"Placemark")};function writeDocument(_t,e,n){pushSerializeAndPop({node:_t},DOCUMENT_SERIALIZERS,DOCUMENT_NODE_FACTORY,e,n,void 0,this)}const DATA_NODE_FACTORY=makeSimpleNodeFactory("Data");function writeExtendedData(_t,e,n){const ei={node:_t},ti=e.names,ii=e.values,ri=ti.length;for(let ni=0;ni<ri;ni++)pushSerializeAndPop(ei,EXTENDEDDATA_NODE_SERIALIZERS,DATA_NODE_FACTORY,[{name:ti[ni],value:ii[ni]}],n)}const ICON_SEQUENCE=makeStructureNS(NAMESPACE_URIS$4,["href"],makeStructureNS(GX_NAMESPACE_URIS,["x","y","w","h"])),ICON_SERIALIZERS=makeStructureNS(NAMESPACE_URIS$4,{href:makeChildAppender(writeStringTextNode)},makeStructureNS(GX_NAMESPACE_URIS,{x:makeChildAppender(writeDecimalTextNode),y:makeChildAppender(writeDecimalTextNode),w:makeChildAppender(writeDecimalTextNode),h:makeChildAppender(writeDecimalTextNode)})),GX_NODE_FACTORY=function(_t,e,n){return createElementNS(GX_NAMESPACE_URIS[0],"gx:"+n)};function writeIcon(_t,e,n){const ei={node:_t},ti=n[n.length-1].node;let ii=ICON_SEQUENCE[ti.namespaceURI],ri=makeSequence(e,ii);pushSerializeAndPop(ei,ICON_SERIALIZERS,OBJECT_PROPERTY_NODE_FACTORY,ri,n,ii),ii=ICON_SEQUENCE[GX_NAMESPACE_URIS[0]],ri=makeSequence(e,ii),pushSerializeAndPop(ei,ICON_SERIALIZERS,GX_NODE_FACTORY,ri,n,ii)}const ICON_STYLE_SEQUENCE=makeStructureNS(NAMESPACE_URIS$4,["scale","heading","Icon","color","hotSpot"]),ICON_STYLE_SERIALIZERS=makeStructureNS(NAMESPACE_URIS$4,{Icon:makeChildAppender(writeIcon),color:makeChildAppender(writeColorTextNode),heading:makeChildAppender(writeDecimalTextNode),hotSpot:makeChildAppender(writeVec2),scale:makeChildAppender(writeScaleTextNode)});function writeIconStyle(_t,e,n){const ei={node:_t},ti={},ii=e.getSrc(),ri=e.getSize(),ni=e.getImageSize(),si={href:ii};if(ri){si.w=ri[0],si.h=ri[1];const hi=e.getAnchor(),pi=e.getOrigin();if(pi&&ni&&pi[0]!==0&&pi[1]!==ri[1]&&(si.x=pi[0],si.y=ni[1]-(pi[1]+ri[1])),hi&&(hi[0]!==ri[0]/2||hi[1]!==ri[1]/2)){const gi={x:hi[0],xunits:"pixels",y:ri[1]-hi[1],yunits:"pixels"};ti.hotSpot=gi}}ti.Icon=si;let ai=e.getScaleArray()[0],oi=ri;if(oi===null&&(oi=DEFAULT_IMAGE_STYLE_SIZE),oi.length==2){const hi=scaleForSize(oi);ai=ai/hi}ai!==1&&(ti.scale=ai);const li=e.getRotation();li!==0&&(ti.heading=li);const ci=e.getColor();ci&&(ti.color=ci);const ui=n[n.length-1].node,di=ICON_STYLE_SEQUENCE[ui.namespaceURI],fi=makeSequence(ti,di);pushSerializeAndPop(ei,ICON_STYLE_SERIALIZERS,OBJECT_PROPERTY_NODE_FACTORY,fi,n,di)}const LABEL_STYLE_SEQUENCE=makeStructureNS(NAMESPACE_URIS$4,["color","scale"]),LABEL_STYLE_SERIALIZERS=makeStructureNS(NAMESPACE_URIS$4,{color:makeChildAppender(writeColorTextNode),scale:makeChildAppender(writeScaleTextNode)});function writeLabelStyle(_t,e,n){const ei={node:_t},ti={},ii=e.getFill();ii&&(ti.color=ii.getColor());const ri=e.getScale();ri&&ri!==1&&(ti.scale=ri);const ni=n[n.length-1].node,si=LABEL_STYLE_SEQUENCE[ni.namespaceURI],ai=makeSequence(ti,si);pushSerializeAndPop(ei,LABEL_STYLE_SERIALIZERS,OBJECT_PROPERTY_NODE_FACTORY,ai,n,si)}const LINE_STYLE_SEQUENCE=makeStructureNS(NAMESPACE_URIS$4,["color","width"]),LINE_STYLE_SERIALIZERS=makeStructureNS(NAMESPACE_URIS$4,{color:makeChildAppender(writeColorTextNode),width:makeChildAppender(writeDecimalTextNode)});function writeLineStyle(_t,e,n){const ei={node:_t},ti={color:e.getColor(),width:Number(e.getWidth())||1},ii=n[n.length-1].node,ri=LINE_STYLE_SEQUENCE[ii.namespaceURI],ni=makeSequence(ti,ri);pushSerializeAndPop(ei,LINE_STYLE_SERIALIZERS,OBJECT_PROPERTY_NODE_FACTORY,ni,n,ri)}const GEOMETRY_TYPE_TO_NODENAME$1={Point:"Point",LineString:"LineString",LinearRing:"LinearRing",Polygon:"Polygon",MultiPoint:"MultiGeometry",MultiLineString:"MultiGeometry",MultiPolygon:"MultiGeometry",GeometryCollection:"MultiGeometry"},GEOMETRY_NODE_FACTORY=function(_t,e,n){if(_t){const ei=e[e.length-1].node;return createElementNS(ei.namespaceURI,GEOMETRY_TYPE_TO_NODENAME$1[_t.getType()])}},POINT_NODE_FACTORY=makeSimpleNodeFactory("Point"),LINE_STRING_NODE_FACTORY=makeSimpleNodeFactory("LineString"),LINEAR_RING_NODE_FACTORY=makeSimpleNodeFactory("LinearRing"),POLYGON_NODE_FACTORY=makeSimpleNodeFactory("Polygon"),MULTI_GEOMETRY_SERIALIZERS=makeStructureNS(NAMESPACE_URIS$4,{LineString:makeChildAppender(writePrimitiveGeometry),Point:makeChildAppender(writePrimitiveGeometry),Polygon:makeChildAppender(writePolygon),GeometryCollection:makeChildAppender(writeMultiGeometry)});function writeMultiGeometry(_t,e,n){const ei={node:_t},ti=e.getType();let ii=[],ri;if(ti==="GeometryCollection")e.getGeometriesArrayRecursive().forEach(function(ni){const si=ni.getType();if(si==="MultiPoint")ii=ii.concat(ni.getPoints());else if(si==="MultiLineString")ii=ii.concat(ni.getLineStrings());else if(si==="MultiPolygon")ii=ii.concat(ni.getPolygons());else if(si==="Point"||si==="LineString"||si==="Polygon")ii.push(ni);else throw new Error("Unknown geometry type")}),ri=GEOMETRY_NODE_FACTORY;else if(ti==="MultiPoint")ii=e.getPoints(),ri=POINT_NODE_FACTORY;else if(ti==="MultiLineString")ii=e.getLineStrings(),ri=LINE_STRING_NODE_FACTORY;else if(ti==="MultiPolygon")ii=e.getPolygons(),ri=POLYGON_NODE_FACTORY;else throw new Error("Unknown geometry type");pushSerializeAndPop(ei,MULTI_GEOMETRY_SERIALIZERS,ri,ii,n)}const BOUNDARY_IS_SERIALIZERS=makeStructureNS(NAMESPACE_URIS$4,{LinearRing:makeChildAppender(writePrimitiveGeometry)});function writeBoundaryIs(_t,e,n){pushSerializeAndPop({node:_t},BOUNDARY_IS_SERIALIZERS,LINEAR_RING_NODE_FACTORY,[e],n)}const PLACEMARK_SERIALIZERS=makeStructureNS(NAMESPACE_URIS$4,{ExtendedData:makeChildAppender(writeExtendedData),MultiGeometry:makeChildAppender(writeMultiGeometry),LineString:makeChildAppender(writePrimitiveGeometry),LinearRing:makeChildAppender(writePrimitiveGeometry),Point:makeChildAppender(writePrimitiveGeometry),Polygon:makeChildAppender(writePolygon),Style:makeChildAppender(writeStyle),address:makeChildAppender(writeStringTextNode),description:makeChildAppender(writeStringTextNode),name:makeChildAppender(writeStringTextNode),open:makeChildAppender(writeBooleanTextNode),phoneNumber:makeChildAppender(writeStringTextNode),styleUrl:makeChildAppender(writeStringTextNode),visibility:makeChildAppender(writeBooleanTextNode)}),PLACEMARK_SEQUENCE=makeStructureNS(NAMESPACE_URIS$4,["name","open","visibility","address","phoneNumber","description","styleUrl","Style"]),EXTENDEDDATA_NODE_FACTORY=makeSimpleNodeFactory("ExtendedData");function writePlacemark(_t,e,n){const ei={node:_t};e.getId()&&_t.setAttribute("id",e.getId());const ti=e.getProperties(),ii={address:1,description:1,name:1,open:1,phoneNumber:1,styleUrl:1,visibility:1};ii[e.getGeometryName()]=1;const ri=Object.keys(ti||{}).sort().filter(function(ui){return!ii[ui]}),ni=e.getStyleFunction();if(ni){const ui=ni(e,0);if(ui){const di=Array.isArray(ui)?ui:[ui];let fi=di;if(e.getGeometry()&&(fi=di.filter(function(hi){const pi=hi.getGeometryFunction()(e);if(pi){const gi=pi.getType();return gi==="GeometryCollection"?pi.getGeometriesArrayRecursive().filter(function(vi){const yi=vi.getType();return yi==="Point"||yi==="MultiPoint"}).length:gi==="Point"||gi==="MultiPoint"}})),this.writeStyles_){let hi=di,pi=di;e.getGeometry()&&(hi=di.filter(function(gi){const vi=gi.getGeometryFunction()(e);if(vi){const yi=vi.getType();return yi==="GeometryCollection"?vi.getGeometriesArrayRecursive().filter(function(_i){const Ai=_i.getType();return Ai==="LineString"||Ai==="MultiLineString"}).length:yi==="LineString"||yi==="MultiLineString"}}),pi=di.filter(function(gi){const vi=gi.getGeometryFunction()(e);if(vi){const yi=vi.getType();return yi==="GeometryCollection"?vi.getGeometriesArrayRecursive().filter(function(_i){const Ai=_i.getType();return Ai==="Polygon"||Ai==="MultiPolygon"}).length:yi==="Polygon"||yi==="MultiPolygon"}})),ti.Style={pointStyles:fi,lineStyles:hi,polyStyles:pi}}if(fi.length&&ti.name===void 0){const hi=fi[0].getText();hi&&(ti.name=hi.getText())}}}const si=n[n.length-1].node,ai=PLACEMARK_SEQUENCE[si.namespaceURI],oi=makeSequence(ti,ai);if(pushSerializeAndPop(ei,PLACEMARK_SERIALIZERS,OBJECT_PROPERTY_NODE_FACTORY,oi,n,ai),ri.length>0){const ui=makeSequence(ti,ri);pushSerializeAndPop(ei,PLACEMARK_SERIALIZERS,EXTENDEDDATA_NODE_FACTORY,[{names:ri,values:ui}],n)}const li=n[0];let ci=e.getGeometry();ci&&(ci=transformGeometryWithOptions(ci,!0,li)),pushSerializeAndPop(ei,PLACEMARK_SERIALIZERS,GEOMETRY_NODE_FACTORY,[ci],n)}const PRIMITIVE_GEOMETRY_SEQUENCE=makeStructureNS(NAMESPACE_URIS$4,["extrude","tessellate","altitudeMode","coordinates"]),PRIMITIVE_GEOMETRY_SERIALIZERS=makeStructureNS(NAMESPACE_URIS$4,{extrude:makeChildAppender(writeBooleanTextNode),tessellate:makeChildAppender(writeBooleanTextNode),altitudeMode:makeChildAppender(writeStringTextNode),coordinates:makeChildAppender(writeCoordinatesTextNode)});function writePrimitiveGeometry(_t,e,n){const ei=e.getFlatCoordinates(),ti={node:_t};ti.layout=e.getLayout(),ti.stride=e.getStride();const ii=e.getProperties();ii.coordinates=ei;const ri=n[n.length-1].node,ni=PRIMITIVE_GEOMETRY_SEQUENCE[ri.namespaceURI],si=makeSequence(ii,ni);pushSerializeAndPop(ti,PRIMITIVE_GEOMETRY_SERIALIZERS,OBJECT_PROPERTY_NODE_FACTORY,si,n,ni)}const POLY_STYLE_SEQUENCE=makeStructureNS(NAMESPACE_URIS$4,["color","fill","outline"]),POLYGON_SERIALIZERS=makeStructureNS(NAMESPACE_URIS$4,{outerBoundaryIs:makeChildAppender(writeBoundaryIs),innerBoundaryIs:makeChildAppender(writeBoundaryIs)}),INNER_BOUNDARY_NODE_FACTORY=makeSimpleNodeFactory("innerBoundaryIs"),OUTER_BOUNDARY_NODE_FACTORY=makeSimpleNodeFactory("outerBoundaryIs");function writePolygon(_t,e,n){const ei=e.getLinearRings(),ti=ei.shift(),ii={node:_t};pushSerializeAndPop(ii,POLYGON_SERIALIZERS,INNER_BOUNDARY_NODE_FACTORY,ei,n),pushSerializeAndPop(ii,POLYGON_SERIALIZERS,OUTER_BOUNDARY_NODE_FACTORY,[ti],n)}const POLY_STYLE_SERIALIZERS=makeStructureNS(NAMESPACE_URIS$4,{color:makeChildAppender(writeColorTextNode),fill:makeChildAppender(writeBooleanTextNode),outline:makeChildAppender(writeBooleanTextNode)});function writePolyStyle(_t,e,n){const ei={node:_t},ti=e.getFill(),ii=e.getStroke(),ri={color:ti?ti.getColor():void 0,fill:ti?void 0:!1,outline:ii?void 0:!1},ni=n[n.length-1].node,si=POLY_STYLE_SEQUENCE[ni.namespaceURI],ai=makeSequence(ri,si);pushSerializeAndPop(ei,POLY_STYLE_SERIALIZERS,OBJECT_PROPERTY_NODE_FACTORY,ai,n,si)}function writeScaleTextNode(_t,e){writeDecimalTextNode(_t,Math.round(e*1e6)/1e6)}const STYLE_SEQUENCE=makeStructureNS(NAMESPACE_URIS$4,["IconStyle","LabelStyle","LineStyle","PolyStyle"]),STYLE_SERIALIZERS=makeStructureNS(NAMESPACE_URIS$4,{IconStyle:makeChildAppender(writeIconStyle),LabelStyle:makeChildAppender(writeLabelStyle),LineStyle:makeChildAppender(writeLineStyle),PolyStyle:makeChildAppender(writePolyStyle)});function writeStyle(_t,e,n){const ei={node:_t},ti={};if(e.pointStyles.length){const si=e.pointStyles[0].getText();si&&(ti.LabelStyle=si);const ai=e.pointStyles[0].getImage();ai&&typeof ai.getSrc=="function"&&(ti.IconStyle=ai)}if(e.lineStyles.length){const si=e.lineStyles[0].getStroke();si&&(ti.LineStyle=si)}if(e.polyStyles.length){const si=e.polyStyles[0].getStroke();si&&!ti.LineStyle&&(ti.LineStyle=si),ti.PolyStyle=e.polyStyles[0]}const ii=n[n.length-1].node,ri=STYLE_SEQUENCE[ii.namespaceURI],ni=makeSequence(ti,ri);pushSerializeAndPop(ei,STYLE_SERIALIZERS,OBJECT_PROPERTY_NODE_FACTORY,ni,n,ri)}function writeVec2(_t,e){_t.setAttribute("x",String(e.x)),_t.setAttribute("y",String(e.y)),_t.setAttribute("xunits",e.xunits),_t.setAttribute("yunits",e.yunits)}var ColorUtils={hex:function(_t){if(_t>255)throw new Error("'"+_t+"'' is greater than 255(0xff);");var e=Number(_t).toString(16);return("0"+e).slice(-2)},num:function(_t){return parseInt(_t,16)},arrayToRgba:function(_t){if(!Array.isArray(_t))throw new Error("Not an array !");var e=_t[0],n=_t[1],ei=_t[2],ti=_t[3]||1,ii="rgba("+e+", "+n+", "+ei+", "+parseFloat(ti)+")";return ii},arrayToHex:function(_t){if(!Array.isArray(_t))throw new Error("Not an array !");var e=_t[0],n=_t[1],ei=_t[2],ti=_t[3],ii=[this.hex(e),this.hex(n),this.hex(ei)],ri={};return ri.hex="#"+ii.join(""),ti&&(ri.opacity=parseFloat(ti)),ri},rgbaToHex:function(_t){var e=/rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(0?.?\d+)\s*)?\)/,n=e.exec(_t);if(!n)throw new Error("Invalid format: "+_t);var ei=n[1],ti=n[2],ii=n[3],ri=n[4],ni=[this.hex(ei),this.hex(ti),this.hex(ii)],si={};return si.hex="#"+ni.join(""),ri&&(si.opacity=parseFloat(ri)),si},hexToRgba:function(_t,e){var n=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;if(!_t)throw new Error("Invalid format");_t=_t.replace(n,function(ii,ri,ni,si){return ri+ri+ni+ni+si+si});var ei=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(_t);ei=ei?{r:parseInt(ei[1],16),g:parseInt(ei[2],16),b:parseInt(ei[3],16)}:null;var ti=ei?"rgba("+ei.r+", "+ei.g+", "+ei.b+", "+e+")":null;return ti},isHex:function(_t){if(!_t||_t.charAt(0)!=="#")return!1;var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,n=e.exec(_t);return!!n},isRGB:function(_t){if(!_t)return!1;var e=/rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(0?.?\d+)\s*)?\)/,n=e.exec(_t);return!!n}},logger$F=LoggerByDefault.getLogger("styling");Feature.prototype.setPropertyFill=function(){var _t=this.getStyle();if(_t&&!(Array.isArray(_t)&&_t.length===0)){var e=_t.getFill();if(e){var n=e.getColor();if(Array.isArray(n)){var ei="rgba(";ei+=n[0]+",",ei+=n[1]+",",ei+=n[2]+",",ei+=n[3]+")",n=ei}if(ColorUtils.isRGB(n)){var ti=ColorUtils.rgbaToHex(n);this.set("fill",ti.hex),this.set("fill-opacity",ti.opacity)}else this.set("fill",n),this.set("fill-opacity",1)}}};Feature.prototype.setPropertyStroke=function(){var _t=this.getStyle();if(_t&&!(Array.isArray(_t)&&_t.length===0)){var e=_t.getStroke();if(e){var n=e.getColor();if(Array.isArray(n)){var ei="rgba(";ei+=n[0]+",",ei+=n[1]+",",ei+=n[2]+",",ei+=n[3]+")",n=ei}if(ColorUtils.isRGB(n)){var ti=ColorUtils.rgbaToHex(n);this.set("stroke",ti.hex),this.set("stroke-opacity",ti.opacity)}else this.set("stroke",n),this.set("stroke-opacity",1);this.set("stroke-width",e.getWidth())}}};Feature.prototype.setPropertyLabel=function(){var _t=this.getStyle();if(_t&&!(Array.isArray(_t)&&_t.length===0)){var e=this.get("name")!==void 0,n=_t.getText();if(n&&e){var ei=_t.getText().getFill();if(ei){var ti=ei.getColor();if(Array.isArray(ti)){var ii="rgba(";ii+=ti[0]+",",ii+=ti[1]+",",ii+=ti[2]+",",ii+=ti[3]+")",ti=ii}if(ColorUtils.isRGB(ti)){var ri=ColorUtils.rgbaToHex(ti);this.set("label-fill",ri.hex),this.set("label-fill-opacity",ri.opacity)}else this.set("label-fill",ti),this.set("label-fill-opacity",1)}var ni=_t.getText().getStroke();if(ni){var si=ni.getColor();if(Array.isArray(si)){var ai="rgba(";ai+=si[0]+",",ai+=si[1]+",",ai+=si[2]+",",ai+=si[3]+")",si=ai}if(ColorUtils.isRGB(si)){var oi=ColorUtils.rgbaToHex(si);this.set("label-stroke",oi.hex),this.set("label-stroke-opacity",oi.opacity)}else this.set("label-stroke",si),this.set("label-stroke-opacity",1);this.set("label-stroke-width",ni.getWidth())}this.set("label-font",_t.getText().getFont()||Styling.DEFAULT_TEXT.font),this.set("label-textAlign",_t.getText().getTextAlign()||Styling.DEFAULT_TEXT.textAlign)}}};Feature.prototype.setPropertyMarker=function(){var _t=this.getStyle();if(_t&&!(Array.isArray(_t)&&_t.length===0)){var e=_t.getImage();if(e)if(e instanceof Icon){var n=e.getColor();if(Array.isArray(n)){var ei="rgba(";ei+=n[0]+",",ei+=n[1]+",",ei+=n[2]+",",ei+=n[3]+")",n=ei}if(n){var ti=ColorUtils.rgbaToHex(n);this.set("marker-color",ti.hex)}var ii=e.getScale();switch(Math.round(ii*2)/2){case 0:case .5:this.set("marker-size","small");break;case 1:this.set("marker-size","medium");break;case 1.5:case 2:this.set("marker-size","large");break}var ri=e.getSrc();ri&&this.set("marker-symbol",ri),this.unset("circle-fill"),this.unset("circle-fill-opacity"),this.unset("circle-stroke"),this.unset("circle-stroke-width"),this.unset("circle-stroke-opacity"),this.unset("circle-radius")}else{var ni=e.getFill();if(ni){var si=ni.getColor();if(Array.isArray(si)){var ai="rgba(";ai+=si[0]+",",ai+=si[1]+",",ai+=si[2]+",",ai+=si[3]+")",si=ai}if(ColorUtils.isRGB(si)){var oi=ColorUtils.rgbaToHex(si);this.set("circle-fill",oi.hex),this.set("circle-fill-opacity",oi.opacity)}else this.set("circle-fill",si),this.set("circle-fill-opacity",1)}var li=e.getStroke();if(li){var ci=li.getColor();if(Array.isArray(ci)){var ui="rgba(";ui+=ci[0]+",",ui+=ci[1]+",",ui+=ci[2]+",",ui+=ci[3]+")",ci=ui}if(ColorUtils.isRGB(ci)){var di=ColorUtils.rgbaToHex(ci);this.set("circle-stroke",di.hex),this.set("circle-stroke-opacity",di.opacity)}else this.set("circle-stroke",ci),this.set("circle-stroke-opacity",1);this.set("circle-stroke-width",li.getWidth())}var fi=e.getRadius();this.set("circle-radius",fi)}}};var Styling={APPLY_CONVERT_GEOM_GPX:!0,DEFAULT_ICON:{src:Marker.lightOrange,anchor:[.5,1],scale:1},DEFAULT_CIRCLE:{radius:10,fill:{opacity:1,color:[0,0,0,1]},stroke:{width:1,opacity:1,color:[0,0,0,1]}},DEFAULT_STROKE:{width:5,opacity:1,color:[250,250,250,1]},DEFAULT_FILL:{opacity:1,color:[0,0,0,1]},DEFAULT_TEXT:{font:"16px sans",textAlign:"left",stroke:{color:[250,250,250,1],width:5,opactity:1},fill:{opacity:1,color:[0,0,0,1]}},getListTags:function(){return["type","fill","fill-opacity","stroke","stroke-opacity","stroke-width","circle-fill","circle-fill-opacity","circle-stroke","circle-stroke-opacity","circle-stroke-width","circle-radius","marker-symbol","marker-color","marker-size","label-fill","label-fill-opacity","label-stroke","label-stroke-width","label-stroke-opacity","label-font","label-textAlign"]},defineStyleFromProperties:function(_t){var e=null,n={},ei=null;if(_t.get("marker-color")||_t.get("marker-size")||_t.get("marker-symbol")){ei={},ei.src=this.DEFAULT_ICON.src,ei.anchor=this.DEFAULT_ICON.anchor;var ti=_t.get("marker-symbol");ti&&ti.search("data:image/png;base64")!==-1&&(ei.src=ti);var ii=_t.get("marker-color");ColorUtils.isHex(ii)&&(ei.color=ColorUtils.hexToRgba(ii,1));var ri=_t.get("marker-size");if(ri)switch(ri){case"small":ei.scale=.5;break;case"medium":ei.scale=1;break;case"large":ei.scale=1.5;break;default:ei.scale=this.DEFAULT_ICON.scale;break}}var ni=null;(_t.get("stroke")||_t.get("stroke-opacity")||_t.get("stroke-width"))&&(ni={},ni.color=ColorUtils.hexToRgba(_t.get("stroke"),+_t.get("stroke-opacity")||this.DEFAULT_STROKE.opacity),ni.width=+_t.get("stroke-width")||this.DEFAULT_STROKE.width);var si=null;(_t.get("fill")||_t.get("fill-opacity"))&&(si={},si.color=ColorUtils.hexToRgba(_t.get("fill"),+_t.get("fill-opacity")||this.DEFAULT_FILL.opacity));var ai=null,oi=null,li=_t.get("name")!=="";li&&((_t.get("label-fill")||_t.get("label-fill-opacity"))&&(oi={},oi.color=ColorUtils.hexToRgba(_t.get("label-fill"),+_t.get("label-fill-opacity")||this.DEFAULT_TEXT.fill.opacity)),(_t.get("label-stroke")||_t.get("label-stroke-opacity")||_t.get("label-stroke-width"))&&(ai={},ai.color=ColorUtils.hexToRgba(_t.get("label-stroke"),+_t.get("label-stroke-opacity")||this.DEFAULT_TEXT.stroke.opacity),ai.width=+_t.get("label-stroke-width")||this.DEFAULT_TEXT.stroke.width));var ci=_t.get("circle-radius")||this.DEFAULT_CIRCLE.radius,ui=null;(_t.get("circle-stroke")||_t.get("circle-stroke-opacity")||_t.get("circle-stroke-width"))&&(ui={},ui.color=ColorUtils.hexToRgba(_t.get("circle-stroke"),+_t.get("circle-stroke-opacity")||this.DEFAULT_CIRCLE.stroke.opacity),ui.width=+_t.get("circle-stroke-width")||this.DEFAULT_CIRCLE.stroke.width);var di=null;if((_t.get("circle-fill")||_t.get("circle-fill-opacity"))&&(di={},di.color=ColorUtils.hexToRgba(_t.get("circle-fill"),+_t.get("circle-fill-opacity")||this.DEFAULT_CIRCLE.fill.opacity)),_t.getGeometry()){var fi=_t.getGeometry().getType();switch(fi){case"Circle":case"Point":case"MultiPoint":var hi=!1,pi={};if(ui&&(pi.stroke=new Stroke(ui)),di&&(pi.fill=new Fill(di)),Object.keys(pi).length!==0&&(hi=!0,pi.radius=+ci,n.image=new CircleStyle(pi)),ei&&(n.image=new Icon(ei)),li){var gi={};if(ai&&(gi.stroke=new Stroke(ai)),oi&&(gi.fill=new Fill(oi)),Object.keys(gi).length!==0)gi.text=_t.get("name"),gi.textAlign=_t.get("label-textAlign")||this.DEFAULT_TEXT.textAlign,gi.font=_t.get("label-font")||this.DEFAULT_TEXT.font,n.text=new Text(Object.assign({},this.DEFAULT_TEXT,gi));else if(ei||hi){var vi=new Text(Object.assign({},this.DEFAULT_TEXT,{fill:new Fill(this.DEFAULT_TEXT.fill),stroke:new Stroke(this.DEFAULT_TEXT.stroke)}));if(vi){var yi=vi.clone();yi.setText(_t.get("name")),n.text=yi}}}break;case"Polygon":case"MultiPolygon":ni&&(n.stroke=new Stroke(ni)),si&&(n.fill=new Fill(si));break;case"LineString":case"MultiLineString":if(ni&&(n.stroke=new Stroke(ni)),this.APPLY_CONVERT_GEOM_GPX&&si){var _i=_t.get("type");if(_i&&(_i==="Polygon"||_i==="MultiPolygon")){n.fill=new Fill(si);var Ai=_t.clone(),Ei=fi==="LineString"?Polygon:MultiPolygon;_t.setGeometry(new Ei([Ai.getGeometry().getCoordinates()]))}}break}}return Object.keys(n).length!==0&&(e=new Style$1(n)),e},defineStyleFunctionByDefault:function(_t){if(!_t)return[];if(Object.keys(_t).length===0)return[];var e=(n,ei)=>{if(n.getGeometry()){var ti=null,ii=n.getGeometry().getType();switch(ii){case"Point":case"MultiPoint":var ri={};if(_t.getImage()&&(ri.image=_t.getImage()),_t.getText()&&n.get("name")){var ni=_t.getText().clone();ni.setText(n.get("name")),ri.text=ni}ti=new Style$1(ri);break;case"Circle":var si={},ai={};if(_t.getFill()&&(ai.fill=_t.getFill()),_t.getStroke()&&(ai.stroke=_t.getStroke()),_t.getText()&&n.get("name")){var oi=_t.getText().clone();oi.setText(n.get("name")),si.text=oi}Object.keys(ai).length!==0&&(ai.radius=3,si.image=new CircleStyle(ai)),ti=new Style$1(si);break;case"Polygon":case"MultiPolygon":var li={};_t.getFill()&&(li.fill=_t.getFill()),_t.getStroke()&&(li.stroke=_t.getStroke()),ti=new Style$1(li);break;case"LineString":case"LinearRing":case"MultiLineString":var ci={};_t.getStroke()&&(ci.stroke=_t.getStroke()),ti=new Style$1(ci);break}return[ti]}};return e},definePropertiesFromStyleByType:function(_t){if(_t.getGeometry()){var e=_t.getGeometry().getType();switch(e){case"Point":case"MultiPoint":_t.setPropertyMarker(),_t.setPropertyLabel();break;case"LineString":case"MultiLineString":_t.setPropertyStroke();break;case"Polygon":case"MultiPolygon":_t.setPropertyStroke(),_t.setPropertyFill();break}}},definePropertiesFromStyle:function(_t){var e=_t.getStyle()||_t.getStyleFunction();if(e){if(typeof e=="function"){var n=e.call(this,_t,0);if(n&&n.length!==0)e=Array.isArray(n)?n[0]:n,_t.setStyle(e);else return}this.definePropertiesFromStyleByType(_t)}},defineTagFromStyle:function(_t,e){return logger$F.trace("todo..."),null}},logger$E=LoggerByDefault.getLogger("parser"),Parser$1={parse:function(_t){var e=null,n=null,ei=typeof window<"u"?window:null;if(typeof exports=="object"&&window===null){var ti=require("@xmldom/xmldom").DOMParser;n=new ti,e=n.parseFromString(_t,"text/xml")}else ei.DOMParser?(n=new ei.DOMParser,e=n.parseFromString(_t,"text/xml")):ei.ActiveXObject?(e=new ei.ActiveXObject("Microsoft.XMLDOM"),e.async=!1,e.loadXML(_t)):logger$E.log("Incompatible environment for DOM Parser !");var ii=e.querySelector("parsererror");return ii?(console.error(ii),null):(logger$E.trace(e),e)},toString:function(_t){var e=new XMLSerializer,n=e.serializeToString(_t);return logger$E.trace(n),n},format:function(_t){var e=/(>)\s*(<)(\/*)/g,n=/ *(.*) +\n/g,ei=/(<.+>)(.+\n)/g;_t=_t.replace(e,`$1
$2$3`).replace(n,`$1
`).replace(ei,`$1
$2`);for(var ti="",ii=_t.split(`
`),ri=0,ni="other",si={"single->single":0,"single->closing":-1,"single->opening":0,"single->other":0,"closing->single":0,"closing->closing":-1,"closing->opening":0,"closing->other":0,"opening->single":1,"opening->closing":0,"opening->opening":1,"opening->other":1,"other->single":0,"other->closing":-1,"other->opening":0,"other->other":0},ai=0;ai<ii.length;ai++){var oi=ii[ai],li=!!oi.match(/<.+\/>/),ci=!!oi.match(/<\/.+>/),ui=!!oi.match(/<[^!].*>/),di=li?"single":ci?"closing":ui?"opening":"other",fi=ni+"->"+di;ni=di;var hi="";ri+=si[fi];for(var pi=0;pi<ri;pi++)hi+="	";fi==="opening->closing"?ti=ti.substr(0,ti.length-1)+oi+`
`:ti+=hi+oi+`
`}return logger$E.trace(ti),ti}},logger$D=LoggerByDefault.getLogger("extended KML format");class KML extends KML$1{constructor(e){if(super(e),!(this instanceof KML))throw new TypeError("ERROR CLASS_CONSTRUCTOR");return e=e||{},this.source=null,this.extensions=e.extensions||null,e.defaultStyle&&!Array.isArray(e.defaultStyle)&&(e.defaultStyle=[e.defaultStyle]),(e.defaultStyle===null||typeof e.defaultStyle>"u")&&(e.defaultStyle=[]),this}_processKml(e,n,ei){for(var ti=e.nodeName==="#document"?e.childNodes[0].childNodes:e.childNodes,ii=ti,ri=0;ri<ti.length;ri++){const Yi=ti[ri];if(Yi.nodeName==="Document"){ii=Yi.childNodes;break}if(Yi.nodeName==="Placemark"){ii=[Yi];break}}for(var ni={},si=-1,ai=0;ai<ii.length;ai++){var oi=ii[ai];switch(oi.nodeName){case"Style":var li=oi.attributes[0];if(li&&li.nodeName==="id"){var ci=li.nodeValue,ui=oi;ni[ci]=ui}break;case"Placemark":si++;for(var di=oi.childNodes,fi=!1,hi=!1,pi=!1,gi=null,vi=null,yi=null,_i=oi,Ai=0;Ai<di.length;Ai++)switch(di[Ai].nodeName){case"Polygon":pi=!0;break;case"LineString":hi=!0;break;case"Point":fi=!0;break;case"Style":vi=di[Ai],gi=di[Ai].childNodes;break;case"styleUrl":var Ei=di[Ai].textContent.slice(1);ni[Ei]&&(gi=ni[Ei].childNodes);break;case"ExtendedData":yi=di[Ai].childNodes;break;case"name":_i=null;break}if(yi){logger$D.log("ExtendedData :",yi);var Si=ei.extendedData;Si&&typeof Si=="function"&&Si(n[si],yi)}if(_i){logger$D.log("Name :",_i);var wi=ei.nameData;wi&&typeof wi=="function"&&wi(n[si],_i)}if(fi&&gi&&gi.length!==0){for(var Oi=null,Ii=null,Li=0;Li<gi.length;Li++)switch(gi[Li].nodeName){case"LabelStyle":Oi=gi[Li];break;case"IconStyle":Ii=gi[Li];break}var Di=n[si].getProperties().name,Ni=n[si].getProperties().description,$i=Di||Ni;if(logger$D.trace($i),!Ii&&Oi){var Ki=ei.labelStyle;Ki&&typeof Ki=="function"&&Ki(n[si],Oi)}else if(Ii&&!Oi){var er=ei.iconStyle;er&&typeof er=="function"&&er(n[si],Ii)}else if(Ii&&Oi){var Vi=ei.iconLabelStyle;Vi&&typeof Vi=="function"&&Vi(n[si],Ii,Oi)}}else{var nr=n[si],zi=nr.getStyle();if(zi&&typeof zi=="function"){var Wi=zi.call(this,nr,0);Wi&&Wi.length!==0&&(zi=Wi[0])}if(pi){var Ti=ei.polygonStyle;Ti&&typeof Ti=="function"&&Ti(n[si],gi)}if(hi){var ki=ei.lineStringStyle;ki&&typeof ki=="function"&&ki(n[si],gi)}if(fi&&zi){var xi=zi.getImage();if(xi&&xi instanceof CircleStyle){var Mi=ei.circleStyle;Mi&&typeof Mi=="function"&&Mi(n[si],vi)}else if(xi&&xi instanceof Icon){var Ui=ei.pointStyle;Ui&&typeof Ui=="function"&&Ui(n[si],vi)}}}break;default:logger$D.trace("tag is not processing !")}}}writeFeatures(e,n){logger$D.log("overload : ol.format.KML.writeFeatures");var ei=super.writeFeaturesNode(e,n);if(ei===null)return null;this.hasOwnProperty("extensions")&&this._writeRootExtensions(ei,this.extensions);var ti=this._writeExtendStylesFeatures(ei,e,n),ii=Parser$1.format(ti);return ii===""?null:ii}_writeExtendStylesFeatures(e,n,ei){function ti(ui,di){var fi=ui.toString(16);fi.charAt(0)==="#"&&(fi=fi.slice(1)),di=di||1,di=parseInt(di*255,10),di=di.toString(16);var hi=di;return hi=hi+fi.substr(4,2),hi=hi+fi.substr(2,2),hi=hi+fi.substr(0,2),hi.toLowerCase()}var ii=function(ui,di){if(logger$D.trace("label with style :",di),!!ui&&ui.getStyle()instanceof Style$1){var fi=ui.getStyle().getText();if(!fi)return;var hi="Sans",pi="16px",gi=fi.getFont();if(gi){var vi=gi.split(" ",2);pi=vi[0],hi=vi[1]}var yi=ui.getStyle().getText().getStroke();if(!yi)return;if(yi instanceof Stroke){var _i=ti("#FFFFFF"),Ai=yi.getColor();if(Array.isArray(Ai)){var Ei="rgba(";Ei+=Ai[0]+",",Ei+=Ai[1]+",",Ei+=Ai[2]+",",Ei+=Ai[3]+")",Ai=Ei}if(ColorUtils.isRGB(Ai)){var Si=ColorUtils.rgbaToHex(Ai);_i=ti(Si.hex,Si.opacity)}else _i=ti(Ai);var wi=yi.getWidth()||"0",Oi="1";if(di&&di.getElementsByTagName("LabelStyleSimpleExtensionGroup").length===0){var Ii=document.createElementNS(e.namespaceURI,"LabelStyleSimpleExtensionGroup");Ii.setAttribute("fontSize",pi),Ii.setAttribute("fontFamily",hi),Ii.setAttribute("haloColor",_i),Ii.setAttribute("haloRadius",wi),Ii.setAttribute("haloOpacity",Oi),di.appendChild(Ii)}}var Li=ui.getStyle().getImage();if(!Li)return;if(Li instanceof CircleStyle){var Di=null,Ni=null;if(Li.getStroke()){if(Ni=Li.getStroke().getWidth(),Di=Li.getStroke().getColor(),Array.isArray(Di)){var $i="rgba(";$i+=Di[0]+",",$i+=Di[1]+",",$i+=Di[2]+",",$i+=Di[3]+")",Di=$i}if(ColorUtils.isRGB(Di)){var Ki=ColorUtils.rgbaToHex(Di);Di=ti(Ki.hex,Ki.opacity)}else Di=ti(Di)}var er=null;if(Li.getFill()){if(er=Li.getFill().getColor(),Array.isArray(er)){var Vi="rgba(";Vi+=er[0]+",",Vi+=er[1]+",",Vi+=er[2]+",",Vi+=er[3]+")",er=Vi}if(ColorUtils.isRGB(er)){var nr=ColorUtils.rgbaToHex(er);er=ti(nr.hex,nr.opacity)}else er=ti(er)}if(di&&di.getElementsByTagName("ObjectSimpleExtensionGroup").length===0){var zi=document.createElementNS(e.namespaceURI,"ObjectSimpleExtensionGroup");zi.setAttribute("type","circle"),zi.setAttribute("radius",Li.getRadius()),zi.setAttribute("fillColor",er),zi.setAttribute("strokeColor",Di),zi.setAttribute("strokeWidth",Ni),di.appendChild(zi)}}}},ri=function(ui,di){if(logger$D.trace("marker with style (hotspot):",di),!!ui&&ui.getStyle()instanceof Style$1){var fi=ui.getStyle().getImage();if(!fi)return;if(fi instanceof Icon){var hi=0,pi=0,gi="pixels",vi="pixels",yi=fi.getSize(),_i=fi.getAnchor();if(_i.length&&(hi=_i[0],pi=_i[1],vi==="fraction"?pi=pi===1?0:1-pi:pi=vi==="pixels"&&pi===yi[1]?0:yi[1]-pi),di&&di.getElementsByTagName("hotSpot").length===0){var Ai=document.createElementNS(e.namespaceURI,"hotSpot");Ai.setAttribute("x",hi),Ai.setAttribute("y",pi),Ai.setAttribute("xunits",gi),Ai.setAttribute("yunits",vi),di.appendChild(Ai)}}}},ni=function(ui,di){if(ui&&ui.getStyle()instanceof Style$1){var fi=ui.getStyle().getImage();if(!fi)return;if(fi instanceof CircleStyle){var hi=null,pi=null;if(fi.getStroke()){if(pi=fi.getStroke().getWidth(),hi=fi.getStroke().getColor(),Array.isArray(hi)){var gi="rgba(";gi+=hi[0]+",",gi+=hi[1]+",",gi+=hi[2]+",",gi+=hi[3]+")",hi=gi}if(ColorUtils.isRGB(hi)){var vi=ColorUtils.rgbaToHex(hi);hi=ti(vi.hex,vi.opacity)}else hi=ti(hi)}var yi=null;if(fi.getFill()){if(yi=fi.getFill().getColor(),Array.isArray(yi)){var _i="rgba(";_i+=yi[0]+",",_i+=yi[1]+",",_i+=yi[2]+",",_i+=yi[3]+")",yi=_i}if(ColorUtils.isRGB(yi)){var Ai=ColorUtils.rgbaToHex(yi);yi=ti(Ai.hex,Ai.opacity)}else yi=ti(yi)}if(di&&di.getElementsByTagName("ObjectSimpleExtensionGroup").length===0){var Ei=document.createElementNS(e.namespaceURI,"LabelStyle"),Si=document.createElementNS(e.namespaceURI,"ObjectSimpleExtensionGroup");Si.setAttribute("type","circle"),Si.setAttribute("radius",fi.getRadius()),Si.setAttribute("fillColor",yi),Si.setAttribute("strokeColor",hi),Si.setAttribute("strokeWidth",pi),Ei.appendChild(Si),di.appendChild(Ei)}}}},si=function(ui,di){},ai=function(ui,di,fi){logger$D.trace("write an icon with a label"),ri(ui,di),ii(ui,fi)},oi=function(ui,di){for(var fi=0;fi<di.length;fi++){var hi=di[fi];if(hi.nodeName==="name")return}var pi=ui.getProperties().name;if(pi){var gi=document.createElement("name");gi.innerHTML=pi,di.appendChild(gi)}},li=function(ui,di){if(di&&di.length){for(var fi=[],hi=0;hi<di.length;hi++){const gi=di[hi];if(gi.nodeName==="Data"){var pi=gi.getAttribute("name");Styling.getListTags().includes(pi)&&fi.push(gi)}}fi&&fi.length&&fi.forEach(gi=>{gi.remove()})}};this._processKml(e,n,{labelStyle:ii,iconStyle:ri,iconLabelStyle:ai,circleStyle:ni,pointStyle:si,nameData:oi,extendedData:li});var ci=Parser$1.toString(e);return ci||null}_writeRootExtensions(e,n){var ei=document.createElementNS(e.namespaceURI,"ExtendedData");for(const ni in n)if(Object.hasOwnProperty.call(n,ni)){const si=n[ni];var ti=document.createElementNS(e.namespaceURI,"Data");ti.setAttribute("name",ni);var ii=document.createTextNode(JSON.stringify(si));ti.appendChild(ii),ei.appendChild(ti)}var ri=e.firstChild;e.insertBefore(ei,ri)}readFeatures(e,n){logger$D.log("overload : ol.format.KML.readFeatures"),typeof e=="string"?this.source=Parser$1.parse(e):e!==null&&(this.source=e);var ei=this._readExtendStylesFeatures(e,n);return logger$D.trace("Styles tendus",ei),ei.forEach(ti=>{Styling.definePropertiesFromStyle(ti)}),ei}_readExtendStylesFeatures(e,n){var ei=super.readFeatures(e,n),ti=null,ii="";if(typeof e=="string"?ii=e:ii=e.documentElement.outerHTML,ii=ii.replace(/\n/g,""),ii=ii.replace(/(>)\s*(<)/g,"$1$2"),ti=Parser$1.parse(ii),ti===null)return ei;function ri(ci){var ui="";ui=ui+ci.substr(6,2),ui=ui+ci.substr(4,2),ui=ui+ci.substr(2,2);for(var di=parseInt(ui,16).toString(16),fi="",hi=di.length||0,pi=0;pi<6-hi;pi++)fi+="0";return di="#"+fi+di,di}var ni=function(ci,ui){if(logger$D.trace("label with style :",ui),!!ci){for(var di=ci.getProperties().name,fi=ri("ff000000"),hi="#FFFFFF",pi=0,gi="Sans",vi="16px",yi=null,_i=5,Ai="#000000",Ei="#ffffff",Si=1,wi=!1,Oi=!1,Ii=ui.childNodes,Li=0;Li<Ii.length;Li++)switch(Ii[Li].nodeName){case"scale":break;case"colorMode":break;case"color":fi=ri(Ii[Li].textContent);break;case"LabelStyleSimpleExtensionGroup":wi=!0;for(var Di=Ii[Li].attributes,Ni=0;Ni<Di.length;Ni++)switch(Di[Ni].nodeName){case"fontFamily":gi=Di[Ni].nodeValue;break;case"fontSize":vi=Di[Ni].nodeValue;break;case"haloColor":hi=ri(Di[Ni].nodeValue);break;case"haloRadius":pi=parseInt(Di[Ni].nodeValue,10);break}break;case"ObjectSimpleExtensionGroup":Oi=!0;for(var $i=Ii[Li].attributes,Ki=0;Ki<$i.length;Ki++)switch($i[Ki].nodeName){case"type":yi=$i[Ki].nodeValue;break;case"radius":_i=parseInt($i[Ki].nodeValue,10);break;case"fillColor":var er=$i[Ki].nodeValue,Vi=Math.round(ColorUtils.num(er.substr(0,2))/255*10)/10,nr=ri(er);Ai=ColorUtils.hexToRgba(nr,Vi);break;case"strokeColor":var zi=$i[Ki].nodeValue,Wi=Math.round(ColorUtils.num(zi.substr(0,2))/255*10)/10,Ti=ri(zi);Ei=ColorUtils.hexToRgba(Ti,Wi);break;case"strokeWidth":Si=parseInt($i[Ki].nodeValue,10);break}break}var ki=null;Oi&&yi==="circle"?ki=new CircleStyle({radius:_i,fill:new Fill({color:Ai}),stroke:new Stroke({color:Ei,width:Si})}):wi&&(ki=new Icon({src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR4nGNiYAAAAAkAAxkR2eQAAAAASUVORK5CYII=",size:[51,38],anchor:[25.5,38],anchorOrigin:"top-left",anchorXUnits:"pixels",anchorYUnits:"pixels"})),ci.setStyle(new Style$1({image:ki,text:new Text({font:vi+" "+gi,textAlign:"left",text:di,fill:new Fill({color:fi}),stroke:new Stroke({color:hi,width:pi})})}))}},si=function(ci,ui){logger$D.trace("hotspot :",ui);for(var di=null,fi=null,hi=ri("ffffffff"),pi=!1,gi=51,vi=38,yi=!1,_i=25.5,Ai="pixels",Ei=38,Si="pixels",wi=ui.childNodes,Oi=!1,Ii=0;Ii<wi.length;Ii++)switch(wi[Ii].nodeName){case"Icon":Oi=!0;for(var Li=wi[Ii].childNodes,Di=0;Di<Li.length;Di++)switch(Li[Di].nodeName){case"href":di=Li[Di].textContent;break;case"gx:w":pi=!0,gi=parseFloat(Li[Di].textContent);break;case"gx:h":pi=!0,vi=parseFloat(Li[Di].textContent);break}break;case"hotSpot":yi=!0;for(var Ni=wi[Ii].attributes,$i=0;$i<Ni.length;$i++)switch(Ni[$i].nodeName){case"x":_i=parseFloat(Ni[$i].nodeValue);break;case"y":Ei=parseFloat(Ni[$i].nodeValue);break;case"yunits":Ai=Ni[$i].nodeValue;break;case"xunits":Si=Ni[$i].nodeValue;break}break;case"scale":fi=parseFloat(wi[Ii].textContent);break;case"color":hi=ri(wi[Ii].textContent);break}var Ki=null;if(Oi){var er={src:di||"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR4nGNiYAAAAAkAAxkR2eQAAAAASUVORK5CYII=",color:hi,crossOrigin:"anonymous",scale:fi||1};pi&&Helper.mergeParams(er,{size:[gi,vi]}),yi&&Helper.mergeParams(er,{anchor:[_i,Ei],anchorOrigin:"bottom-left",anchorXUnits:Ai||"pixels",anchorYUnits:Si||"pixels"}),Ki=new Icon(er)}var Vi=ci.getStyleFunction();if(Vi){var nr=Vi(ci,0);if(nr&&!Array.isArray(nr)&&(nr=[nr]),nr&&nr.length!==0){var zi=nr.length===1?nr[0]:nr[nr.length-1];ci.setStyle(new Style$1({image:Ki,text:zi.getText()}))}}},ai=function(ci,ui){if(logger$D.trace("extendData :",ui),!!ci){for(var di={},fi=ci.get("name")||"",hi=ci.get("description")||"",pi=null,gi=0;gi<ui.length;gi++){var vi=ui[gi],yi=vi.attributes[0],_i=vi.childNodes;if(yi.nodeName==="name")switch(yi.nodeValue){case"label":fi=vi.textContent,di.name=fi;break;case"title":case"attributetitle":for(var Ai=0;Ai<_i.length;Ai++)_i[Ai].nodeName==="value"&&(pi=_i[Ai].textContent);break;default:di[yi.nodeValue]=vi.textContent;break}}pi&&(hi=hi?pi+" : "+hi:pi,di.description=hi),Object.keys(di).length&&ci.setProperties(di,!0)}},oi=function(ci,ui,di){logger$D.trace("display icon and label"),ni(ci,di),si(ci,ui)},li=function(ci,ui){};return this._processKml(ti,ei,{lineStringStyle:li,polygonStyle:li,pointStyle:li,labelStyle:this.showPointNames_?ni:null,iconStyle:si,iconLabelStyle:this.showPointNames_?oi:si,extendedData:ai}),ei}readRootExtensions(e){for(var n={},ei=this.source.nodeName==="#document"?this.source.childNodes[0]:this.source,ti=ei.childNodes,ii=0;ii<ti.length;ii++){var ri=ti[ii];if(ri.nodeName==="ExtendedData")for(var ni=ri.childNodes,si=0;si<ni.length;si++){var ai=ni[si];if(ai.nodeName==="Data"){var oi=ai.attributes[0];if(oi&&oi.nodeName==="name"&&oi.nodeValue===e){n=JSON.parse(ai.textContent);break}}}}return n}}window.ol&&window.ol.format&&(window.ol.format.KMLExtended=KML);const NAMESPACE_URIS$3=[null,"http://www.topografix.com/GPX/1/0","http://www.topografix.com/GPX/1/1"],SCHEMA_LOCATION="http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd",FEATURE_READER={rte:readRte,trk:readTrk,wpt:readWpt},GPX_PARSERS=makeStructureNS(NAMESPACE_URIS$3,{rte:makeArrayPusher(readRte),trk:makeArrayPusher(readTrk),wpt:makeArrayPusher(readWpt)}),LINK_PARSERS=makeStructureNS(NAMESPACE_URIS$3,{text:makeObjectPropertySetter(readString,"linkText"),type:makeObjectPropertySetter(readString,"linkType")}),AUTHOR_PARSERS=makeStructureNS(NAMESPACE_URIS$3,{name:makeObjectPropertySetter(readString),email:parseEmail,link:parseLink}),METADATA_PARSERS=makeStructureNS(NAMESPACE_URIS$3,{name:makeObjectPropertySetter(readString),desc:makeObjectPropertySetter(readString),author:makeObjectPropertySetter(readAuthor),copyright:makeObjectPropertySetter(readCopyright),link:parseLink,time:makeObjectPropertySetter(readDateTime),keywords:makeObjectPropertySetter(readString),bounds:parseBounds,extensions:parseExtensions}),COPYRIGHT_PARSERS=makeStructureNS(NAMESPACE_URIS$3,{year:makeObjectPropertySetter(readPositiveInteger),license:makeObjectPropertySetter(readString)}),GPX_SERIALIZERS=makeStructureNS(NAMESPACE_URIS$3,{rte:makeChildAppender(writeRte),trk:makeChildAppender(writeTrk),wpt:makeChildAppender(writeWpt)});let GPX$1=class extends XMLFeature{constructor(e){super(),e=e||{},this.dataProjection=get$3("EPSG:4326"),this.readExtensions_=e.readExtensions}handleReadExtensions_(e){e||(e=[]);for(let n=0,ei=e.length;n<ei;++n){const ti=e[n];if(this.readExtensions_){const ii=ti.get("extensionsNode_")||null;this.readExtensions_(ti,ii)}ti.set("extensionsNode_",void 0)}}readMetadata(e){return e?typeof e=="string"?this.readMetadataFromDocument(parse$1(e)):isDocument(e)?this.readMetadataFromDocument(e):this.readMetadataFromNode(e):null}readMetadataFromDocument(e){for(let n=e.firstChild;n;n=n.nextSibling)if(n.nodeType===Node.ELEMENT_NODE){const ei=this.readMetadataFromNode(n);if(ei)return ei}return null}readMetadataFromNode(e){if(!NAMESPACE_URIS$3.includes(e.namespaceURI))return null;for(let n=e.firstElementChild;n;n=n.nextElementSibling)if(NAMESPACE_URIS$3.includes(n.namespaceURI)&&n.localName==="metadata")return pushParseAndPop({},METADATA_PARSERS,n,[]);return null}readFeatureFromNode(e,n){if(!NAMESPACE_URIS$3.includes(e.namespaceURI))return null;const ei=FEATURE_READER[e.localName];if(!ei)return null;const ti=ei(e,[this.getReadOptions(e,n)]);return ti?(this.handleReadExtensions_([ti]),ti):null}readFeaturesFromNode(e,n){if(!NAMESPACE_URIS$3.includes(e.namespaceURI))return[];if(e.localName=="gpx"){const ei=pushParseAndPop([],GPX_PARSERS,e,[this.getReadOptions(e,n)]);return ei?(this.handleReadExtensions_(ei),ei):[]}return[]}writeFeaturesNode(e,n){n=this.adaptOptions(n);const ei=createElementNS("http://www.topografix.com/GPX/1/1","gpx");return ei.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xsi",XML_SCHEMA_INSTANCE_URI),ei.setAttributeNS(XML_SCHEMA_INSTANCE_URI,"xsi:schemaLocation",SCHEMA_LOCATION),ei.setAttribute("version","1.1"),ei.setAttribute("creator","OpenLayers"),pushSerializeAndPop({node:ei},GPX_SERIALIZERS,GPX_NODE_FACTORY,e,[n]),ei}};const RTE_PARSERS=makeStructureNS(NAMESPACE_URIS$3,{name:makeObjectPropertySetter(readString),cmt:makeObjectPropertySetter(readString),desc:makeObjectPropertySetter(readString),src:makeObjectPropertySetter(readString),link:parseLink,number:makeObjectPropertySetter(readPositiveInteger),extensions:parseExtensions,type:makeObjectPropertySetter(readString),rtept:parseRtePt}),RTEPT_PARSERS=makeStructureNS(NAMESPACE_URIS$3,{ele:makeObjectPropertySetter(readDecimal),time:makeObjectPropertySetter(readDateTime)}),TRK_PARSERS=makeStructureNS(NAMESPACE_URIS$3,{name:makeObjectPropertySetter(readString),cmt:makeObjectPropertySetter(readString),desc:makeObjectPropertySetter(readString),src:makeObjectPropertySetter(readString),link:parseLink,number:makeObjectPropertySetter(readPositiveInteger),type:makeObjectPropertySetter(readString),extensions:parseExtensions,trkseg:parseTrkSeg}),TRKSEG_PARSERS=makeStructureNS(NAMESPACE_URIS$3,{trkpt:parseTrkPt}),TRKPT_PARSERS=makeStructureNS(NAMESPACE_URIS$3,{ele:makeObjectPropertySetter(readDecimal),time:makeObjectPropertySetter(readDateTime)}),WPT_PARSERS=makeStructureNS(NAMESPACE_URIS$3,{ele:makeObjectPropertySetter(readDecimal),time:makeObjectPropertySetter(readDateTime),magvar:makeObjectPropertySetter(readDecimal),geoidheight:makeObjectPropertySetter(readDecimal),name:makeObjectPropertySetter(readString),cmt:makeObjectPropertySetter(readString),desc:makeObjectPropertySetter(readString),src:makeObjectPropertySetter(readString),link:parseLink,sym:makeObjectPropertySetter(readString),type:makeObjectPropertySetter(readString),fix:makeObjectPropertySetter(readString),sat:makeObjectPropertySetter(readPositiveInteger),hdop:makeObjectPropertySetter(readDecimal),vdop:makeObjectPropertySetter(readDecimal),pdop:makeObjectPropertySetter(readDecimal),ageofdgpsdata:makeObjectPropertySetter(readDecimal),dgpsid:makeObjectPropertySetter(readPositiveInteger),extensions:parseExtensions}),LINK_SEQUENCE=["text","type"],LINK_SERIALIZERS=makeStructureNS(NAMESPACE_URIS$3,{text:makeChildAppender(writeStringTextNode),type:makeChildAppender(writeStringTextNode)}),RTE_SEQUENCE=makeStructureNS(NAMESPACE_URIS$3,["name","cmt","desc","src","link","number","type","rtept"]),RTE_SERIALIZERS=makeStructureNS(NAMESPACE_URIS$3,{name:makeChildAppender(writeStringTextNode),cmt:makeChildAppender(writeStringTextNode),desc:makeChildAppender(writeStringTextNode),src:makeChildAppender(writeStringTextNode),link:makeChildAppender(writeLink),number:makeChildAppender(writeNonNegativeIntegerTextNode),type:makeChildAppender(writeStringTextNode),rtept:makeArraySerializer(makeChildAppender(writeWptType))}),RTEPT_TYPE_SEQUENCE=makeStructureNS(NAMESPACE_URIS$3,["ele","time"]),TRK_SEQUENCE=makeStructureNS(NAMESPACE_URIS$3,["name","cmt","desc","src","link","number","type","trkseg"]),TRK_SERIALIZERS=makeStructureNS(NAMESPACE_URIS$3,{name:makeChildAppender(writeStringTextNode),cmt:makeChildAppender(writeStringTextNode),desc:makeChildAppender(writeStringTextNode),src:makeChildAppender(writeStringTextNode),link:makeChildAppender(writeLink),number:makeChildAppender(writeNonNegativeIntegerTextNode),type:makeChildAppender(writeStringTextNode),trkseg:makeArraySerializer(makeChildAppender(writeTrkSeg))}),TRKSEG_NODE_FACTORY=makeSimpleNodeFactory("trkpt"),TRKSEG_SERIALIZERS=makeStructureNS(NAMESPACE_URIS$3,{trkpt:makeChildAppender(writeWptType)}),WPT_TYPE_SEQUENCE=makeStructureNS(NAMESPACE_URIS$3,["ele","time","magvar","geoidheight","name","cmt","desc","src","link","sym","type","fix","sat","hdop","vdop","pdop","ageofdgpsdata","dgpsid"]),WPT_TYPE_SERIALIZERS=makeStructureNS(NAMESPACE_URIS$3,{ele:makeChildAppender(writeDecimalTextNode),time:makeChildAppender(writeDateTimeTextNode),magvar:makeChildAppender(writeDecimalTextNode),geoidheight:makeChildAppender(writeDecimalTextNode),name:makeChildAppender(writeStringTextNode),cmt:makeChildAppender(writeStringTextNode),desc:makeChildAppender(writeStringTextNode),src:makeChildAppender(writeStringTextNode),link:makeChildAppender(writeLink),sym:makeChildAppender(writeStringTextNode),type:makeChildAppender(writeStringTextNode),fix:makeChildAppender(writeStringTextNode),sat:makeChildAppender(writeNonNegativeIntegerTextNode),hdop:makeChildAppender(writeDecimalTextNode),vdop:makeChildAppender(writeDecimalTextNode),pdop:makeChildAppender(writeDecimalTextNode),ageofdgpsdata:makeChildAppender(writeDecimalTextNode),dgpsid:makeChildAppender(writeNonNegativeIntegerTextNode)}),GEOMETRY_TYPE_TO_NODENAME={Point:"wpt",LineString:"rte",MultiLineString:"trk"};function GPX_NODE_FACTORY(_t,e,n){const ei=_t.getGeometry();if(ei){const ti=GEOMETRY_TYPE_TO_NODENAME[ei.getType()];if(ti){const ii=e[e.length-1].node;return createElementNS(ii.namespaceURI,ti)}}}function appendCoordinate(_t,e,n,ei){return _t.push(parseFloat(n.getAttribute("lon")),parseFloat(n.getAttribute("lat"))),"ele"in ei?(_t.push(ei.ele),delete ei.ele,e.hasZ=!0):_t.push(0),"time"in ei?(_t.push(ei.time),delete ei.time,e.hasM=!0):_t.push(0),_t}function applyLayoutOptions(_t,e,n){let ei="XY",ti=2;if(_t.hasZ&&_t.hasM?(ei="XYZM",ti=4):_t.hasZ?(ei="XYZ",ti=3):_t.hasM&&(ei="XYM",ti=3),ti!==4){for(let ii=0,ri=e.length/4;ii<ri;ii++)e[ii*ti]=e[ii*4],e[ii*ti+1]=e[ii*4+1],_t.hasZ&&(e[ii*ti+2]=e[ii*4+2]),_t.hasM&&(e[ii*ti+2]=e[ii*4+3]);if(e.length=e.length/4*ti,n)for(let ii=0,ri=n.length;ii<ri;ii++)n[ii]=n[ii]/4*ti}return ei}function readAuthor(_t,e){const n=pushParseAndPop({},AUTHOR_PARSERS,_t,e);if(n)return n}function readCopyright(_t,e){const n=pushParseAndPop({},COPYRIGHT_PARSERS,_t,e);if(n){const ei=_t.getAttribute("author");return ei!==null&&(n.author=ei),n}}function parseBounds(_t,e){const n=e[e.length-1],ei=_t.getAttribute("minlat"),ti=_t.getAttribute("minlon"),ii=_t.getAttribute("maxlat"),ri=_t.getAttribute("maxlon");ti!==null&&ei!==null&&ri!==null&&ii!==null&&(n.bounds=[[parseFloat(ti),parseFloat(ei)],[parseFloat(ri),parseFloat(ii)]])}function parseEmail(_t,e){const n=e[e.length-1],ei=_t.getAttribute("id"),ti=_t.getAttribute("domain");ei!==null&&ti!==null&&(n.email=`${ei}@${ti}`)}function parseLink(_t,e){const n=e[e.length-1],ei=_t.getAttribute("href");ei!==null&&(n.link=ei),parseNode(LINK_PARSERS,_t,e)}function parseExtensions(_t,e){const n=e[e.length-1];n.extensionsNode_=_t}function parseRtePt(_t,e){const n=pushParseAndPop({},RTEPT_PARSERS,_t,e);if(n){const ei=e[e.length-1],ti=ei.flatCoordinates,ii=ei.layoutOptions;appendCoordinate(ti,ii,_t,n)}}function parseTrkPt(_t,e){const n=pushParseAndPop({},TRKPT_PARSERS,_t,e);if(n){const ei=e[e.length-1],ti=ei.flatCoordinates,ii=ei.layoutOptions;appendCoordinate(ti,ii,_t,n)}}function parseTrkSeg(_t,e){const n=e[e.length-1];parseNode(TRKSEG_PARSERS,_t,e);const ei=n.flatCoordinates;n.ends.push(ei.length)}function readRte(_t,e){const n=e[0],ei=pushParseAndPop({flatCoordinates:[],layoutOptions:{}},RTE_PARSERS,_t,e);if(!ei)return;const ti=ei.flatCoordinates;delete ei.flatCoordinates;const ii=ei.layoutOptions;delete ei.layoutOptions;const ri=applyLayoutOptions(ii,ti),ni=new LineString(ti,ri);transformGeometryWithOptions(ni,!1,n);const si=new Feature(ni);return si.setProperties(ei,!0),si}function readTrk(_t,e){const n=e[0],ei=pushParseAndPop({flatCoordinates:[],ends:[],layoutOptions:{}},TRK_PARSERS,_t,e);if(!ei)return;const ti=ei.flatCoordinates;delete ei.flatCoordinates;const ii=ei.ends;delete ei.ends;const ri=ei.layoutOptions;delete ei.layoutOptions;const ni=applyLayoutOptions(ri,ti,ii),si=new MultiLineString(ti,ni,ii);transformGeometryWithOptions(si,!1,n);const ai=new Feature(si);return ai.setProperties(ei,!0),ai}function readWpt(_t,e){const n=e[0],ei=pushParseAndPop({},WPT_PARSERS,_t,e);if(!ei)return;const ti={},ii=appendCoordinate([],ti,_t,ei),ri=applyLayoutOptions(ti,ii),ni=new Point$1(ii,ri);transformGeometryWithOptions(ni,!1,n);const si=new Feature(ni);return si.setProperties(ei,!0),si}function writeLink(_t,e,n){_t.setAttribute("href",e);const ti=n[n.length-1].properties,ii=[ti.linkText,ti.linkType];pushSerializeAndPop({node:_t},LINK_SERIALIZERS,OBJECT_PROPERTY_NODE_FACTORY,ii,n,LINK_SEQUENCE)}function writeWptType(_t,e,n){const ei=n[n.length-1],ii=ei.node.namespaceURI,ri=ei.properties;switch(_t.setAttributeNS(null,"lat",String(e[1])),_t.setAttributeNS(null,"lon",String(e[0])),ei.geometryLayout){case"XYZM":e[3]!==0&&(ri.time=e[3]);case"XYZ":e[2]!==0&&(ri.ele=e[2]);break;case"XYM":e[2]!==0&&(ri.time=e[2]);break}const si=_t.nodeName=="rtept"?RTEPT_TYPE_SEQUENCE[ii]:WPT_TYPE_SEQUENCE[ii],ai=makeSequence(ri,si);pushSerializeAndPop({node:_t,properties:ri},WPT_TYPE_SERIALIZERS,OBJECT_PROPERTY_NODE_FACTORY,ai,n,si)}function writeRte(_t,e,n){const ei=n[0],ti=e.getProperties(),ii={node:_t};ii.properties=ti;const ri=e.getGeometry();if(ri.getType()=="LineString"){const oi=transformGeometryWithOptions(ri,!0,ei);ii.geometryLayout=oi.getLayout(),ti.rtept=oi.getCoordinates()}const ni=n[n.length-1].node,si=RTE_SEQUENCE[ni.namespaceURI],ai=makeSequence(ti,si);pushSerializeAndPop(ii,RTE_SERIALIZERS,OBJECT_PROPERTY_NODE_FACTORY,ai,n,si)}function writeTrk(_t,e,n){const ei=n[0],ti=e.getProperties(),ii={node:_t};ii.properties=ti;const ri=e.getGeometry();if(ri.getType()=="MultiLineString"){const oi=transformGeometryWithOptions(ri,!0,ei);ti.trkseg=oi.getLineStrings()}const ni=n[n.length-1].node,si=TRK_SEQUENCE[ni.namespaceURI],ai=makeSequence(ti,si);pushSerializeAndPop(ii,TRK_SERIALIZERS,OBJECT_PROPERTY_NODE_FACTORY,ai,n,si)}function writeTrkSeg(_t,e,n){const ei={node:_t};ei.geometryLayout=e.getLayout(),ei.properties={},pushSerializeAndPop(ei,TRKSEG_SERIALIZERS,TRKSEG_NODE_FACTORY,e.getCoordinates(),n)}function writeWpt(_t,e,n){const ei=n[0],ti=n[n.length-1];ti.properties=e.getProperties();const ii=e.getGeometry();if(ii.getType()=="Point"){const ri=transformGeometryWithOptions(ii,!0,ei);ti.geometryLayout=ri.getLayout(),writeWptType(_t,ri.getCoordinates(),n)}}class GPX extends GPX$1{constructor(e){if(super(e),!(this instanceof GPX))throw new TypeError("ERROR CLASS_CONSTRUCTOR");if(this.options=e||{},this.options.readExtensions&&typeof this.options.readExtensions=="function"){var n=this.options.readExtensions;this.options.readExtensions=function(ei,ti){this.readExtensions(ei,ti),n.call(this,ei,ti)}}else this.options.readExtensions=this.readExtensions;return(this.options.defaultStyle===null||typeof this.options.defaultStyle>"u")&&(this.options.defaultStyle={}),this.source=null,this}readFeatures(e,n){var ei=super.readFeatures(e,n);typeof e=="string"?this.source=Parser$1.parse(e):e!==null&&(this.source=e);var ti=this;return ei.forEach(function(ii,ri,ni){ii.setId(ri+1);var si=ii.getProperties().desc;si&&ii.setProperties({description:si});var ai=ii.getStyleFunction();if(!ai){var oi=Styling.defineStyleFunctionByDefault(ti.options.defaultStyle);oi&&ii.setStyle(oi)}}),ei}writeFeatures(e,n){if(e.forEach(function(si,ai,oi){var li=si.getProperties().description;li&&si.setProperties({desc:li}),Styling.definePropertiesFromStyle(si);var ci=si.getGeometry().getType();if(ci==="Polygon"){var ui=si.clone();ui.set("type",ci),ui.setGeometry(new LineString(si.getGeometry().getCoordinates())),e.push(ui),oi.splice(ai,1)}else if(ci==="MultiPolygon"){var di=si.clone();di.set("type",ci),di.setGeometry(new MultiLineString(si.getGeometry().getCoordinates())),e.push(di),oi.splice(ai,1)}}),this.options.orderBy!==void 0){var ei=this.options.orderBy;if(ei){var ti=function(si,ai){var oi=si.get(ei)||0,li=ai.get(ei)||0;return oi.toString().localeCompare(li.toString(),void 0,{numeric:!0})};e.sort(ti)}}var ii=super.writeFeaturesNode(e,n);if(ii===null)return null;this.options.hasOwnProperty("extensions")&&this.writeRootExtensions_(ii,this.options.extensions),this.processExtensions_(ii,e,{extensions:this.writeExtensions_});var ri=Parser$1.toString(ii);if(!ri)return null;var ni=Parser$1.format(ri);return ni===""?null:ni}readExtensions(e,n){var ei=n;if(!n){var ti=e.getProperties();for(const si in ti)if(Object.hasOwnProperty.call(ti,si)){const ai=ti[si];if(ai instanceof Node){ei=ai;break}}}if(!ei){console.warn("node not found !");return}for(var ii=0;ii<ei.childNodes.length;ii++){var ri=ei.childNodes[ii];ri.nodeType===1&&e.set(ri.nodeName,ri.textContent)}Styling.APPLY_CONVERT_GEOM_GPX=!0;var ni=Styling.defineStyleFromProperties(e);ni&&e.setStyle(ni)}readRootExtensions(e){for(var n={},ei=this.source.childNodes[0],ti=ei.childNodes,ii=0;ii<ti.length;ii++){var ri=ti[ii];if(ri.nodeName==="metadata")for(var ni=ri.childNodes,si=0;si<ni.length;si++){var ai=ni[si];if(ai.nodeName==="extensions")for(var oi=ai.childNodes,li=0;li<oi.length;li++){var ci=oi[li];if(ci.nodeName==="data"){var ui=ci.attributes[0];if(ui&&ui.nodeName==="name"&&ui.nodeValue===e){n=JSON.parse(ci.textContent);break}}}}}return n}writeRootExtensions_(e,n,ei){var ti=document.createElement("metadata"),ii=document.createElement("extensions");function ri(oi,li){for(const gi in li)if(Object.hasOwnProperty.call(li,gi)){var ci=li[gi]||"",ui=document.createElement(gi);if(typeof ci=="string"||typeof ci=="number")ui.innerHTML=ci,oi.appendChild(ui);else if(ci instanceof Array){ui.setAttribute("type","array"),ui.setAttribute("index",ci.length);for(let vi=0;vi<ci.length;vi++){var di=ci[vi]||"",fi=document.createElement("value");if(typeof di=="string"||typeof di=="number")fi.innerHTML=di,ui.appendChild(fi);else if(di instanceof Array){fi.setAttribute("type","array"),fi.setAttribute("index",di.length);for(let yi=0;yi<di.length;yi++){var hi=di[yi]||"",pi=document.createElement("value");(typeof hi=="string"||typeof hi=="number")&&(pi.innerHTML=hi,fi.appendChild(pi))}ui.appendChild(fi)}else di instanceof Object&&ui.appendChild(ri(fi,di))}oi.appendChild(ui)}else ci instanceof Object&&oi.appendChild(ri(ui,ci))}return oi}if(ei)ri(ii,n);else for(const oi in n)if(Object.hasOwnProperty.call(n,oi)){const li=n[oi];var ni=document.createElement("data");ni.setAttribute("name",oi);var si=document.createTextNode(JSON.stringify(li));ni.appendChild(si),ii.appendChild(ni)}ti.appendChild(ii);var ai=e.firstChild;e.insertBefore(ti,ai)}writeExtensions_(e,n){var ei=document.createElementNS(n.parentNode.namespaceURI,"extensions");Styling.getListTags().forEach(ti=>{if(e.get(ti)){var ii=document.createElementNS(n.parentNode.namespaceURI,ti);ii.innerHTML=e.get(ti),ei.appendChild(ii)}}),n.appendChild(ei)}processExtensions_(e,n,ei){for(var ti=-1,ii=e.childNodes,ri=0;ri<ii.length;ri++){var ni=ii[ri];switch(ni.nodeName){case"wpt":case"rte":case"trk":ti++;var si=n[ti],ai=si.getStyle();if(ai){var oi=ei.extensions;oi&&typeof oi=="function"&&oi(si,ni)}break;case"metadata":break;default:console.warn("nodename unknown :",ni.nodeName);break}}}}window.ol&&window.ol.format&&(window.ol.format.GPXExtended=GPX);class JSONFeature extends FeatureFormat{constructor(){super()}getType(){return"json"}readFeature(e,n){return this.readFeatureFromObject(getObject(e),this.getReadOptions(e,n))}readFeatures(e,n){return this.readFeaturesFromObject(getObject(e),this.getReadOptions(e,n))}readFeatureFromObject(e,n){return abstract()}readFeaturesFromObject(e,n){return abstract()}readGeometry(e,n){return this.readGeometryFromObject(getObject(e),this.getReadOptions(e,n))}readGeometryFromObject(e,n){return abstract()}readProjection(e){return this.readProjectionFromObject(getObject(e))}readProjectionFromObject(e){return abstract()}writeFeature(e,n){return JSON.stringify(this.writeFeatureObject(e,n))}writeFeatureObject(e,n){return abstract()}writeFeatures(e,n){return JSON.stringify(this.writeFeaturesObject(e,n))}writeFeaturesObject(e,n){return abstract()}writeGeometry(e,n){return JSON.stringify(this.writeGeometryObject(e,n))}writeGeometryObject(e,n){return abstract()}}function getObject(_t){if(typeof _t=="string"){const e=JSON.parse(_t);return e||null}return _t!==null?_t:null}let GeoJSON$1=class extends JSONFeature{constructor(e){e=e||{},super(),this.dataProjection=get$3(e.dataProjection?e.dataProjection:"EPSG:4326"),e.featureProjection&&(this.defaultFeatureProjection=get$3(e.featureProjection)),e.featureClass&&(this.featureClass=e.featureClass),this.geometryName_=e.geometryName,this.extractGeometryName_=e.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(e,n){let ei=null;e.type==="Feature"?ei=e:ei={type:"Feature",geometry:e,properties:null};const ti=readGeometryInternal(ei.geometry);if(this.featureClass===RenderFeature)return createRenderFeature({geometry:ti,id:ei.id,properties:ei.properties},n);const ii=new Feature;return this.geometryName_?ii.setGeometryName(this.geometryName_):this.extractGeometryName_&&ei.geometry_name&&ii.setGeometryName(ei.geometry_name),ii.setGeometry(createGeometry(ti,n)),"id"in ei&&ii.setId(ei.id),ei.properties&&ii.setProperties(ei.properties,!0),ii}readFeaturesFromObject(e,n){const ei=e;let ti=null;if(ei.type==="FeatureCollection"){const ii=e;ti=[];const ri=ii.features;for(let ni=0,si=ri.length;ni<si;++ni){const ai=this.readFeatureFromObject(ri[ni],n);ai&&ti.push(ai)}}else ti=[this.readFeatureFromObject(e,n)];return ti.flat()}readGeometryFromObject(e,n){return readGeometry(e,n)}readProjectionFromObject(e){const n=e.crs;let ei;if(n)if(n.type=="name")ei=get$3(n.properties.name);else if(n.type==="EPSG")ei=get$3("EPSG:"+n.properties.code);else throw new Error("Unknown SRS type");else ei=this.dataProjection;return ei}writeFeatureObject(e,n){n=this.adaptOptions(n);const ei={type:"Feature",geometry:null,properties:null},ti=e.getId();if(ti!==void 0&&(ei.id=ti),!e.hasProperties())return ei;const ii=e.getProperties(),ri=e.getGeometry();return ri&&(ei.geometry=writeGeometry(ri,n),delete ii[e.getGeometryName()]),isEmpty(ii)||(ei.properties=ii),ei}writeFeaturesObject(e,n){n=this.adaptOptions(n);const ei=[];for(let ti=0,ii=e.length;ti<ii;++ti)ei.push(this.writeFeatureObject(e[ti],n));return{type:"FeatureCollection",features:ei}}writeGeometryObject(e,n){return writeGeometry(e,this.adaptOptions(n))}};function readGeometryInternal(_t,e){if(!_t)return null;let n;switch(_t.type){case"Point":{n=readPointGeometry(_t);break}case"LineString":{n=readLineStringGeometry(_t);break}case"Polygon":{n=readPolygonGeometry(_t);break}case"MultiPoint":{n=readMultiPointGeometry(_t);break}case"MultiLineString":{n=readMultiLineStringGeometry(_t);break}case"MultiPolygon":{n=readMultiPolygonGeometry(_t);break}case"GeometryCollection":{n=readGeometryCollectionGeometry(_t);break}default:throw new Error("Unsupported GeoJSON type: "+_t.type)}return n}function readGeometry(_t,e){const n=readGeometryInternal(_t);return createGeometry(n,e)}function readGeometryCollectionGeometry(_t,e){return _t.geometries.map(function(ei){return readGeometryInternal(ei)})}function readPointGeometry(_t){const e=_t.coordinates;return{type:"Point",flatCoordinates:e,layout:getLayoutForStride(e.length)}}function readLineStringGeometry(_t){var ei;const e=_t.coordinates,n=e.flat();return{type:"LineString",flatCoordinates:n,ends:[n.length],layout:getLayoutForStride(((ei=e[0])==null?void 0:ei.length)||2)}}function readMultiLineStringGeometry(_t){var ii,ri;const e=_t.coordinates,n=((ri=(ii=e[0])==null?void 0:ii[0])==null?void 0:ri.length)||2,ei=[],ti=deflateCoordinatesArray(ei,0,e,n);return{type:"MultiLineString",flatCoordinates:ei,ends:ti,layout:getLayoutForStride(n)}}function readMultiPointGeometry(_t){var n;const e=_t.coordinates;return{type:"MultiPoint",flatCoordinates:e.flat(),layout:getLayoutForStride(((n=e[0])==null?void 0:n.length)||2)}}function readMultiPolygonGeometry(_t){var ii,ri;const e=_t.coordinates,n=[],ei=((ri=(ii=e[0])==null?void 0:ii[0])==null?void 0:ri[0].length)||2,ti=deflateMultiCoordinatesArray(n,0,e,ei);return{type:"MultiPolygon",flatCoordinates:n,ends:ti,layout:getLayoutForStride(ei)}}function readPolygonGeometry(_t){var ii,ri;const e=_t.coordinates,n=[],ei=(ri=(ii=e[0])==null?void 0:ii[0])==null?void 0:ri.length,ti=deflateCoordinatesArray(n,0,e,ei);return{type:"Polygon",flatCoordinates:n,ends:ti,layout:getLayoutForStride(ei)}}function writeGeometry(_t,e){_t=transformGeometryWithOptions(_t,!0,e);const n=_t.getType();let ei;switch(n){case"Point":{ei=writePointGeometry(_t);break}case"LineString":{ei=writeLineStringGeometry(_t);break}case"Polygon":{ei=writePolygonGeometry(_t,e);break}case"MultiPoint":{ei=writeMultiPointGeometry(_t);break}case"MultiLineString":{ei=writeMultiLineStringGeometry(_t);break}case"MultiPolygon":{ei=writeMultiPolygonGeometry(_t,e);break}case"GeometryCollection":{ei=writeGeometryCollectionGeometry(_t,e);break}case"Circle":{ei={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+n)}return ei}function writeGeometryCollectionGeometry(_t,e){return e=Object.assign({},e),delete e.featureProjection,{type:"GeometryCollection",geometries:_t.getGeometriesArray().map(function(ei){return writeGeometry(ei,e)})}}function writeLineStringGeometry(_t,e){return{type:"LineString",coordinates:_t.getCoordinates()}}function writeMultiLineStringGeometry(_t,e){return{type:"MultiLineString",coordinates:_t.getCoordinates()}}function writeMultiPointGeometry(_t,e){return{type:"MultiPoint",coordinates:_t.getCoordinates()}}function writeMultiPolygonGeometry(_t,e){let n;return e&&(n=e.rightHanded),{type:"MultiPolygon",coordinates:_t.getCoordinates(n)}}function writePointGeometry(_t,e){return{type:"Point",coordinates:_t.getCoordinates()}}function writePolygonGeometry(_t,e){let n;return e&&(n=e.rightHanded),{type:"Polygon",coordinates:_t.getCoordinates(n)}}class GeoJSON extends GeoJSON$1{constructor(e){if(super(e),!(this instanceof GeoJSON))throw new TypeError("ERROR CLASS_CONSTRUCTOR");return this.options=e||{},(this.options.defaultStyle===null||typeof this.options.defaultStyle>"u")&&(this.options.defaultStyle={}),this.source=null,this}readFeatures(e,n){var ei=super.readFeatures(e,n);return typeof e=="string"?this.source=JSON.parse(e):e!==null&&(this.source=e),ei.forEach(ti=>{var ii=ti.getStyleFunction();if(ii){var ri=ii.call(this,ti,0);ri&&ri.length!==0&&ti.setStyle(ri[0])}else{var ni=Styling.defineStyleFromProperties(ti);if(ni)ti.setStyle(ni);else{var si=Styling.defineStyleFunctionByDefault(this.options.defaultStyle);si&&(ti.setStyle(si),Styling.definePropertiesFromStyle(ti))}}}),ei}writeFeatures(e,n){e.forEach(function(ti){Styling.definePropertiesFromStyle(ti)});var ei=this.writeFeaturesObject(e,n);return this.options.hasOwnProperty("extensions")&&Object.assign(ei,this.options.extensions),JSON.stringify(ei)}readRootExtensions(e){return this.source[e]}}window.ol&&window.ol.format&&(window.ol.format.GeoJSONExtended=GeoJSON);class WMTS extends WMTS$1{constructor(e){super(e)}getFeatureInfoUrl(e,n,ei,ti){var ii=this.options&&this.options.tilePixelRatio?this.options.tilePixelRatio:1,ri=this.tileGrid,ni=this.tileGrid.getTileCoordForCoordAndResolution(e,n),si=function(vi,yi,_i){var Ai=[0,0,0],Ei=createEmpty(),Si=vi[1],wi=vi[2],Oi=yi.getTileCoordExtent(vi),Ii=_i.getExtent();if(Ii!=null&&_i.isGlobal()){var Li=Math.ceil(getWidth(Ii)/getWidth(Oi));Si=Si%Li,Ai[0]=vi[0],Ai[1]=Si,Ai[2]=vi[2],Oi=yi.getTileCoordExtent(Ai,Ei)}return intersects$1(Oi,Ii)?[vi[0],Si,wi]:null},ai=ri.getTileCoordExtent(ni),oi=si(ni,ri,ei);if(!(ri.getResolutions().length<=ni[0])){var li=ri.getResolution(ni[0]),ci=ri.getMatrixIds()[ni[0]],ui={SERVICE:"WMTS",VERSION:"1.0.0",REQUEST:"GetFeatureInfo",LAYER:this.getLayer(),TILECOL:oi[1],TILEROW:oi[2],TILEMATRIX:ci,TILEMATRIXSET:this.getMatrixSet(),FORMAT:this.getFormat()||"image/png",STYLE:this.getStyle()||"normal"};Helper.assign(ui,ti);var di=Math.floor((e[0]-ai[0])/(li/ii)),fi=Math.floor((ai[3]-e[1])/(li/ii)),hi=ri.getTileSize(ni[0]);di=Math.min(di,(hi[0]|hi)-1),fi=Math.max(fi,0),ui.I=di,ui.J=fi;var pi=this.urls[0],gi=Gp.Helper.normalyzeUrl(pi,ui);return gi}}}window.ol&&window.ol.source&&(window.ol.source.WMTSExtended=WMTS);var LayerUtils={getZoomLevelFromScaleDenominator:function(_t,e){var n={};switch(e){case"EPSG:2154":n={0:104579.224549894,1:52277.5323537905,2:26135.4870785954,3:13066.8913818,4:6533.2286041135,5:3266.5595244627,6:1633.2660045974,7:816.629554986,8:408.3139146768,9:204.1567415109,10:102.0783167832,11:51.0391448966,12:25.5195690743,13:12.7597836936,14:6.379891636,15:3.1899457653,16:1.5949728695,17:.7974864315,18:.3987432149,19:.1993716073,20:.0996858037,21:.0498429018};break;default:n={0:156543.033928041,1:78271.51696402048,2:39135.758482010235,3:19567.87924100512,4:9783.93962050256,5:4891.96981025128,6:2445.98490512564,7:1222.99245256282,8:611.49622628141,9:305.7481131407048,10:152.8740565703525,11:76.43702828517624,12:38.21851414258813,13:19.10925707129406,14:9.554628535647032,15:4.777314267823516,16:2.388657133911758,17:1.194328566955879,18:.5971642834779395,19:.2985821417389697,20:.1492910708694849,21:.0746455354347424};break}var ei=_t*28e-5;for(var ti in n)if(n.hasOwnProperty(ti)&&n[ti]<=ei)return ti=parseInt(ti,10),ti;return 0},getAttributions:function(_t){var e=_t.zoom,n=[];if(_t.originators!=null&&_t.visibility)for(var ei,ti=0,ii=_t.originators.length;ti<ii;ti++){ei=!0;for(var ri=_t.originators[ti],ni=_t.originators[ti].constraints||[],si=0,ai=ni.length;si<ai;si++){var oi=ni[si];ei=!0;var li=this.getZoomLevelFromScaleDenominator(oi.maxScaleDenominator,_t.crs),ci=this.getZoomLevelFromScaleDenominator(oi.minScaleDenominator,_t.crs)||21;li&&li>e&&(ei=!1),ei&&ci&&ci<e&&(ei=!1);var ui=oi.bbox;if(ei&&ui){ei=!1;var di=_t.extent;if(di){var fi=[ui.top,ui.left,ui.bottom,ui.right];if(this.intersects(di,fi)){ei=!0;break}}}}if(ei){var hi=ri.logo,pi=ri.url,gi=ri.name?ri.name:"",vi=ri.attribution,yi=document.createElement("div");yi.className="gp-control-attribution";var _i=null;_i=document.createElement("a"),_i.className="gp-control-attribution-link",_i.target="_blank",yi.appendChild(_i),pi&&(_i.href=pi);var Ai=!!hi,Ei=null;Ai?(Ei=document.createElement("img"),_i?(Ei.className="gp-control-attribution-image",_i.appendChild(Ei)):(Ei.className="",yi.appendChild(Ei)),Ei.src=hi,Ei.title=vi||gi,Ei.style.height="30px",Ei.style.width="30px"):gi?_i.textContent=gi:vi?_i.textContent=vi:pi?_i.textContent=pi:_i.textContent="",n.push(yi.innerHTML+" ")}}return n},intersects:function(_t,e){var n=_t[1]<=e[3]&&e[1]<=_t[3],ei=_t[2]<=e[0]&&e[2]<=_t[0];return n&&ei}},Config={configuration:{},isConfigLoaded:function(){if(this.configuration&&Object.keys(this.configuration).length!==0)return!0;var _t=typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:{};return _t.Gp&&_t.Gp.Config&&_t.Gp.Config.layers&&Object.keys(_t.Gp.Config.layers).length!==0?(this.configuration=_t.Gp.Config,!0):!1}};LoggerByDefault.getLogger("sourcewmts");class SourceWMTS extends WMTS{constructor(e){if(!e.layer)throw new Error("ERROR PARAM_MISSING : layer");if(typeof e.layer!="string")throw new Error("ERROR WRONG TYPE : layer");typeof e.ssl>"u"&&(e.ssl=!0);var n=e.configuration,ei=n?n.params:null,ti=e.apiKey;if(!n){if(!Config.isConfigLoaded())throw new Error("ERROR : contract key configuration has to be loaded to load Geoportal layers.");var ii=Config.configuration.getLayerId(e.layer,"WMTS");if(!ii)throw new Error(`ERROR : WMTS Layer ID ${e.layer} cannot be found in Geoportal Configuration. Make sure that this resource is included in your contract key.`);if(n=Config.configuration.getLayerConf(ii),!n)throw new Error("ERROR : WMTS Layer configuration cannot be found in Geoportal.");ti=Config.configuration.getLayerKey(ii)[0],ei=Config.configuration.getLayerParams(e.layer,"WMTS")}var ri=e.ssl===!1?"http://":"https://",ni={"gp-ol-ext":Pkg$1.olExtVersion||Pkg$1.version};if(ei.url.includes("/private/")){var si=e.apiKey||ti;if(!si)throw new Error("ERROR : WMS Layer apiKey cannot be found in Geoportal Configuration.");ni.apikey=si}var ai={url:Gp.Helper.normalyzeUrl(ei.url.replace(/(http|https):\/\//,ri),ni,!1),version:ei.version,style:ei.styles,format:ei.format,projection:ei.projection,maxZoom:LayerUtils.getZoomLevelFromScaleDenominator(ei.minScale),layer:e.layer,matrixSet:ei.TMSLink,tileGrid:new WMTSTileGrid({resolutions:ei.nativeResolutions,matrixIds:ei.matrixIds,origin:[Object.values(ei.tileMatrices)[0].topLeftCorner.x,Object.values(ei.tileMatrices)[0].topLeftCorner.y]}),crossOrigin:"anonymous"};return Helper.mergeParams(ai,e.olParams),e.olParams&&!ei.originators&&(ei.originators=e.olParams.attributions),super(ai),this._originators=ei.originators,this._legends=e.legends||n.legends,this._metadata=e.metadata||n.metadata||n.metadata_urls,this._description=e.description||n.description,this._title=e.title||n.title,this._quicklookUrl=e.quicklookUrl||n.quicklookUrl,this._thumbnail=e.thumbnail||n.thumbnail,this._producer=e.producer||n.producer,this.name=e.layer,this.service="WMTS",this}}window.ol&&window.ol.source&&(window.ol.source.GeoportalWMTS=SourceWMTS);LoggerByDefault.getLogger("sourcewms");class SourceWMS extends TileWMS{constructor(e){if(!e.layer)throw new Error("ERROR PARAM_MISSING : layer");if(typeof e.layer!="string")throw new Error("ERROR WRONG TYPE : layer");typeof e.ssl>"u"&&(e.ssl=!0);var n=e.configuration,ei=n?n.params:null,ti=e.apiKey;if(!n){if(!Config.isConfigLoaded())throw new Error("ERROR : contract key configuration has to be loaded to load Geoportal layers.");var ii=Config.configuration.getLayerId(e.layer,"WMS");if(!ii)throw new Error(`ERROR : WMS Layer ID ${e.layer} cannot be found in Geoportal Configuration. Make sure that this resource is included in your contract key.`);if(n=Config.configuration.getLayerConf(ii),!n)throw new Error("ERROR : WMS Layer configuration cannot be found in Geoportal.");ti=Config.configuration.getLayerKey(ii)[0],ei=Config.configuration.getLayerParams(e.layer,"WMS")}var ri=e.ssl===!1?"http://":"https://",ni={"gp-ol-ext":Pkg$1.olExtVersion||Pkg$1.version};if(ei.url.includes("/private/")){var si=e.apiKey||ti;if(!si)throw new Error("ERROR : WMS Layer apiKey cannot be found in Geoportal Configuration.");ni.apikey=si}var ai={url:Gp.Helper.normalyzeUrl(ei.url.replace(/(http|https):\/\//,ri),ni,!1),params:{SERVICE:"WMS",LAYERS:e.layer,VERSION:ei.version,STYLES:ei.styles,FORMAT:ei.format},crossOrigin:"anonymous"};return Helper.mergeParams(ai,e.olParams),e.olParams&&!ei.originators&&(ei.originators=e.olParams.attributions),super(ai),this._originators=ei.originators,this._legends=e.legends||n.legends,this._metadata=e.metadata||n.metadata||n.metadata_urls,this._title=e.title||n.title,this._description=e.description||n.description,this._quicklookUrl=e.quicklookUrl||n.quicklookUrl,this._thumbnail=e.thumbnail||n.thumbnail,this._producer=e.producer||n.producer,this.name=e.layer,this.service="WMS",this}}window.ol&&window.ol.source&&(window.ol.source.GeoportalWMS=SourceWMS);LoggerByDefault.getLogger("sourcewfs");class SourceWFS extends VectorSource{constructor(e){if(!e.layer)throw new Error("ERROR PARAM_MISSING : layer");if(typeof e.layer!="string")throw new Error("ERROR WRONG TYPE : layer");typeof e.ssl>"u"&&(e.ssl=!0);var n=e.configuration,ei=n?n.params:null,ti=e.apiKey;if(!n){if(!Config.isConfigLoaded())throw new Error("ERROR : contract key configuration has to be loaded to load Geoportal layers.");var ii=Config.configuration.getLayerId(e.layer,"WFS");if(!ii)throw new Error(`ERROR : WFS Layer ID ${e.layer} cannot be found in Geoportal Configuration. Make sure that this resource is included in your contract key.`);if(n=Config.configuration.getLayerConf(ii),!n)throw new Error("ERROR : WFS Layer configuration cannot be found in Geoportal.");ti=Config.configuration.getLayerKey(ii)[0],ei=Config.configuration.getLayerParams(e.layer,"WFS")}var ri=e.ssl===!1?"http://":"https://",ni={"gp-ol-ext":Pkg$1.olExtVersion||Pkg$1.version};if(ei.url.includes("/private/")){var si=e.apiKey||ti;if(!si)throw new Error("ERROR : WFS Layer apiKey cannot be found in Geoportal Configuration.");ni.apikey=si}var ai=(li,ci,ui,di,fi)=>{const hi=new XMLHttpRequest;hi.open("POST",ci);const pi=function(){li.removeLoadedExtent(ui),fi()};hi.onerror=pi,hi.onload=function(){if(hi.status==200){var gi=JSON.parse(hi.responseText);const vi=li.getFormat().readFeatures(gi);if(li.addFeatures(vi),di(vi),gi.links)for(let yi=0;yi<gi.links.length;yi++){const _i=gi.links[yi];_i.rel==="next"&&ai(li,_i.href,ui,di,fi)}}else pi()},hi.send()},oi={format:new GeoJSON$1,loader:function(li,ci,ui,di,fi){var hi=this;const pi=e.maxFeatures,gi=e.layer,vi=ui.getCode(),yi=Gp.Helper.normalyzeUrl(ei.url.replace(/(http|https):\/\//,ri),ni,!1)+"&SERVICE=WFS&VERSION=2.0.0&REQUEST=GetFeature&typename="+gi+"&outputFormat=application/json&srsname="+vi+"&bbox="+li.join(",")+","+vi+"&maxFeatures="+pi+"&count="+pi+"&startIndex=0";ai(hi,yi,li,di,fi)},strategy:tile(createXYZ({minZoom:e.olParams.minZoom||15,maxZoom:e.olParams.maxZoom||21,tileSize:512})),crossOrigin:"anonymous"};return Helper.mergeParams(oi,e.olParams),e.olParams&&!ei.originators&&(ei.originators=e.olParams.attributions),super(oi),this._originators=ei.originators,this._legends=e.legends||n.legends,this._metadata=e.metadata||n.metadata||n.metadata_urls,this._title=e.title||n.title,this._description=e.description||n.description,this._quicklookUrl=e.quicklookUrl||n.quicklookUrl,this._thumbnail=e.thumbnail||n.thumbnail,this._producer=e.producer||n.producer,this.name=e.layer,this.service="WFS",this}}window.ol&&window.ol.source&&(window.ol.source.GeoportalWFS=SourceWFS);function asImageLike(_t){return _t instanceof Image||_t instanceof HTMLCanvasElement||_t instanceof HTMLVideoElement||_t instanceof ImageBitmap?_t:null}const disposedError=new Error("disposed"),defaultSize=[256,256];class DataTile extends Tile{constructor(e){const n=TileState.IDLE;super(e.tileCoord,n,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null,this.controller_=e.controller||null}getSize(){if(this.size_)return this.size_;const e=asImageLike(this.data_);return e?[e.width,e.height]:defaultSize}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==TileState.IDLE&&this.state!==TileState.ERROR)return;this.state=TileState.LOADING,this.changed();const e=this;this.loader_().then(function(n){e.data_=n,e.state=TileState.LOADED,e.changed()}).catch(function(n){e.error_=n,e.state=TileState.ERROR,e.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(disposedError),this.controller_=null),super.disposeInternal()}}class LRUCache{constructor(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const e=this.pop();e instanceof Disposable&&e.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(e){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let n=this.oldest_;for(;n;)e(n.value_,n.key_,this),n=n.newer}get(e,n){const ei=this.entries_[e];return assert(ei!==void 0,"Tried to get a value for a key that does not exist in the cache"),ei===this.newest_||(ei===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(ei.newer.older=ei.older,ei.older.newer=ei.newer),ei.newer=null,ei.older=this.newest_,this.newest_.newer=ei,this.newest_=ei),ei.value_}remove(e){const n=this.entries_[e];return assert(n!==void 0,"Tried to get a value for a key that does not exist in the cache"),n===this.newest_?(this.newest_=n.older,this.newest_&&(this.newest_.newer=null)):n===this.oldest_?(this.oldest_=n.newer,this.oldest_&&(this.oldest_.older=null)):(n.newer.older=n.older,n.older.newer=n.newer),delete this.entries_[e],--this.count_,n.value_}getCount(){return this.count_}getKeys(){const e=new Array(this.count_);let n=0,ei;for(ei=this.newest_;ei;ei=ei.older)e[n++]=ei.key_;return e}getValues(){const e=new Array(this.count_);let n=0,ei;for(ei=this.newest_;ei;ei=ei.older)e[n++]=ei.value_;return e}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){var n;return(n=this.entries_[e])==null?void 0:n.value_}pop(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,n){this.get(e),this.entries_[e].value_=n}set(e,n){assert(!(e in this.entries_),"Tried to set a value for a key that is used already");const ei={key_:e,newer:null,older:this.newest_,value_:n};this.newest_?this.newest_.newer=ei:this.oldest_=ei,this.newest_=ei,this.entries_[e]=ei,++this.count_}setSize(e){this.highWaterMark=e}}function addTileToLookup(_t,e,n){if(!(n in _t))return _t[n]=new Set([e]),!0;const ei=_t[n],ti=ei.has(e);return ti||ei.add(e),!ti}function removeTileFromLookup(_t,e,n){const ei=_t[n];return ei?ei.delete(e):!1}function getRenderExtent(_t,e){const n=_t.layerStatesArray[_t.layerIndex];n.extent&&(e=getIntersection(e,fromUserExtent(n.extent,_t.viewState.projection)));const ei=n.layer.getRenderSource();if(!ei.getWrapX()){const ti=ei.getTileGridForProjection(_t.viewState.projection).getExtent();ti&&(e=getIntersection(e,ti))}return e}class CanvasTileLayerRenderer extends CanvasLayerRenderer{constructor(e,n){super(e),n=n||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=createEmpty(),this.tempTileRange_=new TileRange(0,0,0,0),this.tempTileCoord_=createOrUpdate(0,0,0);const ei=n.cacheSize!==void 0?n.cacheSize:512;this.tileCache_=new LRUCache(ei),this.sourceTileCache_=null,this.maxStaleKeys=ei*.5}getTileCache(){return this.tileCache_}getSourceTileCache(){return this.sourceTileCache_||(this.sourceTileCache_=new LRUCache(512)),this.sourceTileCache_}getOrCreateTile(e,n,ei,ti){const ii=this.tileCache_,ni=this.getLayer().getSource(),si=getCacheKey$1(ni,ni.getKey(),e,n,ei);let ai;if(ii.containsKey(si))ai=ii.get(si);else{const oi=ti.viewState.projection,li=ni.getProjection();if(ai=ni.getTile(e,n,ei,ti.pixelRatio,oi,!li||equivalent$1(li,oi)?void 0:this.getSourceTileCache()),!ai)return null;ii.set(si,ai)}return ai}getTile(e,n,ei,ti){const ii=this.getOrCreateTile(e,n,ei,ti);return ii||null}getData(e){const n=this.frameState;if(!n)return null;const ei=this.getLayer(),ti=apply(n.pixelToCoordinateTransform,e.slice()),ii=ei.getExtent();if(ii&&!containsCoordinate(ii,ti))return null;const ri=n.viewState,ni=ei.getRenderSource(),si=ni.getTileGridForProjection(ri.projection),ai=ni.getTilePixelRatio(n.pixelRatio);for(let oi=si.getZForResolution(ri.resolution);oi>=si.getMinZoom();--oi){const li=si.getTileCoordForCoordAndZ(ti,oi),ci=this.getTile(oi,li[1],li[2],n);if(!ci||ci.getState()!==TileState.LOADED)continue;const ui=si.getOrigin(oi),di=toSize(si.getTileSize(oi)),fi=si.getResolution(oi);let hi;if(ci instanceof ImageTile||ci instanceof ReprojTile)hi=ci.getImage();else if(ci instanceof DataTile){if(hi=asImageLike(ci.getData()),!hi)continue}else continue;const pi=Math.floor(ai*((ti[0]-ui[0])/fi-li[1]*di[0])),gi=Math.floor(ai*((ui[1]-ti[1])/fi-li[2]*di[1])),vi=Math.round(ai*ni.getGutterForProjection(ri.projection));return this.getImageData(hi,pi+vi,gi+vi)}return null}prepareFrame(e){var ti;this.renderedProjection?e.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=e.viewState.projection):this.renderedProjection=e.viewState.projection;const n=this.getLayer().getSource();if(!n)return!1;const ei=n.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==ei&&(this.renderedSourceRevision_=ei,this.renderedSourceKey_===n.getKey()&&(this.tileCache_.clear(),(ti=this.sourceTileCache_)==null||ti.clear())):this.renderedSourceRevision_=ei,!0}enqueueTilesForNextExtent(){return!0}enqueueTiles(e,n,ei,ti,ii){const ri=e.viewState,ni=this.getLayer(),si=ni.getRenderSource(),ai=si.getTileGridForProjection(ri.projection),oi=getUid(si);oi in e.wantedTiles||(e.wantedTiles[oi]={});const li=e.wantedTiles[oi],ci=ni.getMapInternal(),ui=Math.max(ei-ii,ai.getMinZoom(),ai.getZForResolution(Math.min(ni.getMaxResolution(),ci?ci.getView().getResolutionForZoom(Math.max(ni.getMinZoom(),0)):ai.getResolution(0)),si.zDirection)),di=ri.rotation,fi=di?getRotatedViewport(ri.center,ri.resolution,di,e.size):void 0;for(let hi=ei;hi>=ui;--hi){const pi=ai.getTileRangeForExtentAndZ(n,hi,this.tempTileRange_),gi=ai.getResolution(hi);for(let vi=pi.minX;vi<=pi.maxX;++vi)for(let yi=pi.minY;yi<=pi.maxY;++yi){if(di&&!ai.tileCoordIntersectsViewport([hi,vi,yi],fi))continue;const _i=this.getTile(hi,vi,yi,e);if(!_i||!addTileToLookup(ti,_i,hi))continue;const Ei=_i.getKey();if(li[Ei]=!0,_i.getState()===TileState.IDLE&&!e.tileQueue.isKeyQueued(Ei)){const Si=createOrUpdate(hi,vi,yi,this.tempTileCoord_);e.tileQueue.enqueue([_i,oi,ai.getTileCoordCenter(Si),gi])}}}}findStaleTile_(e,n){const ei=this.tileCache_,ti=e[0],ii=e[1],ri=e[2],ni=this.getStaleKeys();for(let si=0;si<ni.length;++si){const ai=getCacheKey$1(this.getLayer().getSource(),ni[si],ti,ii,ri);if(ei.containsKey(ai)){const oi=ei.peek(ai);if(oi.getState()===TileState.LOADED)return oi.endTransition(getUid(this)),addTileToLookup(n,oi,ti),!0}}return!1}findAltTiles_(e,n,ei,ti){const ii=e.getTileRangeForTileCoordAndZ(n,ei,this.tempTileRange_);if(!ii)return!1;let ri=!0;const ni=this.tileCache_,si=this.getLayer().getRenderSource(),ai=si.getKey();for(let oi=ii.minX;oi<=ii.maxX;++oi)for(let li=ii.minY;li<=ii.maxY;++li){const ci=getCacheKey$1(si,ai,ei,oi,li);let ui=!1;if(ni.containsKey(ci)){const di=ni.peek(ci);di.getState()===TileState.LOADED&&(addTileToLookup(ti,di,ei),ui=!0)}ui||(ri=!1)}return ri}renderFrame(e,n){this.renderComplete=!0;const ei=e.layerStatesArray[e.layerIndex],ti=e.viewState,ii=ti.projection,ri=ti.resolution,ni=ti.center,si=e.pixelRatio,ai=this.getLayer(),oi=ai.getSource(),li=oi.getTileGridForProjection(ii),ci=li.getZForResolution(ri,oi.zDirection),ui=li.getResolution(ci),di=oi.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==di&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=di):this.renderedSourceKey_=di;let fi=e.extent;const hi=oi.getTilePixelRatio(si);this.prepareContainer(e,n);const pi=this.context.canvas.width,gi=this.context.canvas.height,vi=ei.extent&&fromUserExtent(ei.extent);vi&&(fi=getIntersection(fi,fromUserExtent(ei.extent)));const yi=ui*pi/2/hi,_i=ui*gi/2/hi,Ai=[ni[0]-yi,ni[1]-_i,ni[0]+yi,ni[1]+_i],Ei={};this.renderedTiles.length=0;const Si=ai.getPreload();if(e.nextExtent&&this.enqueueTilesForNextExtent()){const Vi=li.getZForResolution(ti.nextResolution,oi.zDirection),nr=getRenderExtent(e,e.nextExtent);this.enqueueTiles(e,nr,Vi,Ei,Si)}const wi=getRenderExtent(e,fi);if(this.enqueueTiles(e,wi,ci,Ei,0),Si>0&&setTimeout(()=>{this.enqueueTiles(e,wi,ci-1,Ei,Si-1)},0),!(ci in Ei))return this.container;const Oi=getUid(this),Ii=e.time;for(const Vi of Ei[ci]){const nr=Vi.getState();if(nr===TileState.EMPTY)continue;const zi=Vi.tileCoord;if(nr===TileState.LOADED&&Vi.getAlpha(Oi,Ii)===1){Vi.endTransition(Oi);continue}if(nr!==TileState.ERROR&&(this.renderComplete=!1),this.findStaleTile_(zi,Ei)){removeTileFromLookup(Ei,Vi,ci),e.animate=!0;continue}if(this.findAltTiles_(li,zi,ci+1,Ei))continue;const ki=li.getMinZoom();for(let xi=ci-1;xi>=ki&&!this.findAltTiles_(li,zi,xi,Ei);--xi);}const Li=ui/ri*si/hi,Di=this.getRenderContext(e);compose(this.tempTransform,pi/2,gi/2,Li,Li,0,-pi/2,-gi/2),ei.extent&&this.clipUnrotated(Di,e,vi),oi.getInterpolate()||(Di.imageSmoothingEnabled=!1),this.preRender(Di,e);const Ni=Object.keys(Ei).map(Number);Ni.sort(ascending);let $i;const Ki=[],er=[];for(let Vi=Ni.length-1;Vi>=0;--Vi){const nr=Ni[Vi],zi=oi.getTilePixelSize(nr,si,ii),Ti=li.getResolution(nr)/ui,ki=zi[0]*Ti*Li,xi=zi[1]*Ti*Li,Mi=li.getTileCoordForCoordAndZ(getTopLeft(Ai),nr),Ui=li.getTileCoordExtent(Mi),Yi=apply(this.tempTransform,[hi*(Ui[0]-Ai[0])/ui,hi*(Ai[3]-Ui[3])/ui]),sr=hi*oi.getGutterForProjection(ii);for(const cr of Ei[nr]){if(cr.getState()!==TileState.LOADED)continue;const ir=cr.tileCoord,Zi=Mi[1]-ir[1],rr=Math.round(Yi[0]-(Zi-1)*ki),ar=Mi[2]-ir[2],pr=Math.round(Yi[1]-(ar-1)*xi),Gi=Math.round(Yi[0]-Zi*ki),gr=Math.round(Yi[1]-ar*xi),Br=rr-Gi,Nr=pr-gr,mr=Ni.length===1;let Mr=!1;$i=[Gi,gr,Gi+Br,gr,Gi+Br,gr+Nr,Gi,gr+Nr];for(let Er=0,Fr=Ki.length;Er<Fr;++Er)if(!mr&&nr<er[Er]){const or=Ki[Er];intersects$1([Gi,gr,Gi+Br,gr+Nr],[or[0],or[3],or[4],or[7]])&&(Mr||(Di.save(),Mr=!0),Di.beginPath(),Di.moveTo($i[0],$i[1]),Di.lineTo($i[2],$i[3]),Di.lineTo($i[4],$i[5]),Di.lineTo($i[6],$i[7]),Di.moveTo(or[6],or[7]),Di.lineTo(or[4],or[5]),Di.lineTo(or[2],or[3]),Di.lineTo(or[0],or[1]),Di.clip())}Ki.push($i),er.push(nr),this.drawTile(cr,e,Gi,gr,Br,Nr,sr,mr),Mr&&Di.restore(),this.renderedTiles.unshift(cr),this.updateUsedTiles(e.usedTiles,oi,cr)}}if(this.renderedResolution=ui,this.extentChanged=!this.renderedExtent_||!equals$1(this.renderedExtent_,Ai),this.renderedExtent_=Ai,this.renderedPixelRatio=si,this.postRender(this.context,e),ei.extent&&Di.restore(),Di.imageSmoothingEnabled=!0,this.renderComplete){const Vi=(nr,zi)=>{var xi;const Wi=getUid(oi),Ti=zi.wantedTiles[Wi],ki=Ti?Object.keys(Ti).length:0;this.updateCacheSize(ki),this.tileCache_.expireCache(),(xi=this.sourceTileCache_)==null||xi.expireCache()};e.postRenderFunctions.push(Vi)}return this.container}updateCacheSize(e){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,e*2)}drawTile(e,n,ei,ti,ii,ri,ni,si){let ai;if(e instanceof DataTile){if(ai=asImageLike(e.getData()),!ai)throw new Error("Rendering array data is not yet supported")}else ai=this.getTileImage(e);if(!ai)return;const oi=this.getRenderContext(n),li=getUid(this),ci=n.layerStatesArray[n.layerIndex],ui=ci.opacity*(si?e.getAlpha(li,n.time):1),di=ui!==oi.globalAlpha;di&&(oi.save(),oi.globalAlpha=ui),oi.drawImage(ai,ni,ni,ai.width-2*ni,ai.height-2*ni,ei,ti,ii,ri),di&&oi.restore(),ui!==ci.opacity?n.animate=!0:si&&e.endTransition(li)}getImage(){const e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}updateUsedTiles(e,n,ei){const ti=getUid(n);ti in e||(e[ti]={}),e[ti][ei.getKey()]=!0}}const TileProperty={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class BaseTileLayer extends Layer$1{constructor(e){e=e||{};const n=Object.assign({},e),ei=e.cacheSize;delete e.cacheSize,delete n.preload,delete n.useInterimTilesOnError,super(n),this.on,this.once,this.un,this.cacheSize_=ei,this.setPreload(e.preload!==void 0?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(TileProperty.PRELOAD)}setPreload(e){this.set(TileProperty.PRELOAD,e)}getUseInterimTilesOnError(){return this.get(TileProperty.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(TileProperty.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}}class TileLayer extends BaseTileLayer{constructor(e){super(e)}createRenderer(){return new CanvasTileLayerRenderer(this,{cacheSize:this.getCacheSize()})}}class LayerWMTS extends TileLayer{constructor(e){if(!e.layer)throw new Error("ERROR PARAM_MISSING : layer");if(typeof e.layer!="string")throw new Error("ERROR WRONG TYPE : layer");typeof e.ssl>"u"&&(e.ssl=!0),typeof e.noConstraint>"u"&&(e.noConstraint=!1);var n=e.configuration;if(!n){if(!Config.isConfigLoaded())throw new Error("ERROR : contract key configuration has to be loaded to load Geoportal layers.");var ei=Config.configuration.getLayerId(e.layer,"WMTS");if(n=Config.configuration.getLayerConf(ei),!n)throw new Error("ERROR : Layer ID not found into the catalogue !?")}var ti;e.olParams&&e.olParams.sourceParams&&(ti=e.olParams.sourceParams);var ii=new SourceWMTS({layer:e.layer,configuration:e.configuration,ssl:e.ssl,apiKey:e.apiKey,olParams:ti}),ri={source:ii};if(ii.getLayer()!==void 0&&n.globalConstraint){var ni=[n.globalConstraint.bbox.left,n.globalConstraint.bbox.bottom,n.globalConstraint.bbox.right,n.globalConstraint.bbox.top];ri.extent=transformExtent(ni,"EPSG:4326",n.globalConstraint.projection||"EPSG:3857");var si;typeof n.globalConstraint.projection=="string"?si=get$3(n.globalConstraint.projection):si=get$3("EPSG:3857"),e.noConstraint!==!0&&n.globalConstraint.noConstraint!==!0&&si&&si.getUnits()&&(si.getUnits()==="m"?(ri.minResolution=(n.globalConstraint.minScaleDenominator-1)*28e-5,ri.maxResolution=(n.globalConstraint.maxScaleDenominator+1)*28e-5):si.getUnits()==="degrees"&&(ri.minResolution=(n.globalConstraint.minScaleDenominator-1)*28e-5*180/(Math.PI*6378137),ri.maxResolution=(n.globalConstraint.maxScaleDenominator+1)*28e-5*180/(Math.PI*6378137)))}return Helper.mergeParams(ri,e.olParams),super(ri),this.name=e.layer,this.service="WMTS",this.config=n,this}getConfiguration(){return this.config}getLegends(){return this.getSource()._legends}getMetadata(){return this.getSource()._metadata}getDescription(){return this.getSource()._description}getTitle(){return this.getSource()._title}getQuicklookUrl(){return this.getSource()._quicklookUrl}getOriginators(){return this.getSource()._originators}getThumbnailUrl(){return this.getSource()._thumbnail}getProducer(){return this.getSource()._producer}}window.ol&&window.ol.layer&&(window.ol.layer.GeoportalWMTS=LayerWMTS);class LayerWMS extends TileLayer{constructor(e){if(!e.layer)throw new Error("ERROR PARAM_MISSING : layer");if(typeof e.layer!="string")throw new Error("ERROR WRONG TYPE : layer");typeof e.ssl>"u"&&(e.ssl=!0),typeof e.noConstraint>"u"&&(e.noConstraint=!1);var n=e.configuration;if(!n){if(!Config.isConfigLoaded())throw new Error("ERROR : contract key configuration has to be loaded to load Geoportal layers.");var ei=Config.configuration.getLayerId(e.layer,"WMS");if(n=Config.configuration.getLayerConf(ei),!n)throw new Error("ERROR : Layer ID not found into the catalogue !?")}var ti;e.olParams&&e.olParams.sourceParams&&(ti=e.olParams.sourceParams);var ii=new SourceWMS({layer:e.layer,configuration:e.configuration,ssl:e.ssl,apiKey:e.apiKey,olParams:ti}),ri={source:ii};if(ii.getParams().LAYERS!==void 0&&ti&&ti.projection){var ni=[n.globalConstraint.bbox.left,n.globalConstraint.bbox.bottom,n.globalConstraint.bbox.right,n.globalConstraint.bbox.top];ri.extent=transformExtent(ni,"EPSG:4326",ti.projection);var si;typeof ti.projection=="string"?si=get$3(ti.projection):typeof ti.projection=="object"&&ti.projection.getCode()&&(si=get$3(ti.projection.getCode())),e.noConstraint!==!0&&n.globalConstraint.noConstraint!==!0&&si&&si.getUnits()&&(si.getUnits()==="m"?(ri.minResolution=(n.globalConstraint.minScaleDenominator-1)*28e-5,ri.maxResolution=(n.globalConstraint.maxScaleDenominator+1)*28e-5):si.getUnits()==="degrees"&&(ri.minResolution=(n.globalConstraint.minScaleDenominator-1)*28e-5*180/(Math.PI*6378137),ri.maxResolution=(n.globalConstraint.maxScaleDenominator+1)*28e-5*180/(Math.PI*6378137)))}return Helper.mergeParams(ri,e.olParams),super(ri),this.name=e.layer,this.service="WMS",this.config=n,this}getConfiguration(){return this.config}getLegends(){return this.getSource()._legends}getMetadata(){return this.getSource()._metadata}getDescription(){return this.getSource()._description}getTitle(){return this.getSource()._title}getQuicklookUrl(){return this.getSource()._quicklookUrl}getOriginators(){return this.getSource()._originators}getThumbnailUrl(){return this.getSource()._thumbnail}getProducer(){return this.getSource()._producer}}window.ol&&window.ol.layer&&(window.ol.layer.GeoportalWMS=LayerWMS);const MAXFEATURES=500,MINZOOMDEFAULT=15,MAXZOOMDEFAULT=21,STYLEBYDEFAULT=new Style$1({stroke:new Stroke({color:"rgba(0, 0, 255, 1.0)",width:2}),fill:new Fill({color:"rgba(0, 0, 255, 0.5)"})});class LayerWFS extends VectorLayer{constructor(e){if(!e.layer)throw new Error("ERROR PARAM_MISSING : layer");if(typeof e.layer!="string")throw new Error("ERROR WRONG TYPE : layer");typeof e.ssl>"u"&&(e.ssl=!0);var n=e.configuration;if(!n){if(!Config.isConfigLoaded())throw new Error("ERROR : contract key configuration has to be loaded to load Geoportal layers.");var ei=Config.configuration.getLayerId(e.layer,"WFS");if(n=Config.configuration.getLayerConf(ei),!n)throw new Error("ERROR : Layer ID not found into the catalogue !?")}var ti;e.olParams&&e.olParams.sourceParams&&(ti=e.olParams.sourceParams);var ii=new SourceWFS({layer:e.layer,configuration:e.configuration,maxFeatures:e.maxFeatures||MAXFEATURES,ssl:e.ssl,apiKey:e.apiKey,olParams:ti||{minZoom:MINZOOMDEFAULT,maxZoom:MAXZOOMDEFAULT}}),ri={source:ii};return e.olParams?Helper.mergeParams({minZoom:MINZOOMDEFAULT,maxZoom:MAXZOOMDEFAULT,style:STYLEBYDEFAULT},e.olParams):e.olParams={minZoom:MINZOOMDEFAULT,maxZoom:MAXZOOMDEFAULT,style:STYLEBYDEFAULT},Helper.mergeParams(ri,e.olParams),super(ri),this.name=e.layer,this.service="WFS",this.config=n,this}getConfiguration(){return this.config}getLegends(){return this.getSource()._legends}getMetadata(){return this.getSource()._metadata}getDescription(){return this.getSource()._description}getTitle(){return this.getSource()._title}getQuicklookUrl(){return this.getSource()._quicklookUrl}getOriginators(){return this.getSource()._originators}getThumbnailUrl(){return this.getSource()._thumbnail}getProducer(){return this.getSource()._producer}}window.ol&&window.ol.layer&&(window.ol.layer.GeoportalWFS=LayerWFS);const IMAGE_REPLAYS={image:["Polygon","Circle","LineString","Image","Text"],hybrid:["Polygon","LineString"],vector:[]},VECTOR_REPLAYS={hybrid:["Image","Text","Default"],vector:["Polygon","Circle","LineString","Image","Text","Default"]};class CanvasVectorTileLayerRenderer extends CanvasTileLayerRenderer{constructor(e,n){super(e,n),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.renderedLayerRevision_,this.renderedPixelToCoordinateTransform_=null,this.renderedRotation_,this.renderedOpacity_=1,this.tmpTransform_=create(),this.tileClipContexts_=null}enqueueTilesForNextExtent(){return this.getLayer().getRenderMode()!=="vector"}drawTile(e,n,ei,ti,ii,ri,ni,si){this.updateExecutorGroup_(e,n.pixelRatio,n.viewState.projection),this.tileImageNeedsRender_(e)&&this.renderTileImage_(e,n),super.drawTile(e,n,ei,ti,ii,ri,ni,si)}getTile(e,n,ei,ti){const ii=this.getOrCreateTile(e,n,ei,ti);if(!ii)return null;const ri=ti.viewState,ni=ri.resolution,si=ti.viewHints,ai=this.getLayer().getSource(),oi=ai.getTileGridForProjection(ri.projection),li=!(si[ViewHint.ANIMATING]||si[ViewHint.INTERACTING]),ci=oi.getZForResolution(ni,ai.zDirection)===e;return li&&ci?ii.wantedResolution=ni:ii.wantedResolution||(ii.wantedResolution=oi.getResolution(e)),ii}prepareFrame(e){const n=this.getLayer().getRevision();return this.renderedLayerRevision_!==n&&(this.renderedLayerRevision_=n,this.renderedTiles.length=0),super.prepareFrame(e)}updateExecutorGroup_(e,n,ei){const ti=this.getLayer(),ii=ti.getRevision(),ri=ti.getRenderOrder()||null,ni=e.wantedResolution,si=e.getReplayState(ti);if(!si.dirty&&si.renderedResolution===ni&&si.renderedRevision==ii&&si.renderedRenderOrder==ri)return;const ai=ti.getSource(),oi=!!ti.getDeclutter(),li=ai.getTileGrid(),ui=ai.getTileGridForProjection(ei).getTileCoordExtent(e.wrappedTileCoord),di=ai.getSourceTiles(n,ei,e),fi=getUid(ti);delete e.hitDetectionImageData[fi],e.executorGroups[fi]=[],si.dirty=!1;for(let hi=0,pi=di.length;hi<pi;++hi){const gi=di[hi];if(gi.getState()!=TileState.LOADED)continue;const vi=ai.getProjection(),yi=gi.tileCoord;let _i=li.getTileCoordExtent(yi);ei&&vi&&!equivalent$1(ei,vi)&&(_i=transformExtent(_i,vi,ei,32));const Ai=getIntersection(ui,_i),Ei=buffer(Ai,ti.getRenderBuffer()*ni,this.tempExtent),Si=equals$1(_i,Ai)?null:Ei,wi=new BuilderGroup(0,Ai,ni,n),Oi=getSquaredTolerance(ni,n),Ii=function(Ki,er){let Vi;const nr=Ki.getStyleFunction()||ti.getStyleFunction();if(nr&&(Vi=nr(Ki,ni)),Vi){const zi=this.renderFeature(Ki,Oi,Vi,wi,oi,er);si.dirty=si.dirty||zi}},Li=gi.getFeatures();ri&&ri!==si.renderedRenderOrder&&Li.sort(ri);for(let Ki=0,er=Li.length;Ki<er;++Ki){let Vi=Li[Ki];ei&&gi.projection&&!equivalent$1(ei,gi.projection)&&(Vi=Vi.clone(),Vi.getGeometry().applyTransform(getTransform(gi.projection,ei))),(!Si||intersects$1(Si,Vi.getGeometry().getExtent()))&&Ii.call(this,Vi,Ki)}const Di=wi.finish(),Ni=ti.getRenderMode()!=="vector"&&oi&&di.length===1?null:Ai,$i=new ExecutorGroup(Ni,ni,n,ai.getOverlaps(),Di,ti.getRenderBuffer(),!0);e.executorGroups[fi].push($i)}si.renderedRevision=ii,si.renderedRenderOrder=ri,si.renderedResolution=ni}forEachFeatureAtCoordinate(e,n,ei,ti,ii){var vi,yi;const ri=n.viewState.resolution,ni=n.viewState.rotation;ei=ei??0;const si=this.getLayer(),oi=si.getSource().getTileGridForProjection(n.viewState.projection),li=boundingExtent([e]);buffer(li,ri*ei,li);const ci={},ui=function(_i,Ai,Ei){let Si=_i.getId();Si===void 0&&(Si=getUid(_i));const wi=ci[Si];if(wi){if(wi!==!0&&Ei<wi.distanceSq){if(Ei===0)return ci[Si]=!0,ii.splice(ii.lastIndexOf(wi),1),ti(_i,si,Ai);wi.geometry=Ai,wi.distanceSq=Ei}}else{if(Ei===0)return ci[Si]=!0,ti(_i,si,Ai);ii.push(ci[Si]={feature:_i,layer:si,geometry:Ai,distanceSq:Ei,callback:ti})}},di=this.renderedTiles,fi=getUid(si),hi=si.getDeclutter(),pi=hi?(yi=(vi=n.declutter)==null?void 0:vi[hi])==null?void 0:yi.all().map(_i=>_i.value):null;let gi;e:for(let _i=0,Ai=di.length;_i<Ai;++_i){const Ei=di[_i],Si=oi.getTileCoordExtent(Ei.wrappedTileCoord);if(!intersects$1(Si,li))continue;const wi=Ei.executorGroups[fi];for(let Oi=0,Ii=wi.length;Oi<Ii;++Oi)if(gi=wi[Oi].forEachFeatureAtCoordinate(e,ri,ni,ei,ui,pi),gi)break e}return gi}getFeatures(e){return this.renderedTiles.length===0?Promise.resolve([]):new Promise((n,ei)=>{const ti=this.getLayer(),ii=ti.getSource(),ri=this.renderedProjection,ni=ri.getExtent(),si=this.renderedResolution,ai=ii.getTileGridForProjection(ri),oi=apply(this.renderedPixelToCoordinateTransform_,e.slice()),li=ai.getTileCoordForCoordAndResolution(oi,si).toString(),ci=this.renderedTiles.find(vi=>vi.tileCoord.toString()===li&&vi.getState()===TileState.LOADED);if(!ci||ci.loadingSourceTiles>0){n([]);return}ii.getWrapX()&&ri.canWrapX()&&!containsExtent(ni,ai.getTileCoordExtent(ci.tileCoord))&&wrapX$1(oi,ri);const ui=getUid(ti),di=ai.getTileCoordExtent(ci.wrappedTileCoord),fi=getTopLeft(di),hi=[(oi[0]-fi[0])/si,(fi[1]-oi[1])/si],pi=ci.getSourceTiles().reduce((vi,yi)=>vi.concat(yi.getFeatures()),[]);let gi=ci.hitDetectionImageData[ui];if(!gi){const vi=toSize(ai.getTileSize(ai.getZForResolution(si,ii.zDirection))),yi=this.renderedRotation_,_i=[this.getRenderTransform(ai.getTileCoordCenter(ci.wrappedTileCoord),si,0,HIT_DETECT_RESOLUTION,vi[0]*HIT_DETECT_RESOLUTION,vi[1]*HIT_DETECT_RESOLUTION,0)];gi=createHitDetectionImageData(vi,_i,pi,ti.getStyleFunction(),ai.getTileCoordExtent(ci.wrappedTileCoord),ci.getReplayState(ti).renderedResolution,yi),ci.hitDetectionImageData[ui]=gi}n(hitDetect(hi,pi,gi))})}getFeaturesInExtent(e){const n=[],ei=this.getTileCache();if(ei.getCount()===0)return n;const ii=this.getLayer().getSource().getTileGridForProjection(this.frameState.viewState.projection),ri=ii.getZForResolution(this.renderedResolution),ni={};return ei.forEach(si=>{if(si.tileCoord[0]!==ri||si.getState()!==TileState.LOADED)return;const ai=si.getSourceTiles();for(let oi=0,li=ai.length;oi<li;++oi){const ci=ai[oi],ui=ci.getKey();if(ui in ni)continue;ni[ui]=!0;const di=ci.tileCoord;if(intersects$1(e,ii.getTileCoordExtent(di))){const fi=ci.getFeatures();if(fi)for(let hi=0,pi=fi.length;hi<pi;++hi){const gi=fi[hi],vi=gi.getGeometry();intersects$1(e,vi.getExtent())&&n.push(gi)}}}}),n}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.renderedLayerRevision_!==void 0&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}renderDeclutter(e,n){var ci;const ei=this.context,ti=ei.globalAlpha;ei.globalAlpha=n.opacity;const ii=e.viewHints,ri=!(ii[ViewHint.ANIMATING]||ii[ViewHint.INTERACTING]),ni=[this.context.canvas.width,this.context.canvas.height],si=this.getLayer().getDeclutter(),ai=si?(ci=e.declutter)==null?void 0:ci[si]:void 0,oi=getUid(this.getLayer()),li=this.renderedTiles;for(let ui=0,di=li.length;ui<di;++ui){const fi=li[ui],hi=fi.executorGroups[oi];if(hi)for(let pi=hi.length-1;pi>=0;--pi)hi[pi].execute(this.context,ni,this.getTileRenderTransform(fi,e),e.viewState.rotation,ri,DECLUTTER,ai)}ei.globalAlpha=ti}renderDeferredInternal(e){const n=this.renderedTiles,ei=getUid(this.getLayer()),ti=n.reduce((si,ai,oi)=>(ai.executorGroups[ei].forEach(li=>si.push({executorGroup:li,index:oi})),si),[]),ii=ti.map(({executorGroup:si})=>si.getDeferredZIndexContexts()),ri={};for(let si=0,ai=ti.length;si<ai;++si){const oi=ti[si].executorGroup.getDeferredZIndexContexts();for(const li in oi)ri[li]=!0}Object.keys(ri).map(Number).sort(ascending).forEach(si=>{ii.forEach((ai,oi)=>{ai[si]&&(ai[si].forEach(li=>{const{executorGroup:ci,index:ui}=ti[oi],di=ci.getRenderedContext(),fi=di.globalAlpha;di.globalAlpha=this.renderedOpacity_;const hi=this.tileClipContexts_[ui];hi&&hi.draw(di),li.draw(di),hi&&di.restore(),di.globalAlpha=fi,li.clear()}),ai[si].length=0)})})}getTileRenderTransform(e,n){const ei=n.pixelRatio,ti=n.viewState,ii=ti.center,ri=ti.resolution,ni=ti.rotation,si=n.size,ai=Math.round(si[0]*ei),oi=Math.round(si[1]*ei),ci=this.getLayer().getSource().getTileGridForProjection(n.viewState.projection),ui=e.tileCoord,di=ci.getTileCoordExtent(e.wrappedTileCoord),fi=ci.getTileCoordExtent(ui,this.tempExtent)[0]-di[0];return multiply(scale(this.inversePixelTransform.slice(),1/ei,1/ei),this.getRenderTransform(ii,ri,ni,ei,ai,oi,fi))}postRender(e,n){var _i;const ei=n.viewHints,ti=!(ei[ViewHint.ANIMATING]||ei[ViewHint.INTERACTING]);this.renderedPixelToCoordinateTransform_=n.pixelToCoordinateTransform.slice(),this.renderedRotation_=n.viewState.rotation,this.renderedOpacity_=n.layerStatesArray[n.layerIndex].opacity;const ii=this.getLayer(),ri=ii.getRenderMode(),ni=e.globalAlpha;e.globalAlpha=this.renderedOpacity_;const si=ii.getDeclutter(),ai=si?VECTOR_REPLAYS[ri].filter(Ai=>!DECLUTTER.includes(Ai)):VECTOR_REPLAYS[ri],oi=n.viewState,li=oi.rotation,ci=ii.getSource(),di=ci.getTileGridForProjection(oi.projection).getZForResolution(oi.resolution,ci.zDirection),fi=this.renderedTiles,hi=[],pi=[],gi=[],vi=getUid(ii);let yi=!0;for(let Ai=fi.length-1;Ai>=0;--Ai){const Ei=fi[Ai];yi=yi&&!Ei.getReplayState(ii).dirty;const Si=Ei.executorGroups[vi].filter($i=>$i.hasExecutors(ai));if(Si.length===0)continue;const wi=this.getTileRenderTransform(Ei,n),Oi=Ei.tileCoord[0];let Ii=!1;const Li=Si[0].getClipCoords(wi);let Di=e,Ni;if(Li){Ni=new ZIndexContext,Di=Ni.getContext();for(let $i=0,Ki=hi.length;$i<Ki;++$i)if(di!==Oi&&Oi<pi[$i]){const er=hi[$i];intersects$1([Li[0],Li[3],Li[4],Li[7]],[er[0],er[3],er[4],er[7]])&&(Ii||(Di.save(),Ii=!0),Di.beginPath(),Di.moveTo(Li[0],Li[1]),Di.lineTo(Li[2],Li[3]),Di.lineTo(Li[4],Li[5]),Di.lineTo(Li[6],Li[7]),Di.moveTo(er[6],er[7]),Di.lineTo(er[4],er[5]),Di.lineTo(er[2],er[3]),Di.lineTo(er[0],er[1]),Di.clip())}hi.push(Li),pi.push(Oi)}for(let $i=0,Ki=Si.length;$i<Ki;++$i)Si[$i].execute(e,[e.canvas.width,e.canvas.height],wi,li,ti,ai,(_i=n.declutter)==null?void 0:_i[si]);Ii&&(Di===e?Di.restore():gi[Ai]=Ni)}e.globalAlpha=ni,this.ready=yi,this.tileClipContexts_=gi,n.declutter||this.renderDeferredInternal(n),super.postRender(e,n)}renderFeature(e,n,ei,ti,ii,ri){if(!ei)return!1;let ni=!1;if(Array.isArray(ei))for(let si=0,ai=ei.length;si<ai;++si)ni=renderFeature$1(ti,e,ei[si],n,this.boundHandleStyleImageChange_,void 0,ii,ri)||ni;else ni=renderFeature$1(ti,e,ei,n,this.boundHandleStyleImageChange_,void 0,ii,ri);return ni}tileImageNeedsRender_(e){const n=this.getLayer();if(n.getRenderMode()==="vector")return!1;const ei=e.getReplayState(n),ti=n.getRevision(),ii=e.wantedResolution;return ei.renderedTileResolution!==ii||ei.renderedTileRevision!==ti}renderTileImage_(e,n){const ei=this.getLayer(),ti=e.getReplayState(ei),ii=ei.getRevision(),ri=e.executorGroups[getUid(ei)];ti.renderedTileRevision=ii;const ni=e.wrappedTileCoord,si=ni[0],ai=ei.getSource();let oi=n.pixelRatio;const ci=n.viewState.projection,ui=ai.getTileGridForProjection(ci),di=ui.getResolution(e.tileCoord[0]),fi=n.pixelRatio/e.wantedResolution*di,hi=ui.getResolution(si),pi=e.getContext();oi=Math.round(Math.max(oi,fi/oi));const gi=ai.getTilePixelSize(si,oi,ci);pi.canvas.width=gi[0],pi.canvas.height=gi[1];const vi=oi/fi;if(vi!==1){const Ei=reset(this.tmpTransform_);scale(Ei,vi,vi),pi.setTransform.apply(pi,Ei)}const yi=ui.getTileCoordExtent(ni,this.tempExtent),_i=fi/hi,Ai=reset(this.tmpTransform_);scale(Ai,_i,-_i),translate(Ai,-yi[0],-yi[3]);for(let Ei=0,Si=ri.length;Ei<Si;++Ei)ri[Ei].execute(pi,[pi.canvas.width*vi,pi.canvas.height*vi],Ai,0,!0,IMAGE_REPLAYS[ei.getRenderMode()],null);ti.renderedTileResolution=e.wantedResolution}}class VectorTileLayer extends BaseVectorLayer{constructor(e){e=e||{};const n=Object.assign({},e);delete n.preload;const ei=e.cacheSize===void 0?0:e.cacheSize;delete e.cacheSize,delete n.useInterimTilesOnError,super(n),this.on,this.once,this.un,this.cacheSize_=ei;const ti=e.renderMode||"hybrid";assert(ti=="hybrid"||ti=="vector","`renderMode` must be `'hybrid'` or `'vector'`"),this.renderMode_=ti,this.setPreload(e.preload?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0),this.getBackground,this.setBackground}createRenderer(){return new CanvasVectorTileLayerRenderer(this,{cacheSize:this.cacheSize_})}getFeatures(e){return super.getFeatures(e)}getFeaturesInExtent(e){return this.getRenderer().getFeaturesInExtent(e)}getRenderMode(){return this.renderMode_}getPreload(){return this.get(TileProperty.PRELOAD)}getUseInterimTilesOnError(){return this.get(TileProperty.USE_INTERIM_TILES_ON_ERROR)}setPreload(e){this.set(TileProperty.PRELOAD,e)}setUseInterimTilesOnError(e){this.set(TileProperty.USE_INTERIM_TILES_ON_ERROR,e)}}function jsonp(_t,e,n,ei){const ti=document.createElement("script"),ii="olc_"+getUid(e);function ri(){delete window[ii],ti.parentNode.removeChild(ti)}ti.async=!0,ti.src=_t+(_t.includes("?")?"&":"?")+"callback="+ii;const ni=setTimeout(function(){ri(),n&&n()},1e4);window[ii]=function(si){clearTimeout(ni),ri(),e(si)},document.head.appendChild(ti)}class TileJSON extends TileImage{constructor(e){if(super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:get$3("EPSG:3857"),reprojectionErrorThreshold:e.reprojectionErrorThreshold,state:"loading",tileLoadFunction:e.tileLoadFunction,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,zDirection:e.zDirection}),this.tileJSON_=null,this.tileSize_=e.tileSize,e.url)if(e.jsonp)jsonp(e.url,this.handleTileJSONResponse.bind(this),this.handleTileJSONError.bind(this));else{const n=new XMLHttpRequest;n.addEventListener("load",this.onXHRLoad_.bind(this)),n.addEventListener("error",this.onXHRError_.bind(this)),n.open("GET",e.url),n.send()}else if(e.tileJSON)this.handleTileJSONResponse(e.tileJSON);else throw new Error("Either `url` or `tileJSON` options must be provided")}onXHRLoad_(e){const n=e.target;if(!n.status||n.status>=200&&n.status<300){let ei;try{ei=JSON.parse(n.responseText)}catch{this.handleTileJSONError();return}this.handleTileJSONResponse(ei)}else this.handleTileJSONError()}onXHRError_(e){this.handleTileJSONError()}getTileJSON(){return this.tileJSON_}handleTileJSONResponse(e){const n=get$3("EPSG:4326"),ei=this.getProjection();let ti;if(e.bounds!==void 0){const ai=getTransformFromProjections(n,ei);ti=applyTransform(e.bounds,ai)}const ii=extentFromProjection(ei),ri=e.minzoom||0,ni=e.maxzoom||22,si=createXYZ({extent:ii,maxZoom:ni,minZoom:ri,tileSize:this.tileSize_});if(this.tileGrid=si,this.tileUrlFunction=createFromTemplates(e.tiles,si),e.attribution&&!this.getAttributions()){const ai=ti!==void 0?ti:ii;this.setAttributions(function(oi){return intersects$1(ai,oi.extent)?[e.attribution]:null})}this.tileJSON_=e,this.setState("ready")}handleTileJSONError(){this.setState("error")}}const SHIFT_LEFT_32=65536*65536,SHIFT_RIGHT_32=1/SHIFT_LEFT_32,TEXT_DECODER_MIN_LENGTH=12,utf8TextDecoder=typeof TextDecoder>"u"?null:new TextDecoder("utf-8"),PBF_VARINT=0,PBF_FIXED64=1,PBF_BYTES=2,PBF_FIXED32=5;class Pbf{constructor(e=new Uint8Array(16)){this.buf=ArrayBuffer.isView(e)?e:new Uint8Array(e),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(e,n,ei=this.length){for(;this.pos<ei;){const ti=this.readVarint(),ii=ti>>3,ri=this.pos;this.type=ti&7,e(ii,n,this),this.pos===ri&&this.skip(ti)}return n}readMessage(e,n){return this.readFields(e,n,this.readVarint()+this.pos)}readFixed32(){const e=this.dataView.getUint32(this.pos,!0);return this.pos+=4,e}readSFixed32(){const e=this.dataView.getInt32(this.pos,!0);return this.pos+=4,e}readFixed64(){const e=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*SHIFT_LEFT_32;return this.pos+=8,e}readSFixed64(){const e=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*SHIFT_LEFT_32;return this.pos+=8,e}readFloat(){const e=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,e}readDouble(){const e=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,e}readVarint(e){const n=this.buf;let ei,ti;return ti=n[this.pos++],ei=ti&127,ti<128||(ti=n[this.pos++],ei|=(ti&127)<<7,ti<128)||(ti=n[this.pos++],ei|=(ti&127)<<14,ti<128)||(ti=n[this.pos++],ei|=(ti&127)<<21,ti<128)?ei:(ti=n[this.pos],ei|=(ti&15)<<28,readVarintRemainder(ei,e,this))}readVarint64(){return this.readVarint(!0)}readSVarint(){const e=this.readVarint();return e%2===1?(e+1)/-2:e/2}readBoolean(){return!!this.readVarint()}readString(){const e=this.readVarint()+this.pos,n=this.pos;return this.pos=e,e-n>=TEXT_DECODER_MIN_LENGTH&&utf8TextDecoder?utf8TextDecoder.decode(this.buf.subarray(n,e)):readUtf8(this.buf,n,e)}readBytes(){const e=this.readVarint()+this.pos,n=this.buf.subarray(this.pos,e);return this.pos=e,n}readPackedVarint(e=[],n){const ei=this.readPackedEnd();for(;this.pos<ei;)e.push(this.readVarint(n));return e}readPackedSVarint(e=[]){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readSVarint());return e}readPackedBoolean(e=[]){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readBoolean());return e}readPackedFloat(e=[]){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readFloat());return e}readPackedDouble(e=[]){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readDouble());return e}readPackedFixed32(e=[]){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readFixed32());return e}readPackedSFixed32(e=[]){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readSFixed32());return e}readPackedFixed64(e=[]){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readFixed64());return e}readPackedSFixed64(e=[]){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readSFixed64());return e}readPackedEnd(){return this.type===PBF_BYTES?this.readVarint()+this.pos:this.pos+1}skip(e){const n=e&7;if(n===PBF_VARINT)for(;this.buf[this.pos++]>127;);else if(n===PBF_BYTES)this.pos=this.readVarint()+this.pos;else if(n===PBF_FIXED32)this.pos+=4;else if(n===PBF_FIXED64)this.pos+=8;else throw new Error(`Unimplemented type: ${n}`)}writeTag(e,n){this.writeVarint(e<<3|n)}realloc(e){let n=this.length||16;for(;n<this.pos+e;)n*=2;if(n!==this.length){const ei=new Uint8Array(n);ei.set(this.buf),this.buf=ei,this.dataView=new DataView(ei.buffer),this.length=n}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(e){this.realloc(4),this.dataView.setInt32(this.pos,e,!0),this.pos+=4}writeSFixed32(e){this.realloc(4),this.dataView.setInt32(this.pos,e,!0),this.pos+=4}writeFixed64(e){this.realloc(8),this.dataView.setInt32(this.pos,e&-1,!0),this.dataView.setInt32(this.pos+4,Math.floor(e*SHIFT_RIGHT_32),!0),this.pos+=8}writeSFixed64(e){this.realloc(8),this.dataView.setInt32(this.pos,e&-1,!0),this.dataView.setInt32(this.pos+4,Math.floor(e*SHIFT_RIGHT_32),!0),this.pos+=8}writeVarint(e){if(e=+e||0,e>268435455||e<0){writeBigVarint(e,this);return}this.realloc(4),this.buf[this.pos++]=e&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=(e>>>=7)&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=(e>>>=7)&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=e>>>7&127)))}writeSVarint(e){this.writeVarint(e<0?-e*2-1:e*2)}writeBoolean(e){this.writeVarint(+e)}writeString(e){e=String(e),this.realloc(e.length*4),this.pos++;const n=this.pos;this.pos=writeUtf8(this.buf,e,this.pos);const ei=this.pos-n;ei>=128&&makeRoomForExtraLength(n,ei,this),this.pos=n-1,this.writeVarint(ei),this.pos+=ei}writeFloat(e){this.realloc(4),this.dataView.setFloat32(this.pos,e,!0),this.pos+=4}writeDouble(e){this.realloc(8),this.dataView.setFloat64(this.pos,e,!0),this.pos+=8}writeBytes(e){const n=e.length;this.writeVarint(n),this.realloc(n);for(let ei=0;ei<n;ei++)this.buf[this.pos++]=e[ei]}writeRawMessage(e,n){this.pos++;const ei=this.pos;e(n,this);const ti=this.pos-ei;ti>=128&&makeRoomForExtraLength(ei,ti,this),this.pos=ei-1,this.writeVarint(ti),this.pos+=ti}writeMessage(e,n,ei){this.writeTag(e,PBF_BYTES),this.writeRawMessage(n,ei)}writePackedVarint(e,n){n.length&&this.writeMessage(e,writePackedVarint,n)}writePackedSVarint(e,n){n.length&&this.writeMessage(e,writePackedSVarint,n)}writePackedBoolean(e,n){n.length&&this.writeMessage(e,writePackedBoolean,n)}writePackedFloat(e,n){n.length&&this.writeMessage(e,writePackedFloat,n)}writePackedDouble(e,n){n.length&&this.writeMessage(e,writePackedDouble,n)}writePackedFixed32(e,n){n.length&&this.writeMessage(e,writePackedFixed32,n)}writePackedSFixed32(e,n){n.length&&this.writeMessage(e,writePackedSFixed32,n)}writePackedFixed64(e,n){n.length&&this.writeMessage(e,writePackedFixed64,n)}writePackedSFixed64(e,n){n.length&&this.writeMessage(e,writePackedSFixed64,n)}writeBytesField(e,n){this.writeTag(e,PBF_BYTES),this.writeBytes(n)}writeFixed32Field(e,n){this.writeTag(e,PBF_FIXED32),this.writeFixed32(n)}writeSFixed32Field(e,n){this.writeTag(e,PBF_FIXED32),this.writeSFixed32(n)}writeFixed64Field(e,n){this.writeTag(e,PBF_FIXED64),this.writeFixed64(n)}writeSFixed64Field(e,n){this.writeTag(e,PBF_FIXED64),this.writeSFixed64(n)}writeVarintField(e,n){this.writeTag(e,PBF_VARINT),this.writeVarint(n)}writeSVarintField(e,n){this.writeTag(e,PBF_VARINT),this.writeSVarint(n)}writeStringField(e,n){this.writeTag(e,PBF_BYTES),this.writeString(n)}writeFloatField(e,n){this.writeTag(e,PBF_FIXED32),this.writeFloat(n)}writeDoubleField(e,n){this.writeTag(e,PBF_FIXED64),this.writeDouble(n)}writeBooleanField(e,n){this.writeVarintField(e,+n)}}function readVarintRemainder(_t,e,n){const ei=n.buf;let ti,ii;if(ii=ei[n.pos++],ti=(ii&112)>>4,ii<128||(ii=ei[n.pos++],ti|=(ii&127)<<3,ii<128)||(ii=ei[n.pos++],ti|=(ii&127)<<10,ii<128)||(ii=ei[n.pos++],ti|=(ii&127)<<17,ii<128)||(ii=ei[n.pos++],ti|=(ii&127)<<24,ii<128)||(ii=ei[n.pos++],ti|=(ii&1)<<31,ii<128))return toNum(_t,ti,e);throw new Error("Expected varint not more than 10 bytes")}function toNum(_t,e,n){return n?e*4294967296+(_t>>>0):(e>>>0)*4294967296+(_t>>>0)}function writeBigVarint(_t,e){let n,ei;if(_t>=0?(n=_t%4294967296|0,ei=_t/4294967296|0):(n=~(-_t%4294967296),ei=~(-_t/4294967296),n^4294967295?n=n+1|0:(n=0,ei=ei+1|0)),_t>=18446744073709552e3||_t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),writeBigVarintLow(n,ei,e),writeBigVarintHigh(ei,e)}function writeBigVarintLow(_t,e,n){n.buf[n.pos++]=_t&127|128,_t>>>=7,n.buf[n.pos++]=_t&127|128,_t>>>=7,n.buf[n.pos++]=_t&127|128,_t>>>=7,n.buf[n.pos++]=_t&127|128,_t>>>=7,n.buf[n.pos]=_t&127}function writeBigVarintHigh(_t,e){const n=(_t&7)<<4;e.buf[e.pos++]|=n|((_t>>>=3)?128:0),_t&&(e.buf[e.pos++]=_t&127|((_t>>>=7)?128:0),_t&&(e.buf[e.pos++]=_t&127|((_t>>>=7)?128:0),_t&&(e.buf[e.pos++]=_t&127|((_t>>>=7)?128:0),_t&&(e.buf[e.pos++]=_t&127|((_t>>>=7)?128:0),_t&&(e.buf[e.pos++]=_t&127)))))}function makeRoomForExtraLength(_t,e,n){const ei=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(Math.LN2*7));n.realloc(ei);for(let ti=n.pos-1;ti>=_t;ti--)n.buf[ti+ei]=n.buf[ti]}function writePackedVarint(_t,e){for(let n=0;n<_t.length;n++)e.writeVarint(_t[n])}function writePackedSVarint(_t,e){for(let n=0;n<_t.length;n++)e.writeSVarint(_t[n])}function writePackedFloat(_t,e){for(let n=0;n<_t.length;n++)e.writeFloat(_t[n])}function writePackedDouble(_t,e){for(let n=0;n<_t.length;n++)e.writeDouble(_t[n])}function writePackedBoolean(_t,e){for(let n=0;n<_t.length;n++)e.writeBoolean(_t[n])}function writePackedFixed32(_t,e){for(let n=0;n<_t.length;n++)e.writeFixed32(_t[n])}function writePackedSFixed32(_t,e){for(let n=0;n<_t.length;n++)e.writeSFixed32(_t[n])}function writePackedFixed64(_t,e){for(let n=0;n<_t.length;n++)e.writeFixed64(_t[n])}function writePackedSFixed64(_t,e){for(let n=0;n<_t.length;n++)e.writeSFixed64(_t[n])}function readUtf8(_t,e,n){let ei="",ti=e;for(;ti<n;){const ii=_t[ti];let ri=null,ni=ii>239?4:ii>223?3:ii>191?2:1;if(ti+ni>n)break;let si,ai,oi;ni===1?ii<128&&(ri=ii):ni===2?(si=_t[ti+1],(si&192)===128&&(ri=(ii&31)<<6|si&63,ri<=127&&(ri=null))):ni===3?(si=_t[ti+1],ai=_t[ti+2],(si&192)===128&&(ai&192)===128&&(ri=(ii&15)<<12|(si&63)<<6|ai&63,(ri<=2047||ri>=55296&&ri<=57343)&&(ri=null))):ni===4&&(si=_t[ti+1],ai=_t[ti+2],oi=_t[ti+3],(si&192)===128&&(ai&192)===128&&(oi&192)===128&&(ri=(ii&15)<<18|(si&63)<<12|(ai&63)<<6|oi&63,(ri<=65535||ri>=1114112)&&(ri=null))),ri===null?(ri=65533,ni=1):ri>65535&&(ri-=65536,ei+=String.fromCharCode(ri>>>10&1023|55296),ri=56320|ri&1023),ei+=String.fromCharCode(ri),ti+=ni}return ei}function writeUtf8(_t,e,n){for(let ei=0,ti,ii;ei<e.length;ei++){if(ti=e.charCodeAt(ei),ti>55295&&ti<57344)if(ii)if(ti<56320){_t[n++]=239,_t[n++]=191,_t[n++]=189,ii=ti;continue}else ti=ii-55296<<10|ti-56320|65536,ii=null;else{ti>56319||ei+1===e.length?(_t[n++]=239,_t[n++]=191,_t[n++]=189):ii=ti;continue}else ii&&(_t[n++]=239,_t[n++]=191,_t[n++]=189,ii=null);ti<128?_t[n++]=ti:(ti<2048?_t[n++]=ti>>6|192:(ti<65536?_t[n++]=ti>>12|224:(_t[n++]=ti>>18|240,_t[n++]=ti>>12&63|128),_t[n++]=ti>>6&63|128),_t[n++]=ti&63|128)}return n}class MVT extends FeatureFormat{constructor(e){super(),e=e||{},this.dataProjection=new Projection$1({code:"",units:"tile-pixels"}),this.featureClass=e.featureClass?e.featureClass:RenderFeature,this.geometryName_=e.geometryName,this.layerName_=e.layerName?e.layerName:"layer",this.layers_=e.layers?e.layers:null,this.idProperty_=e.idProperty,this.supportedMediaTypes=["application/vnd.mapbox-vector-tile","application/x-protobuf"]}readRawGeometry_(e,n,ei,ti){e.pos=n.geometry;const ii=e.readVarint()+e.pos;let ri=1,ni=0,si=0,ai=0,oi=0,li=0;for(;e.pos<ii;){if(!ni){const ci=e.readVarint();ri=ci&7,ni=ci>>3}if(ni--,ri===1||ri===2)si+=e.readSVarint(),ai+=e.readSVarint(),ri===1&&oi>li&&(ti.push(oi),li=oi),ei.push(si,ai),oi+=2;else if(ri===7)oi>li&&(ei.push(ei[li],ei[li+1]),oi+=2);else throw new Error("Invalid command found in the PBF")}oi>li&&(ti.push(oi),li=oi)}createFeature_(e,n,ei){const ti=n.type;if(ti===0)return null;let ii;const ri=n.properties;let ni;this.idProperty_?(ni=ri[this.idProperty_],delete ri[this.idProperty_]):ni=n.id,ri[this.layerName_]=n.layer.name;const si=[],ai=[];this.readRawGeometry_(e,n,si,ai);const oi=getGeometryType(ti,ai.length);if(this.featureClass===RenderFeature)ii=new this.featureClass(oi,si,ai,2,ri,ni),ii.transform(ei.dataProjection);else{let li;if(oi=="Polygon"){const di=inflateEnds(si,ai);li=di.length>1?new MultiPolygon(si,"XY",di):new Polygon(si,"XY",ai)}else li=oi==="Point"?new Point$1(si,"XY"):oi==="LineString"?new LineString(si,"XY"):oi==="MultiPoint"?new MultiPoint(si,"XY"):oi==="MultiLineString"?new MultiLineString(si,"XY",ai):null;const ci=this.featureClass;ii=new ci,this.geometryName_&&ii.setGeometryName(this.geometryName_);const ui=transformGeometryWithOptions(li,!1,ei);ii.setGeometry(ui),ni!==void 0&&ii.setId(ni),ii.setProperties(ri,!0)}return ii}getType(){return"arraybuffer"}readFeatures(e,n){const ei=this.layers_;n=this.adaptOptions(n);const ti=get$3(n.dataProjection);ti.setWorldExtent(n.extent),n.dataProjection=ti;const ii=new Pbf(e),ri=ii.readFields(layersPBFReader,{}),ni=[];for(const si in ri){if(ei&&!ei.includes(si))continue;const ai=ri[si],oi=ai?[0,0,ai.extent,ai.extent]:null;ti.setExtent(oi);for(let li=0,ci=ai.length;li<ci;++li){const ui=readRawFeature(ii,ai,li),di=this.createFeature_(ii,ui,n);di!==null&&ni.push(di)}}return ni}readProjection(e){return this.dataProjection}setLayers(e){this.layers_=e}}function layersPBFReader(_t,e,n){if(_t===3){const ei={keys:[],values:[],features:[]},ti=n.readVarint()+n.pos;n.readFields(layerPBFReader,ei,ti),ei.length=ei.features.length,ei.length&&(e[ei.name]=ei)}}function layerPBFReader(_t,e,n){if(_t===15)e.version=n.readVarint();else if(_t===1)e.name=n.readString();else if(_t===5)e.extent=n.readVarint();else if(_t===2)e.features.push(n.pos);else if(_t===3)e.keys.push(n.readString());else if(_t===4){let ei=null;const ti=n.readVarint()+n.pos;for(;n.pos<ti;)_t=n.readVarint()>>3,ei=_t===1?n.readString():_t===2?n.readFloat():_t===3?n.readDouble():_t===4?n.readVarint64():_t===5?n.readVarint():_t===6?n.readSVarint():_t===7?n.readBoolean():null;e.values.push(ei)}}function featurePBFReader(_t,e,n){if(_t==1)e.id=n.readVarint();else if(_t==2){const ei=n.readVarint()+n.pos;for(;n.pos<ei;){const ti=e.layer.keys[n.readVarint()],ii=e.layer.values[n.readVarint()];e.properties[ti]=ii}}else _t==3?e.type=n.readVarint():_t==4&&(e.geometry=n.pos)}function readRawFeature(_t,e,n){_t.pos=e.features[n];const ei=_t.readVarint()+_t.pos,ti={layer:e,type:0,properties:{}};return _t.readFields(featurePBFReader,ti,ei),ti}function getGeometryType(_t,e){let n;return _t===1?n=e===1?"Point":"MultiPoint":_t===2?n=e===1?"LineString":"MultiLineString":_t===3&&(n="Polygon"),n}var $version=8,$root={version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources={"*":{type:"source"}},source=["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector={type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster={type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem={type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson={type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video={type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image={type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer={id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout=["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill={"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle={"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line={"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol={"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter={type:"array",value:"*"},filter_operator={type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type={type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function_stop={type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression$1={type:"array",value:"*",minimum:1},light={anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky={"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain={source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection={type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint=["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill={"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},paint_line={"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle={"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap={"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol={"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster={"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade={"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_background={"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition={duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},promoteId={"*":{type:"string"}},v8Spec={$version,$root,sources,source,source_vector,source_raster,source_raster_dem,source_geojson,source_video,source_image,layer,layout,layout_background,layout_fill,layout_circle,layout_heatmap,"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line,layout_symbol,layout_raster,layout_hillshade,"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter,filter_operator,geometry_type,function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop,expression:expression$1,light,sky,terrain,projection,paint,paint_fill,"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line,paint_circle,paint_heatmap,paint_symbol,paint_raster,paint_hillshade,"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background,transition,"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId};const refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function deref(_t,e){const n={};for(const ei in _t)ei!=="ref"&&(n[ei]=_t[ei]);return refProperties.forEach(ei=>{ei in e&&(n[ei]=e[ei])}),n}function derefLayers(_t){_t=_t.slice();const e=Object.create(null);for(let n=0;n<_t.length;n++)e[_t[n].id]=_t[n];for(let n=0;n<_t.length;n++)"ref"in _t[n]&&(_t[n]=deref(_t[n],e[_t[n].ref]));return _t}class ExpressionParsingError extends Error{constructor(e,n){super(n),this.message=n,this.key=e}}class Scope{constructor(e,n=[]){this.parent=e,this.bindings={};for(const[ei,ti]of n)this.bindings[ei]=ti}concat(e){return new Scope(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return this.bindings[e]?!0:this.parent?this.parent.has(e):!1}}const NullType={kind:"null"},NumberType={kind:"number"},StringType={kind:"string"},BooleanType={kind:"boolean"},ColorType$1={kind:"color"},ProjectionDefinitionType={kind:"projectionDefinition"},ObjectType={kind:"object"},ValueType={kind:"value"},ErrorType={kind:"error"},CollatorType={kind:"collator"},FormattedType={kind:"formatted"},PaddingType={kind:"padding"},ColorArrayType={kind:"colorArray"},NumberArrayType={kind:"numberArray"},ResolvedImageType={kind:"resolvedImage"},VariableAnchorOffsetCollectionType={kind:"variableAnchorOffsetCollection"};function array(_t,e){return{kind:"array",itemType:_t,N:e}}function typeToString(_t){if(_t.kind==="array"){const e=typeToString(_t.itemType);return typeof _t.N=="number"?`array<${e}, ${_t.N}>`:_t.itemType.kind==="value"?"array":`array<${e}>`}else return _t.kind}const valueMemberTypes=[NullType,NumberType,StringType,BooleanType,ColorType$1,ProjectionDefinitionType,FormattedType,ObjectType,array(ValueType),PaddingType,NumberArrayType,ColorArrayType,ResolvedImageType,VariableAnchorOffsetCollectionType];function checkSubtype(_t,e){if(e.kind==="error")return null;if(_t.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!checkSubtype(_t.itemType,e.itemType))&&(typeof _t.N!="number"||_t.N===e.N))return null}else{if(_t.kind===e.kind)return null;if(_t.kind==="value"){for(const n of valueMemberTypes)if(!checkSubtype(n,e))return null}}return`Expected ${typeToString(_t)} but found ${typeToString(e)} instead.`}function isValidType(_t,e){return e.some(n=>n.kind===_t.kind)}function isValidNativeType(_t,e){return e.some(n=>n==="null"?_t===null:n==="array"?Array.isArray(_t):n==="object"?_t&&!Array.isArray(_t)&&typeof _t=="object":n===typeof _t)}function verifyType(_t,e){return _t.kind==="array"&&e.kind==="array"?_t.itemType.kind===e.itemType.kind&&typeof _t.N=="number":_t.kind===e.kind}const Xn=.96422,Yn=1,Zn=.82521,t0=4/29,t1=6/29,t2=3*t1*t1,t3=t1*t1*t1,deg2rad$1=Math.PI/180,rad2deg=180/Math.PI;function constrainAngle(_t){return _t=_t%360,_t<0&&(_t+=360),_t}function rgbToLab([_t,e,n,ei]){_t=rgb2xyz(_t),e=rgb2xyz(e),n=rgb2xyz(n);let ti,ii;const ri=xyz2lab((.2225045*_t+.7168786*e+.0606169*n)/Yn);_t===e&&e===n?ti=ii=ri:(ti=xyz2lab((.4360747*_t+.3850649*e+.1430804*n)/Xn),ii=xyz2lab((.0139322*_t+.0971045*e+.7141733*n)/Zn));const ni=116*ri-16;return[ni<0?0:ni,500*(ti-ri),200*(ri-ii),ei]}function rgb2xyz(_t){return _t<=.04045?_t/12.92:Math.pow((_t+.055)/1.055,2.4)}function xyz2lab(_t){return _t>t3?Math.pow(_t,1/3):_t/t2+t0}function labToRgb([_t,e,n,ei]){let ti=(_t+16)/116,ii=isNaN(e)?ti:ti+e/500,ri=isNaN(n)?ti:ti-n/200;return ti=Yn*lab2xyz(ti),ii=Xn*lab2xyz(ii),ri=Zn*lab2xyz(ri),[xyz2rgb(3.1338561*ii-1.6168667*ti-.4906146*ri),xyz2rgb(-.9787684*ii+1.9161415*ti+.033454*ri),xyz2rgb(.0719453*ii-.2289914*ti+1.4052427*ri),ei]}function xyz2rgb(_t){return _t=_t<=.00304?12.92*_t:1.055*Math.pow(_t,1/2.4)-.055,_t<0?0:_t>1?1:_t}function lab2xyz(_t){return _t>t1?_t*_t*_t:t2*(_t-t0)}function rgbToHcl(_t){const[e,n,ei,ti]=rgbToLab(_t),ii=Math.sqrt(n*n+ei*ei);return[Math.round(ii*1e4)?constrainAngle(Math.atan2(ei,n)*rad2deg):NaN,ii,e,ti]}function hclToRgb([_t,e,n,ei]){return _t=isNaN(_t)?0:_t*deg2rad$1,labToRgb([n,Math.cos(_t)*e,Math.sin(_t)*e,ei])}function hslToRgb([_t,e,n,ei]){_t=constrainAngle(_t),e/=100,n/=100;function ti(ii){const ri=(ii+_t/30)%12,ni=e*Math.min(n,1-n);return n-ni*Math.max(-1,Math.min(ri-3,9-ri,1))}return[ti(0),ti(8),ti(4),ei]}const hasOwnProperty=Object.hasOwn||function(e,n){return Object.prototype.hasOwnProperty.call(e,n)};function getOwn(_t,e){return hasOwnProperty(_t,e)?_t[e]:void 0}function parseCssColor(_t){if(_t=_t.toLowerCase().trim(),_t==="transparent")return[0,0,0,0];const e=getOwn(namedColors,_t);if(e){const[ti,ii,ri]=e;return[ti/255,ii/255,ri/255,1]}if(_t.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(_t)){const ii=_t.length<6?1:2;let ri=1;return[parseHex(_t.slice(ri,ri+=ii)),parseHex(_t.slice(ri,ri+=ii)),parseHex(_t.slice(ri,ri+=ii)),parseHex(_t.slice(ri,ri+ii)||"ff")]}if(_t.startsWith("rgb")){const ti=/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/,ii=_t.match(ti);if(ii){const[ri,ni,si,ai,oi,li,ci,ui,di,fi,hi,pi]=ii,gi=[ai||" ",ci||" ",fi].join("");if(gi==="  "||gi==="  /"||gi===",,"||gi===",,,"){const vi=[si,li,di].join(""),yi=vi==="%%%"?100:vi===""?255:0;if(yi){const _i=[clamp(+ni/yi,0,1),clamp(+oi/yi,0,1),clamp(+ui/yi,0,1),hi?parseAlpha(+hi,pi):1];if(validateNumbers(_i))return _i}}return}}const n=/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/,ei=_t.match(n);if(ei){const[ti,ii,ri,ni,si,ai,oi,li,ci]=ei,ui=[ri||" ",si||" ",oi].join("");if(ui==="  "||ui==="  /"||ui===",,"||ui===",,,"){const di=[+ii,clamp(+ni,0,100),clamp(+ai,0,100),li?parseAlpha(+li,ci):1];if(validateNumbers(di))return hslToRgb(di)}}}function parseHex(_t){return parseInt(_t.padEnd(2,_t),16)/255}function parseAlpha(_t,e){return clamp(e?_t/100:_t,0,1)}function clamp(_t,e,n){return Math.min(Math.max(e,_t),n)}function validateNumbers(_t){return!_t.some(Number.isNaN)}const namedColors={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function interpolateNumber(_t,e,n){return _t+n*(e-_t)}function interpolateArray(_t,e,n){return _t.map((ei,ti)=>interpolateNumber(ei,e[ti],n))}class Color{constructor(e,n,ei,ti=1,ii=!0){this.r=e,this.g=n,this.b=ei,this.a=ti,ii||(this.r*=ti,this.g*=ti,this.b*=ti,ti||this.overwriteGetter("rgb",[e,n,ei,ti]))}static parse(e){if(e instanceof Color)return e;if(typeof e!="string")return;const n=parseCssColor(e);if(n)return new Color(...n,!1)}get rgb(){const{r:e,g:n,b:ei,a:ti}=this,ii=ti||1/0;return this.overwriteGetter("rgb",[e/ii,n/ii,ei/ii,ti])}get hcl(){return this.overwriteGetter("hcl",rgbToHcl(this.rgb))}get lab(){return this.overwriteGetter("lab",rgbToLab(this.rgb))}overwriteGetter(e,n){return Object.defineProperty(this,e,{value:n}),n}toString(){const[e,n,ei,ti]=this.rgb;return`rgba(${[e,n,ei].map(ii=>Math.round(ii*255)).join(",")},${ti})`}static interpolate(e,n,ei,ti="rgb"){switch(ti){case"rgb":{const[ii,ri,ni,si]=interpolateArray(e.rgb,n.rgb,ei);return new Color(ii,ri,ni,si,!1)}case"hcl":{const[ii,ri,ni,si]=e.hcl,[ai,oi,li,ci]=n.hcl;let ui,di;if(!isNaN(ii)&&!isNaN(ai)){let vi=ai-ii;ai>ii&&vi>180?vi-=360:ai<ii&&ii-ai>180&&(vi+=360),ui=ii+ei*vi}else isNaN(ii)?isNaN(ai)?ui=NaN:(ui=ai,(ni===1||ni===0)&&(di=oi)):(ui=ii,(li===1||li===0)&&(di=ri));const[fi,hi,pi,gi]=hclToRgb([ui,di??interpolateNumber(ri,oi,ei),interpolateNumber(ni,li,ei),interpolateNumber(si,ci,ei)]);return new Color(fi,hi,pi,gi,!1)}case"lab":{const[ii,ri,ni,si]=labToRgb(interpolateArray(e.lab,n.lab,ei));return new Color(ii,ri,ni,si,!1)}}}}Color.black=new Color(0,0,0,1);Color.white=new Color(1,1,1,1);Color.transparent=new Color(0,0,0,0);Color.red=new Color(1,0,0,1);class Collator{constructor(e,n,ei){e?this.sensitivity=n?"variant":"case":this.sensitivity=n?"accent":"base",this.locale=ei,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,n){return this.collator.compare(e,n)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const VERTICAL_ALIGN_OPTIONS=["bottom","center","top"];class FormattedSection{constructor(e,n,ei,ti,ii,ri){this.text=e,this.image=n,this.scale=ei,this.fontStack=ti,this.textColor=ii,this.verticalAlign=ri}}class Formatted{constructor(e){this.sections=e}static fromString(e){return new Formatted([new FormattedSection(e,null,null,null,null,null)])}isEmpty(){return this.sections.length===0?!0:!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof Formatted?e:Formatted.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}}class Padding{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof Padding)return e;if(typeof e=="number")return new Padding([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(const n of e)if(typeof n!="number")return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]];break}return new Padding(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,n,ei){return new Padding(interpolateArray(e.values,n.values,ei))}}class NumberArray{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof NumberArray)return e;if(typeof e=="number")return new NumberArray([e]);if(Array.isArray(e)){for(const n of e)if(typeof n!="number")return;return new NumberArray(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,n,ei){return new NumberArray(interpolateArray(e.values,n.values,ei))}}class ColorArray{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof ColorArray)return e;if(typeof e=="string"){const ei=Color.parse(e);return ei?new ColorArray([ei]):void 0}if(!Array.isArray(e))return;const n=[];for(const ei of e){if(typeof ei!="string")return;const ti=Color.parse(ei);if(!ti)return;n.push(ti)}return new ColorArray(n)}toString(){return JSON.stringify(this.values)}static interpolate(e,n,ei,ti="rgb"){const ii=[];if(e.values.length!=n.values.length)throw new Error(`colorArray: Arrays have mismatched length (${e.values.length} vs. ${n.values.length}), cannot interpolate.`);for(let ri=0;ri<e.values.length;ri++)ii.push(Color.interpolate(e.values[ri],n.values[ri],ei,ti));return new ColorArray(ii)}}class RuntimeError extends Error{constructor(e){super(e),this.name="RuntimeError"}toJSON(){return this.message}}const anchors=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class VariableAnchorOffsetCollection{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof VariableAnchorOffsetCollection)return e;if(!(!Array.isArray(e)||e.length<1||e.length%2!==0)){for(let n=0;n<e.length;n+=2){const ei=e[n],ti=e[n+1];if(typeof ei!="string"||!anchors.has(ei)||!Array.isArray(ti)||ti.length!==2||typeof ti[0]!="number"||typeof ti[1]!="number")return}return new VariableAnchorOffsetCollection(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,n,ei){const ti=e.values,ii=n.values;if(ti.length!==ii.length)throw new RuntimeError(`Cannot interpolate values of different length. from: ${e.toString()}, to: ${n.toString()}`);const ri=[];for(let ni=0;ni<ti.length;ni+=2){if(ti[ni]!==ii[ni])throw new RuntimeError(`Cannot interpolate values containing mismatched anchors. from[${ni}]: ${ti[ni]}, to[${ni}]: ${ii[ni]}`);ri.push(ti[ni]);const[si,ai]=ti[ni+1],[oi,li]=ii[ni+1];ri.push([interpolateNumber(si,oi,ei),interpolateNumber(ai,li,ei)])}return new VariableAnchorOffsetCollection(ri)}}class ResolvedImage{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new ResolvedImage({name:e,available:!1}):null}}class ProjectionDefinition{constructor(e,n,ei){this.from=e,this.to=n,this.transition=ei}static interpolate(e,n,ei){return new ProjectionDefinition(e,n,ei)}static parse(e){if(e instanceof ProjectionDefinition)return e;if(Array.isArray(e)&&e.length===3&&typeof e[0]=="string"&&typeof e[1]=="string"&&typeof e[2]=="number")return new ProjectionDefinition(e[0],e[1],e[2]);if(typeof e=="object"&&typeof e.from=="string"&&typeof e.to=="string"&&typeof e.transition=="number")return new ProjectionDefinition(e.from,e.to,e.transition);if(typeof e=="string")return new ProjectionDefinition(e,e,1)}}function validateRGBA(_t,e,n,ei){return typeof _t=="number"&&_t>=0&&_t<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof n=="number"&&n>=0&&n<=255?typeof ei>"u"||typeof ei=="number"&&ei>=0&&ei<=1?null:`Invalid rgba value [${[_t,e,n,ei].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof ei=="number"?[_t,e,n,ei]:[_t,e,n]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function isValue(_t){if(_t===null||typeof _t=="string"||typeof _t=="boolean"||typeof _t=="number"||_t instanceof ProjectionDefinition||_t instanceof Color||_t instanceof Collator||_t instanceof Formatted||_t instanceof Padding||_t instanceof NumberArray||_t instanceof ColorArray||_t instanceof VariableAnchorOffsetCollection||_t instanceof ResolvedImage)return!0;if(Array.isArray(_t)){for(const e of _t)if(!isValue(e))return!1;return!0}else if(typeof _t=="object"){for(const e in _t)if(!isValue(_t[e]))return!1;return!0}else return!1}function typeOf(_t){if(_t===null)return NullType;if(typeof _t=="string")return StringType;if(typeof _t=="boolean")return BooleanType;if(typeof _t=="number")return NumberType;if(_t instanceof Color)return ColorType$1;if(_t instanceof ProjectionDefinition)return ProjectionDefinitionType;if(_t instanceof Collator)return CollatorType;if(_t instanceof Formatted)return FormattedType;if(_t instanceof Padding)return PaddingType;if(_t instanceof NumberArray)return NumberArrayType;if(_t instanceof ColorArray)return ColorArrayType;if(_t instanceof VariableAnchorOffsetCollection)return VariableAnchorOffsetCollectionType;if(_t instanceof ResolvedImage)return ResolvedImageType;if(Array.isArray(_t)){const e=_t.length;let n;for(const ei of _t){const ti=typeOf(ei);if(!n)n=ti;else{if(n===ti)continue;n=ValueType;break}}return array(n||ValueType,e)}else return ObjectType}function valueToString(_t){const e=typeof _t;return _t===null?"":e==="string"||e==="number"||e==="boolean"?String(_t):_t instanceof Color||_t instanceof ProjectionDefinition||_t instanceof Formatted||_t instanceof Padding||_t instanceof NumberArray||_t instanceof ColorArray||_t instanceof VariableAnchorOffsetCollection||_t instanceof ResolvedImage?_t.toString():JSON.stringify(_t)}class Literal{constructor(e,n){this.type=e,this.value=n}static parse(e,n){if(e.length!==2)return n.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!isValue(e[1]))return n.error("invalid value");const ei=e[1];let ti=typeOf(ei);const ii=n.expectedType;return ti.kind==="array"&&ti.N===0&&ii&&ii.kind==="array"&&(typeof ii.N!="number"||ii.N===0)&&(ti=ii),new Literal(ti,ei)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const types$1$1={string:StringType,number:NumberType,boolean:BooleanType,object:ObjectType};class Assertion{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");let ei=1,ti;const ii=e[0];if(ii==="array"){let ni;if(e.length>2){const ai=e[1];if(typeof ai!="string"||!(ai in types$1$1)||ai==="object")return n.error('The item type argument of "array" must be one of string, number, boolean',1);ni=types$1$1[ai],ei++}else ni=ValueType;let si;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return n.error('The length argument to "array" must be a positive integer literal',2);si=e[2],ei++}ti=array(ni,si)}else{if(!types$1$1[ii])throw new Error(`Types doesn't contain name = ${ii}`);ti=types$1$1[ii]}const ri=[];for(;ei<e.length;ei++){const ni=n.parse(e[ei],ei,ValueType);if(!ni)return null;ri.push(ni)}return new Assertion(ti,ri)}evaluate(e){for(let n=0;n<this.args.length;n++){const ei=this.args[n].evaluate(e);if(checkSubtype(this.type,typeOf(ei))){if(n===this.args.length-1)throw new RuntimeError(`Expected value to be of type ${typeToString(this.type)}, but found ${typeToString(typeOf(ei))} instead.`)}else return ei}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}const types$2={"to-boolean":BooleanType,"to-color":ColorType$1,"to-number":NumberType,"to-string":StringType};class Coercion{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");const ei=e[0];if(!types$2[ei])throw new Error(`Can't parse ${ei} as it is not part of the known types`);if((ei==="to-boolean"||ei==="to-string")&&e.length!==2)return n.error("Expected one argument.");const ti=types$2[ei],ii=[];for(let ri=1;ri<e.length;ri++){const ni=n.parse(e[ri],ri,ValueType);if(!ni)return null;ii.push(ni)}return new Coercion(ti,ii)}evaluate(e){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(e);case"color":{let n,ei;for(const ti of this.args){if(n=ti.evaluate(e),ei=null,n instanceof Color)return n;if(typeof n=="string"){const ii=e.parseColor(n);if(ii)return ii}else if(Array.isArray(n)&&(n.length<3||n.length>4?ei=`Invalid rgba value ${JSON.stringify(n)}: expected an array containing either three or four numeric values.`:ei=validateRGBA(n[0],n[1],n[2],n[3]),!ei))return new Color(n[0]/255,n[1]/255,n[2]/255,n[3])}throw new RuntimeError(ei||`Could not parse color from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"padding":{let n;for(const ei of this.args){n=ei.evaluate(e);const ti=Padding.parse(n);if(ti)return ti}throw new RuntimeError(`Could not parse padding from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"numberArray":{let n;for(const ei of this.args){n=ei.evaluate(e);const ti=NumberArray.parse(n);if(ti)return ti}throw new RuntimeError(`Could not parse numberArray from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"colorArray":{let n;for(const ei of this.args){n=ei.evaluate(e);const ti=ColorArray.parse(n);if(ti)return ti}throw new RuntimeError(`Could not parse colorArray from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"variableAnchorOffsetCollection":{let n;for(const ei of this.args){n=ei.evaluate(e);const ti=VariableAnchorOffsetCollection.parse(n);if(ti)return ti}throw new RuntimeError(`Could not parse variableAnchorOffsetCollection from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"number":{let n=null;for(const ei of this.args){if(n=ei.evaluate(e),n===null)return 0;const ti=Number(n);if(!isNaN(ti))return ti}throw new RuntimeError(`Could not convert ${JSON.stringify(n)} to number.`)}case"formatted":return Formatted.fromString(valueToString(this.args[0].evaluate(e)));case"resolvedImage":return ResolvedImage.fromString(valueToString(this.args[0].evaluate(e)));case"projectionDefinition":return this.args[0].evaluate(e);default:return valueToString(this.args[0].evaluate(e))}}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}const geometryTypes=["Unknown","Point","LineString","Polygon"];class EvaluationContext{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?geometryTypes[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let n=this._parseColorCache.get(e);return n||(n=Color.parse(e),this._parseColorCache.set(e,n)),n}}class ParsingContext{constructor(e,n,ei=[],ti,ii=new Scope,ri=[]){this.registry=e,this.path=ei,this.key=ei.map(ni=>`[${ni}]`).join(""),this.scope=ii,this.errors=ri,this.expectedType=ti,this._isConstant=n}parse(e,n,ei,ti,ii={}){return n?this.concat(n,ei,ti)._parse(e,ii):this._parse(e,ii)}_parse(e,n){(e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number")&&(e=["literal",e]);function ei(ti,ii,ri){return ri==="assert"?new Assertion(ii,[ti]):ri==="coerce"?new Coercion(ii,[ti]):ti}if(Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const ti=e[0];if(typeof ti!="string")return this.error(`Expression name must be a string, but found ${typeof ti} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const ii=this.registry[ti];if(ii){let ri=ii.parse(e,this);if(!ri)return null;if(this.expectedType){const ni=this.expectedType,si=ri.type;if((ni.kind==="string"||ni.kind==="number"||ni.kind==="boolean"||ni.kind==="object"||ni.kind==="array")&&si.kind==="value")ri=ei(ri,ni,n.typeAnnotation||"assert");else if(ni.kind==="projectionDefinition"&&["string","array"].includes(si.kind)||["color","formatted","resolvedImage"].includes(ni.kind)&&["value","string"].includes(si.kind)||["padding","numberArray"].includes(ni.kind)&&["value","number","array"].includes(si.kind)||ni.kind==="colorArray"&&["value","string","array"].includes(si.kind)||ni.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(si.kind))ri=ei(ri,ni,n.typeAnnotation||"coerce");else if(this.checkSubtype(ni,si))return null}if(!(ri instanceof Literal)&&ri.type.kind!=="resolvedImage"&&this._isConstant(ri)){const ni=new EvaluationContext;try{ri=new Literal(ri.type,ri.evaluate(ni))}catch(si){return this.error(si.message),null}}return ri}return this.error(`Unknown expression "${ti}". If you wanted a literal array, use ["literal", [...]].`,0)}else return typeof e>"u"?this.error("'undefined' value invalid. Use null instead."):typeof e=="object"?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error(`Expected an array, but found ${typeof e} instead.`)}concat(e,n,ei){const ti=typeof e=="number"?this.path.concat(e):this.path,ii=ei?this.scope.concat(ei):this.scope;return new ParsingContext(this.registry,this._isConstant,ti,n||null,ii,this.errors)}error(e,...n){const ei=`${this.key}${n.map(ti=>`[${ti}]`).join("")}`;this.errors.push(new ExpressionParsingError(ei,e))}checkSubtype(e,n){const ei=checkSubtype(e,n);return ei&&this.error(ei),ei}}class Let{constructor(e,n){this.type=n.type,this.bindings=[].concat(e),this.result=n}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const n of this.bindings)e(n[1]);e(this.result)}static parse(e,n){if(e.length<4)return n.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const ei=[];for(let ii=1;ii<e.length-1;ii+=2){const ri=e[ii];if(typeof ri!="string")return n.error(`Expected string, but found ${typeof ri} instead.`,ii);if(/[^a-zA-Z0-9_]/.test(ri))return n.error("Variable names must contain only alphanumeric characters or '_'.",ii);const ni=n.parse(e[ii+1],ii+1);if(!ni)return null;ei.push([ri,ni])}const ti=n.parse(e[e.length-1],e.length-1,n.expectedType,ei);return ti?new Let(ei,ti):null}outputDefined(){return this.result.outputDefined()}}class Var{constructor(e,n){this.type=n.type,this.name=e,this.boundExpression=n}static parse(e,n){if(e.length!==2||typeof e[1]!="string")return n.error("'var' expression requires exactly one string literal argument.");const ei=e[1];return n.scope.has(ei)?new Var(ei,n.scope.get(ei)):n.error(`Unknown variable "${ei}". Make sure "${ei}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}}let At$1=class Yc{constructor(e,n,ei){this.type=e,this.index=n,this.input=ei}static parse(e,n){if(e.length!==3)return n.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const ei=n.parse(e[1],1,NumberType),ti=n.parse(e[2],2,array(n.expectedType||ValueType));if(!ei||!ti)return null;const ii=ti.type;return new Yc(ii.itemType,ei,ti)}evaluate(e){const n=this.index.evaluate(e),ei=this.input.evaluate(e);if(n<0)throw new RuntimeError(`Array index out of bounds: ${n} < 0.`);if(n>=ei.length)throw new RuntimeError(`Array index out of bounds: ${n} > ${ei.length-1}.`);if(n!==Math.floor(n))throw new RuntimeError(`Array index must be an integer, but found ${n} instead.`);return ei[n]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}};class In{constructor(e,n){this.type=BooleanType,this.needle=e,this.haystack=n}static parse(e,n){if(e.length!==3)return n.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const ei=n.parse(e[1],1,ValueType),ti=n.parse(e[2],2,ValueType);return!ei||!ti?null:isValidType(ei.type,[BooleanType,StringType,NumberType,NullType,ValueType])?new In(ei,ti):n.error(`Expected first argument to be of type boolean, string, number or null, but found ${typeToString(ei.type)} instead`)}evaluate(e){const n=this.needle.evaluate(e),ei=this.haystack.evaluate(e);if(!ei)return!1;if(!isValidNativeType(n,["boolean","string","number","null"]))throw new RuntimeError(`Expected first argument to be of type boolean, string, number or null, but found ${typeToString(typeOf(n))} instead.`);if(!isValidNativeType(ei,["string","array"]))throw new RuntimeError(`Expected second argument to be of type array or string, but found ${typeToString(typeOf(ei))} instead.`);return ei.indexOf(n)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}}class IndexOf{constructor(e,n,ei){this.type=NumberType,this.needle=e,this.haystack=n,this.fromIndex=ei}static parse(e,n){if(e.length<=2||e.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const ei=n.parse(e[1],1,ValueType),ti=n.parse(e[2],2,ValueType);if(!ei||!ti)return null;if(!isValidType(ei.type,[BooleanType,StringType,NumberType,NullType,ValueType]))return n.error(`Expected first argument to be of type boolean, string, number or null, but found ${typeToString(ei.type)} instead`);if(e.length===4){const ii=n.parse(e[3],3,NumberType);return ii?new IndexOf(ei,ti,ii):null}else return new IndexOf(ei,ti)}evaluate(e){const n=this.needle.evaluate(e),ei=this.haystack.evaluate(e);if(!isValidNativeType(n,["boolean","string","number","null"]))throw new RuntimeError(`Expected first argument to be of type boolean, string, number or null, but found ${typeToString(typeOf(n))} instead.`);let ti;if(this.fromIndex&&(ti=this.fromIndex.evaluate(e)),isValidNativeType(ei,["string"])){const ii=ei.indexOf(n,ti);return ii===-1?-1:[...ei.slice(0,ii)].length}else{if(isValidNativeType(ei,["array"]))return ei.indexOf(n,ti);throw new RuntimeError(`Expected second argument to be of type array or string, but found ${typeToString(typeOf(ei))} instead.`)}}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}}class Match{constructor(e,n,ei,ti,ii,ri){this.inputType=e,this.type=n,this.input=ei,this.cases=ti,this.outputs=ii,this.otherwise=ri}static parse(e,n){if(e.length<5)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!==1)return n.error("Expected an even number of arguments.");let ei,ti;n.expectedType&&n.expectedType.kind!=="value"&&(ti=n.expectedType);const ii={},ri=[];for(let ai=2;ai<e.length-1;ai+=2){let oi=e[ai];const li=e[ai+1];Array.isArray(oi)||(oi=[oi]);const ci=n.concat(ai);if(oi.length===0)return ci.error("Expected at least one branch label.");for(const di of oi){if(typeof di!="number"&&typeof di!="string")return ci.error("Branch labels must be numbers or strings.");if(typeof di=="number"&&Math.abs(di)>Number.MAX_SAFE_INTEGER)return ci.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof di=="number"&&Math.floor(di)!==di)return ci.error("Numeric branch labels must be integer values.");if(!ei)ei=typeOf(di);else if(ci.checkSubtype(ei,typeOf(di)))return null;if(typeof ii[String(di)]<"u")return ci.error("Branch labels must be unique.");ii[String(di)]=ri.length}const ui=n.parse(li,ai,ti);if(!ui)return null;ti=ti||ui.type,ri.push(ui)}const ni=n.parse(e[1],1,ValueType);if(!ni)return null;const si=n.parse(e[e.length-1],e.length-1,ti);return!si||ni.type.kind!=="value"&&n.concat(1).checkSubtype(ei,ni.type)?null:new Match(ei,ti,ni,ii,ri,si)}evaluate(e){const n=this.input.evaluate(e);return(typeOf(n)===this.inputType&&this.outputs[this.cases[n]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}}class Case{constructor(e,n,ei){this.type=e,this.branches=n,this.otherwise=ei}static parse(e,n){if(e.length<4)return n.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!==0)return n.error("Expected an odd number of arguments.");let ei;n.expectedType&&n.expectedType.kind!=="value"&&(ei=n.expectedType);const ti=[];for(let ri=1;ri<e.length-1;ri+=2){const ni=n.parse(e[ri],ri,BooleanType);if(!ni)return null;const si=n.parse(e[ri+1],ri+1,ei);if(!si)return null;ti.push([ni,si]),ei=ei||si.type}const ii=n.parse(e[e.length-1],e.length-1,ei);if(!ii)return null;if(!ei)throw new Error("Can't infer output type");return new Case(ei,ti,ii)}evaluate(e){for(const[n,ei]of this.branches)if(n.evaluate(e))return ei.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[n,ei]of this.branches)e(n),e(ei);e(this.otherwise)}outputDefined(){return this.branches.every(([e,n])=>n.outputDefined())&&this.otherwise.outputDefined()}}class Slice{constructor(e,n,ei,ti){this.type=e,this.input=n,this.beginIndex=ei,this.endIndex=ti}static parse(e,n){if(e.length<=2||e.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const ei=n.parse(e[1],1,ValueType),ti=n.parse(e[2],2,NumberType);if(!ei||!ti)return null;if(!isValidType(ei.type,[array(ValueType),StringType,ValueType]))return n.error(`Expected first argument to be of type array or string, but found ${typeToString(ei.type)} instead`);if(e.length===4){const ii=n.parse(e[3],3,NumberType);return ii?new Slice(ei.type,ei,ti,ii):null}else return new Slice(ei.type,ei,ti)}evaluate(e){const n=this.input.evaluate(e),ei=this.beginIndex.evaluate(e);let ti;if(this.endIndex&&(ti=this.endIndex.evaluate(e)),isValidNativeType(n,["string"]))return[...n].slice(ei,ti).join("");if(isValidNativeType(n,["array"]))return n.slice(ei,ti);throw new RuntimeError(`Expected first argument to be of type array or string, but found ${typeToString(typeOf(n))} instead.`)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}}function findStopLessThanOrEqualTo(_t,e){const n=_t.length-1;let ei=0,ti=n,ii=0,ri,ni;for(;ei<=ti;)if(ii=Math.floor((ei+ti)/2),ri=_t[ii],ni=_t[ii+1],ri<=e){if(ii===n||e<ni)return ii;ei=ii+1}else if(ri>e)ti=ii-1;else throw new RuntimeError("Input is not a number.");return 0}class Step{constructor(e,n,ei){this.type=e,this.input=n,this.labels=[],this.outputs=[];for(const[ti,ii]of ei)this.labels.push(ti),this.outputs.push(ii)}static parse(e,n){if(e.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!==0)return n.error("Expected an even number of arguments.");const ei=n.parse(e[1],1,NumberType);if(!ei)return null;const ti=[];let ii=null;n.expectedType&&n.expectedType.kind!=="value"&&(ii=n.expectedType);for(let ri=1;ri<e.length;ri+=2){const ni=ri===1?-1/0:e[ri],si=e[ri+1],ai=ri,oi=ri+1;if(typeof ni!="number")return n.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',ai);if(ti.length&&ti[ti.length-1][0]>=ni)return n.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',ai);const li=n.parse(si,oi,ii);if(!li)return null;ii=ii||li.type,ti.push([ni,li])}return new Step(ii,ei,ti)}evaluate(e){const n=this.labels,ei=this.outputs;if(n.length===1)return ei[0].evaluate(e);const ti=this.input.evaluate(e);if(ti<=n[0])return ei[0].evaluate(e);const ii=n.length;if(ti>=n[ii-1])return ei[ii-1].evaluate(e);const ri=findStopLessThanOrEqualTo(n,ti);return ei[ri].evaluate(e)}eachChild(e){e(this.input);for(const n of this.outputs)e(n)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function getDefaultExportFromCjs(_t){return _t&&_t.__esModule&&Object.prototype.hasOwnProperty.call(_t,"default")?_t.default:_t}var unitbezier,hasRequiredUnitbezier;function requireUnitbezier(){if(hasRequiredUnitbezier)return unitbezier;hasRequiredUnitbezier=1,unitbezier=_t;function _t(e,n,ei,ti){this.cx=3*e,this.bx=3*(ei-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(ti-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=n,this.p2x=ei,this.p2y=ti}return _t.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,n){if(n===void 0&&(n=1e-6),e<0)return 0;if(e>1)return 1;for(var ei=e,ti=0;ti<8;ti++){var ii=this.sampleCurveX(ei)-e;if(Math.abs(ii)<n)return ei;var ri=this.sampleCurveDerivativeX(ei);if(Math.abs(ri)<1e-6)break;ei=ei-ii/ri}var ni=0,si=1;for(ei=e,ti=0;ti<20&&(ii=this.sampleCurveX(ei),!(Math.abs(ii-e)<n));ti++)e>ii?ni=ei:si=ei,ei=(si-ni)*.5+ni;return ei},solve:function(e,n){return this.sampleCurveY(this.solveCurveX(e,n))}},unitbezier}var unitbezierExports=requireUnitbezier(),UnitBezier=getDefaultExportFromCjs(unitbezierExports);class Interpolate{constructor(e,n,ei,ti,ii){this.type=e,this.operator=n,this.interpolation=ei,this.input=ti,this.labels=[],this.outputs=[];for(const[ri,ni]of ii)this.labels.push(ri),this.outputs.push(ni)}static interpolationFactor(e,n,ei,ti){let ii=0;if(e.name==="exponential")ii=exponentialInterpolation(n,e.base,ei,ti);else if(e.name==="linear")ii=exponentialInterpolation(n,1,ei,ti);else if(e.name==="cubic-bezier"){const ri=e.controlPoints;ii=new UnitBezier(ri[0],ri[1],ri[2],ri[3]).solve(exponentialInterpolation(n,1,ei,ti))}return ii}static parse(e,n){let[ei,ti,ii,...ri]=e;if(!Array.isArray(ti)||ti.length===0)return n.error("Expected an interpolation type expression.",1);if(ti[0]==="linear")ti={name:"linear"};else if(ti[0]==="exponential"){const ai=ti[1];if(typeof ai!="number")return n.error("Exponential interpolation requires a numeric base.",1,1);ti={name:"exponential",base:ai}}else if(ti[0]==="cubic-bezier"){const ai=ti.slice(1);if(ai.length!==4||ai.some(oi=>typeof oi!="number"||oi<0||oi>1))return n.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);ti={name:"cubic-bezier",controlPoints:ai}}else return n.error(`Unknown interpolation type ${String(ti[0])}`,1,0);if(e.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!==0)return n.error("Expected an even number of arguments.");if(ii=n.parse(ii,2,NumberType),!ii)return null;const ni=[];let si=null;(ei==="interpolate-hcl"||ei==="interpolate-lab")&&n.expectedType!=ColorArrayType?si=ColorType$1:n.expectedType&&n.expectedType.kind!=="value"&&(si=n.expectedType);for(let ai=0;ai<ri.length;ai+=2){const oi=ri[ai],li=ri[ai+1],ci=ai+3,ui=ai+4;if(typeof oi!="number")return n.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',ci);if(ni.length&&ni[ni.length-1][0]>=oi)return n.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',ci);const di=n.parse(li,ui,si);if(!di)return null;si=si||di.type,ni.push([oi,di])}return!verifyType(si,NumberType)&&!verifyType(si,ProjectionDefinitionType)&&!verifyType(si,ColorType$1)&&!verifyType(si,PaddingType)&&!verifyType(si,NumberArrayType)&&!verifyType(si,ColorArrayType)&&!verifyType(si,VariableAnchorOffsetCollectionType)&&!verifyType(si,array(NumberType))?n.error(`Type ${typeToString(si)} is not interpolatable.`):new Interpolate(si,ei,ti,ii,ni)}evaluate(e){const n=this.labels,ei=this.outputs;if(n.length===1)return ei[0].evaluate(e);const ti=this.input.evaluate(e);if(ti<=n[0])return ei[0].evaluate(e);const ii=n.length;if(ti>=n[ii-1])return ei[ii-1].evaluate(e);const ri=findStopLessThanOrEqualTo(n,ti),ni=n[ri],si=n[ri+1],ai=Interpolate.interpolationFactor(this.interpolation,ti,ni,si),oi=ei[ri].evaluate(e),li=ei[ri+1].evaluate(e);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return interpolateNumber(oi,li,ai);case"color":return Color.interpolate(oi,li,ai);case"padding":return Padding.interpolate(oi,li,ai);case"colorArray":return ColorArray.interpolate(oi,li,ai);case"numberArray":return NumberArray.interpolate(oi,li,ai);case"variableAnchorOffsetCollection":return VariableAnchorOffsetCollection.interpolate(oi,li,ai);case"array":return interpolateArray(oi,li,ai);case"projectionDefinition":return ProjectionDefinition.interpolate(oi,li,ai)}case"interpolate-hcl":switch(this.type.kind){case"color":return Color.interpolate(oi,li,ai,"hcl");case"colorArray":return ColorArray.interpolate(oi,li,ai,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return Color.interpolate(oi,li,ai,"lab");case"colorArray":return ColorArray.interpolate(oi,li,ai,"lab")}}}eachChild(e){e(this.input);for(const n of this.outputs)e(n)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function exponentialInterpolation(_t,e,n,ei){const ti=ei-n,ii=_t-n;return ti===0?0:e===1?ii/ti:(Math.pow(e,ii)-1)/(Math.pow(e,ti)-1)}class Coalesce{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");let ei=null;const ti=n.expectedType;ti&&ti.kind!=="value"&&(ei=ti);const ii=[];for(const ni of e.slice(1)){const si=n.parse(ni,1+ii.length,ei,void 0,{typeAnnotation:"omit"});if(!si)return null;ei=ei||si.type,ii.push(si)}if(!ei)throw new Error("No output type");return ti&&ii.some(ni=>checkSubtype(ti,ni.type))?new Coalesce(ValueType,ii):new Coalesce(ei,ii)}evaluate(e){let n=null,ei=0,ti;for(const ii of this.args)if(ei++,n=ii.evaluate(e),n&&n instanceof ResolvedImage&&!n.available&&(ti||(ti=n.name),n=null,ei===this.args.length&&(n=ti)),n!==null)break;return n}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}function isComparableType(_t,e){return _t==="=="||_t==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function eq(_t,e,n){return e===n}function neq(_t,e,n){return e!==n}function lt$1(_t,e,n){return e<n}function gt$1(_t,e,n){return e>n}function lteq(_t,e,n){return e<=n}function gteq(_t,e,n){return e>=n}function eqCollate(_t,e,n,ei){return ei.compare(e,n)===0}function neqCollate(_t,e,n,ei){return!eqCollate(_t,e,n,ei)}function ltCollate(_t,e,n,ei){return ei.compare(e,n)<0}function gtCollate(_t,e,n,ei){return ei.compare(e,n)>0}function lteqCollate(_t,e,n,ei){return ei.compare(e,n)<=0}function gteqCollate(_t,e,n,ei){return ei.compare(e,n)>=0}function makeComparison(_t,e,n){const ei=_t!=="=="&&_t!=="!=";return class Xc{constructor(ii,ri,ni){this.type=BooleanType,this.lhs=ii,this.rhs=ri,this.collator=ni,this.hasUntypedArgument=ii.type.kind==="value"||ri.type.kind==="value"}static parse(ii,ri){if(ii.length!==3&&ii.length!==4)return ri.error("Expected two or three arguments.");const ni=ii[0];let si=ri.parse(ii[1],1,ValueType);if(!si)return null;if(!isComparableType(ni,si.type))return ri.concat(1).error(`"${ni}" comparisons are not supported for type '${typeToString(si.type)}'.`);let ai=ri.parse(ii[2],2,ValueType);if(!ai)return null;if(!isComparableType(ni,ai.type))return ri.concat(2).error(`"${ni}" comparisons are not supported for type '${typeToString(ai.type)}'.`);if(si.type.kind!==ai.type.kind&&si.type.kind!=="value"&&ai.type.kind!=="value")return ri.error(`Cannot compare types '${typeToString(si.type)}' and '${typeToString(ai.type)}'.`);ei&&(si.type.kind==="value"&&ai.type.kind!=="value"?si=new Assertion(ai.type,[si]):si.type.kind!=="value"&&ai.type.kind==="value"&&(ai=new Assertion(si.type,[ai])));let oi=null;if(ii.length===4){if(si.type.kind!=="string"&&ai.type.kind!=="string"&&si.type.kind!=="value"&&ai.type.kind!=="value")return ri.error("Cannot use collator to compare non-string types.");if(oi=ri.parse(ii[3],3,CollatorType),!oi)return null}return new Xc(si,ai,oi)}evaluate(ii){const ri=this.lhs.evaluate(ii),ni=this.rhs.evaluate(ii);if(ei&&this.hasUntypedArgument){const si=typeOf(ri),ai=typeOf(ni);if(si.kind!==ai.kind||!(si.kind==="string"||si.kind==="number"))throw new RuntimeError(`Expected arguments for "${_t}" to be (string, string) or (number, number), but found (${si.kind}, ${ai.kind}) instead.`)}if(this.collator&&!ei&&this.hasUntypedArgument){const si=typeOf(ri),ai=typeOf(ni);if(si.kind!=="string"||ai.kind!=="string")return e(ii,ri,ni)}return this.collator?n(ii,ri,ni,this.collator.evaluate(ii)):e(ii,ri,ni)}eachChild(ii){ii(this.lhs),ii(this.rhs),this.collator&&ii(this.collator)}outputDefined(){return!0}}}const Equals=makeComparison("==",eq,eqCollate),NotEquals=makeComparison("!=",neq,neqCollate),LessThan=makeComparison("<",lt$1,ltCollate),GreaterThan=makeComparison(">",gt$1,gtCollate),LessThanOrEqual=makeComparison("<=",lteq,lteqCollate),GreaterThanOrEqual=makeComparison(">=",gteq,gteqCollate);class CollatorExpression{constructor(e,n,ei){this.type=CollatorType,this.locale=ei,this.caseSensitive=e,this.diacriticSensitive=n}static parse(e,n){if(e.length!==2)return n.error("Expected one argument.");const ei=e[1];if(typeof ei!="object"||Array.isArray(ei))return n.error("Collator options argument must be an object.");const ti=n.parse(ei["case-sensitive"]===void 0?!1:ei["case-sensitive"],1,BooleanType);if(!ti)return null;const ii=n.parse(ei["diacritic-sensitive"]===void 0?!1:ei["diacritic-sensitive"],1,BooleanType);if(!ii)return null;let ri=null;return ei.locale&&(ri=n.parse(ei.locale,1,StringType),!ri)?null:new CollatorExpression(ti,ii,ri)}evaluate(e){return new Collator(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}}class NumberFormat{constructor(e,n,ei,ti,ii){this.type=StringType,this.number=e,this.locale=n,this.currency=ei,this.minFractionDigits=ti,this.maxFractionDigits=ii}static parse(e,n){if(e.length!==3)return n.error("Expected two arguments.");const ei=n.parse(e[1],1,NumberType);if(!ei)return null;const ti=e[2];if(typeof ti!="object"||Array.isArray(ti))return n.error("NumberFormat options argument must be an object.");let ii=null;if(ti.locale&&(ii=n.parse(ti.locale,1,StringType),!ii))return null;let ri=null;if(ti.currency&&(ri=n.parse(ti.currency,1,StringType),!ri))return null;let ni=null;if(ti["min-fraction-digits"]&&(ni=n.parse(ti["min-fraction-digits"],1,NumberType),!ni))return null;let si=null;return ti["max-fraction-digits"]&&(si=n.parse(ti["max-fraction-digits"],1,NumberType),!si)?null:new NumberFormat(ei,ii,ri,ni,si)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}}class FormatExpression{constructor(e){this.type=FormattedType,this.sections=e}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");const ei=e[1];if(!Array.isArray(ei)&&typeof ei=="object")return n.error("First argument must be an image or text section.");const ti=[];let ii=!1;for(let ri=1;ri<=e.length-1;++ri){const ni=e[ri];if(ii&&typeof ni=="object"&&!Array.isArray(ni)){ii=!1;let si=null;if(ni["font-scale"]&&(si=n.parse(ni["font-scale"],1,NumberType),!si))return null;let ai=null;if(ni["text-font"]&&(ai=n.parse(ni["text-font"],1,array(StringType)),!ai))return null;let oi=null;if(ni["text-color"]&&(oi=n.parse(ni["text-color"],1,ColorType$1),!oi))return null;let li=null;if(ni["vertical-align"]){if(typeof ni["vertical-align"]=="string"&&!VERTICAL_ALIGN_OPTIONS.includes(ni["vertical-align"]))return n.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${ni["vertical-align"]}' instead.`);if(li=n.parse(ni["vertical-align"],1,StringType),!li)return null}const ci=ti[ti.length-1];ci.scale=si,ci.font=ai,ci.textColor=oi,ci.verticalAlign=li}else{const si=n.parse(e[ri],1,ValueType);if(!si)return null;const ai=si.type.kind;if(ai!=="string"&&ai!=="value"&&ai!=="null"&&ai!=="resolvedImage")return n.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");ii=!0,ti.push({content:si,scale:null,font:null,textColor:null,verticalAlign:null})}}return new FormatExpression(ti)}evaluate(e){const n=ei=>{const ti=ei.content.evaluate(e);return typeOf(ti)===ResolvedImageType?new FormattedSection("",ti,null,null,null,ei.verticalAlign?ei.verticalAlign.evaluate(e):null):new FormattedSection(valueToString(ti),null,ei.scale?ei.scale.evaluate(e):null,ei.font?ei.font.evaluate(e).join(","):null,ei.textColor?ei.textColor.evaluate(e):null,ei.verticalAlign?ei.verticalAlign.evaluate(e):null)};return new Formatted(this.sections.map(n))}eachChild(e){for(const n of this.sections)e(n.content),n.scale&&e(n.scale),n.font&&e(n.font),n.textColor&&e(n.textColor),n.verticalAlign&&e(n.verticalAlign)}outputDefined(){return!1}}class ImageExpression{constructor(e){this.type=ResolvedImageType,this.input=e}static parse(e,n){if(e.length!==2)return n.error("Expected two arguments.");const ei=n.parse(e[1],1,StringType);return ei?new ImageExpression(ei):n.error("No image name provided.")}evaluate(e){const n=this.input.evaluate(e),ei=ResolvedImage.fromString(n);return ei&&e.availableImages&&(ei.available=e.availableImages.indexOf(n)>-1),ei}eachChild(e){e(this.input)}outputDefined(){return!1}}class Length{constructor(e){this.type=NumberType,this.input=e}static parse(e,n){if(e.length!==2)return n.error(`Expected 1 argument, but found ${e.length-1} instead.`);const ei=n.parse(e[1],1);return ei?ei.type.kind!=="array"&&ei.type.kind!=="string"&&ei.type.kind!=="value"?n.error(`Expected argument of type string or array, but found ${typeToString(ei.type)} instead.`):new Length(ei):null}evaluate(e){const n=this.input.evaluate(e);if(typeof n=="string")return[...n].length;if(Array.isArray(n))return n.length;throw new RuntimeError(`Expected value to be of type string or array, but found ${typeToString(typeOf(n))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}}const EXTENT=8192;function getTileCoordinates(_t,e){const n=mercatorXfromLng(_t[0]),ei=mercatorYfromLat(_t[1]),ti=Math.pow(2,e.z);return[Math.round(n*ti*EXTENT),Math.round(ei*ti*EXTENT)]}function getLngLatFromTileCoord(_t,e){const n=Math.pow(2,e.z),ei=(_t[0]/EXTENT+e.x)/n,ti=(_t[1]/EXTENT+e.y)/n;return[lngFromMercatorXfromLng(ei),latFromMercatorY(ti)]}function mercatorXfromLng(_t){return(180+_t)/360}function lngFromMercatorXfromLng(_t){return _t*360-180}function mercatorYfromLat(_t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+_t*Math.PI/360)))/360}function latFromMercatorY(_t){return 360/Math.PI*Math.atan(Math.exp((180-_t*360)*Math.PI/180))-90}function updateBBox(_t,e){_t[0]=Math.min(_t[0],e[0]),_t[1]=Math.min(_t[1],e[1]),_t[2]=Math.max(_t[2],e[0]),_t[3]=Math.max(_t[3],e[1])}function boxWithinBox(_t,e){return!(_t[0]<=e[0]||_t[2]>=e[2]||_t[1]<=e[1]||_t[3]>=e[3])}function rayIntersect(_t,e,n){return e[1]>_t[1]!=n[1]>_t[1]&&_t[0]<(n[0]-e[0])*(_t[1]-e[1])/(n[1]-e[1])+e[0]}function pointOnBoundary(_t,e,n){const ei=_t[0]-e[0],ti=_t[1]-e[1],ii=_t[0]-n[0],ri=_t[1]-n[1];return ei*ri-ii*ti===0&&ei*ii<=0&&ti*ri<=0}function segmentIntersectSegment(_t,e,n,ei){const ti=[e[0]-_t[0],e[1]-_t[1]],ii=[ei[0]-n[0],ei[1]-n[1]];return perp(ii,ti)===0?!1:!!(twoSided(_t,e,n,ei)&&twoSided(n,ei,_t,e))}function lineIntersectPolygon(_t,e,n){for(const ei of n)for(let ti=0;ti<ei.length-1;++ti)if(segmentIntersectSegment(_t,e,ei[ti],ei[ti+1]))return!0;return!1}function pointWithinPolygon(_t,e,n=!1){let ei=!1;for(const ti of e)for(let ii=0;ii<ti.length-1;ii++){if(pointOnBoundary(_t,ti[ii],ti[ii+1]))return n;rayIntersect(_t,ti[ii],ti[ii+1])&&(ei=!ei)}return ei}function pointWithinPolygons(_t,e){for(const n of e)if(pointWithinPolygon(_t,n))return!0;return!1}function lineStringWithinPolygon(_t,e){for(const n of _t)if(!pointWithinPolygon(n,e))return!1;for(let n=0;n<_t.length-1;++n)if(lineIntersectPolygon(_t[n],_t[n+1],e))return!1;return!0}function lineStringWithinPolygons(_t,e){for(const n of e)if(lineStringWithinPolygon(_t,n))return!0;return!1}function perp(_t,e){return _t[0]*e[1]-_t[1]*e[0]}function twoSided(_t,e,n,ei){const ti=_t[0]-n[0],ii=_t[1]-n[1],ri=e[0]-n[0],ni=e[1]-n[1],si=ei[0]-n[0],ai=ei[1]-n[1],oi=ti*ai-si*ii,li=ri*ai-si*ni;return oi>0&&li<0||oi<0&&li>0}function getTilePolygon(_t,e,n){const ei=[];for(let ti=0;ti<_t.length;ti++){const ii=[];for(let ri=0;ri<_t[ti].length;ri++){const ni=getTileCoordinates(_t[ti][ri],n);updateBBox(e,ni),ii.push(ni)}ei.push(ii)}return ei}function getTilePolygons(_t,e,n){const ei=[];for(let ti=0;ti<_t.length;ti++){const ii=getTilePolygon(_t[ti],e,n);ei.push(ii)}return ei}function updatePoint(_t,e,n,ei){if(_t[0]<n[0]||_t[0]>n[2]){const ti=ei*.5;let ii=_t[0]-n[0]>ti?-ei:n[0]-_t[0]>ti?ei:0;ii===0&&(ii=_t[0]-n[2]>ti?-ei:n[2]-_t[0]>ti?ei:0),_t[0]+=ii}updateBBox(e,_t)}function resetBBox(_t){_t[0]=_t[1]=1/0,_t[2]=_t[3]=-1/0}function getTilePoints(_t,e,n,ei){const ti=Math.pow(2,ei.z)*EXTENT,ii=[ei.x*EXTENT,ei.y*EXTENT],ri=[];for(const ni of _t)for(const si of ni){const ai=[si.x+ii[0],si.y+ii[1]];updatePoint(ai,e,n,ti),ri.push(ai)}return ri}function getTileLines(_t,e,n,ei){const ti=Math.pow(2,ei.z)*EXTENT,ii=[ei.x*EXTENT,ei.y*EXTENT],ri=[];for(const ni of _t){const si=[];for(const ai of ni){const oi=[ai.x+ii[0],ai.y+ii[1]];updateBBox(e,oi),si.push(oi)}ri.push(si)}if(e[2]-e[0]<=ti/2){resetBBox(e);for(const ni of ri)for(const si of ni)updatePoint(si,e,n,ti)}return ri}function pointsWithinPolygons(_t,e){const n=[1/0,1/0,-1/0,-1/0],ei=[1/0,1/0,-1/0,-1/0],ti=_t.canonicalID();if(e.type==="Polygon"){const ii=getTilePolygon(e.coordinates,ei,ti),ri=getTilePoints(_t.geometry(),n,ei,ti);if(!boxWithinBox(n,ei))return!1;for(const ni of ri)if(!pointWithinPolygon(ni,ii))return!1}if(e.type==="MultiPolygon"){const ii=getTilePolygons(e.coordinates,ei,ti),ri=getTilePoints(_t.geometry(),n,ei,ti);if(!boxWithinBox(n,ei))return!1;for(const ni of ri)if(!pointWithinPolygons(ni,ii))return!1}return!0}function linesWithinPolygons(_t,e){const n=[1/0,1/0,-1/0,-1/0],ei=[1/0,1/0,-1/0,-1/0],ti=_t.canonicalID();if(e.type==="Polygon"){const ii=getTilePolygon(e.coordinates,ei,ti),ri=getTileLines(_t.geometry(),n,ei,ti);if(!boxWithinBox(n,ei))return!1;for(const ni of ri)if(!lineStringWithinPolygon(ni,ii))return!1}if(e.type==="MultiPolygon"){const ii=getTilePolygons(e.coordinates,ei,ti),ri=getTileLines(_t.geometry(),n,ei,ti);if(!boxWithinBox(n,ei))return!1;for(const ni of ri)if(!lineStringWithinPolygons(ni,ii))return!1}return!0}class Within{constructor(e,n){this.type=BooleanType,this.geojson=e,this.geometries=n}static parse(e,n){if(e.length!==2)return n.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(isValue(e[1])){const ei=e[1];if(ei.type==="FeatureCollection"){const ti=[];for(const ii of ei.features){const{type:ri,coordinates:ni}=ii.geometry;ri==="Polygon"&&ti.push(ni),ri==="MultiPolygon"&&ti.push(...ni)}if(ti.length){const ii={type:"MultiPolygon",coordinates:ti};return new Within(ei,ii)}}else if(ei.type==="Feature"){const ti=ei.geometry.type;if(ti==="Polygon"||ti==="MultiPolygon")return new Within(ei,ei.geometry)}else if(ei.type==="Polygon"||ei.type==="MultiPolygon")return new Within(ei,ei)}return n.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return pointsWithinPolygons(e,this.geometries);if(e.geometryType()==="LineString")return linesWithinPolygons(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class TinyQueue{constructor(e=[],n=(ei,ti)=>ei<ti?-1:ei>ti?1:0){if(this.data=e,this.length=this.data.length,this.compare=n,this.length>0)for(let ei=(this.length>>1)-1;ei>=0;ei--)this._down(ei)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(this.length===0)return;const e=this.data[0],n=this.data.pop();return--this.length>0&&(this.data[0]=n,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:n,compare:ei}=this,ti=n[e];for(;e>0;){const ii=e-1>>1,ri=n[ii];if(ei(ti,ri)>=0)break;n[e]=ri,e=ii}n[e]=ti}_down(e){const{data:n,compare:ei}=this,ti=this.length>>1,ii=n[e];for(;e<ti;){let ri=(e<<1)+1;const ni=ri+1;if(ni<this.length&&ei(n[ni],n[ri])<0&&(ri=ni),ei(n[ri],ii)>=0)break;n[e]=n[ri],e=ri}n[e]=ii}}function classifyRings(_t,e){if(_t.length<=1)return[_t];const ei=[];let ti,ii;for(const ri of _t){const ni=calculateSignedArea(ri);ni!==0&&(ri.area=Math.abs(ni),ii===void 0&&(ii=ni<0),ii===ni<0?(ti&&ei.push(ti),ti=[ri]):ti.push(ri))}return ti&&ei.push(ti),ei}function calculateSignedArea(_t){let e=0;for(let n=0,ei=_t.length,ti=ei-1,ii,ri;n<ei;ti=n++)ii=_t[n],ri=_t[ti],e+=(ri.x-ii.x)*(ii.y+ri.y);return e}const RE=6378.137,FE=1/298.257223563,E2=FE*(2-FE),RAD=Math.PI/180;class CheapRuler{constructor(e){const n=RAD*RE*1e3,ei=Math.cos(e*RAD),ti=1/(1-E2*(1-ei*ei)),ii=Math.sqrt(ti);this.kx=n*ii*ei,this.ky=n*ii*ti*(1-E2)}distance(e,n){const ei=this.wrap(e[0]-n[0])*this.kx,ti=(e[1]-n[1])*this.ky;return Math.sqrt(ei*ei+ti*ti)}pointOnLine(e,n){let ei=1/0,ti,ii,ri,ni;for(let si=0;si<e.length-1;si++){let ai=e[si][0],oi=e[si][1],li=this.wrap(e[si+1][0]-ai)*this.kx,ci=(e[si+1][1]-oi)*this.ky,ui=0;(li!==0||ci!==0)&&(ui=(this.wrap(n[0]-ai)*this.kx*li+(n[1]-oi)*this.ky*ci)/(li*li+ci*ci),ui>1?(ai=e[si+1][0],oi=e[si+1][1]):ui>0&&(ai+=li/this.kx*ui,oi+=ci/this.ky*ui)),li=this.wrap(n[0]-ai)*this.kx,ci=(n[1]-oi)*this.ky;const di=li*li+ci*ci;di<ei&&(ei=di,ti=ai,ii=oi,ri=si,ni=ui)}return{point:[ti,ii],index:ri,t:Math.max(0,Math.min(1,ni))}}wrap(e){for(;e<-180;)e+=360;for(;e>180;)e-=360;return e}}const MinPointsSize=100,MinLinePointsSize=50;function compareDistPair(_t,e){return e[0]-_t[0]}function getRangeSize(_t){return _t[1]-_t[0]+1}function isRangeSafe(_t,e){return _t[1]>=_t[0]&&_t[1]<e}function splitRange(_t,e){if(_t[0]>_t[1])return[null,null];const n=getRangeSize(_t);if(e){if(n===2)return[_t,null];const ti=Math.floor(n/2);return[[_t[0],_t[0]+ti],[_t[0]+ti,_t[1]]]}if(n===1)return[_t,null];const ei=Math.floor(n/2)-1;return[[_t[0],_t[0]+ei],[_t[0]+ei+1,_t[1]]]}function getBBox(_t,e){if(!isRangeSafe(e,_t.length))return[1/0,1/0,-1/0,-1/0];const n=[1/0,1/0,-1/0,-1/0];for(let ei=e[0];ei<=e[1];++ei)updateBBox(n,_t[ei]);return n}function getPolygonBBox(_t){const e=[1/0,1/0,-1/0,-1/0];for(const n of _t)for(const ei of n)updateBBox(e,ei);return e}function isValidBBox(_t){return _t[0]!==-1/0&&_t[1]!==-1/0&&_t[2]!==1/0&&_t[3]!==1/0}function bboxToBBoxDistance(_t,e,n){if(!isValidBBox(_t)||!isValidBBox(e))return NaN;let ei=0,ti=0;return _t[2]<e[0]&&(ei=e[0]-_t[2]),_t[0]>e[2]&&(ei=_t[0]-e[2]),_t[1]>e[3]&&(ti=_t[1]-e[3]),_t[3]<e[1]&&(ti=e[1]-_t[3]),n.distance([0,0],[ei,ti])}function pointToLineDistance(_t,e,n){const ei=n.pointOnLine(e,_t);return n.distance(_t,ei.point)}function segmentToSegmentDistance(_t,e,n,ei,ti){const ii=Math.min(pointToLineDistance(_t,[n,ei],ti),pointToLineDistance(e,[n,ei],ti)),ri=Math.min(pointToLineDistance(n,[_t,e],ti),pointToLineDistance(ei,[_t,e],ti));return Math.min(ii,ri)}function lineToLineDistance(_t,e,n,ei,ti){if(!(isRangeSafe(e,_t.length)&&isRangeSafe(ei,n.length)))return 1/0;let ri=1/0;for(let ni=e[0];ni<e[1];++ni){const si=_t[ni],ai=_t[ni+1];for(let oi=ei[0];oi<ei[1];++oi){const li=n[oi],ci=n[oi+1];if(segmentIntersectSegment(si,ai,li,ci))return 0;ri=Math.min(ri,segmentToSegmentDistance(si,ai,li,ci,ti))}}return ri}function pointsToPointsDistance(_t,e,n,ei,ti){if(!(isRangeSafe(e,_t.length)&&isRangeSafe(ei,n.length)))return NaN;let ri=1/0;for(let ni=e[0];ni<=e[1];++ni)for(let si=ei[0];si<=ei[1];++si)if(ri=Math.min(ri,ti.distance(_t[ni],n[si])),ri===0)return ri;return ri}function pointToPolygonDistance(_t,e,n){if(pointWithinPolygon(_t,e,!0))return 0;let ei=1/0;for(const ti of e){const ii=ti[0],ri=ti[ti.length-1];if(ii!==ri&&(ei=Math.min(ei,pointToLineDistance(_t,[ri,ii],n)),ei===0))return ei;const ni=n.pointOnLine(ti,_t);if(ei=Math.min(ei,n.distance(_t,ni.point)),ei===0)return ei}return ei}function lineToPolygonDistance(_t,e,n,ei){if(!isRangeSafe(e,_t.length))return NaN;for(let ii=e[0];ii<=e[1];++ii)if(pointWithinPolygon(_t[ii],n,!0))return 0;let ti=1/0;for(let ii=e[0];ii<e[1];++ii){const ri=_t[ii],ni=_t[ii+1];for(const si of n)for(let ai=0,oi=si.length,li=oi-1;ai<oi;li=ai++){const ci=si[li],ui=si[ai];if(segmentIntersectSegment(ri,ni,ci,ui))return 0;ti=Math.min(ti,segmentToSegmentDistance(ri,ni,ci,ui,ei))}}return ti}function polygonIntersect(_t,e){for(const n of _t)for(const ei of n)if(pointWithinPolygon(ei,e,!0))return!0;return!1}function polygonToPolygonDistance(_t,e,n,ei=1/0){const ti=getPolygonBBox(_t),ii=getPolygonBBox(e);if(ei!==1/0&&bboxToBBoxDistance(ti,ii,n)>=ei)return ei;if(boxWithinBox(ti,ii)){if(polygonIntersect(_t,e))return 0}else if(polygonIntersect(e,_t))return 0;let ri=1/0;for(const ni of _t)for(let si=0,ai=ni.length,oi=ai-1;si<ai;oi=si++){const li=ni[oi],ci=ni[si];for(const ui of e)for(let di=0,fi=ui.length,hi=fi-1;di<fi;hi=di++){const pi=ui[hi],gi=ui[di];if(segmentIntersectSegment(li,ci,pi,gi))return 0;ri=Math.min(ri,segmentToSegmentDistance(li,ci,pi,gi,n))}}return ri}function updateQueue(_t,e,n,ei,ti,ii){if(!ii)return;const ri=bboxToBBoxDistance(getBBox(ei,ii),ti,n);ri<e&&_t.push([ri,ii,[0,0]])}function updateQueueTwoSets(_t,e,n,ei,ti,ii,ri){if(!ii||!ri)return;const ni=bboxToBBoxDistance(getBBox(ei,ii),getBBox(ti,ri),n);ni<e&&_t.push([ni,ii,ri])}function pointsToPolygonDistance(_t,e,n,ei,ti=1/0){let ii=Math.min(ei.distance(_t[0],n[0][0]),ti);if(ii===0)return ii;const ri=new TinyQueue([[0,[0,_t.length-1],[0,0]]],compareDistPair),ni=getPolygonBBox(n);for(;ri.length>0;){const si=ri.pop();if(si[0]>=ii)continue;const ai=si[1],oi=e?MinLinePointsSize:MinPointsSize;if(getRangeSize(ai)<=oi){if(!isRangeSafe(ai,_t.length))return NaN;if(e){const li=lineToPolygonDistance(_t,ai,n,ei);if(isNaN(li)||li===0)return li;ii=Math.min(ii,li)}else for(let li=ai[0];li<=ai[1];++li){const ci=pointToPolygonDistance(_t[li],n,ei);if(ii=Math.min(ii,ci),ii===0)return 0}}else{const li=splitRange(ai,e);updateQueue(ri,ii,ei,_t,ni,li[0]),updateQueue(ri,ii,ei,_t,ni,li[1])}}return ii}function pointSetToPointSetDistance(_t,e,n,ei,ti,ii=1/0){let ri=Math.min(ii,ti.distance(_t[0],n[0]));if(ri===0)return ri;const ni=new TinyQueue([[0,[0,_t.length-1],[0,n.length-1]]],compareDistPair);for(;ni.length>0;){const si=ni.pop();if(si[0]>=ri)continue;const ai=si[1],oi=si[2],li=e?MinLinePointsSize:MinPointsSize,ci=ei?MinLinePointsSize:MinPointsSize;if(getRangeSize(ai)<=li&&getRangeSize(oi)<=ci){if(!isRangeSafe(ai,_t.length)&&isRangeSafe(oi,n.length))return NaN;let ui;if(e&&ei)ui=lineToLineDistance(_t,ai,n,oi,ti),ri=Math.min(ri,ui);else if(e&&!ei){const di=_t.slice(ai[0],ai[1]+1);for(let fi=oi[0];fi<=oi[1];++fi)if(ui=pointToLineDistance(n[fi],di,ti),ri=Math.min(ri,ui),ri===0)return ri}else if(!e&&ei){const di=n.slice(oi[0],oi[1]+1);for(let fi=ai[0];fi<=ai[1];++fi)if(ui=pointToLineDistance(_t[fi],di,ti),ri=Math.min(ri,ui),ri===0)return ri}else ui=pointsToPointsDistance(_t,ai,n,oi,ti),ri=Math.min(ri,ui)}else{const ui=splitRange(ai,e),di=splitRange(oi,ei);updateQueueTwoSets(ni,ri,ti,_t,n,ui[0],di[0]),updateQueueTwoSets(ni,ri,ti,_t,n,ui[0],di[1]),updateQueueTwoSets(ni,ri,ti,_t,n,ui[1],di[0]),updateQueueTwoSets(ni,ri,ti,_t,n,ui[1],di[1])}}return ri}function pointToGeometryDistance(_t,e){const n=_t.geometry(),ei=n.flat().map(ri=>getLngLatFromTileCoord([ri.x,ri.y],_t.canonical));if(n.length===0)return NaN;const ti=new CheapRuler(ei[0][1]);let ii=1/0;for(const ri of e){switch(ri.type){case"Point":ii=Math.min(ii,pointSetToPointSetDistance(ei,!1,[ri.coordinates],!1,ti,ii));break;case"LineString":ii=Math.min(ii,pointSetToPointSetDistance(ei,!1,ri.coordinates,!0,ti,ii));break;case"Polygon":ii=Math.min(ii,pointsToPolygonDistance(ei,!1,ri.coordinates,ti,ii));break}if(ii===0)return ii}return ii}function lineStringToGeometryDistance(_t,e){const n=_t.geometry(),ei=n.flat().map(ri=>getLngLatFromTileCoord([ri.x,ri.y],_t.canonical));if(n.length===0)return NaN;const ti=new CheapRuler(ei[0][1]);let ii=1/0;for(const ri of e){switch(ri.type){case"Point":ii=Math.min(ii,pointSetToPointSetDistance(ei,!0,[ri.coordinates],!1,ti,ii));break;case"LineString":ii=Math.min(ii,pointSetToPointSetDistance(ei,!0,ri.coordinates,!0,ti,ii));break;case"Polygon":ii=Math.min(ii,pointsToPolygonDistance(ei,!0,ri.coordinates,ti,ii));break}if(ii===0)return ii}return ii}function polygonToGeometryDistance(_t,e){const n=_t.geometry();if(n.length===0||n[0].length===0)return NaN;const ei=classifyRings(n).map(ri=>ri.map(ni=>ni.map(si=>getLngLatFromTileCoord([si.x,si.y],_t.canonical)))),ti=new CheapRuler(ei[0][0][0][1]);let ii=1/0;for(const ri of e)for(const ni of ei){switch(ri.type){case"Point":ii=Math.min(ii,pointsToPolygonDistance([ri.coordinates],!1,ni,ti,ii));break;case"LineString":ii=Math.min(ii,pointsToPolygonDistance(ri.coordinates,!0,ni,ti,ii));break;case"Polygon":ii=Math.min(ii,polygonToPolygonDistance(ni,ri.coordinates,ti,ii));break}if(ii===0)return ii}return ii}function toSimpleGeometry(_t){return _t.type==="MultiPolygon"?_t.coordinates.map(e=>({type:"Polygon",coordinates:e})):_t.type==="MultiLineString"?_t.coordinates.map(e=>({type:"LineString",coordinates:e})):_t.type==="MultiPoint"?_t.coordinates.map(e=>({type:"Point",coordinates:e})):[_t]}class Distance{constructor(e,n){this.type=NumberType,this.geojson=e,this.geometries=n}static parse(e,n){if(e.length!==2)return n.error(`'distance' expression requires exactly one argument, but found ${e.length-1} instead.`);if(isValue(e[1])){const ei=e[1];if(ei.type==="FeatureCollection")return new Distance(ei,ei.features.map(ti=>toSimpleGeometry(ti.geometry)).flat());if(ei.type==="Feature")return new Distance(ei,toSimpleGeometry(ei.geometry));if("type"in ei&&"coordinates"in ei)return new Distance(ei,toSimpleGeometry(ei))}return n.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return pointToGeometryDistance(e,this.geometries);if(e.geometryType()==="LineString")return lineStringToGeometryDistance(e,this.geometries);if(e.geometryType()==="Polygon")return polygonToGeometryDistance(e,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class GlobalState{constructor(e){this.type=ValueType,this.key=e}static parse(e,n){if(e.length!==2)return n.error(`Expected 1 argument, but found ${e.length-1} instead.`);const ei=e[1];return ei==null?n.error("Global state property must be defined."):typeof ei!="string"?n.error(`Global state property must be string, but found ${typeof e[1]} instead.`):new GlobalState(ei)}evaluate(e){var n;const ei=(n=e.globals)===null||n===void 0?void 0:n.globalState;return!ei||Object.keys(ei).length===0?null:getOwn(ei,this.key)}eachChild(){}outputDefined(){return!1}}const expressions$1={"==":Equals,"!=":NotEquals,">":GreaterThan,"<":LessThan,">=":GreaterThanOrEqual,"<=":LessThanOrEqual,array:Assertion,at:At$1,boolean:Assertion,case:Case,coalesce:Coalesce,collator:CollatorExpression,format:FormatExpression,image:ImageExpression,in:In,"index-of":IndexOf,interpolate:Interpolate,"interpolate-hcl":Interpolate,"interpolate-lab":Interpolate,length:Length,let:Let,literal:Literal,match:Match,number:Assertion,"number-format":NumberFormat,object:Assertion,slice:Slice,step:Step,string:Assertion,"to-boolean":Coercion,"to-color":Coercion,"to-number":Coercion,"to-string":Coercion,var:Var,within:Within,distance:Distance,"global-state":GlobalState};class CompoundExpression{constructor(e,n,ei,ti){this.name=e,this.type=n,this._evaluate=ei,this.args=ti}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,n){const ei=e[0],ti=CompoundExpression.definitions[ei];if(!ti)return n.error(`Unknown expression "${ei}". If you wanted a literal array, use ["literal", [...]].`,0);const ii=Array.isArray(ti)?ti[0]:ti.type,ri=Array.isArray(ti)?[[ti[1],ti[2]]]:ti.overloads,ni=ri.filter(([ai])=>!Array.isArray(ai)||ai.length===e.length-1);let si=null;for(const[ai,oi]of ni){si=new ParsingContext(n.registry,isExpressionConstant,n.path,null,n.scope);const li=[];let ci=!1;for(let ui=1;ui<e.length;ui++){const di=e[ui],fi=Array.isArray(ai)?ai[ui-1]:ai.type,hi=si.parse(di,1+li.length,fi);if(!hi){ci=!0;break}li.push(hi)}if(!ci){if(Array.isArray(ai)&&ai.length!==li.length){si.error(`Expected ${ai.length} arguments, but found ${li.length} instead.`);continue}for(let ui=0;ui<li.length;ui++){const di=Array.isArray(ai)?ai[ui]:ai.type,fi=li[ui];si.concat(ui+1).checkSubtype(di,fi.type)}if(si.errors.length===0)return new CompoundExpression(ei,ii,oi,li)}}if(ni.length===1)n.errors.push(...si.errors);else{const oi=(ni.length?ni:ri).map(([ci])=>stringifySignature(ci)).join(" | "),li=[];for(let ci=1;ci<e.length;ci++){const ui=n.parse(e[ci],1+li.length);if(!ui)return null;li.push(typeToString(ui.type))}n.error(`Expected arguments of type ${oi}, but found (${li.join(", ")}) instead.`)}return null}static register(e,n){CompoundExpression.definitions=n;for(const ei in n)e[ei]=CompoundExpression}}function rgba(_t,[e,n,ei,ti]){e=e.evaluate(_t),n=n.evaluate(_t),ei=ei.evaluate(_t);const ii=ti?ti.evaluate(_t):1,ri=validateRGBA(e,n,ei,ii);if(ri)throw new RuntimeError(ri);return new Color(e/255,n/255,ei/255,ii,!1)}function has(_t,e){return _t in e}function get$1(_t,e){const n=e[_t];return typeof n>"u"?null:n}function binarySearch(_t,e,n,ei){for(;n<=ei;){const ti=n+ei>>1;if(e[ti]===_t)return!0;e[ti]>_t?ei=ti-1:n=ti+1}return!1}function varargs(_t){return{type:_t}}CompoundExpression.register(expressions$1,{error:[ErrorType,[StringType],(_t,[e])=>{throw new RuntimeError(e.evaluate(_t))}],typeof:[StringType,[ValueType],(_t,[e])=>typeToString(typeOf(e.evaluate(_t)))],"to-rgba":[array(NumberType,4),[ColorType$1],(_t,[e])=>{const[n,ei,ti,ii]=e.evaluate(_t).rgb;return[n*255,ei*255,ti*255,ii]}],rgb:[ColorType$1,[NumberType,NumberType,NumberType],rgba],rgba:[ColorType$1,[NumberType,NumberType,NumberType,NumberType],rgba],has:{type:BooleanType,overloads:[[[StringType],(_t,[e])=>has(e.evaluate(_t),_t.properties())],[[StringType,ObjectType],(_t,[e,n])=>has(e.evaluate(_t),n.evaluate(_t))]]},get:{type:ValueType,overloads:[[[StringType],(_t,[e])=>get$1(e.evaluate(_t),_t.properties())],[[StringType,ObjectType],(_t,[e,n])=>get$1(e.evaluate(_t),n.evaluate(_t))]]},"feature-state":[ValueType,[StringType],(_t,[e])=>get$1(e.evaluate(_t),_t.featureState||{})],properties:[ObjectType,[],_t=>_t.properties()],"geometry-type":[StringType,[],_t=>_t.geometryType()],id:[ValueType,[],_t=>_t.id()],zoom:[NumberType,[],_t=>_t.globals.zoom],"heatmap-density":[NumberType,[],_t=>_t.globals.heatmapDensity||0],elevation:[NumberType,[],_t=>_t.globals.elevation||0],"line-progress":[NumberType,[],_t=>_t.globals.lineProgress||0],accumulated:[ValueType,[],_t=>_t.globals.accumulated===void 0?null:_t.globals.accumulated],"+":[NumberType,varargs(NumberType),(_t,e)=>{let n=0;for(const ei of e)n+=ei.evaluate(_t);return n}],"*":[NumberType,varargs(NumberType),(_t,e)=>{let n=1;for(const ei of e)n*=ei.evaluate(_t);return n}],"-":{type:NumberType,overloads:[[[NumberType,NumberType],(_t,[e,n])=>e.evaluate(_t)-n.evaluate(_t)],[[NumberType],(_t,[e])=>-e.evaluate(_t)]]},"/":[NumberType,[NumberType,NumberType],(_t,[e,n])=>e.evaluate(_t)/n.evaluate(_t)],"%":[NumberType,[NumberType,NumberType],(_t,[e,n])=>e.evaluate(_t)%n.evaluate(_t)],ln2:[NumberType,[],()=>Math.LN2],pi:[NumberType,[],()=>Math.PI],e:[NumberType,[],()=>Math.E],"^":[NumberType,[NumberType,NumberType],(_t,[e,n])=>Math.pow(e.evaluate(_t),n.evaluate(_t))],sqrt:[NumberType,[NumberType],(_t,[e])=>Math.sqrt(e.evaluate(_t))],log10:[NumberType,[NumberType],(_t,[e])=>Math.log(e.evaluate(_t))/Math.LN10],ln:[NumberType,[NumberType],(_t,[e])=>Math.log(e.evaluate(_t))],log2:[NumberType,[NumberType],(_t,[e])=>Math.log(e.evaluate(_t))/Math.LN2],sin:[NumberType,[NumberType],(_t,[e])=>Math.sin(e.evaluate(_t))],cos:[NumberType,[NumberType],(_t,[e])=>Math.cos(e.evaluate(_t))],tan:[NumberType,[NumberType],(_t,[e])=>Math.tan(e.evaluate(_t))],asin:[NumberType,[NumberType],(_t,[e])=>Math.asin(e.evaluate(_t))],acos:[NumberType,[NumberType],(_t,[e])=>Math.acos(e.evaluate(_t))],atan:[NumberType,[NumberType],(_t,[e])=>Math.atan(e.evaluate(_t))],min:[NumberType,varargs(NumberType),(_t,e)=>Math.min(...e.map(n=>n.evaluate(_t)))],max:[NumberType,varargs(NumberType),(_t,e)=>Math.max(...e.map(n=>n.evaluate(_t)))],abs:[NumberType,[NumberType],(_t,[e])=>Math.abs(e.evaluate(_t))],round:[NumberType,[NumberType],(_t,[e])=>{const n=e.evaluate(_t);return n<0?-Math.round(-n):Math.round(n)}],floor:[NumberType,[NumberType],(_t,[e])=>Math.floor(e.evaluate(_t))],ceil:[NumberType,[NumberType],(_t,[e])=>Math.ceil(e.evaluate(_t))],"filter-==":[BooleanType,[StringType,ValueType],(_t,[e,n])=>_t.properties()[e.value]===n.value],"filter-id-==":[BooleanType,[ValueType],(_t,[e])=>_t.id()===e.value],"filter-type-==":[BooleanType,[StringType],(_t,[e])=>_t.geometryType()===e.value],"filter-<":[BooleanType,[StringType,ValueType],(_t,[e,n])=>{const ei=_t.properties()[e.value],ti=n.value;return typeof ei==typeof ti&&ei<ti}],"filter-id-<":[BooleanType,[ValueType],(_t,[e])=>{const n=_t.id(),ei=e.value;return typeof n==typeof ei&&n<ei}],"filter->":[BooleanType,[StringType,ValueType],(_t,[e,n])=>{const ei=_t.properties()[e.value],ti=n.value;return typeof ei==typeof ti&&ei>ti}],"filter-id->":[BooleanType,[ValueType],(_t,[e])=>{const n=_t.id(),ei=e.value;return typeof n==typeof ei&&n>ei}],"filter-<=":[BooleanType,[StringType,ValueType],(_t,[e,n])=>{const ei=_t.properties()[e.value],ti=n.value;return typeof ei==typeof ti&&ei<=ti}],"filter-id-<=":[BooleanType,[ValueType],(_t,[e])=>{const n=_t.id(),ei=e.value;return typeof n==typeof ei&&n<=ei}],"filter->=":[BooleanType,[StringType,ValueType],(_t,[e,n])=>{const ei=_t.properties()[e.value],ti=n.value;return typeof ei==typeof ti&&ei>=ti}],"filter-id->=":[BooleanType,[ValueType],(_t,[e])=>{const n=_t.id(),ei=e.value;return typeof n==typeof ei&&n>=ei}],"filter-has":[BooleanType,[ValueType],(_t,[e])=>e.value in _t.properties()],"filter-has-id":[BooleanType,[],_t=>_t.id()!==null&&_t.id()!==void 0],"filter-type-in":[BooleanType,[array(StringType)],(_t,[e])=>e.value.indexOf(_t.geometryType())>=0],"filter-id-in":[BooleanType,[array(ValueType)],(_t,[e])=>e.value.indexOf(_t.id())>=0],"filter-in-small":[BooleanType,[StringType,array(ValueType)],(_t,[e,n])=>n.value.indexOf(_t.properties()[e.value])>=0],"filter-in-large":[BooleanType,[StringType,array(ValueType)],(_t,[e,n])=>binarySearch(_t.properties()[e.value],n.value,0,n.value.length-1)],all:{type:BooleanType,overloads:[[[BooleanType,BooleanType],(_t,[e,n])=>e.evaluate(_t)&&n.evaluate(_t)],[varargs(BooleanType),(_t,e)=>{for(const n of e)if(!n.evaluate(_t))return!1;return!0}]]},any:{type:BooleanType,overloads:[[[BooleanType,BooleanType],(_t,[e,n])=>e.evaluate(_t)||n.evaluate(_t)],[varargs(BooleanType),(_t,e)=>{for(const n of e)if(n.evaluate(_t))return!0;return!1}]]},"!":[BooleanType,[BooleanType],(_t,[e])=>!e.evaluate(_t)],"is-supported-script":[BooleanType,[StringType],(_t,[e])=>{const n=_t.globals&&_t.globals.isSupportedScript;return n?n(e.evaluate(_t)):!0}],upcase:[StringType,[StringType],(_t,[e])=>e.evaluate(_t).toUpperCase()],downcase:[StringType,[StringType],(_t,[e])=>e.evaluate(_t).toLowerCase()],concat:[StringType,varargs(ValueType),(_t,e)=>e.map(n=>valueToString(n.evaluate(_t))).join("")],"resolved-locale":[StringType,[CollatorType],(_t,[e])=>e.evaluate(_t).resolvedLocale()]});function stringifySignature(_t){return Array.isArray(_t)?`(${_t.map(typeToString).join(", ")})`:`(${typeToString(_t.type)}...)`}function isExpressionConstant(_t){if(_t instanceof Var)return isExpressionConstant(_t.boundExpression);if(_t instanceof CompoundExpression&&_t.name==="error")return!1;if(_t instanceof CollatorExpression)return!1;if(_t instanceof Within)return!1;if(_t instanceof Distance)return!1;if(_t instanceof GlobalState)return!1;const e=_t instanceof Coercion||_t instanceof Assertion;let n=!0;return _t.eachChild(ei=>{e?n=n&&isExpressionConstant(ei):n=n&&ei instanceof Literal}),n?isFeatureConstant(_t)&&isGlobalPropertyConstant(_t,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"]):!1}function isFeatureConstant(_t){if(_t instanceof CompoundExpression){if(_t.name==="get"&&_t.args.length===1)return!1;if(_t.name==="feature-state")return!1;if(_t.name==="has"&&_t.args.length===1)return!1;if(_t.name==="properties"||_t.name==="geometry-type"||_t.name==="id")return!1;if(/^filter-/.test(_t.name))return!1}if(_t instanceof Within||_t instanceof Distance)return!1;let e=!0;return _t.eachChild(n=>{e&&!isFeatureConstant(n)&&(e=!1)}),e}function isStateConstant(_t){if(_t instanceof CompoundExpression&&_t.name==="feature-state")return!1;let e=!0;return _t.eachChild(n=>{e&&!isStateConstant(n)&&(e=!1)}),e}function isGlobalPropertyConstant(_t,e){if(_t instanceof CompoundExpression&&e.indexOf(_t.name)>=0)return!1;let n=!0;return _t.eachChild(ei=>{n&&!isGlobalPropertyConstant(ei,e)&&(n=!1)}),n}function success(_t){return{result:"success",value:_t}}function error(_t){return{result:"error",value:_t}}function supportsPropertyExpression(_t){return _t["property-type"]==="data-driven"||_t["property-type"]==="cross-faded-data-driven"}function supportsZoomExpression(_t){return!!_t.expression&&_t.expression.parameters.indexOf("zoom")>-1}function supportsInterpolation(_t){return!!_t.expression&&_t.expression.interpolated}function isFunction$1(_t){return typeof _t=="object"&&_t!==null&&!Array.isArray(_t)&&typeOf(_t)===ObjectType}class StyleExpression{constructor(e,n){this.expression=e,this._warningHistory={},this._evaluator=new EvaluationContext,this._defaultValue=n?getDefaultValue(n):null,this._enumValues=n&&n.type==="enum"?n.values:null}evaluateWithoutErrorHandling(e,n,ei,ti,ii,ri){return this._evaluator.globals=e,this._evaluator.feature=n,this._evaluator.featureState=ei,this._evaluator.canonical=ti,this._evaluator.availableImages=ii||null,this._evaluator.formattedSection=ri,this.expression.evaluate(this._evaluator)}evaluate(e,n,ei,ti,ii,ri){this._evaluator.globals=e,this._evaluator.feature=n||null,this._evaluator.featureState=ei||null,this._evaluator.canonical=ti,this._evaluator.availableImages=ii||null,this._evaluator.formattedSection=ri||null;try{const ni=this.expression.evaluate(this._evaluator);if(ni==null||typeof ni=="number"&&ni!==ni)return this._defaultValue;if(this._enumValues&&!(ni in this._enumValues))throw new RuntimeError(`Expected value to be one of ${Object.keys(this._enumValues).map(si=>JSON.stringify(si)).join(", ")}, but found ${JSON.stringify(ni)} instead.`);return ni}catch(ni){return this._warningHistory[ni.message]||(this._warningHistory[ni.message]=!0,typeof console<"u"&&console.warn(ni.message)),this._defaultValue}}}function isExpression(_t){return Array.isArray(_t)&&_t.length>0&&typeof _t[0]=="string"&&_t[0]in expressions$1}function createExpression(_t,e){const n=new ParsingContext(expressions$1,isExpressionConstant,[],e?getExpectedType(e):void 0),ei=n.parse(_t,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return ei?success(new StyleExpression(ei,e)):error(n.errors)}class ZoomConstantExpression{constructor(e,n){this.kind=e,this._styleExpression=n,this.isStateDependent=e!=="constant"&&!isStateConstant(n.expression),this.globalStateRefs=findGlobalStateRefs(n.expression)}evaluateWithoutErrorHandling(e,n,ei,ti,ii,ri){return this._styleExpression.evaluateWithoutErrorHandling(e,n,ei,ti,ii,ri)}evaluate(e,n,ei,ti,ii,ri){return this._styleExpression.evaluate(e,n,ei,ti,ii,ri)}}class ZoomDependentExpression{constructor(e,n,ei,ti){this.kind=e,this.zoomStops=ei,this._styleExpression=n,this.isStateDependent=e!=="camera"&&!isStateConstant(n.expression),this.globalStateRefs=findGlobalStateRefs(n.expression),this.interpolationType=ti}evaluateWithoutErrorHandling(e,n,ei,ti,ii,ri){return this._styleExpression.evaluateWithoutErrorHandling(e,n,ei,ti,ii,ri)}evaluate(e,n,ei,ti,ii,ri){return this._styleExpression.evaluate(e,n,ei,ti,ii,ri)}interpolationFactor(e,n,ei){return this.interpolationType?Interpolate.interpolationFactor(this.interpolationType,e,n,ei):0}}function createPropertyExpression(_t,e){const n=createExpression(_t,e);if(n.result==="error")return n;const ei=n.value.expression,ti=isFeatureConstant(ei);if(!ti&&!supportsPropertyExpression(e))return error([new ExpressionParsingError("","data expressions not supported")]);const ii=isGlobalPropertyConstant(ei,["zoom"]);if(!ii&&!supportsZoomExpression(e))return error([new ExpressionParsingError("","zoom expressions not supported")]);const ri=findZoomCurve(ei);if(!ri&&!ii)return error([new ExpressionParsingError("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(ri instanceof ExpressionParsingError)return error([ri]);if(ri instanceof Interpolate&&!supportsInterpolation(e))return error([new ExpressionParsingError("",'"interpolate" expressions cannot be used with this property')]);if(!ri)return success(ti?new ZoomConstantExpression("constant",n.value):new ZoomConstantExpression("source",n.value));const ni=ri instanceof Interpolate?ri.interpolation:void 0;return success(ti?new ZoomDependentExpression("camera",n.value,ri.labels,ni):new ZoomDependentExpression("composite",n.value,ri.labels,ni))}function findZoomCurve(_t){let e=null;if(_t instanceof Let)e=findZoomCurve(_t.result);else if(_t instanceof Coalesce){for(const n of _t.args)if(e=findZoomCurve(n),e)break}else(_t instanceof Step||_t instanceof Interpolate)&&_t.input instanceof CompoundExpression&&_t.input.name==="zoom"&&(e=_t);return e instanceof ExpressionParsingError||_t.eachChild(n=>{const ei=findZoomCurve(n);ei instanceof ExpressionParsingError?e=ei:!e&&ei?e=new ExpressionParsingError("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&ei&&e!==ei&&(e=new ExpressionParsingError("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}function findGlobalStateRefs(_t,e=new Set){return _t instanceof GlobalState&&e.add(_t.key),_t.eachChild(n=>{findGlobalStateRefs(n,e)}),e}function getExpectedType(_t){const e={color:ColorType$1,string:StringType,number:NumberType,enum:StringType,boolean:BooleanType,formatted:FormattedType,padding:PaddingType,numberArray:NumberArrayType,colorArray:ColorArrayType,projectionDefinition:ProjectionDefinitionType,resolvedImage:ResolvedImageType,variableAnchorOffsetCollection:VariableAnchorOffsetCollectionType};return _t.type==="array"?array(e[_t.value]||ValueType,_t.length):e[_t.type]}function getDefaultValue(_t){if(_t.type==="color"&&isFunction$1(_t.default))return new Color(0,0,0,0);switch(_t.type){case"color":return Color.parse(_t.default)||null;case"padding":return Padding.parse(_t.default)||null;case"numberArray":return NumberArray.parse(_t.default)||null;case"colorArray":return ColorArray.parse(_t.default)||null;case"variableAnchorOffsetCollection":return VariableAnchorOffsetCollection.parse(_t.default)||null;case"projectionDefinition":return ProjectionDefinition.parse(_t.default)||null;default:return _t.default===void 0?null:_t.default}}function isExpressionFilter(_t){if(_t===!0||_t===!1)return!0;if(!Array.isArray(_t)||_t.length===0)return!1;switch(_t[0]){case"has":return _t.length>=2&&_t[1]!=="$id"&&_t[1]!=="$type";case"in":return _t.length>=3&&(typeof _t[1]!="string"||Array.isArray(_t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return _t.length!==3||Array.isArray(_t[1])||Array.isArray(_t[2]);case"any":case"all":for(const e of _t.slice(1))if(!isExpressionFilter(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}const filterSpec={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function featureFilter(_t){if(_t==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};isExpressionFilter(_t)||(_t=convertFilter$1(_t));const e=createExpression(_t,filterSpec);if(e.result==="error")throw new Error(e.value.map(n=>`${n.key}: ${n.message}`).join(", "));{const n=geometryNeeded(_t);return{filter:(ei,ti,ii)=>e.value.evaluate(ei,ti,{},ii),needGeometry:n,getGlobalStateRefs:()=>findGlobalStateRefs(e.value.expression)}}}function compare(_t,e){return _t<e?-1:_t>e?1:0}function geometryNeeded(_t){if(!Array.isArray(_t))return!1;if(_t[0]==="within"||_t[0]==="distance")return!0;for(let e=1;e<_t.length;e++)if(geometryNeeded(_t[e]))return!0;return!1}function convertFilter$1(_t){if(!_t)return!0;const e=_t[0];return _t.length<=1?e!=="any":e==="=="?convertComparisonOp$1(_t[1],_t[2],"=="):e==="!="?convertNegation(convertComparisonOp$1(_t[1],_t[2],"==")):e==="<"||e===">"||e==="<="||e===">="?convertComparisonOp$1(_t[1],_t[2],e):e==="any"?convertDisjunctionOp(_t.slice(1)):e==="all"?["all"].concat(_t.slice(1).map(convertFilter$1)):e==="none"?["all"].concat(_t.slice(1).map(convertFilter$1).map(convertNegation)):e==="in"?convertInOp$1(_t[1],_t.slice(2)):e==="!in"?convertNegation(convertInOp$1(_t[1],_t.slice(2))):e==="has"?convertHasOp$1(_t[1]):e==="!has"?convertNegation(convertHasOp$1(_t[1])):!0}function convertComparisonOp$1(_t,e,n){switch(_t){case"$type":return[`filter-type-${n}`,e];case"$id":return[`filter-id-${n}`,e];default:return[`filter-${n}`,_t,e]}}function convertDisjunctionOp(_t){return["any"].concat(_t.map(convertFilter$1))}function convertInOp$1(_t,e){if(e.length===0)return!1;switch(_t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(n=>typeof n!=typeof e[0])?["filter-in-large",_t,["literal",e.sort(compare)]]:["filter-in-small",_t,["literal",e]]}}function convertHasOp$1(_t){switch(_t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",_t]}}function convertNegation(_t){return["!",_t]}function convertLiteral(_t){return typeof _t=="object"?["literal",_t]:_t}function convertFunction(_t,e){let n=_t.stops;if(!n)return convertIdentityFunction(_t,e);const ei=n&&typeof n[0][0]=="object",ti=ei||_t.property!==void 0,ii=ei||!ti;return n=n.map(ri=>!ti&&e.tokens&&typeof ri[1]=="string"?[ri[0],convertTokenString(ri[1])]:[ri[0],convertLiteral(ri[1])]),ei?convertZoomAndPropertyFunction(_t,e,n):ii?convertZoomFunction(_t,e,n):convertPropertyFunction(_t,e,n)}function convertIdentityFunction(_t,e){const n=["get",_t.property];if(_t.default===void 0)return e.type==="string"?["string",n]:n;if(e.type==="enum")return["match",n,Object.keys(e.values),n,_t.default];{const ei=[e.type==="color"?"to-color":e.type,n,convertLiteral(_t.default)];return e.type==="array"&&ei.splice(1,0,e.value,e.length||null),ei}}function getInterpolateOperator(_t){switch(_t.colorSpace){case"hcl":return"interpolate-hcl";case"lab":return"interpolate-lab";default:return"interpolate"}}function convertZoomAndPropertyFunction(_t,e,n){const ei={},ti={},ii=[];for(let ni=0;ni<n.length;ni++){const si=n[ni],ai=si[0].zoom;ei[ai]===void 0&&(ei[ai]={zoom:ai,type:_t.type,property:_t.property,default:_t.default},ti[ai]=[],ii.push(ai)),ti[ai].push([si[0].value,si[1]])}if(getFunctionType({},e)==="exponential"){const ni=[getInterpolateOperator(_t),["linear"],["zoom"]];for(const si of ii){const ai=convertPropertyFunction(ei[si],e,ti[si]);appendStopPair(ni,si,ai,!1)}return ni}else{const ni=["step",["zoom"]];for(const si of ii){const ai=convertPropertyFunction(ei[si],e,ti[si]);appendStopPair(ni,si,ai,!0)}return fixupDegenerateStepCurve(ni),ni}}function coalesce(_t,e){if(_t!==void 0)return _t;if(e!==void 0)return e}function getFallback(_t,e){const n=convertLiteral(coalesce(_t.default,e.default));return n===void 0&&e.type==="resolvedImage"?"":n}function convertPropertyFunction(_t,e,n){const ei=getFunctionType(_t,e),ti=["get",_t.property];if(ei==="categorical"&&typeof n[0][0]=="boolean"){const ii=["case"];for(const ri of n)ii.push(["==",ti,ri[0]],ri[1]);return ii.push(getFallback(_t,e)),ii}else if(ei==="categorical"){const ii=["match",ti];for(const ri of n)appendStopPair(ii,ri[0],ri[1],!1);return ii.push(getFallback(_t,e)),ii}else if(ei==="interval"){const ii=["step",["number",ti]];for(const ri of n)appendStopPair(ii,ri[0],ri[1],!0);return fixupDegenerateStepCurve(ii),_t.default===void 0?ii:["case",["==",["typeof",ti],"number"],ii,convertLiteral(_t.default)]}else if(ei==="exponential"){const ii=_t.base!==void 0?_t.base:1,ri=[getInterpolateOperator(_t),ii===1?["linear"]:["exponential",ii],["number",ti]];for(const ni of n)appendStopPair(ri,ni[0],ni[1],!1);return _t.default===void 0?ri:["case",["==",["typeof",ti],"number"],ri,convertLiteral(_t.default)]}else throw new Error(`Unknown property function type ${ei}`)}function convertZoomFunction(_t,e,n,ei=["zoom"]){const ti=getFunctionType(_t,e);let ii,ri=!1;if(ti==="interval")ii=["step",ei],ri=!0;else if(ti==="exponential"){const ni=_t.base!==void 0?_t.base:1;ii=[getInterpolateOperator(_t),ni===1?["linear"]:["exponential",ni],ei]}else throw new Error(`Unknown zoom function type "${ti}"`);for(const ni of n)appendStopPair(ii,ni[0],ni[1],ri);return fixupDegenerateStepCurve(ii),ii}function fixupDegenerateStepCurve(_t){_t[0]==="step"&&_t.length===3&&(_t.push(0),_t.push(_t[3]))}function appendStopPair(_t,e,n,ei){_t.length>3&&e===_t[_t.length-2]||(ei&&_t.length===2||_t.push(e),_t.push(n))}function getFunctionType(_t,e){return _t.type?_t.type:e.expression.interpolated?"exponential":"interval"}function convertTokenString(_t){const e=["concat"],n=/{([^{}]+)}/g;let ei=0;for(let ti=n.exec(_t);ti!==null;ti=n.exec(_t)){const ii=_t.slice(ei,n.lastIndex-ti[0].length);ei=n.lastIndex,ii.length>0&&e.push(ii),e.push(["get",ti[1]])}if(e.length===1)return _t;if(ei<_t.length)e.push(_t.slice(ei));else if(e.length===2)return["to-string",e[1]];return e}const v8=v8Spec;var fontWeights={thin:100,hairline:100,"ultra-light":200,"extra-light":200,light:300,book:300,regular:400,normal:400,plain:400,roman:400,standard:400,medium:500,"semi-bold":600,"demi-bold":600,bold:700,"extra-bold":800,"ultra-bold":800,heavy:900,black:900,"heavy-black":900,fat:900,poster:900,"ultra-black":950,"extra-black":950},sp=" ",italicRE=/(italic|oblique)$/i,fontCache={};function mb2css(_t,e,n){var ei=fontCache[_t];if(!ei){Array.isArray(_t)||(_t=[_t]);for(var ti=400,ii="normal",ri=[],ni,si,ai=0,oi=_t.length;ai<oi;++ai){var li=_t[ai],ci=li.split(" "),ui=ci[ci.length-1].toLowerCase();ui=="normal"||ui=="italic"||ui=="oblique"?(ii=si?ii:ui,si=!0,ci.pop(),ui=ci[ci.length-1].toLowerCase()):italicRE.test(ui)&&(ui=ui.replace(italicRE,""),ii=si?ii:ci[ci.length-1].replace(ui,""),si=!0);for(var di in fontWeights){var fi=ci.length>1?ci[ci.length-2].toLowerCase():"";if(ui==di||ui==di.replace("-","")||fi+"-"+ui==di){ti=ni?ti:fontWeights[di],ci.pop(),fi&&di.startsWith(fi)&&ci.pop();break}}!ni&&typeof ui=="number"&&(ti=ui,ni=!0);var hi=ci.join(sp).replace("Klokantech Noto Sans","Noto Sans").replace("DIN Pro","Barlow").replace("Arial Unicode MS","Arial");hi.indexOf(sp)!==-1&&(hi='"'+hi+'"'),ri.push(hi)}ei=fontCache[_t]=[ii,ti,ri]}return ei[0]+sp+ei[1]+sp+e+"px"+(n?"/"+n:"")+sp+ei[2]}const PointerEventType={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown"};class MapBrowserEventHandler extends Target{constructor(e,n){super(e),this.map_=e,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=n===void 0?1:n,this.down_=null;const ei=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=ei,this.pointerdownListenerKey_=listen(ei,PointerEventType.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=listen(ei,PointerEventType.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(EventType.TOUCHMOVE,this.boundHandleTouchMove_,PASSIVE_EVENT_LISTENERS?{passive:!1}:!1)}emulateClick_(e){let n=new MapBrowserEvent(MapBrowserEventType.CLICK,this.map_,e);this.dispatchEvent(n),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,n=new MapBrowserEvent(MapBrowserEventType.DBLCLICK,this.map_,e),this.dispatchEvent(n)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const ei=new MapBrowserEvent(MapBrowserEventType.SINGLECLICK,this.map_,e);this.dispatchEvent(ei)},250)}updateActivePointers_(e){const n=e,ei=n.pointerId;if(n.type==MapBrowserEventType.POINTERUP||n.type==MapBrowserEventType.POINTERCANCEL){delete this.trackedTouches_[ei];for(const ti in this.trackedTouches_)if(this.trackedTouches_[ti].target!==n.target){delete this.trackedTouches_[ti];break}}else(n.type==MapBrowserEventType.POINTERDOWN||n.type==MapBrowserEventType.POINTERMOVE)&&(this.trackedTouches_[ei]=n);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(e){this.updateActivePointers_(e);const n=new MapBrowserEvent(MapBrowserEventType.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(n),this.emulateClicks_&&!n.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(unlistenByKey),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(e){return e.button===0}handlePointerDown_(e){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(e);const n=new MapBrowserEvent(MapBrowserEventType.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);if(this.dispatchEvent(n),this.down_=new PointerEvent(e.type,e),Object.defineProperty(this.down_,"target",{writable:!1,value:e.target}),this.dragListenerKeys_.length===0){const ei=this.map_.getOwnerDocument();this.dragListenerKeys_.push(listen(ei,MapBrowserEventType.POINTERMOVE,this.handlePointerMove_,this),listen(ei,MapBrowserEventType.POINTERUP,this.handlePointerUp_,this),listen(this.element_,MapBrowserEventType.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==ei&&this.dragListenerKeys_.push(listen(this.element_.getRootNode(),MapBrowserEventType.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;const n=new MapBrowserEvent(MapBrowserEventType.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(n)}}relayMoveEvent_(e){this.originalPointerMoveEvent_=e;const n=!!(this.down_&&this.isMoving_(e));this.dispatchEvent(new MapBrowserEvent(MapBrowserEventType.POINTERMOVE,this.map_,e,n))}handleTouchMove_(e){const n=this.originalPointerMoveEvent_;(!n||n.defaultPrevented)&&(typeof e.cancelable!="boolean"||e.cancelable===!0)&&e.preventDefault()}isMoving_(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(unlistenByKey(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(EventType.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(unlistenByKey(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(unlistenByKey),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const MapProperty={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"},DROP=1/0;class PriorityQueue{constructor(e,n){this.priorityFunction_=e,this.keyFunction_=n,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,clear$1(this.queuedElements_)}dequeue(){const e=this.elements_,n=this.priorities_,ei=e[0];e.length==1?(e.length=0,n.length=0):(e[0]=e.pop(),n[0]=n.pop(),this.siftUp_(0));const ti=this.keyFunction_(ei);return delete this.queuedElements_[ti],ei}enqueue(e){assert(!(this.keyFunction_(e)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const n=this.priorityFunction_(e);return n!=DROP?(this.elements_.push(e),this.priorities_.push(n),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(e){return e*2+1}getRightChildIndex_(e){return e*2+2}getParentIndex_(e){return e-1>>1}heapify_(){let e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)}isEmpty(){return this.elements_.length===0}isKeyQueued(e){return e in this.queuedElements_}isQueued(e){return this.isKeyQueued(this.keyFunction_(e))}siftUp_(e){const n=this.elements_,ei=this.priorities_,ti=n.length,ii=n[e],ri=ei[e],ni=e;for(;e<ti>>1;){const si=this.getLeftChildIndex_(e),ai=this.getRightChildIndex_(e),oi=ai<ti&&ei[ai]<ei[si]?ai:si;n[e]=n[oi],ei[e]=ei[oi],e=oi}n[e]=ii,ei[e]=ri,this.siftDown_(ni,e)}siftDown_(e,n){const ei=this.elements_,ti=this.priorities_,ii=ei[n],ri=ti[n];for(;n>e;){const ni=this.getParentIndex_(n);if(ti[ni]>ri)ei[n]=ei[ni],ti[n]=ti[ni],n=ni;else break}ei[n]=ii,ti[n]=ri}reprioritize(){const e=this.priorityFunction_,n=this.elements_,ei=this.priorities_;let ti=0;const ii=n.length;let ri,ni,si;for(ni=0;ni<ii;++ni)ri=n[ni],si=e(ri),si==DROP?delete this.queuedElements_[this.keyFunction_(ri)]:(ei[ti]=si,n[ti++]=ri);n.length=ti,ei.length=ti,this.heapify_()}}class TileQueue extends PriorityQueue{constructor(e,n){super(ei=>e.apply(null,ei),ei=>ei[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=n,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(e){const n=super.enqueue(e);return n&&e[0].addEventListener(EventType.CHANGE,this.boundHandleTileChange_),n}getTilesLoading(){return this.tilesLoading_}handleTileChange(e){const n=e.target,ei=n.getState();if(ei===TileState.LOADED||ei===TileState.ERROR||ei===TileState.EMPTY){ei!==TileState.ERROR&&n.removeEventListener(EventType.CHANGE,this.boundHandleTileChange_);const ti=n.getKey();ti in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[ti],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(e,n){let ei=0;for(;this.tilesLoading_<e&&ei<n&&this.getCount()>0;){const ti=this.dequeue()[0],ii=ti.getKey();ti.getState()===TileState.IDLE&&!(ii in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[ii]=!0,++this.tilesLoading_,++ei,ti.load())}}}function getTilePriority(_t,e,n,ei,ti){if(!_t||!(n in _t.wantedTiles)||!_t.wantedTiles[n][e.getKey()])return DROP;const ii=_t.viewState.center,ri=ei[0]-ii[0],ni=ei[1]-ii[1];return 65536*Math.log(ti)+Math.sqrt(ri*ri+ni*ni)/ti}class Attribution extends Control{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=e.collapsible!==void 0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=e.attributions;const n=e.className!==void 0?e.className:"ol-attribution",ei=e.tipLabel!==void 0?e.tipLabel:"Attributions",ti=e.expandClassName!==void 0?e.expandClassName:n+"-expand",ii=e.collapseLabel!==void 0?e.collapseLabel:"",ri=e.collapseClassName!==void 0?e.collapseClassName:n+"-collapse";typeof ii=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=ii,this.collapseLabel_.className=ri):this.collapseLabel_=ii;const ni=e.label!==void 0?e.label:"i";typeof ni=="string"?(this.label_=document.createElement("span"),this.label_.textContent=ni,this.label_.className=ti):this.label_=ni;const si=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=ei,this.toggleButton_.appendChild(si),this.toggleButton_.addEventListener(EventType.CLICK,this.handleClick_.bind(this),!1);const ai=n+" "+CLASS_UNSELECTABLE+" "+CLASS_CONTROL+(this.collapsed_&&this.collapsible_?" "+CLASS_COLLAPSED:"")+(this.collapsible_?"":" ol-uncollapsible"),oi=this.element;oi.className=ai,oi.appendChild(this.toggleButton_),oi.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(e){const n=this.getMap().getAllLayers(),ei=new Set(n.flatMap(ti=>ti.getAttributions(e)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(ti=>ei.add(ti)):ei.add(this.attributions_)),!this.overrideCollapsible_){const ti=!n.some(ii=>{var ri;return((ri=ii.getSource())==null?void 0:ri.getAttributionsCollapsible())===!1});this.setCollapsible(ti)}return Array.from(ei)}async updateElement_(e){if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const n=await Promise.all(this.collectSourceAttributions_(e).map(ti=>toPromise(()=>ti))),ei=n.length>0;if(this.renderedVisible_!=ei&&(this.element.style.display=ei?"":"none",this.renderedVisible_=ei),!equals(n,this.renderedAttributions_)){removeChildren(this.ulElement_);for(let ti=0,ii=n.length;ti<ii;++ti){const ri=document.createElement("li");ri.innerHTML=n[ti],this.ulElement_.appendChild(ri)}this.renderedAttributions_=n}}handleClick_(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(CLASS_COLLAPSED),this.collapsed_?replaceNode(this.collapseLabel_,this.label_):replaceNode(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(e){this.userCollapsed_=e,!(!this.collapsible_||this.collapsed_===e)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(e){this.updateElement_(e.frameState)}}class Rotate extends Control{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target});const n=e.className!==void 0?e.className:"ol-rotate",ei=e.label!==void 0?e.label:"",ti=e.compassClassName!==void 0?e.compassClassName:"ol-compass";this.label_=null,typeof ei=="string"?(this.label_=document.createElement("span"),this.label_.className=ti,this.label_.textContent=ei):(this.label_=ei,this.label_.classList.add(ti));const ii=e.tipLabel?e.tipLabel:"Reset rotation",ri=document.createElement("button");ri.className=n+"-reset",ri.setAttribute("type","button"),ri.title=ii,ri.appendChild(this.label_),ri.addEventListener(EventType.CLICK,this.handleClick_.bind(this),!1);const ni=n+" "+CLASS_UNSELECTABLE+" "+CLASS_CONTROL,si=this.element;si.className=ni,si.appendChild(ri),this.callResetNorth_=e.resetNorth?e.resetNorth:void 0,this.duration_=e.duration!==void 0?e.duration:250,this.autoHide_=e.autoHide!==void 0?e.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(CLASS_HIDDEN)}handleClick_(e){e.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const n=this.getMap().getView();if(!n)return;const ei=n.getRotation();ei!==void 0&&(this.duration_>0&&ei%(2*Math.PI)!==0?n.animate({rotation:0,duration:this.duration_,easing:easeOut}):n.setRotation(0))}render(e){const n=e.frameState;if(!n)return;const ei=n.viewState.rotation;if(ei!=this.rotation_){const ti="rotate("+ei+"rad)";if(this.autoHide_){const ii=this.element.classList.contains(CLASS_HIDDEN);!ii&&ei===0?this.element.classList.add(CLASS_HIDDEN):ii&&ei!==0&&this.element.classList.remove(CLASS_HIDDEN)}this.label_.style.transform=ti}this.rotation_=ei}}class Zoom extends Control{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target});const n=e.className!==void 0?e.className:"ol-zoom",ei=e.delta!==void 0?e.delta:1,ti=e.zoomInClassName!==void 0?e.zoomInClassName:n+"-in",ii=e.zoomOutClassName!==void 0?e.zoomOutClassName:n+"-out",ri=e.zoomInLabel!==void 0?e.zoomInLabel:"+",ni=e.zoomOutLabel!==void 0?e.zoomOutLabel:"",si=e.zoomInTipLabel!==void 0?e.zoomInTipLabel:"Zoom in",ai=e.zoomOutTipLabel!==void 0?e.zoomOutTipLabel:"Zoom out",oi=document.createElement("button");oi.className=ti,oi.setAttribute("type","button"),oi.title=si,oi.appendChild(typeof ri=="string"?document.createTextNode(ri):ri),oi.addEventListener(EventType.CLICK,this.handleClick_.bind(this,ei),!1);const li=document.createElement("button");li.className=ii,li.setAttribute("type","button"),li.title=ai,li.appendChild(typeof ni=="string"?document.createTextNode(ni):ni),li.addEventListener(EventType.CLICK,this.handleClick_.bind(this,-ei),!1);const ci=n+" "+CLASS_UNSELECTABLE+" "+CLASS_CONTROL,ui=this.element;ui.className=ci,ui.appendChild(oi),ui.appendChild(li),this.duration_=e.duration!==void 0?e.duration:250}handleClick_(e,n){n.preventDefault(),this.zoomByDelta_(e)}zoomByDelta_(e){const ei=this.getMap().getView();if(!ei)return;const ti=ei.getZoom();if(ti!==void 0){const ii=ei.getConstrainedZoom(ti+e);this.duration_>0?(ei.getAnimating()&&ei.cancelAnimations(),ei.animate({zoom:ii,duration:this.duration_,easing:easeOut})):ei.setZoom(ii)}}}function defaults$2(_t){_t=_t||{};const e=new Collection;return(_t.zoom!==void 0?_t.zoom:!0)&&e.push(new Zoom(_t.zoomOptions)),(_t.rotate!==void 0?_t.rotate:!0)&&e.push(new Rotate(_t.rotateOptions)),(_t.attribution!==void 0?_t.attribution:!0)&&e.push(new Attribution(_t.attributionOptions)),e}const GroupEventType={ADDLAYER:"addlayer",REMOVELAYER:"removelayer"};class GroupEvent extends BaseEvent{constructor(e,n){super(e),this.layer=n}}const Property$1={LAYERS:"layers"};class LayerGroup extends BaseLayer{constructor(e){e=e||{};const n=Object.assign({},e);delete n.layers;let ei=e.layers;super(n),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(Property$1.LAYERS,this.handleLayersChanged_),ei?Array.isArray(ei)?ei=new Collection(ei.slice(),{unique:!0}):assert(typeof ei.getArray=="function","Expected `layers` to be an array or a `Collection`"):ei=new Collection(void 0,{unique:!0}),this.setLayers(ei)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(unlistenByKey),this.layersListenerKeys_.length=0;const e=this.getLayers();this.layersListenerKeys_.push(listen(e,CollectionEventType.ADD,this.handleLayersAdd_,this),listen(e,CollectionEventType.REMOVE,this.handleLayersRemove_,this));for(const ei in this.listenerKeys_)this.listenerKeys_[ei].forEach(unlistenByKey);clear$1(this.listenerKeys_);const n=e.getArray();for(let ei=0,ti=n.length;ei<ti;ei++){const ii=n[ei];this.registerLayerListeners_(ii),this.dispatchEvent(new GroupEvent(GroupEventType.ADDLAYER,ii))}this.changed()}registerLayerListeners_(e){const n=[listen(e,ObjectEventType.PROPERTYCHANGE,this.handleLayerChange_,this),listen(e,EventType.CHANGE,this.handleLayerChange_,this)];e instanceof LayerGroup&&n.push(listen(e,GroupEventType.ADDLAYER,this.handleLayerGroupAdd_,this),listen(e,GroupEventType.REMOVELAYER,this.handleLayerGroupRemove_,this)),this.listenerKeys_[getUid(e)]=n}handleLayerGroupAdd_(e){this.dispatchEvent(new GroupEvent(GroupEventType.ADDLAYER,e.layer))}handleLayerGroupRemove_(e){this.dispatchEvent(new GroupEvent(GroupEventType.REMOVELAYER,e.layer))}handleLayersAdd_(e){const n=e.element;this.registerLayerListeners_(n),this.dispatchEvent(new GroupEvent(GroupEventType.ADDLAYER,n)),this.changed()}handleLayersRemove_(e){const n=e.element,ei=getUid(n);this.listenerKeys_[ei].forEach(unlistenByKey),delete this.listenerKeys_[ei],this.dispatchEvent(new GroupEvent(GroupEventType.REMOVELAYER,n)),this.changed()}getLayers(){return this.get(Property$1.LAYERS)}setLayers(e){const n=this.getLayers();if(n){const ei=n.getArray();for(let ti=0,ii=ei.length;ti<ii;++ti)this.dispatchEvent(new GroupEvent(GroupEventType.REMOVELAYER,ei[ti]))}this.set(Property$1.LAYERS,e)}getLayersArray(e){return e=e!==void 0?e:[],this.getLayers().forEach(function(n){n.getLayersArray(e)}),e}getLayerStatesArray(e){const n=e!==void 0?e:[],ei=n.length;this.getLayers().forEach(function(ri){ri.getLayerStatesArray(n)});const ti=this.getLayerState();let ii=ti.zIndex;!e&&ti.zIndex===void 0&&(ii=0);for(let ri=ei,ni=n.length;ri<ni;ri++){const si=n[ri];si.opacity*=ti.opacity,si.visible=si.visible&&ti.visible,si.maxResolution=Math.min(si.maxResolution,ti.maxResolution),si.minResolution=Math.max(si.minResolution,ti.minResolution),si.minZoom=Math.max(si.minZoom,ti.minZoom),si.maxZoom=Math.min(si.maxZoom,ti.maxZoom),ti.extent!==void 0&&(si.extent!==void 0?si.extent=getIntersection(si.extent,ti.extent):si.extent=ti.extent),si.zIndex===void 0&&(si.zIndex=ii)}return n}getSourceState(){return"ready"}}class MapRenderer extends Disposable{constructor(e){super(),this.map_=e}dispatchRenderEvent(e,n){abstract()}calculateMatrices2D(e){const n=e.viewState,ei=e.coordinateToPixelTransform,ti=e.pixelToCoordinateTransform;compose(ei,e.size[0]/2,e.size[1]/2,1/n.resolution,-1/n.resolution,-n.rotation,-n.center[0],-n.center[1]),makeInverse(ti,ei)}forEachFeatureAtCoordinate(e,n,ei,ti,ii,ri,ni,si){let ai;const oi=n.viewState;function li(yi,_i,Ai,Ei){return ii.call(ri,_i,yi?Ai:null,Ei)}const ci=oi.projection,ui=wrapX$1(e.slice(),ci),di=[[0,0]];if(ci.canWrapX()&&ti){const yi=ci.getExtent(),_i=getWidth(yi);di.push([-_i,0],[_i,0])}const fi=n.layerStatesArray,hi=fi.length,pi=[],gi=[];for(let yi=0;yi<di.length;yi++)for(let _i=hi-1;_i>=0;--_i){const Ai=fi[_i],Ei=Ai.layer;if(Ei.hasRenderer()&&inView(Ai,oi)&&ni.call(si,Ei)){const Si=Ei.getRenderer(),wi=Ei.getSource();if(Si&&wi){const Oi=wi.getWrapX()?ui:e,Ii=li.bind(null,Ai.managed);gi[0]=Oi[0]+di[yi][0],gi[1]=Oi[1]+di[yi][1],ai=Si.forEachFeatureAtCoordinate(gi,n,ei,Ii,pi)}if(ai)return ai}}if(pi.length===0)return;const vi=1/pi.length;return pi.forEach((yi,_i)=>yi.distanceSq+=_i*vi),pi.sort((yi,_i)=>yi.distanceSq-_i.distanceSq),pi.some(yi=>ai=yi.callback(yi.feature,yi.layer,yi.geometry)),ai}hasFeatureAtCoordinate(e,n,ei,ti,ii,ri){return this.forEachFeatureAtCoordinate(e,n,ei,ti,TRUE,this,ii,ri)!==void 0}getMap(){return this.map_}renderFrame(e){abstract()}scheduleExpireIconCache(e){shared.canExpireCache()&&e.postRenderFunctions.push(expireIconCache)}}function expireIconCache(_t,e){shared.expire()}class CompositeMapRenderer extends MapRenderer{constructor(e){super(e),this.fontChangeListenerKey_=listen(checkedFonts,ObjectEventType.PROPERTYCHANGE,e.redrawText,e),this.element_=WORKER_OFFSCREEN_CANVAS?createMockDiv():document.createElement("div");const n=this.element_.style;n.position="absolute",n.width="100%",n.height="100%",n.zIndex="0",this.element_.className=CLASS_UNSELECTABLE+" ol-layers";const ei=e.getViewport();ei&&ei.insertBefore(this.element_,ei.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(e,n){const ei=this.getMap();if(ei.hasListener(e)){const ti=new RenderEvent(e,void 0,n);ei.dispatchEvent(ti)}}disposeInternal(){unlistenByKey(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(e){if(!e){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(e),this.dispatchRenderEvent(RenderEventType.PRECOMPOSE,e);const n=e.layerStatesArray.sort((ai,oi)=>ai.zIndex-oi.zIndex);n.some(ai=>ai.layer instanceof BaseVectorLayer&&ai.layer.getDeclutter())&&(e.declutter={});const ti=e.viewState;this.children_.length=0;const ii=[];let ri=null;for(let ai=0,oi=n.length;ai<oi;++ai){const li=n[ai];e.layerIndex=ai;const ci=li.layer,ui=ci.getSourceState();if(!inView(li,ti)||ui!="ready"&&ui!="undefined"){ci.unrender();continue}const di=ci.render(e,ri);di&&(di!==ri&&(this.children_.push(di),ri=di),ii.push(li))}this.declutter(e,ii),replaceChildren(this.element_,this.children_);const si=this.getMap().getTargetElement();if(isCanvas(si)){const ai=si.getContext("2d");for(const oi of this.children_){const li=oi.firstElementChild||oi,ci=oi.style.backgroundColor;if(ci&&(!isCanvas(li)||li.width>0)&&(ai.fillStyle=ci,ai.fillRect(0,0,si.width,si.height)),isCanvas(li)&&li.width>0){const ui=oi.style.opacity||li.style.opacity;ai.globalAlpha=ui===""?1:Number(ui);const di=li.style.transform;if(di)ai.setTransform(...fromString$1(di));else{const fi=parseFloat(li.style.width)/li.width,hi=parseFloat(li.style.height)/li.height;ai.setTransform(fi,0,0,hi,0,0)}ai.drawImage(li,0,0)}}ai.globalAlpha=1,ai.setTransform(1,0,0,1,0,0)}this.dispatchRenderEvent(RenderEventType.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}declutter(e,n){if(e.declutter){for(let ei=n.length-1;ei>=0;--ei){const ti=n[ei],ii=ti.layer;ii.getDeclutter()&&ii.renderDeclutter(e,ti)}n.forEach(ei=>ei.layer.renderDeferred(e))}}}function removeLayerMapProperty(_t){if(_t instanceof Layer$1){_t.setMapInternal(null);return}_t instanceof LayerGroup&&_t.getLayers().forEach(removeLayerMapProperty)}function setLayerMapProperty(_t,e){if(_t instanceof Layer$1){_t.setMapInternal(e);return}if(_t instanceof LayerGroup){const n=_t.getLayers().getArray();for(let ei=0,ti=n.length;ei<ti;++ei)setLayerMapProperty(n[ei],e)}}let Map$1=class extends BaseObject{constructor(e){super(),e=e||{},this.on,this.once,this.un;const n=createOptionsInternal(e);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=e.maxTilesLoading!==void 0?e.maxTilesLoading:16,this.pixelRatio_=e.pixelRatio!==void 0?e.pixelRatio:DEVICE_PIXEL_RATIO,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=create(),this.pixelToCoordinateTransform_=create(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,WORKER_OFFSCREEN_CANVAS||(this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_)),this.mapBrowserEventHandler_=null,this.moveTolerance_=e.moveTolerance,this.keyboardEventTarget_=n.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,WORKER_OFFSCREEN_CANVAS||(this.resizeObserver_=new ResizeObserver(()=>this.updateSize())),this.controls=n.controls||(WORKER_OFFSCREEN_CANVAS?new Collection:defaults$2()),this.interactions=n.interactions||(WORKER_OFFSCREEN_CANVAS?new Collection:defaults$3({onFocusOnly:!0})),this.overlays_=n.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new TileQueue(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(MapProperty.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(MapProperty.VIEW,this.handleViewChanged_),this.addChangeListener(MapProperty.SIZE,this.handleSizeChanged_),this.addChangeListener(MapProperty.TARGET,this.handleTargetChanged_),this.setProperties(n.values);const ei=this;e.view&&!(e.view instanceof View)&&e.view.then(function(ti){ei.setView(new View(ti))}),this.controls.addEventListener(CollectionEventType.ADD,ti=>{ti.element.setMap(this)}),this.controls.addEventListener(CollectionEventType.REMOVE,ti=>{ti.element.setMap(null)}),this.interactions.addEventListener(CollectionEventType.ADD,ti=>{ti.element.setMap(this)}),this.interactions.addEventListener(CollectionEventType.REMOVE,ti=>{ti.element.setMap(null)}),this.overlays_.addEventListener(CollectionEventType.ADD,ti=>{this.addOverlayInternal_(ti.element)}),this.overlays_.addEventListener(CollectionEventType.REMOVE,ti=>{const ii=ti.element.getId();ii!==void 0&&delete this.overlayIdIndex_[ii.toString()],ti.element.setMap(null)}),this.controls.forEach(ti=>{ti.setMap(this)}),this.interactions.forEach(ti=>{ti.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(e){this.getControls().push(e)}addInteraction(e){this.getInteractions().push(e)}addLayer(e){this.getLayerGroup().getLayers().push(e)}handleLayerAdd_(e){setLayerMapProperty(e.layer,this)}addOverlay(e){this.getOverlays().push(e)}addOverlayInternal_(e){const n=e.getId();n!==void 0&&(this.overlayIdIndex_[n.toString()]=e),e.setMap(this)}disposeInternal(){var e;this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),(e=this.resizeObserver_)==null||e.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(e,n,ei){if(!this.frameState_||!this.renderer_)return;const ti=this.getCoordinateFromPixelInternal(e);ei=ei!==void 0?ei:{};const ii=ei.hitTolerance!==void 0?ei.hitTolerance:0,ri=ei.layerFilter!==void 0?ei.layerFilter:TRUE,ni=ei.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(ti,this.frameState_,ii,ni,n,null,ri,null)}getFeaturesAtPixel(e,n){const ei=[];return this.forEachFeatureAtPixel(e,function(ti){ei.push(ti)},n),ei}getAllLayers(){const e=[];function n(ei){ei.forEach(function(ti){ti instanceof LayerGroup?n(ti.getLayers()):e.push(ti)})}return n(this.getLayers()),e}hasFeatureAtPixel(e,n){if(!this.frameState_||!this.renderer_)return!1;const ei=this.getCoordinateFromPixelInternal(e);n=n!==void 0?n:{};const ti=n.layerFilter!==void 0?n.layerFilter:TRUE,ii=n.hitTolerance!==void 0?n.hitTolerance:0,ri=n.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(ei,this.frameState_,ii,ri,ti,null)}getEventCoordinate(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}getEventCoordinateInternal(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}getEventPixel(e){const ei=this.viewport_.getBoundingClientRect(),ti=this.getSize(),ii=ei.width/ti[0],ri=ei.height/ti[1],ni="changedTouches"in e?e.changedTouches[0]:e;return[(ni.clientX-ei.left)/ii,(ni.clientY-ei.top)/ri]}getTarget(){return this.get(MapProperty.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(e){return toUserCoordinate(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}getCoordinateFromPixelInternal(e){const n=this.frameState_;return n?apply(n.pixelToCoordinateTransform,e.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(e){const n=this.overlayIdIndex_[e.toString()];return n!==void 0?n:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(MapProperty.LAYERGROUP)}setLayers(e){const n=this.getLayerGroup();if(e instanceof Collection){n.setLayers(e);return}const ei=n.getLayers();ei.clear(),ei.extend(e)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const e=this.getLayerGroup().getLayerStatesArray();for(let n=0,ei=e.length;n<ei;++n){const ti=e[n];if(!ti.visible)continue;const ii=ti.layer.getRenderer();if(ii&&!ii.ready)return!0;const ri=ti.layer.getSource();if(ri&&ri.loading)return!0}return!1}getPixelFromCoordinate(e){const n=fromUserCoordinate(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(n)}getPixelFromCoordinateInternal(e){const n=this.frameState_;return n?apply(n.coordinateToPixelTransform,e.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(MapProperty.SIZE)}getView(){return this.get(MapProperty.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const e=this.getTargetElement();return e?e.ownerDocument:document}getTilePriority(e,n,ei,ti){return getTilePriority(this.frameState_,e,n,ei,ti)}handleBrowserEvent(e,n){n=n||e.type;const ei=new MapBrowserEvent(n,this,e);this.handleMapBrowserEvent(ei)}handleMapBrowserEvent(e){if(!this.frameState_)return;const n=e.originalEvent,ei=n.type;if(ei===PointerEventType.POINTERDOWN||ei===EventType.WHEEL||ei===EventType.KEYDOWN){const ti=this.getOwnerDocument(),ii=this.viewport_.getRootNode?this.viewport_.getRootNode():ti,ri=n.target,ni=ii instanceof ShadowRoot?ii.host===ri?ii.host.ownerDocument:ii:ii===ti?ti.documentElement:ii;if(this.overlayContainerStopEvent_.contains(ri)||!ni.contains(ri))return}if(e.frameState=this.frameState_,this.dispatchEvent(e)!==!1){const ti=this.getInteractions().getArray().slice();for(let ii=ti.length-1;ii>=0;ii--){const ri=ti[ii];if(ri.getMap()!==this||!ri.getActive()||!this.getTargetElement())continue;if(!ri.handleEvent(e)||e.propagationStopped)break}}}handlePostRender(){const e=this.frameState_,n=this.tileQueue_;if(!n.isEmpty()){let ti=this.maxTilesLoading_,ii=ti;if(e){const ri=e.viewHints;if(ri[ViewHint.ANIMATING]||ri[ViewHint.INTERACTING]){const ni=Date.now()-e.time>8;ti=ni?0:8,ii=ni?0:2}}n.getTilesLoading()<ti&&(n.reprioritize(),n.loadMoreTiles(ti,ii))}e&&this.renderer_&&!e.animate&&(this.renderComplete_?(this.hasListener(RenderEventType.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(RenderEventType.RENDERCOMPLETE,e),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new MapEvent(MapEventType.LOADEND,this,e)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new MapEvent(MapEventType.LOADSTART,this,e))));const ei=this.postRenderFunctions_;if(e)for(let ti=0,ii=ei.length;ti<ii;++ti)ei[ti](this,e);ei.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){var ei,ti;if(this.mapBrowserEventHandler_){for(let ii=0,ri=this.targetChangeHandlerKeys_.length;ii<ri;++ii)unlistenByKey(this.targetChangeHandlerKeys_[ii]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(EventType.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(EventType.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_&&!isCanvas(this.targetElement_)){(ei=this.resizeObserver_)==null||ei.unobserve(this.targetElement_);const ii=this.targetElement_.getRootNode();ii instanceof ShadowRoot&&this.resizeObserver_.unobserve(ii.host),this.setSize(void 0)}const e=this.getTarget(),n=typeof e=="string"?document.getElementById(e):e;if(this.targetElement_=n,!n)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{if(isCanvas(n)||n.appendChild(this.viewport_),this.renderer_||(this.renderer_=new CompositeMapRenderer(this)),!isCanvas(n)){this.mapBrowserEventHandler_=new MapBrowserEventHandler(this,this.moveTolerance_);for(const ri in MapBrowserEventType)this.mapBrowserEventHandler_.addEventListener(MapBrowserEventType[ri],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(EventType.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(EventType.WHEEL,this.boundHandleBrowserEvent_,PASSIVE_EVENT_LISTENERS?{passive:!1}:!1);let ii;if(this.keyboardEventTarget_)ii=this.keyboardEventTarget_;else{const ri=n.getRootNode();ii=ri instanceof ShadowRoot?ri.host:n}if(this.targetChangeHandlerKeys_=[listen(ii,EventType.KEYDOWN,this.handleBrowserEvent,this),listen(ii,EventType.KEYPRESS,this.handleBrowserEvent,this)],n instanceof HTMLElement){const ri=n.getRootNode();ri instanceof ShadowRoot&&this.resizeObserver_.observe(ri.host),(ti=this.resizeObserver_)==null||ti.observe(n)}}this.updateSize()}}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(unlistenByKey(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(unlistenByKey(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const e=this.getView();e&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=listen(e,ObjectEventType.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=listen(e,EventType.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(unlistenByKey),this.layerGroupPropertyListenerKeys_=null);const e=this.getLayerGroup();e&&(this.handleLayerAdd_(new GroupEvent("addlayer",e)),this.layerGroupPropertyListenerKeys_=[listen(e,ObjectEventType.PROPERTYCHANGE,this.render,this),listen(e,EventType.CHANGE,this.render,this),listen(e,"addlayer",this.handleLayerAdd_,this),listen(e,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;const e=this.frameState_.layerStatesArray;for(let n=0,ei=e.length;n<ei;++n){const ti=e[n].layer;ti.hasRenderer()&&ti.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(e){return this.getControls().remove(e)}removeInteraction(e){return this.getInteractions().remove(e)}removeLayer(e){return this.getLayerGroup().getLayers().remove(e)}handleLayerRemove_(e){removeLayerMapProperty(e.layer)}removeOverlay(e){return this.getOverlays().remove(e)}renderFrame_(e){const n=this.getSize(),ei=this.getView(),ti=this.frameState_;let ii=null;if(n!==void 0&&hasArea(n)&&ei&&ei.isDef()){const ri=ei.getHints(this.frameState_?this.frameState_.viewHints:void 0),ni=ei.getState();if(ii={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:getForViewAndSize(ni.center,ni.resolution,ni.rotation,n),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:n,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:ni,viewHints:ri,wantedTiles:{},mapId:getUid(this),renderTargets:{}},ni.nextCenter&&ni.nextResolution){const si=isNaN(ni.nextRotation)?ni.rotation:ni.nextRotation;ii.nextExtent=getForViewAndSize(ni.nextCenter,ni.nextResolution,si,n)}}this.frameState_=ii,this.renderer_.renderFrame(ii),ii&&(ii.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,ii.postRenderFunctions),ti&&(!this.previousExtent_||!isEmpty$1(this.previousExtent_)&&!equals$1(ii.extent,this.previousExtent_))&&(this.dispatchEvent(new MapEvent(MapEventType.MOVESTART,this,ti)),this.previousExtent_=createOrUpdateEmpty(this.previousExtent_)),this.previousExtent_&&!ii.viewHints[ViewHint.ANIMATING]&&!ii.viewHints[ViewHint.INTERACTING]&&!equals$1(ii.extent,this.previousExtent_)&&(this.dispatchEvent(new MapEvent(MapEventType.MOVEEND,this,ii)),clone$1(ii.extent,this.previousExtent_))),this.dispatchEvent(new MapEvent(MapEventType.POSTRENDER,this,ii)),this.renderComplete_=(this.hasListener(MapEventType.LOADSTART)||this.hasListener(MapEventType.LOADEND)||this.hasListener(RenderEventType.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(e){const n=this.getLayerGroup();n&&this.handleLayerRemove_(new GroupEvent("removelayer",n)),this.set(MapProperty.LAYERGROUP,e)}setSize(e){this.set(MapProperty.SIZE,e)}setTarget(e){this.set(MapProperty.TARGET,e)}setView(e){if(!e||e instanceof View){this.set(MapProperty.VIEW,e);return}this.set(MapProperty.VIEW,new View);const n=this;e.then(function(ei){n.setView(new View(ei))})}updateSize(){const e=this.getTargetElement();let n;if(e){let ti,ii;if(isCanvas(e))ti=e.width,ii=e.height;else{const ri=getComputedStyle(e);ti=e.offsetWidth-parseFloat(ri.borderLeftWidth)-parseFloat(ri.paddingLeft)-parseFloat(ri.paddingRight)-parseFloat(ri.borderRightWidth),ii=e.offsetHeight-parseFloat(ri.borderTopWidth)-parseFloat(ri.paddingTop)-parseFloat(ri.paddingBottom)-parseFloat(ri.borderBottomWidth)}!isNaN(ti)&&!isNaN(ii)&&(n=[Math.max(0,ti),Math.max(0,ii)],!hasArea(n)&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&warn("No map visible because the map container's width or height are 0."))}const ei=this.getSize();n&&(!ei||!equals(n,ei))&&(this.setSize(n),this.updateViewportSize_(n))}updateViewportSize_(e){const n=this.getView();n&&n.setViewportSize(e)}};function createOptionsInternal(_t){let e=null;_t.keyboardEventTarget!==void 0&&(e=typeof _t.keyboardEventTarget=="string"?document.getElementById(_t.keyboardEventTarget):_t.keyboardEventTarget);const n={},ei=_t.layers&&typeof _t.layers.getLayers=="function"?_t.layers:new LayerGroup({layers:_t.layers});n[MapProperty.LAYERGROUP]=ei,n[MapProperty.TARGET]=_t.target,n[MapProperty.VIEW]=_t.view instanceof View?_t.view:new View;let ti;_t.controls!==void 0&&(Array.isArray(_t.controls)?ti=new Collection(_t.controls.slice()):(assert(typeof _t.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),ti=_t.controls));let ii;_t.interactions!==void 0&&(Array.isArray(_t.interactions)?ii=new Collection(_t.interactions.slice()):(assert(typeof _t.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),ii=_t.interactions));let ri;return _t.overlays!==void 0?Array.isArray(_t.overlays)?ri=new Collection(_t.overlays.slice()):(assert(typeof _t.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),ri=_t.overlays):ri=new Collection,{controls:ti,interactions:ii,keyboardEventTarget:e,overlays:ri,values:n}}const Property={ACCURACY:"accuracy",ACCURACY_GEOMETRY:"accuracyGeometry",ALTITUDE:"altitude",ALTITUDE_ACCURACY:"altitudeAccuracy",HEADING:"heading",POSITION:"position",PROJECTION:"projection",SPEED:"speed",TRACKING:"tracking",TRACKING_OPTIONS:"trackingOptions"},GeolocationErrorType={ERROR:"error"};class GeolocationError extends BaseEvent{constructor(e){super(GeolocationErrorType.ERROR),this.code=e.code,this.message=e.message}}class Geolocation extends BaseObject{constructor(e){super(),this.on,this.once,this.un,e=e||{},this.position_=null,this.transform_=identityTransform,this.watchId_=void 0,this.addChangeListener(Property.PROJECTION,this.handleProjectionChanged_),this.addChangeListener(Property.TRACKING,this.handleTrackingChanged_),e.projection!==void 0&&this.setProjection(e.projection),e.trackingOptions!==void 0&&this.setTrackingOptions(e.trackingOptions),this.setTracking(e.tracking!==void 0?e.tracking:!1)}disposeInternal(){this.setTracking(!1),super.disposeInternal()}handleProjectionChanged_(){const e=this.getProjection();e&&(this.transform_=getTransformFromProjections(get$3("EPSG:4326"),e),this.position_&&this.set(Property.POSITION,this.transform_(this.position_)))}handleTrackingChanged_(){if("geolocation"in navigator){const e=this.getTracking();e&&this.watchId_===void 0?this.watchId_=navigator.geolocation.watchPosition(this.positionChange_.bind(this),this.positionError_.bind(this),this.getTrackingOptions()):!e&&this.watchId_!==void 0&&(navigator.geolocation.clearWatch(this.watchId_),this.watchId_=void 0)}}positionChange_(e){const n=e.coords;this.set(Property.ACCURACY,n.accuracy),this.set(Property.ALTITUDE,n.altitude===null?void 0:n.altitude),this.set(Property.ALTITUDE_ACCURACY,n.altitudeAccuracy===null?void 0:n.altitudeAccuracy),this.set(Property.HEADING,n.heading===null?void 0:toRadians(n.heading)),this.position_?(this.position_[0]=n.longitude,this.position_[1]=n.latitude):this.position_=[n.longitude,n.latitude];const ei=this.transform_(this.position_);this.set(Property.POSITION,ei.slice()),this.set(Property.SPEED,n.speed===null?void 0:n.speed);const ti=circular(this.position_,n.accuracy);ti.applyTransform(this.transform_),this.set(Property.ACCURACY_GEOMETRY,ti),this.changed()}positionError_(e){this.dispatchEvent(new GeolocationError(e))}getAccuracy(){return this.get(Property.ACCURACY)}getAccuracyGeometry(){return this.get(Property.ACCURACY_GEOMETRY)||null}getAltitude(){return this.get(Property.ALTITUDE)}getAltitudeAccuracy(){return this.get(Property.ALTITUDE_ACCURACY)}getHeading(){return this.get(Property.HEADING)}getPosition(){return this.get(Property.POSITION)}getProjection(){return this.get(Property.PROJECTION)}getSpeed(){return this.get(Property.SPEED)}getTracking(){return this.get(Property.TRACKING)}getTrackingOptions(){return this.get(Property.TRACKING_OPTIONS)}setProjection(e){this.set(Property.PROJECTION,get$3(e))}setTracking(e){this.set(Property.TRACKING,e)}setTrackingOptions(e){this.set(Property.TRACKING_OPTIONS,e)}}const mapboxBaseUrl="https://api.mapbox.com";function getMapboxPath(_t){const e="mapbox://";return _t.indexOf(e)!==0?"":_t.slice(e.length)}function normalizeSpriteDefinition(_t,e,n){if(typeof _t=="string")return[{id:"default",url:normalizeSpriteUrl(_t,e,n)}];for(const ei of _t)ei.url=normalizeSpriteUrl(ei.url,e,n);return _t}function normalizeSpriteUrl(_t,e,n){const ei=getMapboxPath(_t);if(!ei)return decodeURI(new URL(_t,n).href);const ti="sprites/";if(ei.indexOf(ti)!==0)throw new Error(`unexpected sprites url: ${_t}`);const ii=ei.slice(ti.length);return`${mapboxBaseUrl}/styles/v1/${ii}/sprite?access_token=${e}`}function normalizeStyleUrl(_t,e){const n=getMapboxPath(_t);if(!n)return decodeURI(new URL(_t,location.href).href);const ei="styles/";if(n.indexOf(ei)!==0)throw new Error(`unexpected style url: ${_t}`);const ti=n.slice(ei.length);return`${mapboxBaseUrl}/styles/v1/${ti}?&access_token=${e}`}const mapboxSubdomains=["a","b","c","d"];function normalizeSourceUrl(_t,e,n,ei){const ti=new URL(_t,ei||location.href),ii=getMapboxPath(_t);if(!ii)return e?(ti.searchParams.has(n)||ti.searchParams.set(n,e),[decodeURI(ti.href)]):[decodeURI(ti.href)];if(ii==="mapbox.satellite"){const ri=window.devicePixelRatio>=1.5?"@2x":"";return[`https://api.mapbox.com/v4/${ii}/{z}/{x}/{y}${ri}.webp?access_token=${e}`]}return mapboxSubdomains.map(ri=>`https://${ri}.tiles.mapbox.com/v4/${ii}/{z}/{x}/{y}.vector.pbf?access_token=${e}`)}const emptyObj=Object.freeze({}),functionCacheByStyleId={},filterCacheByStyleId={};let styleId=0;function getStyleId(_t){return _t.id||(_t.id=styleId++),_t.id}function getStyleFunctionKey(_t,e){return getStyleId(_t)+"."+getUid(e)}function getFunctionCache(_t){let e=functionCacheByStyleId[_t.id];return e||(e={},functionCacheByStyleId[getStyleId(_t)]=e),e}function getFilterCache(_t){let e=filterCacheByStyleId[_t.id];return e||(e={},filterCacheByStyleId[getStyleId(_t)]=e),e}function deg2rad(_t){return _t*Math.PI/180}const defaultResolutions=(function(){const _t=[];for(let e=78271.51696402048;_t.length<=24;e/=2)_t.push(e);return _t})();function createCanvas(_t,e){if(typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof OffscreenCanvas<"u")return new OffscreenCanvas(_t,e);const n=document.createElement("canvas");return n.width=_t,n.height=e,n}function getZoomForResolution(_t,e){let n=0;const ei=e.length;for(;n<ei;++n)if(e[n]<_t&&n+1<ei){const ii=e[n]/e[n+1];return n+Math.log(e[n]/_t)/Math.log(ii)}return ei-1}function getResolutionForZoom(_t,e){const n=Math.floor(_t),ei=Math.pow(2,_t-n);return e[n]/ei}const pendingRequests={};function fetchResource(_t,e,n={},ei){if(e in pendingRequests)return ei&&(ei.url=pendingRequests[e][0].url),pendingRequests[e][1];const ti=n.transformRequest&&n.transformRequest(e,_t)||e,ii=function(si){return delete pendingRequests[e],Promise.reject(new Error("Error fetching source "+e))},ri=function(si){return delete pendingRequests[e],si.ok?si.json():Promise.reject(new Error("Error fetching source "+e))},ni=toPromise(()=>ti).then(si=>si instanceof Response?(ei&&(ei.url=si.url),ri(si)):(si instanceof Request||(si=new Request(si)),si.headers.get("Accept")||si.headers.set("Accept","application/json"),ei&&(ei.url=si.url),fetch(si).then(ri).catch(ii))).catch(ii);return pendingRequests[e]=[ti,ni],ni}function getGlStyle(_t,e){if(typeof _t=="string")if(_t.trim().startsWith("{"))try{const n=JSON.parse(_t);return Promise.resolve(n)}catch(n){return Promise.reject(n)}else return _t=normalizeStyleUrl(_t,e.accessToken),fetchResource("Style",_t,e);else return Promise.resolve(_t)}const tilejsonCache={};function getTileJson(_t,e,n={}){const ei=[e,JSON.stringify(_t)].toString();let ti=tilejsonCache[ei];if(!ti||n.transformRequest){let ii;n.transformRequest&&(ii=(ni,si)=>{const ai=n.transformRequest&&n.transformRequest(si,"Tiles")||si;if(ni instanceof VectorTile$1)ni.setLoader((oi,li,ci)=>{const ui=function(di){di.arrayBuffer().then(fi=>{const pi=ni.getFormat().readFeatures(fi,{extent:oi,featureProjection:ci});ni.setFeatures(pi)})};toPromise(()=>ai).then(di=>{if(di instanceof Response)return ui(di);fetch(di).then(ui).catch(fi=>ni.setState(TileState.ERROR))}).catch(di=>ni.setState(TileState.ERROR))});else{const oi=ni.getImage();toPromise(()=>ai).then(li=>{if(typeof li=="string"){oi.src=li;return}const ci=ui=>ui.blob().then(di=>{const fi=URL.createObjectURL(di);oi.addEventListener("load",()=>URL.revokeObjectURL(fi)),oi.addEventListener("error",()=>URL.revokeObjectURL(fi)),oi.src=fi});if(li instanceof Response)return ci(li);fetch(li).then(ci).catch(ui=>ni.setState(TileState.ERROR))}).catch(li=>ni.setState(TileState.ERROR))}});const ri=_t.url;if(ri&&!_t.tiles){const ni=normalizeSourceUrl(ri,n.accessToken,n.accessTokenParam||"access_token",e||location.href);if(ri.startsWith("mapbox://"))ti=Promise.resolve({tileJson:Object.assign({},_t,{url:void 0,tiles:ni}),tileLoadFunction:ii});else{const si={};ti=fetchResource("Source",ni[0],n,si).then(function(ai){return ai.tiles=ai.tiles.map(function(oi){return ai.scheme==="tms"&&(oi=oi.replace("{y}","{-y}")),normalizeSourceUrl(oi,n.accessToken,n.accessTokenParam||"access_token",si.url)[0]}),Promise.resolve({tileJson:ai,tileLoadFunction:ii})})}}else _t.tiles?(_t=Object.assign({},_t,{tiles:_t.tiles.map(function(ni){return _t.scheme==="tms"&&(ni=ni.replace("{y}","{-y}")),normalizeSourceUrl(ni,n.accessToken,n.accessTokenParam||"access_token",e||location.href)[0]})}),ti=Promise.resolve({tileJson:Object.assign({},_t),tileLoadFunction:ii})):ti=Promise.reject(new Error("source has no `tiles` nor `url`"));tilejsonCache[ei]=ti}return ti}function drawIconHalo(_t,e,n,ei){const ti=[2*n*e.pixelRatio+e.width,2*n*e.pixelRatio+e.height],ii=createCanvas(ti[0],ti[1]),ri=ii.getContext("2d");ri.drawImage(_t,e.x,e.y,e.width,e.height,n*e.pixelRatio,n*e.pixelRatio,e.width,e.height);const ni=ri.getImageData(0,0,ti[0],ti[1]);ri.globalCompositeOperation="destination-over",ri.fillStyle=`rgba(${ei.r*255},${ei.g*255},${ei.b*255},${ei.a})`;const si=ni.data;for(let ai=0,oi=ni.width;ai<oi;++ai)for(let li=0,ci=ni.height;li<ci;++li){const ui=(li*oi+ai)*4;si[ui+3]>0&&ri.arc(ai,li,n*e.pixelRatio,0,2*Math.PI)}return ri.fill(),ii}function smoothstep(_t,e,n){const ei=Math.max(0,Math.min(1,(n-_t)/(e-_t)));return ei*ei*(3-2*ei)}function drawSDF(_t,e,n){const ei=createCanvas(e.width,e.height),ti=ei.getContext("2d");ti.drawImage(_t,e.x,e.y,e.width,e.height,0,0,e.width,e.height);const ii=ti.getImageData(0,0,e.width,e.height),ri=ii.data;for(let ni=0,si=ii.width;ni<si;++ni)for(let ai=0,oi=ii.height;ai<oi;++ai){const li=(ai*si+ni)*4,ci=ri[li+3]/255,ui=.75,di=.1,fi=smoothstep(ui-di,ui+di,ci);fi>0?(ri[li+0]=Math.round(255*n.r*fi),ri[li+1]=Math.round(255*n.g*fi),ri[li+2]=Math.round(255*n.b*fi),ri[li+3]=Math.round(255*fi)):ri[li+3]=0}return ti.putImageData(ii,0,0),ei}const hairSpacePool=Array(256).join("");function applyLetterSpacing(_t,e){if(e>=.05){let n="";const ei=_t.split(`
`),ti=hairSpacePool.slice(0,Math.round(e/.1));for(let ii=0,ri=ei.length;ii<ri;++ii)ii>0&&(n+=`
`),n+=ei[ii].split("").join(ti);return n}return _t}let measureContext;function getMeasureContext(){return measureContext||(measureContext=createCanvas(1,1).getContext("2d")),measureContext}function measureText(_t,e){return getMeasureContext().measureText(_t).width+(_t.length-1)*e}const measureCache={};function wrapText(_t,e,n,ei){if(_t.indexOf(`
`)!==-1){const ri=_t.split(`
`),ni=[];for(let si=0,ai=ri.length;si<ai;++si)ni.push(wrapText(ri[si],e,n,ei));return ni.join(`
`)}const ti=n+","+e+","+_t+","+ei;let ii=measureCache[ti];if(!ii){const ri=_t.split(" ");if(ri.length>1){const ni=getMeasureContext();ni.font=e;const ai=ni.measureText("M").width*n;let oi="";const li=[];for(let ci=0,ui=ri.length;ci<ui;++ci){const di=ri[ci],fi=oi+(oi?" ":"")+di;measureText(fi,ei)<=ai?oi=fi:(oi&&li.push(oi),oi=di)}oi&&li.push(oi);for(let ci=0,ui=li.length;ci<ui&&ui>1;++ci){const di=li[ci];if(measureText(di,ei)<ai*.35){const fi=ci>0?measureText(li[ci-1],ei):1/0,hi=ci<ui-1?measureText(li[ci+1],ei):1/0;li.splice(ci,1),ui-=1,fi<hi?(li[ci-1]+=" "+di,ci-=1):li[ci]=di+" "+li[ci]}}for(let ci=0,ui=li.length-1;ci<ui;++ci){const di=li[ci],fi=li[ci+1];if(measureText(di,ei)>ai*.7&&measureText(fi,ei)<ai*.6){const hi=di.split(" "),pi=hi.pop();measureText(pi,ei)<ai*.2&&(li[ci]=hi.join(" "),li[ci+1]=pi+" "+fi),ui-=1}}ii=li.join(`
`)}else ii=_t;ii=applyLetterSpacing(ii,ei),measureCache[ti]=ii}return ii}const fontFamilyRegEx=/font-family: ?([^;]*);/,stripQuotesRegEx=/("|')/g;let loadedFontFamilies;function hasFontFamily(_t){if(!loadedFontFamilies){loadedFontFamilies={};const e=document.styleSheets;for(let n=0,ei=e.length;n<ei;++n){const ti=e[n];try{const ii=ti.rules||ti.cssRules;if(ii)for(let ri=0,ni=ii.length;ri<ni;++ri){const si=ii[ri];if(si.type==5){const ai=si.cssText.match(fontFamilyRegEx);loadedFontFamilies[ai[1].replace(stripQuotesRegEx,"")]=!0}}}catch{}}}return _t in loadedFontFamilies}const processedFontFamilies={};function getFonts(_t,e="https://cdn.jsdelivr.net/npm/@fontsource/{font-family}/{fontweight}{-fontstyle}.css"){const n=_t.toString();if(n in processedFontFamilies)return processedFontFamilies[n];const ei=[];for(let ti=0,ii=_t.length;ti<ii;++ti){_t[ti]=_t[ti].replace("Arial Unicode MS","Arial");const ri=_t[ti],ni=mb2css(ri,1);registerFont(ni);const si=ni.split(" ");ei.push([si.slice(3).join(" ").replace(/"/g,""),si[1],si[0]])}for(let ti=0,ii=ei.length;ti<ii;++ti){const ri=ei[ti],ni=ri[0];if(!hasFontFamily(ni)&&checkedFonts.get(`${ri[2]}
${ri[1]} 
${ni}`)!==100){const si=e.replace("{font-family}",ni.replace(/ /g,"-").toLowerCase()).replace("{Font+Family}",ni.replace(/ /g,"+")).replace("{fontweight}",ri[1]).replace("{-fontstyle}",ri[2].replace("normal","").replace(/(.+)/,"-$1")).replace("{fontstyle}",ri[2]);if(!document.querySelector('link[href="'+si+'"]')){const ai=document.createElement("link");ai.href=si,ai.rel="stylesheet",document.head.appendChild(ai)}}}return processedFontFamilies[n]=_t,_t}const types$1={Point:1,MultiPoint:1,LineString:2,MultiLineString:2,Polygon:3,MultiPolygon:3},anchor={center:[.5,.5],left:[0,.5],right:[1,.5],top:[.5,0],bottom:[.5,1],"top-left":[0,0],"top-right":[1,0],"bottom-left":[0,1],"bottom-right":[1,1]},expressionData=function(_t,e){const n=createPropertyExpression(_t,e);if(n.result==="error")throw new Error(n.value.map(ei=>`${ei.key}: ${ei.message}`).join(", "));return n.value},cameraObj={zoom:0,distanceFromCenter:0};CompoundExpression.register(expressions$1,{...CompoundExpression.definitions,pitch:[{kind:"number"},[],_t=>cameraObj.pitch||90],"distance-from-center":[{kind:"number"},[],_t=>cameraObj.distanceFromCenter||0]});let renderFeatureCoordinates,renderFeature;function getValue(_t,e,n,ei,ti,ii){const ri=_t.id;ti||(ti={},console.warn("No functionCache provided to getValue()")),ti[ri]||(ti[ri]={});const ni=ti[ri];if(!ni[n]){let si=(_t[e]||emptyObj)[n];const ai=v8[`${e}_${_t.type}`][n];si===void 0&&(si=ai.default);let oi=isExpression(si);if(!oi&&isFunction$1(si)&&(si=convertFunction(si,ai),oi=!0),oi){const li=expressionData(si,ai);ni[n]=li.evaluate.bind(li)}else ai.type=="color"&&(si=Color.parse(si)),ni[n]=function(){return si}}return ni[n](cameraObj,ei,ii)}function getDeclutterMode(_t,e,n,ei){return getValue(_t,"layout",`${n}-allow-overlap`,e,ei)?getValue(_t,"layout",`${n}-ignore-placement`,e,ei)?"none":"obstacle":"declutter"}function evaluateFilter(_t,e,n,ei){if(ei||console.warn("No filterCache provided to evaluateFilter()"),!(_t in ei))try{ei[_t]=featureFilter(e).filter}catch(ti){console.warn("Filter will evaluate to false: "+ti.message),ei[_t]=function(){return!1}}return ei[_t](cameraObj,n)}function colorWithOpacity(_t,e){if(_t){if(_t.a===0||e===0)return;const n=_t.a;return e=e===void 0?1:e,n===0?"transparent":"rgba("+Math.round(_t.r*255/n)+","+Math.round(_t.g*255/n)+","+Math.round(_t.b*255/n)+","+n*e+")"}return _t}const templateRegEx=/\{[^{}}]*\}/g;function fromTemplate(_t,e){return _t.replace(templateRegEx,function(n){return e[n.slice(1,-1)]||""})}function getSpriteImageForIcon(_t,e){let n=_t.split(":")[0];return n===_t&&(n="default"),e[n]}const styleFunctionArgs={};function stylefunction(_t,e,n,ei=defaultResolutions,ti=void 0,ii=void 0,ri=void 0,ni=void 0){if(typeof e=="string"&&(e=JSON.parse(e)),e.version!=8)throw new Error("glStyle version 8 required.");styleFunctionArgs[getStyleFunctionKey(e,_t)]=Array.from(arguments);const si={};(typeof ii=="string"||ii instanceof Request||ii instanceof Response||ii instanceof Promise)&&(ii={default:ii});for(const _i in ii){const Ai=ii[_i];toPromise(()=>Ai).then(async Ei=>{let Si;if(typeof Image<"u"){const wi=new Image;if(typeof Ei=="string")wi.crossOrigin="anonymous",wi.src=Ei;else{let Oi;Ei instanceof Request?Oi=await fetch(Ei):Ei instanceof Response&&(Oi=Ei);const Ii=await Oi.blob();Si=URL.createObjectURL(Ii),wi.src=Si}wi.addEventListener("load",function Oi(){wi.removeEventListener("load",Oi),si[_i]={image:wi,size:[wi.width,wi.height]},_t.changed(),Si&&URL.revokeObjectURL(Si)}),wi.addEventListener("error",function Oi(){URL.revokeObjectURL(Si),wi.removeEventListener("error",Oi)})}else if(typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope){const wi=self;wi.postMessage({action:"loadImage",src:Ei}),wi.addEventListener("message",function(Ii){Ii.data.action==="imageLoaded"&&Ii.data.src===Ei&&(si[_i]={image:Ii.data.image,size:[Ii.data.image.width,Ii.data.image.height]})})}})}const ai=derefLayers(e.layers),oi={},li=[],ci={},ui={},di=getFunctionCache(e),fi=getFilterCache(e);let hi;for(let _i=0,Ai=ai.length;_i<Ai;++_i){const Ei=ai[_i],Si=Ei.id;if(typeof n=="string"&&Ei.source==n||Array.isArray(n)&&n.indexOf(Si)!==-1){const wi=Ei["source-layer"];if(hi){if(Ei.source!==hi)throw new Error(`Layer "${Si}" does not use source "${hi}`)}else{hi=Ei.source;const Ii=e.sources[hi];if(!Ii)throw new Error(`Source "${hi}" is not defined`);const Li=Ii.type;if(Li!=="vector"&&Li!=="geojson")throw new Error(`Source "${hi}" is not of type "vector" or "geojson", but "${Li}"`)}let Oi=oi[wi];Oi||(Oi=[],oi[wi]=Oi),Oi.push({layer:Ei,index:_i}),li.push(Si)}}const pi=new Stroke,gi=new Fill,vi=[],yi=function(_i,Ai,Ei){const Si=_i.getProperties(),wi=oi[Si.layer];if(!wi)return;let Oi=ei.indexOf(Ai);Oi==-1&&(Oi=getZoomForResolution(Ai,ei)),cameraObj.zoom=Oi,cameraObj.distanceFromCenter=0;const Ii=_i.getGeometry(),Li=types$1[Ii.getType()],Di=_t.get("map");if(Di&&Di instanceof Map$1&&Li===1){const er=Di.getSize();if(er){const Vi=Di.getView().getCenter(),nr=getCenter(Ii.getExtent());cameraObj.distanceFromCenter=distance(Vi,nr)/Ai/er[1]}}const Ni={id:_i.getId(),properties:Si,type:Li},$i=_t.get("mapbox-featurestate")[_i.getId()];let Ki=-1;for(let er=0,Vi=wi.length;er<Vi;++er){const nr=wi[er],zi=nr.layer,Wi=zi.id;if(Ei!==void 0&&Ei!==Wi)continue;const Ti=zi.layout||emptyObj,ki=zi.paint||emptyObj;if(Ti.visibility==="none"||"minzoom"in zi&&Oi<zi.minzoom||"maxzoom"in zi&&Oi>=zi.maxzoom)continue;const xi=zi.filter;if(!xi||evaluateFilter(Wi,xi,Ni,fi)){let Mi,Ui,Yi,sr,cr,ir;const Zi=nr.index;if(Li==3&&(zi.type=="fill"||zi.type=="fill-extrusion"))if(Ui=getValue(zi,"paint",zi.type+"-opacity",Ni,di,$i),zi.type+"-pattern"in ki){const yr=getValue(zi,"paint",zi.type+"-pattern",Ni,di,$i);if(yr){const _r=typeof yr=="string"?fromTemplate(yr,Si):yr.toString(),Ar=getSpriteImageForIcon(_r,si);if(ti&&ti[_r]&&Ar){++Ki,ir=vi[Ki],(!ir||!ir.getFill()||ir.getStroke()||ir.getText())&&(ir=new Style$1({fill:new Fill}),vi[Ki]=ir),Yi=ir.getFill(),ir.setZIndex(Zi);const wr=_r+"."+Ui;let Rr=ui[wr];if(!Rr){const Sr=ti[_r],Gr=createCanvas(Sr.width,Sr.height),Or=Gr.getContext("2d");Or.globalAlpha=Ui,Or.drawImage(Ar.image,Sr.x,Sr.y,Sr.width,Sr.height,0,0,Sr.width,Sr.height),Rr=Or.createPattern(Gr,"repeat"),ui[wr]=Rr}Yi.setColor(Rr)}}}else Mi=colorWithOpacity(getValue(zi,"paint",zi.type+"-color",Ni,di,$i),Ui),zi.type+"-outline-color"in ki&&(cr=colorWithOpacity(getValue(zi,"paint",zi.type+"-outline-color",Ni,di,$i),Ui)),cr||(cr=Mi),(Mi||cr)&&(++Ki,ir=vi[Ki],(!ir||Mi&&!ir.getFill()||!Mi&&ir.getFill()||cr&&!ir.getStroke()||!cr&&ir.getStroke()||ir.getText())&&(ir=new Style$1({fill:Mi?new Fill:void 0,stroke:cr?new Stroke:void 0}),vi[Ki]=ir),Mi&&(Yi=ir.getFill(),Yi.setColor(Mi)),cr&&(sr=ir.getStroke(),sr.setColor(cr),sr.setWidth(.5)),ir.setZIndex(Zi));if(Li!=1&&zi.type=="line"){"line-pattern"in ki?Mi=void 0:Mi=colorWithOpacity(getValue(zi,"paint","line-color",Ni,di,$i),getValue(zi,"paint","line-opacity",Ni,di,$i));const yr=getValue(zi,"paint","line-width",Ni,di,$i);Mi&&yr>0&&(++Ki,ir=vi[Ki],(!ir||!ir.getStroke()||ir.getFill()||ir.getText())&&(ir=new Style$1({stroke:new Stroke}),vi[Ki]=ir),sr=ir.getStroke(),sr.setLineCap(getValue(zi,"layout","line-cap",Ni,di,$i)),sr.setLineJoin(getValue(zi,"layout","line-join",Ni,di,$i)),sr.setMiterLimit(getValue(zi,"layout","line-miter-limit",Ni,di,$i)),sr.setColor(Mi),sr.setWidth(yr),sr.setLineDash(ki["line-dasharray"]?getValue(zi,"paint","line-dasharray",Ni,di,$i).map(function(_r){return _r*yr}):null),ir.setZIndex(Zi))}let rr=!1,ar=null,pr=0,Gi,gr,Br;if((Li==1||Li==2)&&"icon-image"in Ti){const yr=getValue(zi,"layout","icon-image",Ni,di,$i);if(yr){Gi=typeof yr=="string"?fromTemplate(yr,Si):yr.toString();let _r;const Ar=ni?ni(_t,Gi):void 0,wr=getSpriteImageForIcon(Gi,si);if(ti&&ti[Gi]&&wr||Ar){const Rr=getValue(zi,"layout","icon-rotation-alignment",Ni,di,$i);if(Li==2){const Sr=_i.getGeometry();if(Sr.getFlatMidpoint||Sr.getFlatMidpoints){const Gr=Sr.getExtent();if(Math.sqrt(Math.max(Math.pow((Gr[2]-Gr[0])/Ai,2),Math.pow((Gr[3]-Gr[1])/Ai,2)))>150){const nn=Sr.getType()==="MultiLineString"?Sr.getFlatMidpoints():Sr.getFlatMidpoint();if(renderFeature||(renderFeatureCoordinates=[NaN,NaN],renderFeature=new RenderFeature("Point",renderFeatureCoordinates,[],2,{},void 0)),_r=renderFeature,renderFeatureCoordinates[0]=nn[0],renderFeatureCoordinates[1]=nn[1],getValue(zi,"layout","symbol-placement",Ni,di,$i)==="line"&&Rr==="map"){const Vr=Sr.getStride(),Xr=Sr.getFlatCoordinates();for(let tn=0,Dr=Xr.length-Vr;tn<Dr;tn+=Vr){const rn=Xr[tn],jr=Xr[tn+1],$r=Xr[tn+Vr],un=Xr[tn+Vr+1],sn=Math.min(rn,$r),Wr=Math.max(rn,$r),an=nn[0],En=nn[1],Pn=(un-jr)*(an-rn)-($r-rn)*(En-jr);if(Math.abs(Pn)<.001&&an<=Wr&&an>=sn){pr=Math.atan2(jr-un,$r-rn);break}}}}}}if(Li!==2||_r){const Sr=getValue(zi,"layout","icon-size",Ni,di,$i),Gr=ki["icon-color"]!==void 0?getValue(zi,"paint","icon-color",Ni,di,$i):null;if(!Gr||Gr.a!==0){const Or=getValue(zi,"paint","icon-halo-color",Ni,di,$i),nn=getValue(zi,"paint","icon-halo-width",Ni,di,$i);let en=`${Gi}.${Sr}.${nn}.${Or}`;if(Gr!==null&&(en+=`.${Gr}`),gr=ci[en],!gr){const Vr=getDeclutterMode(zi,Ni,"icon",di);let Xr;"icon-offset"in Ti&&(Xr=getValue(zi,"layout","icon-offset",Ni,di,$i).slice(0),Xr[0]*=Sr,Xr[1]*=-Sr);let tn=Gr?[Gr.r*255,Gr.g*255,Gr.b*255,Gr.a]:void 0;if(Ar){const Dr={color:tn,rotateWithView:Rr==="map",displacement:Xr,declutterMode:Vr,scale:Sr};typeof Ar=="string"?Dr.src=Ar:(Dr.img=Ar,Dr.imgSize=[Ar.width,Ar.height]),gr=new Icon(Dr)}else{const Dr=ti[Gi];let rn,jr,$r;if(nn)Dr.sdf?(rn=drawIconHalo(drawSDF(wr.image,Dr,Gr||[0,0,0,1]),{x:0,y:0,width:Dr.width,height:Dr.height,pixelRatio:Dr.pixelRatio},nn,Or),tn=void 0):rn=drawIconHalo(wr.image,Dr,nn,Or);else{if(Dr.sdf&&!wr.unSDFed){const un=drawSDF(wr.image,{x:0,y:0,width:wr.size[0],height:wr.size[1]},{r:1,g:1,b:1});wr.image=un,wr.unSDFed=!0}rn=wr.image,jr=[Dr.width,Dr.height],$r=[Dr.x,Dr.y]}gr=new Icon({color:tn,img:rn,imgSize:wr.size,size:jr,offset:$r,rotateWithView:Rr==="map",scale:Sr/Dr.pixelRatio,displacement:Xr,declutterMode:Vr})}ci[en]=gr}}gr&&(++Ki,ir=vi[Ki],(!ir||!ir.getImage()||ir.getFill()||ir.getStroke())&&(ir=new Style$1,vi[Ki]=ir),ir.setGeometry(_r),gr.setRotation(pr+deg2rad(getValue(zi,"layout","icon-rotate",Ni,di,$i))),gr.setOpacity(getValue(zi,"paint","icon-opacity",Ni,di,$i)),gr.setAnchor(anchor[getValue(zi,"layout","icon-anchor",Ni,di,$i)]),ir.setImage(gr),ar=ir.getText(),ir.setText(void 0),ir.setZIndex(Zi),rr=!0,Br=!1)}else Br=!0}}}if(Li==1&&zi.type==="circle"){++Ki,ir=vi[Ki],(!ir||!ir.getImage()||ir.getFill()||ir.getStroke())&&(ir=new Style$1,vi[Ki]=ir);const yr="circle-radius"in ki?getValue(zi,"paint","circle-radius",Ni,di,$i):5,_r=colorWithOpacity(getValue(zi,"paint","circle-stroke-color",Ni,di,$i),getValue(zi,"paint","circle-stroke-opacity",Ni,di,$i)),Ar=getValue(zi,"paint","circle-translate",Ni,di,$i),wr=colorWithOpacity(getValue(zi,"paint","circle-color",Ni,di,$i),getValue(zi,"paint","circle-opacity",Ni,di,$i)),Rr=getValue(zi,"paint","circle-stroke-width",Ni,di,$i),Sr=yr+"."+_r+"."+wr+"."+Rr+"."+Ar[0]+"."+Ar[1];gr=ci[Sr],gr||(gr=new CircleStyle({radius:yr,displacement:[Ar[0],-Ar[1]],stroke:_r&&Rr>0?new Stroke({width:Rr,color:_r}):void 0,fill:wr?new Fill({color:wr}):void 0,declutterMode:"none"}),ci[Sr]=gr),ir.setImage(gr),ar=ir.getText(),ir.setText(void 0),ir.setGeometry(void 0),ir.setZIndex(Zi),rr=!0}let Nr,mr,Mr,Er,Fr,or;if("text-field"in Ti){Er=Math.round(getValue(zi,"layout","text-size",Ni,di,$i));const yr=getValue(zi,"layout","text-font",Ni,di,$i);Mr=getValue(zi,"layout","text-line-height",Ni,di,$i),mr=mb2css(ri?ri(yr,e.metadata?e.metadata["ol:webfonts"]:void 0):yr,Er,Mr),mr.includes("sans-serif")||(mr+=",sans-serif"),Fr=getValue(zi,"layout","text-letter-spacing",Ni,di,$i),or=getValue(zi,"layout","text-max-width",Ni,di,$i);const _r=getValue(zi,"layout","text-field",Ni,di,$i);typeof _r=="object"&&_r.sections?_r.sections.length===1?Nr=_r.toString():Nr=_r.sections.reduce((Ar,wr,Rr)=>{const Sr=wr.fontStack?wr.fontStack.split(","):yr,Gr=mb2css(ri?ri(Sr):Sr,Er*(wr.scale||1),Mr);let Or=wr.text;if(Or===`
`)return Ar.push(`
`,""),Ar;if(Li==2)return Ar.push(applyLetterSpacing(Or,Fr),Gr),Ar;Or=wrapText(Or,Gr,or,Fr).split(`
`);for(let nn=0,en=Or.length;nn<en;++nn)nn>0&&Ar.push(`
`,""),Ar.push(Or[nn],Gr);return Ar},[]):Nr=fromTemplate(_r,Si).trim(),Ui=getValue(zi,"paint","text-opacity",Ni,di,$i)}if(Nr&&Ui&&!Br){rr||(++Ki,ir=vi[Ki],(!ir||!ir.getText()||ir.getFill()||ir.getStroke())&&(ir=new Style$1,vi[Ki]=ir),ir.setImage(void 0),ir.setGeometry(void 0));const yr=getDeclutterMode(zi,Ni,"text",di);ir.getText()||ir.setText(ar),ar=ir.getText(),(!ar||"getDeclutterMode"in ar&&ar.getDeclutterMode()!==yr)&&(ar=new Text({padding:[2,2,2,2],declutterMode:yr}),ir.setText(ar));const _r=getValue(zi,"layout","text-transform",Ni,di,$i);_r=="uppercase"?Nr=Array.isArray(Nr)?Nr.map(($r,un)=>un%2?$r:$r.toUpperCase()):Nr.toUpperCase():_r=="lowercase"&&(Nr=Array.isArray(Nr)?Nr.map(($r,un)=>un%2?$r:$r.toLowerCase()):Nr.toLowerCase());const Ar=Array.isArray(Nr)?Nr:Li==2?applyLetterSpacing(Nr,Fr):wrapText(Nr,mr,or,Fr);if(ar.setText(Ar),ar.setFont(mr),ar.setRotation(deg2rad(getValue(zi,"layout","text-rotate",Ni,di,$i))),typeof ar.setKeepUpright=="function"){const $r=getValue(zi,"layout","text-keep-upright",Ni,di,$i);ar.setKeepUpright($r)}const wr=getValue(zi,"layout","text-anchor",Ni,di,$i),Rr=rr||Li==1?"point":getValue(zi,"layout","symbol-placement",Ni,di,$i);let Sr;if(Rr==="line-center"?(ar.setPlacement("line"),Sr="center"):ar.setPlacement(Rr),Rr==="line"&&typeof ar.setRepeat=="function"){const $r=getValue(zi,"layout","symbol-spacing",Ni,di,$i);ar.setRepeat($r*2)}ar.setOverflow(Rr==="point");let Gr=getValue(zi,"paint","text-halo-width",Ni,di,$i);const Or=getValue(zi,"layout","text-offset",Ni,di,$i),nn=getValue(zi,"paint","text-translate",Ni,di,$i);let en=0,Vr=0;if(Rr=="point"){Sr="center",wr.indexOf("left")!==-1?(Sr="left",Vr=Gr):wr.indexOf("right")!==-1&&(Sr="right",Vr=-Gr);const $r=getValue(zi,"layout","text-rotation-alignment",Ni,di,$i);ar.setRotateWithView($r=="map")}else ar.setMaxAngle(deg2rad(getValue(zi,"layout","text-max-angle",Ni,di,$i))*Nr.length/Ar.length),ar.setRotateWithView(!1);ar.setTextAlign(Sr);let Xr="middle";wr.indexOf("bottom")==0?(Xr="bottom",en=-Gr-.5*(Mr-1)*Er):wr.indexOf("top")==0&&(Xr="top",en=Gr+.5*(Mr-1)*Er),ar.setTextBaseline(Xr);const tn=getValue(zi,"layout","text-justify",Ni,di,$i);ar.setJustify(tn==="auto"?void 0:tn),ar.setOffsetX(Or[0]*Er+Vr+nn[0]),ar.setOffsetY(Or[1]*Er+en+nn[1]),gi.setColor(colorWithOpacity(getValue(zi,"paint","text-color",Ni,di,$i),Ui)),ar.setFill(gi);const Dr=colorWithOpacity(getValue(zi,"paint","text-halo-color",Ni,di,$i),Ui);if(Dr&&Gr>0){pi.setColor(Dr),Gr*=2;const $r=.5*Er;pi.setWidth(Gr<=$r?Gr:$r),ar.setStroke(pi)}else ar.setStroke(void 0);const rn=getValue(zi,"layout","text-padding",Ni,di,$i),jr=ar.getPadding();rn!==jr[0]&&(jr[0]=rn,jr[1]=rn,jr[2]=rn,jr[3]=rn),ir.setZIndex(Zi)}}}if(Ki>-1)return vi.length=Ki+1,vi};return _t.setStyle(yi),_t.set("mapbox-layers",li),_t.set("mapbox-source",hi),_t.set("mapbox-featurestate",_t.get("mapbox-featurestate")||{}),yi}function getTileResolutions(_t,e=512){return _t.getExtent()?createXYZ({extent:_t.getExtent(),tileSize:e,maxZoom:22}).getResolutions():defaultResolutions}function completeOptions(_t,e){return e.accessToken||(e=Object.assign({},e),new URL(_t).searchParams.forEach((ei,ti)=>{e.accessToken=ei,e.accessTokenParam=ti})),e}function applyStyle(_t,e,n="",ei={},ti=void 0){let ii,ri,ni,si,ai=!0;return typeof n!="string"&&!Array.isArray(n)?(ni=n,si=ni.source||ni.layers,ei=ni):si=n,typeof ei=="string"?(ii=ei,ni={}):(ii=ei.styleUrl,ni=ei),ni.updateSource===!1&&(ai=!1),ti||(ti=ni.resolutions),!ii&&typeof e=="string"&&!e.trim().startsWith("{")&&(ii=e),ii&&(ii=ii.startsWith("data:")?location.href:normalizeStyleUrl(ii,ni.accessToken),ni=completeOptions(ii,ni)),new Promise(function(oi,li){getGlStyle(e,ni).then(function(ci){if(ci.version!=8)return li(new Error("glStyle version 8 required."));if(!(_t instanceof VectorLayer||_t instanceof VectorTileLayer))return li(new Error("Can only apply to VectorLayer or VectorTileLayer"));const ui=_t instanceof VectorTileLayer?"vector":"geojson";if(si?Array.isArray(si)?ri=ci.layers.find(function(yi){return yi.id===si[0]}).source:ri=si:(ri=ci.layers.find(function(yi){return yi.source&&ci.sources[yi.source].type===ui}).source,si=ri),!ri)return li(new Error(`No ${ui} source found in the glStyle.`));function di(){if(!ai)return Promise.resolve();if(_t instanceof VectorTileLayer)return setupVectorSource(ci.sources[ri],ii,ni).then(function(Ei){const Si=_t.getSource();Si?Ei!==Si&&(Si.setTileUrlFunction(Ei.getTileUrlFunction()),typeof Si.setUrls=="function"&&typeof Ei.getUrls=="function"&&Si.setUrls(Ei.getUrls()),Si.format_||(Si.format_=Ei.format_),Si.getAttributions()||Si.setAttributions(Ei.getAttributions()),Si.getTileLoadFunction()===defaultLoadFunction&&Si.setTileLoadFunction(Ei.getTileLoadFunction()),equivalent$1(Si.getProjection(),Ei.getProjection())&&(Si.tileGrid=Ei.getTileGrid())):_t.setSource(Ei);const wi=_t.getSource().getTileGrid();!isFinite(_t.getMaxResolution())&&!isFinite(_t.getMinZoom())&&wi.getMinZoom()>0&&_t.setMaxResolution(getResolutionForZoom(Math.max(0,wi.getMinZoom()-1e-12),wi.getResolutions()))});const yi=ci.sources[ri];let _i=_t.getSource();(!_i||_i.get("mapbox-source")!==yi)&&(_i=setupGeoJSONSource(yi,ii,ni));const Ai=_t.getSource();return Ai?_i!==Ai&&(Ai.getAttributions()||Ai.setAttributions(_i.getAttributions()),Ai.format_||(Ai.format_=_i.getFormat()),Ai.url_=_i.getUrl()):_t.setSource(_i),Promise.resolve()}let fi,hi;const pi={},gi={};function vi(){if(!hi&&(!ci.sprite||pi)){if(ni.projection&&!ti){const _i=get$3(ni.projection).getUnits();_i!=="m"&&(ti=defaultResolutions.map(Ai=>Ai/METERS_PER_UNIT[_i]))}hi=stylefunction(_t,ci,si,ti,pi,gi,(yi,_i=ni.webfonts)=>getFonts(yi,_i),ni.getImage),_t.getStyle()?di().then(oi).catch(li):li(new Error(`Nothing to show for source [${ri}]`))}else hi?(_t.setStyle(hi),di().then(oi).catch(li)):li(new Error("Something went wrong trying to apply style."))}if(ci.sprite){const yi=normalizeSpriteDefinition(ci.sprite,ni.accessToken,ii||location.href);fi=window.devicePixelRatio>=1.5?.5:1;const _i=fi==.5?"@2x":"";Promise.all(yi.map(function(Ai){const Ei=new URL(Ai.url);let Si=Ei.origin+Ei.pathname+_i+".json"+Ei.search;return new Promise(function(wi,Oi){fetchResource("Sprite",Si,ni).then(wi).catch(function(Ii){Si=Ei.origin+Ei.pathname+".json"+Ei.search,fetchResource("Sprite",Si,ni).then(wi).catch(Oi)})}).then(function(wi){wi===void 0&&li(new Error("No sprites found."));let Oi;if(Oi=Ei.origin+Ei.pathname+_i+".png"+Ei.search,ni.transformRequest){const Ii=ni.transformRequest(Oi,"SpriteImage")||Oi;(Ii instanceof Request||Ii instanceof Promise)&&(Oi=Ii)}gi[Ai.id]=Oi;for(const Ii in wi){const Li=Ai.id=="default"?Ii:`${Ai.id}:${Ii}`;pi[Li]=wi[Ii]}}).catch(function(wi){li(new Error(`Sprites cannot be loaded: ${Si}: ${wi.message}`))})})).then(vi).catch(li)}else vi()}).catch(li)})}function extentFromTileJSON(_t,e){const n=_t.bounds;if(n){const ei=fromLonLat([n[0],n[1]],e),ti=fromLonLat([n[2],n[3]],e);return[ei[0],ei[1],ti[0],ti[1]]}return get$3(e).getExtent()}function sourceOptionsFromTileJSON(_t,e,n){const ei=new TileJSON({tileJSON:e,tileSize:_t.tileSize||e.tileSize||512}),ti=ei.getTileJSON(),ii=ei.getTileGrid(),ri=get$3(n.projection||"EPSG:3857"),ni=extentFromTileJSON(ti,ri),si=ri.getExtent(),ai=ti.minzoom||0,oi=ti.maxzoom||22,li={attributions:ei.getAttributions(),projection:ri,tileGrid:new TileGrid({origin:si?getTopLeft(si):ii.getOrigin(0),extent:ni||ii.getExtent(),minZoom:ai,resolutions:getTileResolutions(ri,e.tileSize).slice(0,oi+1),tileSize:ii.getTileSize(0)})};return Array.isArray(ti.tiles)?li.urls=ti.tiles:li.url=ti.tiles,li}function setupVectorSource(_t,e,n){return new Promise(function(ei,ti){getTileJson(_t,e,n).then(function({tileJson:ii,tileLoadFunction:ri}){const ni=sourceOptionsFromTileJSON(_t,ii,n);ni.tileLoadFunction=ri,ni.format=new MVT;const si=new VectorTile(ni);si.set("mapbox-source",_t),ei(si)}).catch(ti)})}function getBboxTemplate(_t){return`{bbox-${(_t?_t.getCode():"EPSG:3857").toLowerCase().replace(/[^a-z0-9]/g,"-")}}`}function setupGeoJSONSource(_t,e,n){const ei=n.projection?new GeoJSON$1({dataProjection:n.projection}):new GeoJSON$1,ti=_t.data,ii={};if(typeof ti=="string"){const[ni]=normalizeSourceUrl(ti,n.accessToken,n.accessTokenParam||"access_token",e||location.href);if(/\{bbox-[0-9a-z-]+\}/.test(ni)){const ai=(li,ci,ui)=>{const di=getBboxTemplate(ui);return ni.replace(di,`${li.join(",")}`)},oi=new VectorSource({attributions:_t.attribution,format:ei,loader:(li,ci,ui,di,fi)=>{const hi=typeof ai=="function"?ai(li,ci,ui):ai;fetchResource("GeoJSON",hi,n).then(pi=>{const gi=oi.getFormat().readFeatures(pi,{featureProjection:ui});oi.addFeatures(gi),di(gi)}).catch(pi=>{oi.removeLoadedExtent(li),fi()})},strategy:bbox});return oi.set("mapbox-source",_t),oi}const si=new VectorSource({attributions:_t.attribution,format:ei,url:ni,loader:(ai,oi,li,ci,ui)=>{fetchResource("GeoJSON",ni,n).then(di=>{const fi=si.getFormat().readFeatures(di,{featureProjection:li});si.addFeatures(fi),ci(fi)}).catch(di=>{si.removeLoadedExtent(ai),ui()})}});return si}ii.features=ei.readFeatures(ti,{featureProjection:"EPSG:3857"});const ri=new VectorSource(Object.assign({attributions:_t.attribution,format:ei},ii));return ri.set("mapbox-source",_t),ri}function updateMapboxLayer(_t,e){const n=_t.get("mapbox-style"),ei=n.layers,ti=ei.findIndex(function(ni){return ni.id===e.id});if(ti===-1)throw new Error(`Layer with id "${e.id}" not found.`);if(ei[ti].source!==e.source)throw new Error("Updated layer and previous version must use the same source.");delete getFunctionCache(n)[e.id],delete getFilterCache(n)[e.id],ei[ti]=e;const ri=styleFunctionArgs[getStyleFunctionKey(_t.get("mapbox-style"),getLayer(_t,e.id))];ri?stylefunction.apply(void 0,ri):getLayer(_t,e.id).changed()}function getLayer(_t,e){const n=_t.getLayers().getArray();for(let ei=0,ti=n.length;ei<ti;++ei){const ii=n[ei].get("mapbox-layers");if(ii&&ii.indexOf(e)!==-1)return n[ei]}}class LayerMapBox extends VectorTileLayer{constructor(e,n){if(!e.layer)throw new Error("ERROR PARAM_MISSING : layer");if(typeof e.layer!="string")throw new Error("ERROR WRONG TYPE : layer");typeof e.ssl>"u"&&(e.ssl=!0);var ei=e.ssl===!1?"http://":"https://",ti=e.configuration;if(!ti){if(!Config.isConfigLoaded())throw new Error("ERROR : contract key configuration has to be loaded to load Geoportal layers.");var ii=e.layer+"$GEOPORTAIL:GPP:TMS";if(ti=Config.configuration.getLayerConf(ii),!ti)throw new Error("ERROR : Layer ID not found into the catalogue !?")}for(var ri=null,ni="",si=e.style,ai=0;ai<ti.styles.length;ai++){var oi=ti.styles[ai];if(si&&oi.name===si){ri=oi.url,ni=oi.title;break}else if(!si&&oi.current){si=oi.name,ri=oi.url,ni=oi.title;break}}if(!ri)throw new Error("ERROR : Style URL not found !?");ri.replace(/(http|https):\/\//,ei);var li=new VectorTile({state:"loading",format:new MVT});li._originators=ti.originators,li._legends=ti.legends,li._metadata=ti.metadata,li._description=ti.description,li._title=ti.title+" ("+ni+")",li._quicklookUrl=ti.quicklookUrl,li._thumbnail=ti.thumbnail,li._producer=ti.producer;var ci={source:li};return Helper.mergeParams(ci,n),e.olParams&&!ti.originators&&(li._originators=e.olParams.attributions),super(ci),this.name=e.layer,this.service="TMS",this.protocol=ei,this.sourceId=e.source,this.styleUrl=ri,this.styleName=si,this.config=ti,this.setStyleMapBox(),this}setStyleMapBox(){var e=this;fetch(this.styleUrl,{credentials:"same-origin"}).then(function(n){n.ok&&n.json().then(function(ei){e.onStyleMapBoxLoad(ei)})}).catch(function(n){e.onStyleMapBoxError(n)})}onStyleMapBoxLoad(e){this.sourceId||(this.sourceId=Object.keys(e.sources)[0]);var n=e.sources[this.sourceId];if(!n){this.onStyleMapBoxError({message:"ERROR : Source ID not found !? !"});return}if(n.type!=="vector"){this.onStyleMapBoxError({message:"ERROR : Source TYPE not permitted !"});return}var ei=this.getSource();if(n.url){n.url.replace(/(http|https):\/\//,this.protocol);var ti=new TileJSON({url:n.url}),ii=this,ri=ti.on("change",function(){if(ti.getState()==="ready"){var si=ti.getTileJSON();if(!si)return;ii.set("mapbox-extensions",si);for(var ai=Array.isArray(si.tiles)?si.tiles:[si.tiles],oi=0;oi<n.tiles.length;oi++)ai[oi].replace(/(http|https):\/\//,this.protocol);ei.setUrls(ai),unByKey(ri)}})}if(n.tiles){for(var ni=0;ni<n.tiles.length;ni++)n.tiles[ni].replace(/(http|https):\/\//,this.protocol);ei.setUrls(n.tiles)}applyStyle(this,e,this.sourceId).then(()=>{ei.setState("ready"),this.set("mapbox-styles",e)}).then(()=>{this.dispatchEvent({type:"mapbox:style:loaded",style:this.styleUrl,name:this.styleName})}).catch(si=>{this.onStyleMapBoxError(si)})}onStyleMapBoxError(e){var n=this.getSource();n.setState("error"),console.error(e.message)}getConfiguration(){return this.config}getLegends(){return this.getSource()._legends}getMetadata(){return this.getSource()._metadata}getDescription(){return this.getSource()._description}getTitle(){return this.getSource()._title}getQuicklookUrl(){return this.getSource()._quicklookUrl}getOriginators(){return this.getSource()._originators}getThumbnailUrl(){return this.getSource()._thumbnail}getProducer(){return this.getSource()._producer}}window.ol&&window.ol.layer&&(window.ol.layer.GeoportalMapBox=LayerMapBox);const exceptions=["GPoverviewMap","GPfullScreen"];function getSameSideOpenedPanel(_t,e){var n=[...exceptions,e],ei=[];if(_t&&_t.includes("left")){var ti=document.getElementById("position-container-bottom-left"),ii=document.getElementById("position-container-top-left");ei=[...ti.children,...ii.children]}if(_t&&_t.includes("right")){var ri=document.getElementById("position-container-bottom-right"),ni=document.getElementById("position-container-top-right");ei=[...ri.children,...ni.children]}return ei.filter(si=>{var ai=si.id.match(/(\w+)-[0-9]+/)[1],oi=n.includes(ai),li=si.getElementsByTagName("button")[0].getAttribute("aria-pressed");if(li==="true"&&!oi)return si})}var PanelManager=function(_t,e){var n=getSameSideOpenedPanel(_t,e);n.length>0&&n[0].getElementsByTagName("button")[0].click()},Widget={onPanelOpen:function(){PanelManager(this.options.position,this.element.id.match(/(\w+)-[0-9]+/)[1])}},checkDsfr=function(){var _t=getComputedStyle(document.documentElement),e=_t.getPropertyValue("--blue-france-sun-113-625");return e!==""};class ControlExtended extends Control{constructor(e){e=e||{},super({element:e.element,target:e.target,render:e.render}),e&&e.listable?this.listable=!0:this.listable=!1,e&&e.description?this.description=e.description:this.description=""}setPosition(e){if(this.getMap()){var n=new PositionFactory(this);n.set(e)}}updatePosition(e){if(this.getMap()){var n=new PositionFactory(this);n.update(e)}}}const ANCHORS=["top-left","top-right","bottom-left","bottom-right"];var js,Kc,Fo,rc;class PositionFactory{constructor(e){ic(this,js);return this.caller=e,this.container=null,ea(this,js,Fo).call(this,"top-left"),ea(this,js,Fo).call(this,"top-right"),ea(this,js,Fo).call(this,"bottom-left"),ea(this,js,Fo).call(this,"bottom-right"),this}set(e){ANCHORS.includes(e.toLowerCase())&&(ea(this,js,rc).call(this,e,!1),e.includes("bottom")?this.container.children["position-container-"+e].prepend(this.caller.element):this.container.children["position-container-"+e].appendChild(this.caller.element))}update(e){ANCHORS.includes(e.toLowerCase())&&ea(this,js,rc).call(this,e,!0)}}js=new WeakSet,Kc=function(e){var n=this.container.children["position-container-"+e];return!!n},Fo=function(e){if(this.container=this.caller.getMap().getOverlayContainerStopEvent(),!ea(this,js,Kc).call(this,e)){var n=document.createElement("div");n.id="position-container-"+e,n.className="position position-container-"+e,this.container.appendChild(n)}},rc=function(e,n){var ei=this;const ti=oi=>{var li=ei.container.children["position-container-"+oi];return li.children.length},ii=oi=>{var li=ei.container.children["position-container-"+oi],ci=li.offsetWidth;return ci},ri=oi=>{var li=ei.container.children["position-container-"+oi],ci=li.offsetHeight;if(n){oi.includes("top")&&(ci=0);for(let ui=0;ui<li.children.length;ui++){if(li.children[ui].id===ei.caller.element.id){ci=oi.includes("bottom")?ci-ei.caller.element.offsetHeight:ci*-1;break}ci-=li.children[ui].offsetHeight}}return ci},ni=oi=>{oi.style.top="unset",oi.style.bottom="unset",oi.style.left="unset",oi.style.right="unset"};ni(this.caller.element),this.caller.element.style.position="unset";var si=Array.from(this.caller.element.getElementsByClassName("GPpanel"));if(si.length!==0){var ai=0;si.forEach(oi=>{if(oi.nodeName.toLowerCase()==="dialog"){switch(ni(oi),e.toLowerCase()){case"top-left":checkDsfr()?oi.style.top="0px":oi.style.top=ti(e)?ri(e)+"px":"0px",oi.style.left=ii(e)+ai+"px";break;case"bottom-left":checkDsfr()?oi.style.top="0px":oi.style.bottom=ti(e)?ri(e)+"px":"0px",oi.style.left=ii(e)+ai+"px";break;case"top-right":checkDsfr()?oi.style.top="0px":oi.style.top=ti(e)?ri(e)+"px":"0px",oi.style.right=ii(e)+ai+"px";break;case"bottom-right":checkDsfr()?oi.style.top="0px":oi.style.bottom=ti(e)?ri(e)+"px":"0px",oi.style.right=ii(e)+ai+"px";break}ai+=oi.offsetWidth}})}};var SelectorID={generate:(function(){var _t=Math.floor(Date.now());return function(){return _t++}})(),name:function(_t){var e=null,n=_t.lastIndexOf("-");return n===-1?e=_t:e=_t.substring(0,n),e},index:function(_t){var e=null,n=this.name(_t),ei=n.lastIndexOf("_");return ei!==-1&&(e=n.substring(ei+1)),e},uuid:function(_t){var e=null,n=_t.lastIndexOf("-");return n!==-1&&(e=parseInt(_t.substring(n+1),10)),e}},ToolTips={id:"gpf-tooltips-html",init:function(_t={}){if(document.getElementById(this.id))return;const e=document.createElement("div");e.id=this.id,Object.assign(e.style,_t),document.body.appendChild(e)},active:function(_t){var e=this,n=_t.getAttribute("data-tooltip");n&&(_t.addEventListener("mouseenter",ei=>{var ti=document.getElementById(e.id);if(!ti)return;ti.innerHTML=n;const ii=_t.getBoundingClientRect();ti.style.top=`${ii.top-ti.offsetHeight-10}px`,ti.style.left=`${ii.left+ii.width/2}px`,ti.style.transform="translateX(-50%)",ti.style.opacity="1"}),_t.addEventListener("mouseleave",()=>{var ei=document.getElementById(e.id);ei&&(ei.style.opacity="0")}))}};/**!
 * Sortable 1.15.3
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function ownKeys(_t,e){var n=Object.keys(_t);if(Object.getOwnPropertySymbols){var ei=Object.getOwnPropertySymbols(_t);e&&(ei=ei.filter(function(ti){return Object.getOwnPropertyDescriptor(_t,ti).enumerable})),n.push.apply(n,ei)}return n}function _objectSpread2(_t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?ownKeys(Object(n),!0).forEach(function(ei){_defineProperty(_t,ei,n[ei])}):Object.getOwnPropertyDescriptors?Object.defineProperties(_t,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(ei){Object.defineProperty(_t,ei,Object.getOwnPropertyDescriptor(n,ei))})}return _t}function _typeof$1(_t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?_typeof$1=function(e){return typeof e}:_typeof$1=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof$1(_t)}function _defineProperty(_t,e,n){return e in _t?Object.defineProperty(_t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):_t[e]=n,_t}function _extends(){return _extends=Object.assign||function(_t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var ei in n)Object.prototype.hasOwnProperty.call(n,ei)&&(_t[ei]=n[ei])}return _t},_extends.apply(this,arguments)}function _objectWithoutPropertiesLoose(_t,e){if(_t==null)return{};var n={},ei=Object.keys(_t),ti,ii;for(ii=0;ii<ei.length;ii++)ti=ei[ii],!(e.indexOf(ti)>=0)&&(n[ti]=_t[ti]);return n}function _objectWithoutProperties(_t,e){if(_t==null)return{};var n=_objectWithoutPropertiesLoose(_t,e),ei,ti;if(Object.getOwnPropertySymbols){var ii=Object.getOwnPropertySymbols(_t);for(ti=0;ti<ii.length;ti++)ei=ii[ti],!(e.indexOf(ei)>=0)&&Object.prototype.propertyIsEnumerable.call(_t,ei)&&(n[ei]=_t[ei])}return n}var version="1.15.3";function userAgent(_t){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(_t)}var IE11OrLess=userAgent(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),Edge=userAgent(/Edge/i),FireFox=userAgent(/firefox/i),Safari=userAgent(/safari/i)&&!userAgent(/chrome/i)&&!userAgent(/android/i),IOS=userAgent(/iP(ad|od|hone)/i),ChromeForAndroid=userAgent(/chrome/i)&&userAgent(/android/i),captureMode={capture:!1,passive:!1};function on(_t,e,n){_t.addEventListener(e,n,!IE11OrLess&&captureMode)}function off(_t,e,n){_t.removeEventListener(e,n,!IE11OrLess&&captureMode)}function matches(_t,e){if(e){if(e[0]===">"&&(e=e.substring(1)),_t)try{if(_t.matches)return _t.matches(e);if(_t.msMatchesSelector)return _t.msMatchesSelector(e);if(_t.webkitMatchesSelector)return _t.webkitMatchesSelector(e)}catch{return!1}return!1}}function getParentOrHost(_t){return _t.host&&_t!==document&&_t.host.nodeType?_t.host:_t.parentNode}function closest(_t,e,n,ei){if(_t){n=n||document;do{if(e!=null&&(e[0]===">"?_t.parentNode===n&&matches(_t,e):matches(_t,e))||ei&&_t===n)return _t;if(_t===n)break}while(_t=getParentOrHost(_t))}return null}var R_SPACE=/\s+/g;function toggleClass(_t,e,n){if(_t&&e)if(_t.classList)_t.classList[n?"add":"remove"](e);else{var ei=(" "+_t.className+" ").replace(R_SPACE," ").replace(" "+e+" "," ");_t.className=(ei+(n?" "+e:"")).replace(R_SPACE," ")}}function css(_t,e,n){var ei=_t&&_t.style;if(ei){if(n===void 0)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(_t,""):_t.currentStyle&&(n=_t.currentStyle),e===void 0?n:n[e];!(e in ei)&&e.indexOf("webkit")===-1&&(e="-webkit-"+e),ei[e]=n+(typeof n=="string"?"":"px")}}function matrix(_t,e){var n="";if(typeof _t=="string")n=_t;else do{var ei=css(_t,"transform");ei&&ei!=="none"&&(n=ei+" "+n)}while(!e&&(_t=_t.parentNode));var ti=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return ti&&new ti(n)}function find(_t,e,n){if(_t){var ei=_t.getElementsByTagName(e),ti=0,ii=ei.length;if(n)for(;ti<ii;ti++)n(ei[ti],ti);return ei}return[]}function getWindowScrollingElement(){var _t=document.scrollingElement;return _t||document.documentElement}function getRect(_t,e,n,ei,ti){if(!(!_t.getBoundingClientRect&&_t!==window)){var ii,ri,ni,si,ai,oi,li;if(_t!==window&&_t.parentNode&&_t!==getWindowScrollingElement()?(ii=_t.getBoundingClientRect(),ri=ii.top,ni=ii.left,si=ii.bottom,ai=ii.right,oi=ii.height,li=ii.width):(ri=0,ni=0,si=window.innerHeight,ai=window.innerWidth,oi=window.innerHeight,li=window.innerWidth),(e||n)&&_t!==window&&(ti=ti||_t.parentNode,!IE11OrLess))do if(ti&&ti.getBoundingClientRect&&(css(ti,"transform")!=="none"||n&&css(ti,"position")!=="static")){var ci=ti.getBoundingClientRect();ri-=ci.top+parseInt(css(ti,"border-top-width")),ni-=ci.left+parseInt(css(ti,"border-left-width")),si=ri+ii.height,ai=ni+ii.width;break}while(ti=ti.parentNode);if(ei&&_t!==window){var ui=matrix(ti||_t),di=ui&&ui.a,fi=ui&&ui.d;ui&&(ri/=fi,ni/=di,li/=di,oi/=fi,si=ri+oi,ai=ni+li)}return{top:ri,left:ni,bottom:si,right:ai,width:li,height:oi}}}function isScrolledPast(_t,e,n){for(var ei=getParentAutoScrollElement(_t,!0),ti=getRect(_t)[e];ei;){var ii=getRect(ei)[n],ri=void 0;if(ri=ti>=ii,!ri)return ei;if(ei===getWindowScrollingElement())break;ei=getParentAutoScrollElement(ei,!1)}return!1}function getChild(_t,e,n,ei){for(var ti=0,ii=0,ri=_t.children;ii<ri.length;){if(ri[ii].style.display!=="none"&&ri[ii]!==Sortable.ghost&&(ei||ri[ii]!==Sortable.dragged)&&closest(ri[ii],n.draggable,_t,!1)){if(ti===e)return ri[ii];ti++}ii++}return null}function lastChild(_t,e){for(var n=_t.lastElementChild;n&&(n===Sortable.ghost||css(n,"display")==="none"||e&&!matches(n,e));)n=n.previousElementSibling;return n||null}function index(_t,e){var n=0;if(!_t||!_t.parentNode)return-1;for(;_t=_t.previousElementSibling;)_t.nodeName.toUpperCase()!=="TEMPLATE"&&_t!==Sortable.clone&&(!e||matches(_t,e))&&n++;return n}function getRelativeScrollOffset(_t){var e=0,n=0,ei=getWindowScrollingElement();if(_t)do{var ti=matrix(_t),ii=ti.a,ri=ti.d;e+=_t.scrollLeft*ii,n+=_t.scrollTop*ri}while(_t!==ei&&(_t=_t.parentNode));return[e,n]}function indexOfObject(_t,e){for(var n in _t)if(_t.hasOwnProperty(n)){for(var ei in e)if(e.hasOwnProperty(ei)&&e[ei]===_t[n][ei])return Number(n)}return-1}function getParentAutoScrollElement(_t,e){if(!_t||!_t.getBoundingClientRect)return getWindowScrollingElement();var n=_t,ei=!1;do if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var ti=css(n);if(n.clientWidth<n.scrollWidth&&(ti.overflowX=="auto"||ti.overflowX=="scroll")||n.clientHeight<n.scrollHeight&&(ti.overflowY=="auto"||ti.overflowY=="scroll")){if(!n.getBoundingClientRect||n===document.body)return getWindowScrollingElement();if(ei||e)return n;ei=!0}}while(n=n.parentNode);return getWindowScrollingElement()}function extend$1(_t,e){if(_t&&e)for(var n in e)e.hasOwnProperty(n)&&(_t[n]=e[n]);return _t}function isRectEqual(_t,e){return Math.round(_t.top)===Math.round(e.top)&&Math.round(_t.left)===Math.round(e.left)&&Math.round(_t.height)===Math.round(e.height)&&Math.round(_t.width)===Math.round(e.width)}var _throttleTimeout;function throttle(_t,e){return function(){if(!_throttleTimeout){var n=arguments,ei=this;n.length===1?_t.call(ei,n[0]):_t.apply(ei,n),_throttleTimeout=setTimeout(function(){_throttleTimeout=void 0},e)}}}function cancelThrottle(){clearTimeout(_throttleTimeout),_throttleTimeout=void 0}function scrollBy(_t,e,n){_t.scrollLeft+=e,_t.scrollTop+=n}function clone(_t){var e=window.Polymer,n=window.jQuery||window.Zepto;return e&&e.dom?e.dom(_t).cloneNode(!0):n?n(_t).clone(!0)[0]:_t.cloneNode(!0)}function getChildContainingRectFromElement(_t,e,n){var ei={};return Array.from(_t.children).forEach(function(ti){var ii,ri,ni,si;if(!(!closest(ti,e.draggable,_t,!1)||ti.animated||ti===n)){var ai=getRect(ti);ei.left=Math.min((ii=ei.left)!==null&&ii!==void 0?ii:1/0,ai.left),ei.top=Math.min((ri=ei.top)!==null&&ri!==void 0?ri:1/0,ai.top),ei.right=Math.max((ni=ei.right)!==null&&ni!==void 0?ni:-1/0,ai.right),ei.bottom=Math.max((si=ei.bottom)!==null&&si!==void 0?si:-1/0,ai.bottom)}}),ei.width=ei.right-ei.left,ei.height=ei.bottom-ei.top,ei.x=ei.left,ei.y=ei.top,ei}var expando="Sortable"+new Date().getTime();function AnimationStateManager(){var _t=[],e;return{captureAnimationState:function(){if(_t=[],!!this.options.animation){var ei=[].slice.call(this.el.children);ei.forEach(function(ti){if(!(css(ti,"display")==="none"||ti===Sortable.ghost)){_t.push({target:ti,rect:getRect(ti)});var ii=_objectSpread2({},_t[_t.length-1].rect);if(ti.thisAnimationDuration){var ri=matrix(ti,!0);ri&&(ii.top-=ri.f,ii.left-=ri.e)}ti.fromRect=ii}})}},addAnimationState:function(ei){_t.push(ei)},removeAnimationState:function(ei){_t.splice(indexOfObject(_t,{target:ei}),1)},animateAll:function(ei){var ti=this;if(!this.options.animation){clearTimeout(e),typeof ei=="function"&&ei();return}var ii=!1,ri=0;_t.forEach(function(ni){var si=0,ai=ni.target,oi=ai.fromRect,li=getRect(ai),ci=ai.prevFromRect,ui=ai.prevToRect,di=ni.rect,fi=matrix(ai,!0);fi&&(li.top-=fi.f,li.left-=fi.e),ai.toRect=li,ai.thisAnimationDuration&&isRectEqual(ci,li)&&!isRectEqual(oi,li)&&(di.top-li.top)/(di.left-li.left)===(oi.top-li.top)/(oi.left-li.left)&&(si=calculateRealTime(di,ci,ui,ti.options)),isRectEqual(li,oi)||(ai.prevFromRect=oi,ai.prevToRect=li,si||(si=ti.options.animation),ti.animate(ai,di,li,si)),si&&(ii=!0,ri=Math.max(ri,si),clearTimeout(ai.animationResetTimer),ai.animationResetTimer=setTimeout(function(){ai.animationTime=0,ai.prevFromRect=null,ai.fromRect=null,ai.prevToRect=null,ai.thisAnimationDuration=null},si),ai.thisAnimationDuration=si)}),clearTimeout(e),ii?e=setTimeout(function(){typeof ei=="function"&&ei()},ri):typeof ei=="function"&&ei(),_t=[]},animate:function(ei,ti,ii,ri){if(ri){css(ei,"transition",""),css(ei,"transform","");var ni=matrix(this.el),si=ni&&ni.a,ai=ni&&ni.d,oi=(ti.left-ii.left)/(si||1),li=(ti.top-ii.top)/(ai||1);ei.animatingX=!!oi,ei.animatingY=!!li,css(ei,"transform","translate3d("+oi+"px,"+li+"px,0)"),this.forRepaintDummy=repaint(ei),css(ei,"transition","transform "+ri+"ms"+(this.options.easing?" "+this.options.easing:"")),css(ei,"transform","translate3d(0,0,0)"),typeof ei.animated=="number"&&clearTimeout(ei.animated),ei.animated=setTimeout(function(){css(ei,"transition",""),css(ei,"transform",""),ei.animated=!1,ei.animatingX=!1,ei.animatingY=!1},ri)}}}}function repaint(_t){return _t.offsetWidth}function calculateRealTime(_t,e,n,ei){return Math.sqrt(Math.pow(e.top-_t.top,2)+Math.pow(e.left-_t.left,2))/Math.sqrt(Math.pow(e.top-n.top,2)+Math.pow(e.left-n.left,2))*ei.animation}var plugins=[],defaults$1={initializeByDefault:!0},PluginManager={mount:function(e){for(var n in defaults$1)defaults$1.hasOwnProperty(n)&&!(n in e)&&(e[n]=defaults$1[n]);plugins.forEach(function(ei){if(ei.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),plugins.push(e)},pluginEvent:function(e,n,ei){var ti=this;this.eventCanceled=!1,ei.cancel=function(){ti.eventCanceled=!0};var ii=e+"Global";plugins.forEach(function(ri){n[ri.pluginName]&&(n[ri.pluginName][ii]&&n[ri.pluginName][ii](_objectSpread2({sortable:n},ei)),n.options[ri.pluginName]&&n[ri.pluginName][e]&&n[ri.pluginName][e](_objectSpread2({sortable:n},ei)))})},initializePlugins:function(e,n,ei,ti){plugins.forEach(function(ni){var si=ni.pluginName;if(!(!e.options[si]&&!ni.initializeByDefault)){var ai=new ni(e,n,e.options);ai.sortable=e,ai.options=e.options,e[si]=ai,_extends(ei,ai.defaults)}});for(var ii in e.options)if(e.options.hasOwnProperty(ii)){var ri=this.modifyOption(e,ii,e.options[ii]);typeof ri<"u"&&(e.options[ii]=ri)}},getEventProperties:function(e,n){var ei={};return plugins.forEach(function(ti){typeof ti.eventProperties=="function"&&_extends(ei,ti.eventProperties.call(n[ti.pluginName],e))}),ei},modifyOption:function(e,n,ei){var ti;return plugins.forEach(function(ii){e[ii.pluginName]&&ii.optionListeners&&typeof ii.optionListeners[n]=="function"&&(ti=ii.optionListeners[n].call(e[ii.pluginName],ei))}),ti}};function dispatchEvent(_t){var e=_t.sortable,n=_t.rootEl,ei=_t.name,ti=_t.targetEl,ii=_t.cloneEl,ri=_t.toEl,ni=_t.fromEl,si=_t.oldIndex,ai=_t.newIndex,oi=_t.oldDraggableIndex,li=_t.newDraggableIndex,ci=_t.originalEvent,ui=_t.putSortable,di=_t.extraEventProperties;if(e=e||n&&n[expando],!!e){var fi,hi=e.options,pi="on"+ei.charAt(0).toUpperCase()+ei.substr(1);window.CustomEvent&&!IE11OrLess&&!Edge?fi=new CustomEvent(ei,{bubbles:!0,cancelable:!0}):(fi=document.createEvent("Event"),fi.initEvent(ei,!0,!0)),fi.to=ri||n,fi.from=ni||n,fi.item=ti||n,fi.clone=ii,fi.oldIndex=si,fi.newIndex=ai,fi.oldDraggableIndex=oi,fi.newDraggableIndex=li,fi.originalEvent=ci,fi.pullMode=ui?ui.lastPutMode:void 0;var gi=_objectSpread2(_objectSpread2({},di),PluginManager.getEventProperties(ei,e));for(var vi in gi)fi[vi]=gi[vi];n&&n.dispatchEvent(fi),hi[pi]&&hi[pi].call(e,fi)}}var _excluded=["evt"],pluginEvent=function(e,n){var ei=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},ti=ei.evt,ii=_objectWithoutProperties(ei,_excluded);PluginManager.pluginEvent.bind(Sortable)(e,n,_objectSpread2({dragEl,parentEl,ghostEl,rootEl,nextEl,lastDownEl,cloneEl,cloneHidden,dragStarted:moved,putSortable,activeSortable:Sortable.active,originalEvent:ti,oldIndex,oldDraggableIndex,newIndex,newDraggableIndex,hideGhostForTarget:_hideGhostForTarget,unhideGhostForTarget:_unhideGhostForTarget,cloneNowHidden:function(){cloneHidden=!0},cloneNowShown:function(){cloneHidden=!1},dispatchSortableEvent:function(ni){_dispatchEvent({sortable:n,name:ni,originalEvent:ti})}},ii))};function _dispatchEvent(_t){dispatchEvent(_objectSpread2({putSortable,cloneEl,targetEl:dragEl,rootEl,oldIndex,oldDraggableIndex,newIndex,newDraggableIndex},_t))}var dragEl,parentEl,ghostEl,rootEl,nextEl,lastDownEl,cloneEl,cloneHidden,oldIndex,newIndex,oldDraggableIndex,newDraggableIndex,activeGroup,putSortable,awaitingDragStarted=!1,ignoreNextClick=!1,sortables=[],tapEvt,touchEvt,lastDx,lastDy,tapDistanceLeft,tapDistanceTop,moved,lastTarget,lastDirection,pastFirstInvertThresh=!1,isCircumstantialInvert=!1,targetMoveDistance,ghostRelativeParent,ghostRelativeParentInitialScroll=[],_silent=!1,savedInputChecked=[],documentExists=typeof document<"u",PositionGhostAbsolutely=IOS,CSSFloatProperty=Edge||IE11OrLess?"cssFloat":"float",supportDraggable=documentExists&&!ChromeForAndroid&&!IOS&&"draggable"in document.createElement("div"),supportCssPointerEvents=(function(){if(documentExists){if(IE11OrLess)return!1;var _t=document.createElement("x");return _t.style.cssText="pointer-events:auto",_t.style.pointerEvents==="auto"}})(),_detectDirection=function(e,n){var ei=css(e),ti=parseInt(ei.width)-parseInt(ei.paddingLeft)-parseInt(ei.paddingRight)-parseInt(ei.borderLeftWidth)-parseInt(ei.borderRightWidth),ii=getChild(e,0,n),ri=getChild(e,1,n),ni=ii&&css(ii),si=ri&&css(ri),ai=ni&&parseInt(ni.marginLeft)+parseInt(ni.marginRight)+getRect(ii).width,oi=si&&parseInt(si.marginLeft)+parseInt(si.marginRight)+getRect(ri).width;if(ei.display==="flex")return ei.flexDirection==="column"||ei.flexDirection==="column-reverse"?"vertical":"horizontal";if(ei.display==="grid")return ei.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(ii&&ni.float&&ni.float!=="none"){var li=ni.float==="left"?"left":"right";return ri&&(si.clear==="both"||si.clear===li)?"vertical":"horizontal"}return ii&&(ni.display==="block"||ni.display==="flex"||ni.display==="table"||ni.display==="grid"||ai>=ti&&ei[CSSFloatProperty]==="none"||ri&&ei[CSSFloatProperty]==="none"&&ai+oi>ti)?"vertical":"horizontal"},_dragElInRowColumn=function(e,n,ei){var ti=ei?e.left:e.top,ii=ei?e.right:e.bottom,ri=ei?e.width:e.height,ni=ei?n.left:n.top,si=ei?n.right:n.bottom,ai=ei?n.width:n.height;return ti===ni||ii===si||ti+ri/2===ni+ai/2},_detectNearestEmptySortable=function(e,n){var ei;return sortables.some(function(ti){var ii=ti[expando].options.emptyInsertThreshold;if(!(!ii||lastChild(ti))){var ri=getRect(ti),ni=e>=ri.left-ii&&e<=ri.right+ii,si=n>=ri.top-ii&&n<=ri.bottom+ii;if(ni&&si)return ei=ti}}),ei},_prepareGroup=function(e){function n(ii,ri){return function(ni,si,ai,oi){var li=ni.options.group.name&&si.options.group.name&&ni.options.group.name===si.options.group.name;if(ii==null&&(ri||li))return!0;if(ii==null||ii===!1)return!1;if(ri&&ii==="clone")return ii;if(typeof ii=="function")return n(ii(ni,si,ai,oi),ri)(ni,si,ai,oi);var ci=(ri?ni:si).options.group.name;return ii===!0||typeof ii=="string"&&ii===ci||ii.join&&ii.indexOf(ci)>-1}}var ei={},ti=e.group;(!ti||_typeof$1(ti)!="object")&&(ti={name:ti}),ei.name=ti.name,ei.checkPull=n(ti.pull,!0),ei.checkPut=n(ti.put),ei.revertClone=ti.revertClone,e.group=ei},_hideGhostForTarget=function(){!supportCssPointerEvents&&ghostEl&&css(ghostEl,"display","none")},_unhideGhostForTarget=function(){!supportCssPointerEvents&&ghostEl&&css(ghostEl,"display","")};documentExists&&!ChromeForAndroid&&document.addEventListener("click",function(_t){if(ignoreNextClick)return _t.preventDefault(),_t.stopPropagation&&_t.stopPropagation(),_t.stopImmediatePropagation&&_t.stopImmediatePropagation(),ignoreNextClick=!1,!1},!0);var nearestEmptyInsertDetectEvent=function(e){if(dragEl){e=e.touches?e.touches[0]:e;var n=_detectNearestEmptySortable(e.clientX,e.clientY);if(n){var ei={};for(var ti in e)e.hasOwnProperty(ti)&&(ei[ti]=e[ti]);ei.target=ei.rootEl=n,ei.preventDefault=void 0,ei.stopPropagation=void 0,n[expando]._onDragOver(ei)}}},_checkOutsideTargetEl=function(e){dragEl&&dragEl.parentNode[expando]._isOutsideThisEl(e.target)};function Sortable(_t,e){if(!(_t&&_t.nodeType&&_t.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(_t));this.el=_t,this.options=e=_extends({},e),_t[expando]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(_t.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return _detectDirection(_t,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(ri,ni){ri.setData("Text",ni.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:Sortable.supportPointer!==!1&&"PointerEvent"in window&&!Safari,emptyInsertThreshold:5};PluginManager.initializePlugins(this,_t,n);for(var ei in n)!(ei in e)&&(e[ei]=n[ei]);_prepareGroup(e);for(var ti in this)ti.charAt(0)==="_"&&typeof this[ti]=="function"&&(this[ti]=this[ti].bind(this));this.nativeDraggable=e.forceFallback?!1:supportDraggable,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?on(_t,"pointerdown",this._onTapStart):(on(_t,"mousedown",this._onTapStart),on(_t,"touchstart",this._onTapStart)),this.nativeDraggable&&(on(_t,"dragover",this),on(_t,"dragenter",this)),sortables.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),_extends(this,AnimationStateManager())}Sortable.prototype={constructor:Sortable,_isOutsideThisEl:function(e){!this.el.contains(e)&&e!==this.el&&(lastTarget=null)},_getDirection:function(e,n){return typeof this.options.direction=="function"?this.options.direction.call(this,e,n,dragEl):this.options.direction},_onTapStart:function(e){if(e.cancelable){var n=this,ei=this.el,ti=this.options,ii=ti.preventOnFilter,ri=e.type,ni=e.touches&&e.touches[0]||e.pointerType&&e.pointerType==="touch"&&e,si=(ni||e).target,ai=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||si,oi=ti.filter;if(_saveInputCheckedState(ei),!dragEl&&!(/mousedown|pointerdown/.test(ri)&&e.button!==0||ti.disabled)&&!ai.isContentEditable&&!(!this.nativeDraggable&&Safari&&si&&si.tagName.toUpperCase()==="SELECT")&&(si=closest(si,ti.draggable,ei,!1),!(si&&si.animated)&&lastDownEl!==si)){if(oldIndex=index(si),oldDraggableIndex=index(si,ti.draggable),typeof oi=="function"){if(oi.call(this,e,si,this)){_dispatchEvent({sortable:n,rootEl:ai,name:"filter",targetEl:si,toEl:ei,fromEl:ei}),pluginEvent("filter",n,{evt:e}),ii&&e.cancelable&&e.preventDefault();return}}else if(oi&&(oi=oi.split(",").some(function(li){if(li=closest(ai,li.trim(),ei,!1),li)return _dispatchEvent({sortable:n,rootEl:li,name:"filter",targetEl:si,fromEl:ei,toEl:ei}),pluginEvent("filter",n,{evt:e}),!0}),oi)){ii&&e.cancelable&&e.preventDefault();return}ti.handle&&!closest(ai,ti.handle,ei,!1)||this._prepareDragStart(e,ni,si)}}},_prepareDragStart:function(e,n,ei){var ti=this,ii=ti.el,ri=ti.options,ni=ii.ownerDocument,si;if(ei&&!dragEl&&ei.parentNode===ii){var ai=getRect(ei);if(rootEl=ii,dragEl=ei,parentEl=dragEl.parentNode,nextEl=dragEl.nextSibling,lastDownEl=ei,activeGroup=ri.group,Sortable.dragged=dragEl,tapEvt={target:dragEl,clientX:(n||e).clientX,clientY:(n||e).clientY},tapDistanceLeft=tapEvt.clientX-ai.left,tapDistanceTop=tapEvt.clientY-ai.top,this._lastX=(n||e).clientX,this._lastY=(n||e).clientY,dragEl.style["will-change"]="all",si=function(){if(pluginEvent("delayEnded",ti,{evt:e}),Sortable.eventCanceled){ti._onDrop();return}ti._disableDelayedDragEvents(),!FireFox&&ti.nativeDraggable&&(dragEl.draggable=!0),ti._triggerDragStart(e,n),_dispatchEvent({sortable:ti,name:"choose",originalEvent:e}),toggleClass(dragEl,ri.chosenClass,!0)},ri.ignore.split(",").forEach(function(oi){find(dragEl,oi.trim(),_disableDraggable)}),on(ni,"dragover",nearestEmptyInsertDetectEvent),on(ni,"mousemove",nearestEmptyInsertDetectEvent),on(ni,"touchmove",nearestEmptyInsertDetectEvent),on(ni,"mouseup",ti._onDrop),on(ni,"touchend",ti._onDrop),on(ni,"touchcancel",ti._onDrop),FireFox&&this.nativeDraggable&&(this.options.touchStartThreshold=4,dragEl.draggable=!0),pluginEvent("delayStart",this,{evt:e}),ri.delay&&(!ri.delayOnTouchOnly||n)&&(!this.nativeDraggable||!(Edge||IE11OrLess))){if(Sortable.eventCanceled){this._onDrop();return}on(ni,"mouseup",ti._disableDelayedDrag),on(ni,"touchend",ti._disableDelayedDrag),on(ni,"touchcancel",ti._disableDelayedDrag),on(ni,"mousemove",ti._delayedDragTouchMoveHandler),on(ni,"touchmove",ti._delayedDragTouchMoveHandler),ri.supportPointer&&on(ni,"pointermove",ti._delayedDragTouchMoveHandler),ti._dragStartTimer=setTimeout(si,ri.delay)}else si()}},_delayedDragTouchMoveHandler:function(e){var n=e.touches?e.touches[0]:e;Math.max(Math.abs(n.clientX-this._lastX),Math.abs(n.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){dragEl&&_disableDraggable(dragEl),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;off(e,"mouseup",this._disableDelayedDrag),off(e,"touchend",this._disableDelayedDrag),off(e,"touchcancel",this._disableDelayedDrag),off(e,"mousemove",this._delayedDragTouchMoveHandler),off(e,"touchmove",this._delayedDragTouchMoveHandler),off(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,n){n=n||e.pointerType=="touch"&&e,!this.nativeDraggable||n?this.options.supportPointer?on(document,"pointermove",this._onTouchMove):n?on(document,"touchmove",this._onTouchMove):on(document,"mousemove",this._onTouchMove):(on(dragEl,"dragend",this),on(rootEl,"dragstart",this._onDragStart));try{document.selection?_nextTick(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(e,n){if(awaitingDragStarted=!1,rootEl&&dragEl){pluginEvent("dragStarted",this,{evt:n}),this.nativeDraggable&&on(document,"dragover",_checkOutsideTargetEl);var ei=this.options;!e&&toggleClass(dragEl,ei.dragClass,!1),toggleClass(dragEl,ei.ghostClass,!0),Sortable.active=this,e&&this._appendGhost(),_dispatchEvent({sortable:this,name:"start",originalEvent:n})}else this._nulling()},_emulateDragOver:function(){if(touchEvt){this._lastX=touchEvt.clientX,this._lastY=touchEvt.clientY,_hideGhostForTarget();for(var e=document.elementFromPoint(touchEvt.clientX,touchEvt.clientY),n=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(touchEvt.clientX,touchEvt.clientY),e!==n);)n=e;if(dragEl.parentNode[expando]._isOutsideThisEl(e),n)do{if(n[expando]){var ei=void 0;if(ei=n[expando]._onDragOver({clientX:touchEvt.clientX,clientY:touchEvt.clientY,target:e,rootEl:n}),ei&&!this.options.dragoverBubble)break}e=n}while(n=getParentOrHost(n));_unhideGhostForTarget()}},_onTouchMove:function(e){if(tapEvt){var n=this.options,ei=n.fallbackTolerance,ti=n.fallbackOffset,ii=e.touches?e.touches[0]:e,ri=ghostEl&&matrix(ghostEl,!0),ni=ghostEl&&ri&&ri.a,si=ghostEl&&ri&&ri.d,ai=PositionGhostAbsolutely&&ghostRelativeParent&&getRelativeScrollOffset(ghostRelativeParent),oi=(ii.clientX-tapEvt.clientX+ti.x)/(ni||1)+(ai?ai[0]-ghostRelativeParentInitialScroll[0]:0)/(ni||1),li=(ii.clientY-tapEvt.clientY+ti.y)/(si||1)+(ai?ai[1]-ghostRelativeParentInitialScroll[1]:0)/(si||1);if(!Sortable.active&&!awaitingDragStarted){if(ei&&Math.max(Math.abs(ii.clientX-this._lastX),Math.abs(ii.clientY-this._lastY))<ei)return;this._onDragStart(e,!0)}if(ghostEl){ri?(ri.e+=oi-(lastDx||0),ri.f+=li-(lastDy||0)):ri={a:1,b:0,c:0,d:1,e:oi,f:li};var ci="matrix(".concat(ri.a,",").concat(ri.b,",").concat(ri.c,",").concat(ri.d,",").concat(ri.e,",").concat(ri.f,")");css(ghostEl,"webkitTransform",ci),css(ghostEl,"mozTransform",ci),css(ghostEl,"msTransform",ci),css(ghostEl,"transform",ci),lastDx=oi,lastDy=li,touchEvt=ii}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!ghostEl){var e=this.options.fallbackOnBody?document.body:rootEl,n=getRect(dragEl,!0,PositionGhostAbsolutely,!0,e),ei=this.options;if(PositionGhostAbsolutely){for(ghostRelativeParent=e;css(ghostRelativeParent,"position")==="static"&&css(ghostRelativeParent,"transform")==="none"&&ghostRelativeParent!==document;)ghostRelativeParent=ghostRelativeParent.parentNode;ghostRelativeParent!==document.body&&ghostRelativeParent!==document.documentElement?(ghostRelativeParent===document&&(ghostRelativeParent=getWindowScrollingElement()),n.top+=ghostRelativeParent.scrollTop,n.left+=ghostRelativeParent.scrollLeft):ghostRelativeParent=getWindowScrollingElement(),ghostRelativeParentInitialScroll=getRelativeScrollOffset(ghostRelativeParent)}ghostEl=dragEl.cloneNode(!0),toggleClass(ghostEl,ei.ghostClass,!1),toggleClass(ghostEl,ei.fallbackClass,!0),toggleClass(ghostEl,ei.dragClass,!0),css(ghostEl,"transition",""),css(ghostEl,"transform",""),css(ghostEl,"box-sizing","border-box"),css(ghostEl,"margin",0),css(ghostEl,"top",n.top),css(ghostEl,"left",n.left),css(ghostEl,"width",n.width),css(ghostEl,"height",n.height),css(ghostEl,"opacity","0.8"),css(ghostEl,"position",PositionGhostAbsolutely?"absolute":"fixed"),css(ghostEl,"zIndex","100000"),css(ghostEl,"pointerEvents","none"),Sortable.ghost=ghostEl,e.appendChild(ghostEl),css(ghostEl,"transform-origin",tapDistanceLeft/parseInt(ghostEl.style.width)*100+"% "+tapDistanceTop/parseInt(ghostEl.style.height)*100+"%")}},_onDragStart:function(e,n){var ei=this,ti=e.dataTransfer,ii=ei.options;if(pluginEvent("dragStart",this,{evt:e}),Sortable.eventCanceled){this._onDrop();return}pluginEvent("setupClone",this),Sortable.eventCanceled||(cloneEl=clone(dragEl),cloneEl.removeAttribute("id"),cloneEl.draggable=!1,cloneEl.style["will-change"]="",this._hideClone(),toggleClass(cloneEl,this.options.chosenClass,!1),Sortable.clone=cloneEl),ei.cloneId=_nextTick(function(){pluginEvent("clone",ei),!Sortable.eventCanceled&&(ei.options.removeCloneOnHide||rootEl.insertBefore(cloneEl,dragEl),ei._hideClone(),_dispatchEvent({sortable:ei,name:"clone"}))}),!n&&toggleClass(dragEl,ii.dragClass,!0),n?(ignoreNextClick=!0,ei._loopId=setInterval(ei._emulateDragOver,50)):(off(document,"mouseup",ei._onDrop),off(document,"touchend",ei._onDrop),off(document,"touchcancel",ei._onDrop),ti&&(ti.effectAllowed="move",ii.setData&&ii.setData.call(ei,ti,dragEl)),on(document,"drop",ei),css(dragEl,"transform","translateZ(0)")),awaitingDragStarted=!0,ei._dragStartId=_nextTick(ei._dragStarted.bind(ei,n,e)),on(document,"selectstart",ei),moved=!0,Safari&&css(document.body,"user-select","none")},_onDragOver:function(e){var n=this.el,ei=e.target,ti,ii,ri,ni=this.options,si=ni.group,ai=Sortable.active,oi=activeGroup===si,li=ni.sort,ci=putSortable||ai,ui,di=this,fi=!1;if(_silent)return;function hi(Vi,nr){pluginEvent(Vi,di,_objectSpread2({evt:e,isOwner:oi,axis:ui?"vertical":"horizontal",revert:ri,dragRect:ti,targetRect:ii,canSort:li,fromSortable:ci,target:ei,completed:gi,onMove:function(Wi,Ti){return _onMove(rootEl,n,dragEl,ti,Wi,getRect(Wi),e,Ti)},changed:vi},nr))}function pi(){hi("dragOverAnimationCapture"),di.captureAnimationState(),di!==ci&&ci.captureAnimationState()}function gi(Vi){return hi("dragOverCompleted",{insertion:Vi}),Vi&&(oi?ai._hideClone():ai._showClone(di),di!==ci&&(toggleClass(dragEl,putSortable?putSortable.options.ghostClass:ai.options.ghostClass,!1),toggleClass(dragEl,ni.ghostClass,!0)),putSortable!==di&&di!==Sortable.active?putSortable=di:di===Sortable.active&&putSortable&&(putSortable=null),ci===di&&(di._ignoreWhileAnimating=ei),di.animateAll(function(){hi("dragOverAnimationComplete"),di._ignoreWhileAnimating=null}),di!==ci&&(ci.animateAll(),ci._ignoreWhileAnimating=null)),(ei===dragEl&&!dragEl.animated||ei===n&&!ei.animated)&&(lastTarget=null),!ni.dragoverBubble&&!e.rootEl&&ei!==document&&(dragEl.parentNode[expando]._isOutsideThisEl(e.target),!Vi&&nearestEmptyInsertDetectEvent(e)),!ni.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),fi=!0}function vi(){newIndex=index(dragEl),newDraggableIndex=index(dragEl,ni.draggable),_dispatchEvent({sortable:di,name:"change",toEl:n,newIndex,newDraggableIndex,originalEvent:e})}if(e.preventDefault!==void 0&&e.cancelable&&e.preventDefault(),ei=closest(ei,ni.draggable,n,!0),hi("dragOver"),Sortable.eventCanceled)return fi;if(dragEl.contains(e.target)||ei.animated&&ei.animatingX&&ei.animatingY||di._ignoreWhileAnimating===ei)return gi(!1);if(ignoreNextClick=!1,ai&&!ni.disabled&&(oi?li||(ri=parentEl!==rootEl):putSortable===this||(this.lastPutMode=activeGroup.checkPull(this,ai,dragEl,e))&&si.checkPut(this,ai,dragEl,e))){if(ui=this._getDirection(e,ei)==="vertical",ti=getRect(dragEl),hi("dragOverValid"),Sortable.eventCanceled)return fi;if(ri)return parentEl=rootEl,pi(),this._hideClone(),hi("revert"),Sortable.eventCanceled||(nextEl?rootEl.insertBefore(dragEl,nextEl):rootEl.appendChild(dragEl)),gi(!0);var yi=lastChild(n,ni.draggable);if(!yi||_ghostIsLast(e,ui,this)&&!yi.animated){if(yi===dragEl)return gi(!1);if(yi&&n===e.target&&(ei=yi),ei&&(ii=getRect(ei)),_onMove(rootEl,n,dragEl,ti,ei,ii,e,!!ei)!==!1)return pi(),yi&&yi.nextSibling?n.insertBefore(dragEl,yi.nextSibling):n.appendChild(dragEl),parentEl=n,vi(),gi(!0)}else if(yi&&_ghostIsFirst(e,ui,this)){var _i=getChild(n,0,ni,!0);if(_i===dragEl)return gi(!1);if(ei=_i,ii=getRect(ei),_onMove(rootEl,n,dragEl,ti,ei,ii,e,!1)!==!1)return pi(),n.insertBefore(dragEl,_i),parentEl=n,vi(),gi(!0)}else if(ei.parentNode===n){ii=getRect(ei);var Ai=0,Ei,Si=dragEl.parentNode!==n,wi=!_dragElInRowColumn(dragEl.animated&&dragEl.toRect||ti,ei.animated&&ei.toRect||ii,ui),Oi=ui?"top":"left",Ii=isScrolledPast(ei,"top","top")||isScrolledPast(dragEl,"top","top"),Li=Ii?Ii.scrollTop:void 0;lastTarget!==ei&&(Ei=ii[Oi],pastFirstInvertThresh=!1,isCircumstantialInvert=!wi&&ni.invertSwap||Si),Ai=_getSwapDirection(e,ei,ii,ui,wi?1:ni.swapThreshold,ni.invertedSwapThreshold==null?ni.swapThreshold:ni.invertedSwapThreshold,isCircumstantialInvert,lastTarget===ei);var Di;if(Ai!==0){var Ni=index(dragEl);do Ni-=Ai,Di=parentEl.children[Ni];while(Di&&(css(Di,"display")==="none"||Di===ghostEl))}if(Ai===0||Di===ei)return gi(!1);lastTarget=ei,lastDirection=Ai;var $i=ei.nextElementSibling,Ki=!1;Ki=Ai===1;var er=_onMove(rootEl,n,dragEl,ti,ei,ii,e,Ki);if(er!==!1)return(er===1||er===-1)&&(Ki=er===1),_silent=!0,setTimeout(_unsilent,30),pi(),Ki&&!$i?n.appendChild(dragEl):ei.parentNode.insertBefore(dragEl,Ki?$i:ei),Ii&&scrollBy(Ii,0,Li-Ii.scrollTop),parentEl=dragEl.parentNode,Ei!==void 0&&!isCircumstantialInvert&&(targetMoveDistance=Math.abs(Ei-getRect(ei)[Oi])),vi(),gi(!0)}if(n.contains(dragEl))return gi(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){off(document,"mousemove",this._onTouchMove),off(document,"touchmove",this._onTouchMove),off(document,"pointermove",this._onTouchMove),off(document,"dragover",nearestEmptyInsertDetectEvent),off(document,"mousemove",nearestEmptyInsertDetectEvent),off(document,"touchmove",nearestEmptyInsertDetectEvent)},_offUpEvents:function(){var e=this.el.ownerDocument;off(e,"mouseup",this._onDrop),off(e,"touchend",this._onDrop),off(e,"pointerup",this._onDrop),off(e,"touchcancel",this._onDrop),off(document,"selectstart",this)},_onDrop:function(e){var n=this.el,ei=this.options;if(newIndex=index(dragEl),newDraggableIndex=index(dragEl,ei.draggable),pluginEvent("drop",this,{evt:e}),parentEl=dragEl&&dragEl.parentNode,newIndex=index(dragEl),newDraggableIndex=index(dragEl,ei.draggable),Sortable.eventCanceled){this._nulling();return}awaitingDragStarted=!1,isCircumstantialInvert=!1,pastFirstInvertThresh=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),_cancelNextTick(this.cloneId),_cancelNextTick(this._dragStartId),this.nativeDraggable&&(off(document,"drop",this),off(n,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Safari&&css(document.body,"user-select",""),css(dragEl,"transform",""),e&&(moved&&(e.cancelable&&e.preventDefault(),!ei.dropBubble&&e.stopPropagation()),ghostEl&&ghostEl.parentNode&&ghostEl.parentNode.removeChild(ghostEl),(rootEl===parentEl||putSortable&&putSortable.lastPutMode!=="clone")&&cloneEl&&cloneEl.parentNode&&cloneEl.parentNode.removeChild(cloneEl),dragEl&&(this.nativeDraggable&&off(dragEl,"dragend",this),_disableDraggable(dragEl),dragEl.style["will-change"]="",moved&&!awaitingDragStarted&&toggleClass(dragEl,putSortable?putSortable.options.ghostClass:this.options.ghostClass,!1),toggleClass(dragEl,this.options.chosenClass,!1),_dispatchEvent({sortable:this,name:"unchoose",toEl:parentEl,newIndex:null,newDraggableIndex:null,originalEvent:e}),rootEl!==parentEl?(newIndex>=0&&(_dispatchEvent({rootEl:parentEl,name:"add",toEl:parentEl,fromEl:rootEl,originalEvent:e}),_dispatchEvent({sortable:this,name:"remove",toEl:parentEl,originalEvent:e}),_dispatchEvent({rootEl:parentEl,name:"sort",toEl:parentEl,fromEl:rootEl,originalEvent:e}),_dispatchEvent({sortable:this,name:"sort",toEl:parentEl,originalEvent:e})),putSortable&&putSortable.save()):newIndex!==oldIndex&&newIndex>=0&&(_dispatchEvent({sortable:this,name:"update",toEl:parentEl,originalEvent:e}),_dispatchEvent({sortable:this,name:"sort",toEl:parentEl,originalEvent:e})),Sortable.active&&((newIndex==null||newIndex===-1)&&(newIndex=oldIndex,newDraggableIndex=oldDraggableIndex),_dispatchEvent({sortable:this,name:"end",toEl:parentEl,originalEvent:e}),this.save()))),this._nulling()},_nulling:function(){pluginEvent("nulling",this),rootEl=dragEl=parentEl=ghostEl=nextEl=cloneEl=lastDownEl=cloneHidden=tapEvt=touchEvt=moved=newIndex=newDraggableIndex=oldIndex=oldDraggableIndex=lastTarget=lastDirection=putSortable=activeGroup=Sortable.dragged=Sortable.ghost=Sortable.clone=Sortable.active=null,savedInputChecked.forEach(function(e){e.checked=!0}),savedInputChecked.length=lastDx=lastDy=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":dragEl&&(this._onDragOver(e),_globalDragOver(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e=[],n,ei=this.el.children,ti=0,ii=ei.length,ri=this.options;ti<ii;ti++)n=ei[ti],closest(n,ri.draggable,this.el,!1)&&e.push(n.getAttribute(ri.dataIdAttr)||_generateId(n));return e},sort:function(e,n){var ei={},ti=this.el;this.toArray().forEach(function(ii,ri){var ni=ti.children[ri];closest(ni,this.options.draggable,ti,!1)&&(ei[ii]=ni)},this),n&&this.captureAnimationState(),e.forEach(function(ii){ei[ii]&&(ti.removeChild(ei[ii]),ti.appendChild(ei[ii]))}),n&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,n){return closest(e,n||this.options.draggable,this.el,!1)},option:function(e,n){var ei=this.options;if(n===void 0)return ei[e];var ti=PluginManager.modifyOption(this,e,n);typeof ti<"u"?ei[e]=ti:ei[e]=n,e==="group"&&_prepareGroup(ei)},destroy:function(){pluginEvent("destroy",this);var e=this.el;e[expando]=null,off(e,"mousedown",this._onTapStart),off(e,"touchstart",this._onTapStart),off(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(off(e,"dragover",this),off(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(n){n.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),sortables.splice(sortables.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!cloneHidden){if(pluginEvent("hideClone",this),Sortable.eventCanceled)return;css(cloneEl,"display","none"),this.options.removeCloneOnHide&&cloneEl.parentNode&&cloneEl.parentNode.removeChild(cloneEl),cloneHidden=!0}},_showClone:function(e){if(e.lastPutMode!=="clone"){this._hideClone();return}if(cloneHidden){if(pluginEvent("showClone",this),Sortable.eventCanceled)return;dragEl.parentNode==rootEl&&!this.options.group.revertClone?rootEl.insertBefore(cloneEl,dragEl):nextEl?rootEl.insertBefore(cloneEl,nextEl):rootEl.appendChild(cloneEl),this.options.group.revertClone&&this.animate(dragEl,cloneEl),css(cloneEl,"display",""),cloneHidden=!1}}};function _globalDragOver(_t){_t.dataTransfer&&(_t.dataTransfer.dropEffect="move"),_t.cancelable&&_t.preventDefault()}function _onMove(_t,e,n,ei,ti,ii,ri,ni){var si,ai=_t[expando],oi=ai.options.onMove,li;return window.CustomEvent&&!IE11OrLess&&!Edge?si=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(si=document.createEvent("Event"),si.initEvent("move",!0,!0)),si.to=e,si.from=_t,si.dragged=n,si.draggedRect=ei,si.related=ti||e,si.relatedRect=ii||getRect(e),si.willInsertAfter=ni,si.originalEvent=ri,_t.dispatchEvent(si),oi&&(li=oi.call(ai,si,ri)),li}function _disableDraggable(_t){_t.draggable=!1}function _unsilent(){_silent=!1}function _ghostIsFirst(_t,e,n){var ei=getRect(getChild(n.el,0,n.options,!0)),ti=getChildContainingRectFromElement(n.el,n.options,ghostEl),ii=10;return e?_t.clientX<ti.left-ii||_t.clientY<ei.top&&_t.clientX<ei.right:_t.clientY<ti.top-ii||_t.clientY<ei.bottom&&_t.clientX<ei.left}function _ghostIsLast(_t,e,n){var ei=getRect(lastChild(n.el,n.options.draggable)),ti=getChildContainingRectFromElement(n.el,n.options,ghostEl),ii=10;return e?_t.clientX>ti.right+ii||_t.clientY>ei.bottom&&_t.clientX>ei.left:_t.clientY>ti.bottom+ii||_t.clientX>ei.right&&_t.clientY>ei.top}function _getSwapDirection(_t,e,n,ei,ti,ii,ri,ni){var si=ei?_t.clientY:_t.clientX,ai=ei?n.height:n.width,oi=ei?n.top:n.left,li=ei?n.bottom:n.right,ci=!1;if(!ri){if(ni&&targetMoveDistance<ai*ti){if(!pastFirstInvertThresh&&(lastDirection===1?si>oi+ai*ii/2:si<li-ai*ii/2)&&(pastFirstInvertThresh=!0),pastFirstInvertThresh)ci=!0;else if(lastDirection===1?si<oi+targetMoveDistance:si>li-targetMoveDistance)return-lastDirection}else if(si>oi+ai*(1-ti)/2&&si<li-ai*(1-ti)/2)return _getInsertDirection(e)}return ci=ci||ri,ci&&(si<oi+ai*ii/2||si>li-ai*ii/2)?si>oi+ai/2?1:-1:0}function _getInsertDirection(_t){return index(dragEl)<index(_t)?1:-1}function _generateId(_t){for(var e=_t.tagName+_t.className+_t.src+_t.href+_t.textContent,n=e.length,ei=0;n--;)ei+=e.charCodeAt(n);return ei.toString(36)}function _saveInputCheckedState(_t){savedInputChecked.length=0;for(var e=_t.getElementsByTagName("input"),n=e.length;n--;){var ei=e[n];ei.checked&&savedInputChecked.push(ei)}}function _nextTick(_t){return setTimeout(_t,0)}function _cancelNextTick(_t){return clearTimeout(_t)}documentExists&&on(document,"touchmove",function(_t){(Sortable.active||awaitingDragStarted)&&_t.cancelable&&_t.preventDefault()});Sortable.utils={on,off,css,find,is:function(e,n){return!!closest(e,n,e,!1)},extend:extend$1,throttle,closest,toggleClass,clone,index,nextTick:_nextTick,cancelNextTick:_cancelNextTick,detectDirection:_detectDirection,getChild,expando};Sortable.get=function(_t){return _t[expando]};Sortable.mount=function(){for(var _t=arguments.length,e=new Array(_t),n=0;n<_t;n++)e[n]=arguments[n];e[0].constructor===Array&&(e=e[0]),e.forEach(function(ei){if(!ei.prototype||!ei.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(ei));ei.utils&&(Sortable.utils=_objectSpread2(_objectSpread2({},Sortable.utils),ei.utils)),PluginManager.mount(ei)})};Sortable.create=function(_t,e){return new Sortable(_t,e)};Sortable.version=version;var autoScrolls=[],scrollEl,scrollRootEl,scrolling=!1,lastAutoScrollX,lastAutoScrollY,touchEvt$1,pointerElemChangedInterval;function AutoScrollPlugin(){function _t(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var e in this)e.charAt(0)==="_"&&typeof this[e]=="function"&&(this[e]=this[e].bind(this))}return _t.prototype={dragStarted:function(n){var ei=n.originalEvent;this.sortable.nativeDraggable?on(document,"dragover",this._handleAutoScroll):this.options.supportPointer?on(document,"pointermove",this._handleFallbackAutoScroll):ei.touches?on(document,"touchmove",this._handleFallbackAutoScroll):on(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(n){var ei=n.originalEvent;!this.options.dragOverBubble&&!ei.rootEl&&this._handleAutoScroll(ei)},drop:function(){this.sortable.nativeDraggable?off(document,"dragover",this._handleAutoScroll):(off(document,"pointermove",this._handleFallbackAutoScroll),off(document,"touchmove",this._handleFallbackAutoScroll),off(document,"mousemove",this._handleFallbackAutoScroll)),clearPointerElemChangedInterval(),clearAutoScrolls(),cancelThrottle()},nulling:function(){touchEvt$1=scrollRootEl=scrollEl=scrolling=pointerElemChangedInterval=lastAutoScrollX=lastAutoScrollY=null,autoScrolls.length=0},_handleFallbackAutoScroll:function(n){this._handleAutoScroll(n,!0)},_handleAutoScroll:function(n,ei){var ti=this,ii=(n.touches?n.touches[0]:n).clientX,ri=(n.touches?n.touches[0]:n).clientY,ni=document.elementFromPoint(ii,ri);if(touchEvt$1=n,ei||this.options.forceAutoScrollFallback||Edge||IE11OrLess||Safari){autoScroll(n,this.options,ni,ei);var si=getParentAutoScrollElement(ni,!0);scrolling&&(!pointerElemChangedInterval||ii!==lastAutoScrollX||ri!==lastAutoScrollY)&&(pointerElemChangedInterval&&clearPointerElemChangedInterval(),pointerElemChangedInterval=setInterval(function(){var ai=getParentAutoScrollElement(document.elementFromPoint(ii,ri),!0);ai!==si&&(si=ai,clearAutoScrolls()),autoScroll(n,ti.options,ai,ei)},10),lastAutoScrollX=ii,lastAutoScrollY=ri)}else{if(!this.options.bubbleScroll||getParentAutoScrollElement(ni,!0)===getWindowScrollingElement()){clearAutoScrolls();return}autoScroll(n,this.options,getParentAutoScrollElement(ni,!1),!1)}}},_extends(_t,{pluginName:"scroll",initializeByDefault:!0})}function clearAutoScrolls(){autoScrolls.forEach(function(_t){clearInterval(_t.pid)}),autoScrolls=[]}function clearPointerElemChangedInterval(){clearInterval(pointerElemChangedInterval)}var autoScroll=throttle(function(_t,e,n,ei){if(e.scroll){var ti=(_t.touches?_t.touches[0]:_t).clientX,ii=(_t.touches?_t.touches[0]:_t).clientY,ri=e.scrollSensitivity,ni=e.scrollSpeed,si=getWindowScrollingElement(),ai=!1,oi;scrollRootEl!==n&&(scrollRootEl=n,clearAutoScrolls(),scrollEl=e.scroll,oi=e.scrollFn,scrollEl===!0&&(scrollEl=getParentAutoScrollElement(n,!0)));var li=0,ci=scrollEl;do{var ui=ci,di=getRect(ui),fi=di.top,hi=di.bottom,pi=di.left,gi=di.right,vi=di.width,yi=di.height,_i=void 0,Ai=void 0,Ei=ui.scrollWidth,Si=ui.scrollHeight,wi=css(ui),Oi=ui.scrollLeft,Ii=ui.scrollTop;ui===si?(_i=vi<Ei&&(wi.overflowX==="auto"||wi.overflowX==="scroll"||wi.overflowX==="visible"),Ai=yi<Si&&(wi.overflowY==="auto"||wi.overflowY==="scroll"||wi.overflowY==="visible")):(_i=vi<Ei&&(wi.overflowX==="auto"||wi.overflowX==="scroll"),Ai=yi<Si&&(wi.overflowY==="auto"||wi.overflowY==="scroll"));var Li=_i&&(Math.abs(gi-ti)<=ri&&Oi+vi<Ei)-(Math.abs(pi-ti)<=ri&&!!Oi),Di=Ai&&(Math.abs(hi-ii)<=ri&&Ii+yi<Si)-(Math.abs(fi-ii)<=ri&&!!Ii);if(!autoScrolls[li])for(var Ni=0;Ni<=li;Ni++)autoScrolls[Ni]||(autoScrolls[Ni]={});(autoScrolls[li].vx!=Li||autoScrolls[li].vy!=Di||autoScrolls[li].el!==ui)&&(autoScrolls[li].el=ui,autoScrolls[li].vx=Li,autoScrolls[li].vy=Di,clearInterval(autoScrolls[li].pid),(Li!=0||Di!=0)&&(ai=!0,autoScrolls[li].pid=setInterval((function(){ei&&this.layer===0&&Sortable.active._onTouchMove(touchEvt$1);var $i=autoScrolls[this.layer].vy?autoScrolls[this.layer].vy*ni:0,Ki=autoScrolls[this.layer].vx?autoScrolls[this.layer].vx*ni:0;typeof oi=="function"&&oi.call(Sortable.dragged.parentNode[expando],Ki,$i,_t,touchEvt$1,autoScrolls[this.layer].el)!=="continue"||scrollBy(autoScrolls[this.layer].el,Ki,$i)}).bind({layer:li}),24))),li++}while(e.bubbleScroll&&ci!==si&&(ci=getParentAutoScrollElement(ci,!1)));scrolling=ai}},30),drop=function(e){var n=e.originalEvent,ei=e.putSortable,ti=e.dragEl,ii=e.activeSortable,ri=e.dispatchSortableEvent,ni=e.hideGhostForTarget,si=e.unhideGhostForTarget;if(n){var ai=ei||ii;ni();var oi=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:n,li=document.elementFromPoint(oi.clientX,oi.clientY);si(),ai&&!ai.el.contains(li)&&(ri("spill"),this.onSpill({dragEl:ti,putSortable:ei}))}};function Revert(){}Revert.prototype={startIndex:null,dragStart:function(e){var n=e.oldDraggableIndex;this.startIndex=n},onSpill:function(e){var n=e.dragEl,ei=e.putSortable;this.sortable.captureAnimationState(),ei&&ei.captureAnimationState();var ti=getChild(this.sortable.el,this.startIndex,this.options);ti?this.sortable.el.insertBefore(n,ti):this.sortable.el.appendChild(n),this.sortable.animateAll(),ei&&ei.animateAll()},drop};_extends(Revert,{pluginName:"revertOnSpill"});function Remove(){}Remove.prototype={onSpill:function(e){var n=e.dragEl,ei=e.putSortable,ti=ei||this.sortable;ti.captureAnimationState(),n.parentNode&&n.parentNode.removeChild(n),ti.animateAll()},drop};_extends(Remove,{pluginName:"removeOnSpill"});Sortable.mount(new AutoScrollPlugin);Sortable.mount(Remove,Revert);var LayerSwitcherDOM={_createDraggableElement:function(_t,e){let n=[".GPtitle"];checkDsfr()&&n.push(".GPlayerDragNDrop"),navigator.userAgent.match(/chrome|chromium|crios/i),e._sortables=[],n.forEach(ei=>{const ti=Sortable.create(_t,{handle:ei,dataIdAttr:"data-sortable-id",draggable:".draggable-layer",ghostClass:"GPghostLayer",animation:200,onEnd:function(ii){e._onEndDragAndDropLayerClick(ii)}});e._sortables.push(ti)})},_moveElement:function(_t,e){const n=this._sortables[0];if(["up","down"].includes(e)==!1||typeof _t.dataset.sortableId>"u")return!1;let ei=_t.dataset.sortableId,ti=n.toArray(),ii=ti.indexOf(ei);return ti.splice(ii,1),e=="down"?ti.splice(ii+1,0,ei):e=="up"&&ti.splice(ii-1,0,ei),n.sort(ti,!0),this._onEndDragAndDropLayerClick({newIndex:ti.indexOf(ei)}),!0},_onMoveElement:function(_t,e){if(["Enter","Space"].includes(e.code)){const n=_t?"up":"down",ei=_t?"down":"up";e.stopPropagation(),e.preventDefault(),this._moveElement(e.currentTarget.closest(".draggable-layer"),n),window.getComputedStyle(e.currentTarget).visibility=="hidden"?e.currentTarget.parentNode.querySelector(`[data-direction=${ei}]`).focus():e.currentTarget.focus()}},_addUID:function(_t){var e=this._uid?_t+"-"+this._uid:_t;return e},_createMainContainerElement:function(){var _t=document.createElement("div");return _t.id=this._addUID("GPlayerSwitcher"),_t.className="GPwidget gpf-widget gpf-mobile-fullscreen gpf-widget-button",_t},_createMainLayersShowElement:function(){var _t=document.createElement("input");return _t.id=this._addUID("GPshowLayersList"),_t.type="checkbox",_t},_createMainLayersElement:function(){var _t=document.createElement("dialog");return _t.id=this._addUID("GPlayersList"),_t.className="GPpanel gpf-panel fr-modal",_t},_createMainLayersDivElement:function(){var _t=document.createElement("div");return _t.className="GPpanelBody gpf-panel__body_ls fr-modal__body",_t},_createMainLayerListElement:function(){var _t=document.createElement("div");return _t.className="GPLayerListBody",_t.setAttribute("role","list"),_t},_createMainPictoElement:function(){var _t=this,e=document.createElement("button"),n=document.createElement("span");return e.appendChild(n),e.id=this._addUID("GPshowLayersListPicto"),e.classList.add("GPshowOpen","GPshowAdvancedToolPicto","GPshowLayersListPicto"),e.classList.add("gpf-btn","gpf-btn--tertiary","gpf-btn-icon","gpf-btn-icon-layerswitcher"),e.classList.add("fr-btn","fr-btn--tertiary"),e.htmlFor=this._addUID("GPshowLayersList"),e.setAttribute("aria-label","Ma slection de cartes"),e.setAttribute("tabindex","0"),e.setAttribute("aria-pressed",!1),e.setAttribute("type","button"),e.addEventListener?e.addEventListener("click",function(ei){var ti=ei.target.ariaPressed==="true";ei.target.setAttribute("aria-pressed",!ti),document.getElementById(_t._addUID("GPshowLayersList")).checked=ti,document.getElementById(_t._addUID("GPshowLayersList")).checked&&(document.getElementById(_t._addUID("GPlayerInfoPanel")).classList.remove("GPlayerInfoPanelOpened","gpf-visible"),document.getElementById(_t._addUID("GPlayerInfoPanel")).classList.add("GPlayerInfoPanelClosed","gpf-hidden"),document.getElementById(_t._addUID("GPlayerStylePanel")).classList.add("GPlayerStylePanelClosed","gpf-hidden"),document.getElementById(_t._addUID("GPlayerStylePanel")).classList.remove("GPlayerStylePanelOpened","gpf-visible")),_t.onShowLayerSwitcherClick(ei)}):e.attachEvent&&e.attachEvent("onclick",function(ei){var ti=ei.target.ariaPressed==="true";ei.target.setAttribute("aria-pressed",!ti),document.getElementById(_t._addUID("GPshowLayersList")).checked&&(document.getElementById(_t._addUID("GPlayerInfoPanel")).classList.remove("GPlayerInfoPanelOpened","gpf-visible"),document.getElementById(_t._addUID("GPlayerInfoPanel")).classList.add("GPlayerInfoPanelClosed","gpf-hidden"),document.getElementById(_t._addUID("GPlayerStylePanel")).classList.add("GPlayerStylePanelClosed","gpf-hidden"),document.getElementById(_t._addUID("GPlayerStylePanel")).classList.remove("GPlayerStylePanelOpened","gpf-visible")),_t.onShowLayerSwitcherClick(ei)}),e},_createMainCounterLayersElement:function(){var _t=document.createElement("span");return _t.id=this._addUID("GPlayerCounter"),_t.className="GPlayerCounter",_t.innerHTML="0",_t},_createMainInfoElement:function(){var _t=document.createElement("dialog");return _t.id=this._addUID("GPlayerInfoPanel"),_t.className="GPpanel GPlayerInfoPanelClosed gpf-panel fr-modal",_t},_createMainInfoDivElement:function(){var _t=document.createElement("div");return _t.className="gpf-panel__body fr-modal__body",_t},_createMainStyleElement:function(){var _t=document.createElement("dialog");return _t.id=this._addUID("GPlayerStylePanel"),_t.className="GPpanel GPlayerStylePanelClosed gpf-panel fr-modal",_t},_createMainStyleDivElement:function(){var _t=document.createElement("div");return _t.className="gpf-panel__body fr-modal__body",_t},_createLayersPanelHeaderElement:function(){var _t=document.createElement("div");return _t.className="GPpanelHeader gpf-panel__header_ls",_t},_createLayersPanelIconElement:function(){var _t=document.createElement("label");return _t.className="GPpanelIcon gpf-btn-header gpf-btn-icon-layers",_t.title="Couches",_t},_createLayersPanelTitleElement:function(){var _t=document.createElement("div");return _t.className="GPpanelTitle gpf-panel__title_ls",_t.id=this._addUID("GPlayersHeaderTitle"),_t.innerHTML="Couches",_t},_createLayersPanelCloseElement:function(){var _t=this,e=document.createElement("button");e.id=this._addUID("GPlayersPanelClose"),e.className="GPpanelClose GPlayersPanelClose gpf-btn gpf-btn-icon-close fr-btn--close fr-btn fr-btn--tertiary-no-outline fr-m-1w",e.title="Fermer le panneau";var n=document.createElement("span");return n.className="GPelementHidden gpf-visible fr-mx-1w",n.innerText="Fermer",e.appendChild(n),e.addEventListener?e.addEventListener("click",function(){document.getElementById(_t._addUID("GPshowLayersListPicto")).click()},!1):e.attachEvent&&e.attachEvent("onclick",function(){document.getElementById(_t._addUID("GPshowLayersListPicto")).click()}),e},_createHeaderButtonsDivElement:function(){var _t=document.createElement("div");return _t.className="GPbodyHeader",_t.id=this._addUID("GPbodyHeader"),_t},_createButtonsGroupElement:function(_t){_t=_t||{};let e=_t.className?_t.className:"",n=_t.left?"left":"right",ei="";switch(_t.size=_t.size?_t.size:"",_t.size.toLowerCase()){case"sm":ei="fr-btns-group--sm";break;case"lg":ei="fr-btns-group--lg";break}var ti=document.createElement("div");ti.className=`${e} GPbtnsGroup GPbtnsGroup--${n} fr-btns-group fr-btns-group--${n} fr-btns-group--inline-reverse fr-btns-group--inline ${ei} fr-btns-group--icon-left`;let ii=_t.id!==null?`${e}_ID_${_t.id}`:e;return ti.id=this._addUID(ii),ti},_createButtonHeaderElement:function(_t){let e=document.createElement("button");if(e.className="fr-btn fr-btn--tertiary gpf-btn ",_t.className&&(e.className+=_t.className),_t.icon&&(e.className+=_t.icon),_t.label&&(e.innerHTML=_t.label),_t.title&&(e.title=_t.title,e.ariaLabel=_t.title),e.id=_t.id?_t.id:this._addUID("GPtools-"+_t.label.toLowerCase()),_t.attributes)for(const ei in _t.attributes){if(!Object.hasOwn(_t.attributes,ei))continue;const ti=_t.attributes[ei];e.setAttribute(ei,ti)}let n=this;return e.addEventListener("click",ei=>{n._onClickHeaderButtons(ei,_t.label,_t.cb)}),e},_createContainerLayerElement:function(_t,e){var n=document.createElement("div");return n.id=this._addUID("GPlayerSwitcher_ID_"+_t.id),n.className="GPlayerSwitcher_layer gpf-panel__content fr-modal__content draggable-layer",n.appendChild(this._createBasicToolElement(_t,e)),n.appendChild(this._createAdvancedToolDivElement(_t)),n.setAttribute("tabindex",0),n.setAttribute("role","listitem"),["click","keydown"].forEach(ei=>{n.addEventListener(ei,ti=>{this._onSelectLayer(ti)})}),n},_createBasicToolElement:function(_t,e){var n=document.createElement("div");return n.id=this._addUID("GPbasicTools_ID_"+_t.id),n.className="GPlayerBasicTools",n.appendChild(this._createBasicToolButtons(_t)),n.appendChild(this._createBasicToolTitleElement(_t,e)),_t.draggable&&n.appendChild(this._createDragNDropElement(_t)),n},_createBasicToolButtons:function(_t){let e=document.createElement("div");return e.id=this._addUID("GPbasicToolButtons_ID_"+_t.id),e.className="GPbasicToolButtons",e.appendChild(this._createAdvancedToolShowElement(_t)),e.appendChild(this._createVisibilityElement(_t)),_t.deletable&&e.appendChild(this._createDeleteElement(_t.id)),e},_createBasicToolTitleElement:function(_t,e){let n=document.createElement("div");return n.id=this._addUID("GPtitle_ID_"+_t.id),n.className="GPtitle",n.appendChild(this._createLayerThumbnailElement(_t)),n.appendChild(this._createLayerNameDivElement(_t,e)),n},_createLayerNameDivElement:function(_t,e){let n=document.createElement("div");return n.id=this._addUID("GPlayerTitle_ID_"+_t.id),n.className="GPlayerTitle",n.appendChild(this._createLayerNameElement(_t,e)),n.appendChild(this._createLayerProducerElement(_t,e)),n},_createLayerThumbnailElement:function(_t){let e=document.createElement("img");return e.id=this._addUID("GPtitleImage_ID_"+_t.id),e.className="GPtitleImage GPtitleDefaultImage",e.alt="",_t.thumbnail&&typeof _t.thumbnail=="string"&&_t.thumbnail!=="default"&&(e.classList.remove("GPtitleDefaultImage"),e.src=_t.thumbnail),e},_createLayerNameElement:function(_t,e){var n=document.createElement("div");return n.id=this._addUID("GPname_ID_"+_t.id),n.className="GPlayerName",n.title=_t.description||_t.title,e&&(n.dataset.tooltip=_t.description||_t.title,ToolTips.active(n),n.title=_t.name),n.innerHTML=_t.title,_t.layer.config&&_t.layer.config.serviceParams.id==="GPP:TMS"&&(n.innerHTML=_t.title||_t.description),n},_createLayerProducerElement:function(_t,e){let n=document.createElement("div");return n.id=this._addUID("GPlayerProducer_ID_"+_t.id),n.className="GPlayerProducer",n.innerHTML=_t.producer,e&&(n.dataset.tooltip=_t.producer,ToolTips.active(n)),n},_createDragNDropElement:function(_t){let e=document.createElement("div");e.id=this._addUID("GPdragndropPicto_ID_"+_t.id),e.className="GPelementHidden GPlayerDragNDrop gpf-btn gpf-btn-icon-ls-draggable gpf-btn--tertiary",e.title="Deplacer la couche";let n=this,ei=document.createElement("div");ei.className="keyboard-navigation";let ti=document.createElement("span");ti.tabIndex=0,ti.dataset.direction="up",ti.title=ti.ariaLabel="Dplacer la couche vers le haut",ti.className="fr-icon-arrow-up-line fr-icon--sm",ti.onkeydown=this._onMoveElement.bind(this,!0);let ii=document.createElement("span");return ii.tabIndex=0,ii.dataset.direction="down",ii.title=ii.ariaLabel="Dplacer la couche vers le bas",ii.className="fr-icon-arrow-down-line fr-icon--sm",ii.onkeydown=this._onMoveElement.bind(this,!1),ei.appendChild(ii),ei.appendChild(ti),e.appendChild(ei),e.addEventListener?e.addEventListener("click",function(ri){n._onStartDragAndDropLayerClick(ri)}):e.attachEvent&&e.attachEvent("onclick",function(ri){n._onStartDragAndDropLayerClick(ri)}),e},_createVisibilityElement:function(_t){var e=typeof _t.visibility<"u"?_t.visibility:!0;let n=document.createElement("button");n.id=this._addUID("GPvisibilityPicto_ID_"+_t.id);let ei="gpf-btn-icon-ls-visibility gpf-btn-icon";checkDsfr()&&(ei=e?"fr-icon-eye-line":"fr-icon-eye-off-line"),n.className=`GPlayerVisibility gpf-btn ${ei} fr-btn fr-btn--sm gpf-btn--tertiary fr-btn--tertiary-no-outline`,n.title="Afficher/masquer la couche",n.setAttribute("tabindex","0"),n.setAttribute("aria-pressed",e),n.setAttribute("type","button");var ti=this;let ii=function(ri){var ni=ri.target.ariaPressed==="true";ri.target.setAttribute("aria-pressed",!ni),checkDsfr()&&(n.classList.toggle("fr-icon-eye-off-line",ni),n.classList.toggle("fr-icon-eye-line",!ni)),ti._onVisibilityLayerClick(ri)};return n.addEventListener?n.addEventListener("click",ii):n.attachEvent&&n.attachEvent("onclick",ii),n},_createAdvancedToolShowElement:function(_t){let e=document.createElement("button");e.id=this._addUID("GPshowAdvancedTools_ID_"+_t.id),e.className="GPshowAdvancedToolPicto GPshowMoreOptionsImage GPshowMoreOptions GPshowLayerAdvancedTools gpf-btn fr-icon-arrow-down-s-line fr-btn--sm fr-btn--tertiary-no-outline",e.title="Plus d'outils",e.setAttribute("tabindex","0"),e.setAttribute("aria-pressed",!1),e.setAttribute("type","button");let n=this;const ei=ti=>{let ii=ti.target.ariaPressed==="true";ti.target.setAttribute("aria-pressed",!ii);let ri=document.getElementById(n._addUID("GPadvancedTools_ID_"+_t.id));ii?(ri.classList.replace("GPelementVisible","GPelementHidden"),ri.classList.replace("gpf-visible","gpf-hidden")):(ri.classList.replace("GPelementHidden","GPelementVisible"),ri.classList.replace("gpf-hidden","gpf-visible"))};return e.addEventListener?e.addEventListener("click",ei):e.attachEvent&&e.attachEvent("onclick",ei),e},_createAdvancedToolDivElement:function(_t){let e=document.createElement("div");e.id=this._addUID("GPadvancedTools_ID_"+_t.id),e.className="GPelementHidden GPlayerAdvancedTools gpf-hidden";let n=document.createElement("div");n.id=this._addUID("GPopacityContainer_ID_"+_t.id),n.className="GPopacityContainer";let ei=this._createOpacityElement(_t.id,_t.opacity);for(let ii=0;ii<ei.length;ii++)n.appendChild(ei[ii]);e.appendChild(n);let ti=this._createButtonsGroupElement({className:"GPAdvancedToolBtnsGroup",id:_t.id,left:!0,size:"sm"});if(_t.advancedTools&&_t.advancedTools instanceof Array){const ii=this.constructor.switcherButtons;if(!_t.advancedTools.length)return;_t.advancedTools.forEach(ri=>{const ni=ri.key;if(ni&&Object.values(ii).includes(ni)){let si;switch(ni){case ii.INFO:si=this._createInformationElement;break;case ii.EDIT:si=this._createEditionElement;break;case ii.GREYSCALE:si=this._createGreyscaleElement;break;case ii.EXTENT:si=this._createExtentElement;break}typeof si=="function"&&ti.appendChild(si.call(this,_t,ri))}else ri&&ti.appendChild(this._createAdvancedToolElement(_t,ri))}),e.appendChild(ti)}else checkDsfr()?(ti.appendChild(this._createInformationElement(_t,{})),ti.appendChild(this._createEditionElement(_t,{})),ti.appendChild(this._createGreyscaleElement(_t,{})),ti.appendChild(this._createExtentElement(_t,{}))):(ti.appendChild(this._createInformationElement(_t,{})),ti.appendChild(this._createGreyscaleElement(_t,{}))),e.appendChild(ti);return e},_setAdvancedToolOptions:function(_t,e,n=!0){if(!_t)return;let ei;e.label?ei=e.label.toLowerCase().replaceAll(" ","-"):ei=e.icon;const ti=`gpf-btn-icon-ls-tools-${ei}`;if(e.className&&(_t.className+=` ${e.className} `),e.icon&&this._setButtonIconStyle(_t,ti,e.icon),e.label&&(_t.innerHTML=e.label),e.title&&(_t.title=e.title,_t.ariaLabel=e.title),e.attributes)for(const ri in e.attributes){if(!Object.hasOwn(e.attributes,ri))continue;const ni=e.attributes[ri];_t.setAttribute(ri,ni)}_t.setAttribute("tabindex","0"),_t.setAttribute("type","button");let ii=this;return n&&_t.addEventListener("click",ri=>{ii._onClickAdvancedToolsMore(ri,e.label,e.cb)}),_t},_setButtonIconStyle:function(_t,e,n){let ei=!1;const ti=/(\.|\\)/;if(n&&(n.startsWith("<svg")?(n="data:image/svg+xml;base64,"+btoa(n),ei=!0):ti.test(n)?ei=!0:_t.className+=n),ei&&(_t.classList.add(e),!document.querySelector(`style[data-injected="${e.toLowerCase()}"]`))){const ii=document.createElement("style");ii.dataset.injected=e.toLowerCase(),ii.textContent=`
                    .${e.toLowerCase()}::before {
                        width: 100%;
                        height: 100%;
                        -webkit-mask-image: url('${n}');
                        -webkit-mask-repeat: no-repeat;
                        -webkit-mask-position: center;

                        mask-image: url('${n}');
                        mask-repeat: no-repeat;
                        mask-position: center;
                    }
                `,document.head.appendChild(ii)}},_createDeleteElement:function(_t){let e=document.createElement("button");e.id=this._addUID("GPremove_ID_"+_t);let n="gpf-btn-icon-ls-remove gpf-btn-icon";checkDsfr()&&(n="fr-icon-delete-line"),e.className=`GPlayerRemove gpf-btn ${n} fr-btn fr-btn--sm gpf-btn--tertiary fr-btn--tertiary-no-outline`,e.title="Supprimer la couche",e.layerId=_t,e.setAttribute("tabindex","0"),e.setAttribute("type","button");var ei=this;return e.addEventListener?e.addEventListener("click",function(ti){ei._onDropLayerClick(ti)}):e.attachEvent&&e.attachEvent("onclick",function(ti){ei._onDropLayerClick(ti)}),e},_createEditionElement:function(_t,e){let n=_t.id,ei=_t.editable,ti=_t.layer.config&&_t.layer.config.serviceParams.id==="GPP:TMS",ii=ti?_t.layer.config.styles:null,ri=document.createElement("button");ri.id=this._addUID("GPedit_ID_"+n),ri.layerId=n;let ni="gpf-btn-icon-ls-edit gpf-btn-icon",si;checkDsfr()&&(ni="fr-icon-pencil-line",si="Style");let ai="GPlayerEdit gpf-btn gpf-btn--tertiary fr-btn fr-btn--tertiary-no-outline";const oi={icon:ni,label:si},li=Helper.assign(oi,e);li.className=ai,e&&e.className&&(li.className+=` ${e.className}`),this._setAdvancedToolOptions(ri,li,!1),(!ei||ti&&ii.length===1)&&(ri.disabled=!0);let ci=this;return ti&&ii.length>1?ri.addEventListener?ri.addEventListener("click",function(ui){ci._onEditLayerStyleClick(ui,ii)}):ri.attachEvent&&ri.attachEvent("onclick",function(ui){ci._onEditLayerStyleClick(ui,ii)}):ri.addEventListener?ri.addEventListener("click",function(ui){ci._onEditLayerClick(ui)}):ri.attachEvent&&ri.attachEvent("onclick",function(ui){ci._onEditLayerClick(ui)}),ri},_createInformationElement:function(_t,e){let n=_t.id,ei=_t.title,ti=_t.description,ii=document.createElement("button");ii.id=this._addUID("GPinfo_ID_"+n),ii.layerId=n;let ri="gpf-btn-icon-ls-info gpf-btn-icon",ni;checkDsfr()&&(ri="fr-icon-information-line",ni="Infos");let si="GPlayerInfo GPlayerInfoClosed gpf-btn gpf-btn--tertiary fr-btn fr-btn--tertiary-no-outline";const ai={icon:ri,label:ni},oi=Helper.assign(ai,e);oi.className=si,e&&e.className&&(oi.className+=` ${e.className}`),this._setAdvancedToolOptions(ii,oi,!1),(!ei||!ti)&&(ii.disabled=!0);var li=this;return ii.addEventListener?ii.addEventListener("click",function(ci){li._onOpenLayerInfoClick(ci)}):ii.attachEvent&&ii.attachEvent("onclick",function(ci){li._onOpenLayerInfoClick(ci)}),ii},_createGreyscaleElement:function(_t,e){let n=_t.id,ei=_t.grayable,ti=_t.grayscale;e=e||{};var ii=typeof ti<"u"?ti:!1;let ri=document.createElement("button");ri.id=this._addUID("GPgreyscale_ID_"+n),ri.layerId=n;let ni="gpf-btn-icon-ls-greyscale gpf-btn-icon",si;checkDsfr()&&(ni="fr-icon-contrast-line",si="Noir et blanc");let ai="GPlayerGreyscale GPlayerGreyscaleOff gpf-btn gpf-btn--tertiary fr-btn fr-btn--tertiary-no-outline";const oi={icon:ni,label:si},li=Helper.assign(oi,e);li.className=ai,e&&e.className&&(li.className+=` ${e.className}`),this._setAdvancedToolOptions(ri,li,!1),ii&&ri.classList.replace("GPlayerGreyscaleOff","GPlayerGreyscaleOn"),ri.setAttribute("aria-pressed",ii),ei||(ri.disabled=!0);var ci=this;return ri.addEventListener?ri.addEventListener("click",function(ui){var di=ui.target.ariaPressed==="true";ui.target.setAttribute("aria-pressed",!di),ci._onToggleLayerGreyscaleClick(ui)}):ri.attachEvent&&ri.attachEvent("onclick",function(ui){var di=ui.target.ariaPressed==="true";ui.target.setAttribute("aria-pressed",!di),ci._onToggleLayerGreyscaleClick(ui)}),ri},_createOpacityElement:function(_t,e){var n=[],ei=document.createElement("div");ei.id=this._addUID("GPopacity_ID_"+_t),ei.className="GPlayerOpacity fr-range fr-range--sm",ei.dataset.frJsRange="true",ei.title="Opacit";var ti=typeof e<"u"?e:1;ti=Math.round(ti*100),ei.style.setProperty("--progress-right",ti+"%");var ii=document.createElement("input");ii.id=this._addUID("GPopacityValueDiv_ID_"+_t),ii.type="range",ii.value=ti,ii.ariaLabel="Opacit";var ri=this;ii.addEventListener?ii.addEventListener("change",function(ai){ri._onChangeLayerOpacity(ai)}):ii.attachEvent&&ii.attachEvent("onchange",function(ai){ri._onChangeLayerOpacity(ai)}),ii.addEventListener?ii.addEventListener("input",function(ai){ri._onChangeLayerOpacity(ai)}):ii.attachEvent&&ii.attachEvent("oninput",function(ai){ri._onChangeLayerOpacity(ai)}),ei.appendChild(ii);var ni=document.createElement("div");ni.id=this._addUID("GPopacityValueDiv_ID_"+_t),ni.className="GPlayerOpacityValue";var si=document.createElement("span");return si.id=this._addUID("GPopacityValue_ID_"+_t),si.className="gpf-range__output fr-range__output gpf-visible",si.innerHTML=ti+"%",ni.appendChild(si),n.push(ei),n.push(ni),n},_createExtentElement:function(_t,e){let n=_t.id,ei=document.createElement("button");ei.id=this._addUID("GPextent_ID_"+n),ei.layerId=n,e=e||{};let ti="gpf-btn-icon-ls-extent gpf-btn-icon",ii;checkDsfr()&&(ti="fr-icon-zoom-in-line",ii="Centrer sur la couche");let ri="GPelementHidden GPlayerExtent gpf-btn--tertiary gpf-btn fr-btn fr-btn--tertiary-no-outline";const ni={icon:ti,label:ii},si=Helper.assign(ni,e);si.className=ri,e&&e.className&&(si.className+=` ${e.className}`),this._setAdvancedToolOptions(ei,si,!1),ei.setAttribute("aria-pressed",!0);var ai=this;return ei.addEventListener?ei.addEventListener("click",function(oi){var li=oi.target.ariaPressed==="true";oi.target.setAttribute("aria-pressed",!li),ai._onZoomToExtentClick(oi)}):ei.attachEvent&&ei.attachEvent("onclick",function(oi){var li=oi.target.ariaPressed==="true";oi.target.setAttribute("aria-pressed",!li),ai._onZoomToExtentClick(oi)}),ei},_createAdvancedToolElement:function(_t,e){let n=_t.id,ei=document.createElement("button");const ti=e.label.toLowerCase().replaceAll(" ","-");ei.id=this._addUID("GPtools-"+ti+"_ID_"+n),ei.layerId=n,e=e||{};let ii=e.icon,ri;checkDsfr()&&(ri=e.label);let ni="GPlayerTools gpf-btn gpf-btn--tertiary fr-btn fr-btn--tertiary-no-outline";const si={icon:ii,label:ri},ai=Helper.assign(si,e);if(ai.className=ni,e&&e.className&&(ai.className+=` ${e.className}`),this._setAdvancedToolOptions(ei,ai,!1),Object.assign(ei.style,e.styles),e.accepted&&e.accepted.length){const li=_t.layer,ci=li.constructor.name;let ui=!0;for(const di of e.accepted)if(typeof di=="string"&&di===ci||di.prototype instanceof BaseLayer&&li instanceof di){ui=!1;break}ei.disabled=ui}var oi=this;return ei.addEventListener?ei.addEventListener("click",li=>{oi._onClickAdvancedToolsMore(li,e.label,e.cb)}):ei.attachEvent&&ei.attachEvent("onclick",li=>{oi._onClickAdvancedToolsMore(li,e.label,e.cb)}),ei},_createContainerLayerInfoElement:function(_t){var e=document.createElement("div"),n=document.createElement("div");n.className="gpf-panel__header_ls",e.appendChild(n);var ei=document.createElement("label");ei.className="GPlayerInfo gpf-btn-header gpf-btn-icon-ls-info",ei.title="Informations",n.appendChild(ei);var ti=document.createElement("div");ti.id=this._addUID("GPlayerInfoTitle"),ti.innerHTML=_t.title,ti.className="gpf-panel__title_ls",n.appendChild(ti);var ii=document.createElement("button");ii.id=this._addUID("GPlayerInfoClose"),ii.className="GPpanelClose GPlayersPanelClose gpf-btn gpf-btn-icon-close fr-btn--close fr-btn fr-btn--tertiary-no-outline fr-m-1w",ii.title="Fermer la fentre";var ri=this,ni=function(){document.getElementById(ri._addUID("GPlayerInfoPanel")).classList.add("GPlayerInfoPanelClosed","gpf-hidden"),document.getElementById(ri._addUID("GPlayerInfoPanel")).classList.remove("GPlayerInfoPanelOpened","gpf-visible"),document.getElementById(_t.id).classList.add("GPlayerInfoClosed"),document.getElementById(_t.id).classList.remove("GPlayerInfoOpened")};ii.addEventListener?ii.addEventListener("click",ni):ii.attachEvent&&ii.attachEvent("onclick",ni),this.addEventListener("layerswitcher:remove",Di=>{parseInt(_t.id.split("-")[0].split("GPinfo_ID_")[1])===Di.layer.id&&(document.getElementById(ri._addUID("GPlayerInfoPanel")).classList.add("GPlayerInfoPanelClosed","gpf-hidden"),document.getElementById(ri._addUID("GPlayerInfoPanel")).classList.remove("GPlayerInfoPanelOpened","gpf-visible"))}),n.appendChild(ii),e.appendChild(n);var si=document.createElement("div");if(si.id=this._addUID("GPlayerInfoContent"),si.className="gpf-panel__content fr-modal__content",e.appendChild(si),_t.quicklookUrl){var ai=document.createElement("div");ai.id=this._addUID("GPlayerInfoQuicklook"),ai.title="Afficher un aperu de la couche";var oi=document.createElement("a");oi.href=_t.quicklookUrl,oi.appendChild(ai),si.appendChild(oi)}var li=document.createElement("div");if(li.id=this._addUID("GPlayerInfoDescription"),li.innerHTML=_t.description,si.appendChild(li),_t.metadata){var ci=document.createElement("div");ci.id=this._addUID("GPlayerInfoMetadata");var ui=document.createElement("div");ui.className="GPlayerInfoSubtitle",ui.innerHTML="Mtadonnes",ci.appendChild(ui);for(var di=0;di<_t.metadata.length;di++){var fi=_t.metadata[di].url,hi=document.createElement("div");hi.className="GPlayerInfoLink";var pi=document.createElement("a");pi.href=fi,pi.innerHTML=fi,hi.appendChild(pi),ci.appendChild(hi)}_t.metadata.length!==0&&si.appendChild(ci)}if(_t.legends){var gi=document.createElement("div");gi.id=this._addUID("GPlayerInfoLegend");var vi=document.createElement("div");vi.className="GPlayerInfoSubtitle",vi.innerHTML="Lgende",gi.appendChild(vi);for(var yi={},_i=_t.maxScaleDenominator||56e7,Ai=0;Ai<_t.legends.length;Ai++){var Ei=_t.legends[Ai].minScaleDenominator;if(Ei){var Si=Ei.toString();Ei=Math.round(parseInt(Si.substring(0,3),10)/10)*Math.pow(10,Si.length-2)}else Ei=270;yi[Ei]=_t.legends[Ai]}for(var wi in yi)if(yi.hasOwnProperty(wi)){var Oi=yi[wi].url;if(typeof Oi=="string"&&Oi.toLowerCase().indexOf("nolegend.jpg")===-1){var Ii=document.createElement("div");Ii.className="GPlayerInfoLink",_i=yi[wi].maxScaleDenominator||_i;var Li=document.createElement("a");Li.className="fr-link",Li.href=Oi,Li.target="_blank",Li.innerHTML="Du 1/"+wi+" au 1/"+_i,Ii.appendChild(Li),gi.appendChild(Ii)}else delete yi[wi]}Object.keys(yi).length!==0&&si.appendChild(gi)}return e},_createContainerLayerStyleElement:function(_t){var e=document.createElement("div"),n=document.createElement("div");n.className="gpf-panel__header_ls",e.appendChild(n);var ei=document.createElement("label");ei.className="GPlayerStyle gpf-btn-header gpf-btn-icon-ls-info",ei.title="Informations",n.appendChild(ei);var ti=document.createElement("div");ti.id=this._addUID("GPlayerStyleTitle"),ti.innerHTML="Options de style",ti.className="gpf-panel__title_ls",n.appendChild(ti);var ii=document.createElement("button");ii.id=this._addUID("GPlayerStyleClose"),ii.className="GPpanelClose GPlayersPanelClose gpf-btn gpf-btn-icon-close fr-btn--close fr-btn fr-btn--tertiary-no-outline fr-m-1w",ii.title="Fermer la fentre";var ri=this,ni=function(){document.getElementById(ri._addUID("GPlayerStylePanel")).classList.add("GPlayerStylePanelClosed","gpf-hidden"),document.getElementById(ri._addUID("GPlayerStylePanel")).classList.remove("GPlayerStylePanelOpened","gpf-visible"),document.getElementById(_t.div).classList.add("GPlayerStyleClosed"),document.getElementById(_t.div).classList.remove("GPlayerStyleOpened")};ii.addEventListener?ii.addEventListener("click",ni):ii.attachEvent&&ii.attachEvent("onclick",ni),this.addEventListener("layerswitcher:remove",di=>{parseInt(_t.id.split("-")[0].split("GPinfo_ID_")[1])===di.layer.id&&(document.getElementById(ri._addUID("GPlayerStylePanel")).classList.add("GPlayerStylePanelClosed","gpf-hidden"),document.getElementById(ri._addUID("GPlayerStylePanel")).classList.remove("GPlayerStylePanelOpened","gpf-visible"))}),n.appendChild(ii),e.appendChild(n);var si=document.createElement("div");si.id=this._addUID("GPlayerStyleContent"),si.className="gpf-panel__content fr-modal__content",e.appendChild(si);var ai=document.createElement("div");ai.id=this._addUID("GPlayerStyleList");const oi=/^([0-9a-f]{8}(-[0-9a-f]{4}){3}-[0-9a-f]{12}_)/i;for(let di=0;di<_t.styles.length;di++){var li=_t.styles[di],ti=li.title?li.title:li.name;ti=ti.replace(oi,"");var ci=document.createElement("div");ci.className="gpf-flex gpf-radio-group fr-radio-group fr-my-1w";var ui=document.createElement("input");ui.type="radio",ui.name=this._addUID("styleradio_ID_"+_t.id),ui.id=this._addUID("styleradio_"+li.name+"_ID_"+_t.id),ui.value=li.url,ui.dataset.name=li.name;var ei=document.createElement("label");ei.className="gpf-label fr-label",ei.innerText=ti,ei.htmlFor=this._addUID("styleradio_"+li.name+"_ID_"+_t.id),ci.appendChild(ui),ci.appendChild(ei),ai.appendChild(ci),_t.layerInfo.layer.styleUrl===li.url&&(ui.checked=!0),ui.addEventListener("change",pi=>{ri._onChangeStyleLayerClick(pi)})}return si.appendChild(ai),e}},logger$C=LoggerByDefault.getLogger("layerswitcher");const bl=class bl extends ControlExtended{constructor(e){e=e||{};var n=e.options||{},ei=e.layers||[];if(super(n),!(this instanceof bl))throw new TypeError("ERROR CLASS_CONSTRUCTOR");if(!Array.isArray(ei))throw new Error("ERROR WRONG_TYPE : layers should be an array");if(typeof n!="object")throw new Error("ERROR WRONG_TYPE : options should be an object");return this.CLASSNAME="LayerSwitcher",this._initialize(n,ei),this.container=this._initContainer(n),this.element?this.element.appendChild(this.container):this.element=this.container,this}setMap(e){if(e)this._addMapLayers(e),this.collapsed||this._showLayerSwitcherButton.setAttribute("aria-pressed",!0),this._listeners.onMoveListener=e.on("moveend",()=>this._onMapMoveEnd(e)),this._listeners.onAddListener=e.getLayers().on("add",ei=>{logger$C.debug("LayerSwitcher:onAddListener",ei);var ti=ei.element,ii;ti.hasOwnProperty("gpLayerId")?ii=ti.gpLayerId:(ii=this._layerId,ti.gpLayerId=ii,this._layerId++),this._layers[ii]||this.addLayer(ti)}),this._listeners.onRemoveListener=e.getLayers().on("remove",ei=>{logger$C.debug("LayerSwitcher:onRemoveListener",ei);var ti=ei.element,ii=ti.gpLayerId;this._layers[ii]&&this.removeLayer(ti)});else{unByKey(this._listeners.onMoveListener),unByKey(this._listeners.onAddListener),unByKey(this._listeners.onRemoveListener);for(var n=this._layersOrder.length-1;n>=0;n--);}super.setMap(e),this.options.position&&this.setPosition(this.options.position),this.options.gutter===!1&&this.getContainer().classList.add("gpf-button-no-gutter"),this.options.allowTooltips&&ToolTips.init()}addLayer(e,n){var ei=this.getMap();if(n=n||e.config||{},!e){logger$C.log("[ERROR] LayerSwitcher:addLayer - missing layer parameter");return}var ti=e.gpLayerId;if(typeof ti>"u"){logger$C.trace("[WARN] LayerSwitcher:addLayer - configuration cannot be set for this layer (layer id not found)",e);return}var ii=!1;if(ei.getLayers().forEach(vi=>{vi.gpLayerId===ti&&(ii=!0)}),!ii){logger$C.log("[ERROR] LayerSwitcher:addLayer - configuration cannot be set for ",e," layer (layer is not in map.getLayers() )");return}if(this._layers[ti]){for(var di in n)n.hasOwnProperty(di)&&(this._layers[ti][di]=n[di]);if(n.title){var fi=document.getElementById(this._addUID("GPname_ID_"+ti));fi&&(fi.innerHTML=n.title,fi.title=n.description||n.title)}if(n.producer){let vi=document.getElementById(this._addUID("GPlayerProducer_ID_"+ti));vi?vi.innerHTML=n.producer:this.setLayerProducer(ti,n.producer)}var hi=document.getElementById(this._addUID("GPinfo_ID_"+ti));if(!document.getElementById(this._addUID("GPinfo_ID_"+ti))&&n.description){var pi=document.getElementById(this._addUID("GPadvancedTools_ID_"+ti));pi&&pi.appendChild(this._createInformationElement({id:ti}))}hi&&hi.className==="GPlayerInfoOpened"&&document.getElementById(this._addUID("GPlayerInfoPanel")).classList.add("GPlayerInfoPanelClosed","gpf-hidden")}else{var ri=this.getLayerInfo(e)||{},ni=e.getOpacity(),si=e.getVisible(),ai=e.get("grayscale"),oi=e.get("locked"),li=this.isInRange(e,ei),ci={layer:e,id:ti,name:e.name,service:e.service,type:"",opacity:ni??1,visibility:si??!0,grayscale:ai,locked:oi,inRange:li??!0,producer:n.producer!=null?n.producer:ri._producer||null,title:n.title!=null?n.title:ri._title||ti,thumbnail:n.thumbnail!=null?n.thumbnail:ri._thumbnail||null,description:n.description||ri._description||null,legends:n.legends||ri._legends||[],metadata:n.metadata||ri._metadata||[],quicklookUrl:n.quicklookUrl||ri._quicklookUrl||null};this._layers[ti]=ci;var ui=this._createLayerDiv(ci);this._layers[ti].div=ui,e.getZIndex&&e.getZIndex()!==0&&typeof e.getZIndex()<"u"||e._forceNullzIndex?this._updateLayersOrder():(this._layersOrder.unshift(ci),this._lastZIndex++,e.setZIndex(this._lastZIndex),ui.dataset.sortableId=this._layerId,this._layerListContainer.insertBefore(ui,this._layerListContainer.firstChild)),this._listeners.updateLayerOpacity=e.on("change:opacity",vi=>this._updateLayerOpacity(vi)),this._listeners.updateLayerVisibility=e.on("change:visible",vi=>this._updateLayerVisibility(vi)),this._listeners.updateLayerGrayScale=e.on("change:grayscale",vi=>this._updateLayerGrayScale(vi)),this._listeners.updateLayerLocked=e.on("change:locked",vi=>this._updateLayerLocked(vi)),this._listeners.updateProperties=e.on("propertychange",vi=>this._updateGenericProperty(vi)),this._layers[ti].onZIndexChangeEvent==null&&(this._layers[ti].onZIndexChangeEvent=e.on("change:zIndex",()=>this._updateLayersOrder()))}this._updateLayerCounter();var gi=this;setTimeout(()=>{gi._updateLayerGrayScale({target:{gpLayerId:ti}})},0),this.dispatchEvent({type:this.ADD_LAYER_EVENT,layer:this._layers[ti]})}removeLayer(e){if(e){unByKey(this._listeners.updateLayerOpacity),unByKey(this._listeners.updateLayerVisibility),unByKey(this._listeners.updateLayerGrayScale),unByKey(this._listeners.updateLayerLocked),unByKey(this._listeners.updateProperties),logger$C.trace(e);var n=e.gpLayerId,ei=document.getElementById(this._addUID("GPinfo_ID_"+n));ei&&ei.className==="GPlayerInfoOpened"&&document.getElementById(this._addUID("GPlayerInfoPanel")).classList.add("GPlayerInfoPanelClosed","gpf-hidden");var ti=document.getElementById(this._addUID("GPedit_ID_"+n));ti&&ti.classList.contains("GPlayerStyleOpened")&&document.getElementById(this._addUID("GPlayerStylePanel")).classList.add("GPlayerStylePanelClosed","gpf-hidden");var ii=document.getElementById(this._addUID("GPlayerSwitcher_ID_"+n));ii&&this._layerListContainer.removeChild(ii);var ri=Math.abs(e.getZIndex()-this._lastZIndex);this._layersOrder.splice(ri,1),this._lastZIndex--;for(var ni=this._layersOrder,si=0;si<ni.length;si++)ni[si].layer.setZIndex(this._lastZIndex-si);this.dispatchEvent({type:this.REMOVE_LAYER_EVENT,layer:this._layers[n]}),e===this.getSelectedLayer()&&this.setSelectedLayer(),delete this._layers[n],this._updateLayerCounter()}}lockLayer(e,n){if(e){var ei=e.gpLayerId,ti=document.getElementById(this._addUID("GPlayerSwitcher_ID_"+ei));ti&&(n?ti.setAttribute("disabled",!0):ti.removeAttribute("disabled")),e.set("locked",n),this.dispatchEvent({type:this.LOCK_LAYER_EVENT,layer:this._layers[ei],locked:n})}}setCollapsed(e){if(e===void 0){logger$C.log("[ERROR] LayerSwitcher:setCollapsed - missing collapsed parameter");return}var n=!document.getElementById(this._addUID("GPshowLayersList")).checked;e&&n||!e&&!n||(n||(document.getElementById(this._addUID("GPlayerInfoPanel")).classList.add("GPlayerInfoPanelClosed","gpf-hidden"),document.getElementById(this._addUID("GPlayerStylePanel")).classList.add("GPlayerStylePanelClosed","gpf-hidden")),document.getElementById(this._addUID("GPshowLayersList")).checked=!e)}getCollapsed(){return this.collapsed}setRemovable(e,n){if(e){var ei=e.gpLayerId;if(ei==null){logger$C.log("[LayerSwitcher:setRemovable] layer should be added to map before calling setRemovable method");return}var ti=document.getElementById(this._addUID("GPremove_ID_"+ei));ti&&(n===!1?ti.style.display="none":n===!0&&(ti.style.display="block"))}}getContainer(){return this.container}forget(){unByKey(this._listeners.onAddListener)}listen(){var e=this.getMap();e&&(this._listeners.onAddListener=e.getLayers().on("add",n=>{logger$C.debug("LayerSwitcher:onAddListener",n);var ei=n.element,ti;ei.hasOwnProperty("gpLayerId")?ti=ei.gpLayerId:(ti=this._layerId,ei.gpLayerId=ti,this._layerId++),this._layers[ti]||this.addLayer(ei)}))}_initialize(e,n){this.options={id:"",collapsed:!0,draggable:!1,counter:!1,panel:!1,gutter:!1,allowEdit:!0,allowGrayScale:!0,allowDraggable:!0,allowDelete:!0,allowTooltips:!1,headerButtons:[],advancedTools:null},Helper.assign(this.options,e),this.options.layers=n,this._uid=this.options.id||SelectorID.generate(),this._layers={},this._layersOrder=[],this._layersIndex={},this._lastZIndex=0,this._layerId=0,this.collapsed=this.options.collapsed!==void 0?this.options.collapsed:!0,this._layerListContainer=null,this._listeners={};for(var ei=0;ei<n.length;ei++){var ti=n[ei].layer;if(ti){var ii;ti.hasOwnProperty("gpLayerId")?ii=ti.gpLayerId:(ii=this._layerId,ti.gpLayerId=ii,this._layerId++);var ri=n[ei].config||{},ni=this.getLayerInfo(ti),si=ti.getOpacity(),ai=ti.getVisible(),oi=ti.get("grayscale"),li={layer:ti,id:ii,name:ti.name,service:ti.service,opacity:si??1,visibility:ai??!0,grayscale:oi,title:ri.title||ni._title,description:ri.description||ni._description,legends:ri.legends||ni._legends,metadata:ri.metadata||ni._metadata,quicklookUrl:ri.quicklookUrl||ni._quicklookUrl,thumbnail:ri.thumbnail||ni._thumbnail,producer:ri.producer||ni._producer};this._layers[ii]=li}}this._layerListContainer=null,this._layerSwitcherCounter=null,this._showLayerSwitcherButton=null,this.PROPERTY_CHANGE_EVENT="layerswitcher:propertychange",this.ADD_LAYER_EVENT="layerswitcher:add",this.REMOVE_LAYER_EVENT="layerswitcher:remove",this.LOCK_LAYER_EVENT="layerswitcher:lock",this.EXTENT_LAYER_EVENT="layerswitcher:extent",this.EDIT_LAYER_EVENT="layerswitcher:edit",this.CUSTOM_LAYER_EVENT="layerswitcher:custom",this.HEADER_BUTTON_EVENT="layerswitcher:header:button",this.CHANGE_LAYER_OPACITY_EVENT="layerswitcher:change:opacity",this.CHANGE_LAYER_VISIBILITY_EVENT="layerswitcher:change:visibility",this.CHANGE_LAYER_GRAYSCALE_EVENT="layerswitcher:change:grayscale",this.CHANGE_LAYER_LOCKED_EVENT="layerswitcher:change:locked",this.CHANGE_LAYER_SELECTED_EVENT="layerswitcher:change:selected"}_initContainer(){var e=this._createMainContainerElement(),n=this._createMainLayersShowElement();e.appendChild(n),this.collapsed?this.collapsed=!0:(n.checked="checked",this.collapsed=!1);var ei=this,ti=function(gi){this.collapsed=!gi.target.checked,this.dispatchEvent("change:collapsed")};n.addEventListener("click",function(gi){ti.call(ei,gi)});var ii=this._showLayerSwitcherButton=this._createMainPictoElement();if(e.appendChild(ii),e.classList.add("GplayerSwitcher-counterRemoved"),this.options.counter){e.classList.remove("GplayerSwitcher-counterRemoved"),e.classList.add("GplayerSwitcher-counterAdded");var ri=this._layerSwitcherCounter=this._createMainCounterLayersElement();ii.appendChild(ri)}var ni=this._createMainLayersElement();if(e.appendChild(ni),this.options.panel){var si=this._createLayersPanelHeaderElement();ni.appendChild(si);var ai=this._createLayersPanelIconElement();si.appendChild(ai);var oi=this._createLayersPanelTitleElement();si.appendChild(oi);var li=this._createLayersPanelCloseElement();si.appendChild(li)}var ci=this._createMainLayersDivElement();if(ni.appendChild(ci),this.options.headerButtons.length){let gi=this._createHeaderButtonsDivElement(),vi=this._createButtonsGroupElement({className:"GPbodyHeaderBtnsGroup",size:"sm"});this.options.headerButtons.forEach(yi=>{let _i=this._createButtonHeaderElement(yi);vi.appendChild(_i)}),gi.appendChild(vi),ci.appendChild(gi)}var ui=this._layerListContainer=this._createMainLayerListElement();ci.appendChild(ui),this._createDraggableElement(ui,this);var di=this._createMainInfoElement(),fi=this._createMainInfoDivElement();di.appendChild(fi),e.appendChild(di);var hi=this._createMainStyleElement(),pi=this._createMainStyleDivElement();return hi.appendChild(pi),e.appendChild(hi),e}_addMapLayers(e){this._layersIndex={},e.getLayers().forEach(si=>{var ai=null;si.hasOwnProperty("gpLayerId")?ai=si.gpLayerId:(ai=this._layerId,si.gpLayerId=ai,this._layerId++);var oi=this.getLayerInfo(si)||{};if(this._layers[ai])this._layers[ai].opacity=si.getOpacity(),this._layers[ai].visibility=si.getVisible(),this._layers[ai].grayscale=si.get("grayscale"),this._layers[ai].locked=si.get("locked"),this._layers[ai].inRange=this.isInRange(si,e);else{var li=si.getOpacity(),ci=si.getVisible(),ui=si.get("grayscale"),di=si.get("locked"),fi=this.isInRange(si,e),hi={layer:si,id:ai,name:si.name,service:si.service,opacity:li??1,visibility:ci??!0,grayscale:ui,locked:di,inRange:fi??!0,producer:oi._producer||null,thumbnail:oi._thumbnail||null,title:oi._title||ai,description:oi._description||null,legends:oi._legends||[],metadata:oi._metadata||[],quicklookUrl:oi._quicklookUrl||null};this._layers[ai]=hi}this._updateLayerCounter(),this._listeners.updateLayerOpacity=si.on("change:opacity",vi=>this._updateLayerOpacity(vi)),this._listeners.updateLayerVisibility=si.on("change:visible",vi=>this._updateLayerVisibility(vi)),this._listeners.updateLayerGrayScale=si.on("change:grayscale",vi=>this._updateLayerGrayScale(vi)),this._listeners.updateLayerLocked=si.on("change:locked",vi=>this._updateLayerLocked(vi)),this._listeners.updateProperties=si.on("propertychange",vi=>this._updateGenericProperty(vi));var pi=this;if(setTimeout(()=>{pi._updateLayerGrayScale({target:{gpLayerId:ai}})},0),si.getZIndex!==void 0){var gi=si.getZIndex()||0;(!this._layersIndex[gi]||!Array.isArray(this._layersIndex[gi]))&&(this._layersIndex[gi]=[]),this._layersIndex[gi].push(this._layers[ai])}});for(var n in this._layersIndex)if(this._layersIndex.hasOwnProperty(n))for(var ei=this._layersIndex[n],ti=0;ti<ei.length;ti++)this._layersOrder.unshift(ei[ti]),this._lastZIndex++,ei[ti].layer.setZIndex(this._lastZIndex),this._layers[ei[ti].layer.gpLayerId].onZIndexChangeEvent==null&&(this._layers[ei[ti].layer.gpLayerId].onZIndexChangeEvent=ei[ti].layer.on("change:zIndex",()=>this._updateLayersOrder()));for(var ii=0;ii<this._layersOrder.length;ii++){var ri=this._layersOrder[ii],ni=this._createLayerDiv(ri);ni.dataset.sortableId=ri.id,this._layerListContainer.querySelector("#"+ni.id)||this._layerListContainer.appendChild(ni),this._layers[ri.id].div=ni}}_createLayerDiv(e){var n=e.legends&&e.legends.length!==0,ei=e.metadata&&e.metadata.length!==0,ti=e.quicklookUrl;(n||ei||ti)&&(e.displayInformationElement=!0),e.editable=!1,this.options.allowEdit&&(e.layer instanceof VectorLayer||e.layer instanceof VectorTileLayer)&&(e.editable=!0),e.grayable=!1,this.options.allowGrayScale&&(e.layer instanceof TileLayer||e.layer instanceof VectorTileLayer)&&(e.grayable=!0),e.draggable=!1,this.options.allowDraggable&&(e.draggable=!0),e.deletable=!1,this.options.allowDelete&&(e.deletable=!0),e.advancedTools=this.options.advancedTools;var ii=this._createContainerLayerElement(e,this.options.allowTooltips);return e.inRange||ii.classList.add("outOfRange"),ii}onShowLayerSwitcherClick(e){e.target.ariaPressed==="true"&&this.onPanelOpen();var n=this._showLayerSwitcherButton.ariaPressed;this.collapsed=n!=="true",this.dispatchEvent("change:collapsed"),this.options.position&&!this.collapsed&&this.updatePosition(this.options.position)}_updateLayerCounter(){this._layerSwitcherCounter&&(this._layerSwitcherCounter.innerHTML=Object.keys(this._layers).length)}_onChangeLayerOpacity(e){e.target.parentNode.style.setProperty("--progress-right",e.target.value+"%");var n=e.target.id,ei=SelectorID.index(n),ti=this._layers[ei].layer,ii=e.target.value,ri=document.getElementById(this._addUID("GPopacityValue_ID_"+ei));ri.innerHTML=ii+"%",ti.setOpacity(ii/100)}_updateLayerOpacity(e){var n=e.target.getOpacity();n>1&&(n=1),n<0&&(n=0);var ei=e.target.gpLayerId,ti=document.getElementById(this._addUID("GPopacityValueDiv_ID_"+ei));ti&&(ti.value=Math.round(n*100));var ii=document.getElementById(this._addUID("GPopacityValue_ID_"+ei));ii&&(ii.innerHTML=Math.round(n*100)+"%"),this.dispatchEvent({type:this.CHANGE_LAYER_OPACITY_EVENT,opacity:n,layer:this._layers[ei]})}_onVisibilityLayerClick(e){var n=e.target.id,ei=SelectorID.index(n),ti=this._layers[ei].layer;ti.setVisible(e.target.ariaPressed==="true")}_updateLayerVisibility(e){var n=e.target.getVisible(),ei=e.target.gpLayerId,ti=document.getElementById(this._addUID("GPvisibilityPicto_ID_"+ei));ti&&(ti.ariaPressed=n),this.dispatchEvent({type:this.CHANGE_LAYER_VISIBILITY_EVENT,visibility:n,layer:this._layers[ei]})}_onChangeStyleLayerClick(e){var n=e.target.id,ii=SelectorID.index(n),ei=this._layers[ii].layer;ei.set("grayscale",!1);var ti=e.target.id,ii=SelectorID.index(ti),ri=document.getElementById(this._addUID("GPgreyscale_ID_"+ii));ri&&(ri.classList.add("GPlayerGreyscaleOff"),ri.classList.remove("GPlayerGreyscaleOn")),ei.styleUrl=e.target.value,ei.styleName=e.target.dataset.name,ei.setStyleMapBox(),this.dispatchEvent({type:"layerswitcher:change:style",name:ei.styleName,url:ei.styleUrl,layer:this._layers[ii]})}_updateLayersOrder(){var e=this.getMap();if(e){this._layersIndex={};var n,ei;e.getLayers().forEach(ai=>{ei=ai.gpLayerId,unByKey(this._layers[ei].onZIndexChangeEvent),this._layers[ei].onZIndexChangeEvent=null,n=null,ai.getZIndex!==void 0&&(n=ai.getZIndex(),(!this._layersIndex[n]||!Array.isArray(this._layersIndex[n]))&&(this._layersIndex[n]=[]),this._layersIndex[n].push(this._layers[ei]))}),this._lastZIndex=0,this._layersOrder=[];for(var ti in this._layersIndex)if(this._layersIndex.hasOwnProperty(ti))for(var ii=this._layersIndex[ti],ri=0;ri<ii.length;ri++)this._layersOrder.unshift(ii[ri]),this._lastZIndex++,this._layers[ii[ri].layer.gpLayerId].onZIndexChangeEvent==null&&(this._layers[ii[ri].layer.gpLayerId].onZIndexChangeEvent=ii[ri].layer.on("change:zIndex",()=>this._updateLayersOrder()));if(this._layerListContainer){for(let ai=0;ai<this._layerListContainer.childNodes.length;ai++){const oi=this._layerListContainer.childNodes[ai];oi.id!==""&&oi.remove()}for(var ni=0;ni<this._layersOrder.length;ni++){var si=this._layersOrder[ni];this._layerListContainer.appendChild(si.div)}}else logger$C.log("[ol.control.LayerSwitcher] _updateLayersOrder : layer list container not found to update layers order ?!")}}_onOpenLayerInfoClick(e){var n=e.target.id,ei=SelectorID.index(n),ti=this._layers[ei],ii,ri,ni=document.getElementById(e.target.id);if(ni.classList.contains("GPlayerInfoOpened")){ni.classList.remove("GPlayerInfoOpened"),ni.classList.add("GPlayerInfoClosed"),ii=document.getElementById(this._addUID("GPlayerInfoPanel")),ii.classList.remove("GPlayerInfoPanelOpened","gpf-visible"),ii.classList.add("GPlayerInfoPanelClosed","gpf-hidden"),ri=document.getElementById(this._addUID("GPlayerInfoContent")),ri&&ri.parentNode.remove();return}ni.classList.contains("GPlayerInfoClosed")&&(ni.classList.remove("GPlayerInfoClosed"),ni.classList.add("GPlayerInfoOpened")),ii=document.getElementById(this._addUID("GPlayerInfoPanel")),ii.classList.remove("GPlayerInfoPanelClosed","gpf-hidden"),ii.classList.add("GPlayerInfoPanelOpened","gpf-visible"),ri=document.getElementById(this._addUID("GPlayerInfoContent")),ri&&ri.parentNode.remove();var si={id:n,title:ti.title,description:ti.description,quicklookUrl:ti.quicklookUrl,metadata:ti.metadata,legends:ti.legends},ai=ti.layer.getMaxResolution();ai===1/0?si._maxScaleDenominator=56e7:si._maxScaleDenominator=Math.round(ai/28e-5);var oi=this._createContainerLayerInfoElement(si);ii.firstChild.appendChild(oi)}_onEditLayerStyleClick(e,n){var ei=e.target.id,ti=SelectorID.index(ei),ii=this._layers[ti],ri,ni,si=document.getElementById(e.target.id);if(si.classList.contains("GPlayerStyleOpened")){si.classList.remove("GPlayerStyleOpened"),si.classList.add("GPlayerStyleClosed"),ri=document.getElementById(this._addUID("GPlayerStylePanel")),ri.classList.remove("GPlayerStylePanelOpened","gpf-visible"),ri.classList.add("GPlayerStylePanelClosed","gpf-hidden"),ni=document.getElementById(this._addUID("GPlayerStyleContent")),ni&&ni.parentNode.remove();return}si.classList.contains("GPlayerStyleClosed")&&(si.classList.remove("GPlayerStyleClosed"),si.classList.add("GPlayerStyleOpened")),ri=document.getElementById(this._addUID("GPlayerStylePanel")),ri.classList.remove("GPlayerStylePanelClosed","gpf-hidden"),ri.classList.add("GPlayerStylePanelOpened","gpf-visible"),ni=document.getElementById(this._addUID("GPlayerStyleContent")),ni&&ni.parentNode.remove();var ai={id:ti,div:ei,styles:n,layerInfo:ii},oi=ii.layer.getMaxResolution();oi===1/0?ai._maxScaleDenominator=56e7:ai._maxScaleDenominator=Math.round(oi/28e-5);var li=this._createContainerLayerStyleElement(ai);ri.firstChild.appendChild(li)}_onDropLayerClick(e){var n=e.target.id,ei=SelectorID.index(n),ti=this._layers[ei].layer;this.getMap().getLayers().remove(ti)}_onEditLayerClick(e){var n=e.target.id,ei=SelectorID.index(n),ti=this._layers[ei],ii=this._layers[ei].layer;this.dispatchEvent({type:this.EDIT_LAYER_EVENT,layer:ii,options:ti})}_onEndDragAndDropLayerClick(e){logger$C.trace(e);var n=this.getMap(),ei=document.querySelectorAll("div.GPlayerSwitcher_layer"),ti=ei.length;this._layersOrder=[];for(var ii=0;ii<ei.length;ii++){var ri=ei[ii].id,ni=SelectorID.index(ri),si=this._layers[ni].layer;unByKey(this._layers[ni].onZIndexChangeEvent),this._layers[ni].onZIndexChangeEvent=null,si.setZIndex&&(si.setZIndex(ti),this._layersOrder.push(this._layers[ni]),ti--),this._layers[ni].onZIndexChangeEvent==null&&(this._layers[ni].onZIndexChangeEvent=si.on("change:zIndex",()=>this._updateLayersOrder()))}n.updateSize(),this.dispatchEvent({type:"layerswitcher:change:position",position:e.newIndex,layer:this._layersOrder[e.newIndex],layers:this._layersOrder})}_onStartDragAndDropLayerClick(e){logger$C.debug(e)}_updateLayerGrayScale(e){function n(hi){hi.crossOrigin="anonymous";var pi=document.createElement("canvas"),gi=pi.getContext("2d");hi.width=hi.width||256,hi.height=hi.height||256,pi.width=hi.width,pi.height=hi.height,gi.drawImage(hi,0,0);for(var vi=gi.getImageData(0,0,hi.width,hi.height),yi=vi.data,_i=0;_i<yi.length;_i+=4){var Ai=(yi[_i]+yi[_i+1]+yi[_i+2])/3;yi[_i]=Ai,yi[_i+1]=Ai,yi[_i+2]=Ai}return gi.putImageData(vi,0,0),pi.toDataURL()}function ei(hi,pi){var gi=n(hi);hi.src="",hi.src=gi}function ti(hi){hi.image.getImage().crossOrigin="Anonymous"}function ii(hi){hi.tile.getImage().crossOrigin="Anonymous"}function ri(hi){ei(hi.image.getImage(),hi.target)}function ni(hi){ei(hi.tile.getImage(),hi.target)}function si(hi){if(!hi||typeof hi!="string"||!hi.startsWith("#"))return hi;const pi=parseInt(hi.slice(1,3),16),gi=parseInt(hi.slice(3,5),16),vi=parseInt(hi.slice(5,7),16),_i=Math.round(.3*pi+.59*gi+.11*vi).toString(16).padStart(2,"0");return`#${_i}${_i}${_i}`}async function ai(hi){var pi=await li(hi);pi.layers.forEach(gi=>{gi.paint&&Object.keys(gi.paint).forEach(vi=>{let yi=gi.paint[vi];if(Array.isArray(yi)&&yi[0]==="interpolate"&&yi[2]==="zoom")for(let _i=4;_i<yi.length;_i+=2)yi[_i]=si(yi[_i]);else if(Array.isArray(yi)&&yi[0]==="step")for(let _i=2;_i<yi.length;_i+=2)yi[_i]=si(yi[_i]);else if(yi instanceof Object&&yi.stops)for(let _i=0;_i<yi.stops.length;_i+=1)yi.stops[_i][1]=si(yi.stops[_i][1]);else gi.paint[vi]=si(yi)})}),applyStyle(hi,pi)}async function oi(hi){var pi=await li(hi);applyStyle(hi,pi)}async function li(hi){return await(await fetch(hi.styleUrl)).json()}var ci=e.target.gpLayerId,ui=this._layers[ci].layer,di=ui.getSource();if(!(di instanceof ImageSource||di instanceof TileWMS||di instanceof WMTS$1||di instanceof VectorTile)){console.warn("Greyscale only implemented for raster and vector tiles");return}var fi=ui.get("grayscale");fi?di instanceof VectorTile?ai(ui):di instanceof ImageSource?(di.loadstartListenerKey=di.on("imageloadstart",ti),di.loadendListenerKey=di.on("imageloadend",ri)):(di.loadstartListenerKey=di.on("tileloadstart",ii),di.loadendListenerKey=di.on("tileloadend",ni)):di instanceof VectorTile?oi(ui):(unByKey(di.loadstartListenerKey),unByKey(di.loadendListenerKey),di.loadstartListenerKey=null,di.loadendListenerKey=null),di instanceof VectorTile||di.refresh(),this.dispatchEvent({type:this.CHANGE_LAYER_GRAYSCALE_EVENT,grayscale:fi,layer:this._layers[ci]})}_onToggleLayerGreyscaleClick(e){console.trace(e);var n=e.target.id,ei=SelectorID.index(n),ti=this._layers[ei].layer,ii=!0;e.target.classList.contains("GPlayerGreyscaleOff")?(e.target.classList.remove("GPlayerGreyscaleOff"),e.target.classList.add("GPlayerGreyscaleOn")):(e.target.classList.add("GPlayerGreyscaleOff"),e.target.classList.remove("GPlayerGreyscaleOn"),ii=!1),ti.set("grayscale",ii)}_updateLayerLocked(e){var n=e.target.gpLayerId,ei=this._layers[n].layer,ti=ei.get("locked"),ii=document.getElementById(this._addUID("GPlayerSwitcher_ID_"+n));ii&&(ti?ii.setAttribute("disabled",!0):ii.removeAttribute("disabled")),this.dispatchEvent({type:this.CHANGE_LAYER_LOCKED_EVENT,locked:ti,layer:this._layers[n]})}_updateGenericProperty(e){var n=e.target.gpLayerId,ei=this._layers[n].layer,ti=ei.get(e.key);switch(e.key){case"title":this._layers[n].title=ti;var ii=document.getElementById(this._addUID("GPname_ID_"+n));ii&&(ii.innerHTML=ti,ii.title=ti);break;case"description":this._layers[n].description=ti;var ii=document.getElementById(this._addUID("GPname_ID_"+n));ii&&(ii.title=ti);break;case"producer":this._layers[n].producer=ti;var ri=document.getElementById(this._addUID("GPlayerProducer_ID_"+n));ri&&(ri.innerHTML=ti);break}this.dispatchEvent({type:this.PROPERTY_CHANGE_EVENT,key:e.key,value:ti,layer:this._layers[n]})}_onToggleLayerLockedClick(e){var n=e.target.id,ei=SelectorID.index(n),ti=this._layers[ei].layer,ii=e.target.ariaPressed==="true";ti.set("locked",ii)}_onZoomToExtentClick(e){logger$C.debug(e);var n=e.target.id,ei=SelectorID.index(n),ti=this._layers[ei],ii=null,ri=null,ni=this.getMap();if(ti.layer.hasOwnProperty("gpResultLayerId")&&(ti.layer.gpResultLayerId.split(":")[0]==="layerimport"||ti.layer.gpResultLayerId.split(":")[0]==="drawing"||ti.layer.gpResultLayerId.split(":")[0]==="compute"||ti.layer.gpResultLayerId.split(":")[0]==="bookmark")){if(ni.getView()&&ni.getSize()){var si=ti.layer.getExtent();if(!si){var ai=ti.layer.getSource();ai&&ai.getExtent?si=ai.getExtent():si=ai.getTileGrid().getExtent()}si&&si[0]!==1/0&&ni.getView().fit(si,ni.getSize())}}else try{if(!Config.isConfigLoaded())throw"ERROR : contract key configuration has to be loaded to load Geoportal layers.";var oi=ti.layer.name||ti.layer.getSource().name,li=ti.layer.service||ti.layer.getSource().service,ci=Config.configuration.getLayerId(oi,li);if(!ci)throw"ERROR : Layer ID not found into the catalogue !?";var ui=Config.configuration.getGlobalConstraints(ci);if(ui){if(!ni||!ni.getView())return;var di=ni.getView(),fi=di.getProjection(),hi=[ui.extent.left,ui.extent.bottom,ui.extent.right,ui.extent.top],pi=ui.crs;pi||(pi="EPSG:4326"),ii=transformExtent(hi,pi,fi),ii&&di.fit(ii)}}catch(gi){ri=gi}this.dispatchEvent({type:this.EXTENT_LAYER_EVENT,extent:ii,layer:ti,error:ri})}_onClickAdvancedToolsMore(e,n,ei){var ti=e.target.id,ii=SelectorID.index(ti),ri=this._layers[ii],ni=this._layers[ii].layer;if(ei){ei(e,this,ni,ri);return}this.dispatchEvent({type:this.CUSTOM_LAYER_EVENT,action:n,layer:ni,options:ri})}_onClickHeaderButtons(e,n,ei){if(ei){ei(e,this);return}this.dispatchEvent({type:this.HEADER_BUTTON_EVENT,action:n})}_onSelectLayer(e){if(e.type!=="keydown"||["Enter","Space"].includes(e.code)&&e.target.id.startsWith("GPlayerSwitcher_ID_")){const ei=e.target.id,ti=SelectorID.index(ei);if(this._layers[ti]){const ri=this._layers[ti].layer;ri!==this.getSelectedLayer()&&this.setSelectedLayer(ri,!0)}}}getSelectedLayer(){return this.selectedLayer}setSelectedLayer(e,n){let ei=this.getSelectedLayer();if(e===ei&&ei&&ei.get("selected")!==n?(e.set("selected",n),this.selectedLayer=null):!e&&ei?(ei.set("selected",!1),this.selectedLayer=null):(e.set("selected",!!n),n?this.selectedLayer=e:this.selectedLayer=null,ei&&ei.set("selected",!1)),this.getSelectedLayer()){const ti=this._layers[this.getSelectedLayer().gpLayerId].div;ti.ariaCurrent=!0}if(ei){const ti=this._layers[ei.gpLayerId].div;ti.ariaCurrent=!1}this.dispatchEvent({type:this.CHANGE_LAYER_SELECTED_EVENT,layer:this.getSelectedLayer(),previous:ei})}_onMapMoveEnd(e){e.getLayers().forEach(n=>{var ei=n.gpLayerId;if(this._layers[ei]){var ti=this._layers[ei],ii;if(this.isInRange(n,e)&&!ti.inRange){ti.inRange=!0,ii=document.getElementById(this._addUID("GPlayerSwitcher_ID_"+ei)),ii.classList.remove("outOfRange");var ri=this.getLayerInfo(n),ni=ri._title,si=ri._description,ai=document.getElementById(this._addUID("GPname_ID_"+ei));ai&&(ai.title=si||ni)}else!this.isInRange(n,e)&&ti.inRange&&(ti.inRange=!1,ii=document.getElementById(this._addUID("GPlayerSwitcher_ID_"+ei)),ii.classList.add("outOfRange"))}})}getLayerDOMId(e){var n=null;return this.getMap().getLayers().forEach(ei=>{ei===e&&(n=ei.hasOwnProperty("gpLayerId")?ei.gpLayerId:null)}),n!==null?this._addUID("GPlayerSwitcher_ID_"+n):null}isInRange(e,n){if(n){var ei=e.gpLayerId,ti=document.getElementById(this._addUID("GPname_ID_"+ei)),ii=n.getView().getResolution();if(ii>e.getMaxResolution()||ii<e.getMinResolution()){var ri="Cette couche n'est pas visible  ce niveau de zoom";return ti&&(ti.title=ri),!1}var ni=n.getView().calculateExtent(n.getSize()),si=e.getExtent();if(si&&!intersects$1(ni,si)){var ri="Cette couche n'est pas visible  cet endroit";return ti&&(ti.title=ri),!1}return!0}}getLayerInfo(e){var n={};if(e.getProperties!==void 0&&e.getSource!==void 0){var ei=e.getProperties(),ti=ei.source;ti&&(n._title=ti._title||ei.title||ei.id||"",n._description=ti._description||ei.description||"",n._producer=ti._producer||ei.producer||"",n._thumbnail=ti._thumbnail||ei.thumbnail||"",n._quicklookUrl=ti._quicklookUrl||ei.quicklookUrl||"",n._metadata=ti._metadata||ei.metadata||[],n._legends=ti._legends||ei.legends||[])}return n}setLayerProducer(e,n){let ei=e.gpLayerId,ti=this._layers[ei].div;if(ti){let ii=ti.querySelector(".GPlayerTitle");if(ii.childElementCount===2&&ii.querySelector(".GPlayerProducer").remove(),n){let ri=this._createLayerProducerElement({producer:n},this.options.allowTooltips);ii.appendChild(ri)}}}};qr(bl,"switcherButtons",{INFO:"info",EDIT:"edition",GREYSCALE:"greyscale",EXTENT:"extent"});let LayerSwitcher=bl;Object.assign(LayerSwitcher.prototype,LayerSwitcherDOM);Object.assign(LayerSwitcher.prototype,Widget);window.ol&&window.ol.control&&(window.ol.control.LayerSwitcher=LayerSwitcher);LoggerByDefault.getLogger("draggable");var Draggable={dragElement:function(_t,e,n){let ei=0,ti=0,ii=0,ri=0,ni=0,si=0;e?e.addEventListener("mousedown",li,!0):_t.addEventListener("mousedown",li,!0);var ai,oi={bottom:0,left:0,right:0,top:0};function li(di){di=di||window.event,di.preventDefault(),ei=di.clientX,ti=di.clientY,ai=_t.getBoundingClientRect();const fi=n.getBoundingClientRect();oi={bottom:fi.bottom,left:fi.left,right:fi.right,top:fi.top},document.addEventListener("mouseup",ci,!0),document.addEventListener("mousemove",ui,!0)}function ci(){ni-=ii,si-=ri,document.removeEventListener("mouseup",ci,!0),document.removeEventListener("mousemove",ui,!0)}function ui(di){di=di||window.event;let fi=di.clientX,hi=di.clientY,pi=ii,gi=ri;ii=ei-fi,ri=ti-hi;var vi=ai.left-ii,yi=ai.top-ri;if(vi<oi.left||yi<oi.top||vi+ai.width>oi.right||yi+ai.height>oi.bottom)ii=pi,ri=gi;else{let _i=ni-ii,Ai=si-ri;_t.style.transform="translate("+_i+"px,"+Ai+"px)"}}}};class AsyncData{constructor(e){this.data=e,this.subscribers=[]}subscribe(e){if(typeof e!="function")throw new Error("Callback must be a function");this.subscribers.push(e)}async set(e,n){this.data[e]=n;const ei=this.subscribers.map(async ti=>{await ti(e,n)});await Promise.allSettled(ei)}get(e){return this.data[e]}}var GetFeatureInfoDOM={_addUID:function(_t){var e=this.uid?_t+"-"+this.uid:_t;return e},stringToHTML:function(_t){var e=function(){if(!window.DOMParser)return!1;var ii=new DOMParser;try{ii.parseFromString("x","text/html")}catch{return!1}return!0};if(e()){var n=new DOMParser,ei=n.parseFromString(_t,"text/html");return ei.body}var ti=document.createElement("div");return ti.innerHTML=_t,ti},_createMainContainerElement:function(){var _t=document.createElement("div");return _t.id=this._addUID("GPgetFeatureInfo"),_t.className="GPgetFeatureInfo gpf-widget gpf-widget-button gpf-mobile-fullscreen",_t},_createShowGetFeatureInfoPictoElement:function(){var _t=this,e=document.createElement("button"),n=document.createElement("span");return e.appendChild(n),e.id=this._addUID("GPgetFeatureInfoPicto"),e.classList.add("GPshowOpen","GPshowAdvancedToolPicto","GPgetFeatureInfoPicto"),e.classList.add("gpf-btn","gpf-btn--tertiary","gpf-btn-icon","gpf-btn-icon-getfeatureinfo"),e.classList.add("fr-btn","fr-btn--tertiary"),e.setAttribute("aria-label","Activer/dsactiver l'interrogation des couches"),e.setAttribute("tabindex","0"),e.setAttribute("aria-pressed",!1),e.setAttribute("type","button"),e.addEventListener?e.addEventListener("click",function(ei){var ti=ei.target.ariaPressed==="true";ei.target.setAttribute("aria-pressed",!ti),_t.onShowGetFeatureInfoClick(ei)}):e.attachEvent&&e.attachEvent("onclick",function(ei){var ti=ei.target.ariaPressed==="true";ei.target.setAttribute("aria-pressed",!ti),_t.onShowGetFeatureInfoClick(ei)}),e},_createGetFeatureInfoPanelElement:function(){var _t=document.createElement("dialog");return _t.id=this._addUID("GPgetFeatureInfoPanel"),_t.className="GPpanel gpf-panel fr-modal",_t},_createGetFeatureInfoPanelDivElement:function(){var _t=document.createElement("div");return _t.className="GPpanelBody fr-modal__body",_t},_createGetFeatureInfoPanelHeaderElement:function(){var _t=document.createElement("div");return _t.className="GPpanelHeader gpf-panel__header_gfi",_t},_createGetFeatureInfoPanelIconElement:function(){var _t=document.createElement("label");return _t.className="GPpanelIcon gpf-btn-header_gfi gpf-btn-icon-header_gfi",_t.title="Get Feature Info",_t},_createGetFeatureInfoPanelTitleElement:function(){var _t=document.createElement("div");return _t.className="GPpanelTitle gpf-panel__title_gfi fr-modal__title",_t.innerHTML="Infos sur les couches",_t},_createGetFeatureInfoPanelCloseElement:function(){var _t=this,e=document.createElement("button");e.className="GPpanelClose GPcloseGetFeatureInfo gpf-btn gpf-btn-icon-close fr-btn--close fr-btn fr-btn--tertiary-no-outline",e.title="Fermer le panneau",e.addEventListener?e.addEventListener("click",function(ei){e.setAttribute("aria-pressed",!1),_t.onCloseGetFeatureInfoClick()},!1):e.attachEvent&&e.attachEvent("onclick",function(ei){e.setAttribute("aria-pressed",!1),_t.onCloseGetFeatureInfoClick()});var n=document.createElement("span");return n.className="GPelementHidden gpf-visible",n.innerText="Fermer",e.appendChild(n),e},_createGetFeatureInfoWaitingDiv:function(){var _t=`
        <div class="waiting-div-container"><div class="lds-ring"><div></div><div></div><div></div><div></div></div><div>
        `;return _t},_createGetFeatureInfoNoData:function(_t){var e=document.createElement("div");return e.className="GPgetFeatureInfoNoData fr-py-2w fr-px-2w",console.log(this.stringToHTML(_t)),e.insertAdjacentHTML("beforeend",_t),e},_createGetFeatureInfoAccordionGroup:function(){var _t=document.createElement("div");return _t.id=this._addUID("GPgetFeatureInfoAccordionGroup"),_t.className="GPgetFeatureInfoAccordionGroup fr-accordions-group",_t},_createGetFeatureInfoLayerAccordion:function(_t){var e=this.stringToHTML(`
            <section class="fr-accordion">
                <h3 class="fr-accordion__title">
                    <button class="GPgfiLayerButton fr-accordion__btn" aria-expanded="false" aria-controls="accordion-${_t}">
                        <span class="GPshowGfiLayerFeature"></span>
                        <span id="gfiLayerName">${_t}</span>
                    </button>
                </h3>
                <div class="fr-collapse GPgetFeatureInfoAccordionContent GPelementHidden" id="accordion-${_t}" style="margin:unset;">
                    ${this._createGetFeatureInfoWaitingDiv()}
                </div>
            </section>
        `),n=e.firstChild,ei=n.querySelector("button, button.fr-accordion__btn");return ei.addEventListener("click",ti=>{ti.currentTarget.ariaExpanded=ti.currentTarget.ariaExpanded!=="true";var ii=document.getElementById(ti.currentTarget.getAttribute("aria-controls"));ti.currentTarget.ariaExpanded==="true"?(ii.classList.add("fr-collapse--expanded"),ii.classList.remove("GPelementHidden"),requestAnimationFrame(()=>{ei.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})})):(ii.classList.remove("fr-collapse--expanded"),ii.classList.add("GPelementHidden"))}),n}},logger$B=LoggerByDefault.getLogger("getFeatureInfo");class GetFeatureInfo extends ControlExtended{constructor(e){if(e=e||{},super(e),!(this instanceof GetFeatureInfo))throw new TypeError("ERROR CLASS_CONSTRUCTOR");return this.CLASSNAME="GetFeatureInfo",this.initialize(e),this.container=this.initContainer(),this.element?this.element.appendChild(this.container):this.element=this.container,this}setMap(e){e?(this.draggable&&Draggable.dragElement(this.panelGetFeatureInfoContainer,this.panelGetFeatureInfoHeaderContainer,e.getTargetElement()),this.collapsed||this.buttonGetFeatureInfoShow.setAttribute("aria-pressed",!0),this.auto&&this.addEventsListeners(e)):this.auto&&this.removeEventsListeners(),super.setMap(e),this.options.position&&this.setPosition(this.options.position),this.options.gutter===!1&&this.element.classList.add("gpf-button-no-gutter")}initialize(e){this.uid=e.id||SelectorID.generate(),this.options={collapsed:!0,draggable:!1,auto:!0},Helper.assign(this.options,e),this.collapsed=this.options.collapsed,this.draggable=this.options.draggable,this.noDataMessage=this.options.noDataMessage,this.auto=this.options.auto,this.buttonGetFeatureInfoShow=null,this.panelGetFeatureInfoContainer=null,this.getFeatureInfoPanelDiv=null,this.panelGetFeatureInfoHeaderContainer=null,this.buttonGetFeatureInfoClose=null,this.getFeatureInfoAccordionGroup=null,this.panelGetFeatureInfoEntriesContainer=null,this.noDataMessageDiv=null,this.eventsListeners=[],this.pixel=[],this.coordinates=[],this.layers=[],this.res=null}initContainer(){var e=this._createMainContainerElement(),n=this.buttonGetFeatureInfoShow=this._createShowGetFeatureInfoPictoElement();e.appendChild(n);var ei=this.panelGetFeatureInfoContainer=this._createGetFeatureInfoPanelElement(),ti=this.getFeatureInfoPanelDiv=this._createGetFeatureInfoPanelDivElement();ei.appendChild(ti);var ii=this.panelGetFeatureInfoHeaderContainer=this._createGetFeatureInfoPanelHeaderElement(),ri=this._createGetFeatureInfoPanelIconElement();ii.appendChild(ri);var ni=this._createGetFeatureInfoPanelTitleElement();ii.appendChild(ni);var si=this.buttonGetFeatureInfoClose=this._createGetFeatureInfoPanelCloseElement();ii.appendChild(si),ti.appendChild(ii);var ai=this.getFeatureInfoAccordionGroup=this._createGetFeatureInfoAccordionGroup();return ti.appendChild(ai),this.noDataMessage&&(this.noDataMessageDiv=this._createGetFeatureInfoNoData(this.noDataMessage)),e.appendChild(ei),logger$B.log(e),e}addEventsListeners(e){var n=this;this.eventsListeners.singleclick=function(ei){logger$B.trace(ei),n.onMapClick(ei)},e.on("singleclick",this.eventsListeners.singleclick)}removeEventsListeners(){var e=this.getMap();e.getLayers().un("singleclick",this.eventsListeners.singleclick),delete this.eventsListeners.singleclick}getFeatureInfoIsActive(){return this.buttonGetFeatureInfoShow.getAttribute("aria-pressed")}onMapClick(e){if(this.getFeatureInfoIsActive()==="true")if(this.getFeatureInfoAccordionGroup.remove(),this.noDataMessage&&this.noDataMessageDiv.remove(),this.buttonGetFeatureInfoClose.setAttribute("aria-pressed",!0),this.layers=e.map.getLayers().getArray().filter(ei=>{if(ei.isVisible(e.map.getView())&&ei.getOpacity()>0)return ei}).sort((ei,ti)=>ti.getZIndex()-ei.getZIndex()),this.layers.length>0){var n=this.getFeatureInfoAccordionGroup=this._createGetFeatureInfoAccordionGroup();this.getFeatureInfoPanelDiv.appendChild(n),this.map=e.map,this.pixel=e.pixel,this.coordinates=e.coordinate,this.res=e.map.getView().getResolution(),this.displayGetFeatureInfo()}else{this.noDataMessage&&this.getFeatureInfoPanelDiv.append(this.noDataMessageDiv);return}}getGetFeatureInfoLayer(e){var n={};let ei=this.getLayerFormat(e);if(n={format:ei,layer:e},ei==="wmts"){let ti=e.getSource().getFeatureInfoUrl(this.coordinates,this.res,this.map.getView().getProjection(),{INFOFORMAT:"text/html",STYLES:""});n={...n,url:ti}}if(ei==="wms"){let ti=e.getSource().getFeatureInfoUrl(this.coordinates,this.res,this.map.getView().getProjection(),{INFO_FORMAT:"text/html",STYLES:""});n={...n,url:ti}}return n}getFeaturesAtClick(e){var n=[];return this.getMap().forEachFeatureAtPixel(this.pixel,function(ei,ti){e==ti&&n.push(ei)}),n}async getGetFeatureInfoContent(e){var n=null;if(e.format==="vector"){var ei=this.getFeaturesAtClick(e.layer);return ei&&(n=this.features2html(ei)),n}else return fetch(e.url).then(ti=>ti.text()).then(ti=>{var ii=!1;if((ti.trim().length===0||ti.indexOf("ServiceExceptionReport")!==-1||ti.indexOf("java.lang.NullPointerException")!==-1||ti.indexOf("java.lang.OutOfMemoryError")!==-1||ti.indexOf("not queryable")!==-1||ti.indexOf("No data")!==-1||ti.indexOf("non interrogeable")!==-1)&&(ii=!0),ii)return null;var ri=this.stringToHTML(ti);return ri&&ri.innerHTML&&ri.innerHTML.trim().length>0?ti:null}).catch(ti=>(logger$B.log(ti),ti))}getLayerTitle(e){if(e.layer.getProperties!==void 0&&e.layer.getSource!==void 0){var n=e.layer.getProperties(),ei=n.source,ti="";ei&&(ti=ei._title||ei.name||n.title||n.name||ei.url_||"Couche de donnes")}return ti}displayGetFeatureInfo(){var e=this.layers.map(ei=>this.getGetFeatureInfoLayer(ei)),n=e.map(ei=>{var ti=this.getLayerTitle(ei),ii=null,ri=this._createGetFeatureInfoLayerAccordion(ti);ri.style.display="none";var ni=!0;return new AsyncData({...ei,layername:ti,content:ii,contentDiv:ri,pending:ni})});for(let ei=0;ei<n.length;ei++)this.getFeatureInfoAccordionGroup.append(n[ei].data.contentDiv);n.forEach(ei=>{ei.subscribe((ti,ii)=>{ti=="content"&&(ei.set("pending",!1),ei.get("content")?(ei.get("contentDiv").querySelector("div.fr-collapse").innerHTML=ei.get("content"),this.buttonGetFeatureInfoClose.setAttribute("aria-pressed",!0),ei.get("contentDiv").style.display="block"):ei.get("contentDiv").remove(),n.filter(ri=>ri.get("pending")===!0).length==0&&n.filter(ri=>ri.get("content")).length==0&&(this.noDataMessage?this.getFeatureInfoPanelDiv.append(this.noDataMessageDiv):this.buttonGetFeatureInfoClose.setAttribute("aria-pressed",!1)))})}),n.forEach(ei=>{this.getGetFeatureInfoContent(ei.data).then(ti=>{ei.set("content",ti)})})}getLayerFormat(e){var n=typeof e.getType=="function"?e.getType():null,ei=e.getSource();if(n){if(n==="VECTOR"||n==="VECTOR_TILE")return"vector";if(n==="TILE")return ei.tileGrid?"wmts":"wms";if(n==="IMAGE")return"wms"}else{if(ei instanceof TileWMS||ei instanceof ImageWMS)return"wms";if(ei instanceof WMTS$1)return"wmts";if(ei instanceof VectorSource||ei instanceof VectorTile)return"vector"}return"unknown"}features2html(e){var n=document.createElement("div");return e.forEach(function(ei){var ti=ei.getProperties();if(ti.hasOwnProperty("render"))n.insertAdjacentHTML("beforeend",ti.render);else{if(ti.hasOwnProperty("name")){var ii=document.createElement("div");ii.className="gp-att-name-div",ii.insertAdjacentHTML("afterbegin",ti.name),n.appendChild(ii)}if(ti.hasOwnProperty("description")){var ri=document.createElement("div");ri.className="gp-att-description-div",ri.insertAdjacentHTML("afterbegin",ti.description),n.appendChild(ri)}var ni=null,si=!1,ai=null,oi=null,li=null,ci=["fill","fill-opacity","label-fill","label-fill-opacity","label-stroke","label-stroke-opacity","label-stroke-width","label-font","label-textAlign","stroke","stroke-opacity","stroke-width","marker-symbol","marker-color","marker-size","geometry","value","name","description","styleUrl","extensionsNode_","icon"];for(ni in ti)if(ti[ni]!==void 0&&ci.indexOf(ni)===-1){si||(ai=document.createElement("div"),ai.className="gp-att-others-div",oi=document.createElement("ul"),si=!0),li=document.createElement("li");var ui=document.createElement("span");ui.className="gp-attname-others-span",ui.appendChild(document.createTextNode(ni+" : ")),li.appendChild(ui),li.appendChild(document.createTextNode(ti[ni])),oi.appendChild(li)}oi&&(ai.appendChild(oi),n.appendChild(ai))}}),n.hasChildNodes()?n=n.innerHTML:n="",n}onShowGetFeatureInfoClick(e){e.target.ariaPressed==="true"&&this.onPanelOpen(),e.target.ariaPressed==="false"&&this.buttonGetFeatureInfoClose.setAttribute("aria-pressed",!1),logger$B.trace(e)}onCloseGetFeatureInfoClick(e){logger$B.trace(e)}onGetFeatureInfoComputationSubmit(e){logger$B.trace(e)}}Object.assign(GetFeatureInfo.prototype,GetFeatureInfoDOM);Object.assign(GetFeatureInfo.prototype,Widget);window.ol&&window.ol.control&&(window.ol.control.GetFeatureInfo=GetFeatureInfo);var MathUtils={modulo:function(_t,e){var n=_t%e;return n*e<0?n+e:n},decimalToDMS:function(_t,e,n){var ei=this.modulo(_t+180,360)-180,ti=Math.abs(3600*ei),ii=n||0,ri=Math.pow(10,ii),ni=Math.floor(ti/3600),si=Math.floor((ti-ni*3600)/60),ai=ti-ni*3600-si*60;ai=Math.ceil(ai*ri)/ri,ai>=60&&(ai=0,si+=1),si>=60&&(si=0,ni+=1);var oi=e.charAt(ei<0?1:0);return{d:ni,m:si,s:ai,direction:oi}},dmsToDecimal(_t,e,n,ei){var ti=_t+e/60+n/3600;return(ei=="S"||ei=="O")&&(ti=ti*-1),ti},coordinateToDecimal(_t){var e={};return e.lat=_t[1].toFixed(6),e.lng=_t[0].toFixed(6),e.unit="",e},coordinateToDMS(_t){return{lng:MathUtils.decimalToDMS(_t[0],"EO",2),lat:MathUtils.decimalToDMS(_t[1],"NS",2),unit:"DMS"}},coordinateToRad(_t){var e={},n=.017453292519943295;return e.lng=_t[0]*n,e.lng=e.lng.toFixed(8),e.lat=_t[1]*n,e.lat=e.lat.toFixed(8),e.unit="rad",e},coordinateToGon(_t){var e={},n=1.1111111111111112;return e.lng=_t[0]*n,e.lng=e.lng.toFixed(8),e.lat=_t[1]*n,e.lat=e.lat.toFixed(8),e.unit="gon",e},coordinateToMeter(_t){var e={};return e.x=_t[0].toFixed(2),e.y=_t[1].toFixed(2),e.unit="m",e},coordinateToKMeter(_t){var e={};return e.x=(_t[0]/1e3).toFixed(2),e.y=(_t[1]/1e3).toFixed(2),e.unit="km",e},toInteger:function(_t,e){var n=e||10,ei=parseInt(_t,n);return!isNaN(ei)&&isFinite(ei)?ei:null},isInteger:function(_t){if(isNaN(_t))return!1;var e=parseFloat(_t);return(e|0)===e},toFloat:function(_t){var e=parseFloat(_t);return!isNaN(e)&&isFinite(e)?e:null},convertSecondsToTime:function(_t){var e="";_t=Math.round(_t);var n=Math.floor(_t/3600),ei=_t%3600,ti=Math.floor(ei/60);return n&&(e=n+"h "),e+=ti+" min",e},convertDistance:function(_t){var e="",n=parseInt(_t/1e3,10);return n?e=n+" km":e=parseInt(_t,10)+" m",e}},SearchEngineUtils={advancedSearchFiltersByDefault:{PositionOfInterest:[{name:"q",title:"Chercher un lieu"},{name:"category",title:"Type",value:["cimetire","arodrome","rservoir","administratif","construction linaire","construction ponctuelle","construction surfacique","cours d'eau","dtail hydrographique","dtail orographique","quipement de transport","plan d'eau","poste de transformation","terrain de sport","transport par cble","zone d'activit ou d'intrt","zone d'habitation","lieu-dit non habit"]},{name:"postcode",title:"Code postal"},{name:"citycode",title:"Code INSEE"}],StreetAddress:[{name:"address",title:"Adresse"},{name:"city",title:"Ville"},{name:"postcode",title:"Code postal"}],CadastralParcel:[{name:"departmentcode",title:"Code dpartement (INSEE)",description:"Code INSEE du dpartement (ex: 01, 94)"},{name:"municipalitycode",title:"Code commune (INSEE)",description:"Code INSEE de la commune : 3 chiffres (ex: 067)"},{name:"oldmunicipalitycode",title:"Commune absorbe",description:"Commune absorbe : 3 chiffres (ex: 000, 001)"},{name:"districtcode",title:"Arrondissement",description:"Arrondissement : 3 chiffres (ex: 004, 012)"},{name:"section",title:"Section",description:"Section Cadastrale : 2 caractres (chiffre et/ou lettre)"},{name:"number",title:"Numro",description:"Numro de la parcelle : 4 chiffres (ex: 0041, 0250)"},{name:"sheet",title:"Feuille",description:"Numro de la feuille cadastrale"}]},zoomToResultsByDefault:function(_t){var e=15,n=_t.service,ei=_t.fields,ti=_t.type,ii={1:11,2:12,3:13,4:14,5:15,6:16,7:17,8:17};return n==="SuggestedLocation"&&ti==="PositionOfInterest"&&(e=ii[ei.classification]),n==="GeocodedLocation"&&ti==="PositionOfInterest"&&(e=ii[ei.importance]||14),ti==="StreetAddress"&&(e=17),ti==="CadastralParcel"&&(e=17),e}},GeocodeUtils={getGeocodedLocationFreeform:function(_t){var e=_t.placeAttributes;if(e.label)return e.label;if(_t.type==="PositionOfInterest"){var n=e.toponym;return e.category&&Array.isArray(e.category)&&e.category.length>=2&&e.category[0]==="administratif"?n=n+", "+e.category[1]:e.postcode&&(n=n+", "+e.postcode[0],e.city&&(n=n+" "+e.city[0])),n}else return _t.type==="StreetAddress"?(e.housenumber?e.housenumber+" ":"")+e.street+" "+(e.postcode?e.postcode+", ":"")+e.city:_t.type==="CadastralParcel"?e.id:"..."},getSuggestedLocationFreeform:function(_t){if(_t.fullText)return _t.fullText;var e=[];return e.push(_t.street||""),e.push(_t.postalCode||""),e.push(_t.commune||""),_t.type==="PositionOfInterest"&&(e.push(_t.poi||""),e.push(_t.kind||"")),e.join(" - ")}};function globals(_t){_t("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),_t("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),_t("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs");for(var e=1;e<=60;++e)_t("EPSG:"+(32600+e),"+proj=utm +zone="+e+" +datum=WGS84 +units=m"),_t("EPSG:"+(32700+e),"+proj=utm +zone="+e+" +south +datum=WGS84 +units=m");_t.WGS84=_t["EPSG:4326"],_t["EPSG:3785"]=_t["EPSG:3857"],_t.GOOGLE=_t["EPSG:3857"],_t["EPSG:900913"]=_t["EPSG:3857"],_t["EPSG:102113"]=_t["EPSG:3857"]}var PJD_3PARAM=1,PJD_7PARAM=2,PJD_GRIDSHIFT=3,PJD_WGS84=4,PJD_NODATUM=5,SRS_WGS84_SEMIMAJOR=6378137,SRS_WGS84_SEMIMINOR=6356752314e-3,SRS_WGS84_ESQUARED=.0066943799901413165,SEC_TO_RAD=484813681109536e-20,HALF_PI=Math.PI/2,SIXTH=.16666666666666666,RA4=.04722222222222222,RA6=.022156084656084655,EPSLN=1e-10,D2R$1=.017453292519943295,R2D=57.29577951308232,FORTPI=Math.PI/4,TWO_PI=Math.PI*2,SPI=3.14159265359,exports$2={};exports$2.greenwich=0;exports$2.lisbon=-9.131906111111;exports$2.paris=2.337229166667;exports$2.bogota=-74.080916666667;exports$2.madrid=-3.687938888889;exports$2.rome=12.452333333333;exports$2.bern=7.439583333333;exports$2.jakarta=106.807719444444;exports$2.ferro=-17.666666666667;exports$2.brussels=4.367975;exports$2.stockholm=18.058277777778;exports$2.athens=23.7163375;exports$2.oslo=10.722916666667;const units={mm:{to_meter:.001},cm:{to_meter:.01},ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937},fath:{to_meter:1.8288},kmi:{to_meter:1852},"us-ch":{to_meter:20.1168402336805},"us-mi":{to_meter:1609.34721869444},km:{to_meter:1e3},"ind-ft":{to_meter:.30479841},"ind-yd":{to_meter:.91439523},mi:{to_meter:1609.344},yd:{to_meter:.9144},ch:{to_meter:20.1168},link:{to_meter:.201168},dm:{to_meter:.01},in:{to_meter:.0254},"ind-ch":{to_meter:20.11669506},"us-in":{to_meter:.025400050800101},"us-yd":{to_meter:.914401828803658}};var ignoredChar=/[\s_\-\/\(\)]/g;function match(_t,e){if(_t[e])return _t[e];for(var n=Object.keys(_t),ei=e.toLowerCase().replace(ignoredChar,""),ti=-1,ii,ri;++ti<n.length;)if(ii=n[ti],ri=ii.toLowerCase().replace(ignoredChar,""),ri===ei)return _t[ii]}function projStr(_t){var e={},n=_t.split("+").map(function(ni){return ni.trim()}).filter(function(ni){return ni}).reduce(function(ni,si){var ai=si.split("=");return ai.push(!0),ni[ai[0].toLowerCase()]=ai[1],ni},{}),ei,ti,ii,ri={proj:"projName",datum:"datumCode",rf:function(ni){e.rf=parseFloat(ni)},lat_0:function(ni){e.lat0=ni*D2R$1},lat_1:function(ni){e.lat1=ni*D2R$1},lat_2:function(ni){e.lat2=ni*D2R$1},lat_ts:function(ni){e.lat_ts=ni*D2R$1},lon_0:function(ni){e.long0=ni*D2R$1},lon_1:function(ni){e.long1=ni*D2R$1},lon_2:function(ni){e.long2=ni*D2R$1},alpha:function(ni){e.alpha=parseFloat(ni)*D2R$1},gamma:function(ni){e.rectified_grid_angle=parseFloat(ni)},lonc:function(ni){e.longc=ni*D2R$1},x_0:function(ni){e.x0=parseFloat(ni)},y_0:function(ni){e.y0=parseFloat(ni)},k_0:function(ni){e.k0=parseFloat(ni)},k:function(ni){e.k0=parseFloat(ni)},a:function(ni){e.a=parseFloat(ni)},b:function(ni){e.b=parseFloat(ni)},r:function(ni){e.a=e.b=parseFloat(ni)},r_a:function(){e.R_A=!0},zone:function(ni){e.zone=parseInt(ni,10)},south:function(){e.utmSouth=!0},towgs84:function(ni){e.datum_params=ni.split(",").map(function(si){return parseFloat(si)})},to_meter:function(ni){e.to_meter=parseFloat(ni)},units:function(ni){e.units=ni;var si=match(units,ni);si&&(e.to_meter=si.to_meter)},from_greenwich:function(ni){e.from_greenwich=ni*D2R$1},pm:function(ni){var si=match(exports$2,ni);e.from_greenwich=(si||parseFloat(ni))*D2R$1},nadgrids:function(ni){ni==="@null"?e.datumCode="none":e.nadgrids=ni},axis:function(ni){var si="ewnsud";ni.length===3&&si.indexOf(ni.substr(0,1))!==-1&&si.indexOf(ni.substr(1,1))!==-1&&si.indexOf(ni.substr(2,1))!==-1&&(e.axis=ni)},approx:function(){e.approx=!0}};for(ei in n)ti=n[ei],ei in ri?(ii=ri[ei],typeof ii=="function"?ii(ti):e[ii]=ti):e[ei]=ti;return typeof e.datumCode=="string"&&e.datumCode!=="WGS84"&&(e.datumCode=e.datumCode.toLowerCase()),e}class PROJJSONBuilderBase{static getId(e){const n=e.find(ei=>Array.isArray(ei)&&ei[0]==="ID");return n&&n.length>=3?{authority:n[1],code:parseInt(n[2],10)}:null}static convertUnit(e,n="unit"){if(!e||e.length<3)return{type:n,name:"unknown",conversion_factor:null};const ei=e[1],ti=parseFloat(e[2])||null,ii=e.find(ni=>Array.isArray(ni)&&ni[0]==="ID"),ri=ii?{authority:ii[1],code:parseInt(ii[2],10)}:null;return{type:n,name:ei,conversion_factor:ti,id:ri}}static convertAxis(e){const n=e[1]||"Unknown";let ei;const ti=n.match(/^\((.)\)$/);if(ti){const ai=ti[1].toUpperCase();if(ai==="E")ei="east";else if(ai==="N")ei="north";else if(ai==="U")ei="up";else throw new Error(`Unknown axis abbreviation: ${ai}`)}else ei=e[2]?e[2].toLowerCase():"unknown";const ii=e.find(ai=>Array.isArray(ai)&&ai[0]==="ORDER"),ri=ii?parseInt(ii[1],10):null,ni=e.find(ai=>Array.isArray(ai)&&(ai[0]==="LENGTHUNIT"||ai[0]==="ANGLEUNIT"||ai[0]==="SCALEUNIT")),si=this.convertUnit(ni);return{name:n,direction:ei,unit:si,order:ri}}static extractAxes(e){return e.filter(n=>Array.isArray(n)&&n[0]==="AXIS").map(n=>this.convertAxis(n)).sort((n,ei)=>(n.order||0)-(ei.order||0))}static convert(e,n={}){switch(e[0]){case"PROJCRS":n.type="ProjectedCRS",n.name=e[1],n.base_crs=e.find(ci=>Array.isArray(ci)&&ci[0]==="BASEGEOGCRS")?this.convert(e.find(ci=>Array.isArray(ci)&&ci[0]==="BASEGEOGCRS")):null,n.conversion=e.find(ci=>Array.isArray(ci)&&ci[0]==="CONVERSION")?this.convert(e.find(ci=>Array.isArray(ci)&&ci[0]==="CONVERSION")):null;const ei=e.find(ci=>Array.isArray(ci)&&ci[0]==="CS");ei&&(n.coordinate_system={type:ei[1],axis:this.extractAxes(e)});const ti=e.find(ci=>Array.isArray(ci)&&ci[0]==="LENGTHUNIT");if(ti){const ci=this.convertUnit(ti);n.coordinate_system.unit=ci}n.id=this.getId(e);break;case"BASEGEOGCRS":case"GEOGCRS":n.type="GeographicCRS",n.name=e[1];const ii=e.find(ci=>Array.isArray(ci)&&(ci[0]==="DATUM"||ci[0]==="ENSEMBLE"));if(ii){const ci=this.convert(ii);ii[0]==="ENSEMBLE"?n.datum_ensemble=ci:n.datum=ci;const ui=e.find(di=>Array.isArray(di)&&di[0]==="PRIMEM");ui&&ui[1]!=="Greenwich"&&(ci.prime_meridian={name:ui[1],longitude:parseFloat(ui[2])})}n.coordinate_system={type:"ellipsoidal",axis:this.extractAxes(e)},n.id=this.getId(e);break;case"DATUM":n.type="GeodeticReferenceFrame",n.name=e[1],n.ellipsoid=e.find(ci=>Array.isArray(ci)&&ci[0]==="ELLIPSOID")?this.convert(e.find(ci=>Array.isArray(ci)&&ci[0]==="ELLIPSOID")):null;break;case"ENSEMBLE":n.type="DatumEnsemble",n.name=e[1],n.members=e.filter(ci=>Array.isArray(ci)&&ci[0]==="MEMBER").map(ci=>({type:"DatumEnsembleMember",name:ci[1],id:this.getId(ci)}));const ri=e.find(ci=>Array.isArray(ci)&&ci[0]==="ENSEMBLEACCURACY");ri&&(n.accuracy=parseFloat(ri[1]));const ni=e.find(ci=>Array.isArray(ci)&&ci[0]==="ELLIPSOID");ni&&(n.ellipsoid=this.convert(ni)),n.id=this.getId(e);break;case"ELLIPSOID":n.type="Ellipsoid",n.name=e[1],n.semi_major_axis=parseFloat(e[2]),n.inverse_flattening=parseFloat(e[3]),e.find(ci=>Array.isArray(ci)&&ci[0]==="LENGTHUNIT")&&this.convert(e.find(ci=>Array.isArray(ci)&&ci[0]==="LENGTHUNIT"),n);break;case"CONVERSION":n.type="Conversion",n.name=e[1],n.method=e.find(ci=>Array.isArray(ci)&&ci[0]==="METHOD")?this.convert(e.find(ci=>Array.isArray(ci)&&ci[0]==="METHOD")):null,n.parameters=e.filter(ci=>Array.isArray(ci)&&ci[0]==="PARAMETER").map(ci=>this.convert(ci));break;case"METHOD":n.type="Method",n.name=e[1],n.id=this.getId(e);break;case"PARAMETER":n.type="Parameter",n.name=e[1],n.value=parseFloat(e[2]),n.unit=this.convertUnit(e.find(ci=>Array.isArray(ci)&&(ci[0]==="LENGTHUNIT"||ci[0]==="ANGLEUNIT"||ci[0]==="SCALEUNIT"))),n.id=this.getId(e);break;case"BOUNDCRS":n.type="BoundCRS";const si=e.find(ci=>Array.isArray(ci)&&ci[0]==="SOURCECRS");if(si){const ci=si.find(ui=>Array.isArray(ui));n.source_crs=ci?this.convert(ci):null}const ai=e.find(ci=>Array.isArray(ci)&&ci[0]==="TARGETCRS");if(ai){const ci=ai.find(ui=>Array.isArray(ui));n.target_crs=ci?this.convert(ci):null}const oi=e.find(ci=>Array.isArray(ci)&&ci[0]==="ABRIDGEDTRANSFORMATION");oi?n.transformation=this.convert(oi):n.transformation=null;break;case"ABRIDGEDTRANSFORMATION":if(n.type="Transformation",n.name=e[1],n.method=e.find(ci=>Array.isArray(ci)&&ci[0]==="METHOD")?this.convert(e.find(ci=>Array.isArray(ci)&&ci[0]==="METHOD")):null,n.parameters=e.filter(ci=>Array.isArray(ci)&&(ci[0]==="PARAMETER"||ci[0]==="PARAMETERFILE")).map(ci=>{if(ci[0]==="PARAMETER")return this.convert(ci);if(ci[0]==="PARAMETERFILE")return{name:ci[1],value:ci[2],id:{authority:"EPSG",code:8656}}}),n.parameters.length===7){const ci=n.parameters[6];ci.name==="Scale difference"&&(ci.value=Math.round((ci.value-1)*1e12)/1e6)}n.id=this.getId(e);break;case"AXIS":n.coordinate_system||(n.coordinate_system={type:"unspecified",axis:[]}),n.coordinate_system.axis.push(this.convertAxis(e));break;case"LENGTHUNIT":const li=this.convertUnit(e,"LinearUnit");n.coordinate_system&&n.coordinate_system.axis&&n.coordinate_system.axis.forEach(ci=>{ci.unit||(ci.unit=li)}),li.conversion_factor&&li.conversion_factor!==1&&n.semi_major_axis&&(n.semi_major_axis={value:n.semi_major_axis,unit:li});break;default:n.keyword=e[0];break}return n}}class PROJJSONBuilder2015 extends PROJJSONBuilderBase{static convert(e,n={}){return super.convert(e,n),n.coordinate_system&&n.coordinate_system.subtype==="Cartesian"&&delete n.coordinate_system,n.usage&&delete n.usage,n}}class PROJJSONBuilder2019 extends PROJJSONBuilderBase{static convert(e,n={}){super.convert(e,n);const ei=e.find(ii=>Array.isArray(ii)&&ii[0]==="CS");ei&&(n.coordinate_system={subtype:ei[1],axis:this.extractAxes(e)});const ti=e.find(ii=>Array.isArray(ii)&&ii[0]==="USAGE");if(ti){const ii=ti.find(si=>Array.isArray(si)&&si[0]==="SCOPE"),ri=ti.find(si=>Array.isArray(si)&&si[0]==="AREA"),ni=ti.find(si=>Array.isArray(si)&&si[0]==="BBOX");n.usage={},ii&&(n.usage.scope=ii[1]),ri&&(n.usage.area=ri[1]),ni&&(n.usage.bbox=ni.slice(1))}return n}}function detectWKT2Version(_t){return _t.find(e=>Array.isArray(e)&&e[0]==="USAGE")?"2019":(_t.find(e=>Array.isArray(e)&&e[0]==="CS")||_t[0]==="BOUNDCRS"||_t[0]==="PROJCRS"||_t[0]==="GEOGCRS","2015")}function buildPROJJSON(_t){return(detectWKT2Version(_t)==="2019"?PROJJSONBuilder2019:PROJJSONBuilder2015).convert(_t)}function detectWKTVersion(_t){const e=_t.toUpperCase();return e.includes("PROJCRS")||e.includes("GEOGCRS")||e.includes("BOUNDCRS")||e.includes("VERTCRS")||e.includes("LENGTHUNIT")||e.includes("ANGLEUNIT")||e.includes("SCALEUNIT")?"WKT2":(e.includes("PROJCS")||e.includes("GEOGCS")||e.includes("LOCAL_CS")||e.includes("VERT_CS")||e.includes("UNIT"),"WKT1")}var NEUTRAL=1,KEYWORD=2,NUMBER=3,QUOTED=4,AFTERQUOTE=5,ENDED=-1,whitespace=/\s/,latin=/[A-Za-z]/,keyword$1=/[A-Za-z84_]/,endThings=/[,\]]/,digets=/[\d\.E\-\+]/;function Parser(_t){if(typeof _t!="string")throw new Error("not a string");this.text=_t.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=NEUTRAL}Parser.prototype.readCharicter=function(){var _t=this.text[this.place++];if(this.state!==QUOTED)for(;whitespace.test(_t);){if(this.place>=this.text.length)return;_t=this.text[this.place++]}switch(this.state){case NEUTRAL:return this.neutral(_t);case KEYWORD:return this.keyword(_t);case QUOTED:return this.quoted(_t);case AFTERQUOTE:return this.afterquote(_t);case NUMBER:return this.number(_t);case ENDED:return}};Parser.prototype.afterquote=function(_t){if(_t==='"'){this.word+='"',this.state=QUOTED;return}if(endThings.test(_t)){this.word=this.word.trim(),this.afterItem(_t);return}throw new Error(`havn't handled "`+_t+'" in afterquote yet, index '+this.place)};Parser.prototype.afterItem=function(_t){if(_t===","){this.word!==null&&this.currentObject.push(this.word),this.word=null,this.state=NEUTRAL;return}if(_t==="]"){this.level--,this.word!==null&&(this.currentObject.push(this.word),this.word=null),this.state=NEUTRAL,this.currentObject=this.stack.pop(),this.currentObject||(this.state=ENDED);return}};Parser.prototype.number=function(_t){if(digets.test(_t)){this.word+=_t;return}if(endThings.test(_t)){this.word=parseFloat(this.word),this.afterItem(_t);return}throw new Error(`havn't handled "`+_t+'" in number yet, index '+this.place)};Parser.prototype.quoted=function(_t){if(_t==='"'){this.state=AFTERQUOTE;return}this.word+=_t};Parser.prototype.keyword=function(_t){if(keyword$1.test(_t)){this.word+=_t;return}if(_t==="["){var e=[];e.push(this.word),this.level++,this.root===null?this.root=e:this.currentObject.push(e),this.stack.push(this.currentObject),this.currentObject=e,this.state=NEUTRAL;return}if(endThings.test(_t)){this.afterItem(_t);return}throw new Error(`havn't handled "`+_t+'" in keyword yet, index '+this.place)};Parser.prototype.neutral=function(_t){if(latin.test(_t)){this.word=_t,this.state=KEYWORD;return}if(_t==='"'){this.word="",this.state=QUOTED;return}if(digets.test(_t)){this.word=_t,this.state=NUMBER;return}if(endThings.test(_t)){this.afterItem(_t);return}throw new Error(`havn't handled "`+_t+'" in neutral yet, index '+this.place)};Parser.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===ENDED)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function parseString(_t){var e=new Parser(_t);return e.output()}function mapit(_t,e,n){Array.isArray(e)&&(n.unshift(e),e=null);var ei=e?{}:_t,ti=n.reduce(function(ii,ri){return sExpr(ri,ii),ii},ei);e&&(_t[e]=ti)}function sExpr(_t,e){if(!Array.isArray(_t)){e[_t]=!0;return}var n=_t.shift();if(n==="PARAMETER"&&(n=_t.shift()),_t.length===1){if(Array.isArray(_t[0])){e[n]={},sExpr(_t[0],e[n]);return}e[n]=_t[0];return}if(!_t.length){e[n]=!0;return}if(n==="TOWGS84"){e[n]=_t;return}if(n==="AXIS"){n in e||(e[n]=[]),e[n].push(_t);return}Array.isArray(n)||(e[n]={});var ei;switch(n){case"UNIT":case"PRIMEM":case"VERT_DATUM":e[n]={name:_t[0].toLowerCase(),convert:_t[1]},_t.length===3&&sExpr(_t[2],e[n]);return;case"SPHEROID":case"ELLIPSOID":e[n]={name:_t[0],a:_t[1],rf:_t[2]},_t.length===4&&sExpr(_t[3],e[n]);return;case"EDATUM":case"ENGINEERINGDATUM":case"LOCAL_DATUM":case"DATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":_t[0]=["name",_t[0]],mapit(e,n,_t);return;case"COMPD_CS":case"COMPOUNDCRS":case"FITTED_CS":case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"ENGCRS":case"ENGINEERINGCRS":_t[0]=["name",_t[0]],mapit(e,n,_t),e[n].type=n;return;default:for(ei=-1;++ei<_t.length;)if(!Array.isArray(_t[ei]))return sExpr(_t,e[n]);return mapit(e,n,_t)}}var D2R=.017453292519943295;function d2r(_t){return _t*D2R}function applyProjectionDefaults(_t){const e=(_t.projName||"").toLowerCase().replace(/_/g," ");!_t.long0&&_t.longc&&(e==="albers conic equal area"||e==="lambert azimuthal equal area")&&(_t.long0=_t.longc),!_t.lat_ts&&_t.lat1&&(e==="stereographic south pole"||e==="polar stereographic (variant b)")?(_t.lat0=d2r(_t.lat1>0?90:-90),_t.lat_ts=_t.lat1,delete _t.lat1):!_t.lat_ts&&_t.lat0&&(e==="polar stereographic"||e==="polar stereographic (variant a)")&&(_t.lat_ts=_t.lat0,_t.lat0=d2r(_t.lat0>0?90:-90),delete _t.lat1)}function processUnit(_t){let e={units:null,to_meter:void 0};return typeof _t=="string"?(e.units=_t.toLowerCase(),e.units==="metre"&&(e.units="meter"),e.units==="meter"&&(e.to_meter=1)):_t&&_t.name&&(e.units=_t.name.toLowerCase(),e.units==="metre"&&(e.units="meter"),e.to_meter=_t.conversion_factor),e}function toValue(_t){return typeof _t=="object"?_t.value*_t.unit.conversion_factor:_t}function calculateEllipsoid(_t,e){_t.ellipsoid.radius?(e.a=_t.ellipsoid.radius,e.rf=0):(e.a=toValue(_t.ellipsoid.semi_major_axis),_t.ellipsoid.inverse_flattening!==void 0?e.rf=_t.ellipsoid.inverse_flattening:_t.ellipsoid.semi_major_axis!==void 0&&_t.ellipsoid.semi_minor_axis!==void 0&&(e.rf=e.a/(e.a-toValue(_t.ellipsoid.semi_minor_axis))))}function transformPROJJSON(_t,e={}){return!_t||typeof _t!="object"?_t:_t.type==="BoundCRS"?(transformPROJJSON(_t.source_crs,e),_t.transformation&&(_t.transformation.method&&_t.transformation.method.name==="NTv2"?e.nadgrids=_t.transformation.parameters[0].value:e.datum_params=_t.transformation.parameters.map(n=>n.value)),e):(Object.keys(_t).forEach(n=>{const ei=_t[n];if(ei!==null)switch(n){case"name":if(e.srsCode)break;e.name=ei,e.srsCode=ei;break;case"type":ei==="GeographicCRS"?e.projName="longlat":ei==="ProjectedCRS"&&_t.conversion&&_t.conversion.method&&(e.projName=_t.conversion.method.name);break;case"datum":case"datum_ensemble":ei.ellipsoid&&(e.ellps=ei.ellipsoid.name,calculateEllipsoid(ei,e)),ei.prime_meridian&&(e.from_greenwich=ei.prime_meridian.longitude*Math.PI/180);break;case"ellipsoid":e.ellps=ei.name,calculateEllipsoid(ei,e);break;case"prime_meridian":e.long0=(ei.longitude||0)*Math.PI/180;break;case"coordinate_system":if(ei.axis){if(e.axis=ei.axis.map(ti=>{const ii=ti.direction;if(ii==="east")return"e";if(ii==="north")return"n";if(ii==="west")return"w";if(ii==="south")return"s";throw new Error(`Unknown axis direction: ${ii}`)}).join("")+"u",ei.unit){const{units:ti,to_meter:ii}=processUnit(ei.unit);e.units=ti,e.to_meter=ii}else if(ei.axis[0]&&ei.axis[0].unit){const{units:ti,to_meter:ii}=processUnit(ei.axis[0].unit);e.units=ti,e.to_meter=ii}}break;case"id":ei.authority&&ei.code&&(e.title=ei.authority+":"+ei.code);break;case"conversion":ei.method&&ei.method.name&&(e.projName=ei.method.name),ei.parameters&&ei.parameters.forEach(ti=>{const ii=ti.name.toLowerCase().replace(/\s+/g,"_"),ri=ti.value;ti.unit&&ti.unit.conversion_factor?e[ii]=ri*ti.unit.conversion_factor:ti.unit==="degree"?e[ii]=ri*Math.PI/180:e[ii]=ri});break;case"unit":ei.name&&(e.units=ei.name.toLowerCase(),e.units==="metre"&&(e.units="meter")),ei.conversion_factor&&(e.to_meter=ei.conversion_factor);break;case"base_crs":transformPROJJSON(ei,e),e.datumCode=ei.id?ei.id.authority+"_"+ei.id.code:ei.name;break}}),e.latitude_of_false_origin!==void 0&&(e.lat0=e.latitude_of_false_origin),e.longitude_of_false_origin!==void 0&&(e.long0=e.longitude_of_false_origin),e.latitude_of_standard_parallel!==void 0&&(e.lat0=e.latitude_of_standard_parallel,e.lat1=e.latitude_of_standard_parallel),e.latitude_of_1st_standard_parallel!==void 0&&(e.lat1=e.latitude_of_1st_standard_parallel),e.latitude_of_2nd_standard_parallel!==void 0&&(e.lat2=e.latitude_of_2nd_standard_parallel),e.latitude_of_projection_centre!==void 0&&(e.lat0=e.latitude_of_projection_centre),e.longitude_of_projection_centre!==void 0&&(e.longc=e.longitude_of_projection_centre),e.easting_at_false_origin!==void 0&&(e.x0=e.easting_at_false_origin),e.northing_at_false_origin!==void 0&&(e.y0=e.northing_at_false_origin),e.latitude_of_natural_origin!==void 0&&(e.lat0=e.latitude_of_natural_origin),e.longitude_of_natural_origin!==void 0&&(e.long0=e.longitude_of_natural_origin),e.longitude_of_origin!==void 0&&(e.long0=e.longitude_of_origin),e.false_easting!==void 0&&(e.x0=e.false_easting),e.easting_at_projection_centre&&(e.x0=e.easting_at_projection_centre),e.false_northing!==void 0&&(e.y0=e.false_northing),e.northing_at_projection_centre&&(e.y0=e.northing_at_projection_centre),e.standard_parallel_1!==void 0&&(e.lat1=e.standard_parallel_1),e.standard_parallel_2!==void 0&&(e.lat2=e.standard_parallel_2),e.scale_factor_at_natural_origin!==void 0&&(e.k0=e.scale_factor_at_natural_origin),e.scale_factor_at_projection_centre!==void 0&&(e.k0=e.scale_factor_at_projection_centre),e.scale_factor_on_pseudo_standard_parallel!==void 0&&(e.k0=e.scale_factor_on_pseudo_standard_parallel),e.azimuth!==void 0&&(e.alpha=e.azimuth),e.azimuth_at_projection_centre!==void 0&&(e.alpha=e.azimuth_at_projection_centre),e.angle_from_rectified_to_skew_grid&&(e.rectified_grid_angle=e.angle_from_rectified_to_skew_grid),applyProjectionDefaults(e),e)}var knownTypes=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function rename(_t,e){var n=e[0],ei=e[1];!(n in _t)&&ei in _t&&(_t[n]=_t[ei],e.length===3&&(_t[n]=e[2](_t[n])))}function cleanWKT(_t){for(var e=Object.keys(_t),n=0,ei=e.length;n<ei;++n){var ti=e[n];knownTypes.indexOf(ti)!==-1&&setPropertiesFromWkt(_t[ti]),typeof _t[ti]=="object"&&cleanWKT(_t[ti])}}function setPropertiesFromWkt(_t){if(_t.AUTHORITY){var e=Object.keys(_t.AUTHORITY)[0];e&&e in _t.AUTHORITY&&(_t.title=e+":"+_t.AUTHORITY[e])}if(_t.type==="GEOGCS"?_t.projName="longlat":_t.type==="LOCAL_CS"?(_t.projName="identity",_t.local=!0):typeof _t.PROJECTION=="object"?_t.projName=Object.keys(_t.PROJECTION)[0]:_t.projName=_t.PROJECTION,_t.AXIS){for(var n="",ei=0,ti=_t.AXIS.length;ei<ti;++ei){var ii=[_t.AXIS[ei][0].toLowerCase(),_t.AXIS[ei][1].toLowerCase()];ii[0].indexOf("north")!==-1||(ii[0]==="y"||ii[0]==="lat")&&ii[1]==="north"?n+="n":ii[0].indexOf("south")!==-1||(ii[0]==="y"||ii[0]==="lat")&&ii[1]==="south"?n+="s":ii[0].indexOf("east")!==-1||(ii[0]==="x"||ii[0]==="lon")&&ii[1]==="east"?n+="e":(ii[0].indexOf("west")!==-1||(ii[0]==="x"||ii[0]==="lon")&&ii[1]==="west")&&(n+="w")}n.length===2&&(n+="u"),n.length===3&&(_t.axis=n)}_t.UNIT&&(_t.units=_t.UNIT.name.toLowerCase(),_t.units==="metre"&&(_t.units="meter"),_t.UNIT.convert&&(_t.type==="GEOGCS"?_t.DATUM&&_t.DATUM.SPHEROID&&(_t.to_meter=_t.UNIT.convert*_t.DATUM.SPHEROID.a):_t.to_meter=_t.UNIT.convert));var ri=_t.GEOGCS;_t.type==="GEOGCS"&&(ri=_t),ri&&(ri.DATUM?_t.datumCode=ri.DATUM.name.toLowerCase():_t.datumCode=ri.name.toLowerCase(),_t.datumCode.slice(0,2)==="d_"&&(_t.datumCode=_t.datumCode.slice(2)),_t.datumCode==="new_zealand_1949"&&(_t.datumCode="nzgd49"),(_t.datumCode==="wgs_1984"||_t.datumCode==="world_geodetic_system_1984")&&(_t.PROJECTION==="Mercator_Auxiliary_Sphere"&&(_t.sphere=!0),_t.datumCode="wgs84"),_t.datumCode==="belge_1972"&&(_t.datumCode="rnb72"),ri.DATUM&&ri.DATUM.SPHEROID&&(_t.ellps=ri.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),_t.ellps.toLowerCase().slice(0,13)==="international"&&(_t.ellps="intl"),_t.a=ri.DATUM.SPHEROID.a,_t.rf=parseFloat(ri.DATUM.SPHEROID.rf,10)),ri.DATUM&&ri.DATUM.TOWGS84&&(_t.datum_params=ri.DATUM.TOWGS84),~_t.datumCode.indexOf("osgb_1936")&&(_t.datumCode="osgb36"),~_t.datumCode.indexOf("osni_1952")&&(_t.datumCode="osni52"),(~_t.datumCode.indexOf("tm65")||~_t.datumCode.indexOf("geodetic_datum_of_1965"))&&(_t.datumCode="ire65"),_t.datumCode==="ch1903+"&&(_t.datumCode="ch1903"),~_t.datumCode.indexOf("israel")&&(_t.datumCode="isr93")),_t.b&&!isFinite(_t.b)&&(_t.b=_t.a),_t.rectified_grid_angle&&(_t.rectified_grid_angle=d2r(_t.rectified_grid_angle));function ni(oi){var li=_t.to_meter||1;return oi*li}var si=function(oi){return rename(_t,oi)},ai=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",d2r],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",d2r],["x0","false_easting",ni],["y0","false_northing",ni],["long0","central_meridian",d2r],["lat0","latitude_of_origin",d2r],["lat0","standard_parallel_1",d2r],["lat1","standard_parallel_1",d2r],["lat2","standard_parallel_2",d2r],["azimuth","Azimuth"],["alpha","azimuth",d2r],["srsCode","name"]];ai.forEach(si),applyProjectionDefaults(_t)}function wkt(_t){if(typeof _t=="object")return transformPROJJSON(_t);const e=detectWKTVersion(_t);var n=parseString(_t);if(e==="WKT2"){const ii=buildPROJJSON(n);return transformPROJJSON(ii)}var ei=n[0],ti={};return sExpr(n,ti),cleanWKT(ti),ti[ei]}function defs(_t){var e=this;if(arguments.length===2){var n=arguments[1];typeof n=="string"?n.charAt(0)==="+"?defs[_t]=projStr(arguments[1]):defs[_t]=wkt(arguments[1]):defs[_t]=n}else if(arguments.length===1){if(Array.isArray(_t))return _t.map(function(ei){Array.isArray(ei)?defs.apply(e,ei):defs(ei)});if(typeof _t=="string"){if(_t in defs)return defs[_t]}else"EPSG"in _t?defs["EPSG:"+_t.EPSG]=_t:"ESRI"in _t?defs["ESRI:"+_t.ESRI]=_t:"IAU2000"in _t?defs["IAU2000:"+_t.IAU2000]=_t:console.log(_t);return}}globals(defs);function testObj(_t){return typeof _t=="string"}function testDef(_t){return _t in defs}var codeWords=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function testWKT(_t){return codeWords.some(function(e){return _t.indexOf(e)>-1})}var codes=["3857","900913","3785","102113"];function checkMercator(_t){var e=match(_t,"authority");if(e){var n=match(e,"epsg");return n&&codes.indexOf(n)>-1}}function checkProjStr(_t){var e=match(_t,"extension");if(e)return match(e,"proj4")}function testProj(_t){return _t[0]==="+"}function parse(_t){if(testObj(_t)){if(testDef(_t))return defs[_t];if(testWKT(_t)){var e=wkt(_t);if(checkMercator(e))return defs["EPSG:3857"];var n=checkProjStr(e);return n?projStr(n):e}if(testProj(_t))return projStr(_t)}else return _t}function extend(_t,e){_t=_t||{};var n,ei;if(!e)return _t;for(ei in e)n=e[ei],n!==void 0&&(_t[ei]=n);return _t}function msfnz(_t,e,n){var ei=_t*e;return n/Math.sqrt(1-ei*ei)}function sign(_t){return _t<0?-1:1}function adjust_lon(_t){return Math.abs(_t)<=SPI?_t:_t-sign(_t)*TWO_PI}function tsfnz(_t,e,n){var ei=_t*n,ti=.5*_t;return ei=Math.pow((1-ei)/(1+ei),ti),Math.tan(.5*(HALF_PI-e))/ei}function phi2z(_t,e){for(var n=.5*_t,ei,ti,ii=HALF_PI-2*Math.atan(e),ri=0;ri<=15;ri++)if(ei=_t*Math.sin(ii),ti=HALF_PI-2*Math.atan(e*Math.pow((1-ei)/(1+ei),n))-ii,ii+=ti,Math.abs(ti)<=1e-10)return ii;return-9999}function init$x(){var _t=this.b/this.a;this.es=1-_t*_t,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=msfnz(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function forward$v(_t){var e=_t.x,n=_t.y;if(n*R2D>90&&n*R2D<-90&&e*R2D>180&&e*R2D<-180)return null;var ei,ti;if(Math.abs(Math.abs(n)-HALF_PI)<=EPSLN)return null;if(this.sphere)ei=this.x0+this.a*this.k0*adjust_lon(e-this.long0),ti=this.y0+this.a*this.k0*Math.log(Math.tan(FORTPI+.5*n));else{var ii=Math.sin(n),ri=tsfnz(this.e,n,ii);ei=this.x0+this.a*this.k0*adjust_lon(e-this.long0),ti=this.y0-this.a*this.k0*Math.log(ri)}return _t.x=ei,_t.y=ti,_t}function inverse$v(_t){var e=_t.x-this.x0,n=_t.y-this.y0,ei,ti;if(this.sphere)ti=HALF_PI-2*Math.atan(Math.exp(-n/(this.a*this.k0)));else{var ii=Math.exp(-n/(this.a*this.k0));if(ti=phi2z(this.e,ii),ti===-9999)return null}return ei=adjust_lon(this.long0+e/(this.a*this.k0)),_t.x=ei,_t.y=ti,_t}var names$y=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"];const merc={init:init$x,forward:forward$v,inverse:inverse$v,names:names$y};function init$w(){}function identity(_t){return _t}var names$x=["longlat","identity"];const longlat={init:init$w,forward:identity,inverse:identity,names:names$x};var projs=[merc,longlat],names$w={},projStore=[];function add(_t,e){var n=projStore.length;return _t.names?(projStore[n]=_t,_t.names.forEach(function(ei){names$w[ei.toLowerCase()]=n}),this):(console.log(e),!0)}function get(_t){if(!_t)return!1;var e=_t.toLowerCase();if(typeof names$w[e]<"u"&&projStore[names$w[e]])return projStore[names$w[e]]}function start(){projs.forEach(add)}const projections={start,add,get};var exports$1={};exports$1.MERIT={a:6378137,rf:298.257,ellipseName:"MERIT 1983"};exports$1.SGS85={a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"};exports$1.GRS80={a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"};exports$1.IAU76={a:6378140,rf:298.257,ellipseName:"IAU 1976"};exports$1.airy={a:6377563396e-3,b:635625691e-2,ellipseName:"Airy 1830"};exports$1.APL4={a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"};exports$1.NWL9D={a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"};exports$1.mod_airy={a:6377340189e-3,b:6356034446e-3,ellipseName:"Modified Airy"};exports$1.andrae={a:637710443e-2,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"};exports$1.aust_SA={a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"};exports$1.GRS67={a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"};exports$1.bessel={a:6377397155e-3,rf:299.1528128,ellipseName:"Bessel 1841"};exports$1.bess_nam={a:6377483865e-3,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"};exports$1.clrk66={a:63782064e-1,b:63565838e-1,ellipseName:"Clarke 1866"};exports$1.clrk80={a:6378249145e-3,rf:293.4663,ellipseName:"Clarke 1880 mod."};exports$1.clrk80ign={a:63782492e-1,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"};exports$1.clrk58={a:6378293645208759e-9,rf:294.2606763692654,ellipseName:"Clarke 1858"};exports$1.CPM={a:63757387e-1,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"};exports$1.delmbr={a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"};exports$1.engelis={a:637813605e-2,rf:298.2566,ellipseName:"Engelis 1985"};exports$1.evrst30={a:6377276345e-3,rf:300.8017,ellipseName:"Everest 1830"};exports$1.evrst48={a:6377304063e-3,rf:300.8017,ellipseName:"Everest 1948"};exports$1.evrst56={a:6377301243e-3,rf:300.8017,ellipseName:"Everest 1956"};exports$1.evrst69={a:6377295664e-3,rf:300.8017,ellipseName:"Everest 1969"};exports$1.evrstSS={a:6377298556e-3,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"};exports$1.fschr60={a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"};exports$1.fschr60m={a:6378155,rf:298.3,ellipseName:"Fischer 1960"};exports$1.fschr68={a:6378150,rf:298.3,ellipseName:"Fischer 1968"};exports$1.helmert={a:6378200,rf:298.3,ellipseName:"Helmert 1906"};exports$1.hough={a:6378270,rf:297,ellipseName:"Hough"};exports$1.intl={a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"};exports$1.kaula={a:6378163,rf:298.24,ellipseName:"Kaula 1961"};exports$1.lerch={a:6378139,rf:298.257,ellipseName:"Lerch 1979"};exports$1.mprts={a:6397300,rf:191,ellipseName:"Maupertius 1738"};exports$1.new_intl={a:63781575e-1,b:63567722e-1,ellipseName:"New International 1967"};exports$1.plessis={a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"};exports$1.krass={a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"};exports$1.SEasia={a:6378155,b:63567733205e-4,ellipseName:"Southeast Asia"};exports$1.walbeck={a:6376896,b:63558348467e-4,ellipseName:"Walbeck"};exports$1.WGS60={a:6378165,rf:298.3,ellipseName:"WGS 60"};exports$1.WGS66={a:6378145,rf:298.25,ellipseName:"WGS 66"};exports$1.WGS7={a:6378135,rf:298.26,ellipseName:"WGS 72"};var WGS84=exports$1.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};exports$1.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};function eccentricity(_t,e,n,ei){var ti=_t*_t,ii=e*e,ri=(ti-ii)/ti,ni=0;ei?(_t*=1-ri*(SIXTH+ri*(RA4+ri*RA6)),ti=_t*_t,ri=0):ni=Math.sqrt(ri);var si=(ti-ii)/ii;return{es:ri,e:ni,ep2:si}}function sphere(_t,e,n,ei,ti){if(!_t){var ii=match(exports$1,ei);ii||(ii=WGS84),_t=ii.a,e=ii.b,n=ii.rf}return n&&!e&&(e=(1-1/n)*_t),(n===0||Math.abs(_t-e)<EPSLN)&&(ti=!0,e=_t),{a:_t,b:e,rf:n,sphere:ti}}var datums={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},mgi:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Ordnance Survey of Great Britain 1936"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"}};for(var key in datums){var datum$1=datums[key];datums[datum$1.datumName]=datum$1}function datum(_t,e,n,ei,ti,ii,ri){var ni={};return _t===void 0||_t==="none"?ni.datum_type=PJD_NODATUM:ni.datum_type=PJD_WGS84,e&&(ni.datum_params=e.map(parseFloat),(ni.datum_params[0]!==0||ni.datum_params[1]!==0||ni.datum_params[2]!==0)&&(ni.datum_type=PJD_3PARAM),ni.datum_params.length>3&&(ni.datum_params[3]!==0||ni.datum_params[4]!==0||ni.datum_params[5]!==0||ni.datum_params[6]!==0)&&(ni.datum_type=PJD_7PARAM,ni.datum_params[3]*=SEC_TO_RAD,ni.datum_params[4]*=SEC_TO_RAD,ni.datum_params[5]*=SEC_TO_RAD,ni.datum_params[6]=ni.datum_params[6]/1e6+1)),ri&&(ni.datum_type=PJD_GRIDSHIFT,ni.grids=ri),ni.a=n,ni.b=ei,ni.es=ti,ni.ep2=ii,ni}var loadedNadgrids={};function nadgrid(_t,e){var n=new DataView(e),ei=detectLittleEndian(n),ti=readHeader(n,ei),ii=readSubgrids(n,ti,ei),ri={header:ti,subgrids:ii};return loadedNadgrids[_t]=ri,ri}function getNadgrids(_t){if(_t===void 0)return null;var e=_t.split(",");return e.map(parseNadgridString)}function parseNadgridString(_t){if(_t.length===0)return null;var e=_t[0]==="@";return e&&(_t=_t.slice(1)),_t==="null"?{name:"null",mandatory:!e,grid:null,isNull:!0}:{name:_t,mandatory:!e,grid:loadedNadgrids[_t]||null,isNull:!1}}function secondsToRadians(_t){return _t/3600*Math.PI/180}function detectLittleEndian(_t){var e=_t.getInt32(8,!1);return e===11?!1:(e=_t.getInt32(8,!0),e!==11&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}function readHeader(_t,e){return{nFields:_t.getInt32(8,e),nSubgridFields:_t.getInt32(24,e),nSubgrids:_t.getInt32(40,e),shiftType:decodeString(_t,56,64).trim(),fromSemiMajorAxis:_t.getFloat64(120,e),fromSemiMinorAxis:_t.getFloat64(136,e),toSemiMajorAxis:_t.getFloat64(152,e),toSemiMinorAxis:_t.getFloat64(168,e)}}function decodeString(_t,e,n){return String.fromCharCode.apply(null,new Uint8Array(_t.buffer.slice(e,n)))}function readSubgrids(_t,e,n){for(var ei=176,ti=[],ii=0;ii<e.nSubgrids;ii++){var ri=readGridHeader(_t,ei,n),ni=readGridNodes(_t,ei,ri,n),si=Math.round(1+(ri.upperLongitude-ri.lowerLongitude)/ri.longitudeInterval),ai=Math.round(1+(ri.upperLatitude-ri.lowerLatitude)/ri.latitudeInterval);ti.push({ll:[secondsToRadians(ri.lowerLongitude),secondsToRadians(ri.lowerLatitude)],del:[secondsToRadians(ri.longitudeInterval),secondsToRadians(ri.latitudeInterval)],lim:[si,ai],count:ri.gridNodeCount,cvs:mapNodes(ni)}),ei+=176+ri.gridNodeCount*16}return ti}function mapNodes(_t){return _t.map(function(e){return[secondsToRadians(e.longitudeShift),secondsToRadians(e.latitudeShift)]})}function readGridHeader(_t,e,n){return{name:decodeString(_t,e+8,e+16).trim(),parent:decodeString(_t,e+24,e+24+8).trim(),lowerLatitude:_t.getFloat64(e+72,n),upperLatitude:_t.getFloat64(e+88,n),lowerLongitude:_t.getFloat64(e+104,n),upperLongitude:_t.getFloat64(e+120,n),latitudeInterval:_t.getFloat64(e+136,n),longitudeInterval:_t.getFloat64(e+152,n),gridNodeCount:_t.getInt32(e+168,n)}}function readGridNodes(_t,e,n,ei){for(var ti=e+176,ii=16,ri=[],ni=0;ni<n.gridNodeCount;ni++){var si={latitudeShift:_t.getFloat32(ti+ni*ii,ei),longitudeShift:_t.getFloat32(ti+ni*ii+4,ei),latitudeAccuracy:_t.getFloat32(ti+ni*ii+8,ei),longitudeAccuracy:_t.getFloat32(ti+ni*ii+12,ei)};ri.push(si)}return ri}function Projection(_t,e){if(!(this instanceof Projection))return new Projection(_t);e=e||function(ai){if(ai)throw ai};var n=parse(_t);if(typeof n!="object"){e("Could not parse to valid json: "+_t);return}var ei=Projection.projections.get(n.projName);if(!ei){e("Could not get projection name from: "+_t);return}if(n.datumCode&&n.datumCode!=="none"){var ti=match(datums,n.datumCode);ti&&(n.datum_params=n.datum_params||(ti.towgs84?ti.towgs84.split(","):null),n.ellps=ti.ellipse,n.datumName=ti.datumName?ti.datumName:n.datumCode)}n.k0=n.k0||1,n.axis=n.axis||"enu",n.ellps=n.ellps||"wgs84",n.lat1=n.lat1||n.lat0;var ii=sphere(n.a,n.b,n.rf,n.ellps,n.sphere),ri=eccentricity(ii.a,ii.b,ii.rf,n.R_A),ni=getNadgrids(n.nadgrids),si=n.datum||datum(n.datumCode,n.datum_params,ii.a,ii.b,ri.es,ri.ep2,ni);extend(this,n),extend(this,ei),this.a=ii.a,this.b=ii.b,this.rf=ii.rf,this.sphere=ii.sphere,this.es=ri.es,this.e=ri.e,this.ep2=ri.ep2,this.datum=si,this.init(),e(null,this)}Projection.projections=projections;Projection.projections.start();function compareDatums(_t,e){return _t.datum_type!==e.datum_type||_t.a!==e.a||Math.abs(_t.es-e.es)>5e-11?!1:_t.datum_type===PJD_3PARAM?_t.datum_params[0]===e.datum_params[0]&&_t.datum_params[1]===e.datum_params[1]&&_t.datum_params[2]===e.datum_params[2]:_t.datum_type===PJD_7PARAM?_t.datum_params[0]===e.datum_params[0]&&_t.datum_params[1]===e.datum_params[1]&&_t.datum_params[2]===e.datum_params[2]&&_t.datum_params[3]===e.datum_params[3]&&_t.datum_params[4]===e.datum_params[4]&&_t.datum_params[5]===e.datum_params[5]&&_t.datum_params[6]===e.datum_params[6]:!0}function geodeticToGeocentric(_t,e,n){var ei=_t.x,ti=_t.y,ii=_t.z?_t.z:0,ri,ni,si,ai;if(ti<-HALF_PI&&ti>-1.001*HALF_PI)ti=-HALF_PI;else if(ti>HALF_PI&&ti<1.001*HALF_PI)ti=HALF_PI;else{if(ti<-HALF_PI)return{x:-1/0,y:-1/0,z:_t.z};if(ti>HALF_PI)return{x:1/0,y:1/0,z:_t.z}}return ei>Math.PI&&(ei-=2*Math.PI),ni=Math.sin(ti),ai=Math.cos(ti),si=ni*ni,ri=n/Math.sqrt(1-e*si),{x:(ri+ii)*ai*Math.cos(ei),y:(ri+ii)*ai*Math.sin(ei),z:(ri*(1-e)+ii)*ni}}function geocentricToGeodetic(_t,e,n,ei){var ti=1e-12,ii=ti*ti,ri=30,ni,si,ai,oi,li,ci,ui,di,fi,hi,pi,gi,vi,yi=_t.x,_i=_t.y,Ai=_t.z?_t.z:0,Ei,Si,wi;if(ni=Math.sqrt(yi*yi+_i*_i),si=Math.sqrt(yi*yi+_i*_i+Ai*Ai),ni/n<ti){if(Ei=0,si/n<ti)return Si=HALF_PI,wi=-ei,{x:_t.x,y:_t.y,z:_t.z}}else Ei=Math.atan2(_i,yi);ai=Ai/si,oi=ni/si,li=1/Math.sqrt(1-e*(2-e)*oi*oi),di=oi*(1-e)*li,fi=ai*li,vi=0;do vi++,ui=n/Math.sqrt(1-e*fi*fi),wi=ni*di+Ai*fi-ui*(1-e*fi*fi),ci=e*ui/(ui+wi),li=1/Math.sqrt(1-ci*(2-ci)*oi*oi),hi=oi*(1-ci)*li,pi=ai*li,gi=pi*di-hi*fi,di=hi,fi=pi;while(gi*gi>ii&&vi<ri);return Si=Math.atan(pi/Math.abs(hi)),{x:Ei,y:Si,z:wi}}function geocentricToWgs84(_t,e,n){if(e===PJD_3PARAM)return{x:_t.x+n[0],y:_t.y+n[1],z:_t.z+n[2]};if(e===PJD_7PARAM){var ei=n[0],ti=n[1],ii=n[2],ri=n[3],ni=n[4],si=n[5],ai=n[6];return{x:ai*(_t.x-si*_t.y+ni*_t.z)+ei,y:ai*(si*_t.x+_t.y-ri*_t.z)+ti,z:ai*(-ni*_t.x+ri*_t.y+_t.z)+ii}}}function geocentricFromWgs84(_t,e,n){if(e===PJD_3PARAM)return{x:_t.x-n[0],y:_t.y-n[1],z:_t.z-n[2]};if(e===PJD_7PARAM){var ei=n[0],ti=n[1],ii=n[2],ri=n[3],ni=n[4],si=n[5],ai=n[6],oi=(_t.x-ei)/ai,li=(_t.y-ti)/ai,ci=(_t.z-ii)/ai;return{x:oi+si*li-ni*ci,y:-si*oi+li+ri*ci,z:ni*oi-ri*li+ci}}}function checkParams(_t){return _t===PJD_3PARAM||_t===PJD_7PARAM}function datum_transform(_t,e,n){if(compareDatums(_t,e)||_t.datum_type===PJD_NODATUM||e.datum_type===PJD_NODATUM)return n;var ei=_t.a,ti=_t.es;if(_t.datum_type===PJD_GRIDSHIFT){var ii=applyGridShift(_t,!1,n);if(ii!==0)return;ei=SRS_WGS84_SEMIMAJOR,ti=SRS_WGS84_ESQUARED}var ri=e.a,ni=e.b,si=e.es;if(e.datum_type===PJD_GRIDSHIFT&&(ri=SRS_WGS84_SEMIMAJOR,ni=SRS_WGS84_SEMIMINOR,si=SRS_WGS84_ESQUARED),ti===si&&ei===ri&&!checkParams(_t.datum_type)&&!checkParams(e.datum_type))return n;if(n=geodeticToGeocentric(n,ti,ei),checkParams(_t.datum_type)&&(n=geocentricToWgs84(n,_t.datum_type,_t.datum_params)),checkParams(e.datum_type)&&(n=geocentricFromWgs84(n,e.datum_type,e.datum_params)),n=geocentricToGeodetic(n,si,ri,ni),e.datum_type===PJD_GRIDSHIFT){var ai=applyGridShift(e,!0,n);if(ai!==0)return}return n}function applyGridShift(_t,e,n){if(_t.grids===null||_t.grids.length===0)return console.log("Grid shift grids not found"),-1;var ei={x:-n.x,y:n.y},ti={x:Number.NaN,y:Number.NaN},ii=[];e:for(var ri=0;ri<_t.grids.length;ri++){var ni=_t.grids[ri];if(ii.push(ni.name),ni.isNull){ti=ei;break}if(ni.mandatory,ni.grid===null){if(ni.mandatory)return console.log("Unable to find mandatory grid '"+ni.name+"'"),-1;continue}for(var si=ni.grid.subgrids,ai=0,oi=si.length;ai<oi;ai++){var li=si[ai],ci=(Math.abs(li.del[1])+Math.abs(li.del[0]))/1e4,ui=li.ll[0]-ci,di=li.ll[1]-ci,fi=li.ll[0]+(li.lim[0]-1)*li.del[0]+ci,hi=li.ll[1]+(li.lim[1]-1)*li.del[1]+ci;if(!(di>ei.y||ui>ei.x||hi<ei.y||fi<ei.x)&&(ti=applySubgridShift(ei,e,li),!isNaN(ti.x)))break e}}return isNaN(ti.x)?(console.log("Failed to find a grid shift table for location '"+-ei.x*R2D+" "+ei.y*R2D+" tried: '"+ii+"'"),-1):(n.x=-ti.x,n.y=ti.y,0)}function applySubgridShift(_t,e,n){var ei={x:Number.NaN,y:Number.NaN};if(isNaN(_t.x))return ei;var ti={x:_t.x,y:_t.y};ti.x-=n.ll[0],ti.y-=n.ll[1],ti.x=adjust_lon(ti.x-Math.PI)+Math.PI;var ii=nadInterpolate(ti,n);if(e){if(isNaN(ii.x))return ei;ii.x=ti.x-ii.x,ii.y=ti.y-ii.y;var ri=9,ni=1e-12,si,ai;do{if(ai=nadInterpolate(ii,n),isNaN(ai.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}si={x:ti.x-(ai.x+ii.x),y:ti.y-(ai.y+ii.y)},ii.x+=si.x,ii.y+=si.y}while(ri--&&Math.abs(si.x)>ni&&Math.abs(si.y)>ni);if(ri<0)return console.log("Inverse grid shift iterator failed to converge."),ei;ei.x=adjust_lon(ii.x+n.ll[0]),ei.y=ii.y+n.ll[1]}else isNaN(ii.x)||(ei.x=_t.x+ii.x,ei.y=_t.y+ii.y);return ei}function nadInterpolate(_t,e){var n={x:_t.x/e.del[0],y:_t.y/e.del[1]},ei={x:Math.floor(n.x),y:Math.floor(n.y)},ti={x:n.x-1*ei.x,y:n.y-1*ei.y},ii={x:Number.NaN,y:Number.NaN},ri;if(ei.x<0||ei.x>=e.lim[0]||ei.y<0||ei.y>=e.lim[1])return ii;ri=ei.y*e.lim[0]+ei.x;var ni={x:e.cvs[ri][0],y:e.cvs[ri][1]};ri++;var si={x:e.cvs[ri][0],y:e.cvs[ri][1]};ri+=e.lim[0];var ai={x:e.cvs[ri][0],y:e.cvs[ri][1]};ri--;var oi={x:e.cvs[ri][0],y:e.cvs[ri][1]},li=ti.x*ti.y,ci=ti.x*(1-ti.y),ui=(1-ti.x)*(1-ti.y),di=(1-ti.x)*ti.y;return ii.x=ui*ni.x+ci*si.x+di*oi.x+li*ai.x,ii.y=ui*ni.y+ci*si.y+di*oi.y+li*ai.y,ii}function adjust_axis(_t,e,n){var ei=n.x,ti=n.y,ii=n.z||0,ri,ni,si,ai={};for(si=0;si<3;si++)if(!(e&&si===2&&n.z===void 0))switch(si===0?(ri=ei,"ew".indexOf(_t.axis[si])!==-1?ni="x":ni="y"):si===1?(ri=ti,"ns".indexOf(_t.axis[si])!==-1?ni="y":ni="x"):(ri=ii,ni="z"),_t.axis[si]){case"e":ai[ni]=ri;break;case"w":ai[ni]=-ri;break;case"n":ai[ni]=ri;break;case"s":ai[ni]=-ri;break;case"u":n[ni]!==void 0&&(ai.z=ri);break;case"d":n[ni]!==void 0&&(ai.z=-ri);break;default:return null}return ai}function common$1(_t){var e={x:_t[0],y:_t[1]};return _t.length>2&&(e.z=_t[2]),_t.length>3&&(e.m=_t[3]),e}function checkSanity(_t){checkCoord(_t.x),checkCoord(_t.y)}function checkCoord(_t){if(typeof Number.isFinite=="function"){if(Number.isFinite(_t))return;throw new TypeError("coordinates must be finite numbers")}if(typeof _t!="number"||_t!==_t||!isFinite(_t))throw new TypeError("coordinates must be finite numbers")}function checkNotWGS(_t,e){return(_t.datum.datum_type===PJD_3PARAM||_t.datum.datum_type===PJD_7PARAM||_t.datum.datum_type===PJD_GRIDSHIFT)&&e.datumCode!=="WGS84"||(e.datum.datum_type===PJD_3PARAM||e.datum.datum_type===PJD_7PARAM||e.datum.datum_type===PJD_GRIDSHIFT)&&_t.datumCode!=="WGS84"}function transform(_t,e,n,ei){var ti;Array.isArray(n)?n=common$1(n):n={x:n.x,y:n.y,z:n.z,m:n.m};var ii=n.z!==void 0;if(checkSanity(n),_t.datum&&e.datum&&checkNotWGS(_t,e)&&(ti=new Projection("WGS84"),n=transform(_t,ti,n,ei),_t=ti),ei&&_t.axis!=="enu"&&(n=adjust_axis(_t,!1,n)),_t.projName==="longlat")n={x:n.x*D2R$1,y:n.y*D2R$1,z:n.z||0};else if(_t.to_meter&&(n={x:n.x*_t.to_meter,y:n.y*_t.to_meter,z:n.z||0}),n=_t.inverse(n),!n)return;if(_t.from_greenwich&&(n.x+=_t.from_greenwich),n=datum_transform(_t.datum,e.datum,n),!!n)return e.from_greenwich&&(n={x:n.x-e.from_greenwich,y:n.y,z:n.z||0}),e.projName==="longlat"?n={x:n.x*R2D,y:n.y*R2D,z:n.z||0}:(n=e.forward(n),e.to_meter&&(n={x:n.x/e.to_meter,y:n.y/e.to_meter,z:n.z||0})),ei&&e.axis!=="enu"?adjust_axis(e,!0,n):(n&&!ii&&delete n.z,n)}var wgs84=Projection("WGS84");function transformer(_t,e,n,ei){var ti,ii,ri;return Array.isArray(n)?(ti=transform(_t,e,n,ei)||{x:NaN,y:NaN},n.length>2?typeof _t.name<"u"&&_t.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"?typeof ti.z=="number"?[ti.x,ti.y,ti.z].concat(n.slice(3)):[ti.x,ti.y,n[2]].concat(n.slice(3)):[ti.x,ti.y].concat(n.slice(2)):[ti.x,ti.y]):(ii=transform(_t,e,n,ei),ri=Object.keys(n),ri.length===2||ri.forEach(function(ni){if(typeof _t.name<"u"&&_t.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"){if(ni==="x"||ni==="y"||ni==="z")return}else if(ni==="x"||ni==="y")return;ii[ni]=n[ni]}),ii)}function checkProj(_t){return _t instanceof Projection?_t:_t.oProj?_t.oProj:Projection(_t)}function proj4(_t,e,n){_t=checkProj(_t);var ei=!1,ti;return typeof e>"u"?(e=_t,_t=wgs84,ei=!0):(typeof e.x<"u"||Array.isArray(e))&&(n=e,e=_t,_t=wgs84,ei=!0),e=checkProj(e),n?transformer(_t,e,n):(ti={forward:function(ii,ri){return transformer(_t,e,ii,ri)},inverse:function(ii,ri){return transformer(e,_t,ii,ri)}},ei&&(ti.oProj=e),ti)}var NUM_100K_SETS=6,SET_ORIGIN_COLUMN_LETTERS="AJSAJS",SET_ORIGIN_ROW_LETTERS="AFAFAF",A$1=65,I$3=73,O$1=79,V$2=86,Z$1=90;const mgrs={forward:forward$u,inverse:inverse$u,toPoint};function forward$u(_t,e){return e=e||5,encode$1(LLtoUTM({lat:_t[1],lon:_t[0]}),e)}function inverse$u(_t){var e=UTMtoLL(decode$1(_t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat,e.lon,e.lat]:[e.left,e.bottom,e.right,e.top]}function toPoint(_t){var e=UTMtoLL(decode$1(_t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}function degToRad(_t){return _t*(Math.PI/180)}function radToDeg(_t){return 180*(_t/Math.PI)}function LLtoUTM(_t){var e=_t.lat,n=_t.lon,ei=6378137,ti=.00669438,ii=.9996,ri,ni,si,ai,oi,li,ci,ui=degToRad(e),di=degToRad(n),fi,hi;hi=Math.floor((n+180)/6)+1,n===180&&(hi=60),e>=56&&e<64&&n>=3&&n<12&&(hi=32),e>=72&&e<84&&(n>=0&&n<9?hi=31:n>=9&&n<21?hi=33:n>=21&&n<33?hi=35:n>=33&&n<42&&(hi=37)),ri=(hi-1)*6-180+3,fi=degToRad(ri),ni=ti/(1-ti),si=ei/Math.sqrt(1-ti*Math.sin(ui)*Math.sin(ui)),ai=Math.tan(ui)*Math.tan(ui),oi=ni*Math.cos(ui)*Math.cos(ui),li=Math.cos(ui)*(di-fi),ci=ei*((1-ti/4-3*ti*ti/64-5*ti*ti*ti/256)*ui-(3*ti/8+3*ti*ti/32+45*ti*ti*ti/1024)*Math.sin(2*ui)+(15*ti*ti/256+45*ti*ti*ti/1024)*Math.sin(4*ui)-35*ti*ti*ti/3072*Math.sin(6*ui));var pi=ii*si*(li+(1-ai+oi)*li*li*li/6+(5-18*ai+ai*ai+72*oi-58*ni)*li*li*li*li*li/120)+5e5,gi=ii*(ci+si*Math.tan(ui)*(li*li/2+(5-ai+9*oi+4*oi*oi)*li*li*li*li/24+(61-58*ai+ai*ai+600*oi-330*ni)*li*li*li*li*li*li/720));return e<0&&(gi+=1e7),{northing:Math.round(gi),easting:Math.round(pi),zoneNumber:hi,zoneLetter:getLetterDesignator(e)}}function UTMtoLL(_t){var e=_t.northing,n=_t.easting,ei=_t.zoneLetter,ti=_t.zoneNumber;if(ti<0||ti>60)return null;var ii=.9996,ri=6378137,ni=.00669438,si,ai=(1-Math.sqrt(1-ni))/(1+Math.sqrt(1-ni)),oi,li,ci,ui,di,fi,hi,pi,gi,vi=n-5e5,yi=e;ei<"N"&&(yi-=1e7),hi=(ti-1)*6-180+3,si=ni/(1-ni),fi=yi/ii,pi=fi/(ri*(1-ni/4-3*ni*ni/64-5*ni*ni*ni/256)),gi=pi+(3*ai/2-27*ai*ai*ai/32)*Math.sin(2*pi)+(21*ai*ai/16-55*ai*ai*ai*ai/32)*Math.sin(4*pi)+151*ai*ai*ai/96*Math.sin(6*pi),oi=ri/Math.sqrt(1-ni*Math.sin(gi)*Math.sin(gi)),li=Math.tan(gi)*Math.tan(gi),ci=si*Math.cos(gi)*Math.cos(gi),ui=ri*(1-ni)/Math.pow(1-ni*Math.sin(gi)*Math.sin(gi),1.5),di=vi/(oi*ii);var _i=gi-oi*Math.tan(gi)/ui*(di*di/2-(5+3*li+10*ci-4*ci*ci-9*si)*di*di*di*di/24+(61+90*li+298*ci+45*li*li-252*si-3*ci*ci)*di*di*di*di*di*di/720);_i=radToDeg(_i);var Ai=(di-(1+2*li+ci)*di*di*di/6+(5-2*ci+28*li-3*ci*ci+8*si+24*li*li)*di*di*di*di*di/120)/Math.cos(gi);Ai=hi+radToDeg(Ai);var Ei;if(_t.accuracy){var Si=UTMtoLL({northing:_t.northing+_t.accuracy,easting:_t.easting+_t.accuracy,zoneLetter:_t.zoneLetter,zoneNumber:_t.zoneNumber});Ei={top:Si.lat,right:Si.lon,bottom:_i,left:Ai}}else Ei={lat:_i,lon:Ai};return Ei}function getLetterDesignator(_t){var e="Z";return 84>=_t&&_t>=72?e="X":72>_t&&_t>=64?e="W":64>_t&&_t>=56?e="V":56>_t&&_t>=48?e="U":48>_t&&_t>=40?e="T":40>_t&&_t>=32?e="S":32>_t&&_t>=24?e="R":24>_t&&_t>=16?e="Q":16>_t&&_t>=8?e="P":8>_t&&_t>=0?e="N":0>_t&&_t>=-8?e="M":-8>_t&&_t>=-16?e="L":-16>_t&&_t>=-24?e="K":-24>_t&&_t>=-32?e="J":-32>_t&&_t>=-40?e="H":-40>_t&&_t>=-48?e="G":-48>_t&&_t>=-56?e="F":-56>_t&&_t>=-64?e="E":-64>_t&&_t>=-72?e="D":-72>_t&&_t>=-80&&(e="C"),e}function encode$1(_t,e){var n="00000"+_t.easting,ei="00000"+_t.northing;return _t.zoneNumber+_t.zoneLetter+get100kID(_t.easting,_t.northing,_t.zoneNumber)+n.substr(n.length-5,e)+ei.substr(ei.length-5,e)}function get100kID(_t,e,n){var ei=get100kSetForZone(n),ti=Math.floor(_t/1e5),ii=Math.floor(e/1e5)%20;return getLetter100kID(ti,ii,ei)}function get100kSetForZone(_t){var e=_t%NUM_100K_SETS;return e===0&&(e=NUM_100K_SETS),e}function getLetter100kID(_t,e,n){var ei=n-1,ti=SET_ORIGIN_COLUMN_LETTERS.charCodeAt(ei),ii=SET_ORIGIN_ROW_LETTERS.charCodeAt(ei),ri=ti+_t-1,ni=ii+e,si=!1;ri>Z$1&&(ri=ri-Z$1+A$1-1,si=!0),(ri===I$3||ti<I$3&&ri>I$3||(ri>I$3||ti<I$3)&&si)&&ri++,(ri===O$1||ti<O$1&&ri>O$1||(ri>O$1||ti<O$1)&&si)&&(ri++,ri===I$3&&ri++),ri>Z$1&&(ri=ri-Z$1+A$1-1),ni>V$2?(ni=ni-V$2+A$1-1,si=!0):si=!1,(ni===I$3||ii<I$3&&ni>I$3||(ni>I$3||ii<I$3)&&si)&&ni++,(ni===O$1||ii<O$1&&ni>O$1||(ni>O$1||ii<O$1)&&si)&&(ni++,ni===I$3&&ni++),ni>V$2&&(ni=ni-V$2+A$1-1);var ai=String.fromCharCode(ri)+String.fromCharCode(ni);return ai}function decode$1(_t){if(_t&&_t.length===0)throw"MGRSPoint coverting from nothing";for(var e=_t.length,n=null,ei="",ti,ii=0;!/[A-Z]/.test(ti=_t.charAt(ii));){if(ii>=2)throw"MGRSPoint bad conversion from: "+_t;ei+=ti,ii++}var ri=parseInt(ei,10);if(ii===0||ii+3>e)throw"MGRSPoint bad conversion from: "+_t;var ni=_t.charAt(ii++);if(ni<="A"||ni==="B"||ni==="Y"||ni>="Z"||ni==="I"||ni==="O")throw"MGRSPoint zone letter "+ni+" not handled: "+_t;n=_t.substring(ii,ii+=2);for(var si=get100kSetForZone(ri),ai=getEastingFromChar(n.charAt(0),si),oi=getNorthingFromChar(n.charAt(1),si);oi<getMinNorthing(ni);)oi+=2e6;var li=e-ii;if(li%2!==0)throw`MGRSPoint has to have an even number 
of digits after the zone letter and two 100km letters - front 
half for easting meters, second half for 
northing meters`+_t;var ci=li/2,ui=0,di=0,fi,hi,pi,gi,vi;return ci>0&&(fi=1e5/Math.pow(10,ci),hi=_t.substring(ii,ii+ci),ui=parseFloat(hi)*fi,pi=_t.substring(ii+ci),di=parseFloat(pi)*fi),gi=ui+ai,vi=di+oi,{easting:gi,northing:vi,zoneLetter:ni,zoneNumber:ri,accuracy:fi}}function getEastingFromChar(_t,e){for(var n=SET_ORIGIN_COLUMN_LETTERS.charCodeAt(e-1),ei=1e5,ti=!1;n!==_t.charCodeAt(0);){if(n++,n===I$3&&n++,n===O$1&&n++,n>Z$1){if(ti)throw"Bad character: "+_t;n=A$1,ti=!0}ei+=1e5}return ei}function getNorthingFromChar(_t,e){if(_t>"V")throw"MGRSPoint given invalid Northing "+_t;for(var n=SET_ORIGIN_ROW_LETTERS.charCodeAt(e-1),ei=0,ti=!1;n!==_t.charCodeAt(0);){if(n++,n===I$3&&n++,n===O$1&&n++,n>V$2){if(ti)throw"Bad character: "+_t;n=A$1,ti=!0}ei+=1e5}return ei}function getMinNorthing(_t){var e;switch(_t){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+_t}function Point(_t,e,n){if(!(this instanceof Point))return new Point(_t,e,n);if(Array.isArray(_t))this.x=_t[0],this.y=_t[1],this.z=_t[2]||0;else if(typeof _t=="object")this.x=_t.x,this.y=_t.y,this.z=_t.z||0;else if(typeof _t=="string"&&typeof e>"u"){var ei=_t.split(",");this.x=parseFloat(ei[0],10),this.y=parseFloat(ei[1],10),this.z=parseFloat(ei[2],10)||0}else this.x=_t,this.y=e,this.z=n||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}Point.fromMGRS=function(_t){return new Point(toPoint(_t))};Point.prototype.toMGRS=function(_t){return forward$u([this.x,this.y],_t)};var C00=1,C02=.25,C04=.046875,C06=.01953125,C08=.01068115234375,C22=.75,C44=.46875,C46=.013020833333333334,C48=.007120768229166667,C66=.3645833333333333,C68=.005696614583333333,C88=.3076171875;function pj_enfn(_t){var e=[];e[0]=C00-_t*(C02+_t*(C04+_t*(C06+_t*C08))),e[1]=_t*(C22-_t*(C04+_t*(C06+_t*C08)));var n=_t*_t;return e[2]=n*(C44-_t*(C46+_t*C48)),n*=_t,e[3]=n*(C66-_t*C68),e[4]=n*_t*C88,e}function pj_mlfn(_t,e,n,ei){return n*=e,e*=e,ei[0]*_t-n*(ei[1]+e*(ei[2]+e*(ei[3]+e*ei[4])))}var MAX_ITER$3=20;function pj_inv_mlfn(_t,e,n){for(var ei=1/(1-e),ti=_t,ii=MAX_ITER$3;ii;--ii){var ri=Math.sin(ti),ni=1-e*ri*ri;if(ni=(pj_mlfn(ti,ri,Math.cos(ti),n)-_t)*(ni*Math.sqrt(ni))*ei,ti-=ni,Math.abs(ni)<EPSLN)return ti}return ti}function init$v(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.es&&(this.en=pj_enfn(this.es),this.ml0=pj_mlfn(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))}function forward$t(_t){var e=_t.x,n=_t.y,ei=adjust_lon(e-this.long0),ti,ii,ri,ni=Math.sin(n),si=Math.cos(n);if(this.es){var oi=si*ei,li=Math.pow(oi,2),ci=this.ep2*Math.pow(si,2),ui=Math.pow(ci,2),di=Math.abs(si)>EPSLN?Math.tan(n):0,fi=Math.pow(di,2),hi=Math.pow(fi,2);ti=1-this.es*Math.pow(ni,2),oi=oi/Math.sqrt(ti);var pi=pj_mlfn(n,ni,si,this.en);ii=this.a*(this.k0*oi*(1+li/6*(1-fi+ci+li/20*(5-18*fi+hi+14*ci-58*fi*ci+li/42*(61+179*hi-hi*fi-479*fi)))))+this.x0,ri=this.a*(this.k0*(pi-this.ml0+ni*ei*oi/2*(1+li/12*(5-fi+9*ci+4*ui+li/30*(61+hi-58*fi+270*ci-330*fi*ci+li/56*(1385+543*hi-hi*fi-3111*fi))))))+this.y0}else{var ai=si*Math.sin(ei);if(Math.abs(Math.abs(ai)-1)<EPSLN)return 93;if(ii=.5*this.a*this.k0*Math.log((1+ai)/(1-ai))+this.x0,ri=si*Math.cos(ei)/Math.sqrt(1-Math.pow(ai,2)),ai=Math.abs(ri),ai>=1){if(ai-1>EPSLN)return 93;ri=0}else ri=Math.acos(ri);n<0&&(ri=-ri),ri=this.a*this.k0*(ri-this.lat0)+this.y0}return _t.x=ii,_t.y=ri,_t}function inverse$t(_t){var e,n,ei,ti,ii=(_t.x-this.x0)*(1/this.a),ri=(_t.y-this.y0)*(1/this.a);if(this.es)if(e=this.ml0+ri/this.k0,n=pj_inv_mlfn(e,this.es,this.en),Math.abs(n)<HALF_PI){var li=Math.sin(n),ci=Math.cos(n),ui=Math.abs(ci)>EPSLN?Math.tan(n):0,di=this.ep2*Math.pow(ci,2),fi=Math.pow(di,2),hi=Math.pow(ui,2),pi=Math.pow(hi,2);e=1-this.es*Math.pow(li,2);var gi=ii*Math.sqrt(e)/this.k0,vi=Math.pow(gi,2);e=e*ui,ei=n-e*vi/(1-this.es)*.5*(1-vi/12*(5+3*hi-9*di*hi+di-4*fi-vi/30*(61+90*hi-252*di*hi+45*pi+46*di-vi/56*(1385+3633*hi+4095*pi+1574*pi*hi)))),ti=adjust_lon(this.long0+gi*(1-vi/6*(1+2*hi+di-vi/20*(5+28*hi+24*pi+8*di*hi+6*di-vi/42*(61+662*hi+1320*pi+720*pi*hi))))/ci)}else ei=HALF_PI*sign(ri),ti=0;else{var ni=Math.exp(ii/this.k0),si=.5*(ni-1/ni),ai=this.lat0+ri/this.k0,oi=Math.cos(ai);e=Math.sqrt((1-Math.pow(oi,2))/(1+Math.pow(si,2))),ei=Math.asin(e),ri<0&&(ei=-ei),si===0&&oi===0?ti=0:ti=adjust_lon(Math.atan2(si,oi)+this.long0)}return _t.x=ti,_t.y=ei,_t}var names$v=["Fast_Transverse_Mercator","Fast Transverse Mercator"];const tmerc={init:init$v,forward:forward$t,inverse:inverse$t,names:names$v};function sinh(_t){var e=Math.exp(_t);return e=(e-1/e)/2,e}function hypot(_t,e){_t=Math.abs(_t),e=Math.abs(e);var n=Math.max(_t,e),ei=Math.min(_t,e)/(n||1);return n*Math.sqrt(1+Math.pow(ei,2))}function log1py(_t){var e=1+_t,n=e-1;return n===0?_t:_t*Math.log(e)/n}function asinhy(_t){var e=Math.abs(_t);return e=log1py(e*(1+e/(hypot(1,e)+1))),_t<0?-e:e}function gatg(_t,e){for(var n=2*Math.cos(2*e),ei=_t.length-1,ti=_t[ei],ii=0,ri;--ei>=0;)ri=-ii+n*ti+_t[ei],ii=ti,ti=ri;return e+ri*Math.sin(2*e)}function clens(_t,e){for(var n=2*Math.cos(e),ei=_t.length-1,ti=_t[ei],ii=0,ri;--ei>=0;)ri=-ii+n*ti+_t[ei],ii=ti,ti=ri;return Math.sin(e)*ri}function cosh(_t){var e=Math.exp(_t);return e=(e+1/e)/2,e}function clens_cmplx(_t,e,n){for(var ei=Math.sin(e),ti=Math.cos(e),ii=sinh(n),ri=cosh(n),ni=2*ti*ri,si=-2*ei*ii,ai=_t.length-1,oi=_t[ai],li=0,ci=0,ui=0,di,fi;--ai>=0;)di=ci,fi=li,ci=oi,li=ui,oi=-di+ni*ci-si*li+_t[ai],ui=-fi+si*ci+ni*li;return ni=ei*ri,si=ti*ii,[ni*oi-si*ui,ni*ui+si*oi]}function init$u(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(tmerc.init.apply(this),this.forward=tmerc.forward,this.inverse=tmerc.inverse),this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var _t=this.es/(1+Math.sqrt(1-this.es)),e=_t/(2-_t),n=e;this.cgb[0]=e*(2+e*(-2/3+e*(-2+e*(116/45+e*(26/45+e*(-2854/675)))))),this.cbg[0]=e*(-2+e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725)))))),n=n*e,this.cgb[1]=n*(7/3+e*(-8/5+e*(-227/45+e*(2704/315+e*(2323/945))))),this.cbg[1]=n*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945))))),n=n*e,this.cgb[2]=n*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835)))),this.cbg[2]=n*(-26/15+e*(34/21+e*(8/5+e*(-12686/2835)))),n=n*e,this.cgb[3]=n*(4279/630+e*(-332/35+e*(-399572/14175))),this.cbg[3]=n*(1237/630+e*(-12/5+e*(-24832/14175))),n=n*e,this.cgb[4]=n*(4174/315+e*(-144838/6237)),this.cbg[4]=n*(-734/315+e*(109598/31185)),n=n*e,this.cgb[5]=n*(601676/22275),this.cbg[5]=n*(444337/155925),n=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+n*(1/4+n*(1/64+n/256))),this.utg[0]=e*(-.5+e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800)))))),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800)))))),this.utg[1]=n*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720))))),this.gtu[1]=n*(13/48+e*(-3/5+e*(557/1440+e*(281/630+e*(-1983433/1935360))))),n=n*e,this.utg[2]=n*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720)))),this.gtu[2]=n*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440)))),n=n*e,this.utg[3]=n*(-4397/161280+e*(11/504+e*(830251/7257600))),this.gtu[3]=n*(49561/161280+e*(-179/168+e*(6601661/7257600))),n=n*e,this.utg[4]=n*(-4583/161280+e*(108847/3991680)),this.gtu[4]=n*(34729/80640+e*(-3418889/1995840)),n=n*e,this.utg[5]=n*(-20648693/638668800),this.gtu[5]=n*(212378941/319334400);var ei=gatg(this.cbg,this.lat0);this.Zb=-this.Qn*(ei+clens(this.gtu,2*ei))}function forward$s(_t){var e=adjust_lon(_t.x-this.long0),n=_t.y;n=gatg(this.cbg,n);var ei=Math.sin(n),ti=Math.cos(n),ii=Math.sin(e),ri=Math.cos(e);n=Math.atan2(ei,ri*ti),e=Math.atan2(ii*ti,hypot(ei,ti*ri)),e=asinhy(Math.tan(e));var ni=clens_cmplx(this.gtu,2*n,2*e);n=n+ni[0],e=e+ni[1];var si,ai;return Math.abs(e)<=2.623395162778?(si=this.a*(this.Qn*e)+this.x0,ai=this.a*(this.Qn*n+this.Zb)+this.y0):(si=1/0,ai=1/0),_t.x=si,_t.y=ai,_t}function inverse$s(_t){var e=(_t.x-this.x0)*(1/this.a),n=(_t.y-this.y0)*(1/this.a);n=(n-this.Zb)/this.Qn,e=e/this.Qn;var ei,ti;if(Math.abs(e)<=2.623395162778){var ii=clens_cmplx(this.utg,2*n,2*e);n=n+ii[0],e=e+ii[1],e=Math.atan(sinh(e));var ri=Math.sin(n),ni=Math.cos(n),si=Math.sin(e),ai=Math.cos(e);n=Math.atan2(ri*ai,hypot(si,ai*ni)),e=Math.atan2(si,ai*ni),ei=adjust_lon(e+this.long0),ti=gatg(this.cgb,n)}else ei=1/0,ti=1/0;return _t.x=ei,_t.y=ti,_t}var names$u=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"];const etmerc={init:init$u,forward:forward$s,inverse:inverse$s,names:names$u};function adjust_zone(_t,e){if(_t===void 0){if(_t=Math.floor((adjust_lon(e)+Math.PI)*30/Math.PI)+1,_t<0)return 0;if(_t>60)return 60}return _t}var dependsOn="etmerc";function init$t(){var _t=adjust_zone(this.zone,this.long0);if(_t===void 0)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(_t)-183)*D2R$1,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,etmerc.init.apply(this),this.forward=etmerc.forward,this.inverse=etmerc.inverse}var names$t=["Universal Transverse Mercator System","utm"];const utm={init:init$t,names:names$t,dependsOn};function srat(_t,e){return Math.pow((1-_t)/(1+_t),e)}var MAX_ITER$2=20;function init$s(){var _t=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*_t*_t),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(_t/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+FORTPI)/(Math.pow(Math.tan(.5*this.lat0+FORTPI),this.C)*srat(this.e*_t,this.ratexp))}function forward$r(_t){var e=_t.x,n=_t.y;return _t.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*n+FORTPI),this.C)*srat(this.e*Math.sin(n),this.ratexp))-HALF_PI,_t.x=this.C*e,_t}function inverse$r(_t){for(var e=1e-14,n=_t.x/this.C,ei=_t.y,ti=Math.pow(Math.tan(.5*ei+FORTPI)/this.K,1/this.C),ii=MAX_ITER$2;ii>0&&(ei=2*Math.atan(ti*srat(this.e*Math.sin(_t.y),-.5*this.e))-HALF_PI,!(Math.abs(ei-_t.y)<e));--ii)_t.y=ei;return ii?(_t.x=n,_t.y=ei,_t):null}const gauss={init:init$s,forward:forward$r,inverse:inverse$r};function init$r(){gauss.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))}function forward$q(_t){var e,n,ei,ti;return _t.x=adjust_lon(_t.x-this.long0),gauss.forward.apply(this,[_t]),e=Math.sin(_t.y),n=Math.cos(_t.y),ei=Math.cos(_t.x),ti=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*n*ei),_t.x=ti*n*Math.sin(_t.x),_t.y=ti*(this.cosc0*e-this.sinc0*n*ei),_t.x=this.a*_t.x+this.x0,_t.y=this.a*_t.y+this.y0,_t}function inverse$q(_t){var e,n,ei,ti,ii;if(_t.x=(_t.x-this.x0)/this.a,_t.y=(_t.y-this.y0)/this.a,_t.x/=this.k0,_t.y/=this.k0,ii=hypot(_t.x,_t.y)){var ri=2*Math.atan2(ii,this.R2);e=Math.sin(ri),n=Math.cos(ri),ti=Math.asin(n*this.sinc0+_t.y*e*this.cosc0/ii),ei=Math.atan2(_t.x*e,ii*this.cosc0*n-_t.y*this.sinc0*e)}else ti=this.phic0,ei=0;return _t.x=ei,_t.y=ti,gauss.inverse.apply(this,[_t]),_t.x=adjust_lon(_t.x+this.long0),_t}var names$s=["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"];const sterea={init:init$r,forward:forward$q,inverse:inverse$q,names:names$s};function ssfn_(_t,e,n){return e*=n,Math.tan(.5*(HALF_PI+_t))*Math.pow((1-e)/(1+e),.5*n)}function init$q(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=EPSLN&&(this.k0=.5*(1+sign(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=EPSLN&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=EPSLN&&Math.abs(Math.cos(this.lat_ts))>EPSLN&&(this.k0=.5*this.cons*msfnz(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/tsfnz(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=msfnz(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-HALF_PI,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function forward$p(_t){var e=_t.x,n=_t.y,ei=Math.sin(n),ti=Math.cos(n),ii,ri,ni,si,ai,oi,li=adjust_lon(e-this.long0);return Math.abs(Math.abs(e-this.long0)-Math.PI)<=EPSLN&&Math.abs(n+this.lat0)<=EPSLN?(_t.x=NaN,_t.y=NaN,_t):this.sphere?(ii=2*this.k0/(1+this.sinlat0*ei+this.coslat0*ti*Math.cos(li)),_t.x=this.a*ii*ti*Math.sin(li)+this.x0,_t.y=this.a*ii*(this.coslat0*ei-this.sinlat0*ti*Math.cos(li))+this.y0,_t):(ri=2*Math.atan(this.ssfn_(n,ei,this.e))-HALF_PI,si=Math.cos(ri),ni=Math.sin(ri),Math.abs(this.coslat0)<=EPSLN?(ai=tsfnz(this.e,n*this.con,this.con*ei),oi=2*this.a*this.k0*ai/this.cons,_t.x=this.x0+oi*Math.sin(e-this.long0),_t.y=this.y0-this.con*oi*Math.cos(e-this.long0),_t):(Math.abs(this.sinlat0)<EPSLN?(ii=2*this.a*this.k0/(1+si*Math.cos(li)),_t.y=ii*ni):(ii=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*ni+this.cosX0*si*Math.cos(li))),_t.y=ii*(this.cosX0*ni-this.sinX0*si*Math.cos(li))+this.y0),_t.x=ii*si*Math.sin(li)+this.x0,_t))}function inverse$p(_t){_t.x-=this.x0,_t.y-=this.y0;var e,n,ei,ti,ii,ri=Math.sqrt(_t.x*_t.x+_t.y*_t.y);if(this.sphere){var ni=2*Math.atan(ri/(2*this.a*this.k0));return e=this.long0,n=this.lat0,ri<=EPSLN?(_t.x=e,_t.y=n,_t):(n=Math.asin(Math.cos(ni)*this.sinlat0+_t.y*Math.sin(ni)*this.coslat0/ri),Math.abs(this.coslat0)<EPSLN?this.lat0>0?e=adjust_lon(this.long0+Math.atan2(_t.x,-1*_t.y)):e=adjust_lon(this.long0+Math.atan2(_t.x,_t.y)):e=adjust_lon(this.long0+Math.atan2(_t.x*Math.sin(ni),ri*this.coslat0*Math.cos(ni)-_t.y*this.sinlat0*Math.sin(ni))),_t.x=e,_t.y=n,_t)}else if(Math.abs(this.coslat0)<=EPSLN){if(ri<=EPSLN)return n=this.lat0,e=this.long0,_t.x=e,_t.y=n,_t;_t.x*=this.con,_t.y*=this.con,ei=ri*this.cons/(2*this.a*this.k0),n=this.con*phi2z(this.e,ei),e=this.con*adjust_lon(this.con*this.long0+Math.atan2(_t.x,-1*_t.y))}else ti=2*Math.atan(ri*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,ri<=EPSLN?ii=this.X0:(ii=Math.asin(Math.cos(ti)*this.sinX0+_t.y*Math.sin(ti)*this.cosX0/ri),e=adjust_lon(this.long0+Math.atan2(_t.x*Math.sin(ti),ri*this.cosX0*Math.cos(ti)-_t.y*this.sinX0*Math.sin(ti)))),n=-1*phi2z(this.e,Math.tan(.5*(HALF_PI+ii)));return _t.x=e,_t.y=n,_t}var names$r=["stere","Stereographic_South_Pole","Polar Stereographic (variant B)","Polar_Stereographic"];const stere={init:init$q,forward:forward$p,inverse:inverse$p,names:names$r,ssfn_};function init$p(){var _t=this.lat0;this.lambda0=this.long0;var e=Math.sin(_t),n=this.a,ei=this.rf,ti=1/ei,ii=2*ti-Math.pow(ti,2),ri=this.e=Math.sqrt(ii);this.R=this.k0*n*Math.sqrt(1-ii)/(1-ii*Math.pow(e,2)),this.alpha=Math.sqrt(1+ii/(1-ii)*Math.pow(Math.cos(_t),4)),this.b0=Math.asin(e/this.alpha);var ni=Math.log(Math.tan(Math.PI/4+this.b0/2)),si=Math.log(Math.tan(Math.PI/4+_t/2)),ai=Math.log((1+ri*e)/(1-ri*e));this.K=ni-this.alpha*si+this.alpha*ri/2*ai}function forward$o(_t){var e=Math.log(Math.tan(Math.PI/4-_t.y/2)),n=this.e/2*Math.log((1+this.e*Math.sin(_t.y))/(1-this.e*Math.sin(_t.y))),ei=-this.alpha*(e+n)+this.K,ti=2*(Math.atan(Math.exp(ei))-Math.PI/4),ii=this.alpha*(_t.x-this.lambda0),ri=Math.atan(Math.sin(ii)/(Math.sin(this.b0)*Math.tan(ti)+Math.cos(this.b0)*Math.cos(ii))),ni=Math.asin(Math.cos(this.b0)*Math.sin(ti)-Math.sin(this.b0)*Math.cos(ti)*Math.cos(ii));return _t.y=this.R/2*Math.log((1+Math.sin(ni))/(1-Math.sin(ni)))+this.y0,_t.x=this.R*ri+this.x0,_t}function inverse$o(_t){for(var e=_t.x-this.x0,n=_t.y-this.y0,ei=e/this.R,ti=2*(Math.atan(Math.exp(n/this.R))-Math.PI/4),ii=Math.asin(Math.cos(this.b0)*Math.sin(ti)+Math.sin(this.b0)*Math.cos(ti)*Math.cos(ei)),ri=Math.atan(Math.sin(ei)/(Math.cos(this.b0)*Math.cos(ei)-Math.sin(this.b0)*Math.tan(ti))),ni=this.lambda0+ri/this.alpha,si=0,ai=ii,oi=-1e3,li=0;Math.abs(ai-oi)>1e-7;){if(++li>20)return;si=1/this.alpha*(Math.log(Math.tan(Math.PI/4+ii/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(ai))/2)),oi=ai,ai=2*Math.atan(Math.exp(si))-Math.PI/2}return _t.x=ni,_t.y=ai,_t}var names$q=["somerc"];const somerc={init:init$p,forward:forward$o,inverse:inverse$o,names:names$q};var TOL=1e-7;function isTypeA(_t){var e=["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"],n=typeof _t.PROJECTION=="object"?Object.keys(_t.PROJECTION)[0]:_t.PROJECTION;return"no_uoff"in _t||"no_off"in _t||e.indexOf(n)!==-1}function init$o(){var _t,e,n,ei,ti,ii,ri,ni,si,ai,oi=0,li,ci=0,ui=0,di=0,fi=0,hi=0,pi=0;this.no_off=isTypeA(this),this.no_rot="no_rot"in this;var gi=!1;"alpha"in this&&(gi=!0);var vi=!1;if("rectified_grid_angle"in this&&(vi=!0),gi&&(pi=this.alpha),vi&&(oi=this.rectified_grid_angle*D2R$1),gi||vi)ci=this.longc;else if(ui=this.long1,fi=this.lat1,di=this.long2,hi=this.lat2,Math.abs(fi-hi)<=TOL||(_t=Math.abs(fi))<=TOL||Math.abs(_t-HALF_PI)<=TOL||Math.abs(Math.abs(this.lat0)-HALF_PI)<=TOL||Math.abs(Math.abs(hi)-HALF_PI)<=TOL)throw new Error;var yi=1-this.es;e=Math.sqrt(yi),Math.abs(this.lat0)>EPSLN?(ni=Math.sin(this.lat0),n=Math.cos(this.lat0),_t=1-this.es*ni*ni,this.B=n*n,this.B=Math.sqrt(1+this.es*this.B*this.B/yi),this.A=this.B*this.k0*e/_t,ei=this.B*e/(n*Math.sqrt(_t)),ti=ei*ei-1,ti<=0?ti=0:(ti=Math.sqrt(ti),this.lat0<0&&(ti=-ti)),this.E=ti+=ei,this.E*=Math.pow(tsfnz(this.e,this.lat0,ni),this.B)):(this.B=1/e,this.A=this.k0,this.E=ei=ti=1),gi||vi?(gi?(li=Math.asin(Math.sin(pi)/ei),vi||(oi=pi)):(li=oi,pi=Math.asin(ei*Math.sin(li))),this.lam0=ci-Math.asin(.5*(ti-1/ti)*Math.tan(li))/this.B):(ii=Math.pow(tsfnz(this.e,fi,Math.sin(fi)),this.B),ri=Math.pow(tsfnz(this.e,hi,Math.sin(hi)),this.B),ti=this.E/ii,si=(ri-ii)/(ri+ii),ai=this.E*this.E,ai=(ai-ri*ii)/(ai+ri*ii),_t=ui-di,_t<-Math.pi?di-=TWO_PI:_t>Math.pi&&(di+=TWO_PI),this.lam0=adjust_lon(.5*(ui+di)-Math.atan(ai*Math.tan(.5*this.B*(ui-di))/si)/this.B),li=Math.atan(2*Math.sin(this.B*adjust_lon(ui-this.lam0))/(ti-1/ti)),oi=pi=Math.asin(ei*Math.sin(li))),this.singam=Math.sin(li),this.cosgam=Math.cos(li),this.sinrot=Math.sin(oi),this.cosrot=Math.cos(oi),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.A*this.B,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(ei*ei-1)/Math.cos(pi))),this.lat0<0&&(this.u_0=-this.u_0)),ti=.5*li,this.v_pole_n=this.ArB*Math.log(Math.tan(FORTPI-ti)),this.v_pole_s=this.ArB*Math.log(Math.tan(FORTPI+ti))}function forward$n(_t){var e={},n,ei,ti,ii,ri,ni,si,ai;if(_t.x=_t.x-this.lam0,Math.abs(Math.abs(_t.y)-HALF_PI)>EPSLN){if(ri=this.E/Math.pow(tsfnz(this.e,_t.y,Math.sin(_t.y)),this.B),ni=1/ri,n=.5*(ri-ni),ei=.5*(ri+ni),ii=Math.sin(this.B*_t.x),ti=(n*this.singam-ii*this.cosgam)/ei,Math.abs(Math.abs(ti)-1)<EPSLN)throw new Error;ai=.5*this.ArB*Math.log((1-ti)/(1+ti)),ni=Math.cos(this.B*_t.x),Math.abs(ni)<TOL?si=this.A*_t.x:si=this.ArB*Math.atan2(n*this.cosgam+ii*this.singam,ni)}else ai=_t.y>0?this.v_pole_n:this.v_pole_s,si=this.ArB*_t.y;return this.no_rot?(e.x=si,e.y=ai):(si-=this.u_0,e.x=ai*this.cosrot+si*this.sinrot,e.y=si*this.cosrot-ai*this.sinrot),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e}function inverse$n(_t){var e,n,ei,ti,ii,ri,ni,si={};if(_t.x=(_t.x-this.x0)*(1/this.a),_t.y=(_t.y-this.y0)*(1/this.a),this.no_rot?(n=_t.y,e=_t.x):(n=_t.x*this.cosrot-_t.y*this.sinrot,e=_t.y*this.cosrot+_t.x*this.sinrot+this.u_0),ei=Math.exp(-this.BrA*n),ti=.5*(ei-1/ei),ii=.5*(ei+1/ei),ri=Math.sin(this.BrA*e),ni=(ri*this.cosgam+ti*this.singam)/ii,Math.abs(Math.abs(ni)-1)<EPSLN)si.x=0,si.y=ni<0?-HALF_PI:HALF_PI;else{if(si.y=this.E/Math.sqrt((1+ni)/(1-ni)),si.y=phi2z(this.e,Math.pow(si.y,1/this.B)),si.y===1/0)throw new Error;si.x=-this.rB*Math.atan2(ti*this.cosgam-ri*this.singam,Math.cos(this.BrA*e))}return si.x+=this.lam0,si}var names$p=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"];const omerc={init:init$o,forward:forward$n,inverse:inverse$n,names:names$p};function init$n(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<EPSLN)){var _t=this.b/this.a;this.e=Math.sqrt(1-_t*_t);var e=Math.sin(this.lat1),n=Math.cos(this.lat1),ei=msfnz(this.e,e,n),ti=tsfnz(this.e,this.lat1,e),ii=Math.sin(this.lat2),ri=Math.cos(this.lat2),ni=msfnz(this.e,ii,ri),si=tsfnz(this.e,this.lat2,ii),ai=tsfnz(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>EPSLN?this.ns=Math.log(ei/ni)/Math.log(ti/si):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=ei/(this.ns*Math.pow(ti,this.ns)),this.rh=this.a*this.f0*Math.pow(ai,this.ns),this.title||(this.title="Lambert Conformal Conic")}}function forward$m(_t){var e=_t.x,n=_t.y;Math.abs(2*Math.abs(n)-Math.PI)<=EPSLN&&(n=sign(n)*(HALF_PI-2*EPSLN));var ei=Math.abs(Math.abs(n)-HALF_PI),ti,ii;if(ei>EPSLN)ti=tsfnz(this.e,n,Math.sin(n)),ii=this.a*this.f0*Math.pow(ti,this.ns);else{if(ei=n*this.ns,ei<=0)return null;ii=0}var ri=this.ns*adjust_lon(e-this.long0);return _t.x=this.k0*(ii*Math.sin(ri))+this.x0,_t.y=this.k0*(this.rh-ii*Math.cos(ri))+this.y0,_t}function inverse$m(_t){var e,n,ei,ti,ii,ri=(_t.x-this.x0)/this.k0,ni=this.rh-(_t.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(ri*ri+ni*ni),n=1):(e=-Math.sqrt(ri*ri+ni*ni),n=-1);var si=0;if(e!==0&&(si=Math.atan2(n*ri,n*ni)),e!==0||this.ns>0){if(n=1/this.ns,ei=Math.pow(e/(this.a*this.f0),n),ti=phi2z(this.e,ei),ti===-9999)return null}else ti=-HALF_PI;return ii=adjust_lon(si/this.ns+this.long0),_t.x=ii,_t.y=ti,_t}var names$o=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"];const lcc={init:init$n,forward:forward$m,inverse:inverse$m,names:names$o};function init$m(){this.a=6377397155e-3,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.7417649320975901-.308341501185665),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq}function forward$l(_t){var e,n,ei,ti,ii,ri,ni,si=_t.x,ai=_t.y,oi=adjust_lon(si-this.long0);return e=Math.pow((1+this.e*Math.sin(ai))/(1-this.e*Math.sin(ai)),this.alfa*this.e/2),n=2*(Math.atan(this.k*Math.pow(Math.tan(ai/2+this.s45),this.alfa)/e)-this.s45),ei=-oi*this.alfa,ti=Math.asin(Math.cos(this.ad)*Math.sin(n)+Math.sin(this.ad)*Math.cos(n)*Math.cos(ei)),ii=Math.asin(Math.cos(n)*Math.sin(ei)/Math.cos(ti)),ri=this.n*ii,ni=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(ti/2+this.s45),this.n),_t.y=ni*Math.cos(ri)/1,_t.x=ni*Math.sin(ri)/1,this.czech||(_t.y*=-1,_t.x*=-1),_t}function inverse$l(_t){var e,n,ei,ti,ii,ri,ni,si,ai=_t.x;_t.x=_t.y,_t.y=ai,this.czech||(_t.y*=-1,_t.x*=-1),ri=Math.sqrt(_t.x*_t.x+_t.y*_t.y),ii=Math.atan2(_t.y,_t.x),ti=ii/Math.sin(this.s0),ei=2*(Math.atan(Math.pow(this.ro0/ri,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(ei)-Math.sin(this.ad)*Math.cos(ei)*Math.cos(ti)),n=Math.asin(Math.cos(ei)*Math.sin(ti)/Math.cos(e)),_t.x=this.long0-n/this.alfa,ni=e,si=0;var oi=0;do _t.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(ni))/(1-this.e*Math.sin(ni)),this.e/2))-this.s45),Math.abs(ni-_t.y)<1e-10&&(si=1),ni=_t.y,oi+=1;while(si===0&&oi<15);return oi>=15?null:_t}var names$n=["Krovak","krovak"];const krovak={init:init$m,forward:forward$l,inverse:inverse$l,names:names$n};function mlfn(_t,e,n,ei,ti){return _t*ti-e*Math.sin(2*ti)+n*Math.sin(4*ti)-ei*Math.sin(6*ti)}function e0fn(_t){return 1-.25*_t*(1+_t/16*(3+1.25*_t))}function e1fn(_t){return .375*_t*(1+.25*_t*(1+.46875*_t))}function e2fn(_t){return .05859375*_t*_t*(1+.75*_t)}function e3fn(_t){return _t*_t*_t*(35/3072)}function gN(_t,e,n){var ei=e*n;return _t/Math.sqrt(1-ei*ei)}function adjust_lat(_t){return Math.abs(_t)<HALF_PI?_t:_t-sign(_t)*Math.PI}function imlfn(_t,e,n,ei,ti){var ii,ri;ii=_t/e;for(var ni=0;ni<15;ni++)if(ri=(_t-(e*ii-n*Math.sin(2*ii)+ei*Math.sin(4*ii)-ti*Math.sin(6*ii)))/(e-2*n*Math.cos(2*ii)+4*ei*Math.cos(4*ii)-6*ti*Math.cos(6*ii)),ii+=ri,Math.abs(ri)<=1e-10)return ii;return NaN}function init$l(){this.sphere||(this.e0=e0fn(this.es),this.e1=e1fn(this.es),this.e2=e2fn(this.es),this.e3=e3fn(this.es),this.ml0=this.a*mlfn(this.e0,this.e1,this.e2,this.e3,this.lat0))}function forward$k(_t){var e,n,ei=_t.x,ti=_t.y;if(ei=adjust_lon(ei-this.long0),this.sphere)e=this.a*Math.asin(Math.cos(ti)*Math.sin(ei)),n=this.a*(Math.atan2(Math.tan(ti),Math.cos(ei))-this.lat0);else{var ii=Math.sin(ti),ri=Math.cos(ti),ni=gN(this.a,this.e,ii),si=Math.tan(ti)*Math.tan(ti),ai=ei*Math.cos(ti),oi=ai*ai,li=this.es*ri*ri/(1-this.es),ci=this.a*mlfn(this.e0,this.e1,this.e2,this.e3,ti);e=ni*ai*(1-oi*si*(1/6-(8-si+8*li)*oi/120)),n=ci-this.ml0+ni*ii/ri*oi*(.5+(5-si+6*li)*oi/24)}return _t.x=e+this.x0,_t.y=n+this.y0,_t}function inverse$k(_t){_t.x-=this.x0,_t.y-=this.y0;var e=_t.x/this.a,n=_t.y/this.a,ei,ti;if(this.sphere){var ii=n+this.lat0;ei=Math.asin(Math.sin(ii)*Math.cos(e)),ti=Math.atan2(Math.tan(e),Math.cos(ii))}else{var ri=this.ml0/this.a+n,ni=imlfn(ri,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(ni)-HALF_PI)<=EPSLN)return _t.x=this.long0,_t.y=HALF_PI,n<0&&(_t.y*=-1),_t;var si=gN(this.a,this.e,Math.sin(ni)),ai=si*si*si/this.a/this.a*(1-this.es),oi=Math.pow(Math.tan(ni),2),li=e*this.a/si,ci=li*li;ei=ni-si*Math.tan(ni)/ai*li*li*(.5-(1+3*oi)*li*li/24),ti=li*(1-ci*(oi/3+(1+3*oi)*oi*ci/15))/Math.cos(ni)}return _t.x=adjust_lon(ti+this.long0),_t.y=adjust_lat(ei),_t}var names$m=["Cassini","Cassini_Soldner","cass"];const cass={init:init$l,forward:forward$k,inverse:inverse$k,names:names$m};function qsfnz(_t,e){var n;return _t>1e-7?(n=_t*e,(1-_t*_t)*(e/(1-n*n)-.5/_t*Math.log((1-n)/(1+n)))):2*e}var S_POLE=1,N_POLE=2,EQUIT=3,OBLIQ=4;function init$k(){var _t=Math.abs(this.lat0);if(Math.abs(_t-HALF_PI)<EPSLN?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(_t)<EPSLN?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0){var e;switch(this.qp=qsfnz(this.e,1),this.mmf=.5/(1-this.es),this.apa=authset(this.es),this.mode){case this.N_POLE:this.dd=1;break;case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),e=Math.sin(this.lat0),this.sinb1=qsfnz(this.e,e)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*e*e)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd;break}}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function forward$j(_t){var e,n,ei,ti,ii,ri,ni,si,ai,oi,li=_t.x,ci=_t.y;if(li=adjust_lon(li-this.long0),this.sphere){if(ii=Math.sin(ci),oi=Math.cos(ci),ei=Math.cos(li),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(n=this.mode===this.EQUIT?1+oi*ei:1+this.sinph0*ii+this.cosph0*oi*ei,n<=EPSLN)return null;n=Math.sqrt(2/n),e=n*oi*Math.sin(li),n*=this.mode===this.EQUIT?ii:this.cosph0*ii-this.sinph0*oi*ei}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(ei=-ei),Math.abs(ci+this.lat0)<EPSLN)return null;n=FORTPI-ci*.5,n=2*(this.mode===this.S_POLE?Math.cos(n):Math.sin(n)),e=n*Math.sin(li),n*=ei}}else{switch(ni=0,si=0,ai=0,ei=Math.cos(li),ti=Math.sin(li),ii=Math.sin(ci),ri=qsfnz(this.e,ii),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(ni=ri/this.qp,si=Math.sqrt(1-ni*ni)),this.mode){case this.OBLIQ:ai=1+this.sinb1*ni+this.cosb1*si*ei;break;case this.EQUIT:ai=1+si*ei;break;case this.N_POLE:ai=HALF_PI+ci,ri=this.qp-ri;break;case this.S_POLE:ai=ci-HALF_PI,ri=this.qp+ri;break}if(Math.abs(ai)<EPSLN)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:ai=Math.sqrt(2/ai),this.mode===this.OBLIQ?n=this.ymf*ai*(this.cosb1*ni-this.sinb1*si*ei):n=(ai=Math.sqrt(2/(1+si*ei)))*ni*this.ymf,e=this.xmf*ai*si*ti;break;case this.N_POLE:case this.S_POLE:ri>=0?(e=(ai=Math.sqrt(ri))*ti,n=ei*(this.mode===this.S_POLE?ai:-ai)):e=n=0;break}}return _t.x=this.a*e+this.x0,_t.y=this.a*n+this.y0,_t}function inverse$j(_t){_t.x-=this.x0,_t.y-=this.y0;var e=_t.x/this.a,n=_t.y/this.a,ei,ti,ii,ri,ni,si,ai;if(this.sphere){var oi=0,li,ci=0;if(li=Math.sqrt(e*e+n*n),ti=li*.5,ti>1)return null;switch(ti=2*Math.asin(ti),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(ci=Math.sin(ti),oi=Math.cos(ti)),this.mode){case this.EQUIT:ti=Math.abs(li)<=EPSLN?0:Math.asin(n*ci/li),e*=ci,n=oi*li;break;case this.OBLIQ:ti=Math.abs(li)<=EPSLN?this.lat0:Math.asin(oi*this.sinph0+n*ci*this.cosph0/li),e*=ci*this.cosph0,n=(oi-Math.sin(ti)*this.sinph0)*li;break;case this.N_POLE:n=-n,ti=HALF_PI-ti;break;case this.S_POLE:ti-=HALF_PI;break}ei=n===0&&(this.mode===this.EQUIT||this.mode===this.OBLIQ)?0:Math.atan2(e,n)}else{if(ai=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(e/=this.dd,n*=this.dd,si=Math.sqrt(e*e+n*n),si<EPSLN)return _t.x=this.long0,_t.y=this.lat0,_t;ri=2*Math.asin(.5*si/this.rq),ii=Math.cos(ri),e*=ri=Math.sin(ri),this.mode===this.OBLIQ?(ai=ii*this.sinb1+n*ri*this.cosb1/si,ni=this.qp*ai,n=si*this.cosb1*ii-n*this.sinb1*ri):(ai=n*ri/si,ni=this.qp*ai,n=si*ii)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(n=-n),ni=e*e+n*n,!ni)return _t.x=this.long0,_t.y=this.lat0,_t;ai=1-ni/this.qp,this.mode===this.S_POLE&&(ai=-ai)}ei=Math.atan2(e,n),ti=authlat(Math.asin(ai),this.apa)}return _t.x=adjust_lon(this.long0+ei),_t.y=ti,_t}var P00=.3333333333333333,P01=.17222222222222222,P02=.10257936507936508,P10=.06388888888888888,P11=.0664021164021164,P20=.016415012942191543;function authset(_t){var e,n=[];return n[0]=_t*P00,e=_t*_t,n[0]+=e*P01,n[1]=e*P10,e*=_t,n[0]+=e*P02,n[1]+=e*P11,n[2]=e*P20,n}function authlat(_t,e){var n=_t+_t;return _t+e[0]*Math.sin(n)+e[1]*Math.sin(n+n)+e[2]*Math.sin(n+n+n)}var names$l=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"];const laea={init:init$k,forward:forward$j,inverse:inverse$j,names:names$l,S_POLE,N_POLE,EQUIT,OBLIQ};function asinz(_t){return Math.abs(_t)>1&&(_t=_t>1?1:-1),Math.asin(_t)}function init$j(){Math.abs(this.lat1+this.lat2)<EPSLN||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=msfnz(this.e3,this.sin_po,this.cos_po),this.qs1=qsfnz(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=msfnz(this.e3,this.sin_po,this.cos_po),this.qs2=qsfnz(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=qsfnz(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>EPSLN?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function forward$i(_t){var e=_t.x,n=_t.y;this.sin_phi=Math.sin(n),this.cos_phi=Math.cos(n);var ei=qsfnz(this.e3,this.sin_phi),ti=this.a*Math.sqrt(this.c-this.ns0*ei)/this.ns0,ii=this.ns0*adjust_lon(e-this.long0),ri=ti*Math.sin(ii)+this.x0,ni=this.rh-ti*Math.cos(ii)+this.y0;return _t.x=ri,_t.y=ni,_t}function inverse$i(_t){var e,n,ei,ti,ii,ri;return _t.x-=this.x0,_t.y=this.rh-_t.y+this.y0,this.ns0>=0?(e=Math.sqrt(_t.x*_t.x+_t.y*_t.y),ei=1):(e=-Math.sqrt(_t.x*_t.x+_t.y*_t.y),ei=-1),ti=0,e!==0&&(ti=Math.atan2(ei*_t.x,ei*_t.y)),ei=e*this.ns0/this.a,this.sphere?ri=Math.asin((this.c-ei*ei)/(2*this.ns0)):(n=(this.c-ei*ei)/this.ns0,ri=this.phi1z(this.e3,n)),ii=adjust_lon(ti/this.ns0+this.long0),_t.x=ii,_t.y=ri,_t}function phi1z(_t,e){var n,ei,ti,ii,ri,ni=asinz(.5*e);if(_t<EPSLN)return ni;for(var si=_t*_t,ai=1;ai<=25;ai++)if(n=Math.sin(ni),ei=Math.cos(ni),ti=_t*n,ii=1-ti*ti,ri=.5*ii*ii/ei*(e/(1-si)-n/ii+.5/_t*Math.log((1-ti)/(1+ti))),ni=ni+ri,Math.abs(ri)<=1e-7)return ni;return null}var names$k=["Albers_Conic_Equal_Area","Albers","aea"];const aea={init:init$j,forward:forward$i,inverse:inverse$i,names:names$k,phi1z};function init$i(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1}function forward$h(_t){var e,n,ei,ti,ii,ri,ni,si,ai=_t.x,oi=_t.y;return ei=adjust_lon(ai-this.long0),e=Math.sin(oi),n=Math.cos(oi),ti=Math.cos(ei),ri=this.sin_p14*e+this.cos_p14*n*ti,ii=1,ri>0||Math.abs(ri)<=EPSLN?(ni=this.x0+this.a*ii*n*Math.sin(ei)/ri,si=this.y0+this.a*ii*(this.cos_p14*e-this.sin_p14*n*ti)/ri):(ni=this.x0+this.infinity_dist*n*Math.sin(ei),si=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*n*ti)),_t.x=ni,_t.y=si,_t}function inverse$h(_t){var e,n,ei,ti,ii,ri;return _t.x=(_t.x-this.x0)/this.a,_t.y=(_t.y-this.y0)/this.a,_t.x/=this.k0,_t.y/=this.k0,(e=Math.sqrt(_t.x*_t.x+_t.y*_t.y))?(ti=Math.atan2(e,this.rc),n=Math.sin(ti),ei=Math.cos(ti),ri=asinz(ei*this.sin_p14+_t.y*n*this.cos_p14/e),ii=Math.atan2(_t.x*n,e*this.cos_p14*ei-_t.y*this.sin_p14*n),ii=adjust_lon(this.long0+ii)):(ri=this.phic0,ii=0),_t.x=ii,_t.y=ri,_t}var names$j=["gnom"];const gnom={init:init$i,forward:forward$h,inverse:inverse$h,names:names$j};function iqsfnz(_t,e){var n=1-(1-_t*_t)/(2*_t)*Math.log((1-_t)/(1+_t));if(Math.abs(Math.abs(e)-n)<1e-6)return e<0?-1*HALF_PI:HALF_PI;for(var ei=Math.asin(.5*e),ti,ii,ri,ni,si=0;si<30;si++)if(ii=Math.sin(ei),ri=Math.cos(ei),ni=_t*ii,ti=Math.pow(1-ni*ni,2)/(2*ri)*(e/(1-_t*_t)-ii/(1-ni*ni)+.5/_t*Math.log((1-ni)/(1+ni))),ei+=ti,Math.abs(ti)<=1e-10)return ei;return NaN}function init$h(){this.sphere||(this.k0=msfnz(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))}function forward$g(_t){var e=_t.x,n=_t.y,ei,ti,ii=adjust_lon(e-this.long0);if(this.sphere)ei=this.x0+this.a*ii*Math.cos(this.lat_ts),ti=this.y0+this.a*Math.sin(n)/Math.cos(this.lat_ts);else{var ri=qsfnz(this.e,Math.sin(n));ei=this.x0+this.a*this.k0*ii,ti=this.y0+this.a*ri*.5/this.k0}return _t.x=ei,_t.y=ti,_t}function inverse$g(_t){_t.x-=this.x0,_t.y-=this.y0;var e,n;return this.sphere?(e=adjust_lon(this.long0+_t.x/this.a/Math.cos(this.lat_ts)),n=Math.asin(_t.y/this.a*Math.cos(this.lat_ts))):(n=iqsfnz(this.e,2*_t.y*this.k0/this.a),e=adjust_lon(this.long0+_t.x/(this.a*this.k0))),_t.x=e,_t.y=n,_t}var names$i=["cea"];const cea={init:init$h,forward:forward$g,inverse:inverse$g,names:names$i};function init$g(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)}function forward$f(_t){var e=_t.x,n=_t.y,ei=adjust_lon(e-this.long0),ti=adjust_lat(n-this.lat0);return _t.x=this.x0+this.a*ei*this.rc,_t.y=this.y0+this.a*ti,_t}function inverse$f(_t){var e=_t.x,n=_t.y;return _t.x=adjust_lon(this.long0+(e-this.x0)/(this.a*this.rc)),_t.y=adjust_lat(this.lat0+(n-this.y0)/this.a),_t}var names$h=["Equirectangular","Equidistant_Cylindrical","eqc"];const eqc={init:init$g,forward:forward$f,inverse:inverse$f,names:names$h};var MAX_ITER$1=20;function init$f(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=e0fn(this.es),this.e1=e1fn(this.es),this.e2=e2fn(this.es),this.e3=e3fn(this.es),this.ml0=this.a*mlfn(this.e0,this.e1,this.e2,this.e3,this.lat0)}function forward$e(_t){var e=_t.x,n=_t.y,ei,ti,ii,ri=adjust_lon(e-this.long0);if(ii=ri*Math.sin(n),this.sphere)Math.abs(n)<=EPSLN?(ei=this.a*ri,ti=-1*this.a*this.lat0):(ei=this.a*Math.sin(ii)/Math.tan(n),ti=this.a*(adjust_lat(n-this.lat0)+(1-Math.cos(ii))/Math.tan(n)));else if(Math.abs(n)<=EPSLN)ei=this.a*ri,ti=-1*this.ml0;else{var ni=gN(this.a,this.e,Math.sin(n))/Math.tan(n);ei=ni*Math.sin(ii),ti=this.a*mlfn(this.e0,this.e1,this.e2,this.e3,n)-this.ml0+ni*(1-Math.cos(ii))}return _t.x=ei+this.x0,_t.y=ti+this.y0,_t}function inverse$e(_t){var e,n,ei,ti,ii,ri,ni,si,ai;if(ei=_t.x-this.x0,ti=_t.y-this.y0,this.sphere)if(Math.abs(ti+this.a*this.lat0)<=EPSLN)e=adjust_lon(ei/this.a+this.long0),n=0;else{ri=this.lat0+ti/this.a,ni=ei*ei/this.a/this.a+ri*ri,si=ri;var oi;for(ii=MAX_ITER$1;ii;--ii)if(oi=Math.tan(si),ai=-1*(ri*(si*oi+1)-si-.5*(si*si+ni)*oi)/((si-ri)/oi-1),si+=ai,Math.abs(ai)<=EPSLN){n=si;break}e=adjust_lon(this.long0+Math.asin(ei*Math.tan(si)/this.a)/Math.sin(n))}else if(Math.abs(ti+this.ml0)<=EPSLN)n=0,e=adjust_lon(this.long0+ei/this.a);else{ri=(this.ml0+ti)/this.a,ni=ei*ei/this.a/this.a+ri*ri,si=ri;var li,ci,ui,di,fi;for(ii=MAX_ITER$1;ii;--ii)if(fi=this.e*Math.sin(si),li=Math.sqrt(1-fi*fi)*Math.tan(si),ci=this.a*mlfn(this.e0,this.e1,this.e2,this.e3,si),ui=this.e0-2*this.e1*Math.cos(2*si)+4*this.e2*Math.cos(4*si)-6*this.e3*Math.cos(6*si),di=ci/this.a,ai=(ri*(li*di+1)-di-.5*li*(di*di+ni))/(this.es*Math.sin(2*si)*(di*di+ni-2*ri*di)/(4*li)+(ri-di)*(li*ui-2/Math.sin(2*si))-ui),si-=ai,Math.abs(ai)<=EPSLN){n=si;break}li=Math.sqrt(1-this.es*Math.pow(Math.sin(n),2))*Math.tan(n),e=adjust_lon(this.long0+Math.asin(ei*li/this.a)/Math.sin(n))}return _t.x=e,_t.y=n,_t}var names$g=["Polyconic","poly"];const poly={init:init$f,forward:forward$e,inverse:inverse$e,names:names$g};function init$e(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function forward$d(_t){var e,n=_t.x,ei=_t.y,ti=ei-this.lat0,ii=n-this.long0,ri=ti/SEC_TO_RAD*1e-5,ni=ii,si=1,ai=0;for(e=1;e<=10;e++)si=si*ri,ai=ai+this.A[e]*si;var oi=ai,li=ni,ci=1,ui=0,di,fi,hi=0,pi=0;for(e=1;e<=6;e++)di=ci*oi-ui*li,fi=ui*oi+ci*li,ci=di,ui=fi,hi=hi+this.B_re[e]*ci-this.B_im[e]*ui,pi=pi+this.B_im[e]*ci+this.B_re[e]*ui;return _t.x=pi*this.a+this.x0,_t.y=hi*this.a+this.y0,_t}function inverse$d(_t){var e,n=_t.x,ei=_t.y,ti=n-this.x0,ii=ei-this.y0,ri=ii/this.a,ni=ti/this.a,si=1,ai=0,oi,li,ci=0,ui=0;for(e=1;e<=6;e++)oi=si*ri-ai*ni,li=ai*ri+si*ni,si=oi,ai=li,ci=ci+this.C_re[e]*si-this.C_im[e]*ai,ui=ui+this.C_im[e]*si+this.C_re[e]*ai;for(var di=0;di<this.iterations;di++){var fi=ci,hi=ui,pi,gi,vi=ri,yi=ni;for(e=2;e<=6;e++)pi=fi*ci-hi*ui,gi=hi*ci+fi*ui,fi=pi,hi=gi,vi=vi+(e-1)*(this.B_re[e]*fi-this.B_im[e]*hi),yi=yi+(e-1)*(this.B_im[e]*fi+this.B_re[e]*hi);fi=1,hi=0;var _i=this.B_re[1],Ai=this.B_im[1];for(e=2;e<=6;e++)pi=fi*ci-hi*ui,gi=hi*ci+fi*ui,fi=pi,hi=gi,_i=_i+e*(this.B_re[e]*fi-this.B_im[e]*hi),Ai=Ai+e*(this.B_im[e]*fi+this.B_re[e]*hi);var Ei=_i*_i+Ai*Ai;ci=(vi*_i+yi*Ai)/Ei,ui=(yi*_i-vi*Ai)/Ei}var Si=ci,wi=ui,Oi=1,Ii=0;for(e=1;e<=9;e++)Oi=Oi*Si,Ii=Ii+this.D[e]*Oi;var Li=this.lat0+Ii*SEC_TO_RAD*1e5,Di=this.long0+wi;return _t.x=Di,_t.y=Li,_t}var names$f=["New_Zealand_Map_Grid","nzmg"];const nzmg={init:init$e,forward:forward$d,inverse:inverse$d,names:names$f};function init$d(){}function forward$c(_t){var e=_t.x,n=_t.y,ei=adjust_lon(e-this.long0),ti=this.x0+this.a*ei,ii=this.y0+this.a*Math.log(Math.tan(Math.PI/4+n/2.5))*1.25;return _t.x=ti,_t.y=ii,_t}function inverse$c(_t){_t.x-=this.x0,_t.y-=this.y0;var e=adjust_lon(this.long0+_t.x/this.a),n=2.5*(Math.atan(Math.exp(.8*_t.y/this.a))-Math.PI/4);return _t.x=e,_t.y=n,_t}var names$e=["Miller_Cylindrical","mill"];const mill={init:init$d,forward:forward$c,inverse:inverse$c,names:names$e};var MAX_ITER=20;function init$c(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=pj_enfn(this.es)}function forward$b(_t){var e,n,ei=_t.x,ti=_t.y;if(ei=adjust_lon(ei-this.long0),this.sphere){if(!this.m)ti=this.n!==1?Math.asin(this.n*Math.sin(ti)):ti;else for(var ii=this.n*Math.sin(ti),ri=MAX_ITER;ri;--ri){var ni=(this.m*ti+Math.sin(ti)-ii)/(this.m+Math.cos(ti));if(ti-=ni,Math.abs(ni)<EPSLN)break}e=this.a*this.C_x*ei*(this.m+Math.cos(ti)),n=this.a*this.C_y*ti}else{var si=Math.sin(ti),ai=Math.cos(ti);n=this.a*pj_mlfn(ti,si,ai,this.en),e=this.a*ei*ai/Math.sqrt(1-this.es*si*si)}return _t.x=e,_t.y=n,_t}function inverse$b(_t){var e,n,ei,ti;return _t.x-=this.x0,ei=_t.x/this.a,_t.y-=this.y0,e=_t.y/this.a,this.sphere?(e/=this.C_y,ei=ei/(this.C_x*(this.m+Math.cos(e))),this.m?e=asinz((this.m*e+Math.sin(e))/this.n):this.n!==1&&(e=asinz(Math.sin(e)/this.n)),ei=adjust_lon(ei+this.long0),e=adjust_lat(e)):(e=pj_inv_mlfn(_t.y/this.a,this.es,this.en),ti=Math.abs(e),ti<HALF_PI?(ti=Math.sin(e),n=this.long0+_t.x*Math.sqrt(1-this.es*ti*ti)/(this.a*Math.cos(e)),ei=adjust_lon(n)):ti-EPSLN<HALF_PI&&(ei=this.long0)),_t.x=ei,_t.y=e,_t}var names$d=["Sinusoidal","sinu"];const sinu={init:init$c,forward:forward$b,inverse:inverse$b,names:names$d};function init$b(){}function forward$a(_t){for(var e=_t.x,n=_t.y,ei=adjust_lon(e-this.long0),ti=n,ii=Math.PI*Math.sin(n);;){var ri=-(ti+Math.sin(ti)-ii)/(1+Math.cos(ti));if(ti+=ri,Math.abs(ri)<EPSLN)break}ti/=2,Math.PI/2-Math.abs(n)<EPSLN&&(ei=0);var ni=.900316316158*this.a*ei*Math.cos(ti)+this.x0,si=1.4142135623731*this.a*Math.sin(ti)+this.y0;return _t.x=ni,_t.y=si,_t}function inverse$a(_t){var e,n;_t.x-=this.x0,_t.y-=this.y0,n=_t.y/(1.4142135623731*this.a),Math.abs(n)>.999999999999&&(n=.999999999999),e=Math.asin(n);var ei=adjust_lon(this.long0+_t.x/(.900316316158*this.a*Math.cos(e)));ei<-Math.PI&&(ei=-Math.PI),ei>Math.PI&&(ei=Math.PI),n=(2*e+Math.sin(2*e))/Math.PI,Math.abs(n)>1&&(n=1);var ti=Math.asin(n);return _t.x=ei,_t.y=ti,_t}var names$c=["Mollweide","moll"];const moll={init:init$b,forward:forward$a,inverse:inverse$a,names:names$c};function init$a(){Math.abs(this.lat1+this.lat2)<EPSLN||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=e0fn(this.es),this.e1=e1fn(this.es),this.e2=e2fn(this.es),this.e3=e3fn(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=msfnz(this.e,this.sinphi,this.cosphi),this.ml1=mlfn(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<EPSLN?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=msfnz(this.e,this.sinphi,this.cosphi),this.ml2=mlfn(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=mlfn(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))}function forward$9(_t){var e=_t.x,n=_t.y,ei;if(this.sphere)ei=this.a*(this.g-n);else{var ti=mlfn(this.e0,this.e1,this.e2,this.e3,n);ei=this.a*(this.g-ti)}var ii=this.ns*adjust_lon(e-this.long0),ri=this.x0+ei*Math.sin(ii),ni=this.y0+this.rh-ei*Math.cos(ii);return _t.x=ri,_t.y=ni,_t}function inverse$9(_t){_t.x-=this.x0,_t.y=this.rh-_t.y+this.y0;var e,n,ei,ti;this.ns>=0?(n=Math.sqrt(_t.x*_t.x+_t.y*_t.y),e=1):(n=-Math.sqrt(_t.x*_t.x+_t.y*_t.y),e=-1);var ii=0;if(n!==0&&(ii=Math.atan2(e*_t.x,e*_t.y)),this.sphere)return ti=adjust_lon(this.long0+ii/this.ns),ei=adjust_lat(this.g-n/this.a),_t.x=ti,_t.y=ei,_t;var ri=this.g-n/this.a;return ei=imlfn(ri,this.e0,this.e1,this.e2,this.e3),ti=adjust_lon(this.long0+ii/this.ns),_t.x=ti,_t.y=ei,_t}var names$b=["Equidistant_Conic","eqdc"];const eqdc={init:init$a,forward:forward$9,inverse:inverse$9,names:names$b};function init$9(){this.R=this.a}function forward$8(_t){var e=_t.x,n=_t.y,ei=adjust_lon(e-this.long0),ti,ii;Math.abs(n)<=EPSLN&&(ti=this.x0+this.R*ei,ii=this.y0);var ri=asinz(2*Math.abs(n/Math.PI));(Math.abs(ei)<=EPSLN||Math.abs(Math.abs(n)-HALF_PI)<=EPSLN)&&(ti=this.x0,n>=0?ii=this.y0+Math.PI*this.R*Math.tan(.5*ri):ii=this.y0+Math.PI*this.R*-Math.tan(.5*ri));var ni=.5*Math.abs(Math.PI/ei-ei/Math.PI),si=ni*ni,ai=Math.sin(ri),oi=Math.cos(ri),li=oi/(ai+oi-1),ci=li*li,ui=li*(2/ai-1),di=ui*ui,fi=Math.PI*this.R*(ni*(li-di)+Math.sqrt(si*(li-di)*(li-di)-(di+si)*(ci-di)))/(di+si);ei<0&&(fi=-fi),ti=this.x0+fi;var hi=si+li;return fi=Math.PI*this.R*(ui*hi-ni*Math.sqrt((di+si)*(si+1)-hi*hi))/(di+si),n>=0?ii=this.y0+fi:ii=this.y0-fi,_t.x=ti,_t.y=ii,_t}function inverse$8(_t){var e,n,ei,ti,ii,ri,ni,si,ai,oi,li,ci,ui;return _t.x-=this.x0,_t.y-=this.y0,li=Math.PI*this.R,ei=_t.x/li,ti=_t.y/li,ii=ei*ei+ti*ti,ri=-Math.abs(ti)*(1+ii),ni=ri-2*ti*ti+ei*ei,si=-2*ri+1+2*ti*ti+ii*ii,ui=ti*ti/si+(2*ni*ni*ni/si/si/si-9*ri*ni/si/si)/27,ai=(ri-ni*ni/3/si)/si,oi=2*Math.sqrt(-ai/3),li=3*ui/ai/oi,Math.abs(li)>1&&(li>=0?li=1:li=-1),ci=Math.acos(li)/3,_t.y>=0?n=(-oi*Math.cos(ci+Math.PI/3)-ni/3/si)*Math.PI:n=-(-oi*Math.cos(ci+Math.PI/3)-ni/3/si)*Math.PI,Math.abs(ei)<EPSLN?e=this.long0:e=adjust_lon(this.long0+Math.PI*(ii-1+Math.sqrt(1+2*(ei*ei-ti*ti)+ii*ii))/2/ei),_t.x=e,_t.y=n,_t}var names$a=["Van_der_Grinten_I","VanDerGrinten","vandg"];const vandg={init:init$9,forward:forward$8,inverse:inverse$8,names:names$a};function init$8(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)}function forward$7(_t){var e=_t.x,n=_t.y,ei=Math.sin(_t.y),ti=Math.cos(_t.y),ii=adjust_lon(e-this.long0),ri,ni,si,ai,oi,li,ci,ui,di,fi,hi,pi,gi,vi,yi,_i,Ai,Ei,Si,wi,Oi,Ii,Li;return this.sphere?Math.abs(this.sin_p12-1)<=EPSLN?(_t.x=this.x0+this.a*(HALF_PI-n)*Math.sin(ii),_t.y=this.y0-this.a*(HALF_PI-n)*Math.cos(ii),_t):Math.abs(this.sin_p12+1)<=EPSLN?(_t.x=this.x0+this.a*(HALF_PI+n)*Math.sin(ii),_t.y=this.y0+this.a*(HALF_PI+n)*Math.cos(ii),_t):(Ei=this.sin_p12*ei+this.cos_p12*ti*Math.cos(ii),_i=Math.acos(Ei),Ai=_i?_i/Math.sin(_i):1,_t.x=this.x0+this.a*Ai*ti*Math.sin(ii),_t.y=this.y0+this.a*Ai*(this.cos_p12*ei-this.sin_p12*ti*Math.cos(ii)),_t):(ri=e0fn(this.es),ni=e1fn(this.es),si=e2fn(this.es),ai=e3fn(this.es),Math.abs(this.sin_p12-1)<=EPSLN?(oi=this.a*mlfn(ri,ni,si,ai,HALF_PI),li=this.a*mlfn(ri,ni,si,ai,n),_t.x=this.x0+(oi-li)*Math.sin(ii),_t.y=this.y0-(oi-li)*Math.cos(ii),_t):Math.abs(this.sin_p12+1)<=EPSLN?(oi=this.a*mlfn(ri,ni,si,ai,HALF_PI),li=this.a*mlfn(ri,ni,si,ai,n),_t.x=this.x0+(oi+li)*Math.sin(ii),_t.y=this.y0+(oi+li)*Math.cos(ii),_t):(ci=ei/ti,ui=gN(this.a,this.e,this.sin_p12),di=gN(this.a,this.e,ei),fi=Math.atan((1-this.es)*ci+this.es*ui*this.sin_p12/(di*ti)),hi=Math.atan2(Math.sin(ii),this.cos_p12*Math.tan(fi)-this.sin_p12*Math.cos(ii)),hi===0?Si=Math.asin(this.cos_p12*Math.sin(fi)-this.sin_p12*Math.cos(fi)):Math.abs(Math.abs(hi)-Math.PI)<=EPSLN?Si=-Math.asin(this.cos_p12*Math.sin(fi)-this.sin_p12*Math.cos(fi)):Si=Math.asin(Math.sin(ii)*Math.cos(fi)/Math.sin(hi)),pi=this.e*this.sin_p12/Math.sqrt(1-this.es),gi=this.e*this.cos_p12*Math.cos(hi)/Math.sqrt(1-this.es),vi=pi*gi,yi=gi*gi,wi=Si*Si,Oi=wi*Si,Ii=Oi*Si,Li=Ii*Si,_i=ui*Si*(1-wi*yi*(1-yi)/6+Oi/8*vi*(1-2*yi)+Ii/120*(yi*(4-7*yi)-3*pi*pi*(1-7*yi))-Li/48*vi),_t.x=this.x0+_i*Math.sin(hi),_t.y=this.y0+_i*Math.cos(hi),_t))}function inverse$7(_t){_t.x-=this.x0,_t.y-=this.y0;var e,n,ei,ti,ii,ri,ni,si,ai,oi,li,ci,ui,di,fi,hi,pi,gi,vi,yi,_i,Ai,Ei,Si;return this.sphere?(e=Math.sqrt(_t.x*_t.x+_t.y*_t.y),e>2*HALF_PI*this.a?void 0:(n=e/this.a,ei=Math.sin(n),ti=Math.cos(n),ii=this.long0,Math.abs(e)<=EPSLN?ri=this.lat0:(ri=asinz(ti*this.sin_p12+_t.y*ei*this.cos_p12/e),ni=Math.abs(this.lat0)-HALF_PI,Math.abs(ni)<=EPSLN?this.lat0>=0?ii=adjust_lon(this.long0+Math.atan2(_t.x,-_t.y)):ii=adjust_lon(this.long0-Math.atan2(-_t.x,_t.y)):ii=adjust_lon(this.long0+Math.atan2(_t.x*ei,e*this.cos_p12*ti-_t.y*this.sin_p12*ei))),_t.x=ii,_t.y=ri,_t)):(si=e0fn(this.es),ai=e1fn(this.es),oi=e2fn(this.es),li=e3fn(this.es),Math.abs(this.sin_p12-1)<=EPSLN?(ci=this.a*mlfn(si,ai,oi,li,HALF_PI),e=Math.sqrt(_t.x*_t.x+_t.y*_t.y),ui=ci-e,ri=imlfn(ui/this.a,si,ai,oi,li),ii=adjust_lon(this.long0+Math.atan2(_t.x,-1*_t.y)),_t.x=ii,_t.y=ri,_t):Math.abs(this.sin_p12+1)<=EPSLN?(ci=this.a*mlfn(si,ai,oi,li,HALF_PI),e=Math.sqrt(_t.x*_t.x+_t.y*_t.y),ui=e-ci,ri=imlfn(ui/this.a,si,ai,oi,li),ii=adjust_lon(this.long0+Math.atan2(_t.x,_t.y)),_t.x=ii,_t.y=ri,_t):(e=Math.sqrt(_t.x*_t.x+_t.y*_t.y),hi=Math.atan2(_t.x,_t.y),di=gN(this.a,this.e,this.sin_p12),pi=Math.cos(hi),gi=this.e*this.cos_p12*pi,vi=-gi*gi/(1-this.es),yi=3*this.es*(1-vi)*this.sin_p12*this.cos_p12*pi/(1-this.es),_i=e/di,Ai=_i-vi*(1+vi)*Math.pow(_i,3)/6-yi*(1+3*vi)*Math.pow(_i,4)/24,Ei=1-vi*Ai*Ai/2-_i*Ai*Ai*Ai/6,fi=Math.asin(this.sin_p12*Math.cos(Ai)+this.cos_p12*Math.sin(Ai)*pi),ii=adjust_lon(this.long0+Math.asin(Math.sin(hi)*Math.sin(Ai)/Math.cos(fi))),Si=Math.sin(fi),ri=Math.atan2((Si-this.es*Ei*this.sin_p12)*Math.tan(fi),Si*(1-this.es)),_t.x=ii,_t.y=ri,_t))}var names$9=["Azimuthal_Equidistant","aeqd"];const aeqd={init:init$8,forward:forward$7,inverse:inverse$7,names:names$9};function init$7(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)}function forward$6(_t){var e,n,ei,ti,ii,ri,ni,si,ai=_t.x,oi=_t.y;return ei=adjust_lon(ai-this.long0),e=Math.sin(oi),n=Math.cos(oi),ti=Math.cos(ei),ri=this.sin_p14*e+this.cos_p14*n*ti,ii=1,(ri>0||Math.abs(ri)<=EPSLN)&&(ni=this.a*ii*n*Math.sin(ei),si=this.y0+this.a*ii*(this.cos_p14*e-this.sin_p14*n*ti)),_t.x=ni,_t.y=si,_t}function inverse$6(_t){var e,n,ei,ti,ii,ri,ni;return _t.x-=this.x0,_t.y-=this.y0,e=Math.sqrt(_t.x*_t.x+_t.y*_t.y),n=asinz(e/this.a),ei=Math.sin(n),ti=Math.cos(n),ri=this.long0,Math.abs(e)<=EPSLN?(ni=this.lat0,_t.x=ri,_t.y=ni,_t):(ni=asinz(ti*this.sin_p14+_t.y*ei*this.cos_p14/e),ii=Math.abs(this.lat0)-HALF_PI,Math.abs(ii)<=EPSLN?(this.lat0>=0?ri=adjust_lon(this.long0+Math.atan2(_t.x,-_t.y)):ri=adjust_lon(this.long0-Math.atan2(-_t.x,_t.y)),_t.x=ri,_t.y=ni,_t):(ri=adjust_lon(this.long0+Math.atan2(_t.x*ei,e*this.cos_p14*ti-_t.y*this.sin_p14*ei)),_t.x=ri,_t.y=ni,_t))}var names$8=["ortho"];const ortho={init:init$7,forward:forward$6,inverse:inverse$6,names:names$8};var FACE_ENUM={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},AREA_ENUM={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function init$6(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=HALF_PI-FORTPI/2?this.face=FACE_ENUM.TOP:this.lat0<=-(HALF_PI-FORTPI/2)?this.face=FACE_ENUM.BOTTOM:Math.abs(this.long0)<=FORTPI?this.face=FACE_ENUM.FRONT:Math.abs(this.long0)<=HALF_PI+FORTPI?this.face=this.long0>0?FACE_ENUM.RIGHT:FACE_ENUM.LEFT:this.face=FACE_ENUM.BACK,this.es!==0&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)}function forward$5(_t){var e={x:0,y:0},n,ei,ti,ii,ri,ni,si={value:0};if(_t.x-=this.long0,this.es!==0?n=Math.atan(this.one_minus_f_squared*Math.tan(_t.y)):n=_t.y,ei=_t.x,this.face===FACE_ENUM.TOP)ii=HALF_PI-n,ei>=FORTPI&&ei<=HALF_PI+FORTPI?(si.value=AREA_ENUM.AREA_0,ti=ei-HALF_PI):ei>HALF_PI+FORTPI||ei<=-(HALF_PI+FORTPI)?(si.value=AREA_ENUM.AREA_1,ti=ei>0?ei-SPI:ei+SPI):ei>-(HALF_PI+FORTPI)&&ei<=-FORTPI?(si.value=AREA_ENUM.AREA_2,ti=ei+HALF_PI):(si.value=AREA_ENUM.AREA_3,ti=ei);else if(this.face===FACE_ENUM.BOTTOM)ii=HALF_PI+n,ei>=FORTPI&&ei<=HALF_PI+FORTPI?(si.value=AREA_ENUM.AREA_0,ti=-ei+HALF_PI):ei<FORTPI&&ei>=-FORTPI?(si.value=AREA_ENUM.AREA_1,ti=-ei):ei<-FORTPI&&ei>=-(HALF_PI+FORTPI)?(si.value=AREA_ENUM.AREA_2,ti=-ei-HALF_PI):(si.value=AREA_ENUM.AREA_3,ti=ei>0?-ei+SPI:-ei-SPI);else{var ai,oi,li,ci,ui,di,fi;this.face===FACE_ENUM.RIGHT?ei=qsc_shift_lon_origin(ei,+HALF_PI):this.face===FACE_ENUM.BACK?ei=qsc_shift_lon_origin(ei,+SPI):this.face===FACE_ENUM.LEFT&&(ei=qsc_shift_lon_origin(ei,-HALF_PI)),ci=Math.sin(n),ui=Math.cos(n),di=Math.sin(ei),fi=Math.cos(ei),ai=ui*fi,oi=ui*di,li=ci,this.face===FACE_ENUM.FRONT?(ii=Math.acos(ai),ti=qsc_fwd_equat_face_theta(ii,li,oi,si)):this.face===FACE_ENUM.RIGHT?(ii=Math.acos(oi),ti=qsc_fwd_equat_face_theta(ii,li,-ai,si)):this.face===FACE_ENUM.BACK?(ii=Math.acos(-ai),ti=qsc_fwd_equat_face_theta(ii,li,-oi,si)):this.face===FACE_ENUM.LEFT?(ii=Math.acos(-oi),ti=qsc_fwd_equat_face_theta(ii,li,ai,si)):(ii=ti=0,si.value=AREA_ENUM.AREA_0)}return ni=Math.atan(12/SPI*(ti+Math.acos(Math.sin(ti)*Math.cos(FORTPI))-HALF_PI)),ri=Math.sqrt((1-Math.cos(ii))/(Math.cos(ni)*Math.cos(ni))/(1-Math.cos(Math.atan(1/Math.cos(ti))))),si.value===AREA_ENUM.AREA_1?ni+=HALF_PI:si.value===AREA_ENUM.AREA_2?ni+=SPI:si.value===AREA_ENUM.AREA_3&&(ni+=1.5*SPI),e.x=ri*Math.cos(ni),e.y=ri*Math.sin(ni),e.x=e.x*this.a+this.x0,e.y=e.y*this.a+this.y0,_t.x=e.x,_t.y=e.y,_t}function inverse$5(_t){var e={lam:0,phi:0},n,ei,ti,ii,ri,ni,si,ai,oi,li={value:0};if(_t.x=(_t.x-this.x0)/this.a,_t.y=(_t.y-this.y0)/this.a,ei=Math.atan(Math.sqrt(_t.x*_t.x+_t.y*_t.y)),n=Math.atan2(_t.y,_t.x),_t.x>=0&&_t.x>=Math.abs(_t.y)?li.value=AREA_ENUM.AREA_0:_t.y>=0&&_t.y>=Math.abs(_t.x)?(li.value=AREA_ENUM.AREA_1,n-=HALF_PI):_t.x<0&&-_t.x>=Math.abs(_t.y)?(li.value=AREA_ENUM.AREA_2,n=n<0?n+SPI:n-SPI):(li.value=AREA_ENUM.AREA_3,n+=HALF_PI),oi=SPI/12*Math.tan(n),ri=Math.sin(oi)/(Math.cos(oi)-1/Math.sqrt(2)),ni=Math.atan(ri),ti=Math.cos(n),ii=Math.tan(ei),si=1-ti*ti*ii*ii*(1-Math.cos(Math.atan(1/Math.cos(ni)))),si<-1?si=-1:si>1&&(si=1),this.face===FACE_ENUM.TOP)ai=Math.acos(si),e.phi=HALF_PI-ai,li.value===AREA_ENUM.AREA_0?e.lam=ni+HALF_PI:li.value===AREA_ENUM.AREA_1?e.lam=ni<0?ni+SPI:ni-SPI:li.value===AREA_ENUM.AREA_2?e.lam=ni-HALF_PI:e.lam=ni;else if(this.face===FACE_ENUM.BOTTOM)ai=Math.acos(si),e.phi=ai-HALF_PI,li.value===AREA_ENUM.AREA_0?e.lam=-ni+HALF_PI:li.value===AREA_ENUM.AREA_1?e.lam=-ni:li.value===AREA_ENUM.AREA_2?e.lam=-ni-HALF_PI:e.lam=ni<0?-ni-SPI:-ni+SPI;else{var ci,ui,di;ci=si,oi=ci*ci,oi>=1?di=0:di=Math.sqrt(1-oi)*Math.sin(ni),oi+=di*di,oi>=1?ui=0:ui=Math.sqrt(1-oi),li.value===AREA_ENUM.AREA_1?(oi=ui,ui=-di,di=oi):li.value===AREA_ENUM.AREA_2?(ui=-ui,di=-di):li.value===AREA_ENUM.AREA_3&&(oi=ui,ui=di,di=-oi),this.face===FACE_ENUM.RIGHT?(oi=ci,ci=-ui,ui=oi):this.face===FACE_ENUM.BACK?(ci=-ci,ui=-ui):this.face===FACE_ENUM.LEFT&&(oi=ci,ci=ui,ui=-oi),e.phi=Math.acos(-di)-HALF_PI,e.lam=Math.atan2(ui,ci),this.face===FACE_ENUM.RIGHT?e.lam=qsc_shift_lon_origin(e.lam,-HALF_PI):this.face===FACE_ENUM.BACK?e.lam=qsc_shift_lon_origin(e.lam,-SPI):this.face===FACE_ENUM.LEFT&&(e.lam=qsc_shift_lon_origin(e.lam,+HALF_PI))}if(this.es!==0){var fi,hi,pi;fi=e.phi<0?1:0,hi=Math.tan(e.phi),pi=this.b/Math.sqrt(hi*hi+this.one_minus_f_squared),e.phi=Math.atan(Math.sqrt(this.a*this.a-pi*pi)/(this.one_minus_f*pi)),fi&&(e.phi=-e.phi)}return e.lam+=this.long0,_t.x=e.lam,_t.y=e.phi,_t}function qsc_fwd_equat_face_theta(_t,e,n,ei){var ti;return _t<EPSLN?(ei.value=AREA_ENUM.AREA_0,ti=0):(ti=Math.atan2(e,n),Math.abs(ti)<=FORTPI?ei.value=AREA_ENUM.AREA_0:ti>FORTPI&&ti<=HALF_PI+FORTPI?(ei.value=AREA_ENUM.AREA_1,ti-=HALF_PI):ti>HALF_PI+FORTPI||ti<=-(HALF_PI+FORTPI)?(ei.value=AREA_ENUM.AREA_2,ti=ti>=0?ti-SPI:ti+SPI):(ei.value=AREA_ENUM.AREA_3,ti+=HALF_PI)),ti}function qsc_shift_lon_origin(_t,e){var n=_t+e;return n<-SPI?n+=TWO_PI:n>+SPI&&(n-=TWO_PI),n}var names$7=["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"];const qsc={init:init$6,forward:forward$5,inverse:inverse$5,names:names$7};var COEFS_X=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-986701e-12],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,18736e-12],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,934959e-12],[.7986,-.00755338,-500009e-10,935324e-12],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],COEFS_Y=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-126793e-14,422642e-15],[.124,.0124,507171e-14,-160604e-14],[.186,.0123999,-190189e-13,600152e-14],[.248,.0124002,710039e-13,-224e-10],[.31,.0123992,-264997e-12,835986e-13],[.372,.0124029,988983e-12,-311994e-12],[.434,.0123893,-369093e-11,-435621e-12],[.4958,.0123198,-102252e-10,-345523e-12],[.5571,.0121916,-154081e-10,-582288e-12],[.6176,.0119938,-241424e-10,-525327e-12],[.6769,.011713,-320223e-10,-516405e-12],[.7346,.0113541,-397684e-10,-609052e-12],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-140374e-14],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],FXC=.8487,FYC=1.3523,C1=R2D/5,RC1=1/C1,NODES=18,poly3_val=function(_t,e){return _t[0]+e*(_t[1]+e*(_t[2]+e*_t[3]))},poly3_der=function(_t,e){return _t[1]+e*(2*_t[2]+e*3*_t[3])};function newton_rapshon(_t,e,n,ei){for(var ti=e;ei;--ei){var ii=_t(ti);if(ti-=ii,Math.abs(ii)<n)break}return ti}function init$5(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"}function forward$4(_t){var e=adjust_lon(_t.x-this.long0),n=Math.abs(_t.y),ei=Math.floor(n*C1);ei<0?ei=0:ei>=NODES&&(ei=NODES-1),n=R2D*(n-RC1*ei);var ti={x:poly3_val(COEFS_X[ei],n)*e,y:poly3_val(COEFS_Y[ei],n)};return _t.y<0&&(ti.y=-ti.y),ti.x=ti.x*this.a*FXC+this.x0,ti.y=ti.y*this.a*FYC+this.y0,ti}function inverse$4(_t){var e={x:(_t.x-this.x0)/(this.a*FXC),y:Math.abs(_t.y-this.y0)/(this.a*FYC)};if(e.y>=1)e.x/=COEFS_X[NODES][0],e.y=_t.y<0?-HALF_PI:HALF_PI;else{var n=Math.floor(e.y*NODES);for(n<0?n=0:n>=NODES&&(n=NODES-1);;)if(COEFS_Y[n][0]>e.y)--n;else if(COEFS_Y[n+1][0]<=e.y)++n;else break;var ei=COEFS_Y[n],ti=5*(e.y-ei[0])/(COEFS_Y[n+1][0]-ei[0]);ti=newton_rapshon(function(ii){return(poly3_val(ei,ii)-e.y)/poly3_der(ei,ii)},ti,EPSLN,100),e.x/=poly3_val(COEFS_X[n],ti),e.y=(5*n+ti)*D2R$1,_t.y<0&&(e.y=-e.y)}return e.x=adjust_lon(e.x+this.long0),e}var names$6=["Robinson","robin"];const robin={init:init$5,forward:forward$4,inverse:inverse$4,names:names$6};function init$4(){this.name="geocent"}function forward$3(_t){var e=geodeticToGeocentric(_t,this.es,this.a);return e}function inverse$3(_t){var e=geocentricToGeodetic(_t,this.es,this.a,this.b);return e}var names$5=["Geocentric","geocentric","geocent","Geocent"];const geocent={init:init$4,forward:forward$3,inverse:inverse$3,names:names$5};var mode={N_POLE:0,S_POLE:1,EQUIT:2,OBLIQ:3},params={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};function init$3(){if(Object.keys(params).forEach((function(n){if(typeof this[n]>"u")this[n]=params[n].def;else{if(params[n].num&&isNaN(this[n]))throw new Error("Invalid parameter value, must be numeric "+n+" = "+this[n]);params[n].num&&(this[n]=parseFloat(this[n]))}params[n].degrees&&(this[n]=this[n]*D2R$1)}).bind(this)),Math.abs(Math.abs(this.lat0)-HALF_PI)<EPSLN?this.mode=this.lat0<0?mode.S_POLE:mode.N_POLE:Math.abs(this.lat0)<EPSLN?this.mode=mode.EQUIT:(this.mode=mode.OBLIQ,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var _t=this.tilt,e=this.azi;this.cg=Math.cos(e),this.sg=Math.sin(e),this.cw=Math.cos(_t),this.sw=Math.sin(_t)}function forward$2(_t){_t.x-=this.long0;var e=Math.sin(_t.y),n=Math.cos(_t.y),ei=Math.cos(_t.x),ti,ii;switch(this.mode){case mode.OBLIQ:ii=this.sinph0*e+this.cosph0*n*ei;break;case mode.EQUIT:ii=n*ei;break;case mode.S_POLE:ii=-e;break;case mode.N_POLE:ii=e;break}switch(ii=this.pn1/(this.p-ii),ti=ii*n*Math.sin(_t.x),this.mode){case mode.OBLIQ:ii*=this.cosph0*e-this.sinph0*n*ei;break;case mode.EQUIT:ii*=e;break;case mode.N_POLE:ii*=-(n*ei);break;case mode.S_POLE:ii*=n*ei;break}var ri,ni;return ri=ii*this.cg+ti*this.sg,ni=1/(ri*this.sw*this.h1+this.cw),ti=(ti*this.cg-ii*this.sg)*this.cw*ni,ii=ri*ni,_t.x=ti*this.a,_t.y=ii*this.a,_t}function inverse$2(_t){_t.x/=this.a,_t.y/=this.a;var e={x:_t.x,y:_t.y},n,ei,ti;ti=1/(this.pn1-_t.y*this.sw),n=this.pn1*_t.x*ti,ei=this.pn1*_t.y*this.cw*ti,_t.x=n*this.cg+ei*this.sg,_t.y=ei*this.cg-n*this.sg;var ii=hypot(_t.x,_t.y);if(Math.abs(ii)<EPSLN)e.x=0,e.y=_t.y;else{var ri,ni;switch(ni=1-ii*ii*this.pfact,ni=(this.p-Math.sqrt(ni))/(this.pn1/ii+ii/this.pn1),ri=Math.sqrt(1-ni*ni),this.mode){case mode.OBLIQ:e.y=Math.asin(ri*this.sinph0+_t.y*ni*this.cosph0/ii),_t.y=(ri-this.sinph0*Math.sin(e.y))*ii,_t.x*=ni*this.cosph0;break;case mode.EQUIT:e.y=Math.asin(_t.y*ni/ii),_t.y=ri*ii,_t.x*=ni;break;case mode.N_POLE:e.y=Math.asin(ri),_t.y=-_t.y;break;case mode.S_POLE:e.y=-Math.asin(ri);break}e.x=Math.atan2(_t.x,_t.y)}return _t.x=e.x+this.long0,_t.y=e.y,_t}var names$4=["Tilted_Perspective","tpers"];const tpers={init:init$3,forward:forward$2,inverse:inverse$2,names:names$4};function init$2(){if(this.flip_axis=this.sweep==="x"?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,this.es!==0){var _t=1-this.es,e=1/_t;this.radius_p=Math.sqrt(_t),this.radius_p2=_t,this.radius_p_inv2=e,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")}function forward$1(_t){var e=_t.x,n=_t.y,ei,ti,ii,ri;if(e=e-this.long0,this.shape==="ellipse"){n=Math.atan(this.radius_p2*Math.tan(n));var ni=this.radius_p/hypot(this.radius_p*Math.cos(n),Math.sin(n));if(ti=ni*Math.cos(e)*Math.cos(n),ii=ni*Math.sin(e)*Math.cos(n),ri=ni*Math.sin(n),(this.radius_g-ti)*ti-ii*ii-ri*ri*this.radius_p_inv2<0)return _t.x=Number.NaN,_t.y=Number.NaN,_t;ei=this.radius_g-ti,this.flip_axis?(_t.x=this.radius_g_1*Math.atan(ii/hypot(ri,ei)),_t.y=this.radius_g_1*Math.atan(ri/ei)):(_t.x=this.radius_g_1*Math.atan(ii/ei),_t.y=this.radius_g_1*Math.atan(ri/hypot(ii,ei)))}else this.shape==="sphere"&&(ei=Math.cos(n),ti=Math.cos(e)*ei,ii=Math.sin(e)*ei,ri=Math.sin(n),ei=this.radius_g-ti,this.flip_axis?(_t.x=this.radius_g_1*Math.atan(ii/hypot(ri,ei)),_t.y=this.radius_g_1*Math.atan(ri/ei)):(_t.x=this.radius_g_1*Math.atan(ii/ei),_t.y=this.radius_g_1*Math.atan(ri/hypot(ii,ei))));return _t.x=_t.x*this.a,_t.y=_t.y*this.a,_t}function inverse$1(_t){var e=-1,n=0,ei=0,ti,ii,ri,ni;if(_t.x=_t.x/this.a,_t.y=_t.y/this.a,this.shape==="ellipse"){this.flip_axis?(ei=Math.tan(_t.y/this.radius_g_1),n=Math.tan(_t.x/this.radius_g_1)*hypot(1,ei)):(n=Math.tan(_t.x/this.radius_g_1),ei=Math.tan(_t.y/this.radius_g_1)*hypot(1,n));var si=ei/this.radius_p;if(ti=n*n+si*si+e*e,ii=2*this.radius_g*e,ri=ii*ii-4*ti*this.C,ri<0)return _t.x=Number.NaN,_t.y=Number.NaN,_t;ni=(-ii-Math.sqrt(ri))/(2*ti),e=this.radius_g+ni*e,n*=ni,ei*=ni,_t.x=Math.atan2(n,e),_t.y=Math.atan(ei*Math.cos(_t.x)/e),_t.y=Math.atan(this.radius_p_inv2*Math.tan(_t.y))}else if(this.shape==="sphere"){if(this.flip_axis?(ei=Math.tan(_t.y/this.radius_g_1),n=Math.tan(_t.x/this.radius_g_1)*Math.sqrt(1+ei*ei)):(n=Math.tan(_t.x/this.radius_g_1),ei=Math.tan(_t.y/this.radius_g_1)*Math.sqrt(1+n*n)),ti=n*n+ei*ei+e*e,ii=2*this.radius_g*e,ri=ii*ii-4*ti*this.C,ri<0)return _t.x=Number.NaN,_t.y=Number.NaN,_t;ni=(-ii-Math.sqrt(ri))/(2*ti),e=this.radius_g+ni*e,n*=ni,ei*=ni,_t.x=Math.atan2(n,e),_t.y=Math.atan(ei*Math.cos(_t.x)/e)}return _t.x=_t.x+this.long0,_t}var names$3=["Geostationary Satellite View","Geostationary_Satellite","geos"];const geos={init:init$2,forward:forward$1,inverse:inverse$1,names:names$3};var A1=1.340264,A2=-.081106,A3=893e-6,A4=.003796,M$3=Math.sqrt(3)/2;function init$1(){this.es=0,this.long0=this.long0!==void 0?this.long0:0}function forward(_t){var e=adjust_lon(_t.x-this.long0),n=_t.y,ei=Math.asin(M$3*Math.sin(n)),ti=ei*ei,ii=ti*ti*ti;return _t.x=e*Math.cos(ei)/(M$3*(A1+3*A2*ti+ii*(7*A3+9*A4*ti))),_t.y=ei*(A1+A2*ti+ii*(A3+A4*ti)),_t.x=this.a*_t.x+this.x0,_t.y=this.a*_t.y+this.y0,_t}function inverse(_t){_t.x=(_t.x-this.x0)/this.a,_t.y=(_t.y-this.y0)/this.a;var e=1e-9,n=12,ei=_t.y,ti,ii,ri,ni,si,ai;for(ai=0;ai<n&&(ti=ei*ei,ii=ti*ti*ti,ri=ei*(A1+A2*ti+ii*(A3+A4*ti))-_t.y,ni=A1+3*A2*ti+ii*(7*A3+9*A4*ti),ei-=si=ri/ni,!(Math.abs(si)<e));++ai);return ti=ei*ei,ii=ti*ti*ti,_t.x=M$3*_t.x*(A1+3*A2*ti+ii*(7*A3+9*A4*ti))/Math.cos(ei),_t.y=Math.asin(Math.sin(ei)/M$3),_t.x=adjust_lon(_t.x+this.long0),_t}var names$2=["eqearth","Equal Earth","Equal_Earth"];const eqearth={init:init$1,forward,inverse,names:names$2};var EPS10=1e-10;function init(){var _t;if(this.phi1=this.lat1,Math.abs(this.phi1)<EPS10)throw new Error;this.es?(this.en=pj_enfn(this.es),this.m1=pj_mlfn(this.phi1,this.am1=Math.sin(this.phi1),_t=Math.cos(this.phi1),this.en),this.am1=_t/(Math.sqrt(1-this.es*this.am1*this.am1)*this.am1),this.inverse=e_inv,this.forward=e_fwd):(Math.abs(this.phi1)+EPS10>=HALF_PI?this.cphi1=0:this.cphi1=1/Math.tan(this.phi1),this.inverse=s_inv,this.forward=s_fwd)}function e_fwd(_t){var e=adjust_lon(_t.x-(this.long0||0)),n=_t.y,ei,ti,ii;return ei=this.am1+this.m1-pj_mlfn(n,ti=Math.sin(n),ii=Math.cos(n),this.en),ti=ii*e/(ei*Math.sqrt(1-this.es*ti*ti)),_t.x=ei*Math.sin(ti),_t.y=this.am1-ei*Math.cos(ti),_t.x=this.a*_t.x+(this.x0||0),_t.y=this.a*_t.y+(this.y0||0),_t}function e_inv(_t){_t.x=(_t.x-(this.x0||0))/this.a,_t.y=(_t.y-(this.y0||0))/this.a;var e,n,ei,ti;if(n=hypot(_t.x,_t.y=this.am1-_t.y),ti=pj_inv_mlfn(this.am1+this.m1-n,this.es,this.en),(e=Math.abs(ti))<HALF_PI)e=Math.sin(ti),ei=n*Math.atan2(_t.x,_t.y)*Math.sqrt(1-this.es*e*e)/Math.cos(ti);else if(Math.abs(e-HALF_PI)<=EPS10)ei=0;else throw new Error;return _t.x=adjust_lon(ei+(this.long0||0)),_t.y=adjust_lat(ti),_t}function s_fwd(_t){var e=adjust_lon(_t.x-(this.long0||0)),n=_t.y,ei,ti;return ti=this.cphi1+this.phi1-n,Math.abs(ti)>EPS10?(_t.x=ti*Math.sin(ei=e*Math.cos(n)/ti),_t.y=this.cphi1-ti*Math.cos(ei)):_t.x=_t.y=0,_t.x=this.a*_t.x+(this.x0||0),_t.y=this.a*_t.y+(this.y0||0),_t}function s_inv(_t){_t.x=(_t.x-(this.x0||0))/this.a,_t.y=(_t.y-(this.y0||0))/this.a;var e,n,ei=hypot(_t.x,_t.y=this.cphi1-_t.y);if(n=this.cphi1+this.phi1-ei,Math.abs(n)>HALF_PI)throw new Error;return Math.abs(Math.abs(n)-HALF_PI)<=EPS10?e=0:e=ei*Math.atan2(_t.x,_t.y)/Math.cos(n),_t.x=adjust_lon(e+(this.long0||0)),_t.y=adjust_lat(n),_t}var names$1=["bonne","Bonne (Werner lat_1=90)"];const bonne={init,names:names$1};function includedProjections(_t){_t.Proj.projections.add(tmerc),_t.Proj.projections.add(etmerc),_t.Proj.projections.add(utm),_t.Proj.projections.add(sterea),_t.Proj.projections.add(stere),_t.Proj.projections.add(somerc),_t.Proj.projections.add(omerc),_t.Proj.projections.add(lcc),_t.Proj.projections.add(krovak),_t.Proj.projections.add(cass),_t.Proj.projections.add(laea),_t.Proj.projections.add(aea),_t.Proj.projections.add(gnom),_t.Proj.projections.add(cea),_t.Proj.projections.add(eqc),_t.Proj.projections.add(poly),_t.Proj.projections.add(nzmg),_t.Proj.projections.add(mill),_t.Proj.projections.add(sinu),_t.Proj.projections.add(moll),_t.Proj.projections.add(eqdc),_t.Proj.projections.add(vandg),_t.Proj.projections.add(aeqd),_t.Proj.projections.add(ortho),_t.Proj.projections.add(qsc),_t.Proj.projections.add(robin),_t.Proj.projections.add(geocent),_t.Proj.projections.add(tpers),_t.Proj.projections.add(geos),_t.Proj.projections.add(eqearth),_t.Proj.projections.add(bonne)}proj4.defaultDatum="WGS84";proj4.Proj=Projection;proj4.WGS84=new proj4.Proj("WGS84");proj4.Point=Point;proj4.toPoint=common$1;proj4.defs=defs;proj4.nadgrid=nadgrid;proj4.transform=transform;proj4.mgrs=mgrs;proj4.version="__VERSION__";includedProjections(proj4);var logger$A=LoggerByDefault.getLogger("CRS");function register(_t){const e=Object.keys(_t.defs);logger$A.trace("proj. codes :",e);const n=e.length;let ei,ti;for(ei=0;ei<n;++ei){const ii=e[ei];if(!get$3(ii)){const ri=_t.defs(ii);addProjection(new Projection$1({code:ii,axisOrientation:ri.axis,metersPerUnit:ri.to_meter,units:ri.units}))}}for(ei=0;ei<n;++ei){const ii=e[ei],ri=get$3(ii);for(ti=0;ti<n;++ti){const ni=e[ti],si=get$3(ni);if(!get$4(ii,ni))if(_t.defs[ii]===_t.defs[ni])addEquivalentProjections([ri,si]);else{const ai=_t(ii,ni);addCoordinateTransforms(ri,si,ai.forward,ai.inverse)}}}}var Register={isLoaded:!1,get:function(_t){if(!(_t===""||_t===null||typeof _t>"u")){var e=_t.split(":");if(e.length===2){var n=e[0],ei=e[1];if(this.hasOwnProperty(n)&&this[n].hasOwnProperty(ei))return this[n][ei]}}},exist:function(_t){if(_t===""||_t===null||typeof _t>"u")return!1;var e=_t.split(":");if(e.length!==2)return!1;var n=e[0],ei=e[1];return!(!this.hasOwnProperty(n)||!this[n].hasOwnProperty(ei))},load:function(_t){if(!this.isLoaded){for(var e=["IGNF","EPSG","CRS"],n=0;n<e.length;n++){var ei=e[n],ti=this[ei];for(var ii in ti)if(ti.hasOwnProperty(ii)){var ri=ei+":"+ii;_t.defs(ri,this.get(ri))}}this.isLoaded=!0}},loadByDefault:function(_t){var e={EPSG:{2154:Register.EPSG[2154],27571:Register.EPSG[27571],27572:Register.EPSG[27572],27573:Register.EPSG[27573],27574:Register.EPSG[27574]},CRS:{84:Register.CRS[84]},IGNF:{LAMB93:Register.IGNF.LAMB93,LAMBE:Register.IGNF.LAMBE,LAMB1:Register.IGNF.LAMB1,LAMB2:Register.IGNF.LAMB2,LAMB3:Register.IGNF.LAMB3,LAMB4:Register.IGNF.LAMB4,RGF93G:Register.IGNF.RGF93G,WGS84G:Register.IGNF.WGS84G}};for(var n in e)if(e.hasOwnProperty(n)){var ei=e[n];for(var ti in ei)if(ei.hasOwnProperty(ti)){var ii=n+":"+ti;_t.defs(ii,ei[ti])}}},loadByName:function(_t,e){if(!this.exist(e))return!1;try{_t.defs(e,this.get(e))}catch{return!1}return!0},EPSG:{4978:"+proj=geocent +datum=WGS84 +units=m +no_defs ",3857:"+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs",3785:"+title=WGS 84 / Pseudo-Mercator (deprecated) +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs",4149:"+title=CH1903 +proj=longlat +ellps=bessel +towgs84=674.374,15.056,405.346,0,0,0,0 +no_defs ",4150:"+title=CH1903plus +proj=longlat +ellps=bessel +towgs84=674.374,15.056,405.346,0,0,0,0 +no_defs ",4151:"+title=CHTRF95 +proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +no_defs ",4171:"+title=RGF93 +proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +no_defs ",4230:"+title=ED50 +proj=longlat +ellps=intl +no_defs ",4235:"+title=Guyane Francaise +proj=longlat +ellps=intl +no_defs ",4258:"+title=ETRS89 +proj=longlat +ellps=GRS80 +no_defs ",4275:"+title=NTF +proj=longlat +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +no_defs ",4322:"+title=WGS 72 +proj=longlat +ellps=WGS72 +no_defs ",4326:"+title=WGS 84 +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs ",4467:"+proj=utm +zone=21 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ",4470:"+proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +no_defs ",4471:"+proj=utm +zone=38 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ",4474:"+proj=utm +zone=38 +south +ellps=intl +towgs84=-382,-59,-262,0,0,0,0 +units=m +no_defs ",4558:"+proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +no_defs ",4559:"+proj=utm +zone=20 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ",4621:"+title=Fort Marigot +proj=longlat +ellps=intl +towgs84=137,248,-430,0,0,0,0 +no_defs ",4622:"+title=Guadeloupe 1948 +proj=longlat +ellps=intl +no_defs ",4623:"+title=CSG67 +proj=longlat +ellps=intl +towgs84=-186,230,110,0,0,0,0 +no_defs ",4624:"+title=RGFG95 +proj=longlat +ellps=GRS80 +towgs84=2,2,-2,0,0,0,0 +no_defs ",4625:"+title=Martinique 1938 +proj=longlat +ellps=intl +no_defs ",4626:"+title=Reunion 1947 +proj=longlat +ellps=intl +no_defs ",4627:"+title=RGR92 +proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +no_defs ",4628:"+title=Tahiti 52 +proj=longlat +ellps=intl +towgs84=162,117,154,0,0,0,0 +no_defs ",4629:"+title=Tahaa 54 +proj=longlat +ellps=intl +no_defs ",4630:"+title=IGN72 Nuku Hiva +proj=longlat +ellps=intl +no_defs ",4632:"+title=Combani 1950 +proj=longlat +ellps=intl +towgs84=-382,-59,-262,0,0,0,0 +no_defs ",4633:"+title=IGN56 Lifou +proj=longlat +ellps=intl +no_defs ",4634:"+title=IGN72 Grand Terre +proj=longlat +ellps=intl +no_defs ",4637:"+title=Perroud 1950 +proj=longlat +ellps=intl +towgs84=325,154,172,0,0,0,0 +no_defs ",4638:"+title=Saint Pierre et Miquelon 1950 +proj=longlat +ellps=clrk66 +towgs84=30,430,368,0,0,0,0 +no_defs ",4640:"+title=RRAF 1991 +proj=longlat +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +no_defs ",4641:"+title=IGN53 Mare +proj=longlat +ellps=intl +no_defs ",4645:"+title=RGNC 1991 +proj=longlat +ellps=intl +towgs84=0,0,0,0,0,0,0 +no_defs ",4687:"+proj=longlat +ellps=GRS80 +no_defs ",4662:"+title=IGN72 Grande Terre +proj=longlat +ellps=intl +no_defs ",4689:"+title=IGN63 Hiva Oa +proj=longlat +ellps=intl +no_defs ",4690:"+title=Tahiti 79 +proj=longlat +ellps=intl +no_defs ",4691:"+title=Moorea 87 +proj=longlat +ellps=intl +towgs84=215.525,149.593,176.229,-3.2624,-1.692,-1.1571,10.4773 +no_defs ",4692:"+title=Maupiti 83 +proj=longlat +ellps=intl +towgs84=217.037,86.959,23.956,0,0,0,0 +no_defs ",4698:"+title=IGN 1962 Kerguelen +proj=longlat +ellps=intl +towgs84=145,-187,103,0,0,0,0 +no_defs ",4749:"+title=RGNC91-93 +proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +no_defs ",4750:"+title=ST87 Ouvea +proj=longlat +ellps=WGS84 +towgs84=-56.263,16.136,-22.856,0,0,0,0 +no_defs ",4807:"+title=NTF (Paris) +proj=longlat +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +no_defs ",2056:"+title=CH1903+ / LV95 +proj=somerc +lat_0=46.95240555555556 +lon_0=7.439583333333333 +x_0=2600000 +y_0=1200000 +ellps=bessel +towgs84=674.374,15.056,405.346,0,0,0,0 +units=m +no_defs ",2154:"+title=RGF93 / Lambert-93 +proj=lcc +lat_1=49 +lat_2=44 +lat_0=46.5 +lon_0=3 +x_0=700000 +y_0=6600000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ",2213:"+title=ETRS89 / TM 30 NE +proj=tmerc +lat_0=0 +lon_0=30 +k=0.9996 +x_0=500000 +y_0=0 +ellps=GRS80 +units=m +no_defs ",2969:"+title=Fort Marigot / UTM zone 20N +proj=utm +zone=20 +ellps=intl +towgs84=137,248,-430,0,0,0,0 +units=m +no_defs ",2970:"+title=Guadeloupe 1948 / UTM zone 20N +proj=utm +zone=20 +ellps=intl +units=m +no_defs ",2971:"+title=CSG67 / UTM zone 22N +proj=utm +zone=22 +ellps=intl +towgs84=-186,230,110,0,0,0,0 +units=m +no_defs ",2972:"+title=RGFG95 / UTM zone 22N +proj=utm +zone=22 +ellps=GRS80 +towgs84=2,2,-2,0,0,0,0 +units=m +no_defs ",2973:"+title=Martinique 1938 / UTM zone 20N +proj=utm +zone=20 +ellps=intl +units=m +no_defs ",2975:"+title=RGR92 / UTM zone 40S +proj=utm +zone=40 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ",2976:"+title=Tahiti 52 / UTM zone 6S +proj=utm +zone=6 +south +ellps=intl +towgs84=162,117,154,0,0,0,0 +units=m +no_defs ",2977:"+title=Tahaa 54 / UTM zone 5S +proj=utm +zone=5 +south +ellps=intl +units=m +no_defs ",2978:"+title=IGN72 Nuku Hiva / UTM zone 7S +proj=utm +zone=7 +south +ellps=intl +units=m +no_defs ",2980:"+title=Combani 1950 / UTM zone 38S +proj=utm +zone=38 +south +ellps=intl +towgs84=-382,-59,-262,0,0,0,0 +units=m +no_defs ",2981:"+title=IGN56 Lifou / UTM zone 58S +proj=utm +zone=58 +south +ellps=intl +units=m +no_defs ",2982:"+title=IGN72 Grand Terre / UTM zone 58S (deprecated) +proj=utm +zone=58 +south +ellps=intl +units=m +no_defs ",2984:"+title=RGNC 1991 / Lambert New Caledonia (deprecated) +proj=lcc +lat_1=-20.66666666666667 +lat_2=-22.33333333333333 +lat_0=-21.5 +lon_0=166 +x_0=400000 +y_0=300000 +ellps=intl +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ",2986:"+title=Terre Adelie 1950 +proj=stere +towgs84=324.9120,153.2820,172.0260 +a=6378388.0000 +rf=297.0000000000000 +lat_0=-90.000000000 +lon_0=140.000000000 +lat_ts=-67.000000000 +k=0.96027295 +x_0=300000.000 +y_0=-2299363.482 +units=m +no_defs",2987:"+title=Saint Pierre et Miquelon 1950 / UTM zone 21N +proj=utm +zone=21 +ellps=clrk66 +towgs84=30,430,368,0,0,0,0 +units=m +no_defs ",2989:"+title=RRAF 1991 / UTM zone 20N +proj=utm +zone=20 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ",2990:"+title=Reunion 1947 / TM Reunion (deprecated) +proj=tmerc +lat_0=-21.11666666666667 +lon_0=55.53333333333333 +k=1 +x_0=50000 +y_0=160000 +ellps=intl +units=m +no_defs ",2995:"+title=IGN53 Mare / UTM zone 58S +proj=utm +zone=58 +south +ellps=intl +units=m +no_defs ",3038:"+proj=utm +zone=26 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ",3039:"+proj=utm +zone=27 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ",3040:"+proj=utm +zone=28 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ",3041:"+proj=utm +zone=29 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ",3045:"+proj=utm +zone=33 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ",3046:"+proj=utm +zone=34 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ",3047:"+proj=utm +zone=35 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ",3048:"+proj=utm +zone=36 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ",3049:"+proj=utm +zone=37 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ",3050:"+proj=utm +zone=38 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ",3051:"+proj=utm +zone=39 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ",3034:"+title=ETRS89 / ETRS-LCC +proj=lcc +lat_1=35 +lat_2=65 +lat_0=52 +lon_0=10 +x_0=4000000 +y_0=2800000 +ellps=GRS80 +units=m +no_defs ",3035:"+title=ETRS89 / ETRS-LAEA +proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 +ellps=GRS80 +units=m +no_defs ",3042:"+title=ETRS89 / ETRS-TM30 +proj=utm +zone=30 +ellps=GRS80 +units=m +no_defs ",3043:"+title=ETRS89 / ETRS-TM31 +proj=utm +zone=31 +ellps=GRS80 +units=m +no_defs ",3044:"+title=ETRS89 / ETRS-TM32 +proj=utm +zone=32 +ellps=GRS80 +units=m +no_defs ",25828:"+proj=utm +zone=28 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ",25829:"+proj=utm +zone=29 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ",25833:"+proj=utm +zone=33 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ",25834:"+proj=utm +zone=34 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ",25835:"+proj=utm +zone=35 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ",25836:"+proj=utm +zone=36 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ",25837:"+proj=utm +zone=37 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ",25838:"+proj=utm +zone=38 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ",3060:"+title=IGN72 Grande Terre / UTM zone 58S +proj=utm +zone=58 +south +ellps=intl +units=m +no_defs ",3163:"+title=RGNC91-93 / Lambert New Caledonia +proj=lcc +lat_1=-20.66666666666667 +lat_2=-22.33333333333333 +lat_0=-21.5 +lon_0=166 +x_0=400000 +y_0=300000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ",3164:"+title=ST87 Ouvea / UTM zone 58S +proj=utm +zone=58 +south +ellps=WGS84 +towgs84=-56.263,16.136,-22.856,0,0,0,0 +units=m +no_defs ",3165:"+title=NEA74 Noumea / Noumea Lambert +proj=lcc +lat_1=-22.24469175 +lat_2=-22.29469175 +lat_0=-22.26969175 +lon_0=166.44242575 +x_0=0.66 +y_0=1.02 +ellps=intl +units=m +no_defs ",3166:"+title=NEA74 Noumea / Noumea Lambert 2 +proj=lcc +lat_1=-22.24472222222222 +lat_2=-22.29472222222222 +lat_0=-22.26972222222222 +lon_0=166.4425 +x_0=8.313000000000001 +y_0=-2.354 +ellps=intl +units=m +no_defs ",3169:"+title=RGNC91-93 / UTM zone 57S +proj=utm +zone=57 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ",3170:"+title=RGNC91-93 / UTM zone 58S +proj=utm +zone=58 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ",3171:"+title=RGNC91-93 / UTM zone 59S +proj=utm +zone=59 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ",3172:"+title=IGN53 Mare / UTM zone 59S +proj=utm +zone=59 +south +ellps=intl +units=m +no_defs ",3296:"+title=RGPF / UTM zone 5S +proj=utm +zone=5 +south +ellps=GRS80 +units=m +no_defs ",3297:"+title=RGPF / UTM zone 6S +proj=utm +zone=6 +south +ellps=GRS80 +units=m +no_defs ",3298:"+title=RGPF / UTM zone 7S +proj=utm +zone=7 +south +ellps=GRS80 +units=m +no_defs ",3299:"+title=RGPF / UTM zone 8S +proj=utm +zone=8 +south +ellps=GRS80 +units=m +no_defs ",3302:"+title=IGN63 Hiva Oa / UTM zone 7S +proj=utm +zone=7 +south +ellps=intl +units=m +no_defs ",3303:"+title=Fatu Iva 72 / UTM zone 7S +proj=utm +zone=7 +south +ellps=intl +towgs84=347.103,1078.12,2623.92,-33.8875,70.6773,-9.3943,186.074 +units=m +no_defs ",3304:"+title=Tahiti 79 / UTM zone 6S +proj=utm +zone=6 +south +ellps=intl +units=m +no_defs ",3305:"+title=Moorea 87 / UTM zone 6S +proj=utm +zone=6 +south +ellps=intl +towgs84=215.525,149.593,176.229,-3.2624,-1.692,-1.1571,10.4773 +units=m +no_defs ",3306:"+title=Maupiti 83 / UTM zone 5S +proj=utm +zone=5 +south +ellps=intl +towgs84=217.037,86.959,23.956,0,0,0,0 +units=m +no_defs ",3312:"+title=CSG67 / UTM zone 21N +proj=utm +zone=21 +ellps=intl +towgs84=-186,230,110,0,0,0,0 +units=m +no_defs ",3313:"+title=RGFG95 / UTM zone 21N +proj=utm +zone=21 +ellps=GRS80 +towgs84=2,2,-2,0,0,0,0 +units=m +no_defs ",3336:"+title=IGN 1962 Kerguelen / UTM zone 42S +proj=utm +zone=42 +south +ellps=intl +towgs84=145,-187,103,0,0,0,0 +units=m +no_defs ",3395:"+title=WGS 84 / World Mercator +proj=merc +lon_0=0 +k=1 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",3727:"+title=Reunion 1947 / TM Reunion +proj=tmerc +lat_0=-21.11666666666667 +lon_0=55.53333333333333 +k=1 +x_0=160000 +y_0=50000 +ellps=intl +units=m +no_defs ",21781:"+title=CH1903 / LV03 +proj=somerc +lat_0=46.95240555555556 +lon_0=7.439583333333333 +x_0=600000 +y_0=200000 +ellps=bessel +towgs84=674.374,15.056,405.346,0,0,0,0 +units=m +no_defs ",25830:"+title=ETRS89 / UTM zone 30N +proj=utm +zone=30 +ellps=GRS80 +units=m +no_defs ",25831:"+title=ETRS89 / UTM zone 31N +proj=utm +zone=31 +ellps=GRS80 +units=m +no_defs ",25832:"+title=ETRS89 / UTM zone 32N +proj=utm +zone=32 +ellps=GRS80 +units=m +no_defs ",27561:"+title=NTF (Paris) / Lambert Nord France +proj=lcc +lat_1=49.50000000000001 +lat_0=49.50000000000001 +lon_0=0 +k_0=0.999877341 +x_0=600000 +y_0=200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ",27562:"+title=NTF (Paris) / Lambert Centre France +proj=lcc +lat_1=46.8 +lat_0=46.8 +lon_0=0 +k_0=0.99987742 +x_0=600000 +y_0=200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ",27563:"+title=NTF (Paris) / Lambert Sud France +proj=lcc +lat_1=44.10000000000001 +lat_0=44.10000000000001 +lon_0=0 +k_0=0.9998774990000001 +x_0=600000 +y_0=200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ",27564:"+title=NTF (Paris) / Lambert Corse +proj=lcc +lat_1=42.16500000000001 +lat_0=42.16500000000001 +lon_0=0 +k_0=0.9999447100000001 +x_0=234.358 +y_0=185861.369 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ",27571:"+title=NTF (Paris) / Lambert zone I +proj=lcc +lat_1=49.50000000000001 +lat_0=49.50000000000001 +lon_0=0 +k_0=0.999877341 +x_0=600000 +y_0=1200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ",27572:"+title=NTF (Paris) / Lambert zone II +proj=lcc +lat_1=46.8 +lat_0=46.8 +lon_0=0 +k_0=0.99987742 +x_0=600000 +y_0=2200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ",27573:"+title=NTF (Paris) / Lambert zone III +proj=lcc +lat_1=44.10000000000001 +lat_0=44.10000000000001 +lon_0=0 +k_0=0.9998774990000001 +x_0=600000 +y_0=3200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ",27574:"+title=NTF (Paris) / Lambert zone IV +proj=lcc +lat_1=42.16500000000001 +lat_0=42.16500000000001 +lon_0=0 +k_0=0.9999447100000001 +x_0=234.358 +y_0=4185861.369 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ",27581:"+title=NTF (Paris) / France I (deprecated) +proj=lcc +lat_1=49.50000000000001 +lat_0=49.50000000000001 +lon_0=0 +k_0=0.999877341 +x_0=600000 +y_0=1200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ",27582:"+title=NTF (Paris) / France II (deprecated) +proj=lcc +lat_1=46.8 +lat_0=46.8 +lon_0=0 +k_0=0.99987742 +x_0=600000 +y_0=2200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ",27583:"+title=NTF (Paris) / France III (deprecated) +proj=lcc +lat_1=44.10000000000001 +lat_0=44.10000000000001 +lon_0=0 +k_0=0.9998774990000001 +x_0=600000 +y_0=3200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ",27584:"+title=NTF (Paris) / France IV (deprecated) +proj=lcc +lat_1=42.16500000000001 +lat_0=42.16500000000001 +lon_0=0 +k_0=0.9999447100000001 +x_0=234.358 +y_0=4185861.369 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ",27591:"+title=NTF (Paris) / Nord France (deprecated) +proj=lcc +lat_1=49.50000000000001 +lat_0=49.50000000000001 +lon_0=0 +k_0=0.999877341 +x_0=600000 +y_0=200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ",27592:"+title=NTF (Paris) / Centre France (deprecated) +proj=lcc +lat_1=46.8 +lat_0=46.8 +lon_0=0 +k_0=0.99987742 +x_0=600000 +y_0=200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ",27593:"+title=NTF (Paris) / Sud France (deprecated) +proj=lcc +lat_1=44.10000000000001 +lat_0=44.10000000000001 +lon_0=0 +k_0=0.9998774990000001 +x_0=600000 +y_0=200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ",27594:"+title=NTF (Paris) / Corse (deprecated) +proj=lcc +lat_1=42.16500000000001 +lat_0=42.16500000000001 +lon_0=0 +k_0=0.9999447100000001 +x_0=234.358 +y_0=185861.369 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ",32601:"+proj=utm +zone=1 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32602:"+proj=utm +zone=2 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32603:"+proj=utm +zone=3 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32604:"+proj=utm +zone=4 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32605:"+proj=utm +zone=5 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32606:"+proj=utm +zone=6 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32607:"+proj=utm +zone=7 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32608:"+proj=utm +zone=8 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32609:"+proj=utm +zone=9 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32610:"+proj=utm +zone=10 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32611:"+proj=utm +zone=11 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32612:"+proj=utm +zone=12 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32613:"+proj=utm +zone=13 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32614:"+proj=utm +zone=14 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32615:"+proj=utm +zone=15 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32616:"+proj=utm +zone=16 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32617:"+proj=utm +zone=17 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32618:"+proj=utm +zone=18 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32619:"+proj=utm +zone=19 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32620:"+proj=utm +zone=20 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32621:"+proj=utm +zone=21 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32622:"+proj=utm +zone=22 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32623:"+proj=utm +zone=23 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32624:"+proj=utm +zone=24 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32625:"+proj=utm +zone=25 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32626:"+proj=utm +zone=26 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32627:"+proj=utm +zone=27 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32628:"+proj=utm +zone=28 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32629:"+proj=utm +zone=29 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32630:"+proj=utm +zone=30 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32631:"+proj=utm +zone=31 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32632:"+proj=utm +zone=32 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32633:"+proj=utm +zone=33 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32634:"+proj=utm +zone=34 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32635:"+proj=utm +zone=35 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32636:"+proj=utm +zone=36 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32637:"+proj=utm +zone=37 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32638:"+proj=utm +zone=38 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32639:"+proj=utm +zone=39 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32640:"+proj=utm +zone=40 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32641:"+proj=utm +zone=41 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32642:"+proj=utm +zone=42 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32643:"+proj=utm +zone=43 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32644:"+proj=utm +zone=44 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32645:"+proj=utm +zone=45 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32646:"+proj=utm +zone=46 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32647:"+proj=utm +zone=47 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32648:"+proj=utm +zone=48 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32649:"+proj=utm +zone=49 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32650:"+proj=utm +zone=50 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32651:"+proj=utm +zone=51 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32652:"+proj=utm +zone=52 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32653:"+proj=utm +zone=53 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32654:"+proj=utm +zone=54 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32655:"+proj=utm +zone=55 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32656:"+proj=utm +zone=56 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32657:"+proj=utm +zone=57 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32658:"+proj=utm +zone=58 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32659:"+proj=utm +zone=59 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32660:"+proj=utm +zone=60 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32661:"+proj=stere +lat_0=90 +lat_ts=90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32662:"+title=WGS 84 / Plate Carree +proj=eqc +lat_ts=0 +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32701:"+proj=utm +zone=1 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32702:"+proj=utm +zone=2 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32703:"+proj=utm +zone=3 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32704:"+proj=utm +zone=4 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32705:"+proj=utm +zone=5 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32706:"+proj=utm +zone=6 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32707:"+proj=utm +zone=7 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32708:"+proj=utm +zone=8 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32709:"+proj=utm +zone=9 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32710:"+proj=utm +zone=10 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32711:"+proj=utm +zone=11 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32712:"+proj=utm +zone=12 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32713:"+proj=utm +zone=13 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32714:"+proj=utm +zone=14 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32715:"+proj=utm +zone=15 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32716:"+proj=utm +zone=16 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32717:"+proj=utm +zone=17 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32718:"+proj=utm +zone=18 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32719:"+proj=utm +zone=19 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32720:"+proj=utm +zone=20 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32721:"+proj=utm +zone=21 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32722:"+proj=utm +zone=22 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32723:"+proj=utm +zone=23 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32724:"+proj=utm +zone=24 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32725:"+proj=utm +zone=25 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32726:"+proj=utm +zone=26 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32727:"+proj=utm +zone=27 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32728:"+proj=utm +zone=28 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32729:"+proj=utm +zone=29 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32730:"+proj=utm +zone=30 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32731:"+proj=utm +zone=31 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32732:"+proj=utm +zone=32 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32733:"+proj=utm +zone=33 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32734:"+proj=utm +zone=34 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32735:"+proj=utm +zone=35 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32736:"+proj=utm +zone=36 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32737:"+proj=utm +zone=37 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32738:"+proj=utm +zone=38 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32739:"+proj=utm +zone=39 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32740:"+proj=utm +zone=40 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32741:"+proj=utm +zone=41 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32742:"+proj=utm +zone=42 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32743:"+proj=utm +zone=43 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32744:"+proj=utm +zone=44 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32745:"+proj=utm +zone=45 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32746:"+proj=utm +zone=46 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32747:"+proj=utm +zone=47 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32748:"+proj=utm +zone=48 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32749:"+proj=utm +zone=49 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32750:"+proj=utm +zone=50 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32751:"+proj=utm +zone=51 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32752:"+proj=utm +zone=52 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32753:"+proj=utm +zone=53 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32754:"+proj=utm +zone=54 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32755:"+proj=utm +zone=55 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32756:"+proj=utm +zone=56 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32757:"+proj=utm +zone=57 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32758:"+proj=utm +zone=58 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32759:"+proj=utm +zone=59 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32760:"+proj=utm +zone=60 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",32761:"+proj=stere +lat_0=-90 +lat_ts=-90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ",310024802:"+title=Geoportail - France metropolitaine +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=46.500000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs",310915814:"+title=Geoportail - Antilles francaises +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=15.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs",310486805:"+title=Geoportail - Guyane +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=4.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs",310700806:"+title=Geoportail - Reunion et dependances +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-21.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs",310702807:"+title=Geoportail - Mayotte +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-12.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs",310706808:"+title=Geoportail - Saint-Pierre et Miquelon +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=47.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs",310547809:"+title=Geoportail - Nouvelle-Caledonie +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-22.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs",310642810:"+title=Geoportail - Wallis et Futuna +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.000000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-14.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs",310032811:"+title=Geoportail - Polynesie francaise +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-15.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs",310642812:"+title=Geoportail - Kerguelen +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-49.500000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs",310642801:"+title=Geoportail - Crozet +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-46.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs",310642813:"+title=Geoportail - Amsterdam et Saint-Paul +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-38.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs",310642901:"+title=Geoportail - Monde +proj=mill +towgs84=0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.000000 +a=6378137.0000 +rf=298.2572221010000 +lon_0=0.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs",5489:"+title=RGAF09 geographiques (dms) +proj=longlat +nadgrids=@null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137 +rf=298.257222101 +units=m +no_defs",5490:"+title=RGAF09 UTM Nord Fuseau 20 +proj=tmerc +nadgrids=@null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137 +rf=298.257222101 +lat_0=0.000000000 +lon_0=-63.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs"},CRS:{84:"+title=WGS 84 longitude-latitude +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs "},IGNF:{AMST63:"+title=Amsterdam 1963 +proj=geocent +towgs84=109.753,-528.133,-362.244,0,0,0,0 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs",CROZ63:"+title=Crozet 1963 +proj=geocent +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs",CSG67:"+title=Guyane CSG67 +proj=geocent +towgs84=-193.0660,236.9930,105.4470,0.4814,-0.8074,0.1276,1.564900 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs",ED50:"+title=ED50 +proj=geocent +towgs84=-84.0000,-97.0000,-117.0000 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs",ETRS89:"+title=Systeme de reference terrestre Europeen (1989) +proj=geocent +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs",GUAD48:"+title=Guadeloupe Ste Anne +proj=geocent +towgs84=-472.2900,-5.6300,-304.1200,0.4362,-0.8374,0.2563,1.898400 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs",GUADFM49:"+title=Guadeloupe Fort Marigot +proj=geocent +towgs84=136.5960,248.1480,-429.7890 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs",IGN63:"+title=IGN 1963 (Hiva Oa, Tahuata, Mohotani) +proj=geocent +towgs84=410.7210,55.0490,80.7460,-2.5779,-2.3514,-0.6664,17.331100 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs",IGN72:"+title=IGN 1972 Grande-Terre / Ile des Pins +proj=geocent +towgs84=-11.6400,-348.6000,291.6800 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs",KERG62CAR:"+title=Kerguelen - K0 +proj=geocent +towgs84=144.8990,-186.7700,100.9230 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs",MART38:"+title=Martinique Fort-Desaix +proj=geocent +towgs84=126.9260,547.9390,130.4090,-2.7867,5.1612,-0.8584,13.822650 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs",MAYO50:"+title=Mayotte Combani +proj=geocent +towgs84=-599.9280,-275.5520,-195.6650,-0.0835,-0.4715,0.0602,49.281400 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs",MOOREA87:"+title=Moorea 1987 +proj=geocent +towgs84=215.9820,149.5930,176.2290,3.2624,1.6920,1.1571,10.477300 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs",NTF:"+title=Nouvelle Triangulation Francaise +proj=geocent +nadgrids=ntf_r93.gsb,null +wktext +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +units=m +no_defs",NUKU72:"+title=IGN 1972 Nuku Hiva +proj=geocent +towgs84=165.7320,216.7200,180.5050,-0.6434,-0.4512,-0.0791,7.420400 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs",REUN47:"+title=Reunion 1947 +proj=geocent +towgs84=789.5240,-626.4860,-89.9040,0.6006,76.7946,-10.5788,-32.324100 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs",RGF93:"+title=Reseau geodesique francais 1993 +proj=geocent +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs",RGFG95:"+title=Reseau geodesique francais de Guyane 1995 +proj=geocent +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs",RGM04:"+title=RGM04 (Reseau Geodesique de Mayotte 2004) +proj=geocent +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs",RGNC:"+title=Reseau Geodesique de Nouvelle-Caledonie +proj=geocent +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs",RGPF:"+title=RGPF (Reseau Geodesique de Polynesie Francaise) +proj=geocent +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs",RGR92:"+title=Reseau geodesique Reunion 1992 +proj=geocent +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs",RGSPM06:"+title=Reseau Geodesique Saint-Pierre-et-Miquelon (2006) +proj=geocent +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs",RGTAAF07:"+title=Reseau Geodesique des TAAF (2007) +proj=geocent +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs",RRAF91:"+title=RRAF 1991 (Reseau de Reference des Antilles Francaises) +proj=geocent +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs",STPL69:"+title=Saint-Paul 1969 +proj=geocent +towgs84=225.571,-346.608,-46.567,0,0,0,0 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs",STPM50:"+title=St Pierre et Miquelon 1950 +proj=geocent +towgs84=-95.5930,573.7630,173.4420,-0.9602,1.2510,-1.3918,42.626500 +a=6378206.4000 +rf=294.9786982000000 +units=m +no_defs",TAHAA:"+title=Raiatea - Tahaa 51-54 (Tahaa, Base Terme Est) +proj=geocent +towgs84=72.4380,345.9180,79.4860,-1.6045,-0.8823,-0.5565,1.374600 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs",TAHI79:"+title=IGN79 (Tahiti) Iles de la Societe +proj=geocent +towgs84=221.5250,152.9480,176.7680,2.3847,1.3896,0.8770,11.474100 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs",TERA50:"+title=Pointe Geologie - Perroud 1950 +proj=geocent +towgs84=324.9120,153.2820,172.0260 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs",WALL78:"+title=Wallis-Uvea 1978 (MOP78) +proj=geocent +towgs84=253.0000,-133.0000,-127.0000 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs",WGS72:"+title=World Geodetic System 1972 +proj=geocent +towgs84=0.0000,12.0000,6.0000 +a=6378135.0000 +rf=298.2600000000000 +units=m +no_defs",WGS84:"+title=World Geodetic System 1984 +proj=geocent +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs",AMST63GEO:"+title=Amsterdam 1963 +proj=longlat +towgs84=109.753,-528.133,-362.244,0,0,0,0 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs",CROZ63GEO:"+title=Crozet 1963 +proj=longlat +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs",CSG67GEO:"+title=Guyane CSG67 +proj=longlat +towgs84=-193.0660,236.9930,105.4470,0.4814,-0.8074,0.1276,1.564900 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs",ED50G:"+title=ED50 +proj=longlat +towgs84=-84.0000,-97.0000,-117.0000 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs",GUAD48GEO:"+title=Guadeloupe Ste Anne +proj=longlat +towgs84=-472.2900,-5.6300,-304.1200,0.4362,-0.8374,0.2563,1.898400 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs",GUADFM49GEO:"+title=Guadeloupe Fort Marigot +proj=longlat +towgs84=136.5960,248.1480,-429.7890 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs",IGN63GEO:"+title=IGN 1963 (Hiva Oa, Tahuata, Mohotani) +proj=longlat +towgs84=410.7210,55.0490,80.7460,-2.5779,-2.3514,-0.6664,17.331100 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs",IGN72GEO:"+title=IGN 1972 Grande-Terre / Ile des Pins +proj=longlat +towgs84=-11.6400,-348.6000,291.6800 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs",KERG62GEO:"+title=Kerguelen - K0 +proj=longlat +towgs84=144.8990,-186.7700,100.9230 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs",MART38GEO:"+title=Martinique Fort-Desaix +proj=longlat +towgs84=126.9260,547.9390,130.4090,-2.7867,5.1612,-0.8584,13.822650 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs",MAYO50GEO:"+title=Mayotte Combani +proj=longlat +towgs84=-599.9280,-275.5520,-195.6650,-0.0835,-0.4715,0.0602,49.281400 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs",MOOREA87GEO:"+title=Moorea 1987 +proj=longlat +towgs84=215.9820,149.5930,176.2290,3.2624,1.6920,1.1571,10.477300 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs",NTFG:"+title=Nouvelle Triangulation Francaise Greenwich degres sexagesimaux +proj=longlat +nadgrids=ntf_r93.gsb,null +wktext +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +units=m +no_defs",NTFP:"+title=Nouvelle Triangulation Francaise Paris grades +proj=longlat +nadgrids=ntf_r93.gsb,null +wktext +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +pm=2.337229167 +units=m +no_defs",NUKU72GEO:"+title=IGN 1972 Nuku Hiva +proj=longlat +towgs84=165.7320,216.7200,180.5050,-0.6434,-0.4512,-0.0791,7.420400 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs",REUN47GEO:"+title=Reunion 1947 +proj=longlat +towgs84=789.5240,-626.4860,-89.9040,0.6006,76.7946,-10.5788,-32.324100 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs",RGF93G:"+title=Reseau geodesique francais 1993 +proj=longlat +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs",RGFG95GEO:"+title=Reseau geodesique francais de Guyane 1995 +proj=longlat +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs",RGM04GEO:"+title=RGM04 (Reseau Geodesique de Mayotte 2004) +proj=longlat +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs",RGNCGEO:"+title=Reseau Geodesique de Nouvelle-Caledonie +proj=longlat +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs",RGPFGEO:"+title=RGPF (Reseau Geodesique de Polynesie Francaise) +proj=longlat +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs",RGR92GEO:"+title=Reseau geodesique de la Reunion 1992 +proj=longlat +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs",RGSPM06GEO:"+title=Saint-Pierre-et-Miquelon (2006) +proj=longlat +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs",RGTAAF07G:"+title=Reseau Geodesique des TAAF (2007) (dms) +proj=longlat +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs",STPL69GEO:"+title=Saint-Paul 1969 +proj=longlat +towgs84=225.571,-346.608,-46.567,0,0,0,0 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs",STPM50GEO:"+title=St Pierre et Miquelon 1950  +proj=longlat +towgs84=-95.5930,573.7630,173.4420,-0.9602,1.2510,-1.3918,42.626500 +a=6378206.4000 +rf=294.9786982000000 +units=m +no_defs",TAHAAGEO:"+title=Raiatea - Tahaa 51-54 (Tahaa, Base Terme Est) +proj=longlat +towgs84=72.4380,345.9180,79.4860,-1.6045,-0.8823,-0.5565,1.374600 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs",TAHI79GEO:"+title=IGN79 (Tahiti) Iles de la Societe +proj=longlat +towgs84=221.5250,152.9480,176.7680,2.3847,1.3896,0.8770,11.474100 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs",TERA50G:"+title=Pointe Geologie - Perroud 1950 +proj=longlat +towgs84=324.9120,153.2820,172.0260 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs",WALL78GEO:"+title=Wallis - Uvea 1978 (MOP78) +proj=longlat +towgs84=253.0000,-133.0000,-127.0000 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs",WGS72G:"+title=WGS72 +proj=longlat +towgs84=0.0000,12.0000,6.0000 +a=6378135.0000 +rf=298.2600000000000 +units=m +no_defs",WGS84G:"+title=World Geodetic System 1984 +proj=longlat +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs",WGS84RRAFGEO:"+title=Reseau de reference des Antilles francaises (1988-1991) +proj=longlat +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs",XGEO:"+title=Systeme CIO-BIH +proj=longlat +towgs84=0.0000,0.0000,0.5000,0.0000,0.0000,0.0140,-0.100000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs",AMST63UTM43S:"+title=Amsterdam 1963 UTM fuseau 43 Sud +proj=tmerc +towgs84=109.753,-528.133,-362.244,0,0,0,0 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=75.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs",CROZ63UTM39S:"+title=Crozet 1963 +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=51.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs",CSG67UTM21:"+title=Guyane CSG67 UTM fuseau 21 +proj=tmerc +towgs84=-193.0660,236.9930,105.4470,0.4814,-0.8074,0.1276,1.564900 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-57.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs",CSG67UTM22:"+title=Guyane CSG67 UTM fuseau 22 +proj=tmerc +towgs84=-193.0660,236.9930,105.4470,0.4814,-0.8074,0.1276,1.564900 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-51.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs",GEOPORTALANF:"+title=Geoportail - Antilles francaises +proj=eqc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=15.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs",GEOPORTALASP:"+title=Geoportail - Amsterdam et Saint-Paul +proj=eqc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-38.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs",GEOPORTALCRZ:"+title=Geoportail - Crozet +proj=eqc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-46.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs",GEOPORTALFXX:"+title=Geoportail - France metropolitaine +proj=eqc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=46.500000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs",GEOPORTALGUF:"+title=Geoportail - Guyane +proj=eqc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=4.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs",GEOPORTALKER:"+title=Geoportail - Kerguelen +proj=eqc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-49.500000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs",GEOPORTALMYT:"+title=Geoportail - Mayotte +proj=eqc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-12.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs",GEOPORTALNCL:"+title=Geoportail - Nouvelle-Caledonie +proj=eqc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-22.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs",GEOPORTALPYF:"+title=Geoportail - Polynesie francaise +proj=eqc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-15.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs",GEOPORTALREU:"+title=Geoportail - Reunion et dependances +proj=eqc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-21.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs",GEOPORTALSPM:"+title=Geoportail - Saint-Pierre et Miquelon +proj=eqc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=47.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs",GEOPORTALWLF:"+title=Geoportail - Wallis et Futuna +proj=eqc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-14.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs",GUAD48UTM20:"+title=Guadeloupe Ste Anne +proj=tmerc +towgs84=-472.2900,-5.6300,-304.1200,0.4362,-0.8374,0.2563,1.898400 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-63.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs",GUADFM49U20:"+title=Guadeloupe Fort Marigot  +proj=tmerc +towgs84=136.5960,248.1480,-429.7890 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-63.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs",IGN63UTM7S:"+title=IGN 1963 - Hiva Oa, Tahuata, Mohotani - UTM fuseau 7 Sud +proj=tmerc +towgs84=410.7210,55.0490,80.7460,-2.5779,-2.3514,-0.6664,17.331100 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-141.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs",IGN72UTM58S:"+title=IGN 1972 - UTM fuseau 58 Sud +proj=tmerc +towgs84=-11.6400,-348.6000,291.6800 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=165.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs",KERG62UTM42S:"+title=Kerguelen 1962 +proj=tmerc +towgs84=144.8990,-186.7700,100.9230 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=69.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs",LAMB1:"+title=Lambert I +proj=lcc +nadgrids=ntf_r93.gsb,null +wktext +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +pm=2.337229167 +lat_0=49.500000000 +lon_0=0.000000000 +k_0=0.99987734 +lat_1=49.500000000 +x_0=600000.000 +y_0=200000.000 +units=m +no_defs",LAMB1C:"+title=Lambert I Carto +proj=lcc +nadgrids=ntf_r93.gsb,null +wktext +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +pm=2.337229167 +lat_0=49.500000000 +lon_0=0.000000000 +k_0=0.99987734 +lat_1=49.500000000 +x_0=600000.000 +y_0=1200000.000 +units=m +no_defs",LAMB2:"+title=Lambert II +proj=lcc +nadgrids=ntf_r93.gsb,null +wktext +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +pm=2.337229167 +lat_0=46.800000000 +lon_0=0.000000000 +k_0=0.99987742 +lat_1=46.800000000 +x_0=600000.000 +y_0=200000.000 +units=m +no_defs",LAMB2C:"+title=Lambert II Carto +proj=lcc +nadgrids=ntf_r93.gsb,null +wktext +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +pm=2.337229167 +lat_0=46.800000000 +lon_0=0.000000000 +k_0=0.99987742 +lat_1=46.800000000 +x_0=600000.000 +y_0=2200000.000 +units=m +no_defs",LAMB3:"+title=Lambert III +proj=lcc +nadgrids=ntf_r93.gsb,null +wktext +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +pm=2.337229167 +lat_0=44.100000000 +lon_0=0.000000000 +k_0=0.99987750 +lat_1=44.100000000 +x_0=600000.000 +y_0=200000.000 +units=m +no_defs",LAMB3C:"+title=Lambert III Carto +proj=lcc +nadgrids=ntf_r93.gsb,null +wktext +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +pm=2.337229167 +lat_0=44.100000000 +lon_0=0.000000000 +k_0=0.99987750 +lat_1=44.100000000 +x_0=600000.000 +y_0=3200000.000 +units=m +no_defs",LAMB4:"+title=Lambert IV +proj=lcc +nadgrids=ntf_r93.gsb,null +wktext +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +pm=2.337229167 +lat_0=42.165000000 +lon_0=0.000000000 +k_0=0.99994471 +lat_1=42.165000000 +x_0=234.358 +y_0=185861.369 +units=m +no_defs",LAMB4C:"+title=Lambert IV Carto +proj=lcc +nadgrids=ntf_r93.gsb,null +wktext +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +pm=2.337229167 +lat_0=42.165000000 +lon_0=0.000000000 +k_0=0.99994471 +lat_1=42.165000000 +x_0=234.358 +y_0=4185861.369 +units=m +no_defs",LAMB93:"+title=Lambert 93 +proj=lcc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=46.500000000 +lon_0=3.000000000 +lat_1=44.000000000 +lat_2=49.000000000 +x_0=700000.000 +y_0=6600000.000 +units=m +no_defs",RGF93CC42:"+title=Lambert conique conforme Zone 1 +proj=lcc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=42.000000000 +lon_0=3.000000000 +lat_1=41.200000000 +lat_2=42.800000000 +x_0=1700000.000 +y_0=1200000.000 +units=m +no_defs",RGF93CC43:"+title=Lambert conique conforme Zone 2 +proj=lcc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=43.000000000 +lon_0=3.000000000 +lat_1=42.200000000 +lat_2=43.800000000 +x_0=1700000.000 +y_0=2200000.000 +units=m +no_defs",RGF93CC44:"+title=Lambert conique conforme Zone 3 +proj=lcc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=44.000000000 +lon_0=3.000000000 +lat_1=43.200000000 +lat_2=44.800000000 +x_0=1700000.000 +y_0=3200000.000 +units=m +no_defs",RGF93CC45:"+title=Lambert conique conforme Zone 4 +proj=lcc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=45.000000000 +lon_0=3.000000000 +lat_1=44.200000000 +lat_2=45.800000000 +x_0=1700000.000 +y_0=4200000.000 +units=m +no_defs",RGF93CC46:"+title=Lambert conique conforme Zone 5 +proj=lcc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=46.000000000 +lon_0=3.000000000 +lat_1=45.200000000 +lat_2=46.800000000 +x_0=1700000.000 +y_0=5200000.000 +units=m +no_defs",RGF93CC47:"+title=Lambert conique conforme Zone 6 +proj=lcc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=47.000000000 +lon_0=3.000000000 +lat_1=46.200000000 +lat_2=47.800000000 +x_0=1700000.000 +y_0=6200000.000 +units=m +no_defs",RGF93CC48:"+title=Lambert conique conforme Zone 7 +proj=lcc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=48.000000000 +lon_0=3.000000000 +lat_1=47.200000000 +lat_2=48.800000000 +x_0=1700000.000 +y_0=7200000.000 +units=m +no_defs",RGF93CC49:"+title=Lambert conique conforme Zone 8 +proj=lcc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=49.000000000 +lon_0=3.000000000 +lat_1=48.200000000 +lat_2=49.800000000 +x_0=1700000.000 +y_0=8200000.000 +units=m +no_defs",RGF93CC50:"+title=Lambert conique conforme Zone 9 +proj=lcc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=50.000000000 +lon_0=3.000000000 +lat_1=49.200000000 +lat_2=50.800000000 +x_0=1700000.000 +y_0=9200000.000 +units=m +no_defs",LAMBE:"+title=Lambert II etendu +proj=lcc +nadgrids=ntf_r93.gsb,null +wktext +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +pm=2.337229167 +lat_0=46.800000000 +lon_0=0.000000000 +k_0=0.99987742 +lat_1=46.800000000 +x_0=600000.000 +y_0=2200000.000 +units=m +no_defs",MART38UTM20:"+title=Martinique Fort-Desaix +proj=tmerc +towgs84=126.9260,547.9390,130.4090,-2.7867,5.1612,-0.8584,13.822650 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-63.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs",MAYO50UTM38S:"+title=Mayotte Combani +proj=tmerc +towgs84=-599.9280,-275.5520,-195.6650,-0.0835,-0.4715,0.0602,49.281400 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=45.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs",MILLER:"+title=Geoportail - Monde +proj=mill +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lon_0=0.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs",MOOREA87U6S:"+title=Moorea 1987 - UTM fuseau 6 Sud +proj=tmerc +towgs84=215.9820,149.5930,176.2290,3.2624,1.6920,1.1571,10.477300 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-147.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs",NUKU72U7S:"+title=IGN 1972 Nuku Hiva - UTM fuseau 7 Sud +proj=tmerc +towgs84=165.7320,216.7200,180.5050,-0.6434,-0.4512,-0.0791,7.420400 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-141.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs",RGM04UTM38S:"+title=UTM fuseau 38 Sud (Reseau Geodesique de Mayotte 2004) +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=45.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs",RGNCUTM57S:"+title=Reseau Geodesique de Nouvelle-Caledonie - UTM fuseau 57 Sud +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=159.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs",RGNCUTM58S:"+title=Reseau Geodesique de Nouvelle-Caledonie - UTM fuseau 58 Sud +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=165.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs",RGNCUTM59S:"+title=Reseau Geodesique de Nouvelle-Caledonie - UTM fuseau 59 Sud +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=171.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs",RGPFUTM5S:"+title=RGPF - UTM fuseau 5 Sud +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-153.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs",RGPFUTM6S:"+title=RGPF - UTM fuseau 6 Sud +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-147.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs",RGPFUTM7S:"+title=RGPF - UTM fuseau 7 Sud +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-141.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs",RGR92UTM40S:"+title=RGR92 UTM fuseau 40 Sud +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=57.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs",RGSPM06U21:"+title=Saint-Pierre-et-Miquelon (2006) UTM Fuseau 21 Nord +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-57.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs",STPL69UTM43S:"+title=Saint-Paul 1969 UTM fuseau 43 Sud +proj=tmerc +towgs84=225.571,-346.608,-46.567,0,0,0,0 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=75.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs",STPM50UTM21:"+title=St Pierre et Miquelon 1950 +proj=tmerc +towgs84=-95.5930,573.7630,173.4420,-0.9602,1.2510,-1.3918,42.626500 +a=6378206.4000 +rf=294.9786982000000 +lat_0=0.000000000 +lon_0=-57.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs",TAHAAUTM05S:"+title=Tahaa 1951 +proj=tmerc +towgs84=72.4380,345.9180,79.4860,-1.6045,-0.8823,-0.5565,1.374600 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-153.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs",TAHI51UTM06S:"+title=Tahiti-Terme Nord UTM fuseau 6 Sud +proj=tmerc +towgs84=162.0000,117.0000,154.0000 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-147.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs",TAHI79UTM6S:"+title=Tahiti 1979 +proj=tmerc +towgs84=221.5250,152.9480,176.7680,2.3847,1.3896,0.8770,11.474100 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-147.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs",TERA50STEREO:"+title=Terre Adelie 1950 +proj=stere +towgs84=324.9120,153.2820,172.0260 +a=6378388.0000 +rf=297.0000000000000 +lat_0=-90.000000000 +lon_0=140.000000000 +lat_ts=-67 +k=0.96027295 +x_0=300000.000 +y_0=-2299363.482 +units=m +no_defs",UTM01SW84:"+title=World Geodetic System 1984 UTM fuseau 01 Sud +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-177.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs",UTM20W84GUAD:"+title=World Geodetic System 1984 UTM fuseau 20 Nord-Guadeloupe +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-63.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs",UTM20W84MART:"+title=World Geodetic System 1984 UTM fuseau 20 Nord-Martinique +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-63.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs",UTM22RGFG95:"+title=RGFG95 UTM fuseau 22 Nord-Guyane +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-51.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs",UTM39SW84:"+title=World Geodetic System 1984 UTM fuseau 39 Sud +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=51.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs",UTM42SW84:"+title=World Geodetic System 1984 UTM fuseau 42 Sud +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=69.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs",UTM43SW84:"+title=World Geodetic System 1984 UTM fuseau 43 Sud +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=75.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs",WALL78UTM1S:"+title=Wallis-Uvea 1978 (MOP78) UTM 1 SUD +proj=tmerc +towgs84=253.0000,-133.0000,-127.0000 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-177.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs",ETRS89GEO:"+title=ETRS89 geographiques (dms) +proj=longlat +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs",ETRS89LAEA:"+title=ETRS89 Lambert Azimutal Equal Area +proj=laea +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=52.000000000 +lon_0=10.000000000 +x_0=4321000.000 +y_0=3210000.000 +units=m +no_defs",ETRS89LCC:"+title=ETRS89 Lambert Conformal Conic +proj=lcc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=52.000000000 +lon_0=9.999999995 +lat_1=35.000000000 +lat_2=65.000000000 +x_0=4000000.000 +y_0=2800000.000 +units=m +no_defs",UTM26ETRS89:"+title=Europe - de 30d a 24d Ouest +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-27.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs",UTM27ETRS89:"+title=Europe - de 24d a 18d Ouest +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-21.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs",UTM28ETRS89:"+title=Europe - de 18d a 12d Ouest +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-15.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs",UTM29ETRS89:"+title=Europe - de 12d a 6d Ouest +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-9.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs",UTM30ETRS89:"+title=Europe - de -6d a 0d Ouest +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-3.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs",UTM31ETRS89:"+title=Europe - de 0d a 6d Est +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=3.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs",UTM32ETRS89:"+title=Europe - de 6d a 12d Est +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=9.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs",UTM33ETRS89:"+title=Europe - de 12d a 18d Est +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=15.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs",UTM34ETRS89:"+title=Europe - de 18d a 24d Est +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=21.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs",UTM35ETRS89:"+title=Europe - de 24d a 30d Est +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=27.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs",UTM36ETRS89:"+title=Europe - de 30d a 36d Est +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=33.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs",UTM37ETRS89:"+title=Europe - de 36d a 42d Est +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=39.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs",UTM38ETRS89:"+title=Europe - de 42d a 48d Est +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=45.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs"}},logger$z=LoggerByDefault.getLogger("CRS"),CRS={projectionsExtent:{"EPSG:2154":{left:-9.62,bottom:41.18,right:10.3,top:51.54},"EPSG:27572":{left:-4.87,bottom:42.33,right:8.23,top:51.14}},load:function(){if(logger$z.trace("Loading custom definitions projections"),!Register.isLoaded){Register.load(proj4);try{register(proj4),window.ol&&window.ol.proj&&window.ol.proj.proj4&&(window.ol.proj.proj4.register=register,window.ol.proj.proj4.register(proj4))}catch(_t){logger$z.error(_t)}}},loadByDefault:function(){if(logger$z.trace("Loading custom definitions projections by default"),!Register.isLoaded){Register.loadByDefault(proj4);try{register(proj4),window.ol&&window.ol.proj&&window.ol.proj.proj4&&(window.ol.proj.proj4.register=register,window.ol.proj.proj4.register(proj4))}catch(_t){logger$z.error(_t)}}},loadByName:function(_t){if(logger$z.trace("Loading a custom definition projection : ",_t),!Register.isLoaded){Register.loadByName(proj4,_t);try{register(proj4),window.ol&&window.ol.proj&&window.ol.proj.proj4&&(window.ol.proj.proj4.register=register,window.ol.proj.proj4.register(proj4))}catch(e){logger$z.error(e)}}},overload:function(){logger$z.trace("Loading projections aera (extent)");for(var _t in this.projectionsExtent)if(this.projectionsExtent.hasOwnProperty(_t)){var e=this.projectionsExtent[_t],n=get$3(_t),ei=getTransform("EPSG:4326",n),ti=applyTransform([e.bottom,e.right,e.top,e.left],ei);n.setExtent(ti),addProjection(n),window.ol&&window.ol.proj&&window.ol.proj.addProjection&&window.ol.proj.addProjection(n)}}};window.ol&&window.ol.proj&&window.ol.proj.proj4&&(window.ol.proj.proj4.register=register);let m_suggestions=[],controller=new AbortController,m_index="geoplateforme",m_fields="title,layer_name",m_size="1000",m_maximumResponses=10,m_filterByService=["WMTS","TMS"],m_filterByProjection=[],m_filterByLayerPriority=[],m_filterWMTSPriority=!1,m_filterTMS=!0,m_url=`https://data.geopf.fr/recherche/api/indexes/${m_index}/suggest`;const target=new EventTarget,suggest=async _t=>{clear(),controller=new AbortController;let e=new URL(m_url),n={text:_t,fields:m_fields,size:m_size};Object.keys(n).forEach(si=>e.searchParams.append(si,n[si]));var ei=await fetch(e,{}),ti=await ei.json();if(ei.status!==200)throw new Error(ei.message);if(!(!ti||ti.length===0)){for(let si=0;si<ti.length;si++){const ai=ti[si];m_filterByLayerPriority.findIndex(li=>li.includes(ai.source.layer_name))>=0&&(ti[si].score+=100)}ti.sort((si,ai)=>ai.score-si.score);var ii=null;m_filterWMTSPriority&&(ii=inventory(ti));for(let si=0;si<ti.length;si++){const ai=ti[si];var ri=m_filterByService.length===0||m_filterByService.includes(ai.source.type);if(ri){if(unique().length>=m_maximumResponses)break;var ni={attribution:ai.source.attribution||{},srs:ai.source.srs||[],keywords:ai.source.keywords||[],extent:ai.source.extent||{},metadata:ai.source.metadata_urls||[],name:ai.source.layer_name||"",title:ai.source.title||"",description:ai.source.description,service:ai.source.type||"",url:ai.source.url||"",tech:ai.source.tech||{},tags:ai.source.tags||{},theme:ai.source.theme||"",producer:ai.source.producer||""};if(m_filterByProjection.length&&m_filterByProjection.includes(ni.srs[0])||ii&&ii[ni.name]&&ni.service==="WMS"||ni.service==="TMS"&&(ni.styles=!1,ni.metadata.length!==0&&/(\.json)$/i.test(ni.metadata[0])&&(ni.styles=!0),!ni.styles&&m_filterTMS)||ni.service==="WMTS"&&ni.metadata.length!==0&&/(.json)$/i.test(ni.metadata[0])&&m_filterTMS===!0)continue;m_suggestions.push(ni)}}return target.dispatchEvent(new CustomEvent("suggest",{bubbles:!0,detail:getSuggestions()})),getSuggestions()}},unique=()=>m_suggestions.filter((_t,e,n)=>e===n.findIndex(ei=>ei.service===_t.service&&ei.name===_t.name&&ei.title===_t.title&&ei.description===_t.description)),clear=()=>{controller.abort(),m_suggestions=[]},inventory=_t=>{var e={};for(let n=0;n<_t.length;n++){const ei=_t[n].source.type,ti=_t[n].source.layer_name;(ei==="WMTS"||ei==="WMS")&&(e[ti]===void 0&&(e[ti]=ei==="WMTS"),e[ti]||(e[ti]=ei==="WMTS"))}return e},getSuggestions=()=>unique(),getNames=()=>unique().map(_t=>_t.name),getTitles=()=>unique().map(_t=>_t.title),setIndex=_t=>{m_index=_t},setFields=_t=>{m_fields=_t},setSuggestions=_t=>{m_suggestions=_t},setSize=_t=>{m_size=parseInt(_t)},setUrl=value=>{m_url=eval("`"+value+"`")},setMaximumResponses=_t=>{m_maximumResponses=parseInt(_t)},setFiltersByService=_t=>{m_filterByService=_t===""?[]:_t.split(",")},setFiltersByProjection=_t=>{m_filterByProjection=_t===""?[]:_t.split(",")},setFiltersByLayerPriority=_t=>{m_filterByLayerPriority=_t===""?[]:_t.split(",")},setFilterWMTSPriority=_t=>{m_filterWMTSPriority=_t},setFilterTMS=_t=>{m_filterTMS=_t},Search$1={target,suggest,clear,getSuggestions,getNames,getTitles,setIndex,setFields,setSuggestions,setSize,setUrl,setMaximumResponses,setFiltersByService,setFiltersByProjection,setFiltersByLayerPriority,setFilterWMTSPriority,setFilterTMS};var SearchEngineDOM={_addUID:function(_t){var e=this._uid?_t+"-"+this._uid:_t;return e},_createMainContainerElement:function(){var _t=document.createElement("div");return _t.id=this._addUID("GPsearchEngine"),_t.className="GPwidget gpf-widget",_t},_createSearchDivElement:function(){var _t=document.createElement("div");return _t.id=this._addUID("GPshowSearchDiv"),_t},_createShowSearchEnginePictoElement:function(_t){var e=this;checkDsfr()&&(_t=!0);var n=document.createElement("button");return n.id=this._addUID("GPshowSearchEnginePicto"),n.className="GPshowOpen GPshowAdvancedToolPicto GPshowSearchEnginePicto gpf-btn gpf-btn-icon-search fr-btn",n.title="Afficher/masquer la recherche par lieux",checkDsfr()&&(n.title="Rechercher"),n.setAttribute("tabindex","0"),n.setAttribute("aria-pressed",!_t),n.disabled=!_t,n.setAttribute("type","button"),n.addEventListener("click",function(ei){if(checkDsfr()){var ti=document.getElementById(e._addUID("GPautocompleteResults")),ii=ti.getElementsByClassName("GPautoCompleteProposal gpf-panel__items gpf-panel__items_searchengine current"),ri=ti.getElementsByClassName("GPautoCompleteProposal gpf-panel__items gpf-panel__items_searchengine"),ni=ri.length;if(!ni)return;var si=null;ii.length?si=ii[0]:(si=ri[0],si.className="GPautoCompleteProposal gpf-panel__items gpf-panel__items_searchengine current",si.style.color="#000000",si.style["background-color"]="#CEDBEF"),si.click();return}var ai=ei.target.ariaPressed==="true";ei.target.setAttribute("aria-pressed",!ai),document.getElementById(e._addUID("GPautoCompleteList")).classList.replace("GPelementVisible","GPelementHidden"),document.getElementById(e._addUID("GPautoCompleteList")).classList.replace("gpf-visible","gpf-hidden"),document.getElementById(e._addUID("GPgeocodeResultsList")).classList.replace("GPelementVisible","GPelementHidden"),document.getElementById(e._addUID("GPgeocodeResultsList")).classList.replace("gpf-visible","gpf-hidden");var oi=document.getElementById(e._addUID("GPshowAdvancedSearch"));oi&&(oi.style.display=null,document.getElementById(e._addUID("GPadvancedSearchPanel")).classList.replace("GPelementVisible","GPelementHidden"),document.getElementById(e._addUID("GPadvancedSearchPanel")).classList.replace("gpf-visible","gpf-hidden"));var li=document.getElementById(e._addUID("GPshowGeolocate"));li&&(li.style.display=null);var ci=document.getElementById(e._addUID("GPshowSearchByCoordinate"));ci&&(ci.style.display=null);var ui="#GPsearchInput-"+e._uid;document.querySelector(ui+" input").disabled=!1,checkDsfr()&&(document.querySelector("#GPshowSearchEnginePicto-"+e._uid).disabled=!1),e.onShowSearchEngineClick(ei)}),n},_createSearchInputElement:function(_t){var e=this,n=document.createElement("form");n.id=this._addUID("GPsearchInput"),n.className="gpf-panel__content fr-modal__content",n.addEventListener("submit",function(ii){return ii.preventDefault(),document.getElementById(e._addUID("GPsearchInputText")).value===""||(document.getElementById(e._addUID("GPgeocodeResultsList")).classList.replace("GPelementHidden","GPelementVisible"),document.getElementById(e._addUID("GPgeocodeResultsList")).classList.replace("gpf-hidden","gpf-visible"),document.getElementById(e._addUID("GPautoCompleteList")).classList.replace("GPelementVisible","GPelementHidden"),document.getElementById(e._addUID("GPautoCompleteList")).classList.replace("gpf-visible","gpf-hidden"),e.onGeocodingSearchSubmit(ii)),!1});var ei=document.createElement("input");ei.id=this._addUID("GPsearchInputText"),ei.className="GPsearchInputText gpf-input fr-input",ei.type="text",ei.placeholder=_t,ei.autocomplete="off",ei.addEventListener("keyup",function(ii){var ri=ii.which||ii.keyCode;ri===13||ri===10||ri===38||ri===40||(document.getElementById(e._addUID("GPgeocodeResultsList")).classList.replace("GPelementVisible","GPelementHidden"),document.getElementById(e._addUID("GPgeocodeResultsList")).classList.replace("gpf-visible","gpf-hidden"),ei.value.length>2?(document.getElementById(e._addUID("GPautoCompleteList")).classList.replace("GPelementHidden","GPelementVisible"),document.getElementById(e._addUID("GPautoCompleteList")).classList.replace("gpf-hidden","gpf-visible")):(document.getElementById(e._addUID("GPautoCompleteList")).classList.replace("GPelementVisible","GPelementHidden"),document.getElementById(e._addUID("GPautoCompleteList")).classList.replace("gpf-visible","gpf-hidden")),e.onAutoCompleteSearchText(ii))});var ti=null;return document.addEventListener("pointerdown",function(ii){ti=ii.target}),ei.addEventListener("blur",function(ii){ti.classList.contains("GPautoCompleteProposal")||(document.getElementById(e._addUID("GPautoCompleteList")).classList.replace("GPelementVisible","GPelementHidden"),document.getElementById(e._addUID("GPautoCompleteList")).classList.replace("gpf-visible","gpf-hidden"))}),ei.addEventListener("keydown",function(ii){var ri=ii.which||ii.keyCode;ri===13&&ii.preventDefault();var ni=document.getElementById(e._addUID("GPautocompleteResults"));if(ni){var si=ni.getElementsByClassName("GPautoCompleteProposal gpf-panel__items gpf-panel__items_searchengine current"),ai=ni.getElementsByClassName("GPautoCompleteProposal gpf-panel__items gpf-panel__items_searchengine"),oi=ai.length;if(oi){var li=null;if(si.length)li=si[0];else if(li=ai[0],li.className="GPautoCompleteProposal gpf-panel__items gpf-panel__items_searchengine current",li.style.color="#000000",li.style["background-color"]="#CEDBEF",ri!==13)return;var ci=parseInt(SelectorID.index(li.id),10),ui=ci===oi-1?ai[0]:ai[ci+1],di=ci===0?ai[oi-1]:ai[ci-1];switch(li.style["background-color"]="",li.style.color="",di.style["background-color"]="",di.style.color="",ui.style["background-color"]="",ui.style.color="",ri){case 38:li.className="GPautoCompleteProposal gpf-panel__items gpf-panel__items_searchengine",di.className="GPautoCompleteProposal gpf-panel__items gpf-panel__items_searchengine current",di.style.color="#000000",di.style["background-color"]="#CEDBEF",li.scrollIntoView();break;case 40:li.className="GPautoCompleteProposal gpf-panel__items gpf-panel__items_searchengine",ui.className="GPautoCompleteProposal gpf-panel__items gpf-panel__items_searchengine current",ui.style.color="#000000",ui.style["background-color"]="#CEDBEF",li.scrollIntoView();break;case 13:ii.preventDefault(),li.click(ii);break}li.focus()}}}),n.appendChild(ei),n},_createSearchResetElement:function(){var _t=this,e=document.createElement("button");return e.id=this._addUID("GPsearchInputReset"),e.className="GPshowOpen GPsearchInputReset gpf-btn gpf-btn-icon-reset gpf-btn-icon-search-reset fr-btn fr-btn--secondary gpf-btn--secondary",e.setAttribute("aria-label","Supprimer la recherche"),e.addEventListener("click",function(n){document.getElementById(_t._addUID("GPsearchInputText")).value="",document.getElementById(_t._addUID("GPautoCompleteList")).classList.replace("GPelementVisible","GPelementHidden"),document.getElementById(_t._addUID("GPautoCompleteList")).classList.replace("gpf-visible","gpf-hidden"),document.getElementById(_t._addUID("GPgeocodeResultsList")).classList.replace("GPelementVisible","GPelementHidden"),document.getElementById(_t._addUID("GPgeocodeResultsList")).classList.replace("gpf-visible","gpf-hidden"),_t.onSearchResetClick()}),e},_createButtonsElement:function(){var _t=document.createElement("div");return _t.className="GPbuttonsContainer",_t},_createFirstLineWrapper:function(){var _t=document.createElement("div");return _t.className="GPsearchFirstLineWrapper",_t},_createRadioContainer:function(){var _t=document.createElement("div");return _t.className="GPsearchRadioContainer",_t},_createRadioElements:function(){var _t=document.createElement("div");_t.className="GPsearchRadioElements";var e=document.createElement("div");e.className="GPsearchSplitChoice gpf-flex gpf-radio-group fr-radio-group fr-my-1w";var n=document.createElement("input");n.id=this._addUID("GPsearchSplitLocations"),n.type="radio",n.name="GPsearchSplit",n.value="address",n.checked=!0,e.appendChild(n);var ei=document.createElement("label");ei.className="gpf-label fr-label",ei.htmlFor=this._addUID("GPsearchSplitLocations"),ei.title="Adresses",ei.innerHTML="Adresses",e.appendChild(ei),n.addEventListener?n.addEventListener("change",function(){n.checked?(document.querySelector("[id^='GPautocompleteResultsSuggest']").classList.add("gpf-hidden","GPelementHidden"),document.querySelector("[id^='GPautocompleteResultsLocation']").classList.remove("gpf-hidden","GPelementHidden")):(document.querySelector("[id^='GPautocompleteResultsSuggest']").classList.remove("gpf-hidden","GPelementHidden"),document.querySelector("[id^='GPautocompleteResultsLocation']").classList.add("gpf-hidden","GPelementHidden"))}):n.attachEvent&&n.attachEvent("onchange",function(){n.checked?(document.querySelector("[id^='GPautocompleteResultsSuggest']").classList.add("gpf-hidden","GPelementHidden"),document.querySelector("[id^='GPautocompleteResultsLocation']").classList.remove("gpf-hidden","GPelementHidden")):(document.querySelector("[id^='GPautocompleteResultsSuggest']").classList.remove("gpf-hidden","GPelementHidden"),document.querySelector("[id^='GPautocompleteResultsLocation']").classList.add("gpf-hidden","GPelementHidden"))});var ti=document.createElement("div");ti.className="GPsearchSplitChoice gpf-flex gpf-radio-group fr-radio-group fr-my-1w";var ii=document.createElement("input");ii.id=this._addUID("GPsearchSplitData"),ii.type="radio",ii.name="GPsearchSplit",ii.value="data",ti.appendChild(ii);var ri=document.createElement("label");return ri.className="gpf-label fr-label",ri.htmlFor=this._addUID("GPsearchSplitData"),ri.title="Cartes et donnes",ri.innerHTML="Cartes et donnes",ti.appendChild(ri),ii.addEventListener?ii.addEventListener("change",function(){ii.checked?(document.querySelector("[id^='GPautocompleteResultsSuggest']").classList.remove("gpf-hidden","GPelementHidden"),document.querySelector("[id^='GPautocompleteResultsLocation']").classList.add("gpf-hidden","GPelementHidden")):(document.querySelector("[id^='GPautocompleteResultsSuggest']").classList.add("gpf-hidden","GPelementHidden"),document.querySelector("[id^='GPautocompleteResultsLocation']").classList.remove("gpf-hidden","GPelementHidden"))}):ii.attachEvent&&ii.attachEvent("onchange",function(){ii.checked?(document.querySelector("[id^='GPautocompleteResultsSuggest']").classList.remove("gpf-hidden","GPelementHidden"),document.querySelector("[id^='GPautocompleteResultsLocation']").classList.remove("gpf-hidden","GPelementHidden")):(document.querySelector("[id^='GPautocompleteResultsSuggest']").classList.remove("gpf-hidden","GPelementHidden"),document.querySelector("[id^='GPautocompleteResultsLocation']").classList.add("gpf-hidden","GPelementHidden"))}),_t.appendChild(e),_t.appendChild(ti),[_t,n,ii]},_createShowAdvancedSearchElement:function(){var _t=this,e=document.createElement("button");return e.id=this._addUID("GPshowAdvancedSearch"),e.className="GPshowOpen GPshowAdvancedToolPicto GPshowAdvancedSearch GPshowOpen gpf-btn gpf-btn-icon-search-advanced fr-btn fr-btn--secondary gpf-btn--secondary fr-m-1w",e.setAttribute("tabindex","0"),e.setAttribute("aria-pressed",!1),e.addEventListener("click",function(n){var ei=n.target.ariaPressed==="true";n.target.setAttribute("aria-pressed",!ei);var ti="#GPsearchInput-"+_t._uid;ei?(document.getElementById(_t._addUID("GPadvancedSearchPanel")).classList.replace("GPelementVisible","GPelementHidden"),document.getElementById(_t._addUID("GPadvancedSearchPanel")).classList.replace("gpf-visible","gpf-hidden"),document.querySelector(ti+" input").disabled=!1,document.querySelector(ti+" .GPsearchInputReset")&&(document.querySelector(ti+" .GPsearchInputReset").disabled=!1),checkDsfr()&&(document.querySelector("#GPshowSearchEnginePicto-"+_t._uid).disabled=!1)):(document.getElementById(_t._addUID("GPadvancedSearchPanel")).classList.replace("GPelementHidden","GPelementVisible"),document.getElementById(_t._addUID("GPadvancedSearchPanel")).classList.replace("gpf-hidden","gpf-visible"),document.querySelector(ti+" input").disabled=!0,document.querySelector(ti+" .GPsearchInputReset")&&(document.querySelector(ti+" .GPsearchInputReset").disabled=!0),checkDsfr()&&(document.querySelector("#GPshowSearchEnginePicto-"+_t._uid).disabled=!0)),document.getElementById(_t._addUID("GPautoCompleteList")).classList.replace("GPelementVisible","GPelementHidden"),document.getElementById(_t._addUID("GPautoCompleteList")).classList.replace("gpf-visible","gpf-hidden"),document.getElementById(_t._addUID("GPgeocodeResultsList")).classList.replace("GPelementVisible","GPelementHidden"),document.getElementById(_t._addUID("GPgeocodeResultsList")).classList.replace("gpf-visible","gpf-hidden");var ii=document.getElementById(_t._addUID("GPcoordinateSearchPanel"));ii&&(ii.classList.replace("GPelementVisible","GPelementHidden"),ii.classList.replace("gpf-visible","gpf-hidden"));var ri=document.getElementById(_t._addUID("GPshowSearchByCoordinate"));ri&&ri.setAttribute("aria-pressed",!1)}),e},_createShowGeolocateElement:function(){var _t=this,e=document.createElement("button");return e.id=this._addUID("GPshowGeolocate"),e.className="GPshowOpen GPshowAdvancedToolPicto GPshowGeolocate gpf-btn gpf-btn-icon-search-geolocate fr-btn fr-btn--secondary gpf-btn--secondary fr-m-1w",e.title="Activer la golocalisation",e.setAttribute("tabindex","0"),e.setAttribute("aria-pressed",!1),e.addEventListener("click",function(n){var ei=n.target.ariaPressed==="true";n.target.setAttribute("aria-pressed",!ei),_t.onShowSearchGeolocateClick(n)}),e},_createShowSearchByCoordinateElement:function(){var _t=this,e=document.createElement("button");return e.id=this._addUID("GPshowSearchByCoordinate"),e.className="GPshowOpen GPshowAdvancedToolPicto GPshowSearchByCoordinate gpf-btn gpf-btn-icon-search-coordinate fr-btn fr-btn--secondary gpf-btn--secondary fr-m-1w",e.title="Ouvrir la recherche par coordonnes",e.setAttribute("tabindex","0"),e.setAttribute("aria-pressed",!1),e.addEventListener("click",function(n){var ei=n.target.ariaPressed==="true";n.target.setAttribute("aria-pressed",!ei);var ti="#GPsearchInput-"+_t._uid;ei?(document.getElementById(_t._addUID("GPcoordinateSearchPanel")).classList.replace("GPelementVisible","GPelementHidden"),document.getElementById(_t._addUID("GPcoordinateSearchPanel")).classList.replace("gpf-visible","gpf-hidden"),document.querySelector(ti+" input").disabled=!1,document.querySelector(ti+" .GPsearchInputReset").disabled=!1,checkDsfr()&&(document.querySelector("#GPshowSearchEnginePicto-"+_t._uid).disabled=!1)):(document.getElementById(_t._addUID("GPcoordinateSearchPanel")).classList.replace("GPelementHidden","GPelementVisible"),document.getElementById(_t._addUID("GPcoordinateSearchPanel")).classList.replace("gpf-hidden","gpf-visible"),document.querySelector(ti+" input").disabled=!0,document.querySelector(ti+" .GPsearchInputReset").disabled=!0,checkDsfr()&&(document.querySelector("#GPshowSearchEnginePicto-"+_t._uid).disabled=!0)),document.getElementById(_t._addUID("GPautoCompleteList")).classList.replace("GPelementVisible","GPelementHidden"),document.getElementById(_t._addUID("GPautoCompleteList")).classList.replace("gpf-visible","gpf-hidden"),document.getElementById(_t._addUID("GPgeocodeResultsList")).classList.replace("GPelementVisible","GPelementHidden"),document.getElementById(_t._addUID("GPgeocodeResultsList")).classList.replace("gpf-visible","gpf-hidden"),document.getElementById(_t._addUID("GPadvancedSearchPanel")).classList.replace("GPelementVisible","GPelementHidden"),document.getElementById(_t._addUID("GPadvancedSearchPanel")).classList.replace("gpf-visible","gpf-hidden"),document.getElementById(_t._addUID("GPshowAdvancedSearch")).setAttribute("aria-pressed",!1)}),e},_createAdvancedSearchPanelElement:function(){var _t=document.createElement("dialog");return _t.id=this._addUID("GPadvancedSearchPanel"),_t.className="GPpanel GPelementHidden gpf-panel gpf-hidden fr-modal",_t},_createAdvancedSearchPanelDivElement:function(){var _t=document.createElement("div");return _t.className="gpf-panel__body fr-modal__body",_t},_createGeocodeResultsElement:function(){var _t=document.createElement("dialog");return _t.id=this._addUID("GPgeocodeResultsList"),_t.className="GPpanel GPelementHidden gpf-panel gpf-hidden fr-modal",_t},_createGeocodeResultsDivElement:function(){var _t=document.createElement("div");return _t.className="gpf-panel__body fr-modal__body",_t.appendChild(this._createGeocodeResultsHeaderElement()),_t},_createAutoCompleteElement:function(){var _t=document.createElement("div");return _t.id=this._addUID("GPautoCompleteList"),_t.className="GPautoCompleteList GPelementHidden gpf-panel fr-modal gpf-hidden ",_t},_createCoordinateSearchPanelElement:function(){var _t=document.createElement("dialog");return _t.id=this._addUID("GPcoordinateSearchPanel"),_t.className="GPpanel GPelementHidden gpf-panel gpf-hidden fr-modal",_t},_createCoordinateSearchPanelDivElement:function(){var _t=document.createElement("div");return _t.className="gpf-panel__body fr-modal__body",_t},_createAutoCompleteListElement:function(){var _t=this,e=document.createElement("div");return e.id=this._addUID("GPautocompleteResults"),e.className="",e.addEventListener?e.addEventListener("click",function(n){document.getElementById(_t._addUID("GPautoCompleteList")).classList.replace("GPelementVisible","GPelementHidden"),document.getElementById(_t._addUID("GPautoCompleteList")).classList.replace("gpf-visible","gpf-hidden")},!1):e.attachEvent&&e.attachEvent("onclick",function(n){document.getElementById(_t._addUID("GPautoCompleteList")).classList.replace("GPelementVisible","GPelementHidden"),document.getElementById(_t._addUID("GPautoCompleteList")).classList.replace("gpf-visible","gpf-hidden")}),e},_createAutoCompletedLocationContainer(){var _t=document.createElement("div");return _t.id=this._addUID("GPautocompleteResultsLocation"),_t.className="GPelementHidden gpf-hidden gpf-select",_t.size=20,_t.autofocus=!0,_t},_createAutoCompletedLocationTitleElement(){var _t=document.getElementById(this._addUID("GPautocompleteResultsLocation")),e=document.createElement("p");e.className="GPlabel GPlabelTitle gpf-label fr-label search-results-loc",e.innerHTML="Lieux et adresses",_t.appendChild(e)},_createAutoCompletedLocationElement:function(_t,e){var n=this,ei=document.getElementById(this._addUID("GPautocompleteResultsLocation")),ti=document.createElement("p");ti.id=this._addUID("AutoCompletedLocation_"+e),ti.className="GPautoCompleteProposal gpf-panel__items gpf-panel__items_searchengine";var ii=GeocodeUtils.getSuggestedLocationFreeform(_t);ti.innerHTML=ii,ti.title=ii,ti.addEventListener?ti.addEventListener("click",function(ri){n.onAutoCompletedResultsItemClick(ri)},!1):ti.attachEvent&&ti.attachEvent("onclick",function(ri){n.onAutoCompletedResultsItemClick(ri)}),ei.appendChild(ti)},_createSearchedSuggestContainer(){var _t=document.createElement("div");return _t.id=this._addUID("GPautocompleteResultsSuggest"),_t.className="GPelementHidden gpf-hidden gpf-select",_t.size=6,_t.autofocus=!0,_t},_createSearchedSuggestTitleElement(){var _t=document.getElementById(this._addUID("GPautocompleteResultsSuggest")),e=document.createElement("p");e.className="GPlabel GPlabelTitle gpf-label fr-label search-results-data",e.innerHTML="Cartes et donnes",_t.appendChild(e)},_createSearchedSuggestElement:function(_t,e){var n=this,ei=document.getElementById(this._addUID("GPautocompleteResultsSuggest")),ti=document.createElement("p");ti.id=this._addUID("AutoCompletedSuggest_"+e),ti.className="GPautoCompleteProposal gpf-panel__items gpf-panel__items_searchengine",ti.innerHTML=_t.title+" ("+_t.service+")",ti.dataset.layer=_t.name,ti.title=`${_t.description} (nom technique : ${_t.name})`,ti.addEventListener?ti.addEventListener("click",function(ii){n.onSearchedResultsItemClick(ii)},!1):ti.attachEvent&&ti.attachEvent("onclick",function(ii){n.onSearchedResultsItemClick(ii)}),ei.appendChild(ti)},_createAdvancedSearchPanelHeaderElement:function(){var _t=this,e=document.createElement("div");e.className="GPpanelHeader gpf-panel__header fr-modal__header";var n=document.createElement("div");n.className="GPpanelTitle gpf-panel__title fr-modal__title fr-pt-4w",n.innerHTML="Recherche avance",e.appendChild(n);var ei=document.createElement("button");ei.id=this._addUID("GPadvancedSearchClose"),ei.className="GPpanelClose gpf-btn gpf-btn-icon-close fr-btn--close fr-btn fr-btn--tertiary-no-outline fr-m-1w",ei.title="Fermer la recherche avance",ei.addEventListener?ei.addEventListener("click",function(){var ii="#GPsearchInput-"+_t._uid;document.querySelector(ii+" input").disabled=!1,document.querySelector(ii+" .GPsearchInputReset")&&(document.querySelector(ii+" .GPsearchInputReset").disabled=!1),checkDsfr()&&(document.querySelector("#GPshowSearchEnginePicto-"+_t._uid).disabled=!1),document.getElementById(_t._addUID("GPgeocodeResultsList")).classList.replace("GPelementVisible","GPelementHidden"),document.getElementById(_t._addUID("GPgeocodeResultsList")).classList.replace("gpf-visible","gpf-hidden"),document.getElementById(_t._addUID("GPshowAdvancedSearch")).setAttribute("aria-pressed",!1),document.getElementById(_t._addUID("GPadvancedSearchPanel")).classList.replace("GPelementVisible","GPelementHidden"),document.getElementById(_t._addUID("GPadvancedSearchPanel")).classList.replace("gpf-visible","gpf-hidden")},!1):ei.attachEvent&&ei.attachEvent("onclick",function(){var ii="#GPsearchInput-"+_t._uid;document.querySelector(ii+" input").disabled=!1,document.querySelector(ii+" .GPsearchInputReset")&&(document.querySelector(ii+" .GPsearchInputReset").disabled=!1),checkDsfr()&&(document.querySelector("#GPshowSearchEnginePicto-"+_t._uid).disabled=!1),document.getElementById(_t._addUID("GPgeocodeResultsList")).classList.replace("GPelementVisible","GPelementHidden"),document.getElementById(_t._addUID("GPgeocodeResultsList")).classList.replace("gpf-visible","gpf-hidden"),document.getElementById(_t._addUID("GPshowAdvancedSearch")).setAttribute("aria-pressed",!1),document.getElementById(_t._addUID("GPadvancedSearchPanel")).classList.replace("GPelementVisible","GPelementHidden"),document.getElementById(_t._addUID("GPadvancedSearchPanel")).classList.replace("gpf-visible","gpf-hidden")});var ti=document.createElement("span");return ti.className="GPelementHidden gpf-visible",ti.innerText="Fermer",ei.appendChild(ti),e.appendChild(ei),e},_createAdvancedSearchPanelFormElement:function(_t,e){var n=this,ei=document.createElement("form");ei.id=this._addUID("GPadvancedSearchForm"),ei.className="gpf-panel__content fr-modal__content",ei.addEventListener("submit",function(ni){ni.preventDefault();for(var si=[],ai="#GPadvancedSearchFilters-"+n._uid,oi=document.querySelectorAll(ai+" > div > div > input,select#category"),li=0;li<oi.length;li++){var ci=oi[li];si.push({key:ci.name,value:ci.value})}return n.onGeocodingAdvancedSearchSubmit(ni,si),document.getElementById(n._addUID("GPgeocodeResultsList")).classList.replace("GPelementHidden","GPelementVisible"),document.getElementById(n._addUID("GPgeocodeResultsList")).classList.replace("gpf-hidden","gpf-visible"),!1});var ti=document.createElement("div");ti.className="GPflexInput gpf-flex-column ";var ii=document.createElement("label");ii.className="GPadvancedSearchCodeLabel gpf-label fr-label",ii.innerHTML="Recherche par",ti.appendChild(ii);var ri=this._createAdvancedSearchFormCodeElement(_t,e);return ti.appendChild(ri),ei.appendChild(ti),ei},_createAdvancedSearchFormCodeElement:function(_t,e){var n=this,ei=document.createElement("select");ei.id=this._addUID("GPadvancedSearchCode"),ei.title="Choisir un type de recherche",ei.className="GPadvancedSearchCode gpf-select fr-select",ei.addEventListener("change",function(ri){n.onGeocodingAdvancedSearchCodeChange(ri)},!1),_t||(_t=[{id:"PositionOfInterest",title:"Lieux/toponymes"},{id:"StreetAddress",title:"Adresses"},{id:"CadastralParcel",title:"Parcelles cadastrales"}]);for(var ti=0;ti<_t.length;ti++){var ii=document.createElement("option");ii.value=_t[ti].id,ii.text=_t[ti].title,ei.appendChild(ii)}if(e){var ii=document.createElement("option");ii.value="Coordinates",ii.text="Coordonnes",ei.appendChild(ii)}return ei},_createAdvancedSearchFormInputElement:function(){var _t=document.createElement("input");return _t.type="submit",_t.id=this._addUID("GPadvancedSearchSubmit"),_t.className="GPsubmit gpf-btn gpf-btn-icon-submit  fr-btn fr-btn--secondary gpf-btn--secondary",_t.value="Chercher",_t},_createAdvancedSearchFormFiltersElement:function(){var _t=document.createElement("div");return _t.id=this._addUID("GPadvancedSearchFilters"),_t},_createAdvancedSearchFiltersTableElement:function(_t,e){var n=document.createElement("div");return n.id=this._addUID(_t),e||(n.style.display="none"),n},_createAdvancedSearchFiltersAttributElement:function(_t){var e=null,n=_t.name,ei=_t.title,ti=_t.description,ii=_t.code,ri=_t.value,ni=document.createElement("div");ni.className="GPflexInput gpf-flex-column ";var si=document.createElement("label");if(si.className="GPadvancedSearchFilterLabel gpf-label fr-label",si.htmlFor=n,si.title=ti||ei,si.innerHTML=ei,ni.appendChild(si),n==="category"){var ai=document.createElement("select");if(ai.id=n,ai.name=n,ai.title=ei,ai.className="GPadvancedSearchFilterInput gpf-select fr-select",ri&&Array.isArray(ri))for(var oi=0;oi<ri.length;oi++){var li=document.createElement("option");li.value=ri[oi],li.text=ri[oi],ai.appendChild(li)}ni.appendChild(ai)}else{var ci=document.createElement("input");if(ci.id=n,ci.className="GPadvancedSearchFilterInput gpf-input fr-input",ci.type="text",ci.name=n,ri)if(Array.isArray(ri)){var ui=n+"_list";ci.setAttribute("list",ui);var di=document.createElement("datalist");di.id=ui;for(var oi=0;oi<ri.length;++oi){var li=document.createElement("option");li.value=ri[oi],di.appendChild(li)}ni.appendChild(di)}else ci.value=ri;ni.appendChild(ci)}return e=document.getElementById(this._addUID(ii)),e?e.appendChild(ni):e=ni,e},_createGeocodeResultsHeaderElement:function(){var _t=this,e=document.createElement("div");e.className="GPpanelHeader gpf-panel__header fr-modal__header";var n=document.createElement("div");n.className="GPpanelTitle gpf-panel__title fr-modal__title fr-pt-4w",n.innerHTML="Rsultats de la recherche",e.appendChild(n);var ei=document.createElement("button");ei.id=this._addUID("GPgeocodeResultsClose"),ei.className="GPpanelClose gpf-btn gpf-btn-icon-close fr-btn--close fr-btn fr-btn--tertiary-no-outline fr-m-1w",ei.title="Fermer la fentre de rsultats",ei.addEventListener?ei.addEventListener("click",function(){document.getElementById(_t._addUID("GPgeocodeResultsList")).classList.replace("GPelementVisible","GPelementHidden"),document.getElementById(_t._addUID("GPgeocodeResultsList")).classList.replace("gpf-visible","gpf-hidden")},!1):ei.attachEvent&&ei.attachEvent("onclick",function(){document.getElementById(_t._addUID("GPgeocodeResultsList")).classList.replace("GPelementVisible","GPelementHidden"),document.getElementById(_t._addUID("GPgeocodeResultsList")).classList.replace("gpf-visible","gpf-hidden")});var ti=document.createElement("span");return ti.className="GPelementHidden gpf-visible",ti.innerText="Fermer",ei.appendChild(ti),e.appendChild(ei),e},_createGeocodeResultsListElement:function(){var _t=this,e=document.createElement("div");return e.id=this._addUID("GPgeocodeResults"),e.className="gpf-panel__list",e.setAttribute("tabindex","0"),e.addEventListener?e.addEventListener("click",function(n){n.ctrlKey||(document.getElementById(_t._addUID("GPgeocodeResultsList")).classList.replace("GPelementVisible","GPelementHidden"),document.getElementById(_t._addUID("GPgeocodeResultsList")).classList.replace("gpf-visible","gpf-hidden")),_t.onGeocodedResultsItemClick(n)},!1):e.attachEvent&&e.attachEvent("onclick",function(n){n.ctrlKey||(document.getElementById(_t._addUID("GPgeocodeResultsList")).classList.replace("GPelementVisible","GPelementHidden"),document.getElementById(_t._addUID("GPgeocodeResultsList")).classList.replace("gpf-visible","gpf-hidden")),_t.onGeocodedResultsItemClick(n)}),e},_createGeocodedLocationElement:function(_t,e){var n=document.getElementById(this._addUID("GPgeocodeResults")),ei=document.createElement("div");ei.id=this._addUID("GeocodedLocation_"+e),ei.className="GPautoCompleteProposal gpf-panel__items gpf-panel__items_searchengine",typeof _t=="string"?ei.innerHTML=_t:ei.innerHTML=GeocodeUtils.getGeocodedLocationFreeform(_t),n.appendChild(ei)},_createCoordinateSearchPanelHeaderElement(){var _t=this,e=document.createElement("div");e.className="GPpanelHeader gpf-panel__header fr-modal__header";var n=document.createElement("div");n.className="GPpanelTitle gpf-panel__title fr-modal__title fr-pt-4w",n.innerHTML="Recherche par coordonnes",e.appendChild(n);var ei=document.createElement("button");ei.id=this._addUID("GPcoordinateSearchClose"),ei.className="GPpanelClose GPcoordinateSearchClose gpf-btn gpf-btn-icon-close fr-btn--close fr-btn fr-btn--tertiary-no-outline fr-m-1w",ei.title="Fermer la recherche par coordonnes",ei.addEventListener?ei.addEventListener("click",function(){var ii="#GPsearchInput-"+_t._uid;document.querySelector(ii+" input").disabled=!1,document.querySelector(ii+" .GPsearchInputReset")&&(document.querySelector(ii+" .GPsearchInputReset").disabled=!1),checkDsfr()&&(document.querySelector("#GPshowSearchEnginePicto-"+_t._uid).disabled=!1),document.getElementById(_t._addUID("GPshowSearchByCoordinate")).setAttribute("aria-pressed",!1),document.getElementById(_t._addUID("GPcoordinateSearchPanel")).classList.replace("GPelementVisible","GPelementHidden"),document.getElementById(_t._addUID("GPcoordinateSearchPanel")).classList.replace("gpf-visible","gpf-hidden"),_t.onCoordinateSearchClose()},!1):ei.attachEvent&&ei.attachEvent("onclick",function(){var ii="#GPsearchInput-"+_t._uid;document.querySelector(ii+" input").disabled=!1,document.querySelector(ii+" .GPsearchInputReset")&&(document.querySelector(ii+" .GPsearchInputReset").disabled=!1),checkDsfr()&&(document.querySelector("#GPshowSearchEnginePicto-"+_t._uid).disabled=!1),document.getElementById(_t._addUID("GPshowSearchByCoordinate")).setAttribute("aria-pressed",!1),document.getElementById(_t._addUID("GPcoordinateSearchPanel")).classList.replace("GPelementVisible","GPelementHidden"),document.getElementById(_t._addUID("GPcoordinateSearchPanel")).classList.replace("gpf-visible","gpf-hidden"),_t.onCoordinateSearchClose()});var ti=document.createElement("span");return ti.className="GPelementHidden gpf-visible",ti.innerText="Fermer",ei.appendChild(ti),e.appendChild(ei),e},_createCoordinateSearchPanelFormElement(){var _t=this,e=document.createElement("form");return e.id=this._addUID("GPcoordinateSearchForm"),e.className="gpf-panel__content fr-modal__content",e.addEventListener("submit",function(n){return n.preventDefault(),_t.onShowSearchByCoordinateClick(),!1}),e},__createCoordinateSearchDivElement(){var _t=document.createElement("div");return _t.className="GPflexInput gpf-flex-column ",_t},_createCoordinateSearchSystemsLabelElement(){var _t=document.createElement("label");return _t.className="GPcoordinateSearchSystemsLabel gpf-label fr-label",_t.innerHTML="Systme de rfrence",_t},_setCoordinateSearchSystemsSelectElement(_t){document.getElementById(this._addUID("GPcoordinateSearchSystem"))&&document.getElementById(this._addUID("GPcoordinateSearchSystem")).remove();var e=this,n=document.createElement("select");n.id=this._addUID("GPcoordinateSearchSystem"),n.title="Choisir un systme de rference",n.className="GPselect GPcoordinateSearchSystemsSelect gpf-select fr-select",n.addEventListener("change",function(ri){e.onCoordinateSearchSystemChange(ri)});for(var ei=0;ei<_t.length;ei++){var ti=_t[ei],ii=document.createElement("option");ii.value=ti.code,ii.text=ti.label||ei,n.appendChild(ii)}return n},_createCoordinateSearchUnitsLabelElement(){var _t=document.createElement("label");return _t.className="GPcoordinateSearchUnitsLabel gpf-label fr-label",_t.innerHTML="Units",_t},_setCoordinateSearchUnitsSelectElement(_t){document.getElementById(this._addUID("GPcoordinateSearchUnits"))&&document.getElementById(this._addUID("GPcoordinateSearchUnits")).remove();var e=this,n=document.createElement("select");n.id=this._addUID("GPcoordinateSearchUnits"),n.title="Choisir un type d'unit",n.className="GPselect GPcoordinateSearchUnitsSelect gpf-select fr-select",n.addEventListener("change",function(ri){e.onCoordinateSearchUnitsChange(ri)});for(var ei=0;ei<_t.length;ei++){var ti=_t[ei],ii=document.createElement("option");ii.value=ti.code?ti.code:ei,ii.text=ti.label||ei,n.appendChild(ii)}return n},_setCoordinateSearchLngLabelElement(_t){document.getElementById(this._addUID("GPcoordinateSearchLngLabel"))&&document.getElementById(this._addUID("GPcoordinateSearchLngLabel")).remove();var e=document.createElement("label");return e.className="GPcoordinateSearchLabel gpf-label fr-label",e.id=this._addUID("GPcoordinateSearchLngLabel"),e.htmlFor="coordinate-lng",e.innerHTML=_t==="Geographical"?"Longitude :":"Y :",e},_setCoordinateSearchLngInputElement(_t){document.getElementById(this._addUID("GPcoordinateSearchLngInput"))&&document.getElementById(this._addUID("GPcoordinateSearchLngInput")).remove(),document.getElementById(this._addUID("GPcoordinateSearchLngDMS"))&&document.getElementById(this._addUID("GPcoordinateSearchLngDMS")).remove();var e=document.createElement("input");switch(e.id=this._addUID("GPcoordinateSearchLngInput"),e.className="GPcoordinateSearchInput gpf-input fr-input",e.title="Saisir des coordonnes",e.name="coordinate-lng",e.type="number",e.step="any",e.required="",_t){case"DMS":return e.title+=" gographiques (en sexa)",e.className="GPelementHidden gpf-hidden",this._setCoordinateSearchLngDMSElement();case"DEC":e.title+=" gographiques (en decimal)",e.min="-180",e.max="180";break;case"M":e.title+=" cartsiennes (en mtre)";break;case"KM":e.title+=" cartsiennes (en kilomtre)";break}return e},_setCoordinateSearchLngDMSElement(){var _t=document.createElement("div");return _t.id=this._addUID("GPcoordinateSearchLngDMS"),_t.innerHTML=`
        <div class="GPflexInput gpf-flex">
            <input step="1"
                id="GPcoordinatSearchInputSexLonDeg"
                class="gpf-input fr-input"
                name="inputSexLonDeg"
                title="Saisir une valeur de degr entre 0 et 180"
                type="number"
                required=""
                min="0"
                max="180">
            <label></label>
            <input step="1"
                id="GPcoordinatSearchInputSexLonMin"
                class="gpf-input fr-input"
                name="inputSexLonMin"
                title="Saisir une valeur de minute entre 0' et 59'"
                type="number"
                required=""
                min="0"
                max="59">
            <label>'</label>
            <input step="any"
                id="GPcoordinatSearchInputSexLonSec"
                class="gpf-input fr-input"
                name="inputSexLonSec"
                title="Saisir une valeur de seconde entre 0'' et 59''"
                type="number"
                required=""
                min="0"
                max="59.9999">
            <label>"</label>
            <select
                id="GPcoordinatSearchInputSexLonToward"
                class="GPselect gpf-select fr-select"
                title="Saisir une direction pour Est et 0uest"
                name="inputSexLonToward">
                <option value="O">O</option>
                <option value="E" selected="">E</option>
            </select>
        </div>
        `,_t},_setCoordinateSearchLatLabelElement(_t){document.getElementById(this._addUID("GPcoordinateSearchLatLabel"))&&document.getElementById(this._addUID("GPcoordinateSearchLatLabel")).remove();var e=document.createElement("label");return e.className="GPcoordinateSearchLabel gpf-label fr-label",e.id=this._addUID("GPcoordinateSearchLatLabel"),e.htmlFor="coordinate-lat",e.innerHTML=_t==="Geographical"?"Latitude :":"X :",e},_setCoordinateSearchLatInputElement(_t){document.getElementById(this._addUID("GPcoordinateSearchLatInput"))&&document.getElementById(this._addUID("GPcoordinateSearchLatInput")).remove(),document.getElementById(this._addUID("GPcoordinateSearchLatDMS"))&&document.getElementById(this._addUID("GPcoordinateSearchLatDMS")).remove();var e=document.createElement("input");switch(e.id=this._addUID("GPcoordinateSearchLatInput"),e.className="GPcoordinateSearchInput gpf-input fr-input",e.title="Saisir des coordonnes",e.name="coordinate-lat",e.type="number",e.step="any",e.required="",_t){case"DMS":return e.title+=" gographiques (en sexa)",e.className="GPelementHidden gpf-hidden",this._setCoordinateSearchLatDMSElement();case"DEC":e.title+=" gographiques (en decimal)",e.min="-180",e.max="180";break;case"M":e.title+=" cartsiennes (en mtre)";break;case"KM":e.title+=" cartsiennes (en kilomtre)";break}return e},_setCoordinateSearchLatDMSElement(){var _t=document.createElement("div");return _t.id=this._addUID("GPcoordinateSearchLatDMS"),_t.innerHTML=`
        <div class="GPflexInput gpf-flex">
            <input step="1"
                id="GPcoordinatSearchInputSexLatDeg"
                class="gpf-input fr-input"
                name="inputSexLatDeg"
                title="Saisir une valeur de degr entre 0 et 85"
                type="number"
                required=""
                min="0"
                max="85">
            <label></label>
            <input step="1"
                id="GPcoordinatSearchInputSexLatMin"
                class="gpf-input fr-input"
                name="inputSexLatMin"
                title="Saisir une valeur de minute entre 0' et 59'"
                type="number"
                required=""
                min="0"
                max="59">
            <label>'</label>
            <input step="any"
                id="GPcoordinatSearchInputSexLatSec"
                class="gpf-input fr-input"
                name="inputSexLatSec"
                title="Saisir une valeur de seconde entre 0' et 59'"
                type="number"
                required=""
                min="0"
                max="59.9999">
            <label>"</label>
            <select
                id="GPcoordinatSearchInputSexLatToward"
                class="GPselect gpf-select fr-select"
                title="Saisir une direction pour Nord et Sud"
                name="inputSexLatToward">
                <option value="N">N</option>
                <option value="S">S</option>
            </select>
        </div>
        `,_t},_createCoordinateSearchSubmitElement(){var _t=document.createElement("input");return _t.type="submit",_t.id=this._addUID("GPcoordinateSearchSubmit"),_t.className="GPsubmit gpf-btn gpf-btn-icon-submit  fr-btn fr-btn--secondary gpf-btn--secondary",_t.value="Chercher",_t}},logger$y=LoggerByDefault.getLogger("searchengine");class SearchEngine extends ControlExtended{constructor(e){if(e=e||{},super(e),!(this instanceof SearchEngine))throw new TypeError("ERROR CLASS_CONSTRUCTOR");return this.CLASSNAME="SearchEngine",this.initialize(e),this.container=this._initContainer(),this.element?this.element.appendChild(this.container):this.element=this.container,this}setMap(e){e||this._clearResults(),this.collapsed||this._showSearchEngineButton.setAttribute("aria-pressed",!0),super.setMap(e),this.options.position&&this.setPosition(this.options.position),this.options.gutter===!1&&this.getContainer().classList.add("gpf-button-no-gutter")}getCollapsed(){return this.collapsed}setCollapsed(e){if(e===void 0){logger$y.log("[ERROR] SearchEngine:setCollapsed - missing collapsed parameter");return}this.options.collapsible&&(e&&this.collapsed||!e&&!this.collapsed||(this._showSearchEngineButton.click(),this.collapsed=e))}getData(){return this._geocodedLocations}getContainer(){return this.container}initialize(e){this._checkInputOptions(e),this.options={collapsed:!0,collapsible:!0,zoomTo:"",resources:{geocode:[],autocomplete:[],search:!1},displayButtonClose:!0,displayButtonAdvancedSearch:!1,displayButtonGeolocate:!1,displayButtonCoordinateSearch:!1,coordinateSearchInAdvancedSearch:!1,advancedSearch:{},coordinateSearch:{},searchOptions:{addToMap:!0,maximumEntries:5,serviceOptions:{maximumResponses:10},filterLayers:!0},geocodeOptions:{serviceOptions:{}},autocompleteOptions:{serviceOptions:{maximumResponses:5},triggerGeocode:!1,triggerDelay:1e3,prettifyResults:!1},displayMarker:!0,markerStyle:"lightOrange",markerUrl:"",placeholder:"Rechercher un lieu, une adresse",splitResults:!1},Helper.mergeParams(this.options,e),this.options.resources.geocode===""&&(this.options.resources.geocode=["PositionOfInterest","StreetAddress"]),this.options.resources.autocomplete.length===0&&(this.options.resources.autocomplete=["PositionOfInterest","StreetAddress"]),this.options.resources.search&&(this.options.searchOptions&&(this.options.searchOptions.serviceOptions&&(this.options.searchOptions.serviceOptions.url&&Search$1.setUrl(this.options.searchOptions.serviceOptions.url),this.options.searchOptions.serviceOptions.fields&&Search$1.setFields(this.options.searchOptions.serviceOptions.fields),this.options.searchOptions.serviceOptions.index&&Search$1.setIndex(this.options.searchOptions.serviceOptions.index),this.options.searchOptions.serviceOptions.size&&Search$1.setSize(this.options.searchOptions.serviceOptions.size),this.options.searchOptions.serviceOptions.maximumResponses&&Search$1.setMaximumResponses(this.options.searchOptions.serviceOptions.maximumResponses)),this.options.searchOptions.filterServices&&Search$1.setFiltersByService(this.options.searchOptions.filterServices),this.options.searchOptions.filterLayersPriority&&Search$1.setFiltersByLayerPriority(this.options.searchOptions.filterLayersPriority),this.options.searchOptions.filterWMTSPriority&&Search$1.setFilterWMTSPriority(this.options.searchOptions.filterWMTSPriority),this.options.searchOptions.filterTMS===!1&&Search$1.setFilterTMS(this.options.searchOptions.filterTMS),this.options.searchOptions.filterProjections&&Search$1.setFiltersByProjection(this.options.searchOptions.filterProjections)),Search$1.target.addEventListener("suggest",ti=>{logger$y.debug(ti);let ii=ti.detail;ii=this._filterResultsFromConfigLayers(ii),this._fillSearchedSuggestListContainer(ii)})),this.options.collapsible||(this.options.collapsed=!1),this.collapsed=this.options.collapsed,this._uid=this.options.id||SelectorID.generate(),this._showSearchEngineButton=null,this._showSearchEngineAdvancedButton=null,this._inputSearchContainer=null,this._autocompleteContainer=null,this._containerResultsLocation=null,this._containerResultsSuggest=null,this._radioButtonLocation=null,this._radioButtonSuggest=null,this._suggestedLocations=[],this._geocodedContainer=null,this._geocodedLocations=[],this._filterContainer=null,this._currentGeocodingCode=null,this._currentGeocodingLocation=null,this._advancedSearchFilters={},this._initAdvancedSearchFilters(),this._advancedSearchCodes=[],this._initAdvancedSearchCodes(),this._coordinateSearchSystems=[],this.options.displayButtonCoordinateSearch&&(this._initCoordinateSearchSystems(),this._currentCoordinateSearchSystems=this._coordinateSearchSystems[0],this._currentCoordinateSearchType=this._coordinateSearchSystems[0].type),this._coordinateSearchUnits=[],this.options.displayButtonCoordinateSearch&&(this._initCoordinateSearchUnits(),this._currentCoordinateSearchUnits=this._coordinateSearchUnits[this._currentCoordinateSearchType][0].code),this._coordinateSearchLngInput=null,this._coordinateSearchLatInput=null,this._marker=null;var n=this.options.markerStyle,ei=this.options.markerUrl;ei?this._markerUrl=ei:this._markerUrl=Object.keys(Marker).indexOf(n)===-1?Marker.lightOrange:Marker[n],this._displayMarker=this.options.displayMarker,this._popupContent=null,this._popupDiv=this._initPopupDiv(),this._popupOverlay=null,this._triggerHandler=null}_checkInputOptions(e){var n;if(e.resources)if(typeof e.resources=="object"){var ei=e.resources.geocode;if(ei)if(Array.isArray(ei)){var ti=["StreetAddress","PositionOfInterest","CadastralParcel","Administratif"];for(n=0;n<ei.length;n++)ti.indexOf(ei[n])===-1&&logger$y.log("[SearchEngine] options.resources.geocode : "+ei[n]+" is not a resource for geocode")}else logger$y.log("[SearchEngine] 'options.resources.geocode' parameter should be an array"),ei=null;var ii=e.resources.autocomplete;if(ii)if(Array.isArray(ii)){var ri=["StreetAddress","PositionOfInterest"];for(n=0;n<ii.length;n++)ri.indexOf(ii[n])===-1&&logger$y.log("[SearchEngine] options.resources.autocomplete : "+ii[n]+" is not a resource for autocomplete")}else logger$y.log("[SearchEngine] 'options.resources.autocomplete' parameter should be an array"),ii=null}else logger$y.log("[SearchEngine] 'resources' parameter should be an object"),e.resources=null}_initAdvancedSearchCodes(){var e=this.options.resources.geocode;e==="location"&&(e=["PositionOfInterest","StreetAddress","CadastralParcel"]),Array.isArray(e)||(e=[e]);for(var n=0;n<e.length;n++)switch(e[n]){case"PositionOfInterest":this._advancedSearchCodes.push({id:"PositionOfInterest",title:"Lieux/toponymes"});break;case"StreetAddress":this._advancedSearchCodes.push({id:"StreetAddress",title:"Adresses"});break;case"CadastralParcel":this._advancedSearchCodes.push({id:"CadastralParcel",title:"Parcelles cadastrales"});break}this._advancedSearchCodes.length===0&&(this._advancedSearchCodes=[{id:"StreetAddress",title:"Adresses"},{id:"PositionOfInterest",title:"Lieux/toponymes"},{id:"CadastralParcel",title:"Cadastre"}]),logger$y.log("advancedSearchCodes",this._advancedSearchCodes)}_initAdvancedSearchFilters(){this._advancedSearchFilters=SearchEngineUtils.advancedSearchFiltersByDefault;var e=this.options.advancedSearch;Helper.assign(this._advancedSearchFilters,e),logger$y.log("advancedSearchFilters",this._advancedSearchFilters)}_initCoordinateSearchSystems(){var e=[{label:"Gographique",crs:"EPSG:4326",type:"Geographical"},{label:"Web Mercator",crs:"EPSG:3857",type:"Metric"},{label:"Lambert 93",crs:"EPSG:2154",type:"Metric"}],n=this.options.coordinateSearch.systems;if(n)for(var ei=0;ei<n.length;ei++){var ti=n[ei];this._setSystem(ti)}if(this._coordinateSearchSystems.length===0)for(var ii=0;ii<e.length;ii++)this._setSystem(e[ii])}_initCoordinateSearchUnits(){var e={Geographical:[{code:"DEC",label:"degrs dcimaux",format:MathUtils.coordinateToDecimal},{code:"DMS",label:"degrs sexagsimaux",format:MathUtils.coordinateToDMS}],Metric:[{code:"M",label:"mtres",format:MathUtils.coordinateToMeter},{code:"KM",label:"kilomtres",format:MathUtils.coordinateToKMeter}]},n=this.options.coordinateSearch.units;if(n){for(var ei in e)if(e.hasOwnProperty(ei)){for(var ti=!1,ii=0;ii<e[ei].length;ii++)for(var ri=e[ei][ii],ni=0;ni<n.length;ni++){var si=n[ni];ri.code===si&&(ti=!0,this._coordinateSearchUnits[ei]||(this._coordinateSearchUnits[ei]=[]),this._coordinateSearchUnits[ei].push(ri))}ti||(this._coordinateSearchUnits[ei]=e[ei])}}typeof this._coordinateSearchUnits=="object"&&Object.keys(this._coordinateSearchUnits).length===0&&(this._coordinateSearchUnits=e)}_initPopupDiv(){var e=this,n=document.createElement("div");n.className="gp-feature-info-div gpf-widget-color";var ei=document.createElement("button");ei.title="Supprimer le marqueur",ei.className="gp-styling-button remove gpf-btn gpf-btn-icon-remove fr-btn--remove fr-btn fr-btn--tertiary-no-outline fr-mt-1v fr-mr-2v",ei.onclick=function(){var ii=e.getMap();e._marker&&(ii.removeOverlay(e._marker),e._marker=null),e._popupOverlay!=null&&e._popupOverlay.setPosition(void 0),e.dispatchEvent({type:"searchengine:geolocation:remove"})};var ti=document.createElement("button");return ti.title="Fermer la pop-up",ti.className="gp-styling-button closer gpf-btn gpf-btn-icon-close fr-btn--close fr-btn fr-btn--tertiary-no-outline fr-mt-1v fr-mr-2v",ti.onclick=function(){return e._popupOverlay!=null&&e._popupOverlay.setPosition(void 0),!1},this._popupContent=document.createElement("div"),this._popupContent.className="gp-features-content-div",this._popupContent.style["min-width"]="200px",n.appendChild(ti),n.appendChild(this._popupContent),n.appendChild(ei),n}_initContainer(){var e=this._createMainContainerElement(),n=this._createSearchDivElement(),ei=this._showSearchEngineButton=this._createShowSearchEnginePictoElement(this.options.collapsible);n.appendChild(ei),this.options.collapsible||e.classList.add("gpf-widget-color","gpf-widget-padding");var ti=this._inputSearchContainer=this._createSearchInputElement(this.options.placeholder);this.options.displayButtonClose&&ti.appendChild(this._createSearchResetElement());var ii=this;ti.addEventListener?ti.addEventListener("click",function(){ii.onAutoCompleteInputClick()}):ti.attachEvent&&ti.attachEvent("onclick",function(){ii.onAutoCompleteInputClick()}),n.appendChild(ti);var ri=this._createButtonsElement(),ni=this._createFirstLineWrapper();if(ni.appendChild(n),ni.appendChild(ri),e.appendChild(ni),checkDsfr()&&this.options.splitResults){var si=this._createRadioContainer();e.appendChild(si)}if(checkDsfr()&&this.options.splitResults){var ai;[ai,this._radioButtonLocation,this._radioButtonSuggest]=this._createRadioElements(),si.appendChild(ai)}if(this.options.displayButtonGeolocate){var oi=this._createShowGeolocateElement();ri.appendChild(oi)}if(this.options.displayButtonCoordinateSearch||this.options.coordinateSearchInAdvancedSearch){var li=this._createShowSearchByCoordinateElement();this.options.coordinateSearchInAdvancedSearch||ri.appendChild(li);var ci=this._createCoordinateSearchPanelElement(),ui=this._createCoordinateSearchPanelDivElement(),di=this._createCoordinateSearchPanelHeaderElement(),fi=this._createCoordinateSearchPanelFormElement(),hi=null;hi=this._containerSystems=this.__createCoordinateSearchDivElement(),fi.appendChild(hi);var pi=this._createCoordinateSearchSystemsLabelElement(),gi=this._setCoordinateSearchSystemsSelectElement(this._coordinateSearchSystems);hi.appendChild(pi),hi.appendChild(gi),hi=this._containerUnits=this.__createCoordinateSearchDivElement(),fi.appendChild(hi);var vi=this._createCoordinateSearchUnitsLabelElement(),yi=this._setCoordinateSearchUnitsSelectElement(this._coordinateSearchUnits[this._currentCoordinateSearchType]);hi.appendChild(vi),hi.appendChild(yi),hi=this._containerCoordinateLat=this.__createCoordinateSearchDivElement(),fi.appendChild(hi);var _i=this._setCoordinateSearchLatLabelElement(this._currentCoordinateSearchType),Ai=this._coordinateSearchLatInput=this._setCoordinateSearchLatInputElement(this._currentCoordinateSearchUnits);hi.appendChild(_i),hi.appendChild(Ai),hi=this._containerCoordinateLng=this.__createCoordinateSearchDivElement(),fi.appendChild(hi);var Ei=this._setCoordinateSearchLngLabelElement(this._currentCoordinateSearchType),Si=this._coordinateSearchLngInput=this._setCoordinateSearchLngInputElement(this._currentCoordinateSearchUnits);hi.appendChild(Ei),hi.appendChild(Si);var wi=this._createCoordinateSearchSubmitElement();fi.appendChild(wi),ui.appendChild(di),ui.appendChild(fi),ci.appendChild(ui),this.options.coordinateSearchInAdvancedSearch||e.appendChild(ci)}if(this.options.displayButtonAdvancedSearch){var Oi=this._showSearchEngineAdvancedButton=this._createShowAdvancedSearchElement();ri.appendChild(Oi);var Ii=this._createAdvancedSearchPanelElement(),Li=this._createAdvancedSearchPanelDivElement(),Di=this._createAdvancedSearchPanelHeaderElement(),Ni=this._createAdvancedSearchPanelFormElement(this._advancedSearchCodes,this.options.coordinateSearchInAdvancedSearch),$i=this._filterContainer=this._createAdvancedSearchFormFiltersElement();this._setFilter(this._advancedSearchCodes[0].id);var Ki=this._createAdvancedSearchFormInputElement();Ni.appendChild($i),this.options.coordinateSearchInAdvancedSearch&&Ni.appendChild(fi),Ni.appendChild(Ki),Li.appendChild(Di),Li.appendChild(Ni),Ii.appendChild(Li),e.appendChild(Ii)}var er=this._autocompleteContainer=this._createAutoCompleteElement(),Vi=this._createAutoCompleteListElement(),nr=this._containerResultsLocation=this._createAutoCompletedLocationContainer(),zi=this._containerResultsSuggest=this._createSearchedSuggestContainer();Vi.appendChild(nr),Vi.appendChild(zi),er.appendChild(Vi),e.appendChild(er);var Wi=this._createGeocodeResultsElement(),Ti=this._createGeocodeResultsDivElement();Wi.appendChild(Ti);var ki=this._geocodedContainer=this._createGeocodeResultsListElement();return Ti.appendChild(ki),e.appendChild(Wi),e}_setFilter(e){for(var n=this._filterContainer,ei=!1,ti=0;ti<this._advancedSearchCodes.length;ti++)if(this._advancedSearchCodes[ti].id===e){ei=!0;break}if(!ei){for(;n.firstChild;)n.removeChild(n.firstChild);return}for(this._currentGeocodingCode=e;n.firstChild;)n.removeChild(n.firstChild);var ii=this._advancedSearchFilters[e];if(!(!ii||ii.length===0)){for(var ri=this._createAdvancedSearchFiltersTableElement(e,!0),ni=0;ni<ii.length;ni++){var si=this._createAdvancedSearchFiltersAttributElement(ii[ni]);ri.appendChild(si)}return n.appendChild(ri),n}}_requestAutoComplete(e){if(!(!e||typeof e=="object"&&Object.keys(e).length===0)&&e.text){logger$y.log(e);var n={};Helper.assign(n,this.options.autocompleteOptions.serviceOptions),Helper.assign(n,e);var ei=this.options.resources.autocomplete;ei&&Array.isArray(ei)&&(n.type||(n.type=ei)),n.apiKey=n.apiKey||this.options.apiKey,typeof n.ssl!="boolean"&&(typeof this.options.ssl=="boolean"?n.ssl=this.options.ssl:n.ssl=!0),logger$y.log(n),Gp.Services.autoComplete(n)}}_fillAutoCompletedLocationListContainer(e){if(!(!e||e.length===0)){var n=this._containerResultsLocation;if(n.childElementCount)for(;n.firstChild;)n.removeChild(n.firstChild);if(n.classList.add("GPelementHidden","gpf-hidden"),e.length){(!this._radioButtonLocation||this._radioButtonLocation&&this._radioButtonLocation.checked)&&n.classList.remove("GPelementHidden","gpf-hidden"),this._displaySuggestedLocation(),(!checkDsfr()||!this.options.splitResults)&&this._createAutoCompletedLocationTitleElement();for(var ei=0;ei<e.length;ei++)this._createAutoCompletedLocationElement(e[ei],ei)}}}_fillSearchedSuggestListContainer(e){this.options.searchOptions.maximumEntries&&(e=e.slice(0,this.options.searchOptions.maximumEntries));var n=this._containerResultsSuggest;if(n.childElementCount)for(;n.firstChild;)n.removeChild(n.firstChild);if(n.classList.add("GPelementHidden","gpf-hidden"),e.length){(!this._radioButtonSuggest||this._radioButtonSuggest&&this._radioButtonSuggest.checked)&&n.classList.remove("GPelementHidden","gpf-hidden"),(!checkDsfr()||!this.options.splitResults)&&this._createSearchedSuggestTitleElement();for(let ei=0;ei<e.length;ei++){const ti=e[ei];this._createSearchedSuggestElement(ti,ei)}}}_filterResultsFromConfigLayers(e){if(this.options.searchOptions.filterLayers){var n={};if(this.options.searchOptions.filterLayersList)n=this.options.searchOptions.filterLayersList;else{var ei=window.Gp.Config.layers;for(let ii in ei)ei.hasOwnProperty(ii)&&(n[ei[ii].name]=ei[ii].serviceParams.id.split(":")[1])}let ti=e.length;for(;ti--;)(!n[e[ti].name]||e[ti].service.toUpperCase()!==n[e[ti].name].toUpperCase())&&e.splice(ti,1)}return Search$1.setSuggestions(e),e}_requestGeocoding(e){if(!(!e||typeof e=="object"&&Object.keys(e).length===0)&&e.query!==null){logger$y.log(e);var n={};Helper.assign(n,this.options.geocodeOptions.serviceOptions),Helper.assign(n,e);var ei=this,ti=this.options.geocodeOptions.serviceOptions.onFailure!==null&&typeof this.options.geocodeOptions.serviceOptions.onFailure=="function",ii=this.options.geocodeOptions.serviceOptions.onSuccess!==null&&typeof this.options.geocodeOptions.serviceOptions.onSuccess=="function";if(ii){var ri=function(ai){e.onSuccess.call(ei,ai),ei.options.geocodeOptions.serviceOptions.onSuccess.call(ei,ai)};n.onSuccess=ri}if(ti){var ni=function(ai){e.onFailure.call(ei,ai),ei.options.geocodeOptions.serviceOptions.onFailure.call(ei,ai)};n.onFailure=ni}var si=this.options.resources.geocode;si&&(n.index||(n.index=si)),n.apiKey=n.apiKey||this.options.apiKey,typeof n.ssl!="boolean"&&(typeof this.options.ssl=="boolean"?n.ssl=this.options.ssl:n.ssl=!0),logger$y.log(n),Gp.Services.geocode(n)}}_fillGeocodedLocationListContainer(e){if(!e||e.length===0){this._clearGeocodedLocation();return}var n=this._geocodedContainer;if(n.childElementCount)for(;n.firstChild;)n.removeChild(n.firstChild);for(var ei=0;ei<e.length;ei++)logger$y.log(e[ei]),this._createGeocodedLocationElement(e[ei],ei);this._geocodedLocations=e}_setLabel(e){document.getElementById("GPsearchInputText-"+this._uid).value=e}_setPosition(e,n){var ei=this.getMap().getView();ei.setCenter(e),ei.setZoom(n)}_setPositionFromExtent(e){var n=this.getMap().getView();n.fit(e)}_setMarker(e,n){var ei=this.getMap(),ti=this;if(this._marker!=null&&(ei.removeOverlay(this._marker),this._marker=null),e){var ii=document.createElement("img");ii.src=this._markerUrl,ii.addEventListener?ii.addEventListener("click",function(){ti._onResultMarkerSelect(n,e)}):ii.attachEvent&&ii.attachEvent("onclick",function(){ti._onResultMarkerSelect(n,e)}),this._marker=new Overlay({position:e,positioning:"center-center",element:ii,stopEvent:!1}),ei.addOverlay(this._marker)}}_getZoom(e){var n=this.getMap(),ei=this.options.zoomTo,ti=null;if(typeof ei=="function"&&(logger$y.trace("zoom function"),ti=ei.call(this,e)),typeof ei=="number"&&(logger$y.trace("zoom level"),ti=ei),typeof ei=="string")if(ei==="auto")logger$y.trace("zoom auto"),ti=SearchEngineUtils.zoomToResultsByDefault(e);else{logger$y.trace("zoom level parsing");var ii=parseInt(ei,10);isNaN(ii)||(logger$y.trace("zoom parsing"),ti=ii)}Number.isInteger=Number.isInteger||function(si){return typeof si=="number"&&isFinite(si)&&Math.floor(si)===si},(!ti||ti===""||!Number.isInteger(ti))&&(logger$y.trace("zoom not found, current zoom..."),ti=n.getView().getZoom());var ri=n.minZoom,ni=n.maxZoom;return ti<ri&&(logger$y.trace("zoom level min..."),ti=ri),ti>ni&&(logger$y.trace("zoom level max..."),ti=ni),logger$y.trace("zoom",ti),ti}_onResultMarkerSelect(e,n=null){var ei=this.getMap();n&&ei.getView().animate({center:n,duration:250});var ti="";if(typeof e!="string")if(e.service==="GeocodedLocation"){ti="<ul>";var ii=e.location.placeAttributes;for(var ri in ii)ii.hasOwnProperty(ri)&&ri!=="trueGeometry"&&ri!=="extraFields"&&ri!=="houseNumberInfos"&&ri!=="_count"&&(ti+="<li>",ti+='<span class="gp-attname-others-span">'+ri.toUpperCase()+" : </span>",ti+=ii[ri],ti+=" </li>");ti+=" </ul>"}else e.service==="SuggestedLocation"?ti=GeocodeUtils.getSuggestedLocationFreeform(e.location):ti="sans informations.";else ti=e;this._popupContent.innerHTML=ti,this._popupOverlay?this._popupOverlay.setPosition(this._marker.getPosition()):(this._popupOverlay=new Overlay({element:this._popupDiv,positioning:"bottom-center",position:this._marker.getPosition(),offset:[0,-42]}),ei.addOverlay(this._popupOverlay))}_setSystem(e){if(typeof e!="object"){logger$y.log("[ERROR] MousePosition:addSystem - system parameter should be an object");return}if(!e.crs){logger$y.error("crs not defined !");return}if(e.label||(logger$y.warn("crs label not defined, use crs code by default."),e.label=e.crs),e.type||(logger$y.warn("type srs not defined, use 'Metric' by default."),e.type="Metric"),CRS.loadByName(e.crs),!get$3(e.crs)){logger$y.error("crs '{}' not available into proj4 definitions !",e.crs);return}for(var n=0;n<this._coordinateSearchSystems.length;n++){var ei=this._coordinateSearchSystems[n];e.crs===ei.crs&&logger$y.info("crs '{}' already configured",ei.crs)}e.code=this._coordinateSearchSystems.length,this._coordinateSearchSystems.push(e)}onShowSearchEngineClick(e){e.target.ariaPressed==="true"&&this.onPanelOpen();var n=this.getMap();Interactions.unset(n);var ei=this._showSearchEngineButton.ariaPressed;this.collapsed=ei!=="true",this.dispatchEvent("change:collapsed"),this.options.position&&!this.collapsed&&this.updatePosition(this.options.position),this.collapsed&&this._clearResults()}onSearchResetClick(){this._clearResults()}onShowSearchGeolocateClick(){"geolocation"in navigator&&navigator.geolocation.getCurrentPosition(e=>{var n=this.getMap().getView(),ei=n.getProjection().getCode(),ti=[e.coords.longitude,e.coords.latitude],ii;if(ei!=="EPSG:4326"?ii=transform$1(ti,"EPSG:4326",ei):ii=ti,isNaN(ii[0])||isNaN(ii[1])){this._setMarker();return}if(this._setPosition(ii,15),this._displayMarker){var ri="<h6> Ma position </h6> latitude : "+ti[1]+"<br/> longitude : "+ti[0];this._setMarker(ii,ri)}this.dispatchEvent({type:"searchengine:geolocation:click",coordinates:ii})})}onShowSearchByCoordinateClick(){var e=null,n=null;if(this._coordinateSearchLngInput&&this._coordinateSearchLngInput.nodeName==="DIV"&&this._coordinateSearchLatInput&&this._coordinateSearchLatInput.nodeName==="DIV"?(e=this._getCoordinateSearchDMS(this._coordinateSearchLngInput),n=this._getCoordinateSearchDMS(this._coordinateSearchLatInput)):(e=this._coordinateSearchLngInput.value,n=this._coordinateSearchLatInput.value),!(!e||!n)){var ei=[e,n],ti=this.getMap().getView(),ii=ti.getProjection().getCode();if(ii!=="EPSG:4326"&&(ei=transform$1(ei,"EPSG:4326",ii)),isNaN(ei[0])||isNaN(ei[1])){this._setMarker();return}this._setPosition(ei,10),this._displayMarker&&this._setMarker(ei,n+", "+e),this.dispatchEvent({type:"searchengine:coordinates:click",coordinates:ei})}}_getCoordinateSearchDMS(e){if(e&&e.nodeName==="DIV"){var n=e.querySelectorAll("[name]");if(n){var ei=MathUtils.toInteger(n[0].value),ti=MathUtils.toInteger(n[1].value),ii=MathUtils.toInteger(n[2].value),ri=n[3].options[n[3].selectedIndex].text;return!ei||!ti||!ii||!ri?void 0:MathUtils.dmsToDecimal(ei,ti,ii,ri)}}}onAutoCompleteInputClick(){var e=document.getElementById("GPsearchInputText-"+this._uid);e&&!e.disabled&&e.value.length>2&&this._displaySuggestedLocation()}onAutoCompleteSearchText(e){var n=e.target.value;if(n){if(this._currentGeocodingLocation=n,n.length<3){this._clearSuggestedLocation();return}var ei=this.options.autocompleteOptions.triggerGeocode,ti=this.options.autocompleteOptions.triggerDelay,ii=this.options.autocompleteOptions.maximumEntries,ri=this.options.autocompleteOptions.prettifyResults,ni=this;this._requestAutoComplete({text:n,onSuccess:function(ai){if(logger$y.log("request from AutoComplete",ai),ai){ni._suggestedLocations=ai.suggestedLocations,ni._locationsToBeDisplayed=[];for(var oi=0;oi<ni._suggestedLocations.length;oi++){var li=ni._suggestedLocations[oi];li.position&&li.position.x===0&&li.position.y===0&&li.fullText?ni._getGeocodeCoordinatesFromFullText(li,oi):ni._locationsToBeDisplayed.push(li)}ri===!0&&ni._prettifyAutocompleteResults(ni._locationsToBeDisplayed),ii&&(ni._locationsToBeDisplayed=ni._locationsToBeDisplayed.slice(0,ii)),ni._fillAutoCompletedLocationListContainer(ni._locationsToBeDisplayed),ni._triggerHandler&&(clearTimeout(ni._triggerHandler),ni._triggerHandler=null,logger$y.warn("Cancel a geocode request !"))}},onFailure:function(ai){ni._clearSuggestedLocation(),logger$y.log(ai.message),ai.message==="No suggestion matching the search"&&ei&&(ni._triggerHandler&&(clearTimeout(ni._triggerHandler),logger$y.warn("Cancel the last geocode request !")),ni._triggerHandler=setTimeout(function(){logger$y.warn("Launch a geocode request !"),ni._requestGeocoding({location:n,onSuccess:function(oi){if(logger$y.log("request from Geocoding",oi),oi){ni._locationsToBeDisplayed=[];for(var li=oi.locations,ci=0;ci<li.length;ci++){var ui=li[ci];ui.fullText=GeocodeUtils.getGeocodedLocationFreeform(ui),ui.position={x:ui.position.lon,y:ui.position.lat},ni._locationsToBeDisplayed.push(ui)}ni._fillAutoCompletedLocationListContainer(li)}},onFailure:function(oi){logger$y.log(oi.message)}})},ti))}}),this.options.resources.search&&Search$1.suggest(n);var ni=this,si=this.getMap();si.once("click",function(){ni._hideSuggestedLocation()}),si.once("pointerdrag",function(){ni._hideSuggestedLocation()})}}_getGeocodeCoordinatesFromFullText(e,n){var ei=this;Gp.Services.geocode({apiKey:this.options.apiKey,ssl:this.options.ssl,q:GeocodeUtils.getSuggestedLocationFreeform(e),index:e.type,onSuccess:function(ti){logger$y.log("request from Geocoding (coordinates null)",ti),ti.locations&&ti.locations.length!==0&&ti.locations[0].position&&ei._suggestedLocations&&ei._suggestedLocations[n]&&(ei._suggestedLocations[n].position={lon:ti.locations[0].position.y,lat:ti.locations[0].position.x},ei._locationsToBeDisplayed.unshift(ei._suggestedLocations[n]),ei._fillAutoCompletedLocationListContainer(ei._locationsToBeDisplayed))},onFailure:function(){ei._suggestedLocations&&ei._suggestedLocations[n]&&ei._createAutoCompletedLocationElement(ei._suggestedLocations[n],n)}})}onAutoCompletedResultsItemClick(e){var n=SelectorID.index(e.target.id);if(logger$y.log(n),logger$y.log(this._locationsToBeDisplayed[n]),!!n){var ei=[this._locationsToBeDisplayed[n].position.x,this._locationsToBeDisplayed[n].position.y],ti={service:"SuggestedLocation",location:this._locationsToBeDisplayed[n]},ii=GeocodeUtils.getSuggestedLocationFreeform(this._locationsToBeDisplayed[n]);this._setLabel(ii),this._currentGeocodingLocation=ii;var ri=this.getMap().getView(),ni=ri.getProjection().getCode();ni!=="EPSG:4326"&&(ei=transform$1(ei,"EPSG:4326",ni)),this._requestGeocoding({index:"address,poi",limit:1,returnTrueGeometry:!0,location:ii,onSuccess:si=>{if(si.locations[0].placeAttributes.truegeometry){var ai=JSON.parse(si.locations[0].placeAttributes.truegeometry);if(ai.type==="Point")this._setPosition(ei,15);else{var oi=new GeoJSON$1,li=oi.readGeometry(ai,{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"}),ci=li.getExtent();this._setPositionFromExtent(ci)}}else this._setPosition(ei,15);this._displayMarker&&this._setMarker(ei,ti);var ui=document.getElementById(this._addUID("GPautocompleteResults"));if(ui){var di=ui.getElementsByClassName("GPautoCompleteProposal gpf-panel__items gpf-panel__items_searchengine");for(let hi=0;hi<di.length;hi++){const pi=di[hi];pi.className="GPautoCompleteProposal gpf-panel__items gpf-panel__items_searchengine"}var fi=di[n];fi.className="GPautoCompleteProposal gpf-panel__items gpf-panel__items_searchengine current",this.dispatchEvent({type:"searchengine:autocomplete:click",location:this._locationsToBeDisplayed[n]})}},onFailure:si=>{logger$y.warn(si);var ai=this._getZoom(ti);this._setPosition(ei,ai),this._displayMarker&&this._setMarker(ei,ti);var oi=document.getElementById(this._addUID("GPautocompleteResults"));if(oi){var li=oi.getElementsByClassName("GPautoCompleteProposal gpf-panel__items gpf-panel__items_searchengine");for(let ui=0;ui<li.length;ui++){const di=li[ui];di.className="GPautoCompleteProposal gpf-panel__items gpf-panel__items_searchengine"}var ci=li[n];ci.className="GPautoCompleteProposal gpf-panel__items gpf-panel__items_searchengine current",this.dispatchEvent({type:"searchengine:autocomplete:click",location:this._locationsToBeDisplayed[n]})}}})}}onSearchedResultsItemClick(e){var n=SelectorID.index(e.target.id),ei=null;try{var ti=Search$1.getSuggestions()[n];if(!ti)throw"No suggestions found !";if(this.options.searchOptions.addToMap){if(!Config.isConfigLoaded())throw"ERROR : contract key configuration has to be loaded to load Geoportal layers.";var ii=ti.service,ri=ti.name,ni=null;switch(ii){case"WMS":ni=new LayerWMS({layer:ri});break;case"WMTS":ni=new LayerWMTS({layer:ri});break;case"WFS":ni=new LayerWFS({layer:ri});break;case"TMS":ni=new LayerMapBox({layer:ri},{declutter:!0});default:break}if(ni){var si=this.getMap();si.addLayer(ni)}}}catch(ai){ei=ai}this.dispatchEvent({type:"searchengine:search:click",suggest:ti,error:ei})}onGeocodingSearchSubmit(e){var n=e.target[0].value;if(n){this._currentGeocodingLocation=n;var ei=this;this._requestGeocoding({query:n,onSuccess:function(ti){if(logger$y.log("request from Geocoding",ti),ti){var ii=ti.locations;ei._fillGeocodedLocationListContainer(ii)}},onFailure:function(ti){ei._clearGeocodedLocation(),logger$y.log(ti.message)}})}}onGeocodedResultsItemClick(e){var n=SelectorID.index(e.target.id);if(n){var ei=[this._geocodedLocations[n].position.lon,this._geocodedLocations[n].position.lat],ti={service:"GeocodedLocation",location:this._geocodedLocations[n]},ii=GeocodeUtils.getGeocodedLocationFreeform(this._geocodedLocations[n]);this._setLabel(ii);var ri=this.getMap().getView(),ni=ri.getProjection().getCode();ni!=="EPSG:4326"&&(ei=transform$1(ei,"EPSG:4326",ni));var si=this._getZoom(this.options.zoomTo);this._setPosition(ei,si),this._displayMarker&&this._setMarker(ei,ti),this.dispatchEvent({type:"searchengine:geocode:click",location:this._geocodedLocations[n]}),this._clearSuggestedLocation(),this._showSearchEngineAdvancedButton.click()}}onGeocodingAdvancedSearchCodeChange(e){logger$y.log(e);var n=e.target.selectedIndex,ei=e.target.options[n].value;ei&&this._setFilter(ei)}onGeocodingAdvancedSearchSubmit(e,n){if(logger$y.log(n),!(!n||n.length===0)){for(var ei,ti={},ii=0;ii<n.length;ii++){var ri=n[ii];ri.value&&(ri.key==="section"&&(ri.value=ri.value.toUpperCase()),ti[ri.key]=ri.value)}var ni=document.getElementById("GPsearchInputText-"+this._uid);ei=ni.value,this._currentGeocodingCode==="CadastralParcel"&&(ei=""),this._currentGeocodingCode==="StreetAddress"&&(ei=`${ti.address} ${ti.postcode} ${ti.city}`,ti={}),this._currentGeocodingCode==="PositionOfInterest"&&(ei=ti.q,delete ti.q);var si=this;this._requestGeocoding({query:ei,index:this._currentGeocodingCode,filters:ti,onSuccess:function(ai){if(logger$y.log(ai),ai){var oi=ai.locations;si._fillGeocodedLocationListContainer(oi)}},onFailure:function(ai){si._clearGeocodedLocation(),logger$y.log(ai.message)}})}}_getCadastralParcelRequestParams(e){var n="",ei,ti=e.department;ti?(ei=ti.length,ei===2?n=ti:ei===1?n="0"+ti:n=ti.substring(0,2)):n="__";var ii=e.commune;ii?(ei=ii.length,ei===3?n+=ii:ei===2?n+="_"+ii:ei===1?n+="__"+ii:n+=ii.substring(0,3)):n+="___";var ri=e.insee;ri&&ri.length===5&&(n=ri);var ni=e.absorbedCity;ni?(ei=ni.length,ei===3?n+=ni:ei<3?ei===2?n+="_"+ni:ei===1&&(n+="__"+ni):n+=ni.substring(0,3)):n+="___";var si=e.section;si?(ei=si.length,ei===2?n+=si:ei===1?n+="_"+si:n+=si.substring(0,2)):n+="__";var ai=e.number;return ai?(ei=ai.length,ei===4?n+=ai:ei===3?n+="_"+ai:ei===2?n+="__"+ai:ei===1?n+="___"+ai:n+=ai.substring(0,4)):n+="___",logger$y.log("location : "+n),n}onCoordinateSearchSystemChange(e){var n=e.target.selectedIndex,ei=e.target.options[n].value;this._coordinateSearchLngInput.value="",this._coordinateSearchLatInput.value="";for(var ti=null,ii=0;ii<this._coordinateSearchSystems.length;++ii)if(this._coordinateSearchSystems[ii].code===Number(ei)){ti=this._coordinateSearchSystems[ii].type;break}if(!ti){logger$y.log("system not found in projection systems container");return}this._currentCoordinateSearchSystems=this._coordinateSearchSystems[Number(ei)],ti!==this._currentCoordinateSearchType&&(this._currentCoordinateSearchType=ti,this._currentCoordinateSearchUnits=this._coordinateSearchUnits[ti][0].code,this._containerUnits.appendChild(this._setCoordinateSearchUnitsSelectElement(this._coordinateSearchUnits[ti])),this._updateCoordinateSearchElements())}onCoordinateSearchUnitsChange(e){var n=e.target.selectedIndex,ei=e.target.options[n].value;this._coordinateSearchLngInput.value="",this._coordinateSearchLatInput.value="",this._currentCoordinateSearchUnits=ei,this._updateCoordinateSearchElements()}onCoordinateSearchClose(){this._setMarker(),this._coordinateSearchLngInput.value="",this._coordinateSearchLatInput.value=""}_updateCoordinateSearchElements(){var e=this._setCoordinateSearchLngLabelElement(this._currentCoordinateSearchType),n=this._coordinateSearchLngInput=this._setCoordinateSearchLngInputElement(this._currentCoordinateSearchUnits);this._containerCoordinateLng.appendChild(e),this._containerCoordinateLng.appendChild(n),e=this._setCoordinateSearchLatLabelElement(this._currentCoordinateSearchType),n=this._coordinateSearchLatInput=this._setCoordinateSearchLatInputElement(this._currentCoordinateSearchUnits),this._containerCoordinateLat.appendChild(e),this._containerCoordinateLat.appendChild(n)}_clearResults(){var e=this.getMap();this._currentGeocodingLocation=null,this._clearSuggestedLocation(),this._clearGeocodedLocation(),this._setMarker(),this._popupOverlay!=null&&(e.removeOverlay(this._popupOverlay),this._popupOverlay=null)}_clearSuggestedLocation(){if(this._suggestedLocations=[],this._containerResultsLocation)for(;this._containerResultsLocation.firstChild;)this._containerResultsLocation.removeChild(this._containerResultsLocation.firstChild);if(this.options.resources.search&&(Search$1.clear(),this._containerResultsSuggest))for(;this._containerResultsSuggest.firstChild;)this._containerResultsSuggest.removeChild(this._containerResultsSuggest.firstChild)}_prettifyAutocompleteResults(e){for(var n=e.length-1;n>=0;n--){var ei=e[n];(ei.type==="StreetAddress"&&ei.kind==="municipality"||ei.type==="PositionOfInterest"&&ei.poiType[0]==="lieu-dit habit"&&ei.poiType[1]==="zone d'habitation")&&e.splice(n,1),ei.type==="PositionOfInterest"&&ei.poiType[0]==="administratif"&&(ei.poiType[1]==="dpartement"||ei.poiType[1]==="rgion")&&(ei.fullText=ei.fullText+", "+ei.poiType[1])}}_hideSuggestedLocation(){this._autocompleteContainer&&(this._autocompleteContainer.classList.replace("GPelementVisible","GPelementHidden"),this._autocompleteContainer.classList.replace("gpf-visible","gpf-hidden"))}_displaySuggestedLocation(){this._autocompleteContainer&&(this._autocompleteContainer.classList.replace("GPelementHidden","GPelementVisible"),this._autocompleteContainer.classList.replace("gpf-hidden","gpf-visible"))}_clearGeocodedLocation(){if(this._geocodedLocations=[],this._geocodedContainer)for(;this._geocodedContainer.firstChild;)this._geocodedContainer.removeChild(this._geocodedContainer.firstChild)}}Object.assign(SearchEngine.prototype,SearchEngineDOM);Object.assign(SearchEngine.prototype,Widget);window.ol&&window.ol.control&&(window.ol.control.SearchEngine=SearchEngine);LoggerByDefault.getLogger("searchengine");class AbstractSearchService extends BaseObject{constructor(e){if(e=e||{},super(e),this.constructor==AbstractSearchService)throw new TypeError("AbstractSearchService cannot be instantiate");return this.CLASSNAME="AbstractSearchService",this.initialize(e),this}initialize(e){this.AUTOCOMPLETE_EVENT="autocomplete",this.SEARCH_EVENT="search",this.ERROR_EVENT="error",this._autocompleteLocations=[],this._locations=[],e.autocomplete===!1&&this.set("autocomplete",!1),this.set("index",e.index||"address,poi"),this.set("limit",typeof e.limit=="number"?e.limit:1),this.set("returnTrueGeometry",!!e.returnTrueGeometry)}getAutocompleteLocations(e){return e===void 0?this._autocompleteLocations:this._autocompleteLocations[e]}getResult(e){return e===void 0?this._locations:this._locations[e]}autocomplete(e){}search(e){}getItemTitle(e){return e}}window.ol&&(window.ol.service||(window.ol.service={}),window.ol.service.AbstractSearchService=AbstractSearchService);LoggerByDefault.getLogger("searchengine");class DefaultSearchService extends AbstractSearchService{constructor(e){e=e||{},super(e),this.CLASSNAME="DefaultSearchService",e.searchTab&&(this._searchTab=e.searchTab||[])}autocomplete(e){this._autocompleteLocations=[];const n=new RegExp(e,"i");(this._searchTab||[]).forEach(ei=>{n.test(ei.toLowerCase())&&this._autocompleteLocations.push(ei)}),this.dispatchEvent({type:this.AUTOCOMPLETE_EVENT,result:this._autocompleteLocations})}search(e){this.dispatchEvent({type:this.SEARCH_EVENT,result:e})}}window.ol&&(window.ol.service||(window.ol.service={}),window.ol.service.DefaultSearchService=DefaultSearchService);const history$1="fr-icon-history-line",defaultIcon="fr-icon-map-pin-2-line",typeClasses={StreetAddress:"fr-icon-map-pin-2-line",PositionOfInterest:{administratif:"fr-icon-france-line",hydrographie:"fr-icon-ign-mer",transport:{"tlcabine, tlphrique transport par cble":"fr-icon-subway-line","gare voyageurs uniquement":"fr-icon-subway-line","voyageurs et fret":"fr-icon-subway-line","station de mtro":"fr-icon-subway-line","gare fret uniquement":"fr-icon-subway-line","gare routire":"fr-icon-subway-line","station de tramway":"fr-icon-subway-line","arrt voyageurs":"fr-icon-subway-line",arodrome:"fr-icon-plane-line",hliport:"fr-icon-plane-line",altiport:"fr-icon-plane-line",arogare:"fr-icon-plane-line",port:"fr-icon-ship-2-line","gare maritime":"fr-icon-ship-2-line",parking:"fr-icon-parking-box-line","aire de repos ou de service":"fr-icon-parking-box-line","service ddi aux vlos":"fr-icon-bike-line"}}};LoggerByDefault.getLogger("searchengine");class SearchEngineBase extends ControlExtended{constructor(e){if(e=e||{},super(e),this.CLASSNAME="SearchEngineBase",this.initialize(e),this.searchService=e.searchService,this.searchService.get("autocomplete")!==!1&&this.searchService.on("autocomplete",(function(n){this.onAutocomplete(n)}).bind(this)),this.searchService.on("search",(function(n){this.onSearch(n)}).bind(this)),this._initContainer(e),this._initEvents(e),this._historic=!1,this._historicName="GPsearch-"+e.historic,e.historic!==!1&&this.searchService.get("autocomplete")!==!1){this._historic=[];try{const n=window.localStorage.getItem(this._historicName);n&&(this._historic=JSON.parse(n))}catch{}}this.showHistoric()}initialize(e){e.minChars=e.minChars?e.minChars:3,e.maximumEntries=typeof e.maximumEntries=="number"?e.maximumEntries:5,e.historic=typeof e.historic=="string"?e.historic:this.CLASSNAME,e.title=e.title?e.title:"Rechercher",e.ariaLabel=e.ariaLabel?e.ariaLabel:"Rechercher",e.placeholder=e.placeholder?e.placeholder:"",e.searchService=e.searchService?e.searchService:new DefaultSearchService,e.label=e.label?e.label:"",e.hint=e.hint?e.hint:"",e.search=e.search===!0,e.searchButton=e.searchButton===!0,e.collapsible=e.collapsible===!0,this.set("maximumEntries",e.maximumEntries)}_initEvents(e){this.searchService.get("autocomplete")!==!1&&(this.input.addEventListener("input",(function(n){n.target.value.length>0?n.target.dataset.erase=!0:delete n.target.dataset.erase,console.log("input",n,n.target.value),n.target.value||this.showHistoric()}).bind(this)),this.input.addEventListener("keydown",(function(n){/ArrowDown|ArrowUp/.test(n.key)&&n.preventDefault()}).bind(this)),this.input.addEventListener("keyup",(function(n){const ei=Array.from(this.autocompleteList.querySelectorAll("li"));let ti=ei.findIndex(ii=>ii.classList.contains("active"));switch(ti===-1&&(this._previousValue=n.target.value),n.key){case"ArrowDown":case"ArrowUp":if(n.preventDefault(),ei.length===0)return;if(ei.forEach(ii=>ii.classList.remove("active")),n.key==="ArrowDown"?(ti++,ti>=ei.length&&(ti=-1)):n.key==="ArrowUp"&&(ti--,ti<-1&&(ti=ei.length-1)),ti!==-1){const ii=ei[ti];ii.classList.add("active"),this.input.value=ii.innerText,this.input.setAttribute("aria-activedescendant",ii.id),this.input.setAttribute("data-active-option",ii.id)}else n.target.value=this._previousValue;this.input.dispatchEvent(new Event("input"));break;default:n.target.value.length&&n.target.value.length>=e.minChars&&n.target.value!==this._currentValue&&this.autocomplete(n.target.value);break}this._currentValue=n.target.value}).bind(this),!1)),this.container.addEventListener("submit",(function(n){n.preventDefault();const ei=Array.from(this.autocompleteList.querySelectorAll("li"));if(n&&n.submitter&&n.submitter.type==="submit"&&n.target.querySelector("input").value.length<e.minChars)return!1;let ti=ei.findIndex(ri=>ri.classList.contains("active")),ii=ei[ti];ti<0&&(ii=ei[0]),ii&&ii.click()}).bind(this))}_initContainer(e){const n=this.element=document.createElement("div");n.className="GPwidget gpf-widget",n.id=Helper.getUid("GPsearchEngine-");const ei=this.container=document.createElement("form");ei.className=e.search?"GPSearchBar":"",ei.id=Helper.getUid("GPsearchInput-Base-"),!e.target&&e.collapsible&&(this.button=document.createElement("button"),this.button.id=Helper.getUid("GPshowSearchEnginePicto-"),this.button.className="GPshowOpen GPshowAdvancedToolPicto GPshowSearchEnginePicto gpf-btn fr-icon-search-line fr-btn fr-btn--lg",this.button.setAttribute("aria-pressed","true"),e.title&&this.button.setAttribute("title",e.title),e.collapsible&&this.button.addEventListener("click",(function(){n.classList.toggle("ol-collapsed");const li=this.button.getAttribute("aria-pressed")==="true";this.button.setAttribute("aria-pressed",!li),li?ii.blur():ii.focus()}).bind(this)),n.appendChild(this.button)),n.appendChild(ei);const ti=document.createElement("div");ti.className="GPInputGroup",ti.classList.add(e.search?"fr-input":"fr-input-group"),ei.appendChild(ti);const ii=this.input=document.createElement("input");if(ii.type="text",ii.className="GPsearchInputText fr-input",ii.id=Helper.getUid("GPsearchInputText-"),ii.placeholder=e.placeholder,ii.autocomplete="off",ii.setAttribute("aria-label",e.ariaLabel),e.label){const li=document.createElement("label");if(li.className="GPLabel fr-label",li.textContent=e.label,li.htmlFor=ii.id,e.hint){const ci=document.createElement("span");ci.className="GPLabelHint fr-hint-text",ci.textContent=e.hint,li.appendChild(ci)}ti.appendChild(li)}ti.appendChild(ii);const ri=document.createElement("div");if(ri.className="GPMessagesGroup fr-messages-group",ri.ariaLive="polite",ri.id=Helper.getUid("GPMessagesGroup-"),ii.setAttribute("aria-describedby",ri.id),ti.appendChild(ri),this.optionscontainer=document.createElement("div"),this.optionscontainer.className="GPOptionsContainer",ti.appendChild(this.optionscontainer),e.searchButton){const li=this.subimtBt=document.createElement("button");li.className="GPsearchInputSubmit gpf-btn fr-icon-search-line fr-btn",li.id=Helper.getUid("GPshowSearchEnginePicto-"),li.type="submit",e.title&&li.setAttribute("title",e.title),ei.appendChild(li)}const ni=this.acContainer=document.createElement("div");ni.id=Helper.getUid("GPautoCompleteContainer-"),ni.className="GPautoCompleteContainer GPelementHidden gpf-hidden",n.appendChild(ni);const si=this.autocompleteHeader=document.createElement("div");si.className="GPautoCompleteHeader",ni.appendChild(si);const ai=this.autocompleteList=document.createElement("ul");ai.className="GPautoCompleteList",ai.id=Helper.getUid("GPautoCompleteList-"),ai.setAttribute("role","listbox"),ai.setAttribute("tabindex","-1"),ai.setAttribute("aria-label","Propositions"),ni.appendChild(ai);const oi=this.autocompleteFooter=document.createElement("div");oi.className="GPautoCompleteFooter",ni.appendChild(oi),ii.setAttribute("role","combobox"),ii.setAttribute("aria-controls",ni.id),ii.setAttribute("aria-expanded","false"),ii.setAttribute("aria-autocomplete","list"),ii.setAttribute("aria-haspopup","listbox"),this.searchService.get("autocomplete")!==!1&&(ii.addEventListener("focus",()=>{ii.setAttribute("aria-expanded","true"),ni.classList.add("gpf-visible"),ni.classList.remove("gpf-hidden"),ni.classList.add("GPelementVisible"),ni.classList.remove("GPelementHidden")}),ii.addEventListener("blur",li=>{li.relatedTarget&&ni.contains(li.relatedTarget)?li.relatedTarget.tagName!=="BUTTON"?ii.focus():li.relatedTarget.addEventListener("blur",ci=>{var ui;ci.relatedTarget&&ni.contains(ci.relatedTarget)||ci.relatedTarget===ii?ii.focus():(ii.value.length===0&&(delete ii.dataset.erase,(ui=ci.relatedTarget.parentNode.querySelector("button"))==null||ui.focus()),setTimeout(()=>{ii.setAttribute("aria-expanded","false"),ni.classList.remove("gpf-visible"),ni.classList.add("gpf-hidden"),ni.classList.remove("GPelementVisible"),ni.classList.add("GPelementHidden")},50))},{once:!0}):(ii.value.length===0&&delete ii.dataset.erase,setTimeout(()=>{ii.setAttribute("aria-expanded","false"),ni.classList.remove("gpf-visible"),ni.classList.add("gpf-hidden"),ni.classList.remove("GPelementVisible"),ni.classList.add("GPelementHidden")},50))}))}setActive(e){this.input.disabled=!!e,this.subimtBt.disabled=!!e}autocomplete(e){clearTimeout(this._completeDelay),this._completeDelay=setTimeout((function(){this.searchService.autocomplete(e)}).bind(this),this.get("triggerDelay")||100)}onAutocomplete(e){clearTimeout(this._completeDelay),this._updateList(e.result),this.dispatchEvent(e)}search(e){clearTimeout(this._completeDelay),this._completeDelay=setTimeout((function(){this.searchService.search(e)}).bind(this),this.get("triggerDelay")||100)}onSearch(e){clearTimeout(this._completeDelay),this.dispatchEvent(e)}select(e){clearTimeout(this._completeDelay);const n=this.getItemTitle(e);this.input.value=n,this.input.dispatchEvent(new Event("input")),this._currentValue=n,this._updateHistoric(e),this._updateList(),this.dispatchEvent({type:"select",title:this.getItemTitle(e),item:e})}showHistoric(){clearTimeout(this._completeDelay),this._historic&&this._updateList(this._historic.length?this._historic:[],"history")}_updateList(e,n="search"){this.autocompleteList.parentNode.dataset.type=n,e=(e||[]).slice(0,this.get("maximumEntries")),this.autocompleteList.querySelectorAll("li").forEach(ei=>ei.classList.remove("active")),this.input.setAttribute("aria-activedescendant",""),this.input.setAttribute("data-active-option",""),this.autocompleteList.innerHTML="",e.forEach((ei,ti)=>{const ii=document.createElement("li"),ri=this.getIconClass(ei,n);if(ii.id=Helper.getUid("GPsearchResult-"),ii.className=`GPsearchResult gpf-panel__item gpf-panel__item-searchengine ${ri} fr-icon--sm`,ii.setAttribute("role","option"),ii.setAttribute("data-idx",ti),ii.innerHTML=ii.title=this.getItemTitle(ei),n==="history"){ii.classList.add("GPsearchHistoric");const ni=document.createElement("span");ni.ariaHidden="true",ni.className=`${history$1} fr-icon--sm`,ii.append(ni)}this.autocompleteList.appendChild(ii),ii.addEventListener("click",(function(ni){const si=Number(ni.target.getAttribute("data-idx"));this.select(e[si]),this.search({location:e[si]})}).bind(this))})}getIconClass(e,n){let ei=typeClasses[e.type];if(typeof ei=="object"){for(let ti=0;ti<e.poiType.length;ti++){const ii=e.poiType[ti];if(Object.hasOwn(ei,ii)){ei=ei[ii];break}}if(typeof ei=="object")for(let ti=0;ti<e.poiType.length;ti++){const ii=e.poiType[ti];if(Object.hasOwn(ei,ii)){ei=ei[ii];break}}ei=typeof ei=="object"?defaultIcon:ei}return ei}getItemTitle(e){return this.searchService.getItemTitle(e)}_updateHistoric(e){if(this._historic){let n=-1;for(let ti=0;ti<this._historic.length;ti++){const ii=this._historic[ti];if(this._isEqual(ii,e)){n=ti;break}}n!==-1&&this._historic.splice(n,1),this._historic.unshift(e)>this.get("maximumEntries")&&this._historic.pop(),localStorage.setItem(this._historicName,JSON.stringify(this._historic))}}_isEqual(e,n){const ei=JSON.stringify(e),ti=JSON.stringify(n);return ei===ti}addMessage(e,n="error"){var ti;let ei=this.input.ariaDescribedByElements[0];if(ei){const ii=document.createElement("p"),ri=n==="error"?"error":"valid";ii.className=`GPMessage GPMessage--${ri} fr-message fr-message--${ri}`,ii.id=Helper.getUid("GPMessage-"),ii.textContent=e,(ti=ei.parentElement)==null||ti.classList.forEach(ni=>{var si;/^fr-.*-group$/.test(ni)&&((si=ei.parentElement)==null||si.classList.add(`${ni}--${ri}`))}),ei.replaceChildren(ii)}}removeMessages(){var n;let e=this.input.ariaDescribedByElements[0];e&&(e.replaceChildren(),(n=e.parentElement)==null||n.classList.forEach(ei=>{var ti;/^fr-.*-group--/.test(ei)&&((ti=e.parentElement)==null||ti.classList.remove(ei))}))}}window.ol&&window.ol.control&&(window.ol.control.SearchEngineBase=SearchEngineBase);var logger$x=LoggerByDefault.getLogger("searchengine");class IGNSearchService extends AbstractSearchService{constructor(e){if(e=e||{},super(e),!(this instanceof IGNSearchService))throw new TypeError("ERROR CLASS_CONSTRUCTOR");return this.CLASSNAME="IGNSearchService",this}initialize(e){super.initialize(e),this.options={searchOptions:{maximumEntries:5,serviceOptions:{maximumResponses:10},filterLayers:!0},geocodeOptions:{serviceOptions:{}},autocomplete:!0,autocompleteOptions:{serviceOptions:{maximumResponses:10},triggerGeocode:!1,triggerDelay:1e3,prettifyResults:!0}},Helper.mergeParams(this.options,e),this.options.searchOptions&&(this.options.searchOptions.serviceOptions&&(this.options.searchOptions.serviceOptions.url&&Search$1.setUrl(this.options.searchOptions.serviceOptions.url),this.options.searchOptions.serviceOptions.fields&&Search$1.setFields(this.options.searchOptions.serviceOptions.fields),this.options.searchOptions.serviceOptions.index&&Search$1.setIndex(this.options.searchOptions.serviceOptions.index),this.options.searchOptions.serviceOptions.size&&Search$1.setSize(this.options.searchOptions.serviceOptions.size),this.options.searchOptions.serviceOptions.maximumResponses&&Search$1.setMaximumResponses(this.options.searchOptions.serviceOptions.maximumResponses)),this.options.searchOptions.filterServices&&Search$1.setFiltersByService(this.options.searchOptions.filterServices),this.options.searchOptions.filterLayersPriority&&Search$1.setFiltersByLayerPriority(this.options.searchOptions.filterLayersPriority),this.options.searchOptions.filterWMTSPriority&&Search$1.setFilterWMTSPriority(this.options.searchOptions.filterWMTSPriority),this.options.searchOptions.filterTMS===!1&&Search$1.setFilterTMS(this.options.searchOptions.filterTMS),this.options.searchOptions.filterProjections&&Search$1.setFiltersByProjection(this.options.searchOptions.filterProjections)),Search$1.target.addEventListener("suggest",n=>{logger$x.debug(n);let ei=n.detail;ei=this._filterResultsFromConfigLayers(ei),this._fillSearchedSuggestListContainer(ei)}),this._currentGeocodingLocation,this._suggestedLocations}autocomplete(e){e&&(this._currentGeocodingLocation=e,this._requestAutoComplete({text:e,onSuccess:this._onSuccessAutoComplete.bind(this),onFailure:this._onFailureAutoComplete.bind(this)}))}getItemTitle(e){return e.fullText}_requestAutoComplete(e){if(!e||typeof e=="object"&&Object.keys(e).length===0||!e.text)return;logger$x.log(e);let n={};Helper.assign(n,this.options.autocompleteOptions.serviceOptions),Helper.assign(n,e),n.apiKey=n.apiKey||this.options.apiKey,typeof n.ssl!="boolean"&&(typeof this.options.ssl=="boolean"?n.ssl=this.options.ssl:n.ssl=!0),logger$x.log(n),Gp.Services.autoComplete(n)}_onSuccessAutoComplete(e){let n=this.options.autocompleteOptions.maximumEntries,ei=this.options.autocompleteOptions.prettifyResults;if(logger$x.log("request from AutoComplete",e),e){this._suggestedLocations=e.suggestedLocations,this._autocompleteLocations=[];for(let ti=0;ti<this._suggestedLocations.length;ti++){let ii=this._suggestedLocations[ti];ii.position&&ii.position.x===0&&ii.position.y===0&&ii.fullText?this._getGeocodeCoordinatesFromFullText(ii,ti):this._autocompleteLocations.push(ii)}ei===!0&&this._prettifyAutocompleteResults(this._autocompleteLocations),n&&(this._autocompleteLocations=this._autocompleteLocations.slice(0,n)),this._triggerHandler&&(clearTimeout(this._triggerHandler),this._triggerHandler=null,logger$x.warn("Cancel a geocode request !")),this.dispatchEvent({type:this.AUTOCOMPLETE_EVENT,result:this._autocompleteLocations})}}_onFailureAutoComplete(e){let n=this.options.autocompleteOptions.triggerGeocode,ei=this.options.autocompleteOptions.triggerDelay,ti=function(ii){if(logger$x.log("request from Geocoding",ii),ii){this._clearResults();let ri=ii.locations;for(let ni=0;ni<ri.length;ni++){let si=ri[ni];si.fullText=GeocodeUtils.getGeocodedLocationFreeform(si),si.position={x:si.position.lon,y:si.position.lat},this._autocompleteLocations.push(si)}}this.dispatchEvent({type:this.AUTOCOMPLETE_EVENT,result:this._autocompleteLocations})};this._clearResults(),logger$x.log(e.message),e.message==="No suggestion matching the search"&&n&&(this._triggerHandler&&(clearTimeout(this._triggerHandler),logger$x.warn("Cancel the last geocode request !")),this._triggerHandler=setTimeout(function(){logger$x.warn("Launch a geocode request !"),this._requestGeocoding({location:value,onSuccess:ti.bind(this),onFailure:function(ii){logger$x.log(ii.message)}})},ei))}_prettifyAutocompleteResults(e){for(let n=e.length-1;n>=0;n--){const ei=e[n];(ei.type==="StreetAddress"&&ei.kind==="municipality"||ei.type==="PositionOfInterest"&&ei.poiType[0]==="lieu-dit habit"&&ei.poiType[1]==="zone d'habitation")&&e.splice(n,1),ei.type==="PositionOfInterest"&&ei.poiType[0]==="administratif"&&(ei.poiType[1]==="dpartement"||ei.poiType[1]==="rgion")&&(ei.fullText=ei.fullText+", "+ei.poiType[1])}}_getGeocodeCoordinatesFromFullText(e,n){var ei=this;Gp.Services.geocode({apiKey:this.options.apiKey,ssl:this.options.ssl,q:GeocodeUtils.getSuggestedLocationFreeform(e),index:e.type,onSuccess:function(ti){logger$x.log("request from Geocoding (coordinates null)",ti),ti.locations&&ti.locations.length!==0&&ti.locations[0].position&&ei._suggestedLocations&&ei._suggestedLocations[n]&&(ei._suggestedLocations[n].position={lon:ti.locations[0].position.y,lat:ti.locations[0].position.x},ei._locationsToBeDisplayed.unshift(ei._suggestedLocations[n]),ei._fillAutoCompletedLocationListContainer(ei._locationsToBeDisplayed))},onFailure:function(){ei._suggestedLocations&&ei._suggestedLocations[n]&&ei._createAutoCompletedLocationElement(ei._suggestedLocations[n],n)}})}_clearResults(){this._autocompleteLocations=[],this._locations=[]}search(e){const n=e.location,ei=e.filters?e.filters:{};if(n===void 0)return;let ti,ii=this.get("index"),ri=this.get("returnTrueGeometry");if(typeof n=="string")ti=n;else{if(ii=n.type?n.type:ii,ti=GeocodeUtils.getSuggestedLocationFreeform(n),n.type==="PositionOfInterest"&&n.poiType[0]==="administratif"&&(n.poiType[1]==="dpartement"||n.poiType[1]==="rgion")&&(ti=ti.substring(0,ti.length-(n.poiType[1].length+2))),ii==="PositionOfInterest"){let ni=n.poiType[0];ni==="administratif"&&n.poiType[1]&&(ni=n.poiType[1]),ei.category=ni||null,ri=!1;const si=["administratif","dpartement","construction","hydrographie"];for(let ai=0;ai<n.poiType.length;ai++){const oi=n.poiType[ai];if(oi!=="lieu-dit habit"&&si.includes(oi)){ri=!0;break}}}ei.postalCode=n.postalCode?n.postalCode:null;for(const ni in ei)Object.hasOwn(ei,ni)&&ei[ni]===null&&delete ei[ni]}this._requestGeocoding({index:ii,limit:this.get("limit"),returnTrueGeometry:ri,location:ti,filters:ei,onSuccess:this._onSuccessSearch.bind(this),onFailure:this._onFailureSearch.bind(this,n)}),this._currentGeocodingLocation=ti}_requestGeocoding(e){if(!(!e||typeof e=="object"&&Object.keys(e).length===0)){logger$x.log(e);var n={};Helper.assign(n,this.options.geocodeOptions.serviceOptions),Helper.assign(n,e),n.maximumResponses=e.limit;var ei=this.options.geocodeOptions.serviceOptions.onSuccess!==null&&typeof this.options.geocodeOptions.serviceOptions.onSuccess=="function";if(ei){var ti=function(ni){e.onSuccess.bind(this,ni),this.options.geocodeOptions.serviceOptions.onSuccess.bind(this,ni)};n.onSuccess=ti.bind(this)}var ii=this.options.geocodeOptions.serviceOptions.onFailure!==null&&typeof this.options.geocodeOptions.serviceOptions.onFailure=="function";if(ii){var ri=function(ni){e.onFailure.bind(this,ni),this.options.geocodeOptions.serviceOptions.onFailure.bind(this,ni)};n.onFailure=ri.bind(this)}n.apiKey=n.apiKey||this.options.apiKey,typeof n.ssl!="boolean"&&(typeof this.options.ssl=="boolean"?n.ssl=this.options.ssl:n.ssl=!0),logger$x.log(n),Gp.Services.geocode(n)}}getResultFeatures(e){let n=this.getResult(e);if(!n)return{featureFilter:null,extent:null};let ei=[n.position.lon,n.position.lat],ti,ii;if(n.placeAttributes.truegeometry){let ri=n.placeAttributes.truegeometry;typeof ri=="string"&&(ri=JSON.parse(ri));let si=new GeoJSON$1().readGeometry(ri,{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"});if(ri.type!=="Point"&&ri.type!=="MultiPoint"){ii=new Feature({geometry:si});const ai=new Point$1(ei);ai.transform("EPSG:4326","EPSG:3857"),ti=new Feature({geometry:ai})}else ii=null,ti=new Feature({geometry:si})}else{const ri=new Point$1(ei);ri.transform("EPSG:4326","EPSG:3857"),ti=new Feature({geometry:ri})}return ii&&ii.set("infoPopup",this._currentGeocodingLocation),ti.set("infoPopup",this._currentGeocodingLocation),{feature:ti,extent:ii}}_onSuccessSearch(e){this._locations=e.locations;const n=this.getResultFeatures(0);this.dispatchEvent({type:this.SEARCH_EVENT,result:n.feature,extent:n.extent,nbResults:e.locations.length})}_onFailureSearch(e,n){if(logger$x.warn(n),!e||!e.position){this.dispatchEvent({type:this.ERROR_EVENT,location:e,error:n});return}let ei=[e.position.x,e.position.y];const ti=new Point$1(ei);let ii=new Feature({geometry:ti});ii.set("infoPopup",this._currentGeocodingLocation),this.dispatchEvent({type:this.SEARCH_EVENT,result:ii})}}window.ol&&(window.ol.service||(window.ol.service={}),window.ol.service.IGNSearchService=IGNSearchService);LoggerByDefault.getLogger("searchengine");class SearchEngineGeocodeIGN extends SearchEngineBase{constructor(e){return e=e||{},super(e),this}initialize(e){this.CLASSNAME="SearchEngineGeocodeIGN",this.REMOVE_FEATURE_EVENT="remove:feature",e.serviceOptions=e.serviceOptions?e.serviceOptions:{},e.autocomplete===!1&&(this.set("autocomplete",!1),e.serviceOptions.autocomplete=!1),e.serviceOptions.returnTrueGeometry=!!e.returnTrueGeometry,(!e.searchService||!(e.searchService instanceof AbstractSearchService))&&(e.searchService=new IGNSearchService(e.serviceOptions)),super.initialize(e)}_initEvents(e){super._initEvents(e)}}window.ol&&window.ol.control&&(window.ol.control.SearchEngineGeocodeIGN=SearchEngineGeocodeIGN);const mapPinIcon="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%20width='40'%20height='40'%20fill='%23ffffff'%3e%3cpath%20d='M18.364%2017.364L12%2023.7279L5.63604%2017.364C2.12132%2013.8492%202.12132%208.15076%205.63604%204.63604C9.15076%201.12132%2014.8492%201.12132%2018.364%204.63604C21.8787%208.15076%2021.8787%2013.8492%2018.364%2017.364ZM12%2013C13.1046%2013%2014%2012.1046%2014%2011C14%209.89543%2013.1046%209%2012%209C10.8954%209%2010%209.89543%2010%2011C10%2012.1046%2010.8954%2013%2012%2013Z'%3e%3c/path%3e%3c/svg%3e";LoggerByDefault.getLogger("abstractAdvancedSearch");class AbstractAdvancedSearch extends ControlExtended{constructor(e){e=e||{},super(e),this.CLASSNAME="AbstractAdvancedSearch",this.initialize(e),this.element=this._initContainer(e),this._initEvents(e)}setMap(e){super.setMap(e),this.inputs.forEach(n=>{n.setMap&&n.setMap(e)}),this.element.appendChild(this.btnGroup)}initialize(e){if(e.name)this.name=e.name;else throw new SyntaxError("`name` is mandatory");this.inputs=[]}getName(){return this.name}getContent(){return this.element}_initContainer(e){let n=document.createElement("form");n.className="GPForm gpf-advanced-search-form",n.id=Helper.getUid("GPAdvancedForm-"+this.CLASSNAME+"-");let ei=document.createElement("fieldset");ei.className="GPFieldset fr-fieldset gpf-advanced-search-fieldset",ei.id=Helper.getUid("GPAdvancedFieldset-"),this.addInputs(),this.inputs.forEach(ni=>{ni instanceof ControlExtended?ni.setTarget(n):n.appendChild(ni)});const ti=this.btnGroup=document.createElement("div");ti.className="GPFormFooter";const ii=this.eraseBtn=document.createElement("button");ii.type="reset",ii.className="GPBtn gpf-btn fr-btn fr-btn--tertiary",ii.id=Helper.getUid("GPEraseBtn-"),ii.textContent="Effacer";const ri=this.searchBtn=document.createElement("button");return ri.className="GPBtn gpf-btn fr-btn",ri.id=Helper.getUid("GPSearchBtn-"),ri.type="submit",ri.textContent="Rechercher",ri.setAttribute("form",n.id),ti.appendChild(ii),ti.appendChild(ri),n.appendChild(ti),n}addInputs(){}_initEvents(e){this.eraseBtn.onclick=this._onErase.bind(this),this.element.onsubmit=this._onSearch.bind(this)}_onErase(e){e.preventDefault(),this.getContent().querySelectorAll("input").forEach(n=>{n.value=""})}_onSearch(e){e.preventDefault()}}window.ol&&window.ol.control&&(window.ol.control.AbstractAdvancedSearch=AbstractAdvancedSearch);function getStyle(_t,e,n=0){return new Style$1({image:new Icon({src:mapPinIcon,color:_t,anchor:[.5,1]}),stroke:new Stroke({color:_t,lineDash:[8,8],width:2,lineDashOffset:n}),fill:new Fill({color:e||"rgba(0, 0, 0, 0.1)"})})}class SearchEngineAdvanced extends ControlExtended{constructor(e){e=e||{},super(e),this.geolocation=new Geolocation({trackingOptions:{enableHighAccuracy:!0},projection:"EPSG:4326"}),this.layer=new VectorLayer({source:new VectorSource({}),zIndex:1/0,style:[getStyle([255,255,255,1]),getStyle([0,0,145,1],null,8)]}),this.selectInteraction=new Select({layers:[this.layer],style:getStyle([145,0,0,1],[145,0,0,.2])}),this.initialize(e),this._initContainer(e),this._initEvents(e),e.popupButtons=e.popupButtons?e.popupButtons:[],this.selectInteraction.on("select",this._onSelectElement.bind(this)),this.popup=this._createPopup(e.popupButtons)}initialize(e){this.CLASSNAME="SearchEngineAdvanced",this._searchForms,this.listenToClick=!1,e.advancedSearch&&e.advancedSearch instanceof Array?this._searchForms=e.advancedSearch:this._searchForms=[],this._searchForms.forEach(n=>{n.on("search",this.onAdvancedSearchResult.bind(this))})}setMap(e){this.getMap()&&this.baseSearchEngine&&this.getMap().removeControl(this.baseSearchEngine),super.setMap(e),this.baseSearchEngine&&this.baseSearchEngine.setMap(e),this._searchForms.forEach(n=>{n.setMap(e)}),this.element.appendChild(this.advancedContainer),e&&(this.layer.setMap(e),e.addInteraction(this.selectInteraction),e.addOverlay(this.popup))}getLayer(){return this.layer}_initEvents(e){this.geolocation.on("change:position",()=>{const n=new Point$1(this.geolocation.getPosition());n.transform("EPSG:4326",this.getMap().getView().getProjection());const ei=this.createEvent(n,"Ma localisation");this.addResultToMap(ei),this.dispatchEvent(ei),this.geolocation.setTracking(!1)}),this.baseSearchEngine.input.addEventListener("keydown",(function(n){n.key==="Tab"&&!n.shiftKey&&this.locationBtn.checkVisibility()&&(n.preventDefault(),this.locationBtn.focus())}).bind(this)),this.locationBtn.addEventListener("keydown",(function(n){n.key==="Tab"&&(n.preventDefault(),n.shiftKey?this.baseSearchEngine.input.focus():this.advancedBtn.checkVisibility()?this.advancedBtn.focus():this.eraseBtn.focus())}).bind(this)),this.on("search",this.addResultToMap.bind(this)),["mousedown","focus"].map(n=>document.addEventListener(n,this._onDocumentClick.bind(this))),this.advancedBtn.addEventListener("blur",(function(n){n.relatedTarget===this.baseSearchEngine.input&&(this.listenToClick=!1,this.advancedBtn.setAttribute("aria-expanded",!1))}).bind(this)),this.baseSearchEngine.input.addEventListener("blur",(function(n){n.relatedTarget&&n.relatedTarget===this.eraseBtn&&n.target.dispatchEvent(new Event("input"))}).bind(this))}createEvent(e,n){let ei=e;return e instanceof Feature?ei={result:e,extent:null}:e instanceof Point$1&&(ei={result:new Feature(e),extent:null}),n&&ei.result.set("infoPopup",n),ei.type="search",ei}_initContainer(e){const n=this.element=document.createElement("div");n.className="GPwidget gpf-widget",n.id=Helper.getUid("GPsearchEngine-Advanced-"),e.target=this.element,e.searchButton=!0,e.search=!0,this.baseSearchEngine=new SearchEngineGeocodeIGN(e),this.baseSearchEngine.on(["select","search","autocomplete"],ri=>{this.dispatchEvent(ri)}),this.locationBtn=this._getGeolocButton(),this.baseSearchEngine.autocompleteHeader.appendChild(this.locationBtn);const ei=this.advancedBtn=document.createElement("button");ei.className="GPSearchEngine-advanced-btn fr-btn fr-btn--sm fr-icon-arrow-up-s-line fr-btn--icon-right fr-btn--tertiary-no-outline",ei.id=Helper.getUid("GPSearchEngine-advanced-btn-"),ei.type="button",ei.title="Recherche avance ",ei.innerHTML="Avance",ei.setAttribute("aria-label","Afficher les options avances"),ei.setAttribute("aria-expanded","false");const ti=this.advancedContainer=document.createElement("div");ti.className="GPAdvancedContainer",ti.id=Helper.getUid("GPsearchEngine-AdvancedContainer-"),ti.setAttribute("aria-labelledby",ei.id),ti.appendChild(this._getGeolocButton()),this._searchForms.forEach(ri=>{const ni=document.createElement("section");ni.className="fr-accordion",ti.appendChild(ni);const si=document.createElement("h3");si.className="fr-accordion__title",ni.appendChild(si);const ai=document.createElement("button");ai.type="button",ai.className="fr-accordion__btn",ai.setAttribute("aria-expanded","false"),ai.innerText=ri.getName(),si.appendChild(ai);const oi=document.createElement("div");oi.className="fr-collapse",oi.id=Helper.getUid("accordion-"),ai.setAttribute("aria-controls",oi.id),ni.appendChild(oi),ri.setTarget(oi),ai.addEventListener("click",()=>{const li=ai.getAttribute("aria-expanded")==="true";ti.querySelectorAll("section").forEach(ci=>{ci.querySelector(".fr-collapse").classList.remove("fr-collapse--expanded"),ci.querySelector("button").setAttribute("aria-expanded","false"),ti.dataset.open=!li,li?ci.classList.remove("fr-hidden"):ci.classList.add("fr-hidden")}),li||(ai.setAttribute("aria-expanded","true"),oi.classList.add("fr-collapse--expanded"),ni.classList.remove("fr-hidden")),ri.dispatchEvent({type:"expand",expanded:!li})})}),ei.setAttribute("aria-controls",ti.id),ei.addEventListener("click",(function(ri){ri.preventDefault();const ni=ei.getAttribute("aria-expanded")==="false";if(ei.setAttribute("aria-expanded",ni),this.listenToClick=ni,ni){const si=["a[href]","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])","[tabindex]:not([tabindex='-1'])"].join(","),ai=ti.querySelector(si);ai&&ai.focus()}}).bind(this)),this._searchForms.length&&this.baseSearchEngine.optionscontainer.appendChild(ei);const ii=this.eraseBtn=document.createElement("button");ii.className="GPSearchEngine-erase-btn fr-btn fr-btn--sm fr-icon-close-circle-fill fr-btn--tertiary-no-outline",ii.id=Helper.getUid("GPSearchEngine-erase-btn-"),ii.type="button",ii.title="Effacer la saisie",ii.setAttribute("aria-label","Effacer la saisie"),ii.addEventListener("click",(function(){this.baseSearchEngine.input.value="",delete this.baseSearchEngine.input.dataset.empty,this.baseSearchEngine.input.dispatchEvent(new Event("input")),console.log("click"),setTimeout(()=>{this.baseSearchEngine.input.focus()},50)}).bind(this)),this.baseSearchEngine.optionscontainer.appendChild(ii)}_onDocumentClick(e){if(this.listenToClick===!0){const n=this.advancedContainer===e.target||this.advancedContainer.contains(e.target),ei=this.advancedBtn===e.target;n||ei||(this.listenToClick=!1,this.advancedBtn.setAttribute("aria-expanded",!1))}}addResultToMap(e){this._closePopup(),this.layer.getSource().clear();let n;if(e.result&&(this.layer.getSource().addFeature(e.result),n=e.result.getGeometry().getExtent(),this.selectInteraction.getFeatures().push(e.result),this._setPopupInfo(e.result)),e.extent&&(this.layer.getSource().addFeature(e.extent),n=e.extent.getGeometry().getExtent()),this.getMap()){let ei=this.getMap().getView();n&&(ei.fit(n),ei.getZoom()>15&&ei.setZoom(15))}}_setPopupInfo(e,n){var ei,ti;if(e){this.popup.setPosition(void 0);let ii=null;((ei=e.getGeometry())==null?void 0:ei.getType())==="Point"&&(n=(ti=e.getGeometry())==null?void 0:ti.getCoordinates(),ii=[0,-20]),this.popup.setPosition(n),ii&&this.popup.setOffset(ii),this.setPopupContent(e.get("infoPopup")||""),this.popup.set("feature",e),this.popup.set("layer",this.layer)}else this.popup.setPosition(void 0),this.setPopupContent(""),this.popup.unset("feature"),this.popup.unset("layer")}_onSelectElement(e){let n=e.mapBrowserEvent.coordinate;this._setPopupInfo(e.selected.length?e.selected[0]:null,n)}_createPopup(e){let n=this._popupDiv=document.createElement("div");n.className="GPSearchPopup";let ei=this._popupContent=document.createElement("div");ei.className="GPPopupContent";let ti=this._popupBtns=document.createElement("div");return ti.className="GPButtonGroups gpf-btns-group",ti.appendChild(this._addCloseButton()),ti.appendChild(this._addRemoveButton()),e.forEach(ri=>{ti.appendChild(this._createCustomPopupButton(ri))}),n.appendChild(ei),n.appendChild(ti),new Overlay({element:n,positioning:"bottom-center"})}setPopupContent(e){this._popupContent.innerHTML=e}_addCloseButton(){let e=document.createElement("button");return e.title=e.ariaLabel="Fermer la pop-up",e.textContent="Fermer",e.className="GPButton gpf-btn fr-icon-close-line fr-btn fr-btn--sm gpf-btn--tertiary  fr-btn--tertiary-no-outline",e.onclick=this._closePopup.bind(this),e}_closePopup(){return this.selectInteraction.getFeatures().clear(),this.popup!==null&&this.popup.setPosition(void 0),!1}_addRemoveButton(){let e=document.createElement("button");return e.title=e.ariaLabel="Supprimer le marqueur",e.textContent="Supprimer",e.className="GPButton gpf-btn fr-icon-delete-line fr-btn fr-btn--sm gpf-btn--tertiary fr-btn--tertiary-no-outline",e.onclick=this._removeFeature.bind(this),e}_removeFeature(){const e=this.popup.get("feature"),n=this.popup.get("layer");n&&e&&(n.getSource().removeFeature(e),this.dispatchEvent({type:this.REMOVE_FEATURE_EVENT,feature:e,layer:n}),this._closePopup())}_createCustomPopupButton(e){const n=document.createElement("button");return n.title=n.ariaLabel=e.label,n.className="GPButton fr-btn fr-btn--sm fr-btn--tertiary-no-outline ",e.className&&(n.className+=e.className),e.icon&&n.classList.add(e.icon),e.attributes&&Object.entries(e.attributes).forEach(([ei,ti])=>{n.setAttribute(ei,ti)}),n.onclick=()=>{const ei=this.popup.get("feature");if(ei&&typeof e.onClick=="function"){const ti=ei.clone();ti.setStyle(void 0),e.onClick.call(this,ti)&&(this._closePopup(),this.selectInteraction.getFeatures().clear(),this.layer.getSource().removeFeature(ei))}},n}_getGeolocButton(){const e=document.createElement("button");return e.innerText="Me golocaliser",e.className="GPSearchEngine-locate fr-btn fr-btn--sm fr-icon-crosshair-2-line fr-btn--icon-left fr-btn--tertiary-no-outline",e.addEventListener("click",()=>{this.geolocation.setTracking(!0),console.log("tracking",this.geolocation)}),e}onAdvancedSearchResult(e){this.listenToClick=!1,this.advancedBtn.setAttribute("aria-expanded",!1),this.closeAllSections(),e.result instanceof Array||e.result instanceof Feature&&this.addResultToMap(e)}closeAllSections(){this.advancedContainer.dataset.open=!1,this.advancedContainer.querySelectorAll("section").forEach(e=>{const n=e.querySelector(".fr-accordion__title > button[aria-expanded]");n.setAttribute("aria-expanded","false"),n.ariaControlsElements[0].classList.remove("fr-collapse--expanded"),e.classList.remove("fr-hidden")})}}window.ol&&window.ol.control&&(window.ol.control.SearchEngineAdvanced=SearchEngineAdvanced);let logger$w=LoggerByDefault.getLogger("abstractAdvancedSearch");class CoordinateAdvancedSearch extends AbstractAdvancedSearch{constructor(e){super(e),this.element.dataset.unitType=this.get("unitType"),this.element.dataset.unit=this.unit.value}initialize(e){e.name||(e.name="Coordonnes"),super.initialize(e),this._initCoordinateSearchSystems(e),this._initCoordinateSearchUnits(e),this._boundOnLonLatBeforeInput=this._onlonLatBeforeInput.bind(this),this._boundOnLonLatInput=this._onlonLatInput.bind(this),this._currentCoordinateSystem=this._coordinateSearchSystems[0],this._currentUnit=this._coordinateSearchUnits[this._currentCoordinateSystem.type],this.set("unitType",this._currentCoordinateSystem.type),this.set("unit",this._currentUnit[0].code),this.CLASSNAME="CoordinateAdvancedSearch"}_initCoordinateSearchSystems(e){this._coordinateSearchSystems=[];let n=[{label:"Gographique",crs:"EPSG:4326",type:"Geographical"},{label:"Web Mercator",crs:"EPSG:3857",type:"Metric"},{label:"Lambert 93",crs:"EPSG:2154",type:"Metric"}];if(e&&e.coordinateSearch&&e.coordinateSearch.systems){let ei=e.coordinateSearch.systems;for(let ti=0;ti<ei.length;ti++){let ii=ei[ti];this._setSystem(ii)}}if(this._coordinateSearchSystems.length===0)for(let ei=0;ei<n.length;ei++)this._setSystem(n[ei])}_initCoordinateSearchUnits(e){this._coordinateSearchUnits=[];let n={Geographical:[{code:"DEC",label:"Degrs dcimaux",format:MathUtils.coordinateToDecimal},{code:"DMS",label:"Degrs sexagsimaux",format:MathUtils.coordinateToDMS}],Metric:[{code:"M",label:"Mtres",format:MathUtils.coordinateToMeter},{code:"KM",label:"Kilomtres",format:MathUtils.coordinateToKMeter}]};if(e&&e.coordinateSearch&&e.coordinateSearch.units){let ei=e.coordinateSearch.units;for(let ti in n)if(n.hasOwnProperty(ti)){let ii=!1;for(let ri=0;ri<n[ti].length;ri++){let ni=n[ti][ri];for(let si=0;si<ei.length;si++){let ai=ei[si];ni.code===ai&&(ii=!0,this._coordinateSearchUnits[ti]||(this._coordinateSearchUnits[ti]=[]),this._coordinateSearchUnits[ti].push(ni))}}ii||(this._coordinateSearchUnits[ti]=n[ti])}}typeof this._coordinateSearchUnits=="object"&&Object.keys(this._coordinateSearchUnits).length===0&&(this._coordinateSearchUnits=n)}_setSystem(e){if(typeof e!="object"){logger$w.log("[ERROR] CoordinateAdvancedSearch:_setSystem - system parameter should be an object");return}if(!e.crs){logger$w.error("crs not defined !");return}if(e.label||(logger$w.warn("crs label not defined, use crs code by default."),e.label=e.crs),e.type||(logger$w.warn("type srs not defined, use 'Metric' by default."),e.type="Metric"),CRS.loadByName(e.crs),!get$3(e.crs)){logger$w.error("crs '{}' not available into proj4 definitions !",e.crs);return}for(var n=0;n<this._coordinateSearchSystems.length;n++){var ei=this._coordinateSearchSystems[n];e.crs===ei.crs&&logger$w.info("crs '{}' already configured",ei.crs)}e.code=this._coordinateSearchSystems.length,this._coordinateSearchSystems.push(e)}_getLabelContainer(e,n,ei,ti=!1){const ii=document.createElement("div");ii.className=n;const ri=this._createLabel(e,ti);return ii.appendChild(ri),ei&&(ri.setAttribute("for",ei.id),ii.appendChild(ei)),ii}_createLabel(e,n=!1){const ei=document.createElement("label");ei.className="fr-label";const ti=n?"*":"";return ei.textContent=e+ti,ei}_updateLabel(e,n,ei=!1){const ti=n.querySelector("label"),ii=ei?"*":"";ti.innerText=e+ii}addInputs(){super.addInputs();const e=document.createElement("div"),n=document.createElement("span");n.className="GPLabelHint fr-hint-text",n.textContent="* Tous les champs sont obligatoires",e.appendChild(n),this.inputs.push(e);const ei=this.system=document.createElement("select");ei.className="fr-select",ei.id=ei.name=Helper.getUid("CoordinateAdvancedSearch-system-");const ti=this._getLabelContainer("Systme de rfrence","fr-select-group",ei,!0);this.inputs.push(ti),this._coordinateSearchSystems.forEach((oi,li)=>{const ci=document.createElement("option");ci.value=li,ci.selected=!li,ci.innerText=oi.label,ei.appendChild(ci)});const ii=this.unit=document.createElement("select");ii.className="fr-select",ii.id=ii.name=Helper.getUid("CoordinateAdvancedSearch-unit-");const ri=this._getLabelContainer("Unit","fr-select-group",ii,!0);this.inputs.push(ri);for(let oi=0;oi<this._currentUnit.length;oi++){const li=this._currentUnit[oi],ci=document.createElement("option");ci.value=li.code?li.code:oi,ci.textContent=li.label||oi,ii.appendChild(ci)}const ni=this.lonLatInputs=document.createElement("div");ni.className="GPLonLatInputs";const si=this.lon=this.createCoordinateInput("lon");ni.appendChild(si);const ai=this.lat=this.createCoordinateInput("lat");ni.appendChild(ai),this.inputs.push(ni)}createCoordinateInput(e){const n=document.createElement("div");n.className="GPCoordinateWrapper";const ei=e==="lon"?"Longitude":"Latitude",ti=this._createLabel(ei,!0);n.appendChild(ti);const ii=document.createElement("div");ii.className="GPCoordinateInputs",n.appendChild(ii);const ri=document.createElement("div"),ni=document.createElement("input");ni.className="GPCoordinateInput fr-input",ni.type="text",ni.name=e,ni.inputMode="numeric",ni.autocomplete="off",ni.required=!0,ni.id=Helper.getUid(`CoordinateAdvancedSearch-${e}-`),ri.appendChild(ni),ii.appendChild(ri),ti.setAttribute("for",ni.id);const si=document.createElement("div");return si.className="display-mask",si.textContent=`____'__"`,ri.appendChild(si),ii.appendChild(this._createSelectCardinals(e)),n}_createSelectCardinals(e){const n={lon:["O","E"],lat:["N","S"]};if(n[e]){const ei=document.createElement("select");return ei.className="fr-select",ei.id=ei.name=Helper.getUid("CoordinateAdvancedSearch-cardinal-"),n[e].forEach(ti=>{const ii=document.createElement("option");ii.value=ii.textContent=ti,ei.appendChild(ii)}),ei}else return}_initEvents(e){super._initEvents(e),this.system.addEventListener("change",this._updateSystem.bind(this)),this.unit.addEventListener("change",this._updateUnits.bind(this)),this.on("change:unitType",this._updateInputsLabel.bind(this)),this.on("change:unit",this._updateInputs.bind(this))}_updateSystem(e){if(this._coordinateSearchSystems[e.target.value].crs!==this._currentCoordinateSystem.crs){this._currentCoordinateSystem=this._coordinateSearchSystems[e.target.value],this._currentUnit=this._coordinateSearchUnits[this._currentCoordinateSystem.type],this.unit.replaceChildren();for(let ei=0;ei<this._currentUnit.length;ei++){const ti=this._currentUnit[ei],ii=document.createElement("option");ii.value=ti.code?ti.code:ei,ii.textContent=ti.label||ei,this.unit.appendChild(ii)}e.target.closest("form").dataset.unit=this.unit.value,this.set("unit",this.unit.value),e.target.closest("form").dataset.unitType=this._currentCoordinateSystem.type,this.set("unitType",this._currentCoordinateSystem.type)}}_updateUnits(e){const n=e.target.value;this.get("unit")!==n&&(e.target.closest("form").dataset.unit=n,this.set("unit",n))}_updateInputsLabel(){const n=this.get("unitType")==="Geographical",ei={lon:n?"Longitude":"X",lat:n?"Latitude":"Y"};this._updateLabel(ei.lon,this.lon,!0),this._updateLabel(ei.lat,this.lat,!0),this.lon.querySelector("input").value="",this.lat.querySelector("input").value=""}_updateInputs(){const e=this.get("unit");let n=1;this.get("unitType")==="Metric"&&(n=e==="KM"?.001:1e3),e==="DMS"?this.lonLatInputs.querySelectorAll("input").forEach(ei=>{ei.value="",ei.minLength="6",ei.maxLength="6",ei.addEventListener("beforeinput",this._boundOnLonLatBeforeInput),ei.addEventListener("input",this._boundOnLonLatInput)}):this.lonLatInputs.querySelectorAll("input").forEach(ei=>{e==="DEC"?ei.value="":ei.value=ei.value===""||isNaN(ei.value)?"":parseFloat(ei.value)*n,ei.removeAttribute("minLength"),ei.removeAttribute("maxLength"),ei.removeEventListener("beforeinput",this._boundOnLonLatBeforeInput),ei.removeEventListener("input",this._boundOnLonLatInput)}),this.getContent().querySelectorAll(".display-mask").forEach(ei=>{ei.textContent=`____'__"`})}_onlonLatBeforeInput(e){const n=/^\d+$/;e.inputType.startsWith("insert")&&e.inputType!="insertLineBreak"&&!n.test(e.data)&&e.preventDefault()}_format(e){const n=e.padEnd(6,"_");return`${n.slice(0,2)}${n.slice(2,4)}'${n.slice(4,6)}"`}_onlonLatInput(e){console.log("on lon lat inputs");const n=e.target.value,ei=e.target.parentElement.querySelector(".display-mask");ei.textContent=this._format(n)}_onSearch(e){super._onSearch(e);let n=this.lon.querySelector("input").value,ei=this.lat.querySelector("input").value;this.get("unit")==="DMS"?(n=MathUtils.dmsToDecimal(parseInt(n.substring(0,2)),parseInt(n.substring(2,4)),parseInt(n.substring(4,6)),this.lon.querySelector("select").value),ei=MathUtils.dmsToDecimal(parseInt(ei.substring(0,2)),parseInt(ei.substring(2,4)),parseInt(ei.substring(4,6)),this.lat.querySelector("select").value)):this.get("unit")==="KM"?(n=parseFloat(n)*1e3,ei=parseFloat(ei)*1e3):(n=parseFloat(n),ei=parseFloat(ei));let ti=[n,ei];const ii=this.getMap().getView().getProjection().getCode(),ri=this._currentCoordinateSystem.crs;ii!==ri&&(ti=transform$1(ti,ri,ii));const ni=new Point$1(ti),si=new Feature({geometry:ni});si.set("infoPopup",this._createInfoPopup(n,ei)),this.dispatchEvent({type:"search",result:si})}_createInfoPopup(e,n){let ei,ti,ii,ri;if(this.get("unitType")==="Geographical")if(ei="Longitude",ti="Latitude",this.get("unit")==="DMS"){const si=this.lon.querySelector("input").value,ai=this.lon.querySelector("select").value;ii=`${parseInt(si.substring(0,2))}${parseInt(si.substring(2,4))}'${parseInt(si.substring(4,6))}" ${ai}`;const oi=this.lat.querySelector("input").value,li=this.lat.querySelector("select").value;ri=`${parseInt(oi.substring(0,2))}${parseInt(oi.substring(2,4))}'${parseInt(oi.substring(4,6))}" ${li}`}else ii=`${e} `,ri=`${n} `;else ei="X",ti="Y",ii=`${e} ${this.get("unit").toLowerCase()}`,ri=`${n} ${this.get("unit").toLowerCase()}`;return`<b>${ei} : </b>${ii}<br><b>${ti} : </b>${ri}`}_onErase(e){super._onErase(e),this.getContent().querySelectorAll(".display-mask").forEach(n=>{n.textContent=`____'__"`})}}window.ol&&window.ol.control&&(window.ol.control.CoordinateAdvancedSearch=CoordinateAdvancedSearch);LoggerByDefault.getLogger("searchengine");class InseeSearchService extends AbstractSearchService{constructor(e){e=e||{},e.autocomplete=!1,super(e),this.CLASSNAME="InseeSearchService",this.ignService=new IGNSearchService({autocomplete:!1,returnTrueGeometry:!0,index:"poi"}),this.ignService.on(this.SEARCH_EVENT,this._onSearch.bind(this))}autocomplete(){}search(e,n){const ei=e.location;this._requestGeoAPI({value:ei,arr:!!n}).then(ii=>{if(ii instanceof Array&&ii.length){const ri=ii[0];let ni=ri.nom;ri.nom.length<3&&(ni=`${ri.nom}, ${ri.codesPostaux[0]}`);let si={category:"administratif",citycode:ri.code};const ai={location:ni,filters:si};this.ignService.search(ai)}else{if(/^(13|69|75)/.test(ei)&&!n){this.search(e,!0);return}this._onSearch({type:this.SEARCH_EVENT})}})}_onSearch(e){this.dispatchEvent(e)}async _requestGeoAPI(e){const n="https://geo.api.gouv.fr/communes",ei="json",ti=["nom","code","codesPostaux"],ii=e.arr;let ri=`${n}?code=${e.value}&format=${ei}&fields=${ti}`;ii&&(ri+="&type=arrondissement-municipal");try{const ni=await fetch(ri,{headers:{"Content-Type":"application/json"}});if(!ni.ok)throw new Error(`Response status: ${ni.status}`);return await ni.json()}catch(ni){console.error(ni.message)}}}window.ol&&(window.ol.service||(window.ol.service={}),window.ol.service.InseeSearchService=InseeSearchService);LoggerByDefault.getLogger("abstractAdvancedSearch");class InseeAdvancedSearch extends AbstractAdvancedSearch{constructor(e){super(e),this.inseeInput.on("search",(function(n){n.result?this.dispatchEvent(n):this.inseeInput.addMessage("Ce code INSEE est introuvable.")}).bind(this))}initialize(e){e.name||(e.name="Code INSEE"),super.initialize(e),this._inputPattern=/^(\d\d|2[A,B,a,b])\d{3}$/,this.CLASSNAME="InseeAdvancedSearch"}addInputs(){super.addInputs();let e=this.inseeInput=new SearchEngineGeocodeIGN({label:"Code INSEE",hint:"Format attendu INSEE : 5 chiffres, selon le code officiel gographique (COG)",searchService:new InseeSearchService({autocomplete:!1,searchOptions:{serviceOptions:{fields:["postcode"]}}})});this.inseeInput.input.title="Code INSEE sur 5 caractres",this.inputs.push(e)}_initEvents(e){super._initEvents(e),this.inseeInput.input.onkeydown=(function(n){n.key==="Enter"&&this.element.requestSubmit(this.searchBtn)}).bind(this)}_onErase(e){super._onErase(e),this.inseeInput.removeMessages()}_onSearch(e){super._onSearch(e);const n=this.inseeInput.input.value;this._inputPattern.test(n)?(this.inseeInput.removeMessages(),this.inseeInput.search({location:n,filters:{cityCode:n}})):this.inseeInput.addMessage("Le champs INSEE n'est pas valide (texte de 5 chiffres).")}}window.ol&&window.ol.control&&(window.ol.control.InseeAdvancedSearch=InseeAdvancedSearch);class LocationAdvancedSearch extends AbstractAdvancedSearch{constructor(e){e=e||{},e.name=e.name||"Lieux et toponymes",super(e),this.searchService=new IGNSearchService({index:"poi",limit:10,returnTrueGeometry:!0}),this.element.setAttribute("novalidate","")}_initEvents(e){super._initEvents(e),this.on("expand",n=>{n.expanded&&setTimeout(()=>this.searchInput.focus(),300),this.searchResult.innerHTML=""}),setTimeout(()=>{this.searchService.on("search",n=>this.handleSearch(n)),this.searchService.on("error",n=>this.handleError(n))})}handleError(e){this.handleSearch({nbResults:0})}handleSearch(e){if(e.multi||(this.searchResult.innerHTML=""),e.nbResults===1){const n=e.attr||this.searchService.getResult(0).placeAttributes;["postcode","citycode","city","category"].forEach(ti=>{n[ti]=n[ti]||[]});const ei={infoPopup:"<strong>"+n.toponym+"</strong><br/>"+(n.category?"<em>"+(n.category||[]).join(", ")+"</em><br/>":"")+(n.postcode?"Code postal : "+(n.postcode||[]).join(", ")+"<br/>":""),toponyme:n.toponym,postcode:n.postcode[0],postcodes:n.postcode.join(" - "),insee:n.citycode[0],citycodes:n.citycode.join(" - "),city:n.city[0],citys:n.city.join(" - "),category:n.category[0],categories:n.category.join(" - ")};e.result&&e.result.setProperties(ei),e.extent&&e.extent.setProperties(ei),console.log(e),this.dispatchEvent(e)}else if(this.element.parentElement.parentElement.scrollTop=0,e.nbResults===0){this.searchResult.innerHTML="";const n=document.createElement("li");n.className="fr-message--error",n.innerText="Aucun rsultat",this.searchInput.value||(n.innerText+=" : prcisez votre recherche en renseignant le lieu."),this.searchResult.appendChild(n),n.addEventListener("click",()=>{n.remove()})}else this.handleMultipleResults(e)}initialize(e){super.initialize(e),this.CLASSNAME="LocationAdvancedSearch",fetch("https://data.geopf.fr/geocodage/getCapabilities").then(ei=>ei.json()).then(ei=>{const ti=ei.indexes.find(ii=>ii.id==="poi").fields.find(ii=>ii.name==="category").values;this._typeList=ti,e.typeList||this.setCategories(ti)}).catch(()=>{console.log("error")}),this._typeList={};const n=["administratif","arodrome","cimetire","construction ponctuelle","construction surfacique","cours d'eau"];this.set("typeList",e.typeList||n)}setCategories(e,n){n=n||this.element.querySelector("select[name='category']"),n.innerHTML="";let ei=[];const ti=Array.isArray(e);if(ti)ei=e;else if(typeof e=="object")ei=Object.keys(e);else return;ei.forEach(ii=>{const ri=document.createElement("option");ri.value=ii.toLowerCase(),ri.innerText=ii,n.appendChild(ri),!ti&&Array.isArray(e[ii])&&(ri.className="option",e[ii].forEach(ni=>{const si=document.createElement("option");si.value=ni.toLowerCase(),si.className="subOption",si.innerHTML="&nbsp;&nbsp;"+ni,n.appendChild(si)}))}),this.filter&&(n.value=this.filter.category,n.value||(n.selectedIndex=0,this.filter.category=n.value))}handleMultipleResults(e){const n=this.searchService.getResult();n.forEach((ii,ri)=>{const ni=ii.placeAttributes,si=document.createElement("li");si.className="search-result-item"+(ri>=5?" hidden":""),this.searchResult.appendChild(si);const ai=document.createElement("a");si.appendChild(ai),ai.className="fr-icon-map-pin-2-line",ai.href="#";const oi=ni.postcode&&ni.postcode[0]?`, ${ni.postcode[0]}`:"",li=(ni.toponym||"")+oi+" ("+(ni.category||[]).join(", ")+") - "+(ni.city||[]).join(", ");ai.title=ai.innerText=li,si.addEventListener("click",()=>ai.click()),ai.addEventListener("click",ci=>{ci.preventDefault();const ui=this.searchService.getResultFeatures(ri),di={type:"search",multi:!0,attr:ni,extent:ui.extent,result:ui.feature,nbResults:1};this.searchService.dispatchEvent(di)})});const ei=document.createElement("li");if(this.searchResult.appendChild(ei),n.length>5){const ii=document.createElement("button");ii.className="fr-btn fr-btn--sm fr-btn--tertiary",ii.innerText="Afficher plus de rsultats",ii.addEventListener("click",()=>{ii.remove(),this.searchResult.querySelectorAll(".hidden").forEach(ri=>{ri.classList.remove("hidden")})}),ei.appendChild(ii)}ei.className="search-result-actions";const ti=document.createElement("button");ti.className="fr-btn fr-btn--sm fr-btn--tertiary",ti.innerText="Effacer",ti.addEventListener("click",()=>{this.searchResult.innerHTML="",this.element.parentElement.parentElement.scrollTop=0}),ei.appendChild(ti)}_getLabelContainer(e,n,ei,ti=""){const ii=document.createElement("div");ii.className=n,this.inputs.push(ii);const ri=document.createElement("label");ri.className="fr-label";let ni=e;ti&&(ni=`${e} <span class="fr-hint-text">${ti}</span>`),ri.innerHTML=ni,ii.appendChild(ri),ei&&(ri.setAttribute("for",ei.id),ii.appendChild(ei));const si=document.createElement("div");return si.className="GPMessagesGroup fr-messages-group",ii.appendChild(si),ii}addInputs(){super.addInputs(),this.searchResult=document.createElement("ul"),this.searchResult.className="search-result",this.inputs.push(this.searchResult);const e=document.createElement("legend");e.className="fr-fieldset__legend fr-fieldset__legend--regular",e.id=Helper.getUid("LocationAdvancedSearch-legend-");const n=document.createElement("span");n.className="fr-hint-text",n.textContent="* Champs obligatoires",e.appendChild(n),this.inputs.push(e);const ei=document.createElement("select");ei.className="fr-select",ei.id=Helper.getUid("LocationAdvancedSearch-type-"),ei.name="category",this._getLabelContainer("Type","fr-select-group",ei),this.setCategories(this.get("typeList"),ei),ei.addEventListener("change",()=>{this.filter.category=ei.value});const ti=this.searchInput=document.createElement("input");ti.className="fr-input",ti.type="text",ti.name="search",ti.setAttribute("minlength","3"),ti.required=!0,ti.id=Helper.getUid("LocationAdvancedSearch-search-"),this._getLabelContainer("Renseigner un lieu *","fr-input-group",ti,null);const ii=document.createElement("input");ii.className="fr-input",ii.type="text",ii.name="postalCode",ii.pattern="^(\\d{5})$",ii.title="Code postal  5 chiffres",ii.id=Helper.getUid("LocationAdvancedSearch-postal-"),this._getLabelContainer("Code postal","fr-input-group",ii),ii.addEventListener("change",()=>{this.filter.postcode=ii.value});const ri=document.createElement("input");ri.className="fr-input",ri.name="cityCode",ri.type="text",ri.pattern="^(\\d\\d|2[A,B,a,b])\\d{3}$",ri.title="Code INSEE sur 5 caractres",ri.id=Helper.getUid("LocationAdvancedSearch-insee-"),this._getLabelContainer("Code INSEE","fr-input-group",ri,"Format attendu INSEE : 5 chiffres, selon le code officiel gographique (COG)"),ri.addEventListener("change",()=>{this.filter.citycode=ri.value.toUpperCase()}),this.filter={category:ei.value,postcode:ii.value.toUpperCase(),citycode:ri.value}}_onErase(e){super._onErase(e),this.element.querySelectorAll("select").forEach(n=>{n.selectedIndex=0}),this.element.querySelectorAll("input").forEach(n=>{n.value=""}),this.searchResult.innerHTML="",this._clearMessages(),this.filter={category:this.element.querySelector("select[name='category']").value,postcode:"",citycode:""}}_clearMessages(){this.element.querySelectorAll(".fr-message--error").forEach(e=>e.remove())}_showMessage(e,n){const ei=this.element.querySelector("input[name='"+e+"']").nextSibling;if(n){const ti=document.createElement("p");ti.className="fr-message fr-message--error",ti.textContent=n,ei.appendChild(ti)}else ei.innerHTML=""}_onSearch(e,n){super._onSearch(e);const ei=n||this.searchInput.value;if(this._clearMessages(),this.filter.postcode&&!this.element.querySelector("input[name='postalCode']").checkValidity()){this._showMessage("postalCode","Le code postal doit tre compos de 5 chiffres.");return}if(this.filter.citycode&&!this.element.querySelector("input[name='cityCode']").checkValidity()){this._showMessage("cityCode","Le code INSEE doit tre compos de 5 caractres (chiffres ou 2A, 2B).");return}if(!ei&&this.filter.citycode){fetch(`https://geo.api.gouv.fr/communes?code=${this.filter.citycode}&format=json&fields=nom`).then(ti=>ti.json()).then(ti=>{if(ti&&ti.length){const ii=ti[0].nom;ii?this._onSearch(e,ii):this.handleSearch({nbResults:0})}}).catch(()=>{this.handleSearch({nbResults:0})});return}else if(!ei&&this.filter.postcode){fetch(`https://apicarto.ign.fr/api/codes-postaux/communes/${this.filter.postcode}`).then(ti=>ti.json()).then(ti=>{if(ti&&ti.length){const ii=ti[0].nomCommune;ii?this._onSearch(e,ii):this.handleSearch({nbResults:0})}}).catch(()=>{this._showMessage("postalCode","Aucune commune trouve pour ce code postal."),this.handleSearch({nbResults:0})});return}else if(ei.length<3){this._showMessage("search","Veuillez saisir au moins 3 caractres pour lancer la recherche.");return}this.searchService.search({location:ei,filters:this.filter})}}window.ol&&window.ol.control&&(window.ol.control.LocationAdvancedSearch=LocationAdvancedSearch);var discriminator={},codegen={},code$1={},hasRequiredCode$1;function requireCode$1(){return hasRequiredCode$1||(hasRequiredCode$1=1,(function(_t){Object.defineProperty(_t,"__esModule",{value:!0}),_t.regexpCode=_t.getEsmExportName=_t.getProperty=_t.safeStringify=_t.stringify=_t.strConcat=_t.addCodeArg=_t.str=_t._=_t.nil=_t._Code=_t.Name=_t.IDENTIFIER=_t._CodeOrName=void 0;class e{}_t._CodeOrName=e,_t.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;class n extends e{constructor(gi){if(super(),!_t.IDENTIFIER.test(gi))throw new Error("CodeGen: name must be a valid identifier");this.str=gi}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}}_t.Name=n;class ei extends e{constructor(gi){super(),this._items=typeof gi=="string"?[gi]:gi}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;const gi=this._items[0];return gi===""||gi==='""'}get str(){var gi;return(gi=this._str)!==null&&gi!==void 0?gi:this._str=this._items.reduce((vi,yi)=>`${vi}${yi}`,"")}get names(){var gi;return(gi=this._names)!==null&&gi!==void 0?gi:this._names=this._items.reduce((vi,yi)=>(yi instanceof n&&(vi[yi.str]=(vi[yi.str]||0)+1),vi),{})}}_t._Code=ei,_t.nil=new ei("");function ti(pi,...gi){const vi=[pi[0]];let yi=0;for(;yi<gi.length;)ni(vi,gi[yi]),vi.push(pi[++yi]);return new ei(vi)}_t._=ti;const ii=new ei("+");function ri(pi,...gi){const vi=[ui(pi[0])];let yi=0;for(;yi<gi.length;)vi.push(ii),ni(vi,gi[yi]),vi.push(ii,ui(pi[++yi]));return si(vi),new ei(vi)}_t.str=ri;function ni(pi,gi){gi instanceof ei?pi.push(...gi._items):gi instanceof n?pi.push(gi):pi.push(li(gi))}_t.addCodeArg=ni;function si(pi){let gi=1;for(;gi<pi.length-1;){if(pi[gi]===ii){const vi=ai(pi[gi-1],pi[gi+1]);if(vi!==void 0){pi.splice(gi-1,3,vi);continue}pi[gi++]="+"}gi++}}function ai(pi,gi){if(gi==='""')return pi;if(pi==='""')return gi;if(typeof pi=="string")return gi instanceof n||pi[pi.length-1]!=='"'?void 0:typeof gi!="string"?`${pi.slice(0,-1)}${gi}"`:gi[0]==='"'?pi.slice(0,-1)+gi.slice(1):void 0;if(typeof gi=="string"&&gi[0]==='"'&&!(pi instanceof n))return`"${pi}${gi.slice(1)}`}function oi(pi,gi){return gi.emptyStr()?pi:pi.emptyStr()?gi:ri`${pi}${gi}`}_t.strConcat=oi;function li(pi){return typeof pi=="number"||typeof pi=="boolean"||pi===null?pi:ui(Array.isArray(pi)?pi.join(","):pi)}function ci(pi){return new ei(ui(pi))}_t.stringify=ci;function ui(pi){return JSON.stringify(pi).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}_t.safeStringify=ui;function di(pi){return typeof pi=="string"&&_t.IDENTIFIER.test(pi)?new ei(`.${pi}`):ti`[${pi}]`}_t.getProperty=di;function fi(pi){if(typeof pi=="string"&&_t.IDENTIFIER.test(pi))return new ei(`${pi}`);throw new Error(`CodeGen: invalid export name: ${pi}, use explicit $id name mapping`)}_t.getEsmExportName=fi;function hi(pi){return new ei(pi.toString())}_t.regexpCode=hi})(code$1)),code$1}var scope={},hasRequiredScope;function requireScope(){return hasRequiredScope||(hasRequiredScope=1,(function(_t){Object.defineProperty(_t,"__esModule",{value:!0}),_t.ValueScope=_t.ValueScopeName=_t.Scope=_t.varKinds=_t.UsedValueState=void 0;const e=requireCode$1();class n extends Error{constructor(ai){super(`CodeGen: "code" for ${ai} not defined`),this.value=ai.value}}var ei;(function(si){si[si.Started=0]="Started",si[si.Completed=1]="Completed"})(ei||(_t.UsedValueState=ei={})),_t.varKinds={const:new e.Name("const"),let:new e.Name("let"),var:new e.Name("var")};class ti{constructor({prefixes:ai,parent:oi}={}){this._names={},this._prefixes=ai,this._parent=oi}toName(ai){return ai instanceof e.Name?ai:this.name(ai)}name(ai){return new e.Name(this._newName(ai))}_newName(ai){const oi=this._names[ai]||this._nameGroup(ai);return`${ai}${oi.index++}`}_nameGroup(ai){var oi,li;if(!((li=(oi=this._parent)===null||oi===void 0?void 0:oi._prefixes)===null||li===void 0)&&li.has(ai)||this._prefixes&&!this._prefixes.has(ai))throw new Error(`CodeGen: prefix "${ai}" is not allowed in this scope`);return this._names[ai]={prefix:ai,index:0}}}_t.Scope=ti;class ii extends e.Name{constructor(ai,oi){super(oi),this.prefix=ai}setValue(ai,{property:oi,itemIndex:li}){this.value=ai,this.scopePath=(0,e._)`.${new e.Name(oi)}[${li}]`}}_t.ValueScopeName=ii;const ri=(0,e._)`\n`;class ni extends ti{constructor(ai){super(ai),this._values={},this._scope=ai.scope,this.opts={...ai,_n:ai.lines?ri:e.nil}}get(){return this._scope}name(ai){return new ii(ai,this._newName(ai))}value(ai,oi){var li;if(oi.ref===void 0)throw new Error("CodeGen: ref must be passed in value");const ci=this.toName(ai),{prefix:ui}=ci,di=(li=oi.key)!==null&&li!==void 0?li:oi.ref;let fi=this._values[ui];if(fi){const gi=fi.get(di);if(gi)return gi}else fi=this._values[ui]=new Map;fi.set(di,ci);const hi=this._scope[ui]||(this._scope[ui]=[]),pi=hi.length;return hi[pi]=oi.ref,ci.setValue(oi,{property:ui,itemIndex:pi}),ci}getValue(ai,oi){const li=this._values[ai];if(li)return li.get(oi)}scopeRefs(ai,oi=this._values){return this._reduceValues(oi,li=>{if(li.scopePath===void 0)throw new Error(`CodeGen: name "${li}" has no value`);return(0,e._)`${ai}${li.scopePath}`})}scopeCode(ai=this._values,oi,li){return this._reduceValues(ai,ci=>{if(ci.value===void 0)throw new Error(`CodeGen: name "${ci}" has no value`);return ci.value.code},oi,li)}_reduceValues(ai,oi,li={},ci){let ui=e.nil;for(const di in ai){const fi=ai[di];if(!fi)continue;const hi=li[di]=li[di]||new Map;fi.forEach(pi=>{if(hi.has(pi))return;hi.set(pi,ei.Started);let gi=oi(pi);if(gi){const vi=this.opts.es5?_t.varKinds.var:_t.varKinds.const;ui=(0,e._)`${ui}${vi} ${pi} = ${gi};${this.opts._n}`}else if(gi=ci==null?void 0:ci(pi))ui=(0,e._)`${ui}${gi}${this.opts._n}`;else throw new n(pi);hi.set(pi,ei.Completed)})}return ui}}_t.ValueScope=ni})(scope)),scope}var hasRequiredCodegen;function requireCodegen(){return hasRequiredCodegen||(hasRequiredCodegen=1,(function(_t){Object.defineProperty(_t,"__esModule",{value:!0}),_t.or=_t.and=_t.not=_t.CodeGen=_t.operators=_t.varKinds=_t.ValueScopeName=_t.ValueScope=_t.Scope=_t.Name=_t.regexpCode=_t.stringify=_t.getProperty=_t.nil=_t.strConcat=_t.str=_t._=void 0;const e=requireCode$1(),n=requireScope();var ei=requireCode$1();Object.defineProperty(_t,"_",{enumerable:!0,get:function(){return ei._}}),Object.defineProperty(_t,"str",{enumerable:!0,get:function(){return ei.str}}),Object.defineProperty(_t,"strConcat",{enumerable:!0,get:function(){return ei.strConcat}}),Object.defineProperty(_t,"nil",{enumerable:!0,get:function(){return ei.nil}}),Object.defineProperty(_t,"getProperty",{enumerable:!0,get:function(){return ei.getProperty}}),Object.defineProperty(_t,"stringify",{enumerable:!0,get:function(){return ei.stringify}}),Object.defineProperty(_t,"regexpCode",{enumerable:!0,get:function(){return ei.regexpCode}}),Object.defineProperty(_t,"Name",{enumerable:!0,get:function(){return ei.Name}});var ti=requireScope();Object.defineProperty(_t,"Scope",{enumerable:!0,get:function(){return ti.Scope}}),Object.defineProperty(_t,"ValueScope",{enumerable:!0,get:function(){return ti.ValueScope}}),Object.defineProperty(_t,"ValueScopeName",{enumerable:!0,get:function(){return ti.ValueScopeName}}),Object.defineProperty(_t,"varKinds",{enumerable:!0,get:function(){return ti.varKinds}}),_t.operators={GT:new e._Code(">"),GTE:new e._Code(">="),LT:new e._Code("<"),LTE:new e._Code("<="),EQ:new e._Code("==="),NEQ:new e._Code("!=="),NOT:new e._Code("!"),OR:new e._Code("||"),AND:new e._Code("&&"),ADD:new e._Code("+")};class ii{optimizeNodes(){return this}optimizeNames(xi,Mi){return this}}class ri extends ii{constructor(xi,Mi,Ui){super(),this.varKind=xi,this.name=Mi,this.rhs=Ui}render({es5:xi,_n:Mi}){const Ui=xi?n.varKinds.var:this.varKind,Yi=this.rhs===void 0?"":` = ${this.rhs}`;return`${Ui} ${this.name}${Yi};`+Mi}optimizeNames(xi,Mi){if(xi[this.name.str])return this.rhs&&(this.rhs=Ni(this.rhs,xi,Mi)),this}get names(){return this.rhs instanceof e._CodeOrName?this.rhs.names:{}}}class ni extends ii{constructor(xi,Mi,Ui){super(),this.lhs=xi,this.rhs=Mi,this.sideEffects=Ui}render({_n:xi}){return`${this.lhs} = ${this.rhs};`+xi}optimizeNames(xi,Mi){if(!(this.lhs instanceof e.Name&&!xi[this.lhs.str]&&!this.sideEffects))return this.rhs=Ni(this.rhs,xi,Mi),this}get names(){const xi=this.lhs instanceof e.Name?{}:{...this.lhs.names};return Di(xi,this.rhs)}}class si extends ni{constructor(xi,Mi,Ui,Yi){super(xi,Ui,Yi),this.op=Mi}render({_n:xi}){return`${this.lhs} ${this.op}= ${this.rhs};`+xi}}class ai extends ii{constructor(xi){super(),this.label=xi,this.names={}}render({_n:xi}){return`${this.label}:`+xi}}class oi extends ii{constructor(xi){super(),this.label=xi,this.names={}}render({_n:xi}){return`break${this.label?` ${this.label}`:""};`+xi}}class li extends ii{constructor(xi){super(),this.error=xi}render({_n:xi}){return`throw ${this.error};`+xi}get names(){return this.error.names}}class ci extends ii{constructor(xi){super(),this.code=xi}render({_n:xi}){return`${this.code};`+xi}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(xi,Mi){return this.code=Ni(this.code,xi,Mi),this}get names(){return this.code instanceof e._CodeOrName?this.code.names:{}}}class ui extends ii{constructor(xi=[]){super(),this.nodes=xi}render(xi){return this.nodes.reduce((Mi,Ui)=>Mi+Ui.render(xi),"")}optimizeNodes(){const{nodes:xi}=this;let Mi=xi.length;for(;Mi--;){const Ui=xi[Mi].optimizeNodes();Array.isArray(Ui)?xi.splice(Mi,1,...Ui):Ui?xi[Mi]=Ui:xi.splice(Mi,1)}return xi.length>0?this:void 0}optimizeNames(xi,Mi){const{nodes:Ui}=this;let Yi=Ui.length;for(;Yi--;){const sr=Ui[Yi];sr.optimizeNames(xi,Mi)||($i(xi,sr.names),Ui.splice(Yi,1))}return Ui.length>0?this:void 0}get names(){return this.nodes.reduce((xi,Mi)=>Li(xi,Mi.names),{})}}class di extends ui{render(xi){return"{"+xi._n+super.render(xi)+"}"+xi._n}}class fi extends ui{}class hi extends di{}hi.kind="else";class pi extends di{constructor(xi,Mi){super(Mi),this.condition=xi}render(xi){let Mi=`if(${this.condition})`+super.render(xi);return this.else&&(Mi+="else "+this.else.render(xi)),Mi}optimizeNodes(){super.optimizeNodes();const xi=this.condition;if(xi===!0)return this.nodes;let Mi=this.else;if(Mi){const Ui=Mi.optimizeNodes();Mi=this.else=Array.isArray(Ui)?new hi(Ui):Ui}if(Mi)return xi===!1?Mi instanceof pi?Mi:Mi.nodes:this.nodes.length?this:new pi(Ki(xi),Mi instanceof pi?[Mi]:Mi.nodes);if(!(xi===!1||!this.nodes.length))return this}optimizeNames(xi,Mi){var Ui;if(this.else=(Ui=this.else)===null||Ui===void 0?void 0:Ui.optimizeNames(xi,Mi),!!(super.optimizeNames(xi,Mi)||this.else))return this.condition=Ni(this.condition,xi,Mi),this}get names(){const xi=super.names;return Di(xi,this.condition),this.else&&Li(xi,this.else.names),xi}}pi.kind="if";class gi extends di{}gi.kind="for";class vi extends gi{constructor(xi){super(),this.iteration=xi}render(xi){return`for(${this.iteration})`+super.render(xi)}optimizeNames(xi,Mi){if(super.optimizeNames(xi,Mi))return this.iteration=Ni(this.iteration,xi,Mi),this}get names(){return Li(super.names,this.iteration.names)}}class yi extends gi{constructor(xi,Mi,Ui,Yi){super(),this.varKind=xi,this.name=Mi,this.from=Ui,this.to=Yi}render(xi){const Mi=xi.es5?n.varKinds.var:this.varKind,{name:Ui,from:Yi,to:sr}=this;return`for(${Mi} ${Ui}=${Yi}; ${Ui}<${sr}; ${Ui}++)`+super.render(xi)}get names(){const xi=Di(super.names,this.from);return Di(xi,this.to)}}class _i extends gi{constructor(xi,Mi,Ui,Yi){super(),this.loop=xi,this.varKind=Mi,this.name=Ui,this.iterable=Yi}render(xi){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(xi)}optimizeNames(xi,Mi){if(super.optimizeNames(xi,Mi))return this.iterable=Ni(this.iterable,xi,Mi),this}get names(){return Li(super.names,this.iterable.names)}}class Ai extends di{constructor(xi,Mi,Ui){super(),this.name=xi,this.args=Mi,this.async=Ui}render(xi){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(xi)}}Ai.kind="func";class Ei extends ui{render(xi){return"return "+super.render(xi)}}Ei.kind="return";class Si extends di{render(xi){let Mi="try"+super.render(xi);return this.catch&&(Mi+=this.catch.render(xi)),this.finally&&(Mi+=this.finally.render(xi)),Mi}optimizeNodes(){var xi,Mi;return super.optimizeNodes(),(xi=this.catch)===null||xi===void 0||xi.optimizeNodes(),(Mi=this.finally)===null||Mi===void 0||Mi.optimizeNodes(),this}optimizeNames(xi,Mi){var Ui,Yi;return super.optimizeNames(xi,Mi),(Ui=this.catch)===null||Ui===void 0||Ui.optimizeNames(xi,Mi),(Yi=this.finally)===null||Yi===void 0||Yi.optimizeNames(xi,Mi),this}get names(){const xi=super.names;return this.catch&&Li(xi,this.catch.names),this.finally&&Li(xi,this.finally.names),xi}}class wi extends di{constructor(xi){super(),this.error=xi}render(xi){return`catch(${this.error})`+super.render(xi)}}wi.kind="catch";class Oi extends di{render(xi){return"finally"+super.render(xi)}}Oi.kind="finally";class Ii{constructor(xi,Mi={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...Mi,_n:Mi.lines?`
`:""},this._extScope=xi,this._scope=new n.Scope({parent:xi}),this._nodes=[new fi]}toString(){return this._root.render(this.opts)}name(xi){return this._scope.name(xi)}scopeName(xi){return this._extScope.name(xi)}scopeValue(xi,Mi){const Ui=this._extScope.value(xi,Mi);return(this._values[Ui.prefix]||(this._values[Ui.prefix]=new Set)).add(Ui),Ui}getScopeValue(xi,Mi){return this._extScope.getValue(xi,Mi)}scopeRefs(xi){return this._extScope.scopeRefs(xi,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(xi,Mi,Ui,Yi){const sr=this._scope.toName(Mi);return Ui!==void 0&&Yi&&(this._constants[sr.str]=Ui),this._leafNode(new ri(xi,sr,Ui)),sr}const(xi,Mi,Ui){return this._def(n.varKinds.const,xi,Mi,Ui)}let(xi,Mi,Ui){return this._def(n.varKinds.let,xi,Mi,Ui)}var(xi,Mi,Ui){return this._def(n.varKinds.var,xi,Mi,Ui)}assign(xi,Mi,Ui){return this._leafNode(new ni(xi,Mi,Ui))}add(xi,Mi){return this._leafNode(new si(xi,_t.operators.ADD,Mi))}code(xi){return typeof xi=="function"?xi():xi!==e.nil&&this._leafNode(new ci(xi)),this}object(...xi){const Mi=["{"];for(const[Ui,Yi]of xi)Mi.length>1&&Mi.push(","),Mi.push(Ui),(Ui!==Yi||this.opts.es5)&&(Mi.push(":"),(0,e.addCodeArg)(Mi,Yi));return Mi.push("}"),new e._Code(Mi)}if(xi,Mi,Ui){if(this._blockNode(new pi(xi)),Mi&&Ui)this.code(Mi).else().code(Ui).endIf();else if(Mi)this.code(Mi).endIf();else if(Ui)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(xi){return this._elseNode(new pi(xi))}else(){return this._elseNode(new hi)}endIf(){return this._endBlockNode(pi,hi)}_for(xi,Mi){return this._blockNode(xi),Mi&&this.code(Mi).endFor(),this}for(xi,Mi){return this._for(new vi(xi),Mi)}forRange(xi,Mi,Ui,Yi,sr=this.opts.es5?n.varKinds.var:n.varKinds.let){const cr=this._scope.toName(xi);return this._for(new yi(sr,cr,Mi,Ui),()=>Yi(cr))}forOf(xi,Mi,Ui,Yi=n.varKinds.const){const sr=this._scope.toName(xi);if(this.opts.es5){const cr=Mi instanceof e.Name?Mi:this.var("_arr",Mi);return this.forRange("_i",0,(0,e._)`${cr}.length`,ir=>{this.var(sr,(0,e._)`${cr}[${ir}]`),Ui(sr)})}return this._for(new _i("of",Yi,sr,Mi),()=>Ui(sr))}forIn(xi,Mi,Ui,Yi=this.opts.es5?n.varKinds.var:n.varKinds.const){if(this.opts.ownProperties)return this.forOf(xi,(0,e._)`Object.keys(${Mi})`,Ui);const sr=this._scope.toName(xi);return this._for(new _i("in",Yi,sr,Mi),()=>Ui(sr))}endFor(){return this._endBlockNode(gi)}label(xi){return this._leafNode(new ai(xi))}break(xi){return this._leafNode(new oi(xi))}return(xi){const Mi=new Ei;if(this._blockNode(Mi),this.code(xi),Mi.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(Ei)}try(xi,Mi,Ui){if(!Mi&&!Ui)throw new Error('CodeGen: "try" without "catch" and "finally"');const Yi=new Si;if(this._blockNode(Yi),this.code(xi),Mi){const sr=this.name("e");this._currNode=Yi.catch=new wi(sr),Mi(sr)}return Ui&&(this._currNode=Yi.finally=new Oi,this.code(Ui)),this._endBlockNode(wi,Oi)}throw(xi){return this._leafNode(new li(xi))}block(xi,Mi){return this._blockStarts.push(this._nodes.length),xi&&this.code(xi).endBlock(Mi),this}endBlock(xi){const Mi=this._blockStarts.pop();if(Mi===void 0)throw new Error("CodeGen: not in self-balancing block");const Ui=this._nodes.length-Mi;if(Ui<0||xi!==void 0&&Ui!==xi)throw new Error(`CodeGen: wrong number of nodes: ${Ui} vs ${xi} expected`);return this._nodes.length=Mi,this}func(xi,Mi=e.nil,Ui,Yi){return this._blockNode(new Ai(xi,Mi,Ui)),Yi&&this.code(Yi).endFunc(),this}endFunc(){return this._endBlockNode(Ai)}optimize(xi=1){for(;xi-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(xi){return this._currNode.nodes.push(xi),this}_blockNode(xi){this._currNode.nodes.push(xi),this._nodes.push(xi)}_endBlockNode(xi,Mi){const Ui=this._currNode;if(Ui instanceof xi||Mi&&Ui instanceof Mi)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${Mi?`${xi.kind}/${Mi.kind}`:xi.kind}"`)}_elseNode(xi){const Mi=this._currNode;if(!(Mi instanceof pi))throw new Error('CodeGen: "else" without "if"');return this._currNode=Mi.else=xi,this}get _root(){return this._nodes[0]}get _currNode(){const xi=this._nodes;return xi[xi.length-1]}set _currNode(xi){const Mi=this._nodes;Mi[Mi.length-1]=xi}}_t.CodeGen=Ii;function Li(ki,xi){for(const Mi in xi)ki[Mi]=(ki[Mi]||0)+(xi[Mi]||0);return ki}function Di(ki,xi){return xi instanceof e._CodeOrName?Li(ki,xi.names):ki}function Ni(ki,xi,Mi){if(ki instanceof e.Name)return Ui(ki);if(!Yi(ki))return ki;return new e._Code(ki._items.reduce((sr,cr)=>(cr instanceof e.Name&&(cr=Ui(cr)),cr instanceof e._Code?sr.push(...cr._items):sr.push(cr),sr),[]));function Ui(sr){const cr=Mi[sr.str];return cr===void 0||xi[sr.str]!==1?sr:(delete xi[sr.str],cr)}function Yi(sr){return sr instanceof e._Code&&sr._items.some(cr=>cr instanceof e.Name&&xi[cr.str]===1&&Mi[cr.str]!==void 0)}}function $i(ki,xi){for(const Mi in xi)ki[Mi]=(ki[Mi]||0)-(xi[Mi]||0)}function Ki(ki){return typeof ki=="boolean"||typeof ki=="number"||ki===null?!ki:(0,e._)`!${Ti(ki)}`}_t.not=Ki;const er=Wi(_t.operators.AND);function Vi(...ki){return ki.reduce(er)}_t.and=Vi;const nr=Wi(_t.operators.OR);function zi(...ki){return ki.reduce(nr)}_t.or=zi;function Wi(ki){return(xi,Mi)=>xi===e.nil?Mi:Mi===e.nil?xi:(0,e._)`${Ti(xi)} ${ki} ${Ti(Mi)}`}function Ti(ki){return ki instanceof e.Name?ki:(0,e._)`(${ki})`}})(codegen)),codegen}var types={},hasRequiredTypes;function requireTypes(){if(hasRequiredTypes)return types;hasRequiredTypes=1,Object.defineProperty(types,"__esModule",{value:!0}),types.DiscrError=void 0;var _t;return(function(e){e.Tag="tag",e.Mapping="mapping"})(_t||(types.DiscrError=_t={})),types}var compile={},validation_error={},hasRequiredValidation_error;function requireValidation_error(){if(hasRequiredValidation_error)return validation_error;hasRequiredValidation_error=1,Object.defineProperty(validation_error,"__esModule",{value:!0});class _t extends Error{constructor(n){super("validation failed"),this.errors=n,this.ajv=this.validation=!0}}return validation_error.default=_t,validation_error}var names={},hasRequiredNames;function requireNames(){if(hasRequiredNames)return names;hasRequiredNames=1,Object.defineProperty(names,"__esModule",{value:!0});const _t=requireCodegen(),e={data:new _t.Name("data"),valCxt:new _t.Name("valCxt"),instancePath:new _t.Name("instancePath"),parentData:new _t.Name("parentData"),parentDataProperty:new _t.Name("parentDataProperty"),rootData:new _t.Name("rootData"),dynamicAnchors:new _t.Name("dynamicAnchors"),vErrors:new _t.Name("vErrors"),errors:new _t.Name("errors"),this:new _t.Name("this"),self:new _t.Name("self"),scope:new _t.Name("scope"),json:new _t.Name("json"),jsonPos:new _t.Name("jsonPos"),jsonLen:new _t.Name("jsonLen"),jsonPart:new _t.Name("jsonPart")};return names.default=e,names}var resolve={},util={},hasRequiredUtil;function requireUtil(){if(hasRequiredUtil)return util;hasRequiredUtil=1,Object.defineProperty(util,"__esModule",{value:!0}),util.checkStrictMode=util.getErrorPath=util.Type=util.useFunc=util.setEvaluated=util.evaluatedPropsToName=util.mergeEvaluated=util.eachItem=util.unescapeJsonPointer=util.escapeJsonPointer=util.escapeFragment=util.unescapeFragment=util.schemaRefOrVal=util.schemaHasRulesButRef=util.schemaHasRules=util.checkUnknownRules=util.alwaysValidSchema=util.toHash=void 0;const _t=requireCodegen(),e=requireCode$1();function n(_i){const Ai={};for(const Ei of _i)Ai[Ei]=!0;return Ai}util.toHash=n;function ei(_i,Ai){return typeof Ai=="boolean"?Ai:Object.keys(Ai).length===0?!0:(ti(_i,Ai),!ii(Ai,_i.self.RULES.all))}util.alwaysValidSchema=ei;function ti(_i,Ai=_i.schema){const{opts:Ei,self:Si}=_i;if(!Ei.strictSchema||typeof Ai=="boolean")return;const wi=Si.RULES.keywords;for(const Oi in Ai)wi[Oi]||yi(_i,`unknown keyword: "${Oi}"`)}util.checkUnknownRules=ti;function ii(_i,Ai){if(typeof _i=="boolean")return!_i;for(const Ei in _i)if(Ai[Ei])return!0;return!1}util.schemaHasRules=ii;function ri(_i,Ai){if(typeof _i=="boolean")return!_i;for(const Ei in _i)if(Ei!=="$ref"&&Ai.all[Ei])return!0;return!1}util.schemaHasRulesButRef=ri;function ni({topSchemaRef:_i,schemaPath:Ai},Ei,Si,wi){if(!wi){if(typeof Ei=="number"||typeof Ei=="boolean")return Ei;if(typeof Ei=="string")return(0,_t._)`${Ei}`}return(0,_t._)`${_i}${Ai}${(0,_t.getProperty)(Si)}`}util.schemaRefOrVal=ni;function si(_i){return li(decodeURIComponent(_i))}util.unescapeFragment=si;function ai(_i){return encodeURIComponent(oi(_i))}util.escapeFragment=ai;function oi(_i){return typeof _i=="number"?`${_i}`:_i.replace(/~/g,"~0").replace(/\//g,"~1")}util.escapeJsonPointer=oi;function li(_i){return _i.replace(/~1/g,"/").replace(/~0/g,"~")}util.unescapeJsonPointer=li;function ci(_i,Ai){if(Array.isArray(_i))for(const Ei of _i)Ai(Ei);else Ai(_i)}util.eachItem=ci;function ui({mergeNames:_i,mergeToName:Ai,mergeValues:Ei,resultToName:Si}){return(wi,Oi,Ii,Li)=>{const Di=Ii===void 0?Oi:Ii instanceof _t.Name?(Oi instanceof _t.Name?_i(wi,Oi,Ii):Ai(wi,Oi,Ii),Ii):Oi instanceof _t.Name?(Ai(wi,Ii,Oi),Oi):Ei(Oi,Ii);return Li===_t.Name&&!(Di instanceof _t.Name)?Si(wi,Di):Di}}util.mergeEvaluated={props:ui({mergeNames:(_i,Ai,Ei)=>_i.if((0,_t._)`${Ei} !== true && ${Ai} !== undefined`,()=>{_i.if((0,_t._)`${Ai} === true`,()=>_i.assign(Ei,!0),()=>_i.assign(Ei,(0,_t._)`${Ei} || {}`).code((0,_t._)`Object.assign(${Ei}, ${Ai})`))}),mergeToName:(_i,Ai,Ei)=>_i.if((0,_t._)`${Ei} !== true`,()=>{Ai===!0?_i.assign(Ei,!0):(_i.assign(Ei,(0,_t._)`${Ei} || {}`),fi(_i,Ei,Ai))}),mergeValues:(_i,Ai)=>_i===!0?!0:{..._i,...Ai},resultToName:di}),items:ui({mergeNames:(_i,Ai,Ei)=>_i.if((0,_t._)`${Ei} !== true && ${Ai} !== undefined`,()=>_i.assign(Ei,(0,_t._)`${Ai} === true ? true : ${Ei} > ${Ai} ? ${Ei} : ${Ai}`)),mergeToName:(_i,Ai,Ei)=>_i.if((0,_t._)`${Ei} !== true`,()=>_i.assign(Ei,Ai===!0?!0:(0,_t._)`${Ei} > ${Ai} ? ${Ei} : ${Ai}`)),mergeValues:(_i,Ai)=>_i===!0?!0:Math.max(_i,Ai),resultToName:(_i,Ai)=>_i.var("items",Ai)})};function di(_i,Ai){if(Ai===!0)return _i.var("props",!0);const Ei=_i.var("props",(0,_t._)`{}`);return Ai!==void 0&&fi(_i,Ei,Ai),Ei}util.evaluatedPropsToName=di;function fi(_i,Ai,Ei){Object.keys(Ei).forEach(Si=>_i.assign((0,_t._)`${Ai}${(0,_t.getProperty)(Si)}`,!0))}util.setEvaluated=fi;const hi={};function pi(_i,Ai){return _i.scopeValue("func",{ref:Ai,code:hi[Ai.code]||(hi[Ai.code]=new e._Code(Ai.code))})}util.useFunc=pi;var gi;(function(_i){_i[_i.Num=0]="Num",_i[_i.Str=1]="Str"})(gi||(util.Type=gi={}));function vi(_i,Ai,Ei){if(_i instanceof _t.Name){const Si=Ai===gi.Num;return Ei?Si?(0,_t._)`"[" + ${_i} + "]"`:(0,_t._)`"['" + ${_i} + "']"`:Si?(0,_t._)`"/" + ${_i}`:(0,_t._)`"/" + ${_i}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return Ei?(0,_t.getProperty)(_i).toString():"/"+oi(_i)}util.getErrorPath=vi;function yi(_i,Ai,Ei=_i.opts.strictSchema){if(Ei){if(Ai=`strict mode: ${Ai}`,Ei===!0)throw new Error(Ai);_i.self.logger.warn(Ai)}}return util.checkStrictMode=yi,util}var fastDeepEqual,hasRequiredFastDeepEqual;function requireFastDeepEqual(){return hasRequiredFastDeepEqual||(hasRequiredFastDeepEqual=1,fastDeepEqual=function _t(e,n){if(e===n)return!0;if(e&&n&&typeof e=="object"&&typeof n=="object"){if(e.constructor!==n.constructor)return!1;var ei,ti,ii;if(Array.isArray(e)){if(ei=e.length,ei!=n.length)return!1;for(ti=ei;ti--!==0;)if(!_t(e[ti],n[ti]))return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if(ii=Object.keys(e),ei=ii.length,ei!==Object.keys(n).length)return!1;for(ti=ei;ti--!==0;)if(!Object.prototype.hasOwnProperty.call(n,ii[ti]))return!1;for(ti=ei;ti--!==0;){var ri=ii[ti];if(!_t(e[ri],n[ri]))return!1}return!0}return e!==e&&n!==n}),fastDeepEqual}var jsonSchemaTraverse={exports:{}},hasRequiredJsonSchemaTraverse;function requireJsonSchemaTraverse(){if(hasRequiredJsonSchemaTraverse)return jsonSchemaTraverse.exports;hasRequiredJsonSchemaTraverse=1;var _t=jsonSchemaTraverse.exports=function(ei,ti,ii){typeof ti=="function"&&(ii=ti,ti={}),ii=ti.cb||ii;var ri=typeof ii=="function"?ii:ii.pre||function(){},ni=ii.post||function(){};e(ti,ri,ni,ei,"",ei)};_t.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0},_t.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},_t.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},_t.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function e(ei,ti,ii,ri,ni,si,ai,oi,li,ci){if(ri&&typeof ri=="object"&&!Array.isArray(ri)){ti(ri,ni,si,ai,oi,li,ci);for(var ui in ri){var di=ri[ui];if(Array.isArray(di)){if(ui in _t.arrayKeywords)for(var fi=0;fi<di.length;fi++)e(ei,ti,ii,di[fi],ni+"/"+ui+"/"+fi,si,ni,ui,ri,fi)}else if(ui in _t.propsKeywords){if(di&&typeof di=="object")for(var hi in di)e(ei,ti,ii,di[hi],ni+"/"+ui+"/"+n(hi),si,ni,ui,ri,hi)}else(ui in _t.keywords||ei.allKeys&&!(ui in _t.skipKeywords))&&e(ei,ti,ii,di,ni+"/"+ui,si,ni,ui,ri)}ii(ri,ni,si,ai,oi,li,ci)}}function n(ei){return ei.replace(/~/g,"~0").replace(/\//g,"~1")}return jsonSchemaTraverse.exports}var hasRequiredResolve;function requireResolve(){if(hasRequiredResolve)return resolve;hasRequiredResolve=1,Object.defineProperty(resolve,"__esModule",{value:!0}),resolve.getSchemaRefs=resolve.resolveUrl=resolve.normalizeId=resolve._getFullPath=resolve.getFullPath=resolve.inlineRef=void 0;const _t=requireUtil(),e=requireFastDeepEqual(),n=requireJsonSchemaTraverse(),ei=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function ti(fi,hi=!0){return typeof fi=="boolean"?!0:hi===!0?!ri(fi):hi?ni(fi)<=hi:!1}resolve.inlineRef=ti;const ii=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function ri(fi){for(const hi in fi){if(ii.has(hi))return!0;const pi=fi[hi];if(Array.isArray(pi)&&pi.some(ri)||typeof pi=="object"&&ri(pi))return!0}return!1}function ni(fi){let hi=0;for(const pi in fi){if(pi==="$ref")return 1/0;if(hi++,!ei.has(pi)&&(typeof fi[pi]=="object"&&(0,_t.eachItem)(fi[pi],gi=>hi+=ni(gi)),hi===1/0))return 1/0}return hi}function si(fi,hi="",pi){pi!==!1&&(hi=li(hi));const gi=fi.parse(hi);return ai(fi,gi)}resolve.getFullPath=si;function ai(fi,hi){return fi.serialize(hi).split("#")[0]+"#"}resolve._getFullPath=ai;const oi=/#\/?$/;function li(fi){return fi?fi.replace(oi,""):""}resolve.normalizeId=li;function ci(fi,hi,pi){return pi=li(pi),fi.resolve(hi,pi)}resolve.resolveUrl=ci;const ui=/^[a-z_][-a-z0-9._]*$/i;function di(fi,hi){if(typeof fi=="boolean")return{};const{schemaId:pi,uriResolver:gi}=this.opts,vi=li(fi[pi]||hi),yi={"":vi},_i=si(gi,vi,!1),Ai={},Ei=new Set;return n(fi,{allKeys:!0},(Oi,Ii,Li,Di)=>{if(Di===void 0)return;const Ni=_i+Ii;let $i=yi[Di];typeof Oi[pi]=="string"&&($i=Ki.call(this,Oi[pi])),er.call(this,Oi.$anchor),er.call(this,Oi.$dynamicAnchor),yi[Ii]=$i;function Ki(Vi){const nr=this.opts.uriResolver.resolve;if(Vi=li($i?nr($i,Vi):Vi),Ei.has(Vi))throw wi(Vi);Ei.add(Vi);let zi=this.refs[Vi];return typeof zi=="string"&&(zi=this.refs[zi]),typeof zi=="object"?Si(Oi,zi.schema,Vi):Vi!==li(Ni)&&(Vi[0]==="#"?(Si(Oi,Ai[Vi],Vi),Ai[Vi]=Oi):this.refs[Vi]=Ni),Vi}function er(Vi){if(typeof Vi=="string"){if(!ui.test(Vi))throw new Error(`invalid anchor "${Vi}"`);Ki.call(this,`#${Vi}`)}}}),Ai;function Si(Oi,Ii,Li){if(Ii!==void 0&&!e(Oi,Ii))throw wi(Li)}function wi(Oi){return new Error(`reference "${Oi}" resolves to more than one schema`)}}return resolve.getSchemaRefs=di,resolve}var validate={},boolSchema={},errors={},hasRequiredErrors;function requireErrors(){return hasRequiredErrors||(hasRequiredErrors=1,(function(_t){Object.defineProperty(_t,"__esModule",{value:!0}),_t.extendErrors=_t.resetErrorsCount=_t.reportExtraError=_t.reportError=_t.keyword$DataError=_t.keywordError=void 0;const e=requireCodegen(),n=requireUtil(),ei=requireNames();_t.keywordError={message:({keyword:hi})=>(0,e.str)`must pass "${hi}" keyword validation`},_t.keyword$DataError={message:({keyword:hi,schemaType:pi})=>pi?(0,e.str)`"${hi}" keyword must be ${pi} ($data)`:(0,e.str)`"${hi}" keyword is invalid ($data)`};function ti(hi,pi=_t.keywordError,gi,vi){const{it:yi}=hi,{gen:_i,compositeRule:Ai,allErrors:Ei}=yi,Si=li(hi,pi,gi);vi??(Ai||Ei)?si(_i,Si):ai(yi,(0,e._)`[${Si}]`)}_t.reportError=ti;function ii(hi,pi=_t.keywordError,gi){const{it:vi}=hi,{gen:yi,compositeRule:_i,allErrors:Ai}=vi,Ei=li(hi,pi,gi);si(yi,Ei),_i||Ai||ai(vi,ei.default.vErrors)}_t.reportExtraError=ii;function ri(hi,pi){hi.assign(ei.default.errors,pi),hi.if((0,e._)`${ei.default.vErrors} !== null`,()=>hi.if(pi,()=>hi.assign((0,e._)`${ei.default.vErrors}.length`,pi),()=>hi.assign(ei.default.vErrors,null)))}_t.resetErrorsCount=ri;function ni({gen:hi,keyword:pi,schemaValue:gi,data:vi,errsCount:yi,it:_i}){if(yi===void 0)throw new Error("ajv implementation error");const Ai=hi.name("err");hi.forRange("i",yi,ei.default.errors,Ei=>{hi.const(Ai,(0,e._)`${ei.default.vErrors}[${Ei}]`),hi.if((0,e._)`${Ai}.instancePath === undefined`,()=>hi.assign((0,e._)`${Ai}.instancePath`,(0,e.strConcat)(ei.default.instancePath,_i.errorPath))),hi.assign((0,e._)`${Ai}.schemaPath`,(0,e.str)`${_i.errSchemaPath}/${pi}`),_i.opts.verbose&&(hi.assign((0,e._)`${Ai}.schema`,gi),hi.assign((0,e._)`${Ai}.data`,vi))})}_t.extendErrors=ni;function si(hi,pi){const gi=hi.const("err",pi);hi.if((0,e._)`${ei.default.vErrors} === null`,()=>hi.assign(ei.default.vErrors,(0,e._)`[${gi}]`),(0,e._)`${ei.default.vErrors}.push(${gi})`),hi.code((0,e._)`${ei.default.errors}++`)}function ai(hi,pi){const{gen:gi,validateName:vi,schemaEnv:yi}=hi;yi.$async?gi.throw((0,e._)`new ${hi.ValidationError}(${pi})`):(gi.assign((0,e._)`${vi}.errors`,pi),gi.return(!1))}const oi={keyword:new e.Name("keyword"),schemaPath:new e.Name("schemaPath"),params:new e.Name("params"),propertyName:new e.Name("propertyName"),message:new e.Name("message"),schema:new e.Name("schema"),parentSchema:new e.Name("parentSchema")};function li(hi,pi,gi){const{createErrors:vi}=hi.it;return vi===!1?(0,e._)`{}`:ci(hi,pi,gi)}function ci(hi,pi,gi={}){const{gen:vi,it:yi}=hi,_i=[ui(yi,gi),di(hi,gi)];return fi(hi,pi,_i),vi.object(..._i)}function ui({errorPath:hi},{instancePath:pi}){const gi=pi?(0,e.str)`${hi}${(0,n.getErrorPath)(pi,n.Type.Str)}`:hi;return[ei.default.instancePath,(0,e.strConcat)(ei.default.instancePath,gi)]}function di({keyword:hi,it:{errSchemaPath:pi}},{schemaPath:gi,parentSchema:vi}){let yi=vi?pi:(0,e.str)`${pi}/${hi}`;return gi&&(yi=(0,e.str)`${yi}${(0,n.getErrorPath)(gi,n.Type.Str)}`),[oi.schemaPath,yi]}function fi(hi,{params:pi,message:gi},vi){const{keyword:yi,data:_i,schemaValue:Ai,it:Ei}=hi,{opts:Si,propertyName:wi,topSchemaRef:Oi,schemaPath:Ii}=Ei;vi.push([oi.keyword,yi],[oi.params,typeof pi=="function"?pi(hi):pi||(0,e._)`{}`]),Si.messages&&vi.push([oi.message,typeof gi=="function"?gi(hi):gi]),Si.verbose&&vi.push([oi.schema,Ai],[oi.parentSchema,(0,e._)`${Oi}${Ii}`],[ei.default.data,_i]),wi&&vi.push([oi.propertyName,wi])}})(errors)),errors}var hasRequiredBoolSchema;function requireBoolSchema(){if(hasRequiredBoolSchema)return boolSchema;hasRequiredBoolSchema=1,Object.defineProperty(boolSchema,"__esModule",{value:!0}),boolSchema.boolOrEmptySchema=boolSchema.topBoolOrEmptySchema=void 0;const _t=requireErrors(),e=requireCodegen(),n=requireNames(),ei={message:"boolean schema is false"};function ti(ni){const{gen:si,schema:ai,validateName:oi}=ni;ai===!1?ri(ni,!1):typeof ai=="object"&&ai.$async===!0?si.return(n.default.data):(si.assign((0,e._)`${oi}.errors`,null),si.return(!0))}boolSchema.topBoolOrEmptySchema=ti;function ii(ni,si){const{gen:ai,schema:oi}=ni;oi===!1?(ai.var(si,!1),ri(ni)):ai.var(si,!0)}boolSchema.boolOrEmptySchema=ii;function ri(ni,si){const{gen:ai,data:oi}=ni,li={gen:ai,keyword:"false schema",data:oi,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:ni};(0,_t.reportError)(li,ei,void 0,si)}return boolSchema}var dataType={},rules={},hasRequiredRules;function requireRules(){if(hasRequiredRules)return rules;hasRequiredRules=1,Object.defineProperty(rules,"__esModule",{value:!0}),rules.getRules=rules.isJSONType=void 0;const _t=["string","number","integer","boolean","null","object","array"],e=new Set(_t);function n(ti){return typeof ti=="string"&&e.has(ti)}rules.isJSONType=n;function ei(){const ti={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...ti,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},ti.number,ti.string,ti.array,ti.object],post:{rules:[]},all:{},keywords:{}}}return rules.getRules=ei,rules}var applicability={},hasRequiredApplicability;function requireApplicability(){if(hasRequiredApplicability)return applicability;hasRequiredApplicability=1,Object.defineProperty(applicability,"__esModule",{value:!0}),applicability.shouldUseRule=applicability.shouldUseGroup=applicability.schemaHasRulesForType=void 0;function _t({schema:ei,self:ti},ii){const ri=ti.RULES.types[ii];return ri&&ri!==!0&&e(ei,ri)}applicability.schemaHasRulesForType=_t;function e(ei,ti){return ti.rules.some(ii=>n(ei,ii))}applicability.shouldUseGroup=e;function n(ei,ti){var ii;return ei[ti.keyword]!==void 0||((ii=ti.definition.implements)===null||ii===void 0?void 0:ii.some(ri=>ei[ri]!==void 0))}return applicability.shouldUseRule=n,applicability}var hasRequiredDataType;function requireDataType(){if(hasRequiredDataType)return dataType;hasRequiredDataType=1,Object.defineProperty(dataType,"__esModule",{value:!0}),dataType.reportTypeError=dataType.checkDataTypes=dataType.checkDataType=dataType.coerceAndCheckDataType=dataType.getJSONTypes=dataType.getSchemaTypes=dataType.DataType=void 0;const _t=requireRules(),e=requireApplicability(),n=requireErrors(),ei=requireCodegen(),ti=requireUtil();var ii;(function(gi){gi[gi.Correct=0]="Correct",gi[gi.Wrong=1]="Wrong"})(ii||(dataType.DataType=ii={}));function ri(gi){const vi=ni(gi.type);if(vi.includes("null")){if(gi.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!vi.length&&gi.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');gi.nullable===!0&&vi.push("null")}return vi}dataType.getSchemaTypes=ri;function ni(gi){const vi=Array.isArray(gi)?gi:gi?[gi]:[];if(vi.every(_t.isJSONType))return vi;throw new Error("type must be JSONType or JSONType[]: "+vi.join(","))}dataType.getJSONTypes=ni;function si(gi,vi){const{gen:yi,data:_i,opts:Ai}=gi,Ei=oi(vi,Ai.coerceTypes),Si=vi.length>0&&!(Ei.length===0&&vi.length===1&&(0,e.schemaHasRulesForType)(gi,vi[0]));if(Si){const wi=di(vi,_i,Ai.strictNumbers,ii.Wrong);yi.if(wi,()=>{Ei.length?li(gi,vi,Ei):hi(gi)})}return Si}dataType.coerceAndCheckDataType=si;const ai=new Set(["string","number","integer","boolean","null"]);function oi(gi,vi){return vi?gi.filter(yi=>ai.has(yi)||vi==="array"&&yi==="array"):[]}function li(gi,vi,yi){const{gen:_i,data:Ai,opts:Ei}=gi,Si=_i.let("dataType",(0,ei._)`typeof ${Ai}`),wi=_i.let("coerced",(0,ei._)`undefined`);Ei.coerceTypes==="array"&&_i.if((0,ei._)`${Si} == 'object' && Array.isArray(${Ai}) && ${Ai}.length == 1`,()=>_i.assign(Ai,(0,ei._)`${Ai}[0]`).assign(Si,(0,ei._)`typeof ${Ai}`).if(di(vi,Ai,Ei.strictNumbers),()=>_i.assign(wi,Ai))),_i.if((0,ei._)`${wi} !== undefined`);for(const Ii of yi)(ai.has(Ii)||Ii==="array"&&Ei.coerceTypes==="array")&&Oi(Ii);_i.else(),hi(gi),_i.endIf(),_i.if((0,ei._)`${wi} !== undefined`,()=>{_i.assign(Ai,wi),ci(gi,wi)});function Oi(Ii){switch(Ii){case"string":_i.elseIf((0,ei._)`${Si} == "number" || ${Si} == "boolean"`).assign(wi,(0,ei._)`"" + ${Ai}`).elseIf((0,ei._)`${Ai} === null`).assign(wi,(0,ei._)`""`);return;case"number":_i.elseIf((0,ei._)`${Si} == "boolean" || ${Ai} === null
              || (${Si} == "string" && ${Ai} && ${Ai} == +${Ai})`).assign(wi,(0,ei._)`+${Ai}`);return;case"integer":_i.elseIf((0,ei._)`${Si} === "boolean" || ${Ai} === null
              || (${Si} === "string" && ${Ai} && ${Ai} == +${Ai} && !(${Ai} % 1))`).assign(wi,(0,ei._)`+${Ai}`);return;case"boolean":_i.elseIf((0,ei._)`${Ai} === "false" || ${Ai} === 0 || ${Ai} === null`).assign(wi,!1).elseIf((0,ei._)`${Ai} === "true" || ${Ai} === 1`).assign(wi,!0);return;case"null":_i.elseIf((0,ei._)`${Ai} === "" || ${Ai} === 0 || ${Ai} === false`),_i.assign(wi,null);return;case"array":_i.elseIf((0,ei._)`${Si} === "string" || ${Si} === "number"
              || ${Si} === "boolean" || ${Ai} === null`).assign(wi,(0,ei._)`[${Ai}]`)}}}function ci({gen:gi,parentData:vi,parentDataProperty:yi},_i){gi.if((0,ei._)`${vi} !== undefined`,()=>gi.assign((0,ei._)`${vi}[${yi}]`,_i))}function ui(gi,vi,yi,_i=ii.Correct){const Ai=_i===ii.Correct?ei.operators.EQ:ei.operators.NEQ;let Ei;switch(gi){case"null":return(0,ei._)`${vi} ${Ai} null`;case"array":Ei=(0,ei._)`Array.isArray(${vi})`;break;case"object":Ei=(0,ei._)`${vi} && typeof ${vi} == "object" && !Array.isArray(${vi})`;break;case"integer":Ei=Si((0,ei._)`!(${vi} % 1) && !isNaN(${vi})`);break;case"number":Ei=Si();break;default:return(0,ei._)`typeof ${vi} ${Ai} ${gi}`}return _i===ii.Correct?Ei:(0,ei.not)(Ei);function Si(wi=ei.nil){return(0,ei.and)((0,ei._)`typeof ${vi} == "number"`,wi,yi?(0,ei._)`isFinite(${vi})`:ei.nil)}}dataType.checkDataType=ui;function di(gi,vi,yi,_i){if(gi.length===1)return ui(gi[0],vi,yi,_i);let Ai;const Ei=(0,ti.toHash)(gi);if(Ei.array&&Ei.object){const Si=(0,ei._)`typeof ${vi} != "object"`;Ai=Ei.null?Si:(0,ei._)`!${vi} || ${Si}`,delete Ei.null,delete Ei.array,delete Ei.object}else Ai=ei.nil;Ei.number&&delete Ei.integer;for(const Si in Ei)Ai=(0,ei.and)(Ai,ui(Si,vi,yi,_i));return Ai}dataType.checkDataTypes=di;const fi={message:({schema:gi})=>`must be ${gi}`,params:({schema:gi,schemaValue:vi})=>typeof gi=="string"?(0,ei._)`{type: ${gi}}`:(0,ei._)`{type: ${vi}}`};function hi(gi){const vi=pi(gi);(0,n.reportError)(vi,fi)}dataType.reportTypeError=hi;function pi(gi){const{gen:vi,data:yi,schema:_i}=gi,Ai=(0,ti.schemaRefOrVal)(gi,_i,"type");return{gen:vi,keyword:"type",data:yi,schema:_i.type,schemaCode:Ai,schemaValue:Ai,parentSchema:_i,params:{},it:gi}}return dataType}var defaults={},hasRequiredDefaults;function requireDefaults(){if(hasRequiredDefaults)return defaults;hasRequiredDefaults=1,Object.defineProperty(defaults,"__esModule",{value:!0}),defaults.assignDefaults=void 0;const _t=requireCodegen(),e=requireUtil();function n(ti,ii){const{properties:ri,items:ni}=ti.schema;if(ii==="object"&&ri)for(const si in ri)ei(ti,si,ri[si].default);else ii==="array"&&Array.isArray(ni)&&ni.forEach((si,ai)=>ei(ti,ai,si.default))}defaults.assignDefaults=n;function ei(ti,ii,ri){const{gen:ni,compositeRule:si,data:ai,opts:oi}=ti;if(ri===void 0)return;const li=(0,_t._)`${ai}${(0,_t.getProperty)(ii)}`;if(si){(0,e.checkStrictMode)(ti,`default is ignored for: ${li}`);return}let ci=(0,_t._)`${li} === undefined`;oi.useDefaults==="empty"&&(ci=(0,_t._)`${ci} || ${li} === null || ${li} === ""`),ni.if(ci,(0,_t._)`${li} = ${(0,_t.stringify)(ri)}`)}return defaults}var keyword={},code={},hasRequiredCode;function requireCode(){if(hasRequiredCode)return code;hasRequiredCode=1,Object.defineProperty(code,"__esModule",{value:!0}),code.validateUnion=code.validateArray=code.usePattern=code.callValidateCode=code.schemaProperties=code.allSchemaProperties=code.noPropertyInData=code.propertyInData=code.isOwnProperty=code.hasPropFunc=code.reportMissingProp=code.checkMissingProp=code.checkReportMissingProp=void 0;const _t=requireCodegen(),e=requireUtil(),n=requireNames(),ei=requireUtil();function ti(gi,vi){const{gen:yi,data:_i,it:Ai}=gi;yi.if(oi(yi,_i,vi,Ai.opts.ownProperties),()=>{gi.setParams({missingProperty:(0,_t._)`${vi}`},!0),gi.error()})}code.checkReportMissingProp=ti;function ii({gen:gi,data:vi,it:{opts:yi}},_i,Ai){return(0,_t.or)(..._i.map(Ei=>(0,_t.and)(oi(gi,vi,Ei,yi.ownProperties),(0,_t._)`${Ai} = ${Ei}`)))}code.checkMissingProp=ii;function ri(gi,vi){gi.setParams({missingProperty:vi},!0),gi.error()}code.reportMissingProp=ri;function ni(gi){return gi.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,_t._)`Object.prototype.hasOwnProperty`})}code.hasPropFunc=ni;function si(gi,vi,yi){return(0,_t._)`${ni(gi)}.call(${vi}, ${yi})`}code.isOwnProperty=si;function ai(gi,vi,yi,_i){const Ai=(0,_t._)`${vi}${(0,_t.getProperty)(yi)} !== undefined`;return _i?(0,_t._)`${Ai} && ${si(gi,vi,yi)}`:Ai}code.propertyInData=ai;function oi(gi,vi,yi,_i){const Ai=(0,_t._)`${vi}${(0,_t.getProperty)(yi)} === undefined`;return _i?(0,_t.or)(Ai,(0,_t.not)(si(gi,vi,yi))):Ai}code.noPropertyInData=oi;function li(gi){return gi?Object.keys(gi).filter(vi=>vi!=="__proto__"):[]}code.allSchemaProperties=li;function ci(gi,vi){return li(vi).filter(yi=>!(0,e.alwaysValidSchema)(gi,vi[yi]))}code.schemaProperties=ci;function ui({schemaCode:gi,data:vi,it:{gen:yi,topSchemaRef:_i,schemaPath:Ai,errorPath:Ei},it:Si},wi,Oi,Ii){const Li=Ii?(0,_t._)`${gi}, ${vi}, ${_i}${Ai}`:vi,Di=[[n.default.instancePath,(0,_t.strConcat)(n.default.instancePath,Ei)],[n.default.parentData,Si.parentData],[n.default.parentDataProperty,Si.parentDataProperty],[n.default.rootData,n.default.rootData]];Si.opts.dynamicRef&&Di.push([n.default.dynamicAnchors,n.default.dynamicAnchors]);const Ni=(0,_t._)`${Li}, ${yi.object(...Di)}`;return Oi!==_t.nil?(0,_t._)`${wi}.call(${Oi}, ${Ni})`:(0,_t._)`${wi}(${Ni})`}code.callValidateCode=ui;const di=(0,_t._)`new RegExp`;function fi({gen:gi,it:{opts:vi}},yi){const _i=vi.unicodeRegExp?"u":"",{regExp:Ai}=vi.code,Ei=Ai(yi,_i);return gi.scopeValue("pattern",{key:Ei.toString(),ref:Ei,code:(0,_t._)`${Ai.code==="new RegExp"?di:(0,ei.useFunc)(gi,Ai)}(${yi}, ${_i})`})}code.usePattern=fi;function hi(gi){const{gen:vi,data:yi,keyword:_i,it:Ai}=gi,Ei=vi.name("valid");if(Ai.allErrors){const wi=vi.let("valid",!0);return Si(()=>vi.assign(wi,!1)),wi}return vi.var(Ei,!0),Si(()=>vi.break()),Ei;function Si(wi){const Oi=vi.const("len",(0,_t._)`${yi}.length`);vi.forRange("i",0,Oi,Ii=>{gi.subschema({keyword:_i,dataProp:Ii,dataPropType:e.Type.Num},Ei),vi.if((0,_t.not)(Ei),wi)})}}code.validateArray=hi;function pi(gi){const{gen:vi,schema:yi,keyword:_i,it:Ai}=gi;if(!Array.isArray(yi))throw new Error("ajv implementation error");if(yi.some(Oi=>(0,e.alwaysValidSchema)(Ai,Oi))&&!Ai.opts.unevaluated)return;const Si=vi.let("valid",!1),wi=vi.name("_valid");vi.block(()=>yi.forEach((Oi,Ii)=>{const Li=gi.subschema({keyword:_i,schemaProp:Ii,compositeRule:!0},wi);vi.assign(Si,(0,_t._)`${Si} || ${wi}`),gi.mergeValidEvaluated(Li,wi)||vi.if((0,_t.not)(Si))})),gi.result(Si,()=>gi.reset(),()=>gi.error(!0))}return code.validateUnion=pi,code}var hasRequiredKeyword;function requireKeyword(){if(hasRequiredKeyword)return keyword;hasRequiredKeyword=1,Object.defineProperty(keyword,"__esModule",{value:!0}),keyword.validateKeywordUsage=keyword.validSchemaType=keyword.funcKeywordCode=keyword.macroKeywordCode=void 0;const _t=requireCodegen(),e=requireNames(),n=requireCode(),ei=requireErrors();function ti(ci,ui){const{gen:di,keyword:fi,schema:hi,parentSchema:pi,it:gi}=ci,vi=ui.macro.call(gi.self,hi,pi,gi),yi=ai(di,fi,vi);gi.opts.validateSchema!==!1&&gi.self.validateSchema(vi,!0);const _i=di.name("valid");ci.subschema({schema:vi,schemaPath:_t.nil,errSchemaPath:`${gi.errSchemaPath}/${fi}`,topSchemaRef:yi,compositeRule:!0},_i),ci.pass(_i,()=>ci.error(!0))}keyword.macroKeywordCode=ti;function ii(ci,ui){var di;const{gen:fi,keyword:hi,schema:pi,parentSchema:gi,$data:vi,it:yi}=ci;si(yi,ui);const _i=!vi&&ui.compile?ui.compile.call(yi.self,pi,gi,yi):ui.validate,Ai=ai(fi,hi,_i),Ei=fi.let("valid");ci.block$data(Ei,Si),ci.ok((di=ui.valid)!==null&&di!==void 0?di:Ei);function Si(){if(ui.errors===!1)Ii(),ui.modifying&&ri(ci),Li(()=>ci.error());else{const Di=ui.async?wi():Oi();ui.modifying&&ri(ci),Li(()=>ni(ci,Di))}}function wi(){const Di=fi.let("ruleErrs",null);return fi.try(()=>Ii((0,_t._)`await `),Ni=>fi.assign(Ei,!1).if((0,_t._)`${Ni} instanceof ${yi.ValidationError}`,()=>fi.assign(Di,(0,_t._)`${Ni}.errors`),()=>fi.throw(Ni))),Di}function Oi(){const Di=(0,_t._)`${Ai}.errors`;return fi.assign(Di,null),Ii(_t.nil),Di}function Ii(Di=ui.async?(0,_t._)`await `:_t.nil){const Ni=yi.opts.passContext?e.default.this:e.default.self,$i=!("compile"in ui&&!vi||ui.schema===!1);fi.assign(Ei,(0,_t._)`${Di}${(0,n.callValidateCode)(ci,Ai,Ni,$i)}`,ui.modifying)}function Li(Di){var Ni;fi.if((0,_t.not)((Ni=ui.valid)!==null&&Ni!==void 0?Ni:Ei),Di)}}keyword.funcKeywordCode=ii;function ri(ci){const{gen:ui,data:di,it:fi}=ci;ui.if(fi.parentData,()=>ui.assign(di,(0,_t._)`${fi.parentData}[${fi.parentDataProperty}]`))}function ni(ci,ui){const{gen:di}=ci;di.if((0,_t._)`Array.isArray(${ui})`,()=>{di.assign(e.default.vErrors,(0,_t._)`${e.default.vErrors} === null ? ${ui} : ${e.default.vErrors}.concat(${ui})`).assign(e.default.errors,(0,_t._)`${e.default.vErrors}.length`),(0,ei.extendErrors)(ci)},()=>ci.error())}function si({schemaEnv:ci},ui){if(ui.async&&!ci.$async)throw new Error("async keyword in sync schema")}function ai(ci,ui,di){if(di===void 0)throw new Error(`keyword "${ui}" failed to compile`);return ci.scopeValue("keyword",typeof di=="function"?{ref:di}:{ref:di,code:(0,_t.stringify)(di)})}function oi(ci,ui,di=!1){return!ui.length||ui.some(fi=>fi==="array"?Array.isArray(ci):fi==="object"?ci&&typeof ci=="object"&&!Array.isArray(ci):typeof ci==fi||di&&typeof ci>"u")}keyword.validSchemaType=oi;function li({schema:ci,opts:ui,self:di,errSchemaPath:fi},hi,pi){if(Array.isArray(hi.keyword)?!hi.keyword.includes(pi):hi.keyword!==pi)throw new Error("ajv implementation error");const gi=hi.dependencies;if(gi!=null&&gi.some(vi=>!Object.prototype.hasOwnProperty.call(ci,vi)))throw new Error(`parent schema must have dependencies of ${pi}: ${gi.join(",")}`);if(hi.validateSchema&&!hi.validateSchema(ci[pi])){const yi=`keyword "${pi}" value is invalid at path "${fi}": `+di.errorsText(hi.validateSchema.errors);if(ui.validateSchema==="log")di.logger.error(yi);else throw new Error(yi)}}return keyword.validateKeywordUsage=li,keyword}var subschema={},hasRequiredSubschema;function requireSubschema(){if(hasRequiredSubschema)return subschema;hasRequiredSubschema=1,Object.defineProperty(subschema,"__esModule",{value:!0}),subschema.extendSubschemaMode=subschema.extendSubschemaData=subschema.getSubschema=void 0;const _t=requireCodegen(),e=requireUtil();function n(ii,{keyword:ri,schemaProp:ni,schema:si,schemaPath:ai,errSchemaPath:oi,topSchemaRef:li}){if(ri!==void 0&&si!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(ri!==void 0){const ci=ii.schema[ri];return ni===void 0?{schema:ci,schemaPath:(0,_t._)`${ii.schemaPath}${(0,_t.getProperty)(ri)}`,errSchemaPath:`${ii.errSchemaPath}/${ri}`}:{schema:ci[ni],schemaPath:(0,_t._)`${ii.schemaPath}${(0,_t.getProperty)(ri)}${(0,_t.getProperty)(ni)}`,errSchemaPath:`${ii.errSchemaPath}/${ri}/${(0,e.escapeFragment)(ni)}`}}if(si!==void 0){if(ai===void 0||oi===void 0||li===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:si,schemaPath:ai,topSchemaRef:li,errSchemaPath:oi}}throw new Error('either "keyword" or "schema" must be passed')}subschema.getSubschema=n;function ei(ii,ri,{dataProp:ni,dataPropType:si,data:ai,dataTypes:oi,propertyName:li}){if(ai!==void 0&&ni!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');const{gen:ci}=ri;if(ni!==void 0){const{errorPath:di,dataPathArr:fi,opts:hi}=ri,pi=ci.let("data",(0,_t._)`${ri.data}${(0,_t.getProperty)(ni)}`,!0);ui(pi),ii.errorPath=(0,_t.str)`${di}${(0,e.getErrorPath)(ni,si,hi.jsPropertySyntax)}`,ii.parentDataProperty=(0,_t._)`${ni}`,ii.dataPathArr=[...fi,ii.parentDataProperty]}if(ai!==void 0){const di=ai instanceof _t.Name?ai:ci.let("data",ai,!0);ui(di),li!==void 0&&(ii.propertyName=li)}oi&&(ii.dataTypes=oi);function ui(di){ii.data=di,ii.dataLevel=ri.dataLevel+1,ii.dataTypes=[],ri.definedProperties=new Set,ii.parentData=ri.data,ii.dataNames=[...ri.dataNames,di]}}subschema.extendSubschemaData=ei;function ti(ii,{jtdDiscriminator:ri,jtdMetadata:ni,compositeRule:si,createErrors:ai,allErrors:oi}){si!==void 0&&(ii.compositeRule=si),ai!==void 0&&(ii.createErrors=ai),oi!==void 0&&(ii.allErrors=oi),ii.jtdDiscriminator=ri,ii.jtdMetadata=ni}return subschema.extendSubschemaMode=ti,subschema}var hasRequiredValidate;function requireValidate(){if(hasRequiredValidate)return validate;hasRequiredValidate=1,Object.defineProperty(validate,"__esModule",{value:!0}),validate.getData=validate.KeywordCxt=validate.validateFunctionCode=void 0;const _t=requireBoolSchema(),e=requireDataType(),n=requireApplicability(),ei=requireDataType(),ti=requireDefaults(),ii=requireKeyword(),ri=requireSubschema(),ni=requireCodegen(),si=requireNames(),ai=requireResolve(),oi=requireUtil(),li=requireErrors();function ci(Zi){if(_i(Zi)&&(Ei(Zi),yi(Zi))){hi(Zi);return}ui(Zi,()=>(0,_t.topBoolOrEmptySchema)(Zi))}validate.validateFunctionCode=ci;function ui({gen:Zi,validateName:rr,schema:ar,schemaEnv:pr,opts:Gi},gr){Gi.code.es5?Zi.func(rr,(0,ni._)`${si.default.data}, ${si.default.valCxt}`,pr.$async,()=>{Zi.code((0,ni._)`"use strict"; ${gi(ar,Gi)}`),fi(Zi,Gi),Zi.code(gr)}):Zi.func(rr,(0,ni._)`${si.default.data}, ${di(Gi)}`,pr.$async,()=>Zi.code(gi(ar,Gi)).code(gr))}function di(Zi){return(0,ni._)`{${si.default.instancePath}="", ${si.default.parentData}, ${si.default.parentDataProperty}, ${si.default.rootData}=${si.default.data}${Zi.dynamicRef?(0,ni._)`, ${si.default.dynamicAnchors}={}`:ni.nil}}={}`}function fi(Zi,rr){Zi.if(si.default.valCxt,()=>{Zi.var(si.default.instancePath,(0,ni._)`${si.default.valCxt}.${si.default.instancePath}`),Zi.var(si.default.parentData,(0,ni._)`${si.default.valCxt}.${si.default.parentData}`),Zi.var(si.default.parentDataProperty,(0,ni._)`${si.default.valCxt}.${si.default.parentDataProperty}`),Zi.var(si.default.rootData,(0,ni._)`${si.default.valCxt}.${si.default.rootData}`),rr.dynamicRef&&Zi.var(si.default.dynamicAnchors,(0,ni._)`${si.default.valCxt}.${si.default.dynamicAnchors}`)},()=>{Zi.var(si.default.instancePath,(0,ni._)`""`),Zi.var(si.default.parentData,(0,ni._)`undefined`),Zi.var(si.default.parentDataProperty,(0,ni._)`undefined`),Zi.var(si.default.rootData,si.default.data),rr.dynamicRef&&Zi.var(si.default.dynamicAnchors,(0,ni._)`{}`)})}function hi(Zi){const{schema:rr,opts:ar,gen:pr}=Zi;ui(Zi,()=>{ar.$comment&&rr.$comment&&Di(Zi),Oi(Zi),pr.let(si.default.vErrors,null),pr.let(si.default.errors,0),ar.unevaluated&&pi(Zi),Si(Zi),Ni(Zi)})}function pi(Zi){const{gen:rr,validateName:ar}=Zi;Zi.evaluated=rr.const("evaluated",(0,ni._)`${ar}.evaluated`),rr.if((0,ni._)`${Zi.evaluated}.dynamicProps`,()=>rr.assign((0,ni._)`${Zi.evaluated}.props`,(0,ni._)`undefined`)),rr.if((0,ni._)`${Zi.evaluated}.dynamicItems`,()=>rr.assign((0,ni._)`${Zi.evaluated}.items`,(0,ni._)`undefined`))}function gi(Zi,rr){const ar=typeof Zi=="object"&&Zi[rr.schemaId];return ar&&(rr.code.source||rr.code.process)?(0,ni._)`/*# sourceURL=${ar} */`:ni.nil}function vi(Zi,rr){if(_i(Zi)&&(Ei(Zi),yi(Zi))){Ai(Zi,rr);return}(0,_t.boolOrEmptySchema)(Zi,rr)}function yi({schema:Zi,self:rr}){if(typeof Zi=="boolean")return!Zi;for(const ar in Zi)if(rr.RULES.all[ar])return!0;return!1}function _i(Zi){return typeof Zi.schema!="boolean"}function Ai(Zi,rr){const{schema:ar,gen:pr,opts:Gi}=Zi;Gi.$comment&&ar.$comment&&Di(Zi),Ii(Zi),Li(Zi);const gr=pr.const("_errs",si.default.errors);Si(Zi,gr),pr.var(rr,(0,ni._)`${gr} === ${si.default.errors}`)}function Ei(Zi){(0,oi.checkUnknownRules)(Zi),wi(Zi)}function Si(Zi,rr){if(Zi.opts.jtd)return Ki(Zi,[],!1,rr);const ar=(0,e.getSchemaTypes)(Zi.schema),pr=(0,e.coerceAndCheckDataType)(Zi,ar);Ki(Zi,ar,!pr,rr)}function wi(Zi){const{schema:rr,errSchemaPath:ar,opts:pr,self:Gi}=Zi;rr.$ref&&pr.ignoreKeywordsWithRef&&(0,oi.schemaHasRulesButRef)(rr,Gi.RULES)&&Gi.logger.warn(`$ref: keywords ignored in schema at path "${ar}"`)}function Oi(Zi){const{schema:rr,opts:ar}=Zi;rr.default!==void 0&&ar.useDefaults&&ar.strictSchema&&(0,oi.checkStrictMode)(Zi,"default is ignored in the schema root")}function Ii(Zi){const rr=Zi.schema[Zi.opts.schemaId];rr&&(Zi.baseId=(0,ai.resolveUrl)(Zi.opts.uriResolver,Zi.baseId,rr))}function Li(Zi){if(Zi.schema.$async&&!Zi.schemaEnv.$async)throw new Error("async schema in sync schema")}function Di({gen:Zi,schemaEnv:rr,schema:ar,errSchemaPath:pr,opts:Gi}){const gr=ar.$comment;if(Gi.$comment===!0)Zi.code((0,ni._)`${si.default.self}.logger.log(${gr})`);else if(typeof Gi.$comment=="function"){const Br=(0,ni.str)`${pr}/$comment`,Nr=Zi.scopeValue("root",{ref:rr.root});Zi.code((0,ni._)`${si.default.self}.opts.$comment(${gr}, ${Br}, ${Nr}.schema)`)}}function Ni(Zi){const{gen:rr,schemaEnv:ar,validateName:pr,ValidationError:Gi,opts:gr}=Zi;ar.$async?rr.if((0,ni._)`${si.default.errors} === 0`,()=>rr.return(si.default.data),()=>rr.throw((0,ni._)`new ${Gi}(${si.default.vErrors})`)):(rr.assign((0,ni._)`${pr}.errors`,si.default.vErrors),gr.unevaluated&&$i(Zi),rr.return((0,ni._)`${si.default.errors} === 0`))}function $i({gen:Zi,evaluated:rr,props:ar,items:pr}){ar instanceof ni.Name&&Zi.assign((0,ni._)`${rr}.props`,ar),pr instanceof ni.Name&&Zi.assign((0,ni._)`${rr}.items`,pr)}function Ki(Zi,rr,ar,pr){const{gen:Gi,schema:gr,data:Br,allErrors:Nr,opts:mr,self:Mr}=Zi,{RULES:Er}=Mr;if(gr.$ref&&(mr.ignoreKeywordsWithRef||!(0,oi.schemaHasRulesButRef)(gr,Er))){Gi.block(()=>Yi(Zi,"$ref",Er.all.$ref.definition));return}mr.jtd||Vi(Zi,rr),Gi.block(()=>{for(const or of Er.rules)Fr(or);Fr(Er.post)});function Fr(or){(0,n.shouldUseGroup)(gr,or)&&(or.type?(Gi.if((0,ei.checkDataType)(or.type,Br,mr.strictNumbers)),er(Zi,or),rr.length===1&&rr[0]===or.type&&ar&&(Gi.else(),(0,ei.reportTypeError)(Zi)),Gi.endIf()):er(Zi,or),Nr||Gi.if((0,ni._)`${si.default.errors} === ${pr||0}`))}}function er(Zi,rr){const{gen:ar,schema:pr,opts:{useDefaults:Gi}}=Zi;Gi&&(0,ti.assignDefaults)(Zi,rr.type),ar.block(()=>{for(const gr of rr.rules)(0,n.shouldUseRule)(pr,gr)&&Yi(Zi,gr.keyword,gr.definition,rr.type)})}function Vi(Zi,rr){Zi.schemaEnv.meta||!Zi.opts.strictTypes||(nr(Zi,rr),Zi.opts.allowUnionTypes||zi(Zi,rr),Wi(Zi,Zi.dataTypes))}function nr(Zi,rr){if(rr.length){if(!Zi.dataTypes.length){Zi.dataTypes=rr;return}rr.forEach(ar=>{ki(Zi.dataTypes,ar)||Mi(Zi,`type "${ar}" not allowed by context "${Zi.dataTypes.join(",")}"`)}),xi(Zi,rr)}}function zi(Zi,rr){rr.length>1&&!(rr.length===2&&rr.includes("null"))&&Mi(Zi,"use allowUnionTypes to allow union type keyword")}function Wi(Zi,rr){const ar=Zi.self.RULES.all;for(const pr in ar){const Gi=ar[pr];if(typeof Gi=="object"&&(0,n.shouldUseRule)(Zi.schema,Gi)){const{type:gr}=Gi.definition;gr.length&&!gr.some(Br=>Ti(rr,Br))&&Mi(Zi,`missing type "${gr.join(",")}" for keyword "${pr}"`)}}}function Ti(Zi,rr){return Zi.includes(rr)||rr==="number"&&Zi.includes("integer")}function ki(Zi,rr){return Zi.includes(rr)||rr==="integer"&&Zi.includes("number")}function xi(Zi,rr){const ar=[];for(const pr of Zi.dataTypes)ki(rr,pr)?ar.push(pr):rr.includes("integer")&&pr==="number"&&ar.push("integer");Zi.dataTypes=ar}function Mi(Zi,rr){const ar=Zi.schemaEnv.baseId+Zi.errSchemaPath;rr+=` at "${ar}" (strictTypes)`,(0,oi.checkStrictMode)(Zi,rr,Zi.opts.strictTypes)}class Ui{constructor(rr,ar,pr){if((0,ii.validateKeywordUsage)(rr,ar,pr),this.gen=rr.gen,this.allErrors=rr.allErrors,this.keyword=pr,this.data=rr.data,this.schema=rr.schema[pr],this.$data=ar.$data&&rr.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,oi.schemaRefOrVal)(rr,this.schema,pr,this.$data),this.schemaType=ar.schemaType,this.parentSchema=rr.schema,this.params={},this.it=rr,this.def=ar,this.$data)this.schemaCode=rr.gen.const("vSchema",ir(this.$data,rr));else if(this.schemaCode=this.schemaValue,!(0,ii.validSchemaType)(this.schema,ar.schemaType,ar.allowUndefined))throw new Error(`${pr} value must be ${JSON.stringify(ar.schemaType)}`);("code"in ar?ar.trackErrors:ar.errors!==!1)&&(this.errsCount=rr.gen.const("_errs",si.default.errors))}result(rr,ar,pr){this.failResult((0,ni.not)(rr),ar,pr)}failResult(rr,ar,pr){this.gen.if(rr),pr?pr():this.error(),ar?(this.gen.else(),ar(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(rr,ar){this.failResult((0,ni.not)(rr),void 0,ar)}fail(rr){if(rr===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if(rr),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(rr){if(!this.$data)return this.fail(rr);const{schemaCode:ar}=this;this.fail((0,ni._)`${ar} !== undefined && (${(0,ni.or)(this.invalid$data(),rr)})`)}error(rr,ar,pr){if(ar){this.setParams(ar),this._error(rr,pr),this.setParams({});return}this._error(rr,pr)}_error(rr,ar){(rr?li.reportExtraError:li.reportError)(this,this.def.error,ar)}$dataError(){(0,li.reportError)(this,this.def.$dataError||li.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,li.resetErrorsCount)(this.gen,this.errsCount)}ok(rr){this.allErrors||this.gen.if(rr)}setParams(rr,ar){ar?Object.assign(this.params,rr):this.params=rr}block$data(rr,ar,pr=ni.nil){this.gen.block(()=>{this.check$data(rr,pr),ar()})}check$data(rr=ni.nil,ar=ni.nil){if(!this.$data)return;const{gen:pr,schemaCode:Gi,schemaType:gr,def:Br}=this;pr.if((0,ni.or)((0,ni._)`${Gi} === undefined`,ar)),rr!==ni.nil&&pr.assign(rr,!0),(gr.length||Br.validateSchema)&&(pr.elseIf(this.invalid$data()),this.$dataError(),rr!==ni.nil&&pr.assign(rr,!1)),pr.else()}invalid$data(){const{gen:rr,schemaCode:ar,schemaType:pr,def:Gi,it:gr}=this;return(0,ni.or)(Br(),Nr());function Br(){if(pr.length){if(!(ar instanceof ni.Name))throw new Error("ajv implementation error");const mr=Array.isArray(pr)?pr:[pr];return(0,ni._)`${(0,ei.checkDataTypes)(mr,ar,gr.opts.strictNumbers,ei.DataType.Wrong)}`}return ni.nil}function Nr(){if(Gi.validateSchema){const mr=rr.scopeValue("validate$data",{ref:Gi.validateSchema});return(0,ni._)`!${mr}(${ar})`}return ni.nil}}subschema(rr,ar){const pr=(0,ri.getSubschema)(this.it,rr);(0,ri.extendSubschemaData)(pr,this.it,rr),(0,ri.extendSubschemaMode)(pr,rr);const Gi={...this.it,...pr,items:void 0,props:void 0};return vi(Gi,ar),Gi}mergeEvaluated(rr,ar){const{it:pr,gen:Gi}=this;pr.opts.unevaluated&&(pr.props!==!0&&rr.props!==void 0&&(pr.props=oi.mergeEvaluated.props(Gi,rr.props,pr.props,ar)),pr.items!==!0&&rr.items!==void 0&&(pr.items=oi.mergeEvaluated.items(Gi,rr.items,pr.items,ar)))}mergeValidEvaluated(rr,ar){const{it:pr,gen:Gi}=this;if(pr.opts.unevaluated&&(pr.props!==!0||pr.items!==!0))return Gi.if(ar,()=>this.mergeEvaluated(rr,ni.Name)),!0}}validate.KeywordCxt=Ui;function Yi(Zi,rr,ar,pr){const Gi=new Ui(Zi,ar,rr);"code"in ar?ar.code(Gi,pr):Gi.$data&&ar.validate?(0,ii.funcKeywordCode)(Gi,ar):"macro"in ar?(0,ii.macroKeywordCode)(Gi,ar):(ar.compile||ar.validate)&&(0,ii.funcKeywordCode)(Gi,ar)}const sr=/^\/(?:[^~]|~0|~1)*$/,cr=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function ir(Zi,{dataLevel:rr,dataNames:ar,dataPathArr:pr}){let Gi,gr;if(Zi==="")return si.default.rootData;if(Zi[0]==="/"){if(!sr.test(Zi))throw new Error(`Invalid JSON-pointer: ${Zi}`);Gi=Zi,gr=si.default.rootData}else{const Mr=cr.exec(Zi);if(!Mr)throw new Error(`Invalid JSON-pointer: ${Zi}`);const Er=+Mr[1];if(Gi=Mr[2],Gi==="#"){if(Er>=rr)throw new Error(mr("property/index",Er));return pr[rr-Er]}if(Er>rr)throw new Error(mr("data",Er));if(gr=ar[rr-Er],!Gi)return gr}let Br=gr;const Nr=Gi.split("/");for(const Mr of Nr)Mr&&(gr=(0,ni._)`${gr}${(0,ni.getProperty)((0,oi.unescapeJsonPointer)(Mr))}`,Br=(0,ni._)`${Br} && ${gr}`);return Br;function mr(Mr,Er){return`Cannot access ${Mr} ${Er} levels up, current level is ${rr}`}}return validate.getData=ir,validate}var hasRequiredCompile;function requireCompile(){if(hasRequiredCompile)return compile;hasRequiredCompile=1,Object.defineProperty(compile,"__esModule",{value:!0}),compile.resolveSchema=compile.getCompilingSchema=compile.resolveRef=compile.compileSchema=compile.SchemaEnv=void 0;const _t=requireCodegen(),e=requireValidation_error(),n=requireNames(),ei=requireResolve(),ti=requireUtil(),ii=requireValidate();class ri{constructor(pi){var gi;this.refs={},this.dynamicAnchors={};let vi;typeof pi.schema=="object"&&(vi=pi.schema),this.schema=pi.schema,this.schemaId=pi.schemaId,this.root=pi.root||this,this.baseId=(gi=pi.baseId)!==null&&gi!==void 0?gi:(0,ei.normalizeId)(vi==null?void 0:vi[pi.schemaId||"$id"]),this.schemaPath=pi.schemaPath,this.localRefs=pi.localRefs,this.meta=pi.meta,this.$async=vi==null?void 0:vi.$async,this.refs={}}}compile.SchemaEnv=ri;function ni(hi){const pi=oi.call(this,hi);if(pi)return pi;const gi=(0,ei.getFullPath)(this.opts.uriResolver,hi.root.baseId),{es5:vi,lines:yi}=this.opts.code,{ownProperties:_i}=this.opts,Ai=new _t.CodeGen(this.scope,{es5:vi,lines:yi,ownProperties:_i});let Ei;hi.$async&&(Ei=Ai.scopeValue("Error",{ref:e.default,code:(0,_t._)`require("ajv/dist/runtime/validation_error").default`}));const Si=Ai.scopeName("validate");hi.validateName=Si;const wi={gen:Ai,allErrors:this.opts.allErrors,data:n.default.data,parentData:n.default.parentData,parentDataProperty:n.default.parentDataProperty,dataNames:[n.default.data],dataPathArr:[_t.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:Ai.scopeValue("schema",this.opts.code.source===!0?{ref:hi.schema,code:(0,_t.stringify)(hi.schema)}:{ref:hi.schema}),validateName:Si,ValidationError:Ei,schema:hi.schema,schemaEnv:hi,rootId:gi,baseId:hi.baseId||gi,schemaPath:_t.nil,errSchemaPath:hi.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,_t._)`""`,opts:this.opts,self:this};let Oi;try{this._compilations.add(hi),(0,ii.validateFunctionCode)(wi),Ai.optimize(this.opts.code.optimize);const Ii=Ai.toString();Oi=`${Ai.scopeRefs(n.default.scope)}return ${Ii}`,this.opts.code.process&&(Oi=this.opts.code.process(Oi,hi));const Di=new Function(`${n.default.self}`,`${n.default.scope}`,Oi)(this,this.scope.get());if(this.scope.value(Si,{ref:Di}),Di.errors=null,Di.schema=hi.schema,Di.schemaEnv=hi,hi.$async&&(Di.$async=!0),this.opts.code.source===!0&&(Di.source={validateName:Si,validateCode:Ii,scopeValues:Ai._values}),this.opts.unevaluated){const{props:Ni,items:$i}=wi;Di.evaluated={props:Ni instanceof _t.Name?void 0:Ni,items:$i instanceof _t.Name?void 0:$i,dynamicProps:Ni instanceof _t.Name,dynamicItems:$i instanceof _t.Name},Di.source&&(Di.source.evaluated=(0,_t.stringify)(Di.evaluated))}return hi.validate=Di,hi}catch(Ii){throw delete hi.validate,delete hi.validateName,Oi&&this.logger.error("Error compiling schema, function code:",Oi),Ii}finally{this._compilations.delete(hi)}}compile.compileSchema=ni;function si(hi,pi,gi){var vi;gi=(0,ei.resolveUrl)(this.opts.uriResolver,pi,gi);const yi=hi.refs[gi];if(yi)return yi;let _i=ci.call(this,hi,gi);if(_i===void 0){const Ai=(vi=hi.localRefs)===null||vi===void 0?void 0:vi[gi],{schemaId:Ei}=this.opts;Ai&&(_i=new ri({schema:Ai,schemaId:Ei,root:hi,baseId:pi}))}if(_i!==void 0)return hi.refs[gi]=ai.call(this,_i)}compile.resolveRef=si;function ai(hi){return(0,ei.inlineRef)(hi.schema,this.opts.inlineRefs)?hi.schema:hi.validate?hi:ni.call(this,hi)}function oi(hi){for(const pi of this._compilations)if(li(pi,hi))return pi}compile.getCompilingSchema=oi;function li(hi,pi){return hi.schema===pi.schema&&hi.root===pi.root&&hi.baseId===pi.baseId}function ci(hi,pi){let gi;for(;typeof(gi=this.refs[pi])=="string";)pi=gi;return gi||this.schemas[pi]||ui.call(this,hi,pi)}function ui(hi,pi){const gi=this.opts.uriResolver.parse(pi),vi=(0,ei._getFullPath)(this.opts.uriResolver,gi);let yi=(0,ei.getFullPath)(this.opts.uriResolver,hi.baseId,void 0);if(Object.keys(hi.schema).length>0&&vi===yi)return fi.call(this,gi,hi);const _i=(0,ei.normalizeId)(vi),Ai=this.refs[_i]||this.schemas[_i];if(typeof Ai=="string"){const Ei=ui.call(this,hi,Ai);return typeof(Ei==null?void 0:Ei.schema)!="object"?void 0:fi.call(this,gi,Ei)}if(typeof(Ai==null?void 0:Ai.schema)=="object"){if(Ai.validate||ni.call(this,Ai),_i===(0,ei.normalizeId)(pi)){const{schema:Ei}=Ai,{schemaId:Si}=this.opts,wi=Ei[Si];return wi&&(yi=(0,ei.resolveUrl)(this.opts.uriResolver,yi,wi)),new ri({schema:Ei,schemaId:Si,root:hi,baseId:yi})}return fi.call(this,gi,Ai)}}compile.resolveSchema=ui;const di=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function fi(hi,{baseId:pi,schema:gi,root:vi}){var yi;if(((yi=hi.fragment)===null||yi===void 0?void 0:yi[0])!=="/")return;for(const Ei of hi.fragment.slice(1).split("/")){if(typeof gi=="boolean")return;const Si=gi[(0,ti.unescapeFragment)(Ei)];if(Si===void 0)return;gi=Si;const wi=typeof gi=="object"&&gi[this.opts.schemaId];!di.has(Ei)&&wi&&(pi=(0,ei.resolveUrl)(this.opts.uriResolver,pi,wi))}let _i;if(typeof gi!="boolean"&&gi.$ref&&!(0,ti.schemaHasRulesButRef)(gi,this.RULES)){const Ei=(0,ei.resolveUrl)(this.opts.uriResolver,pi,gi.$ref);_i=ui.call(this,vi,Ei)}const{schemaId:Ai}=this.opts;if(_i=_i||new ri({schema:gi,schemaId:Ai,root:vi,baseId:pi}),_i.schema!==_i.root.schema)return _i}return compile}var ref_error={},hasRequiredRef_error;function requireRef_error(){if(hasRequiredRef_error)return ref_error;hasRequiredRef_error=1,Object.defineProperty(ref_error,"__esModule",{value:!0});const _t=requireResolve();class e extends Error{constructor(ei,ti,ii,ri){super(ri||`can't resolve reference ${ii} from id ${ti}`),this.missingRef=(0,_t.resolveUrl)(ei,ti,ii),this.missingSchema=(0,_t.normalizeId)((0,_t.getFullPath)(ei,this.missingRef))}}return ref_error.default=e,ref_error}var hasRequiredDiscriminator;function requireDiscriminator(){if(hasRequiredDiscriminator)return discriminator;hasRequiredDiscriminator=1,Object.defineProperty(discriminator,"__esModule",{value:!0});const _t=requireCodegen(),e=requireTypes(),n=requireCompile(),ei=requireRef_error(),ti=requireUtil(),ri={keyword:"discriminator",type:"object",schemaType:"object",error:{message:({params:{discrError:ni,tagName:si}})=>ni===e.DiscrError.Tag?`tag "${si}" must be string`:`value of tag "${si}" must be in oneOf`,params:({params:{discrError:ni,tag:si,tagName:ai}})=>(0,_t._)`{error: ${ni}, tag: ${ai}, tagValue: ${si}}`},code(ni){const{gen:si,data:ai,schema:oi,parentSchema:li,it:ci}=ni,{oneOf:ui}=li;if(!ci.opts.discriminator)throw new Error("discriminator: requires discriminator option");const di=oi.propertyName;if(typeof di!="string")throw new Error("discriminator: requires propertyName");if(oi.mapping)throw new Error("discriminator: mapping is not supported");if(!ui)throw new Error("discriminator: requires oneOf keyword");const fi=si.let("valid",!1),hi=si.const("tag",(0,_t._)`${ai}${(0,_t.getProperty)(di)}`);si.if((0,_t._)`typeof ${hi} == "string"`,()=>pi(),()=>ni.error(!1,{discrError:e.DiscrError.Tag,tag:hi,tagName:di})),ni.ok(fi);function pi(){const yi=vi();si.if(!1);for(const _i in yi)si.elseIf((0,_t._)`${hi} === ${_i}`),si.assign(fi,gi(yi[_i]));si.else(),ni.error(!1,{discrError:e.DiscrError.Mapping,tag:hi,tagName:di}),si.endIf()}function gi(yi){const _i=si.name("valid"),Ai=ni.subschema({keyword:"oneOf",schemaProp:yi},_i);return ni.mergeEvaluated(Ai,_t.Name),_i}function vi(){var yi;const _i={},Ai=Si(li);let Ei=!0;for(let Ii=0;Ii<ui.length;Ii++){let Li=ui[Ii];if(Li!=null&&Li.$ref&&!(0,ti.schemaHasRulesButRef)(Li,ci.self.RULES)){const Ni=Li.$ref;if(Li=n.resolveRef.call(ci.self,ci.schemaEnv.root,ci.baseId,Ni),Li instanceof n.SchemaEnv&&(Li=Li.schema),Li===void 0)throw new ei.default(ci.opts.uriResolver,ci.baseId,Ni)}const Di=(yi=Li==null?void 0:Li.properties)===null||yi===void 0?void 0:yi[di];if(typeof Di!="object")throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${di}"`);Ei=Ei&&(Ai||Si(Li)),wi(Di,Ii)}if(!Ei)throw new Error(`discriminator: "${di}" must be required`);return _i;function Si({required:Ii}){return Array.isArray(Ii)&&Ii.includes(di)}function wi(Ii,Li){if(Ii.const)Oi(Ii.const,Li);else if(Ii.enum)for(const Di of Ii.enum)Oi(Di,Li);else throw new Error(`discriminator: "properties/${di}" must have "const" or "enum"`)}function Oi(Ii,Li){if(typeof Ii!="string"||Ii in _i)throw new Error(`discriminator: "${di}" values must be unique strings`);_i[Ii]=Li}}}};return discriminator.default=ri,discriminator}requireDiscriminator();class ParcelAdvancedSearch extends AbstractAdvancedSearch{constructor(e){e=e||{},e.name=e.name||"Parcelles cadastrales",super(e),this.element.setAttribute("novalidate",""),this.searchService=new IGNSearchService({index:"parcel",limit:1,returnTrueGeometry:!0}),this.searchService.on("search",n=>this.handleSearch(n)),this.searchService.on("error",n=>this.handleError(n))}handleError(e){console.log("error",e),this.dispatchEvent(e)}handleSearch(e){var ei,ti;if(e.nbResults===0){this._showMessage("numero","Aucune parcelle ne correspond  ce numro.");return}const n=e.attr||this.searchService.getResult(0).placeAttributes;delete n.truegeometry,n.infoPopup=`<strong>${n.id}</strong><br/>
            Parcelle n ${n.number.replace(/^0{1,4}/g,"")}<br/>
            Feuille ${n.oldmunicipalitycode}-${n.section}<br/>
            ${n.city}
        `,(ei=e.result)==null||ei.setProperties(n),(ti=e.extent)==null||ti.setProperties(n),this.dispatchEvent(e)}_clearMessages(){this.element.querySelectorAll(".fr-message--error").forEach(e=>e.remove())}_showMessage(e,n,ei){const ti=this.element.querySelector("[name='"+e+"']").parentElement.querySelector(".GPMessagesGroup");if(n){const ii=document.createElement("p");ii.className="fr-message fr-message--"+(ei||"error"),ii.textContent=n,ti.innerHTML="",ti.appendChild(ii)}else ti.innerHTML=""}setSection(){const e=this.prefixInput.value,n=this.sectionInput.value;this.numberList.innerHTML="",this._showMessage("section","chargement en cours","info"),this._fetchCadastre(this.communeId,this.arrondId,e,n).then(ei=>{this._showMessage("section","");const ti=this.sectionInput.value;if(ei&&ei.features&&ei.features[0].properties.section===ti){this.numberInput.focus();const ii=[];ei.features.forEach(ri=>ii.push(ri.properties.numero)),ii.sort().forEach(ri=>{const ni=document.createElement("li");ni.value=ni.textContent=ri.replace(/^0{1,4}/g,""),ni.id=Helper.getUid("GPautoCompleteOption-"),ni.addEventListener("click",()=>{this.numberInput.value=ni.value,this._onSearch(),this.numberInput.blur(),this.numberInput.ariaExpanded="false",this.numberInput.setAttribute("aria-activedescendant","")}),this.numberList.appendChild(ni)}),this.filterListNumber()}})}setFeuille(e){const n=this.feuilles[e];if(this.sectionInput.innerHTML="",n){const ei=document.createElement("option");ei.value="",ei.textContent="Slectionner une section",this.sectionInput.appendChild(ei);let ti="";this.feuilles[e].sort().forEach(ii=>{if(ii!==ti){const ri=document.createElement("option");ri.value=ri.textContent=ii,this.sectionInput.appendChild(ri),ti=ii}}),this.sectionInput.removeAttribute("disabled"),this.sectionInput.focus()}else this.sectionInput.setAttribute("disabled","disabled");this.sectionInput.dispatchEvent(new Event("change"))}setCommune(e="",n=""){if(this.communeId!==e){const ei=this.prefixInput;this.communeId=e,this.arrondId=n,ei.innerHTML="",e?(this._showMessage("commCode","chargement en cours","info"),this._fetchCadastre(e,n).then(ti=>{this._showMessage("commCode",""),this.feuilles={},ti.features.forEach(ri=>{this.feuilles[ri.properties.com_abs]||(this.feuilles[ri.properties.com_abs]=[]),this.feuilles[ri.properties.com_abs].push(ri.properties.section)});let ii="";Object.keys(this.feuilles).sort().forEach(ri=>{if(ri!==ii){const ni=document.createElement("option");ni.value=ni.textContent=ri,ei.appendChild(ni),ii=ri}}),this.setFeuille(ei.value)}),ei.removeAttribute("disabled")):(ei.setAttribute("disabled","disabled"),this.setFeuille())}}_initEvents(e){super._initEvents(e),this.on("expand",di=>{di.expanded&&setTimeout(()=>n.focus(),300)});const n=this.comCodeInput,ei=this.autocompleteList,ti=this.prefixInput,ii=this.sectionInput;let ri="";this.communeId="";let ni=-1,si=-1;const ai=di=>{var fi,hi,pi;ri!==n.value&&this.setCommune(),di!==!1&&(di=ri===n.value),di?(n.setAttribute("aria-expanded","true"),n.setAttribute("aria-activedescendant",((fi=ei.children[ni])==null?void 0:fi.id)||"")):(n.setAttribute("aria-expanded","false"),(hi=ei.children[ni])==null||hi.classList.remove("active"),n.setAttribute("aria-activedescendant",((pi=ei.children[ni])==null?void 0:pi.id)||""),ni=-1)};let oi="";n.addEventListener("keydown",di=>{var hi,pi,gi,vi;di.key==="Tab"&&!di.shiftKey&&n.value&&oi!==n.value&&ti.getAttribute("disabled")==="disabled"&&(di.preventDefault(),n.dispatchEvent(new Event("change"))),oi=n.value;const fi=ei.children;if(fi.length){let yi=ni;switch(di.key){case"Backspace":{yi=-1,n.value.length>5&&(n.value=n.value.slice(0,6));break}case"Escape":{yi=-1;break}case"ArrowDown":{yi++,yi>=fi.length&&(yi=-1),di.preventDefault();break}case"ArrowUp":{yi--,yi<-1&&(yi+=fi.length+1),di.preventDefault();break}case"Enter":{yi>=0&&yi<fi.length&&((hi=fi[ni])==null||hi.classList.remove("active"),fi[yi].click(),yi=-1);break}}ni!==yi&&((pi=fi[ni])==null||pi.classList.remove("active"),ni=yi,(gi=fi[ni])==null||gi.classList.add("active"),ai(["ArrowUp","ArrowDown"].includes(di.key)),(vi=fi[ni])==null||vi.scrollIntoView({block:"nearest"}))}}),n.addEventListener("keyup",di=>{if(["ArrowUp","ArrowDown","Enter","Escape"].includes(di.key)){di.preventDefault();return}ai(di)}),n.addEventListener("focus",ai),n.addEventListener("blur",di=>{di.relatedTarget!==ei&&ai(!1)});function li(di,fi){const hi=`${di.arrond||di.code} ${di.nom}`;return fi&&di.codesPostaux?`${hi}, ${di.codesPostaux.join(", ")} (postal)`:hi}n.addEventListener("change",()=>{if(n.checkValidity())this._clearMessages();else{this._showMessage("commCode","Le code INSEE doit tre compos de 5 caractres (chiffres ou 2A, 2B) ou le code postal de 5 chiffres.");return}this._showMessage("commCode","chargement en cours","info"),this._fetchCommuneData(n.value).then(di=>{this._showMessage("commCode",""),ei.innerHTML="",ri="",di.length===0?(this._showMessage("commCode","Aucune commune ne correspond  ce code INSEE ou code postal."),this.setCommune()):di.length===1?(ri=n.value=li(di[0]),this.setCommune(di[0].code,di[0].arrond)):(di.forEach(fi=>{const hi=fi.codesPostaux?"code INSEE":"code postal",pi=document.createElement("li");pi.className="GPautoCompleteOption",pi.setAttribute("role","option"),pi.id=Helper.getUid("GPautoCompleteOption-"),pi.title=pi.textContent=li(fi,hi),pi.addEventListener("click",()=>{ri=n.value=li(fi),this.setCommune(fi.code,fi.arrond),ai(!1)}),ei.appendChild(pi)}),ri=n.value,this.setCommune(),n.setAttribute("aria-expanded","true"))})}),ti.addEventListener("change",()=>{this.setFeuille(ti.value)});let ci=null,ui=!1;ii.addEventListener("click",()=>{ui=!0}),ii.addEventListener("change",di=>{setTimeout(()=>{clearTimeout(ci),ci=setTimeout(()=>{ii.value?(this.numberInput.removeAttribute("disabled"),this.setSection()):this.numberInput.setAttribute("disabled","disabled")},ui?0:500)}),ui=!1}),this.numberInput.addEventListener("focus",()=>{this.numberInput.ariaExpanded="true"}),this.numberInput.addEventListener("blur",di=>{di.relatedTarget!==this.numberList&&(this.numberInput.ariaExpanded="false")}),this.numberInput.addEventListener("keydown",di=>{if(["ArrowUp","ArrowDown","Enter","Escape"].includes(di.key)){di.preventDefault();return}}),this.numberInput.addEventListener("keyup",di=>{var hi,pi,gi,vi,yi,_i;this.filterListNumber();let fi=si;switch(di.key){case"ArrowDown":{for(let Ai=si+1;Ai<this.numberList.children.length;Ai++)if(this.numberList.children[Ai].style.display!=="none"){fi=Ai;break}fi>=this.numberList.children.length&&(fi=-1),di.preventDefault();break}case"ArrowUp":{for(let Ai=si-1;Ai>=-1;Ai--)if(Ai===-1||this.numberList.children[Ai].style.display!=="none"){fi=Ai;break}fi<-1&&(fi+=this.numberList.children.length+1),di.preventDefault();break}case"Escape":{fi=-1,this.numberInput.ariaExpanded="false";break}case"Enter":{const Ai=((hi=this.numberList.children[fi])==null?void 0:hi.value)||"";Ai&&(this.numberInput.value=Ai,this._onSearch(),this.filterListNumber(),fi=-1,setTimeout(()=>this.numberInput.ariaExpanded="false"));break}default:{fi=-1;break}}si!==fi&&((pi=this.numberList.children[si])==null||pi.classList.remove("active"),si=fi,(gi=this.numberList.children[si])==null||gi.classList.add("active"),this.numberInput.setAttribute("aria-activedescendant",((vi=this.numberList.children[si])==null?void 0:vi.id)||""),this.numberInput.ariaExpanded="true",this.numberInput.setAttribute("aria-activedescendant",((yi=this.numberList.children[si])==null?void 0:yi.id)||""),(_i=this.numberList.children[si])==null||_i.scrollIntoView({block:"nearest"}))})}filterListNumber(){const e=this.numberInput.value.toUpperCase();if(this.currentFilter===e)return;this.currentFilter=e;const n=this.numberList.querySelectorAll("li");let ei=!1;n.forEach(ti=>{ti.textContent.toUpperCase().indexOf(e)>-1?(ti.style.display="",ei=!0):ti.style.display="none"}),ei?(this._showMessage("numero",""),this.numberInput.ariaExpanded="true"):this._showMessage("numero","Aucun numro de parcelle ne correspond  cette saisie.")}initialize(e){super.initialize(e),this.CLASSNAME="ParcelAdvancedSearch",this.insseSearchService=new InseeSearchService}_getLabelContainer(e,n,ei,ti=""){const ii=document.createElement("div");ii.className=n,this.inputs.push(ii);const ri=document.createElement("label");ri.className="fr-label";let ni=e;ti&&(ni=`${e} <span class="fr-hint-text">${ti}</span>`),ri.innerHTML=ni,ii.appendChild(ri),ei&&(ri.setAttribute("for",ei.id),ii.appendChild(ei));const si=document.createElement("div");return si.className="GPMessagesGroup fr-messages-group",ii.appendChild(si),ii}async _fetchCommuneData(e){const n="https://geo.api.gouv.fr/communes",ei=`${n}?code=${e}&format=json&fields=nom,code`,ti=`${n}?codePostal=${e}&format=json&fields=nom,codesPostaux`,ii={headers:{"Content-Type":"application/json"}},ri=[fetch(ei,ii),fetch(ti,ii)];return/^75|^6900|^6938|^1300|^1301|^1320|^1321/.test(e)&&(ri.push(fetch(ei+"&type=arrondissement-municipal",ii)),ri.push(fetch(ti+"&type=arrondissement-municipal",ii))),Promise.all(ri).then(ni=>Promise.all(ni.map(si=>si.json())).then(si=>{if(si[2]&&si[2].length&&si[2].forEach(ai=>{switch(ai.arrond=ai.code,ai.code.slice(0,2)){case"75":{ai.code="75056";break}case"69":{ai.code="69123";break}case"13":{ai.code="13055";break}}}),si[3]&&si[3].length){const ai=si[3][0],oi=ai.codesPostaux[0];if(si[1].length){const li=si[1].filter(ui=>ui.codesPostaux.includes(oi)>=0);si[1]=si[1].filter(ui=>ui.codesPostaux.includes(oi)<0);const ci=li.find(ui=>ui.code!==ai.code);ci&&(ai.arrond=ai.code,ai.code=ci.code)}}return si[0].concat(si[1]).concat(si[2]||[]).concat(si[3]||[])})).catch(ni=>(this._showMessage("commCode","Une erreur est survenue lors de la rcupration des donnes de la commune."),[]))}async _fetchCadastre(e,n,ei,ti){const ii=["97","98"].includes(e.slice(0,2)),ri=e.slice(0,ii?3:2),ni=e.slice(ii?3:2,5),si="https://data.geopf.fr/wfs/ows?",ai={service:"WFS",version:"2.0.0",request:"GetFeature",typename:"CADASTRALPARCELS.PARCELLAIRE_EXPRESS:"+(ti?"parcelle":"feuille"),outputFormat:"application/json",srsName:"CRS:84",count:"1000",propertyName:ti?"com_abs,section,numero":"com_abs,section,code_arr",cql_filter:`code_dep='${ri}' and code_com='${ni}'`+(n?`and code_arr='${n.slice(2)}'`:"")+(ti?` and com_abs='${ei}' and section='${ti}'`:"")},oi=new URLSearchParams(ai).toString(),li=si+oi;this.controller&&this.controller.abort(),this.controller=new AbortController;const ci=await fetch(li,{headers:{"Content-Type":"application/json"},signal:this.controller.signal}).catch(di=>null);return this.controller=null,ci?await ci.json():{}}addInputs(){super.addInputs();const e=document.createElement("legend");e.className="fr-fieldset__legend fr-fieldset__legend--regular",e.id=Helper.getUid("ParcelAdvancedSearch-legend-");const n=document.createElement("span");n.className="fr-hint-text",n.textContent="* Champs obligatoires",e.appendChild(n),this.inputs.push(e);const ei=this.comCodeInput=document.createElement("input");ei.className="fr-input",ei.type="text",ei.name="commCode",ei.pattern="^(\\d\\d|2[A,B,a,b,0-9])\\d{3}$",ei.title="Code postal ou code INSEE",ei.id=Helper.getUid("ParcelAdvancedSearch-comCode-");const ti=this._getLabelContainer("Renseigner un lieu*","fr-input-group",ei,"Code postal ou code INSEE"),ii=this.autocompleteList=document.createElement("ul");ii.className="GPautoCompleteList",ii.id=Helper.getUid("GPautoCompleteList-"),ii.setAttribute("role","listbox"),ii.setAttribute("tabindex","-1"),ii.setAttribute("aria-label","Propositions"),ti.insertBefore(ii,ei.nextSibling),ei.setAttribute("role","combobox"),ei.setAttribute("aria-controls",ii.id),ei.setAttribute("aria-expanded","false"),ei.setAttribute("aria-autocomplete","list"),ei.setAttribute("aria-haspopup","listbox"),ei.setAttribute("autocomplete","off");const ri=this.prefixInput=document.createElement("select");ri.className="fr-select",ri.name="prefix",ri.title="Choisir le prfixe de la parcelle",ri.id=Helper.getUid("ParcelAdvancedSearch-prefix-"),ri.setAttribute("disabled","disabled"),this._getLabelContainer("Prfix","fr-select-group",ri,"");const ni=this.sectionInput=document.createElement("select");ni.className="fr-select",ni.name="section",ni.title="Choisir la section de la parcelle",ni.id=Helper.getUid("ParcelAdvancedSearch-section-"),ni.setAttribute("disabled","disabled"),this._getLabelContainer("Section*","fr-select-group",ni,"");const si=this.numberInput=document.createElement("input");si.className="fr-input",si.type="text",si.pattern="\\d{1,4}",si.maxLength="4",si.name="numero",si.title="Numro de la parcelle",si.autocomplete="off",si.ariaExpanded="false",si.id=Helper.getUid("ParcelAdvancedSearch-number-"),si.setAttribute("disabled","disabled");const ai=this._getLabelContainer("Numro*","fr-input-group",si,""),oi=this.numberList=document.createElement("ul");oi.className="GPautoCompleteList",oi.id=Helper.getUid("GPautoCompleteList-"),oi.setAttribute("role","listbox"),oi.setAttribute("tabindex","-1"),oi.setAttribute("aria-label","Propositions"),ai.insertBefore(oi,si.nextSibling)}_onSearch(e){if(e&&super._onSearch(e),!this.communeId)return;this._clearMessages();const n=this.prefixInput.value,ei=this.sectionInput.value,ti=this.numberInput.value;if(n)if(ei)if(this.numberInput.checkValidity()){if(!ti){this._showMessage("numero","Le numro de parcelle est obligatoire.");return}}else{this._showMessage("numero","Le numro de parcelle doit tre un nombre.");return}else{this._showMessage("section","La section est obligatoire.");return}else return;const ri=(this.arrondId||this.communeId)+"000".slice(n.length)+n+ei+"0000".slice(ti.length)+ti;this.searchService.search({location:ri})}_onErase(e){super._onErase(e),this.setCommune(),this._clearMessages()}}window.ol&&window.ol.control&&(window.ol.control.ParcelAdvancedSearch=ParcelAdvancedSearch);const stringToHTML$3=_t=>{var e=function(){if(!window.DOMParser)return!1;var ii=new DOMParser;try{ii.parseFromString("x","text/html")}catch{return!1}return!0};if(e()){var n=new DOMParser,ei=n.parseFromString(_t,"text/html");return ei.body}var ti=document.createElement("div");return ti.innerHTML=_t,ti};var MousePositionDOM={_addUID:function(_t){var e=this._uid?_t+"-"+this._uid:_t;return e},_createMainContainerElement:function(){var _t=document.createElement("div");return _t.id=this._addUID("GPmousePosition"),_t.className="GPwidget gpf-widget gpf-widget-button gpf-mobile-fullscreen",_t},_createShowMousePositionPictoElement:function(_t){var e=this,n=document.createElement("button"),ei=document.createElement("span");return n.appendChild(ei),n.id=this._addUID("GPshowMousePositionPicto"),n.classList.add("GPshowOpen","GPshowAdvancedToolPicto"),n.classList.add("gpf-btn","gpf-btn--tertiary","gpf-btn-icon","gpf-btn-icon-position"),n.classList.add("fr-btn","fr-btn--tertiary"),n.setAttribute("aria-label","Afficher les coordonnes du curseur"),n.setAttribute("tabindex","0"),n.setAttribute("aria-pressed",!1),n.setAttribute("type","button"),n.addEventListener?n.addEventListener("click",function(ti){var ii=ti.target.ariaPressed==="true";ti.target.setAttribute("aria-pressed",!ii),e.onShowMousePositionClick(ti)}):n.attachEvent&&n.attachEvent("onclick",function(ti){var ii=ti.target.ariaPressed==="true";ti.target.setAttribute("aria-pressed",!ii),e.onShowMousePositionClick(ti)}),n},_createMousePositionPanelElement:function(){var _t=document.createElement("dialog");return _t.id=this._addUID("GPmousePositionPanel"),_t.className="GPpanel gpf-panel fr-modal",_t},_createMousePositionPanelDivElement:function(){var _t=document.createElement("div");return _t.className="gpf-panel__body fr-modal__body",_t},_createMapCenter:function(){var _t=document.createElement("div");return _t.id="GPmapCenter",_t.className="",_t},_createMousePositionPanelTitleElement:function(){var _t=document.createElement("div");return _t.className="GPpanelTitle gpf-panel__title fr-modal__title fr-pt-4w",_t.id=this._addUID("GPmousePositionHeaderTitle"),_t.innerHTML="Coordonnes",_t},_createMousePositionPanelHeaderElement:function(){var _t=document.createElement("div");return _t.className="GPpanelHeader gpf-panel__header fr-modal__header",_t},_createMousePositionPanelCloseElement:function(){var _t=this,e=document.createElement("button");e.id=this._addUID("GPmousePositionPanelClose"),e.className="GPpanelClose gpf-btn gpf-btn-icon-close  fr-btn--close fr-btn fr-btn--tertiary-no-outline fr-m-1w",e.title="Fermer le panneau",e.addEventListener?(e.addEventListener("click",function(){document.getElementById(_t._addUID("GPshowMousePositionPicto")).click()},!1),e.addEventListener("keydown",function(ei){ei.keyCode===13&&document.getElementById(_t._addUID("GPshowMousePositionPicto")).click()},!1)):e.attachEvent&&(e.attachEvent("onclick",function(){document.getElementById(_t._addUID("GPshowMousePositionPicto")).click()}),e.attachEvent("onkeydown",function(ei){ei.keyCode===13&&document.getElementById(_t._addUID("GPshowMousePositionPicto")).click()}));var n=document.createElement("span");return n.className="GPelementHidden gpf-visible",n.innerText="Fermer",e.appendChild(n),e},_createMousePositionPanelBasicElement:function(_t,e,n,ei){_t=typeof _t>"u"?!0:_t,e=typeof e>"u"?!0:e,n=typeof n>"u"?!1:n;var ti=document.createElement("div");return ti.id=this._addUID("GPmousePositionBasicPanel"),ti.classList.add("fr-mx-1w"),ti.appendChild(this._createMousePositionPanelBasicCoordinateElement(e,n,ei)),ti.appendChild(this._createMousePositionPanelEditToolsElement(n)),ti.appendChild(this._createMousePositionPanelBasicAltitudeElement(_t)),ti},_createCoordinateElement:function(_t,e){var n=this;if(["Lon","Lat"].indexOf(_t)===-1)return[];var ei=[],ti=document.createElement("input");ti.id=this._addUID("GPmousePosition"+_t),ti.title=e===!0?"Cliquer pour saisir des coordonnes":"",ti.readOnly=!0,e&&(ti.addEventListener("click",function(){n.onMousePositionEditModeClick(!0)}),ti.addEventListener("change",function(ri){this.classList.remove("error");var ni=n.validateExtentCoordinate(_t,this.value,ri);ni?this.classList.remove("error"):this.classList.add("error")})),ei.push(ti);var ii=document.createElement("span");return ii.className="GPmousePositionUnits",ei.push(ii),ei},_createDMSCoordinateElement:function(_t,e){if(["Lon","Lat"].indexOf(_t)===-1)return[];var n=this,ei=[],ti=document.createElement("input");ti.id=this._addUID("GPmousePosition"+_t+"Degrees"),ti.className="GPSexagesimal",ti.setAttribute("name","degrees"),ti.title=e===!0?"Cliquer pour saisir des coordonnes":"",ti.readOnly=!0,ti.dataset.min=0,ti.dataset.max=_t==="Lon"?180:90,e&&(ti.addEventListener("click",function(){n.onMousePositionEditModeClick(!0)}),ti.addEventListener("change",function(){this.classList.remove("error");var ui=n._checkDMSDegrees(_t,this);ui?this.classList.remove("error"):this.classList.add("error")})),ei.push(ti);var ii=document.createElement("span");ii.className="GPmousePositionSexagesimalLabel",ii.innerHTML="",ei.push(ii);var ri=document.createElement("input");ri.id=this._addUID("GPmousePosition"+_t+"Minutes"),ri.className="GPSexagesimal",ri.setAttribute("name","minutes"),ri.title=e===!0?"Cliquer pour saisir des coordonnes":"",ri.readOnly=!0,ri.dataset.min=0,ri.dataset.max=59,e&&(ri.addEventListener("click",function(){n.onMousePositionEditModeClick(!0)}),ri.addEventListener("change",function(){this.classList.remove("error");var ui=n._checkDMSElement(this);ui?this.classList.remove("error"):this.classList.add("error")})),ei.push(ri);var ni=document.createElement("span");ni.className="GPmousePositionSexagesimalLabel",ni.innerHTML="'",ei.push(ni);var si=document.createElement("input");si.id=this._addUID("GPmousePosition"+_t+"Seconds"),si.className="GPSexagesimalsec",si.setAttribute("name","seconds"),si.title=e===!0?"Cliquer pour saisir des coordonnes":"",si.readOnly=!0,si.dataset.min=0,si.dataset.max=59,e&&(si.addEventListener("click",function(){n.onMousePositionEditModeClick(!0)}),si.addEventListener("change",function(){this.classList.remove("error");var ui=n._checkDMSElement(this,!0);ui?this.classList.remove("error"):this.classList.add("error")})),ei.push(si);var ai=document.createElement("span");ai.className="GPmousePositionSexagesimalLabel",ai.innerHTML="''",ei.push(ai);var oi=document.createElement("select");oi.id=this._addUID("GPmousePosition"+_t+"Direction"),oi.className="GPmousePositionDirection",oi.setAttribute("name","direction"),oi.disabled=!0;var li=document.createElement("option");li.value=_t==="Lon"?"E":"N",li.innerHTML=_t==="Lon"?"E":"N",oi.appendChild(li);var ci=document.createElement("option");return ci.value=_t==="Lon"?"O":"S",ci.innerHTML=_t==="Lon"?"O":"S",oi.appendChild(ci),ei.push(oi),ei},_createMousePositionPanelBasicCoordinateElement:function(_t,e,n){var ei=document.createElement("div");ei.id=this._addUID("GPmousePositionCoordinate"),ei.style.display=_t?"block":"none";var ti=document.createElement("div"),ii=document.createElement("span");ii.className="GPmousePositionLabel",ii.id=this._addUID("GPmousePositionLatLabel"),ii.innerHTML="Latitude : ",ti.appendChild(ii);var ri=document.createElement("span");ri.id=this._addUID("GPmousePositionLatCoordinate");var ni;n==="DMS"?ni=this._createDMSCoordinateElement("Lat",e):ni=this._createCoordinateElement("Lat",e);for(var si=0;si<ni.length;si++)ri.appendChild(ni[si]);ti.appendChild(ri),ei.appendChild(ti);var ai=document.createElement("div"),oi=document.createElement("span");oi.className="GPmousePositionLabel",oi.id=this._addUID("GPmousePositionLonLabel"),oi.innerHTML="Longitude : ",ai.appendChild(oi);var li=document.createElement("span");li.id=this._addUID("GPmousePositionLonCoordinate");var ci;n==="DMS"?ci=this._createDMSCoordinateElement("Lon",e):ci=this._createCoordinateElement("Lon",e);for(var ui=0;ui<ci.length;ui++)li.appendChild(ci[ui]);return ai.appendChild(li),ei.appendChild(ai),ei},_createMousePositionPanelBasicAltitudeElement:function(_t){var e=document.createElement("div");e.id=this._addUID("GPmousePositionAltitude"),e.style.display=_t?"block":"none";var n=document.createElement("span");n.className="GPmousePositionLabel",n.innerHTML="Altitude : ",e.appendChild(n);var ei=document.createElement("span");ei.className="GPmousePositionCoords",ei.id=this._addUID("GPmousePositionAlt"),ei.innerHTML="...",e.appendChild(ei);var ti=document.createElement("span");return ti.className="GPmousePositionAltitudeUnits",ti.innerHTML="m",e.appendChild(ti),e},_createMousePositionPanelEditToolsElement:function(_t){var e=this,n=document.createElement("div");n.className="GPmousePositionPanelEditTools",n.id=this._addUID("GPmousePositionPanelEditTools"),_t||(n.style.display="none");var ei=document.createElement("span");ei.className="GPmousePositionEditTool gpf-btn gpf-btn-icon gpf-btn-icon-mp-edit fr-btn fr-btn--tertiary gpf-btn--tertiary",ei.id=this._addUID("GPmousePositionLocate"),ei.title=_t===!0?"Cliquer pour saisir des coordonnes":"",_t&&ei.addEventListener("click",function(){e.onMousePositionEditModeLocateClick()}),n.appendChild(ei);var ti=document.createElement("span");return ti.className="GPmousePositionEditTool gpf-btn gpf-btn-icon gpf-btn-icon-mp-edit-close fr-btn fr-btn--tertiary gpf-btn--tertiary",ti.id=this._addUID("GPmousePositionCloseEdit"),ti.title="Quitter la saisie des coordonnes",ti.style.display="none",_t&&ti.addEventListener("click",function(){e.onMousePositionEditModeClick(!1)}),n.appendChild(ti),n},_createShowMousePositionSettingsElement:function(_t){var e=this,n=document.createElement("button");return n.id=this._addUID("GPshowMousePositionSettings"),n.className="GPelementHidden GPshowAdvancedToolPicto GPshowMoreOptionsImage GPshowMoreOptions GPshowMousePositionSettingsPicto gpf-hidden gpf-btn fr-btn--sm fr-btn--tertiary gpf-btn--tertiary fr-icon-arrow-down-fill",n.title="Rglages",n.setAttribute("tabindex","0"),n.setAttribute("aria-pressed",!0),n.addEventListener?n.addEventListener("click",function(ei){var ti=ei.target.ariaPressed==="true";ei.target.setAttribute("aria-pressed",!ti),e.onShowMousePositionSettingsClick(ei)}):n.attachEvent&&n.attachEvent("onclick",function(ei){var ti=ei.target.ariaPressed==="true";ei.target.setAttribute("aria-pressed",!ti),e.onShowMousePositionSettingsClick(ei)}),n},_createMousePositionSettingsElement:function(_t){var e=document.createElement("div");e.id=this._addUID("GPmousePositionSettings"),e.style.display=_t===void 0||_t?"block":"none",e.classList.add("fr-m-1w");var n=document.createElement("span");return n.className="GPmousePositionSettingsLabel",e.appendChild(n),e},_createMousePositionSettingsAccordion:function(_t){var e=stringToHTML$3(`
                <section class="fr-accordion">
                               <div class="fr-accordion__title GPmousePositionSettingsLabel">
                                   <button type="button" class="fr-accordion__btn" aria-expanded="false" aria-controls="accordion-more-settings-1">
                                       <span class="GPshowMousePositionAdvancedTools gpf-hidden"></span>Systme de rfrence
                                   </button>
                               </div>
                               <div class="fr-collapse GPelementHidden" id="accordion-more-settings-1">
                               </div>
                    </section>
           `);return _t.map(n=>e.getElementsByClassName("fr-collapse")[0].append(n)),e.getElementsByTagName("button")[0].addEventListener("click",function(n){var ei=n.target.ariaExpanded==="true";n.target.setAttribute("aria-expanded",!ei),ei?(e.getElementsByClassName("fr-collapse")[0].classList.remove("fr-collapse--expanded"),e.getElementsByClassName("fr-collapse")[0].classList.add("GPelementHidden")):(e.getElementsByClassName("fr-collapse")[0].classList.add("fr-collapse--expanded"),e.getElementsByClassName("fr-collapse")[0].classList.remove("GPelementHidden"))}),e},_createMousePositionSettingsSystemsElement:function(_t){var e=this,n=document.createElement("select");n.id=this._addUID("GPmousePositionProjectionSystem"),n.className="GPselect GPmousePositionSettingsSelect gpf-select fr-select fr-my-1w",n.addEventListener("change",function(ri){e.onMousePositionProjectionSystemChange(ri)}),n.addEventListener("mouseover",function(ri){ri.target.nodeName!=="OPTION"&&e.onMousePositionProjectionSystemMouseOver(ri)}),n.title="Type de systme";for(var ei=0;ei<_t.length;ei++){var ti=_t[ei],ii=document.createElement("option");ii.value=ti.code,ii.text=ti.label||ei,n.appendChild(ii)}return n},_createMousePositionSettingsUnitsElement:function(_t){var e=this,n=document.createElement("select");n.id=this._addUID("GPmousePositionProjectionUnits"),n.className="GPselect GPmousePositionSettingsSelect gpf-select fr-select",n.addEventListener("change",function(ri){e.onMousePositionProjectionUnitsChange(ri)}),n.title="Units du systme";for(var ei=0;ei<_t.length;ei++){var ti=_t[ei],ii=document.createElement("option");ii.value=ti.code?ti.code:ei,ii.text=ti.label||ei,n.appendChild(ii)}return n},_resetLabelElements:function(_t){var e=document.getElementById(this._addUID("GPmousePositionLatLabel"));e.innerHTML=_t==="Geographical"?"Latitude :":"X :";var n=document.getElementById(this._addUID("GPmousePositionLonLabel"));n.innerHTML=_t==="Geographical"?"Longitude :":"Y :"},_resetUnitElements:function(_t){var e="";(_t==="M"||_t==="KM")&&(e=_t.toLowerCase());for(var n=document.getElementsByClassName("GPmousePositionUnits"),ei=0;ei<n.length;ei++)n[ei].innerHTML=e},_resetCoordinateElements:function(_t,e,n){for(var ei=document.getElementById(this._addUID("GPmousePositionLatCoordinate"));ei.firstChild;)ei.removeChild(ei.firstChild);var ti;n==="DMS"?ti=this._createDMSCoordinateElement("Lat",_t):ti=this._createCoordinateElement("Lat",_t);for(var ii=0;ii<ti.length;ii++)ei.appendChild(ti[ii]);for(var ri=document.getElementById(this._addUID("GPmousePositionLonCoordinate"));ri.firstChild;)ri.removeChild(ri.firstChild);var ni;n==="DMS"?ni=this._createDMSCoordinateElement("Lon",_t):ni=this._createCoordinateElement("Lon",_t);for(var si=0;si<ni.length;si++)ri.appendChild(ni[si])},_setEditMode:function(_t){var e=document.getElementById(this._addUID("GPmousePositionLocate"));e.title=_t?"Aller  la position ...":"Cliquer pour saisir des coordonnes";var n=document.getElementById(this._addUID("GPmousePositionCloseEdit"));n.style.display=_t?"inline-block":"none",_t===!0?(e.classList.remove("gpf-btn-icon-mp-edit"),e.classList.add("gpf-btn-icon-mp-edit-center"),document.getElementById(this._addUID("GPmousePositionLat")).focus()):(e.classList.remove("gpf-btn-icon-mp-edit-center"),e.classList.add("gpf-btn-icon-mp-edit"));for(var ei="div[id^="+this._addUID("GPmousePositionCoordinate")+"]",ti=document.querySelectorAll(ei+" input"),ii=0;ii<ti.length;ii++)ti[ii].readOnly=!_t,_t&&ti[ii].classList.remove("error");for(var ri=document.querySelectorAll(ei+" select"),ni=0;ni<ri.length;ni++)ri[ni].disabled=!_t},_checkDMSElement:function(_t,e){var n=e!==void 0,ei=_t.value;if(n&&(ei=ei.replace(",",".")),isNaN(ei))return!1;var ti=parseFloat(ei);if(!n&&(ti|0)!==ti)return!1;var ii=Number(_t.dataset.min),ri=Number(_t.dataset.max);return ti>=ii&&ti<=ri},_checkDMSDegrees:function(_t,e){if(isNaN(e.value))return!1;var n=parseFloat(e.value);if((n|0)!==n)return!1;var ei=Number(e.dataset.min),ti=Number(e.dataset.max);if(n<ei||n>ti)return!1;var ii=document.getElementById(this._addUID("GPmousePosition"+_t+"Minutes")),ri=document.getElementById(this._addUID("GPmousePosition"+_t+"Seconds"));return n>=ti?(ii.dataset.max=0,ri.dataset.max=0):(ii.dataset.max=59,ri.dataset.max=59.9999),!0},GPdisplayCoords:function(_t){if(_t){var e=document.getElementById(this._addUID("GPmousePositionLonLabel")),n=document.getElementById(this._addUID("GPmousePositionLatLabel"));if(_t.x||_t.y?(n.innerHTML="X : ",e.innerHTML="Y : "):_t.e||_t.n?(n.innerHTML="E : ",e.innerHTML="N : "):(n.innerHTML="Latitude : ",e.innerHTML="Longitude : "),typeof _t.lat=="object"&&typeof _t.lng=="object"){var ei={lng:"Lon",lat:"Lat"},ti=["Degrees","Minutes","Seconds"];for(var ii in ei)for(var ri=0;ri<ti.length;++ri){var ni="GPmousePosition"+ei[ii]+ti[ri],si=document.getElementById(this._addUID(ni)),ai=ti[ri].charAt(0).toLowerCase();si.value=_t[ii][ai]}document.getElementById(this._addUID("GPmousePositionLonDirection")).value=_t.lng.direction,document.getElementById(this._addUID("GPmousePositionLatDirection")).value=_t.lat.direction}else{var oi=document.getElementById(this._addUID("GPmousePositionLat")),li=document.getElementById(this._addUID("GPmousePositionLon"));oi.value=_t.x||_t.lat||_t.e||"0",li.value=_t.y||_t.lng||_t.lon||_t.n||"0",oi.title="Latitude",li.title="Longitude",oi.type="text",li.type="text";for(var ci=_t.unit===void 0?"":_t.unit,ui=document.getElementsByClassName("GPmousePositionUnits"),di=0;di<ui.length;++di)ui[di].innerHTML=ci}}},GPdisplayElevation:function(_t,e,n,ei){var ti=this,ii;e||(e=500),clearTimeout(ii),document.getElementById(this._addUID("GPmousePositionAlt")).innerHTML="...",n==null&&(n=-99999),ei==null&&(ei=99980);var ri=n+ei,ni=n-ei;_t&&document.getElementById(this._addUID("GPmousePositionAltitude"))&&(ii=setTimeout(function(){ti.onRequestAltitude(_t,function(si){ni<si&&si<ri?ti.GPresetElevation():document.getElementById(ti._addUID("GPmousePositionAlt")).innerHTML=si})},e))},GPresetElevation:function(){document.getElementById(this._addUID("GPmousePositionAltitude"))&&(document.getElementById(this._addUID("GPmousePositionAlt")).innerHTML="---")}},logger$v=LoggerByDefault.getLogger("GeoportalMousePosition");class MousePosition extends ControlExtended{constructor(e){if(e=e||{},super(e),!(this instanceof MousePosition))throw new TypeError("ERROR CLASS_CONSTRUCTOR");return this.CLASSNAME="MousePosition",this._initialize(e),this.container=this._initContainer(this.options),this.element?this.element.appendChild(this.container):this.element=this.container,this}setMap(e){var n=this;if(e){var ei=this._createMapCenter();if(e.getViewport().appendChild(ei),!this.collapsed&&!this._isDesktop&&(ei.className="GPmapCenterVisible"),this.draggable&&Draggable.dragElement(this._panelMousePositionContainer,this._panelHeaderContainer,e.getTargetElement()),this.collapsed||(this._isDesktop?this.listenerKey=e.on("pointermove",ri=>{this.onMouseMove(ri)}):this.listenerKey=e.on("moveend",ri=>this.onMapMove(ri)),this._showMousePositionButton.setAttribute("aria-pressed",!0)),this.options.editCoordinates){var ti=document.createElement("img");ti.id=this._addUID("GPmousePositionMarker"),ti.src=this._markerUrl,ti.title="Cliquer pour supprimer",ti.addEventListener("click",function(){n._markerOverlay.setPosition(void 0)}),this._markerOverlay=new Overlay({offset:this._markerOffset,element:ti,stopEvent:!1}),e.addOverlay(this._markerOverlay)}}else unByKey(this.listenerKey);if(super.setMap(e),e!==null&&(this.options.position&&this.setPosition(this.options.position),this.options.gutter===!1&&this.getContainer().classList.add("gpf-button-no-gutter"),!this.collapsed)){var ii=document.getElementById("GPshowMousePosition-"+this._uid);ii.checked="checked",this._setElevationPanel(this.options.displayAltitude),this._setCoordinatesPanel(this.options.displayCoordinates),this.options.displayCoordinates||this._setSettingsPanel(!1)}}addSystem(e){if(typeof e!="object"){logger$v.log("[ERROR] MousePosition:addSystem - system parameter should be an object");return}if(!e.crs){logger$v.error("crs not defined !");return}if(e.label||(logger$v.warn("crs label not defined, use crs code by default."),e.label=e.crs),e.type||(logger$v.warn("type srs not defined, use 'Metric' by default."),e.type="Metric"),CRS.loadByName(e.crs),!get$3(e.crs)){logger$v.error("crs '{}' not available into proj4 definitions !",e.crs);return}for(var n=0;n<this._projectionSystems.length;n++){var ei=this._projectionSystems[n];e.crs===ei.crs&&logger$v.info("crs '{}' already configured",ei.crs)}e.code=this._projectionSystems.length,this._projectionSystems.push(e);var ti=document.getElementById("GPmousePositionProjectionSystem-"+this._uid);if(ti){var ii=document.createElement("option");ii.value=e.code,ii.text=e.label,ti.appendChild(ii)}}addSystems(e){if(e){if(!Array.isArray(e)){logger$v.log("[ERROR] MousePosition:addSystems - systems parameter should be an array");return}for(var n=0;n<e.length;n++)this.addSystem(e[n])}}removeSystem(e){if(!e||typeof e!="string"){logger$v.log("[ERROR] MousePosition:removeSystem - systemCode parameter should be a string");return}for(var n=document.getElementById("GPmousePositionProjectionSystem-"+this._uid),ei=null,ti=0;ti<this._projectionSystems.length;ti++){var ii=this._projectionSystems[ti];if(e===ii.crs){ei=ii.code,this._projectionSystems.splice(ti,1);break}}if(ei==null){logger$v.log("[WARN] MousePosition:removeSystem - system not found");return}for(var ri=[],ni=0;ni<this._projectionSystems.length;ni++)ri[Number(this._projectionSystems[ni].code)]=ni,this._projectionSystems[ni].code=ni;for(var si=null,ai=0;ai<n.childNodes.length;ai++){if(ei===n.childNodes[ni].value){si=ai;continue}n.childNodes[ni].value=ri[Number(n.childNodes[ni].value)]}si!=null&&n.removeChild(n.childNodes[si]),this._currentProjectionSystems.code===Number(ei)&&(n.childNodes[0].setAttribute("selected","selected"),this._setCurrentSystem(n.childNodes[0].value))}setUnits(e){!e||!Array.isArray(e)||(this.options.units=e,this._projectionUnits=[],this._initProjectionUnits(),this._currentProjectionType&&this._setTypeUnitsPanel(this._currentProjectionType))}setAltitudeOptions(e){if(!(!e||typeof e!="object")&&(this.options.altitude.triggerDelay=e.triggerDelay,this.options.altitude.responseDelay=e.responseDelay,e.serviceOptions))for(var n in e.serviceOptions)e.serviceOptions.hasOwnProperty(n)&&(this.options.altitude.serviceOptions[n]=e.serviceOptions[n])}displayAltitude(e){e!==void 0&&(this.options.displayAltitude=e,this._setElevationPanel(e))}displayCoordinates(e){e!==void 0&&(this.options.displayCoordinates=e,this._setCoordinatesPanel(e),this._setSettingsPanel(e))}setCollapsed(e){if(e===void 0){logger$v.log("[ERROR] MousePosition:setCollapsed - missing collapsed parameter");return}e&&this.collapsed||!e&&!this.collapsed||(this._isDesktop||(document.getElementById("GPmapCenter").className=e?"":"GPmapCenterVisible"),this.onShowMousePositionClick(),this._showMousePositionContainer.checked=!e)}getContainer(){return this.container}_initialize(e){if(e=e||{},this.options=e,this.options.collapsed=e.collapsed!==void 0?e.collapsed:!0,this.collapsed=this.options.collapsed,this.options.draggable=e.draggable!==void 0?e.draggable:!1,this.draggable=this.options.draggable,this._markerOverlay=null,this._markerUrl=null,this._markerOffset=[0,0],this._hideMarker=!1,this._initMarker(e.positionMarker),this.options.units=e.units||[],this.options.displayAltitude=e.displayAltitude!==void 0?e.displayAltitude:!0,this.options.displayCoordinates=e.displayCoordinates!==void 0?e.displayCoordinates:!0,this.options.displayCoordinates?this.options.editCoordinates=e.editCoordinates!==void 0?e.editCoordinates:!1:this.options.editCoordinates=!1,this.editing=!1,this.options.systems=e.systems||[],e.altitude){var n=e.altitude;this.options.altitude={triggerDelay:n.triggerDelay!==void 0?n.triggerDelay:200,responseDelay:n.responseDelay!==void 0?n.responseDelay:500,serviceOptions:n.serviceOptions||{},noDataValue:n.noDataValue!==void 0?n.noDataValue:-99999,noDataValueTolerance:n.noDataValueTolerance!==void 0?n.noDataValueTolerance:9e4}}else this.options.altitude={triggerDelay:200,responseDelay:500,serviceOptions:{}};this._uid=this.options.id||SelectorID.generate(),this._projectionSystems=[],this._initProjectionSystems(),this._projectionUnits={},this._initProjectionUnits(),this._isDesktop=Helper.detectSupport(),this.options.altitude.triggerDelay<100&&(this.options.altitude.triggerDelay=100),this._timer=this.options.altitude.triggerDelay,this._currentProjectionSystems=this._projectionSystems[0],this._currentProjectionType=this._projectionSystems[0].type,this._currentProjectionUnits=this._projectionUnits[this._currentProjectionType][0].code,this._projectionUnitsContainer=null,this._showMousePositionContainer=null,this._panelMousePositionContainer=null,this._panelHeaderMousePositionContainer=null,!this.options.displayAltitude&&!this.options.displayCoordinates&&(this.options.displayCoordinates=!0),this.listenerKey=null}_initMarker(e){if(this.options.editCoordinates){if(!e){this._markerUrl=Marker.lightOrange,this._markerOffset=Marker.defaultOffset;return}this._hideMarker=e.hide!==void 0?e.hide:!1,e.offset?Array.isArray(e.offset)&&e.offset.length===2?this._markerOffset=e.offset:(logger$v.log("positionMarker.offset should be an array. e.g. : [0,0]"),this._markerOffset=Marker.defaultOffset):this._markerOffset=Marker.defaultOffset;var n=e.url;n?n.match(/^[a-zA-Z]+$/)?this._markerUrl=Marker[n]!==void 0?Marker[n]:Marker.lightOrange:this._markerUrl=n:this._markerUrl=Marker.lightOrange}}_initProjectionSystems(){for(var e=[{label:"Gographique",crs:get$3("EPSG:4326").getCode(),type:"Geographical"},{label:"Web Mercator",crs:get$3("EPSG:3857").getCode(),type:"Metric"},{label:"Lambert 93",crs:get$3("EPSG:2154").getCode(),type:"Metric",geoBBox:{left:-9.86,bottom:41.15,right:10.38,top:51.56}},{label:"Lambert II tendu",crs:get$3("EPSG:27572").getCode(),type:"Metric",geoBBox:{left:-4.87,bottom:42.33,right:8.23,top:51.14}}],n=this.options.systems,ei=0;ei<n.length;ei++){var ti=n[ei];this.addSystem(ti)}if(this._projectionSystems.length===0)for(var ii=0;ii<e.length;ii++)this.addSystem(e[ii])}_initProjectionUnits(){var e={Geographical:[{code:"DEC",label:"Degrs dcimaux",format:MathUtils.coordinateToDecimal},{code:"DMS",label:"Degrs sexagsimaux",format:MathUtils.coordinateToDMS},{code:"RAD",label:"Radians",format:MathUtils.coordinateToRad},{code:"GON",label:"Grades",format:MathUtils.coordinateToGon}],Metric:[{code:"M",label:"Mtres",format:MathUtils.coordinateToMeter},{code:"KM",label:"Kilomtres",format:MathUtils.coordinateToKMeter}]},n=this.options.units;for(var ei in e)if(e.hasOwnProperty(ei)){for(var ti=!1,ii=0;ii<e[ei].length;ii++)for(var ri=e[ei][ii],ni=0;ni<n.length;ni++){var si=n[ni];ri.code===si&&(ti=!0,this._projectionUnits[ei]||(this._projectionUnits[ei]=[]),this._projectionUnits[ei].push(ri))}ti||(this._projectionUnits[ei]=e[ei])}typeof this._projectionUnits=="object"&&Object.keys(this._projectionUnits).length===0&&(this._projectionUnits=e)}_getCurrentProjectionInformation(){for(var e=[this._currentProjectionSystems.label,"en"],n=this._projectionUnits[this._currentProjectionType],ei=0;ei<n.length;++ei)if(n[ei].code===this._currentProjectionUnits){e.push(n[ei].label);break}return e.join(" ")}_initContainer(){var e=this._createMainContainerElement(),n=this._showMousePositionButton=this._createShowMousePositionPictoElement();e.appendChild(n);var ei=this._panelMousePositionContainer=this._createMousePositionPanelElement(),ti=this._createMousePositionPanelDivElement();ei.appendChild(ti);var ii=this._panelHeaderContainer=this._createMousePositionPanelHeaderElement(),ri=this._panelTitleContainer=this._createMousePositionPanelTitleElement();ii.appendChild(ri);var ni=this._panelCloseButton=this._createMousePositionPanelCloseElement();ii.appendChild(ni),ti.appendChild(ii);var si=this._createMousePositionPanelBasicElement(this.options.displayAltitude,this.options.displayCoordinates,this.options.editCoordinates,this._currentProjectionUnits);ti.appendChild(si);var ai=this._createShowMousePositionSettingsElement(this.options.displayCoordinates);ti.appendChild(ai);var oi=this._createMousePositionSettingsElement(),li=this._projectionSystemsContainer=this._createMousePositionSettingsSystemsElement(this._projectionSystems),ci=this._projectionUnitsContainer=this._createMousePositionSettingsUnitsElement(this._projectionUnits[this._currentProjectionType]),ui=this._createMousePositionSettingsAccordion([li,ci]);return oi.appendChild(ui),ti.appendChild(oi),e.appendChild(ei),e}_setElevationPanel(e){var n=null;e?(n=document.getElementById("GPmousePositionAltitude-"+this._uid),n.style.display=""):(n=document.getElementById("GPmousePositionAltitude-"+this._uid),n.style.display="none")}_setCoordinatesPanel(e){var n=document.getElementById("GPmousePositionCoordinate-"+this._uid);e?n.style.display="":n.style.display="none"}_setSettingsPanel(e){var n=document.getElementById("GPshowMousePositionSettingsPicto-"+this._uid),ei=document.getElementById("GPmousePositionSettings-"+this._uid);e?(n.style.display="",ei.style.display=""):(n.style.display="none",ei.style.display="none")}_setTypeUnitsPanel(e){for(var n=this._projectionUnitsContainer;n.firstChild;)n.removeChild(n.firstChild);for(var ei=this._projectionUnits[e],ti=0;ti<ei.length;ti++){var ii=ei[ti],ri=document.createElement("option");ri.value=ii.code?ii.code:ti,ri.text=ii.label||ti,n.appendChild(ri)}var ni=this._projectionUnits[e][0].code;(this._currentProjectionUnits==="DMS"||ni==="DMS")&&(this._resetCoordinateElements(this.options.editCoordinates,e,ni),this._setEditMode(this.editing)),this._currentProjectionType=e,this._resetLabelElements(e),this._resetUnitElements(ni),this._currentProjectionUnits=ni}_setCoordinate(e,n){var ei={},ti=this._currentProjectionSystems.crs;if(!ti){logger$v.log("ERROR : system crs not found");return}e=transform$1(e,n,ti);for(var ii=this._currentProjectionSystems.type,ri=null,ni=this._projectionUnits[ii],si=0;si<ni.length;si++)if(ni[si].code===this._currentProjectionUnits){ri=ni[si].format;break}if(!ri||typeof ri!="function"){logger$v.log("WARNING : coordinates format function not found");return}else ei=ri(e);!ei||Object.keys(ei).length===0||this.GPdisplayCoords(ei)}_setElevation(e){var n=this.options.altitude.responseDelay,ei=this.options.altitude.noDataValue,ti=this.options.altitude.noDataValueTolerance;this.GPdisplayElevation(e,n,ei,ti)}onMoveStopped(e,n){var ei=transform$1(e,n,"EPSG:4326");this._setElevation(ei)}onMouseMove(e){var n=this;const ei=e.originalEvent||e;if(!this._panelMousePositionContainer.contains(ei.target)){var ti=e.coordinate;if(!(!e.map||!e.map.getView())){var ii=e.map.getView().getProjection();this._setCoordinate(ti,ii),clearTimeout(this._timer),this._timer=setTimeout(function(){n.onMoveStopped(ti,ii)},this.options.altitude.triggerDelay)}}}onMapMove(){var e=this,n=this.getMap();if(!(!n||!n.getView())){var ei=n.getView(),ti=ei.getCenter(),ii=ei.getProjection();this._setCoordinate(ti,ii),clearTimeout(this._timer),this._timer=setTimeout(function(){e.onMoveStopped(ti,ii)},this.options.altitude.triggerDelay)}}onRequestAltitude(e,n){if(!(!e||Object.keys(e).length===0)&&this.options.displayAltitude){var ei=this.options.altitude.serviceOptions||{},ti=ei.protocol||"XHR",ii=ei.timeOut||0;ti==="JSONP"&&ii===0&&(ii=15e3);var ri=ei.outputFormat||"json",ni=!0,ni;ei.zonly===!1?ni=ei.zonly:ni=!0;var si=ei.measures||!1,ai=[{lon:e[0],lat:e[1]}],oi=ei.resource,li=this,ci=ei.rawResponse||!1,ui=ei.onSuccess||null,di=null,fi=null;ci?di=function(gi){ui&&ui.call(this,gi),logger$v.log("alti service raw response : ",gi)}:di=function(gi){gi&&Object.keys(gi).length&&(ui&&ui.call(this,gi),n.call(this,gi.elevations[0].z))},fi=function(gi){logger$v.log("[getAltitude] ERROR : "+gi.message)};var hi=ei.apiKey||this.options.apiKey;typeof ei.ssl!="boolean"&&(typeof this.options.ssl=="boolean"?ei.ssl=this.options.ssl:ei.ssl=!0);var pi=ei.ssl;Gp.Services.getAltitude({apiKey:hi,protocol:ti,ssl:pi,timeOut:ii,scope:li,outputFormat:ri,rawResponse:ci,onSuccess:di,onFailure:fi,zonly:ni,measures:si,resource:oi,positions:ai})}}onShowMousePositionClick(e){e.target.ariaPressed==="true"&&this.onPanelOpen();var n=this.getMap();Interactions.unset(n);var ei=this._showMousePositionButton.ariaPressed;this.collapsed=ei!=="true",this.dispatchEvent("change:collapsed"),this.options.position&&!this.collapsed&&this.updatePosition(this.options.position),ei==="false"?unByKey(this.listenerKey):this.editing||(this._isDesktop?this.listenerKey=n.on("pointermove",ti=>{this.onMouseMove(ti)}):(this.listenerKey=n.on("moveend",ti=>this.onMapMove(ti)),this.onMapMove())),this._setElevationPanel(this.options.displayAltitude),this._setCoordinatesPanel(this.options.displayCoordinates),this.options.displayCoordinates||this._setSettingsPanel(!1)}onShowMousePositionSettingsClick(e){this.draggable||e.target.ariaPressed}onMousePositionEditModeClick(e){if(this.options.editCoordinates&&this.editing!==e){this.editing=e,this._setEditMode(this.editing);var n=this.getMap();this._isDesktop?this.editing?unByKey(this.listenerKey):(this.listenerKey=n.on("pointermove",ei=>{this.onMouseMove(ei)}),this.onMapMove()):this.editing?unByKey(this.listenerKey):(this.listenerKey=n.on("moveend",ei=>this.onMapMove(ei)),this.onMapMove()),!this.editing&&this._markerOverlay&&this._markerOverlay.setPosition(void 0)}}getCoordinate(e){var n=document.getElementById(this._addUID("GPmousePosition"+e+"Degrees")),ei=n.value;if(!ei||(ei=ei.replace(",","."),!MathUtils.isInteger(ei)))return null;var ti=MathUtils.toInteger(ei);if(ti<Number(n.dataset.min)||ti>Number(n.dataset.max))return null;var ii=document.getElementById(this._addUID("GPmousePosition"+e+"Direction")).value,ri=document.getElementById(this._addUID("GPmousePosition"+e+"Minutes")),ni=ri.value;if(ni&&(ni=ni.replace(",","."),MathUtils.isInteger(ni))){var si=MathUtils.toInteger(ni);si>=Number(ri.dataset.min)&&si<=Number(ri.dataset.max)&&(ti+=si/60)}var ai=document.getElementById(this._addUID("GPmousePosition"+e+"Seconds")),oi=ai.value;if(oi){oi=oi.replace(",",".");var li=MathUtils.toFloat(oi);li&&li>=Number(ai.dataset.min)&&li<=Number(ai.dataset.max)&&(ti+=li/3600)}return(ii==="O"||ii==="S")&&(ti=-ti),ti}locateDMSCoordinates(){var e=[this.getCoordinate("Lon"),this.getCoordinate("Lat")];if(!(e[0]===null||e[1]===null)){var n=this._currentProjectionSystems.crs;if(!n){logger$v.log("ERROR : system crs not found");return}var ei=this.getMap().getView(),ti=transform$1(e,n,ei.getProjection());ei.setCenter(ti),this._markerOverlay&&!this._hideMarker&&this._markerOverlay.setPosition(ti)}}locateCoordinates(){var e=document.getElementById(this._addUID("GPmousePositionLon")).value;if(e=e.replace(",","."),e=MathUtils.toFloat(e),e!==null){var n=document.getElementById(this._addUID("GPmousePositionLat")).value;if(n=n.replace(",","."),n=MathUtils.toFloat(n),n!==null){var ei=this._currentProjectionSystems.crs;if(!ei){logger$v.log("ERROR : system crs not found");return}var ti;this._currentProjectionSystems.type==="Geographical"?ti=[this.convert(e),this.convert(n)]:ti=[this.convert(n),this.convert(e)];var ii=transform$1(ti,this._currentProjectionSystems.crs,"EPSG:4326"),ri=this._currentProjectionSystems.geoBBox;if(ri){var ni=[ri.left,ri.bottom,ri.right,ri.top];if(ii[0]<ni[0]||ii[0]>ni[2]||ii[1]<ni[1]||ii[1]>ni[3])return}var si=this.getMap().getView(),ai=transform$1(ti,ei,si.getProjection());si.setCenter(ai),this._markerOverlay&&!this._hideMarker&&this._markerOverlay.setPosition(ai)}}}onMousePositionEditModeLocateClick(){if(this.options.editCoordinates){if(!this.editing){this.onMousePositionEditModeClick(!0);return}this._currentProjectionUnits==="DMS"?this.locateDMSCoordinates():this.locateCoordinates();var e=this.options.mapCenterCallback;if(typeof e=="function"){var n=this.getMap().getView(),ei=n.getCenter();e.call(this,ei)}}}onMousePositionProjectionSystemChange(e){var n=e.target.selectedIndex,ei=e.target.options[n].value;this._setCurrentSystem(ei)}_setCurrentSystem(e){for(var n=null,ei=0;ei<this._projectionSystems.length;++ei)if(this._projectionSystems[ei].code===Number(e)){n=this._projectionSystems[ei].type;break}if(!n){logger$v.log("system not found in projection systems container");return}this._currentProjectionSystems=this._projectionSystems[Number(e)],n!==this._currentProjectionType&&this._setTypeUnitsPanel(n),this._isDesktop||this.onMapMove()}onMousePositionProjectionSystemMouseOver(e){logger$v.trace(e);var n=this.getMap();if(!(!n||!n.getView())){var ei=n.getView(),ti=ei.getProjection(),ii=ei.calculateExtent(n.getSize());ii=transformExtent(ii,ti,"EPSG:4326");var ri=document.getElementById(this._addUID("GPmousePositionProjectionSystem"));ri.innerHTML="";for(var ni=0;ni<this._projectionSystems.length;ni++){var si=this._projectionSystems[ni],ai=null;if(si.geoBBox&&(ii[0]>si.geoBBox.right||ii[1]>si.geoBBox.top||ii[2]<si.geoBBox.left||ii[3]<si.geoBBox.bottom)){si===this._currentProjectionSystems&&(ai=document.createElement("option"),ai.value=si.code,ai.text=si.label||ni,ai.setAttribute("selected","selected"),ai.setAttribute("disabled","disabled"),ri.appendChild(ai));continue}var oi=document.createElement("option");oi.value=si.code,oi.text=si.label||ni,si===this._currentProjectionSystems&&oi.setAttribute("selected","selected"),ri.appendChild(oi)}}}onMousePositionProjectionUnitsChange(e){var n=e.target.selectedIndex,ei=e.target.options[n].value,ti=this._currentProjectionUnits;this._currentProjectionUnits=ei,this._resetLabelElements(this._currentProjectionType),this._resetUnitElements(this._currentProjectionUnits),(ti==="DMS"||this._currentProjectionUnits==="DMS")&&(this._resetCoordinateElements(this.options.editCoordinates,this._currentProjectionType,this._currentProjectionUnits),this._setEditMode(this.editing)),this._isDesktop||this.onMapMove()}convert(e){var n;if(this._currentProjectionUnits==="M"||this._currentProjectionUnits==="DEC")n=e;else if(this._currentProjectionUnits==="KM")n=e*1e3;else if(this._currentProjectionUnits==="RAD"){var ei=(180/Math.PI).toFixed(20);n=(e*ei).toFixed(20)}else if(this._currentProjectionUnits==="GON"){var ti=.9.toFixed(20);n=(e*ti).toFixed(20)}return n}validateExtentCoordinate(e,n){if(["Lon","Lat"].indexOf(e)===-1)return!1;var ei=n.replace(",",".");if(ei=MathUtils.toFloat(ei),ei===null)return!1;ei=this.convert(ei);var ti=this._currentProjectionSystems.geoBBox;if(ti===void 0)return!0;var ii=[ti.left,ti.bottom,ti.right,ti.top];return ii=transformExtent(ii,"EPSG:4326",this._currentProjectionSystems.crs),!(e==="Lat"&&(ei<ii[0]||ei>ii[2])||e==="Lon"&&(ei<ii[1]||ei>ii[3]))}}Object.assign(MousePosition.prototype,MousePositionDOM);Object.assign(MousePosition.prototype,Widget);window.ol&&window.ol.control&&(window.ol.control.GeoportalMousePosition=MousePosition);var MarkersOther={drawing_api:[{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAAgCAYAAACLmoEDAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH5wUZACIosGP4JQAABapJREFUWMO1mGtsFFUUgL9zZ6bdbaEP2kpRCYj4wlciRMHEHxo0MdHEqDFG/aExvmJiYmJ8G2P0B8YYYozC+oivCAl/VMRqIkTBUIygCAiNlr6oQAttd9vS7bQ7c48/pq0QdtvZFU9yM5nZOfd895xz7zmzQomibwFlgACVCCPUI1QDCcAFAsBHydBDP2ejOEAlyN2l2XRLhaUcyCDUsoQsK4DrgCuBRmAWcALoAfbQyDaUn1nGAZrRUk1KSV59DwhpRLgLuAe4JsZMPwPrsGzA0CuP/M+wugYwCMJFKM+g3IVQEU8ZgCywAeF1LH/ioPJwfPvFpUGA4LEYeBW4DSlCP3JLBXAfSgXCC7i0TS0jhpjYXk0BHjXAE8BtaMn57gK3IzxBjhpdE18xNiyKg3ADcD/glpbtExJF5AGUGwDnjMJqChBqgccRZhVYTDTCk8bks/zvzwIeBWr1vXiwcUNpgCuAqwuCgtKwtIcFtzqU19Ywls5waGPI8d8aUeS0SET3KxAuB34kRu7Gh1VuRCjPDyqWhbcMsGI1VJ1fCRPH/wX3DrHjyX46N9XlBY5O65XAT0RFZEaPxYMVlpAvvxSoXjTIsteGqTp/LvAvbNXiuSx7dZiqRZkCfnOAy9B4HHFhhagy5d9WsxcmmXN5XZ75DHOunEPVecmC8ypz0XjbtZjjJ5H3qQLGcxHJb1CkHPGcghkpFFrIaRL/6ILBAsbA7zvBWLov7+/+QB/+8ZFpfJc5s7CKRWlFCfPCDhxI0JKyaDh8ql44TMtaJd2SLAAbAn8BNg5GvDRQLEIzUdNy6iYTIMgm+H3VXMYz3Vz8UAavqoHc0HEOpMZpSc0nyJYVgM0RNTixYGMltq5BEM4DvkdYlGcxkRg3xKsAcR1sEBJkwQbONFbaEVYCnfLwzOds3JxV4CiwLq8XZGLYwGFsyMEfgPEhZwZQC3xO1PPGamZiV3hNAcqFCJ8Ay+PqTSM7EO6/86PGv347Uo6xEFqD41isiepHhe9zXU8Pk71Ocf1sCg+4HVgNzCuVUpWjA1nz3B3vn7PxSNZ4AbjGYkJrjOPY0BqxAuNJ389eMjjk7204i3meLRoWop70ZeBJwIuvHLnGKnZ7R2LbU183fHVs2PFdo65G6SiR71QRUcCiBChpA/vFaGvRjd4E8EKUtcBNeSv+NLxtfV778011m3YeSmSciYyWU94QUJ24CIAVGLXo98UUBQAmvp26UFYDHcXoDo6azPrds5t3dSfSjkElArFMDYmuIhbEiqgVQRStQLWmaNgJYCXNZuAdou+qGSUXEvzQmty1fvfsDiMgseIhgqqoyBE1prUkWACOESJ8DHzJdEePRlHd31Pe8vb2mt3jgdgYoAIYBR/YY6DJJBKHS//f4BIA0sAbqlwMXJUXQuDYsNOb2lHd3JX2sqe/ogKCTjbwgkU1CxxE5E+gO51MnqjO5YpqZE5leGTSb+zNhawOleGpJydd/RxjX+yb1bzlYLJXmAp/FF7FqAqoBsAI0KmwxXHdzxS+u7mzswU4MT+Tof3gwf/02RcxpaCzz6ltqLKvJD19zAju5KYOlfCntsTOF7+t33pkyPUdE9U6VUVExoERVdKCdomY1hCOqxCM9veHlbW14Di0tbdP2So9DU7y8M7nTAbHfFBfGSyt8PRaI5FjuwbcQx/+Uv3r34Ou7xp1VMkBaRE5BhwVkW7Xcw+j5KwNkFyouA71Cxbwx759+TLqzEjHKo8yx97RUBm+7TnMG/Rl+N3tNU1rm6v3ey5pgaOo/q3QU5FI9I6OjfkiguN5nLt8OZs//XRmx5wpWIDvnp6duLR+9KXaZPjgjs7k1mebGtals6bDiPY7IpnusrKReb5PeVkZB1pbi57/P6fByVKXDPzOtPtmwtX1f/Qm0u3pRL/b0+VXL2xEVbm+r49v+vtLnv8f2Pk64kl5WH4AAAAldEVYdGRhdGU6Y3JlYXRlADIwMjMtMDUtMjVUMDA6Mjg6NTkrMDA6MDAzyLlbAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIzLTA1LTI0VDIzOjAyOjM4KzAwOjAwnw8TLgAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAASUVORK5CYII=",anchor:[.5,1]},{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAAgCAYAAACLmoEDAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH5wUZACIosGP4JQAABm5JREFUWMO1mFtsXFcVhr+195mLx3bshNghKWkNpCglPEBpUYSAKg88gGigUftARSJzkbiIB54QalQkKvGISkGQSkTQplJBKQgQbbmUW6CkTZuGVq0pjV3n4jSOnUzG47HHM545++fhjNs6npDjISzpaDQ6s9f69tr/XnvtMTo0fbYfAhACbN5knJ1ch9QHlseIgAZSHbMyhRsvUj0qvIPeHPbd6Y5iRp3CIkGjy8jUtnJ28mbgg8B7gEGgB5gDpoCXmD92GOxZ3pt/haN1dRrSOuLcvQYitwHpNsTtwE0gj5kAXeLfkGLgKGaPgPslIZ62A7P/X9hk6YMRuB5nX8PYBeoBiy+BbBfHA3OIXyDdh7NRXFP24/nU8VcnA3OG6R047QXtTACsmWaeQBNUAO7E6Ea6B984cYVJLjOXOqvD/aC4D/gSxk7MPFhY1WSx0Bq3E/gizVyf9vSmHp0aloBH3ALcCeZIakEnFkgk8RmCfQTkryqshvshoh/4AtBNu6WTjBAbzUWjUYfmYvJdWrkvDLX8fB58n/b0p4JNp1lhBG0D3k+yWZbDJkCBd95c5H0fz1LoX0u1VOKfv11k/Ln1SNaqFMuR4SaMbYgnSaHddLAmD+wAsm0zigI33lrh09/OMzDUD3QBxvY7Zvjp3lmO/aYX4ZYBmwHkEDswPQVccaOm1KwcaCuJ1i55FWDDlgq79i4yMLSJZHkd0M3A0CZ23bXIhi0V1FbiHtNWTKk4UsKagQ22/X0IMDhU4JobBlhZt41r3j3A4FCB0BbWgW1YSvOVLK1mAfKAtTbHm18Kn4kwy11mnll8RpeRpLX8prK0pUvALO0imjMqF+aols+3HTk/c4HZC3NJtVvhVUhlpFQHQ1rNCvQqEK/04GFiJMuhB+uEUFn2LoQKhx6sc2Yki2tbTptgY8hSwaY9bgNwBNMdYMujmkG9muPR7/RTnZ3glt095HsHWKic59CBOf68fwP1agbXLi9qAs9i6Q6YVMLWcK8hfx3oVxhvZ6UcDAl8pkmuYPjIEzdj6lURN6LW/mlXZ09g9knUPG0PzF0xu+k1GzSFeAQRt5mkMCBuRFTLnkpRVMv+v4KKGHEQaRrSySB1i6jdfeDYAuzD2E47/aY3j/Q0xpd3He0de74S4QLEweF9IDjDgEKtxofPnWNfa1DqFtEeKqPhNSeR7UNch/FWVtHMSK3EGIY0WWy4n9z2zJriVMMGWxyu9cQtv4uC6vmuQu1dA4NszIRVNt/DfRAoYHwd01fBMlz2TBfSG8VeyCRzTaF/lKKnvvHv7sfPL7paZIqUQFqr7VDrWA6IJqLkYMScRld9rdGePjBdC9wLfHTlVeYNyCC5gHmBCZmBjc378W8e7/79c+Wo7F2SLHvTWLCkUtpSf0QwWAjoifT97JIcDpTBwgTSD4Fxlu5ZCEkWZC4WviGyTcgE4aQkc6WGK/1sMvfMsdloxhuyBCTw+mPJp1kAC2YKZphQAal/1bAA9sCcmF74K/AjpPmlbAaZb4pMLKKAnLBkp5hoBGv8pZh5/ueTuVOOtN2AGZLJ7KycG+0IFoCLzZhgD4M9KpliETUhkuRkMsPUWlAk00jFH7//dP6FxWAhBagBTlADXnDwuMvnX+v8f4MtfVDIzlCvf09ia4x9QBKtZC5p2Awxtein9p/JH5lY8AsrOWVLZwqtNh+pCoxh9gowUerqmutrNFZxB7t06g+Xod4QxCO12H4Qi7IlZUnQSimiHlvt11PZI4eKmWnj9eVPlle4pHdXE5gHTgr+5KPoIcHvPnby5MvA3OaZGcbHxjr7k2NZXoZ7GatE/etzujvn9RVnconMZEEW/n4xc/Rbo4UnJ+uu7pcULGFmi8C8RMnQKTM3GsN5Gc2FYjHuXrsWvOfV8fFl2vif7fAn1tr6vG1bn42/3+X5kFlyLTgx70/eM1b4w+FSphglV6MGUDKzaWDSzCZ8FL2GaITQJG7EUuQp9PTw0osvrlzNqwELcPz2deRd+NS6rO7NODaXG1a6/1T+if1nci9nnJUMJpHOCM4V8vmphXq9Zmb4TIa3bd/OHw8cuGKMqwYL8NitA7kb8s27+jL63NOl6G93j/UcnGnYCYeK3mxmIpud31irkctm+dfo6Kr9d14N2thbolA/VbP7rnc6ODIXzZyqZy76M6cX1ly7EUnsuHCBx4rFjv3/B5an/+2QIsMIAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIzLTA1LTI1VDAwOjI4OjU5KzAwOjAwM8i5WwAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMy0wNS0yNFQyMzowMjo1MCswMDowMGqPVM4AAAAZdEVYdFNvZnR3YXJlAHd3dy5pbmtzY2FwZS5vcmeb7jwaAAAAAElFTkSuQmCC",anchor:[.5,1]},{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAAgCAYAAACLmoEDAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH5wUZACIosGP4JQAABPdJREFUWMO9mNtrXFUUh7+1z5nMmdhkkjZpE1RsWi1FqQWL0gp98EUQ7JP+AYJPPigIlvqgiIr4IFqxSFtQ1AqW4oMXUAreK7Zia0vv2Exz6SVNc5u0SZpJZ875+XBOa0oz6UwydcFimNln//a3195nrb3HmKPpxq8GtABZIAB8oAQUgFFgeHoXm+OY/lxhp417P7AOWA+sBtqABcA40A8cBvYAfwInbp7nbTbF3iZ4QfCnQBX4PsHzgiX/C20CaYKVgk8EExWCXvOJpN/KROe2wprgPsGXgmKVoNe8KNgluFdz374VRbVZsGUeoNOBP0j0bgusJ3hKMDZP0Gs+luh5tyOqLYKfawR6zX9IdCuySlOXAx4EHpl1TmvW9LNhg0dzcxP5/Cjffhty8GAb5ffmOmAV8Cu1SmkCX/B22b1qFmrDhkHlcn2SxiWVJI2rs7NPTz45KIhm2btvaf75/gbYOsE3ZQddvnxEhw93SQp1o4U6dKhLy5aNlIGNEt26Spe3EjPiyjTzci5dmmHVqkUz6DlWr15IR0dmFt0lVJjCqgl/ULYllfIxm3lAszSp1GxvfIYKrdLIAlwq2zI0NE4+PzRj28jIEIODE7PojtYaNgI6gXDG1hMnArZvjwjDsRt+D8Mxtm0TJ0+Wi14InEr0a2NJQXhWMFk2Z2azU9q0Kadc7owGBiaVy53Rxo05NTZOzZJnJxPd2hWG5EywTHB61iTv+yU1Npa0cKHU2FiS75duURROCzpqekZIKlhG8KYgrFH1CgVvJLoVWcUzSgRXAJ8Ba2sQg33AM0+3tZ06mE7jIggjh+dFRM4woL5QYH1/P1uTDhWnLouBu4H3gc1A+zxW6sKIc9ufuvPOwT7nFiccLvGQ+IW7KrgymKkvrGhdTHsqqm6vJNGtB14DXgRS1YJGEP0RBHteam39ZsDzCr7kK4a0JCTCTECEKCHyDo6bU2dVNTmJ7hVgK/F963Gq3EpdqVTPlqamIwOe1+yByWyagGI5xa+cYv52QUcofqimKFwHBnqJt0J3NX0vOTe6s6Fh74EgyHsgg8jiJU/c4k+zCCwyU2SGCdUjNVUNmwAL+BH4kDjSt7QilH7JZA7sbGjodhUvhxmSyaxPznXOCTaxEPgU+JpbnEUFHE+nT25pajp01SyqANQAp/h/h8MOvndBcH6+58g88I5gJfBQOYgBz7u4PZvd25tKXbn5GRkYUjIvI0K6AuQw+wc4m89kxrPFYlUHmZumngTtSBE2hzA203MFmPpqwYK9P2UyF+2/fvHyCicZSCVgAugR/OT5/ueC3U/09JwExu8eHaUrl5t/mRPQ43nNrVH0ekZ6zk3L3SGEvwfB/ldaWn7r8/2CF7OaJMzsKjAhkTfUa+Y6QxiUUZocHg7vaG4Gz+N0V9f1seZ9nTBgv3OjOPdRS6m0pl561CWT6PX9Mx9ns3+f8/2CL3mCIpA3swHggpmd9VP+eUQxikpYMRS+R8s993Ds6NGbxqrJ3efhYlHdqdSRy869lw7DDgftl83GdjU0/LUnk7mYigEvIJ0T9GfS6YuTU1OFeLbGXevW8uOOHRUFpma2u6EheGBy8tXmMHx2X5D57eXFrV/knet20rBnNnq2rm6ivVAgXVfHic7OqvVrd6sEFpVKhR7ffzeItPNYOsh3BcGw39tbyLa1IYnHhob4bnh4zvr/AlFvZYTScGjCAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIzLTA1LTI1VDAwOjI4OjU5KzAwOjAwM8i5WwAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMy0wNS0yNFQyMzowMzowMSswMDowMGvaOiAAAAAZdEVYdFNvZnR3YXJlAHd3dy5pbmtzY2FwZS5vcmeb7jwaAAAAAElFTkSuQmCC",anchor:[.5,1]},{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAAgCAYAAACLmoEDAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH5wUZACIosGP4JQAABfxJREFUWMO1mF1sXEcVx39n5u5613btOIlrp0lEhBr6RSmKLUiQIkQFSH0rLSoI8VCE1DSqVKkIAeVDCPECQhChClKXB0qBRKpoQbQNRbSUNIoTKW1NmsZW6vgjNbHXjje79q7Xd33vncPDjYuc7qZ3t+ZIq5V27sz5zZn/mXPuCk2a7vwlZNNgBK5vE/JLm0E6UTIIHhCi+KBFSrk8nTcokYVqGzL85aZ8es3C0tkCI0Xhpq5byVf2AHuBO4BeoB0oAzngNNf1vorTk8z1D9MzqM26lKaiuusJMFEvTu4DvgJ88t2l6q2onAQOoe5pxMzKG/v+v7DafxAiI4jchOi3Qe8DaU04G5QK8DTITxF3DmdVhh5I7L8xGdhQcKkbgR8Dd6PiJd+ugNAKfBXVVlS+h3pj8S6SmUke1QEIUxsQHgbuBm0A9KoACfeAPIwEG7TvYOKJiWFRtSB3AvfH2d4caWziAV9D9E7Arius9g2AkS7gIZD2OpsBpxBEsBLF307j32vyajvwII4u7X8iEWwyzSoGx8eAT9QFBeW27hx7P2TpaNnAYrXIq+9EjFzqRVWQq09CQNiDyO3Av0ig3WSwggH9HEhLHVDHp3dc5ht7YFtHG/HRtnHXzkV+cSLP0clNUAuYFuCzKMeA8P0wkmrWgNxKLX05hW2dC+zvL7Gtowf4H+z2jh7295fY3lHE1QycBT4KmogjGawiKL3UyioFtl6X5caNm2qsZ9i5cSNbO7J1DllAe0ATZWtSGQBkam9EwTMeIrUdirRgxdZNNCSbiCFxZGNbqAMDBb/MYnW+5viiP0/RX0LqBq+4zrDqQEdBo/cMWYGxyxmeHXE4La0Zc1rimRFlrJDF1oBVIpS3UVwSioTlVh3IIHHTsjbJRMAPMzz57x5KK1N84eYibaluloJLPDu8wjMj2/HDNKYGrBAAJ2E9YQVHxCsYpoEPv2fcAKVqmj+c3sGfhsGKJXI34IcQOlsTNLZpVP6JTQabVLOKZQY4VDsKEkc4dJZy1bLgQ3nFEjp7Da06lD8COTRZM5O4wGv/AET6EUR+h7A76bxr2AlU7v/iwm/ffiOcxjiInMFahzOCAK2+z95cjtVWp7F+tm8gBdwDHAC2NEup6MxlV3n03uJv/jrtKqkQPOMwkTPGWhc5I05gJev7lVsWFv03u69nS8o1/FoTAM8Bu4BHgFQjiCA4VXc8mDj3zfJzXXOu/CUP4xkwGMSauMcw8cPOb8mEQ92ZgoGzM5GMNtznad8AwA5UH0f4PNcQZS3csWh+/LvlI8+fCt4pWonvM1nzhMSFRkDjwuYElh36j0aKAgDy+j6AC4geACYambvglouH/aHB14KpgsWoxCCOdz8Sf4s4ECeiTgRRtBXVDQ3DXgFWsoWXgF8BlSRzAo3CV4LR1w77QxMGqVudr/IkqIqKTKsxo03BAtA+F6HyJMpfrn31KKrK2Sg38ljl+NCKhi4BqABGwQdOGzhiMpmLzf9vcOkWWKFAmp8pejPKrtoQwpwrzQ5UTgxeiAqVGm2bgKz2OYrgUK0A5xE5B0wVstlyZxA01MisRXh9H6RQhDcDogMRq33BlSBf8e67oPrn6pnBl4PzswKrxx8fr2JUBVRDYAmYVHjZet7vFV68a3JyBChvLxYZP3/+A731xUx9A0xG813dpuNHWVL7jYi3mtWRanQsGDv1/fLfjk67Rd+KEUBUFRFZAZZUKQh6QcSMRnBJhXA5n4/aurrAWsbGx9do4wPbqTselc3Seftm03awldSnjAgKTIT5iR8u/f3IsWB83sNY4nu6ICJzwIyITFnPu4gSOBcSBZGqZ2ltb+etM2dqCGqdbOLjPyEt9t5uaXssJXbLgvNLv14+fuTx5cGzKfEKAjOo/kch15rJzC5Xq76IYFMptu3ezUtPPfW+PtYNFuDFXd/K3Kabf9Al2a+fCC4c/c7SC4cKrjJhkLwVKU6l00tbfJ+WdJrh0dGG12/+NqhhmzTrT0aFn2esd/itaLYwTiHvXcz5nVt3oKp8Zn6eF/L5ptf/L2sInRchOhqOAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIzLTA1LTI1VDAwOjI4OjU5KzAwOjAwM8i5WwAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMy0wNS0yNFQyMzowNjo0OCswMDowMJwhuk0AAAAZdEVYdFNvZnR3YXJlAHd3dy5pbmtzY2FwZS5vcmeb7jwaAAAAAElFTkSuQmCC",anchor:[.5,1]},{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAAgCAYAAACLmoEDAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH5wUZACIosGP4JQAABmRJREFUWMO1mF2MlFcZx3//887Ozs5O96OwZekupiq0ptJigFhaJaZNa9MbbTVBY5pYY0MlxiZ640XjhfHGxtheGFNFL7AIGmIbEy2Cix8sCSWxSCiyKyy7QGGXhd1hZnc+dnbfec/jxSwI7ADvjvhPJm/yvufj93ycc54zokHt+tYqMnMtOHN0lu7RdGt2KdBuWApTQqIKVgHy3d2F7PhYu7koork0y6d3DTQ0Z6JR2Ltn23m/Y1Crcw88OJ3OPgpsBNYA3UAGKALjwNHx8bv6kT+06r1LA/9+bJk1Oqca6fTnF9fiAtftzW8CvgI8IsAAzQ9p1yDNvzkE7DRnu5zXxSd/8c//L+y+l9bjfSRMDyB9V2ITRjrOKDV2Kwt2yXjVnE74yNvTvzwSe/5FpYESgRT6lQY/AJ4FS6B49tY8rzTG8yZLm9krvmrDV+2IIRe3Yd/m9VhY7QC9jHhWIrHYLJpPlYShL2C87JrUsfeldbH7x4Y1LDDjCeAFoYYX5nwgEoKvSXrCILijsHs3ryMw1wl8k9pKX2iMGeY9vhriwzl8NcS8x2xhlAWYlAG+EeA7+15cHws2pofMefzDwCdvBiqwtg9/fHzpwxuDRLqto1qezk8c7Y8KZwe7zUy6IbcFYHoU00PA34mRu7FgHXKIp4DmeqCAX7rmM5fv3/Qd0l29rdRC29r9yDPTJ3e9lp04un+JGQuAgWaDJ4UdAKq354gh1do9SL38Mk/6nt6plZ/fUkh39S4DrsKmu1Ys++jnthTSXSvymK83dCBYjeJxxGpkmMC6qbP8zYyWJT0trT0rl9QZz2V6V93dsrSnpV7uIoRYdvUkuY1i5qwAUvUtMRQkEvViDCCpWUEQYDdNyZZ4DHE9a2DGVH07xFwxVwzL05P1Poel6cm5Yr50i8Mjf0dhJbzEEBAt+OYCSmPDqdH+t715X7jOSO8L5/vfstLocItcve3UIjM7aVY/oW9UvDQQHuMgtaLlulklEc1VUmf2bFsWlgvnejc+lw9SrV1RpTRxvv/tufMH3loRhZWktNAvZgqBQ8CdgzXkRfQ3cGPARxZ63hGWC8kP+n593+j+30EQBETRvdFcBR9Vg3qg8xrD7K9GEAs27tZlEFww2HkzL0jCR9UgnCkGYXGKcKYY1EDr56oZHmyHwTi3WH03cMRT3+b1eKL7hX4ltCFuv1voXcle+OG7UyeHp6o4D5F3BIHHu9pelq5U2Dg+zhvzHWIXEdsPj/HVtT3TkqaATwF3NUppxoVC6F99pT9/ZLIctXlol9Fupg7nLGNSRtCcqFZJRz6q3tuj1UvbFlk9iRD4A7AW49smmuKGpnaLAG/mB7PhiW3Hip3Ts/5LgUg4cDgUOAMwV2vuK82p6pGuVM7B8QuRhhZ9renbvA7gPsN+BvqsFlnUjhejke0DxT8OXQ7zgZOuGHGdSWbzDwF4wYzH+mLXs1f01NbDeDiL9DpwOn6dD6U5n99/vnLwVC7MOdW8p9qCnf+p9pQ8yEvmJWRYGrOORcMCPL31sCU6W/YJfgqU4/SJvFWPTYbvHThXOS1qu8ftJWEmk8bMuaGGYAHC7kwkbBuy399q6zFqxc7ZQjT4znD5SNWbjwEqwBlUgKMOdrtUarTh60lyYAKfnMvZXPJHGB8zbG09CAH5WX9x70j54KVyVF7YwgS6Yq7VTksrA6eQTgDnci0txfYwjH8Hu1GPbz2MhU0m0/tV43UPBfivj6+UhGHkZw+NzR48NhFevCb8tfAazkxgVgVKwBmDvwSJxHaDPc+cOTMIFFfk84ycOtXYnxzXat/mdVyaiTrbku77TY4tTkqY1S6GZhYdnwz/sWOguP9yxVdcjVRWuzbMASUzcsLOSm4oggkT1ZlsNmrt7IQgYHhk5Loo/c/6+ZfXKJPQQ21J90ZzwGNX0mG8VD3928HS7uOT4WQgAiAEcpIuARcknQsSiVGM0PsqURiZJQLSmQz/OnasbkrdEe14/hM0SV+8q1k/STgtL4e+8KeRmd17Ts8cD5xygguYnTcYT6dSF2dmZyuSCJqa6N2wgX1vvnnbOe4YLMBrz61NLc/Y9zJN+vqJy+H+7cdLOwuhP+0gG0j5c8lkaXmlQnMyycDQ0KLHb3g3qKdMk1UuzUQ/TrrEbz4o+NzFClmNjlZaP9SDmfH45CTvZLMNj/8ffOgG6JpOcn4AAAAldEVYdGRhdGU6Y3JlYXRlADIwMjMtMDUtMjVUMDA6Mjg6NTkrMDA6MDAzyLlbAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIzLTA1LTI0VDIzOjA3OjAwKzAwOjAwxEaR7gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAASUVORK5CYII=",anchor:[.5,1]},{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAAgCAYAAACLmoEDAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH5wUZACIosGP4JQAABZ5JREFUWMO1mF1oXFUQx39z7r3Z3aQx2TYxCVo1aaviJyhqK/TBUgVBRVT6oD4oIiqFgiAoqIjogyIaoYgGFGrFVuuDWloRrWgrxmKrYmtbbZovY76z2e0m2W6ye8/4cLe1obvN3bUOHO7DOTPzP/+ZM2fOFSoUHQaygAVyCB4NKHUIUcAF8ihZIMUUCepQCGbkosp8upWCJQM0IoxxBS6rgNXAtUAzsAiYBkaA36hlD5a9xDlMsgC6ApGKWO0GhGaUdcD9wE3ogtb2AluAbSijsvx/Bqs9gEUQLgOeBtahVJdhJYOyDXgV5U9AZUV4/+WlgUFQlgMvodwNuGXGphp4sPB9ljzdED4tTFms+tQDG1DuRsoGGojgAvcgbMCjXrvL4Sq8EwdYAzxUcFi5BPoPI6wBnHMKtsBqHFhPcNKLLCoxSgNehPI4lnhYdsMyZBCuQbmxaOiDSqBErh8hdqeDE6/HJlPMbPeZ/aUZkBIpswrhapTvCJG74cAqBrgVIVIUKGKpuWOSxe3gLashCG0Nix5Ik3gywcyOJWgRwIG9tcD3QH5hxsKCVa6gVH55bcepf3kKb1kT8C9Yb3kT8Zem8NpSJSw7KFcVyFhQwh4wIbiZigfTuyRG1dVLitgzVF27GLc1VoIEAZoIWe/DpUFgKlp6geciUtyhSATxikdEACVGSAlfuuB4yRl/Yho/OVF8bnICOz5zFiJSYet12Jy1KF0oftH53OEo6Q6L+lPz9fwp0u8oc0dKsecDRwl6twUlbOmyQCdB0zI/pALYTJTUK03Y1ADnPZrCnNeITY+T7pgj3bEUm6kqwV6OoMEJBTZUALQLAVoRvkZoK8E+iOsj1SCug+Z9NAOad87ipQfDWpQ+aVu4zobNWUUYRthSkgUhAGbTDv4k2LSzAFALfIhlhJDNTOhWpHAlXgq8D6wMq3cW+RGHh+57rPnoL39EMBZ8a3AcizXB/VGdzbJ6ZIS3CwqhGxJZBnqMXoQ3gXagpVKUqgxPpkzHvesvGB8aMecXcJjC8AuszylkxmPV2Usbz6fFs2U23wG71cALwJOAF14ZELAW+8PP0T1PvdL4+VjCybpGXQ1ASiGXFBEFLEoeJWngkBjtKqvVk2Wg3WSAtwneW7cRNpUkwNsz4PVt3Fx/YGzCiTsOonJ6y1DYkWphvYDQotDqK1+XcymcAgz0o7Sj9JajezxtUlu313buPxhNOg4qgpUg5IUhwVfEglgRtSKIotWo1pcNtgBYGWMX8BbBO3dByeXJf7s3tn/rjtpeY0BCxUMEVVGRITWmqyKwAEzio2xC+Qw9S+nRIKqHjkaObNxc/+tcTmwIoAIYDf5M/GbgCxONDlb+PFkOKEmE1xQuR7muKAiBsQlntOOjus7+QS9z5hoVEFQLWxMsqhngGCJ/AgPJWGy6Lpcrq5GZj+FygteBcCCXo933mTrJ5Onf7Cyzn361qPObztioyKnwB+FVjKqAah6YAfoUvnFc9wOFL2/v6zsCTC9Npeg5dqyynxzzeOmGvkEn3rjYvhiL6BPG4J481L7F/35fdN9zrzfsHhpzs05wn4mqIiJzwIwqSUH7RUyXD+Mq5E8kEn5NPA6OQ3dPzylf/+2VSlAd9m03KdS827A4f311VG82JiC2f9D9671P6n7+e8TNuq46quSApIiMAcMiMuB67iBKzto8kvMV16Hh4ov5/eDBM3z9Z7AAN9yV097d3oH0lHkj4vmtxtCSnpapj3fW/rTnp9io55EUZBjVvxVGYpHI6InZ2WywW+HCVSvZtXnzwsScC7An5ctNtdErV5x4Pl7nP/Ljr7Hdz7zWuCV53PQa0YQjkhqoqpppyWaJVFVxuKurbPvnhNmTsiSez/YNua9HI7r1965osmcgmnCT/dm6S5pRVW6ZmGBnIlGx/X8AIXpAQWXTlG4AAAAldEVYdGRhdGU6Y3JlYXRlADIwMjMtMDUtMjVUMDA6Mjg6NTkrMDA6MDAzyLlbAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIzLTA1LTI0VDIzOjA3OjE0KzAwOjAw/KO1YwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAASUVORK5CYII=",anchor:[.5,1]},{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAAgCAYAAACLmoEDAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH5wUZACIosGP4JQAABh1JREFUWMO1mH+MXFUVxz/nvje/3s7+mLa72wqNSykIxEKCqKUJf0jQgGJCIGKC/AEaUSEh4R+NGv8wEMUY0xgjTI2J2Go1/EWA7hbBxELcboKh0tItZZfd7a50Z3dmdmZ3Z2dndt67xz9mt7bd2fbNUE/y8jL35d77eed83znnjtCqvfRrcKPgCBS7ha7sFtBOkDioC+KDVFAt0lXKU0wqvgu5Tvjm11ra0m0ZNhqDXFXYHLuJzuztwB3ALcBWIAmUQDPAu8y3vYnRId6+bZg9R7XVLaWlWf1pUN2K8CDIQ8DnEb1oufOZBGAI5SDoixgzw93f+T/DHkqDEUH1U6A/AHkQUS/UMgqIlkFeROQXqJ4Gq9zzeOjtm5SBFdTsBJ4G7kNwQ7+vAIqH8DCqHuiPwX7IhSG4pJnQnANpwHQBTyLch0jzehcBVRflfuBJ1HTV173SsKiDcCfwCB/nwxShHhEeBbkTxbmysAP7wJoU8ARCsvG7aP2ywf+utbHG1EmE72I0xeHnQmGE9ZBB9GbgcxuCCvqZjp7MV3s+6aTcaFehVi2+nJ0M3lnIbkVVkIbavh3YBfyDENoNCasG4YtArBGogL23p29u7w17uNbraAMcoO0bV12/8NT7g/lXZyY2bwAcQ7kLkbcA//IeC+tZuGkV4mJadnid889c99nFa72OXuAc7E6vo/fpnbct7vA6ihs4zgE+jYbjCAsr1CvT+lgq9HntiV3JTZsbrGduad+86RqvI7FBkAWlFw2X/5r5quONh5WIGFeksShFJBYR4zT2rIBoIixAE6mL+cbDQm6lUirUqrlGT+dqlVx2ZXmpYfFQQCmGLQvhYBWLMgIEDVzHcGkuvm/qlA1UF89/FKgupieH9VSpkGiYDYQAkQ8QsWEwwsrAgg6i8hBy0UcmQjnw48+OH+st+tWpb199Y7HDjXQv+LXsvqnhlX1Tw9vLgR9tnLq0BgwhhIINV9gPpQVHr0F5HWTH+j3rcXSNCTwngivi+KpBOajhW+tskGMBxkDuQvwJ7n7ismIIq1kFpoGDqK73ggiI4FvrLNSqztxKhYVa1bkkqKpF9c/1nldCqTZ8i3g4DVavR+SPwO7Q8za2o4g8sv3nL3zgTpzFWAiswXEs1ggCeJUKd2QyPN80LMBrv4sQBPcDexHZ1jKm6rQpLf/wqmd+/3J8finig2ssJrDGOI4NrBErsJKoVMo3zi9Ujnf3sC1im+yeVGuovoKRW4GngEgTc+tysWq99ydO9/zhlZQ7v/h1NcY1YDCIYxRATV12thKL+8e64wUDJ6cDGWn+WHPoOTCmDyUNfAlpLjqRTH6s50D/q4mRySKOc9FhaPVXvTFCVQCswLJFX2+mKNTtK4+DmjOI7kV0vJmpprRc7DzyzmBidKqAMboKYjl3Sf0uYkGsiFoRRFEP1a7mYQG+/JgSLbwB/BYoh5oTBH7bidF/db717/G17HF5E0FVVOSsGjPSGixA8myAygsoL3GpXnS1AY9PZk5t6v/nMfF9GwJUAKNQAd410G/i8Y9aP55kb4aIKWD9X6J6A3Br45IqOMXFma7XhgYjs4XyeoWrgKzVFUWwqJaBUUROA1OFRKLUWas11chcaPc+BjZQ0OP4di92tS9YO8as3mWlVm0fOjHYdnx0BmEt/PXwKkZVQNUHloAJhb87rntA4fA9ExOngNL2YpGx0dEW/+Q43wbSOLm5lG1P/lQjke9hxD2XplQD7+TY2z1/GjjiFhYqGCOAqCoisgIsqVIQ9IyIGQkgq4K/nM8HbakUOA4fjo1doI2PbZH0jwQvuctvb3teY9E9a3KIZPLj3X/9W793ciynjnGAGlAQkVlgWkSmHNf9CKVmrU9QC1RdBy+Z5L0TJ9Yr6krAAkT2/wzruA8EnW2/wXG2mXJlMTUw2J86fPQkrlMAplH9j0LGi8dnlqvViojgRCJcvXs3b+zff9k9rhgsQPuz348vb9/yk8CLf8s7feZI74H+g6ZUHkck74gUp6LRpW2VCrFolOGRkabXbz0bNDC/PVFxZwu/0k9s+UtscrYQny3ka9lMRfv6UFW+kMtxKJ9vef3/AgyZp3iOwsFtAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIzLTA1LTI1VDAwOjI4OjU5KzAwOjAwM8i5WwAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMy0wNS0yNFQyMzowNzozMyswMDowMHshjJAAAAAZdEVYdFNvZnR3YXJlAHd3dy5pbmtzY2FwZS5vcmeb7jwaAAAAAElFTkSuQmCC",anchor:[.5,1]},{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAAgCAYAAACLmoEDAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH5wUZACIosGP4JQAABjBJREFUWMO1mFFsXFcRhr//3F1713biOCVxotiolJiUlpLKtiBFiiqqgpS3tkhFQjwU8QBRpUr0BSHEA+IFVNoIIVQeQ4CAKiVCoUSIFokEKUSENGpCYxJnnUQmteN4u+v12r7ru+cMD+tESbOO727DSFfn4dwz852ZOXPmXtGmDE0NkY/zuODYnGxWMVv8GEavyXJCGaBuZjFQnp+fL/b29prHU8vUOP/x823ZzLQL27vYy9imMe2Y2fFIMVN8AtgN7AS2AD1AFZgG3l23bt3xEMLJmb6Z8/2lfmvXptpZNFwYxsltCRaeB74GfB5raNMqKg07CRw07A2Zrr+z/Z3/L+zoxCg+eEnaIfRd4HmMrrRaDFvEeAP4iUwXAsHODJ1Jbb+lNIhcpGBhO/AjjGcMy0jp9yvUBXzdsC7Dvm91KwCp08K14tW6r28QegnjGURLoLcRZ4SeQ7ykrDaMFEZSL00Na7IIeAp4QVLbB/MmMPANSU8B0X2FHZkYwXnXB7xI46TfvRkzggUSS1i2ZRJLCBawVaIsqQfj2yGEvtHCaCrYVB4yzAWFz2J8rtlhMjMQ9mjno9O787uj9dH6DZVQKR9fOO7HamNbDFOzlBF6QtJjGH8jRe6mgpXJAV9CdDYFhfBk95MfvLzxZQayA900Qtu9p2dP5bXia8VjC8cewLgbuKHvacP+DtTX4kiXs4bDeIQm+RUIDGQH5vZu2Ds/kB3oB27BDmYH+/f27Z0fzA6WA6GZ5gjjM1g6jlQvGSbDttCkLhvGtuy2/PaO7Q800eeGOoY2bstsyzfNXUNAPynrfbo0aIQvt8pGyJDJaJU6JqkzUhQ1hRVg5NMwpPbsisw1hUGUfKla8ZXZZvMVX5kth/LCatcwopz2BkybswFjHMN/eCoiopAUcocrh0OwMH/7XLAwf6hyyArLhXzUpJwa5g27aFgghaQt7gE4QaNpucOqJOIQ5/aX9/fPh/nJZ9c/W+523ZsWwsKNw5XDy4cqhwbjEHc43e0XoQQ4uaJ/TUkVgNHxUXn8J5zcW4iHmjrfjIwyPqcckaLIm/exxdStHt3jWp4wZ09HFl059dCpNets2py1SNEU4uBqXpBE3epRNVSjOT9HNVSjNUCDYb8lMG1YqmYmdScyWhjF4z8l9CuhXWnX3UP+YZG9sPituYu1/9RxAXxwRFEguMZx7Ipjdk9P83qrsAAjl0ayiOeAfcDWtjGNqVAO35t7sXwkmg7ZOmRcwPngXBQFH5yCYDkfx4ufnqvEZzdtZms2tPhZIxLgj8Aw8B0g2wIgCCxYqJ9OLiz9uNqnYviqOTIOHA5FzgDMNd4OcWeufmZTruTgvSmv8ZYb0pX+80HDfin05Vaj46/6icWfVt/0Z5OyIsl0u4KbO7KVQQBBsBSwt1q5FAA4/cnTAFdl2odxuZW1Vgnl5SPxCX8uKRFhiKDGgV151BilAAqSBQkZ1oXZhpZhV4AtP5N/G/gFsJgKtG715GTyr+U348u4W1f4GiJhJpPeN+fG24IF6Pmgx5vZfjP7g9k9So81arC/6MfiA4tnLLGQAlSAM4iBdx0cdbnctbY/T25sv8GyLZc61PEK8LCZDTeFENhsuF77/eKJcM0vNunbBLpZaQ0RMFsELiFdACZL+Xy1N0laamTukNMPnyarrEk6S8I+PPM3PdkYV6zXQm35L7UTyYnkOroV/kZ4DWcmMKsDC8AVg79GmcyvDf6858qVMaA6WC4zcelSez85bpeRwgj+mu9zG90P6WSvnDK3lSlfP5WcWnq1eizMhFiRBMjMkLQMLJhREnZVcuMebpioLxWLvruvD6KIwsTEHbnxkWXnkZ1Srx5zG93r5PiCnBqFcrJ+eelnC0fr/0xmyRABCVCSNANMSZqMMplrGEkIdXzizTIRXT09/PvcuWYZdX/k8WOPo6y+oo36ubLaatUwH/9m6Wjt4NJ7yqoETGH2X4Pprlzu+lKtFksiymYZ2LWLtw8cWNPGfYMFGN4/nLMh+4F69c36meRY/MrCQT8XLksUI6k82dGxsDWO6ezo4Pz4eMv6P9rPig+J9Vns3/evRp2Z3/nxULJJila6FuvBbZgZX5yd5U/FYtv6/weDRwGc3Jre9AAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMy0wNS0yNVQwMDoyODo1OSswMDowMDPIuVsAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjMtMDUtMjRUMjM6MDc6NDkrMDA6MDDVlNrHAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAABJRU5ErkJggg==",anchor:[.5,1]},{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAAgCAYAAACLmoEDAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH5wUZACIosGP4JQAABmJJREFUWMO1l1tsXFcVhr9/7zPjGY/jSy6NXVHVScsttCBVqElBFU0FFYiXqkitVPEQBA8ERBFPqCIUIZAQApSHFgchSEorAuoTUJJSNalTUNNQLs0FO0qcOE6d+D6ecXwbe+bsxcPYpYknyvE0LOloP5yz1/r22v9Ze21Rpz3zxlrcYgULMes2NCk/Prte0AJkDEWCCkbJsOKVcnu+OT1sFfNMqYGnto/XFTOqF1bzC6Q2NKuSn9kyOT53H3A/8DGgHWgCZoAR4ERzeuSvoGP/mr21d2tu0OqOWc+krldzBNEuuUdlPA62FRP2bqfLng2QYXAMtN9CeMF7Rnc+MPv/hX2mO4cHmfFBQ99GPApqvKETq0YybE7wgmQ/DsYZ55zt/NR04virk0GIZfJ3gn4APCxTlGjJqgILNSL7opkaZXzHOzu/tJRE5pJ+2HV4Dbio1aQnEA9LilAC0HcDCwxFZjwCPFGJ1dp1eE3iXCWGNTMv9CCwg+WM1mFVZkWgL2E8iJm/qbBdR3I479pkfF2mplrZNDPMYuKwSBwWiMMiZjFmNXZZgKzJsK+ad217DucSwSbNkDPCRxH31tp3MwNht6z5+Ejnus/6dNTaulgpFgcmXorHZo63m5mklfME92HhbuAICbSbDNbkDD4jaLgOaOhc//nJT97xI1qym3KAB3Lv3/jYldfPPZkfmDi4biWwABqQfdqkvwGVG2YsKaxMW0Ar9GUEWjKbp7Z27ppuyW7aCLwD25LdvPHeTbumW7KbikZY6Ra8obsMJeJIBiuEaKeGBswCzdnbs2tzH1lXw59bl7tr7ZpsZ9Ys1PYMG1GymrKavzpznbQjRVFNUQKSGpwiX0uSSxOySSttosxa9ZmqDeMolfMzC+XiRK33pXJholTOz6rWTlcdF28qrCAI+oB45TvP5OzpTO/w3mAWrjo7zcJ0z9Bem5ztzYqV5dREbOKsiUACSyQDCwTEUeBxXRNVEpV4LvPvt3dvXKhMDW7p2FFM+TUbyvH0eM/QvsXeob23VeL5dK3MCsrAMW4mbEDBQTeEIUybr/0dJMdCuZg+Pvh0Z8/lXyN5bxbfWg5zhFD215OAiSEz92okSwSbVAaG4mGJ/chCLY1JEELZL1SmfKk8yUJlyldBax13gCwIfisXRixhM5O4RezqzoHcBzB+g7Gtvk74KntDnh37v9d89lJ/hAsQB4f3geCqtayxVOL+kRH2rBYWoOtQcwofHgF2Y+qoF9jMhuem3ZP7nmr9U7moVAUiF3BxcM77EAenIFjMlkpzH566Ujq54RY6UmGV/awoI3uR4O4x8S1BKjkgSIYFhYu96TMv/bKpbb7oHvPOIgcOh7wzAHNVWYRSQ6by1oZMwUHPcKy+Veem60gOC64T+IXgoaSnz7IsJ4ei/pf35f586Uyq6L3JrnKwfKWwpUFQLZvzAXslcT+7bF97YJYguwi227ALq5k7P+OKJ7ozRy+fTRWcw0BBEHjnUXWUAihIFiRkWCNmrauGBfjG9hmb0vwhoZ9jzCXJaohV6T+R+ufJ7oYLUrV63NgkzGTSkDnXVxcswIVMHDvTs8AfanfYS5hW3c7RAX/62B8b36pUFBKACnAGJeCEg4Muk7lc9/Vk63Qb026+kFbqJ6APYdxTC0IyZgp+9M0DjUeLo36uRt8mEEvLNUTAbA44h3QGGCxkszMt5XLyO9i19pWHCjQoZZI7GSrstsA02HLQpdGoLGqh5/WGo+ePp0b53/ZXt9dwZgKzCjALDBgc9lH0vMFfPjcwcBqYua1YpP/cufde2ru6mymOubbG5vj7qTQ75SwyU7VMmeKBk6l/vPJs7rUrk77k3NLtywxJi8CsGQVhFyXXF8O4icp8Ph/n2trAe87391+ljfdsu361Vpmm+O5cc9iTzvAJaalMDfsLh5/PHRw4lZ5w3jzVxqUgaQwYljToo+gyRjmECnE5Nos8jU1N/OfUqZWSuhmwAD/8fQtRxBdyLeFpH1lHadZN//3FzME3DzT2uIiCYBizSwYjjZnM6PzCQkkSPpXifdu2cei5524Y46bBAnzzp+sz7beXv5ttCl8e7E2/9vLepv3zM+6CZHkvFQfT6dmOUomGdJrevr5V+6+7GtSyXHMoFcf8z1Jp+93Y26lCYawhz/jFUrazAzNj+8QEB/L5uv3/F2k1+QZ70J2JAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIzLTA1LTI1VDAwOjI4OjU5KzAwOjAwM8i5WwAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMy0wNS0yNFQyMzowODowMiswMDowMKLS20oAAAAZdEVYdFNvZnR3YXJlAHd3dy5pbmtzY2FwZS5vcmeb7jwaAAAAAElFTkSuQmCC",anchor:[.5,1]},{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAAgCAYAAACLmoEDAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH5wUZACIosGP4JQAABdtJREFUWMO1mFuMFFUax3/fqarp7ppLdzMDDCwmzAxegrIka7KLF2JkITFGE5NNfFAeNPuwGh8ML2rcbDYbXMNkszFmH7w8qYmYGB92jcuDwkYwQYzILEFmggODgDANc+menkvX0FXn24dqFJZuprrVf1KpTup85/zP/7uc77TQKv4KmNrvKoJHD0IWSAMuEKIEQIlZpsihGKAT+ENrS7otk3WBACHFejzuAjYDG4FeoAOYAwrAUTo5gOUQ9zLMAbTVJaUlq12A0IvyKMpjCL9JYHUI2I3wPsJFnvu5yQ7WbJRbgeeBRwE/ka0CwgLwPoZBLCewKC8mX77ZMBBgHbAT5RHATbxdARQfYTsWH+WPWE7VtpEITpOq5lFeALYjTRC9lrABbgUcDIf4LQH7kpmbZMO+39gW4Al+TGIKILjAk8AWJLlgyci+DCh5lGeIM/16KGCBCAhrb8uNnNwBPIUlz8vJyCZVyKD8Evh1XdfHyaN3rrqz8PC6h518Kp8rLhZLH45+GB0pHOlFkevs4pC4C2ED8CkJYjcZWcEA24BUPaKC2Idufmj6lS2vMJAbaCcOmfbH1z9e3rFvx9RHJz/qrksYUghbgc9q/lhCsaRkhfV140uhP98/89Lml2YHcgMrge/JrsuvW7lz887Z/lx/qa5ugoNwR02MJZE0wYT4ZLpeG4W12bWZDT0buuvMZzau2LisL9eXaeBkAVaSsN43k9XpRh88x3NFpO6CIpLyjNc445VMUgLNlK6ZRtpMLkzOFYPiZL3P08H05ERlYr6hdkIpab1OStYCo8QF6TqywxPD6Tf++4aNNJq9+lOk0ezrQ6/ryMRIpgGhCPimNv+SSFaQtyIo3cADtYJ+DdmqrbqHC4cz5cXyeF+ubz6yUaowXxgf/GKw/OpXr66euzyXakD2MvAmMMTepUtXMgfsQrD0IXyC0F93jILruJHv+bjiOqGG0UJ1gTAKnRusMlaT4lueX5ps0jBQhHFgN41cJhBGoVMOys50ZZpyUHaWIGpR3iXueRM1M8lbkV2AcgvC28CmxHaN8TnCEzd90PuNeymFsRBZg+NYrInPDz8I2Fwo8FrNIHnXtRfYRpm4KtxDfEFpDcq4qZjBNe+uGUrPeF0WsqJkVSVnjHaoSIdAyg1D/MhG4epfyB09XdJck7cLiJvtPwM7AK8Jglf6Aet/lz6wYt/yf7kLToCoq3E4Sm2AIhK3RUqIUjRwXIyOJlf2irpbqQInUW4HBuqe+PVQG+WVvNM9B5d9liq2CYYuFWkXET9+NH6rtovQAdKF0IPQH8Fcc2R/IDwDTAD3IOSTmprAlPJHs/s6T7VfqPW1KrHmtUfit4iCqIiqiIiiHqoXmyd7hfB9fIuLIb7VLh0OlrBjzD/YfTh/TFQ0mT9EUBUVuaAiXzRz3F6LEhHCWyj/RG9QemqapSdSI8u+yg1JJDYBUQGMQgAcNbDHpNPnW7+erAZmKOLzN4TbUH5Vl4SAM+dczA1lD3oz3kKd3QgIqrWtCRbVBeAkIieAc8VMZi5brTZRuv4fHwMPAB6XiJgHtiGkrsr6OL9DFrtGuv6THe4cE5UriRa7FzEgCBqCVIDzKhx2XfdTa+3xB8+cKZzM5S4vn59n5OzZFv/kuBqD4JScvPXtX9TVpxHcqwhH/tn0lyv29+x359wAE6eVqiIil4F5VYqCnhExoxFMqBBWpqai9nweHIdTY2PXxMaPhvesJ2TYEPrha+rp3T+UKff08gPde/xzmUk16gBVoCgil4BxETnnuO55lKq1IVE1UnUd/I4Ovj52rF5E/TTwXvCwrv1dlIn+gcMqsyiz+SO5Pfkj2eM4FIFxVL9TKPjp9MXK4mIgIjiex5pNm9j7zjtLrvGTkQXofLozXVlW+VOUin7vn8/sX7l/+W5TMacRnXJESufa2uZXBQGptjaGR0ebnr/1alAHYToM3JL7d+3W91KT6WK6nJ6qXjgT6NpeVJX7Jyf599RUy/P/D0pQLH84wUhqAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIzLTA1LTI1VDAwOjI4OjU5KzAwOjAwM8i5WwAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMy0wNS0yNFQyMzowODoxNiswMDowMJo3/8cAAAAZdEVYdFNvZnR3YXJlAHd3dy5pbmtzY2FwZS5vcmeb7jwaAAAAAElFTkSuQmCC",anchor:[.5,1]},{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAAgCAYAAACLmoEDAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH5wUZACIosGP4JQAABapJREFUWMO1mF1sFFUUgL9zZ6bd3ULbBUpBJVTwB1E0UaJg4oNGTUw0MZoYoz5ojKAxMeFFQ4wxBh8wxhB/sWriPyY+GH+RBDT+FhQVFaSBQrtQhRba7ral22l35h4fZosou3R2qSe5mWTm3nu+e+6555w7QrWizwI1gAB1AiOzQBqABOACAeCD5qCnH85QcIA6kNurUulWDUstkBNIL4b8cuAq4BJgDjANOAb0AL/BnG9At8HS3dCm1WqU6qz6ChDOAbkNuAO4IsZU24ANYN8H04us/J9hdT1gBOR80EdAbwNJxRwMkAfeB3kK7B5wFFkRW32FbhAIeOcAa4CbQSoYLwAp4C7QFMij4O6fWEUcMfGt2gp4jcBDEahW6+8ucAvIQ1BojHZrqmFRB+Qa4O5IYXXuHom4wD2g1xCFiCmE1VZA0sCDINPKdCq28IQ28a5k/2nA/UA6OrCTS9ytNMDFwOXlQdHLaOq5iflOmtrGLGO5jzkY/sLROaBy8k4IwHKQJcBXxPDdCmD1OpDaUqAC9kZaBtaxnIXU11GM/ndy7tAqtvZ/SmZmaWBqgWuBb4mSyKQWiwkriynpX8oCGgafZOnwQuqbgeOw51DfvIalwwuoz5UxnANcBBqLIy6sEGWmkqeqhenJJcyYWWI+cwkzZpxNfbL8vNocWX1yqST8JEq/VjyMK0hJhYLUeohT3iWl3EJOkgpCF4PljNOHfyzLWF+prwP4fUfxR04R6nJTDKsWtAM0LAW7m4FEK+02RIdP/BKiwy/Tru1kk2VgQ2AvYONQxHQDtSBtREXLfw6ZkCdIrOXX5hzj3fexKFeP1zRE4Wgru8dbaZ+XJ6gpA1sgKnBiwcZLQ7peQM4GNoMsKNGhuHITpvBwESfAhnkCAqxzCjWdINcCGWTFpHE2rs8qcBjYUNoKAggB1hlizBnAZ4hxZxJQC7xLVPPGKmbiJ3htBfQ8kDeBZbHHlZetIHfPu/n1ve6vhzAWQmtwHIs1ggAp3+eqnh4mSp0K69lWD7gFWAfMrRpT9bAZyK8+89ZXP05k8l4ArrGY0BrjODa0RqzAeNL38xcMDvm/N81mrmcrhoWoJn0cWAV4FQyObGPVpr7r+mb2qk8+co8M+zjG1cgdi+lYFREFLEqAkjXwhxjtqLzOi4BbQF8GrqdMMijH6+3v65z9yMZPkz8czOE68u+Kobgg1eJDAKzAqEU3V5IUIonuTgdA1wFdlQw1udFcwzs72pLbu7O4RhGsRAet2CR6ilgQK6JWBFE0hWpj5bARsEJ2C/Ai0b1qcimEQd2XHT81bNjRFV3j4myICKqiIofUmI7qYAE4EoK8AXzIKUOPgiqJXT3tM577foeMBzYGqABGwQd+M7DRJBJ/ncZ/gwsAssDTqC4CLi0NITi9w72N67e2eZls/uQjHXmtanFlgkU1D+xDZA/QnU0mjzUUChUVMv9hWFk0G79TCNcRTtQFE0aOnuIXxqZ/sLOt7ot9vVHukGgFqqKKURVQDYARIKPwheO6bytsuiGTaQeOzcvl6Ny377RufUWmVpxMX9o21T+hSe8BjLjHT3WgYerb/dtnr/78a/fQkI9jBBBVRUTGgRFVsoIeEDEdIRxVIRjt7w/r0mlwHPZ3dh5XdRpu8I+FzfbVOYPzWjCr7jJNeVdiJApTBwYONr7648/un4O+usZBtQBkReQIcFhEul3P/QulYG2AFELFdZg1fz67du4s4VBTJF7XWmyNc2vYVPc8njPXDPrD6Re+35h+qe0PatwscBjVPxV6UolE7+jYmC8iOJ7HWcuWseWttya3y1TBAkzf9HBi9MJZj4WNyXtTWw983fzwZxvMQL4LI/2OSK67pmZkru9TW1PD7o6Oiuc/fTc4QYKZSd/NZJ/RRe57tbt6s4nObH9hqMfXlhZUlav7+visv7/q+f8Gb188Ax2DNawAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjMtMDUtMjVUMDA6Mjg6NTkrMDA6MDAzyLlbAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIzLTA1LTI0VDIzOjA4OjMyKzAwOjAwLF3cqQAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAASUVORK5CYII=",anchor:[.5,1]},{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAAgCAYAAACLmoEDAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH5wUZACIosGP4JQAABQ5JREFUWMO9mNtvFFUcxz+/M9N2d1HaQgEbNVy8hEiURIIBEx98MTGRhIR/wMQnHzThQXwyPhkfjBcwBg0mKiJiTIiYoCQKEWOoEZWLXCIt2+VWWnrZddvSLTszXx9ma8tll9m2+EtOJrtnzvd85nd+8zu/M8Z0TZr6y4A2oBlIAT4QACWgAAwCkwPMpjWlP23YSchHgLXAU8BK4B7gLmAE6AWOAT8DvwKnroP+X0wC6R6kl5F+RVKC1oH0EtKiG1bljkIa0nKkT5BGE4JOtNHKuOUVnTsKa0gPIX2NVK4TdKKVkb5CehBpesGb0KutSO/PAHQq8JaK3h2B9ZA2IA3PEHSiDVf0vDvh1TakA7MEOtF+qOgmwkiauhzwGPBErUdaBb3rwGuFljwUvoXwzziVVYvNtcCjwE/MWkqTfKQ3q8WqSeE6qb9L6pE0IimQNNIp9Twn9SNFNWL3DaSZ5vvrYBuR9lSb9AFp6JiUlRTqeguPSNll0lAV2Kii25h0eZOYUWM5l0D6UZh/Cz23EuYthXQN3UVUD5PrrB73p6p1NIBvVSY0aGqAWm98moSW1LMA/1TrGICRPAzcqm8IBvphtIZuYbZhI6ATCG/VeQpSH0EUwvDU/0MY/hB0urr3QuBMRX+WLN4QXkAaq5Yzm6XxV6WuLun8FWmsSzr/itQ1VxqvkWfHKrqzuDHENcEypLO1krwvBXOlYJ6kuVLgS8FtNoWzSEuT1ghJw0DAZWBnrSULwCuCNwQUwQtqv1gR8AVxzZtoQ0he9cRb4sPAZ8Ca6S7SFOsAnr9//foz/tGjuAjCyOF5EZEzDMiUSjzV28vWyoDkqcsMpG7gPeBdoH3amNJlNzT00b0bNvSncrmFQczhKi2seP2a4Gp/OlN6eMFC2huiOjw76d0M8DqwEWioGzSKoswvv/y8cOPGPf6VKyU8z1cMWUnVEmYCIkSAyDs4aU6d9e3JsXevAluJz1vPUGcoNWSzudbNm4/7fX2t+L7JbIqAYjkpvsT87YKlofihnk1hEhjOEYdCdz1DXaFQaN6x41D68OE8vi/MIouXvNIsvppFYJGZIjNMKIPUUj9sDCzgR+AD4GqiMeVyMOfAgd+bd+7sxrmEx3EzJJNZj5zrnB5sbCHwKfANt0s9EqkTJ07P27LliF27FiUANcAp/u5wzMF3LpW6NNM6Mg+8hbQceLwahNfX19eydeuhhlzu6s33yOC/g64wosp70YXZ38CFfDo90lwu11XI3PDsRsWjxymX3yUMh295W6k0fvfu3Yfm7N/fh9nEuHh5hZMMpIC42MkJ9nu+/7lg37O53Glg5P5CgWxX1wy/yMTZIfJ6evZGCxZ8KudexLlJzSAI0x0dR1q2bz9j5bLwPANMEmZ2zWBUIg+cc2adIfTLCIr9/eGc1la+X7aMs9nsf3IzP06Y4Q4fLjj4OGhrW6VM5kmci9PUuXPnW7Zt+8O/eLEk3/eQykDezK4Al83sgt/gX0KUoyjAyqHwPdoWL+bEX3/dNNWsnH3Kq1erobv7uCsW3wmbmpbiXLsrFofn7tr1W+bgwT4aG/MGl5EuCnrTTU19Y+PjpYmHvW/tGn7cvv32fpkN2Am7e9++1NiKFa+FLa0vZDoOHVy0adNONzTUjXODnlnhQmPjaHupRFNjI6c6O+vWn8VTJQTz55f8XO5tLU992XTiZD6VzQ6Wi8WSlixBEk8PDLB3cHDa+v8CFsk24crxS5QAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjMtMDUtMjVUMDA6Mjg6NTkrMDA6MDAzyLlbAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIzLTA1LTI0VDIzOjA4OjQ3KzAwOjAwdKD6FwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAASUVORK5CYII=",anchor:[.5,1]},{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAAgCAYAAACLmoEDAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH5wUZACIosGP4JQAABm5JREFUWMO1mFtsXFcVhr9/nzMXj8ceu4mVG1VSFwiq4iIqKClVHygFqQgkRKNAqjyk4gFC+gBPRYI8IISgIKgQjdKXiFKUi6IGVQKiirb0kjakCiJtrk0dO26cxHbsiWdsjz23sxcPdkJIxs3xpGxpdGZ0zt77m3/9a+01I5ocXd99lrJLUnfQPXGnBtr6FxuWk5QGC5HqZpRlVlgzkckfzU1b6Opks5cZ+sUPmtozbBZ2OkjRVaxotD1910Bb/33AA8CngaVAFmMKGAbePd4+84ZDhz6x+sDJ0ye+ZM3uqWYmtXx/D4H5pSbWgx41+DwyhOAqyuwbk+Y2skPALnm3N8JGZrZv+P/CZjfvJgIhrRb2hLD1JjKKsYwBMqYN9prxJI7THqyyLT70gmygyEmB/zjYzxDfAMI4oFdVERnMNkrKGPy4Cn1cE4ubjSDug61bdoKzTqQfgW2UCJtxkSSHbLVQEJodSt27rlw7vC/WXBd3E5MFJnsQbJOkpkD/q7JC4DEHD3ostmCxYLOP78HVw05MWxDZhl/GjMgb1bqnUo+o1j2RN8waR1mQRfpeaOrMPr4zFmxczzocdyPdOx+okH125W3DD/csDzoyyY7CdLWw/9iF6J1zl5eamaRGkbD7TPQArxHDu7FgzZsDvoyRuj76c8r5r9694vIvv/kZuruyrczmQuu3P7dy4onnj+T3H7+waB7glMFDwAGgfnPF4sAKZ+IudGNCeoPurrbi1q/1THZ3ZZcAV2G7u9qWbP16z+Qdi7MF31i3wGCNmWJxxHpIIM2eTDdI481Yuai1Zc3y3KIG67meFR23rVqcbfENvSvJtESmWNm6kDqbbqi6QSJw4TymRFIqESiw+R3ZEhcgZukywIqNcsAJ8lOVqcJ0dazRzPFSZWxsslJy82knCnGrYDxYw2P0AtH1twInTl4spHe8ecZ7b5PX3vPeJne81Wcnh4otQWPaCHgf8HEwYtrAebCDGI9en2SSmK5F6d/+/dSS4kxt8LH77yy0pRNdE+Xq6B/e7KvueKvv9plalHQNXGJQAzskUyzYWAFo3bxHTnaHh5cQ3Q3FNyMRuCiTDAmcgshbNF2tU4t8MI+dMazfyx4KzA2Utm24aZ2Ne9yaR0PALmyekEnUIh8UZ6rB5VKF4kw1+DBQzLyMnc4YJmYzE/uAb92yB8x/EumPGGtvoTWYU5V/Stq0+MDT77vCIM5D5B1B4PFutpfLlMs8MDzM9rk5sZuI2uHnSaxdNyGjCNyPaGue1IZctfTkon/86kiqNNbuIScjZ6YO5yxrUlaQCut1MpGP6stXaM3idi2snzVqGH8B7gH7ISixEC1nOwjzqbHe0x3v7O105YlvmVzoZnsPBc4AzM3awpdT6fqRrvS4gxNDkXoXHMzWLbuR2SqDZ0z6imJa6YopE5OX+nPH9v01mT9bwAUyrl1g7pPZ3EUAXjDjsZdi97NXRmnbBgLvPzDpKeBsnNS48oirThcy594+mLw8MI6czYF4rr40e5U8yEvmJWRYBrOOBcMCFJ/ZaJVc58uCbcim4ySzfFRPX3rvX5lzb5+92m3cfJYwk0kXzbnepmABokwucuJZgxfsQ2kNmZEoXjiV7X3liKK6jwEqwBmUgXcd7Hfp9IWm/zdYNDpIXonxjNV+LbNPgd1Dw1NKhJXiSLbvtYNhaWz6RoubQMw1OobwmE0DZ5BOA4PjLS1TuVot/m+w60f+d+tpsbrJ7Cg+egpscjaX50Q2wwBXr1XS5/99MDXy3sg14Z8Nr+HMBGZ1oAQMGLwShOGfDF58eGDgFDB1e6FA/5kzt1raZ6uDK412+lT7TwmSm00KZYZJyCxKjZ4+nDv659eDcrGMnACZGZKqQMmMcWEfSK43glET9Zl8Pmrt7IQgoK+//3+8ccujfcPPRSrXE6Wy2wmSX7jSS4dTo2dzx1/YnxrtHTO5AKgB45IuAUOSBoMwvIBR875OVIvMwoBMNsvxY8du2OcjgQVo3/Q05oJHfCr7e3PhMledmcyeeXV/tu/VE7hwHBjC7LzBcCadHpmpVMqSCBIJPrZ2LS8/99xN9/jIYAG61v0kXWlftjVKtH4nNdb3eufRfbtUK50F5QOpMJhMlpaVy6SSSU729i54/aarQaMRJbNlVxr7jW9L7E5MXBxPlvP52vmRMitXYWZ8cWyMv+XzTa//H6b399ILDmv5AAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIzLTA1LTI1VDAwOjI4OjU5KzAwOjAwM8i5WwAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMy0wNS0yNFQyMzowOToxMyswMDowMCfNu14AAAAZdEVYdFNvZnR3YXJlAHd3dy5pbmtzY2FwZS5vcmeb7jwaAAAAAElFTkSuQmCC",anchor:[.5,1]},{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAAgCAYAAACLmoEDAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH5wUZACIpx2TIswAABhBJREFUWMO1l0tsXGcVx3//e+94xmPHzsSxPXm4NK/adRKKQISUKjz6QIBKFIQUpMCiwIoFSF3RDQsELCIWCLEosKiggiyyQKWQSFV5pJRHUKpaVbDj2HnUedmOPR57xmOPPfd+h8Wk1JbH9Z1p+kmf7uK795zfd87/nu98otHxkScgbAYLYM4XbdFWsHZQCiNAhIgy2CwtTTmKy0YgaHfwj5cbchk0DLvcCh23xcyOftqiRzGOIB4BskArMI8xAbzFfOXv4J1nb2KIkWVr1KUa+qr/GMhlMR0HToA+gRlohbm1SOcRp/B0GucmGfrDBwy7/yg4T4he4HtgxzGl41kyQAvAabCTOF0GZwzHl4RfF2zXPoH2gn4MHMeURHG3LDASyA5gZIEBQsszM/IBwO4/CngZ4DlMXwcLVqU9Ji/IA/UifHzO0/VwmanhWJ97dbjyMR4HnkHUD7oaOgC+gfQ4ZrEDFu/F/i8DdAA/AXpr5t2sOsMIogicvftarY1JTaAtyDtDV99CnOjGLV0epg8jDtVcNQOwjx3cN/Glz3zcz7S1bM4XSrMvn7sQvTl4JYuZ1snEo2AHwc5Rq340Bmse4imM5JqgmiFwT3/20MxPn/sme3qyLVQz1vK1pz9VePbkC7k//e1CxzrASeBJ0OtAuHHE4sJi/aiGbJyx+4Hs3I++e6K4pyfbDfwfdu8D27p/+J0Txd092VlcjcAZPsYBXDyOmLASKEstsTrHgzu6mw8+9KGOGva8R3of3LJrZ3czztU0DNYNFutvree4Ta23kAj8QKotSknJRODX/pGrpaw5LkA9pWuutkMxnS/O5wvz07WWZ+aK01P5Quk9St3s/YU1c5iNAtGaNd9j6MpY6penX3GRc8WVS5FzxV+cfsUujd5oxq/pKsIYwXDEGPHqbGefgA7E50GrpSNRqYTBG0NXmwvFhfFdO7OlyLnkxHR+/OQLvy/87Ldnts+XFpN4tWBtGfgVaIDp4Q1LV7xjqO+o8LxdwKvA7nWiTxAEUbo5SeB7fhi5aGGxTBhG/voSsGvIniTy3mb4pQ1h42rWEONgp9ZPmQjD0C8US/7MbJFCseS/J2jVzu8wTRDjQIgfWYD9x8DcQ6DfYDrcYCe8kvbfwDM9iyMjgVvAcxA5D99397pQSJfLHJmY4Pl7X8TvuqaGoau3AJoDPYbY1DinjXsWntxZHhpIuaU2B+0y2s202fOs1aRWQTIIQ9KRi8LtO3Rga5vqvdZUMP0R+CjwLJBogNSlXfFy19JYJrDwqwaBBx4e8r1qj+FVZeHKyVQ40JnKezA4Hmm0vuZ76jJ09VUQV4D9wB4M1SOJhCtf31q583rSLQmpzaQWSenqtOrTrEWiFdSG2IrYHcF8fbBQlUN3/xzmpoDHQJm4sJ6Fs5lw6i+bwtk7AEimahTvTVWfkoFMMpMkwxKYTdYPC3D3EuzreZtyk4d0hDhyMAtbo7l/dVQmLgqzeM27hJlMumPSf+o5blePlrkI6dfAS2xUesxIuYVLWyoTAzLnYoAK8AzKwFsenPVSqduNRRag9RBAGeMqZocQ29arhL5VJjsq4682u1L+nYCt2IlAqrbFgHCYlYBBpH8K3syn09PJMIx//1kzJoehsw+Mu2Al0FNIyRUQgJC5pbYo99f2KHdN74JW01u9PCIsBC0Ct028EQTBOefc4BfHxiaubN683FkqcenGjfdf2uk/hh8uZZwf/MDkfbvaO1RBMYvSUfFC1/KN1wKrlKm2kTIzJC0DJTPywsYkbzSCKRPhYi4XtWQy4PtcvXZtlTbe90js/ZxI+AdDgucN75PvpDnhytc7l26dTbvCtCEfqAB5SXeBcUk3/SC4jVFxLiSqRGaBT7q1lf9evLjGz32BBUj0fwHn+ErkNf0ctM2zsJipTJ7NVCYHkZcHxjG7ZTCRTqUmF5eWypLwEwl2Hj7Mn198cUMf9w0WYNPDn04tkv5+RPCtdDT/Wnfl5inPwutAzpdmbzY1lbaVyySbmhgaHa3b/n2Fbe57AnO2peI3b2+v5PJZG89Vbtwq244ePGBfsciZXK5h+/8DFYWTIIiuQPwAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjMtMDUtMjVUMDA6Mjg6NTkrMDA6MDAzyLlbAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIzLTA1LTI0VDIzOjA5OjIzKzAwOjAwqUK8vQAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAASUVORK5CYII=",anchor:[.5,1]},{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAAgCAYAAACLmoEDAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH5wUZACIpx2TIswAABilJREFUWMO1mF9sXEcVh78zd9fetZ04TkmcKDYqJSalpaSyLUiRooqqIOWtLVKREA9FPEBUqRJ9QQjxgHgBlTZCCJXHECCgSolQKBGiRSJBSiNCGjWhMYljJ5FJ7Tje7np3bd/duzM/HtZFCazju9twpNU83J0z3znzmzN/jA5tZGSWfD7GucDWrYkVCtmPgPoly5mRARqSYqBUqVQK/f398h5qtQwXL360ozEzncL29y8zMbHFdu2af6hQyDwG7AV2A9uAPqAKzAHvbNiw4WQI4fT8/MDFwcGiOh3TOuk0OjqFc7YtBD0LfAX4LAgwbA2PEqeBwxKvmenm22/v/P/Cjo9P430wM9tlxreBZ0E9ad1ILINeA35kpkshoHPnRlKP35YMoshZCNoJ/AD0lETGLH28ZvQAX5Xokfiu1JiiOSWpzLWT1UbDbzLjBdBTYG2B3oacMeMZsBfMspvGxqZS90wNK1kEPAE8Z2YdL8wPgIGvmdkTQHRPYcfGpnHODwDP01zpLYIRIYgkEfV6sw1BaI1JNrM+0DdDCAPj4+mymypDEi4E+zToM60WkyTA9PDD3XN79+ajjRujTeVyKJ08ueQnJmrbJKyVZMx4zMweAf2FFNpNBWsmB3wBrLs1KOHxx3vff/HFzQwNZXtpTm3vvn195VdeKRROnFi6D9QC2LqBJyX+CjTW40ipWTnQQ7TQVwgwNJRd3L9/U2VoKDsI/Ad2eDg7uH//QGV4OFsKoaXjCPSppv/1LdWfJExiGy00IMGOHdn8zp1d97Xw50ZGujbv2JHJt9auDBgkZaFOKQMDyK0RCJkMGVujjplZdxRZ1BrWAOXTMKTO7KottoaBYtFXy2W/0Op7uewXSqWwtHZJtlLaHTCtZgNoEuT/+0sUwdRUkjt6tBxCUOX2byGocuRIWVNT9XzUoppKeInLEoEUlra4B+AUzUPLHcOaGXEccgcPlgYrlTDz9NMbS729bsvSUrh19Gi5fuRIeTiOQ5dzLUtXApxe9b+upcr/+Pikec/HnLM3wB5omXuJTMZ8LmdEkUXey8exaDQU3WVbnpbck1Gka2fOPLBunU2rWUWRzYIdXisLZkajoahaDdHioqdaDdE6oEHi1xDmpHSHmdQnkfHxKbznE2b8wow9afvdxd6SoueWF79xudb4Jy6AD44oCgRnGNATx+ydm+PVdmEBxsauZMGeAQ4A2zvn1GwIpe8slp4/FoW5bAMyLuB8cC6Kgg/OgkE9H8fLn1wsx+e3bGV7NrR7rbEE+D0wCnwLyLYBCBhSCI3k7KWV6g8HLBS+LFzGgcNhkROsbpdAiLtzjXNbckUH7856m2z7QLp6/rxf4udmfLHd2fH++vRy9cev++R8ySwyYbc5aAaEtNoYQDBYCeiNdjYFAM6e/TjAdTMdAF1tp69CuVSPj53yyYUiRAIL1lywqz9rtmYBLJgpmGFCPUib2oZdBVY+P/8m8DNgORWoGo0kOf33evz6VXCku2WYIZnM3pNzkx3BAvT1ve8lHZT0O0l3KT1CEt5fnoiXD52TkpAC1AAniIF3HBx3udyNjq8nt27tpF5XsavLXgIelDTaGsJQWLhZW/7tqeBvLP+vxGXNhbcamRGQloErmF0CZor5fLU/Sdo6yNxhZ88+SDZrMrPzkBwAX/kgk81mdfRQq9VrfzqVJKduNt8VbDUCmYSTDKQGsARcE/w5ymR+KfjjvmvXJoDqcKnE9JUrnT1y3G5jY1N4f2PAuc3fh+79Zi5zW5nyjeTMmZXqyydCmI/NIgNMzXtOHViSKBq6buYmPdyS0VgpFHzvwABEEVPT03do40Pb7t3HzKz/Eec2vwq5z5m5ZqFszFxdWfrJ8UbytwXIREACFM1sHpg1s5kok7mBSEJo4BMvZSJ6+vr4x4ULLQR1j+zRR09glv2S2eafmmW3K1Qr8cqvjtdWDr9rli0Cs0j/Esz15HI3V2q12MyIslmG9uzhzUOH1h3jnsECjI4ezEkj3zPr/3ojOXciXnrpsA+LVw0rRGalma6upe1xTHdXFxcnJ9v2/yEfK+40aSD2/r2Xo6j7N95fKYqZgm4UY9txP5L4/MICfygUOvb/b4OFAZuQsv++AAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIzLTA1LTI1VDAwOjI4OjU5KzAwOjAwM8i5WwAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMy0wNS0yNFQyMzowOTo0MSswMDowMPiypBMAAAAZdEVYdFNvZnR3YXJlAHd3dy5pbmtzY2FwZS5vcmeb7jwaAAAAAElFTkSuQmCC",anchor:[.5,1]},{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAAgCAYAAACLmoEDAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH5wUZACIpx2TIswAABfxJREFUWMOtmF1sHNUVgL9zZ3a9u97gXRITO4CwImhpAqXioQ2oeWgESPAUgRQk4AHEQ4uQqJAQP614QFVRItSi/tD0CRVo08gR/xAhkQRIIhMURJxAfm2vHdzY63g3Hv/P7s7c04dxCm7WYXbJkUZXmtl7znfPOffcc1doUn7/smJSgIHalUiiyApR2lBSCC4QKPiAN62Uc4IaB5al4Zd3SVM23WZh3Sz4g0hLF2sSo9wCrAduAjqALDADFIHDy4S9Fg78fC3H9h5Bm7XZ1BI3dyuidChsUrhP4GcxNB4AtonQLZaxJ+9t3HRDM7Z0Kwiiyg9RnkLYBGTizFUFEeZQug1ssYaTVtHfbIqP0FgaWATDtcDvFDYCblxTIqCQEXjAChlVfmuFAYifFqYhrxpyCo8BG0Xig/4PGFDBVbgbeMyx5J7fHj+FY8OiOMAG4EG+x8aU6HFRHgI2CDiXFPb5HYoa8gqPEu30C9eiYBVCC0EYjVaj90tIFviVFfJxvRvXQ0bhx8BP64V+YfNoZ57itZ04LUlylSpe3yhh8Rwdqoj830QRUOUWgRuBj4mRu7FgBQzK7UBLPVDAXreKcxtuglyWVqLQtq65hqndvZT7R1heDxhoEbgN2AcE3+mxWLCKEVhTL78UyGeZXL+W6VyWlfANbD7LyvU3MJ3L4tVzm4AjcINIPI54G0wRlA7q1GVVaGslvaKN5XX0mSvauDzXSlrr0wrCSiRevY+Xs5Gq1FKfHYMrSxgUocWYpXe8QjoWQ2zPRjK51DrmKsz4VUr1vvtVSvMVZpdynSiexCy1cWEt0AeEdTzH+CSp3gJWlelFXlOmDw2g45OkpT5tiHAKwcaBiFu6rEIPUdOyKKQiEISkDpxgpV9l+Cer8ZIJ2qs1xnsLVHsLXB2EJJeArRE1OJcQVrCqfCTKCMLqet71qyQPnqKrdwDE4KhlVS06HBxZKgeUEZQ9EtOzcdNAxTIKbEPrKxaJwPwaznwF/BrORUGjaP0LoYjEa2Zi9yKbtysq/EDgFYR1ceddRD4V4cG3/7Tx1OhwL8ZCaA2OY7EmKi0Z32d9scjWRmEBNndrgqhjehHobJZSVUfnZ849s+OP97wTzAwlAnCNxYTWGMexoTViBapp35/70eSUf6T9CjoTtuHuqQa8C9wMPA4k4gOe7wesPXNq/8mPtz+er0ydvdcYxzVgMIhjFEBNdDBavyUVHGpPTRg4OhpKX8N3i83dCtClyt+BOyTm6bOAjHd2oLB3x1PvFQufecZxRRcdXwrIwspAVQCswLxFP2zkUADg6egacpooFQYbmevPet6xT//ZUxw8OCHGVRArUdlaeCQaRSyIFVErgiiaQTXXMOwCsNZy7BJ4CWUuzhwb1oKvj+/5/MSBbYMipm4LdqGIoCoqMqLG9DUFC+BdSSjKPxTe0ov0oqqgqpTOfHX80K4/HwqDqo0BKkQ9tA8cNrDTpFJnmr6erDoMk2kmMgEviOr1CjfXgxCB2cmxscMfbe2ZKg3NccFvVEDO98WKYFGdA/oROQkMT6TTM221WkONzCJ54n4hHaAuHLFB7UW14fR5T357DGt+pe+LN3pOH9s9hsj58EfhVYyqgGoAzAJDCrsd131N4YM7h4aOAzNXex6F/v7m/uT4tmzpVrzSUD6zrP05N5F+RIxxvylTQTh8Yt/B/a8/88mMN+Ib4wggGl0bqsCsKhOCnhYxfSGMqxDMl8thaz4PjsNAobAoN763/PqFg5LOrLgxc9mKrYlk5lYRAyjeeGGw581ndw6f2FsyjusQ1ekJETkLjIrIsOO6Z1Bq1gaEtVDVdchks3z15ZcXptSlgAV4+qVB3GTynnS2/S+Ok+iszE1O9+75687ePX87atzkhMAoqv9RKGZSqbH5SsUXEZxEgqvWrWPXq69+p41LBgvwyHMfpC7vWPtsSyb/8Eh/zyf7dzy5bX723KCIKTsi3nAyOdvp+7Qkkxzr62tYf9PVoJ6kWpf7XnnoD8vd1L9LI0cnvFKhzNkpP9XVharyi1KJ98vlpvX/F5vAnOxV5r8nAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIzLTA1LTI1VDAwOjI4OjU5KzAwOjAwM8i5WwAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMy0wNS0yNFQyMzowOTo1MiswMDowMAXwvhAAAAAZdEVYdFNvZnR3YXJlAHd3dy5pbmtzY2FwZS5vcmeb7jwaAAAAAElFTkSuQmCC",anchor:[.5,1]},{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAAgCAYAAACLmoEDAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH5wUZACIpx2TIswAABa9JREFUWMOtmGtoHFUUx3/nzkyym7R5tIlNfdCH9f0CLdoK/aCoICiUFkTUDxWxKoLQL0oREdEPikjxGaP9oLVW8IOo2GqpilqJlfporU2oaZKNaW3SZrOb12aSnbnHD7PV1O42s2sPDBdm773nd8/933PurFChvYxSBQhQCzIBTQL1QAJwgQDwFbIDkD4X1In6cjdSkU+3UthqIAvSCJfnYCWwCrgGaAHmAOPAALC/Bb5T2LMcOtpBK/VZ0RLfQgmhReAu4B7ghhgT7QG2WfjQwOBDFbgua0QrigERuEThCYW7BGrijC2EMwd8KPCChUMO6PoyEMqSQQDiwTLgWWC1lDG+gFQD3KdQI/CkC92UIQsTt2MbigcNwGPAaq1c7y6wRuCxPDS0liHh2LAKjsDNwDrArew8R1bYkfs1ms85q7BtKAKNwKMSnfRii0GBcMZz8l2J/nOAh4HGt2JGN+5WGuBq4PpSoIA2X8fAojtxqhtpmMqQ/fNTwhO/0KLRofxvdAFWClwFfEMM7caGVbhVovR6OqhgF9/B8MpNUHchtURbW3vRvYz+sIF06jPmFwMmmu8WYDdREZk1YrFgBS6niL4UqF/KyPLnGKu7kAXwL2zdMhYsf5axuqVkS4TNAa7UmBxxYYWoMhU9V3MXk5x3FfOLzGfmXcO8uiUkS82rsEBj5vty0k+i2EsFjIcrUtyhCNXi4ZQSpFByIadZ7NQFjJRwhj/E+FSGoWK/+8MM+SeYOEPosmcVVsEqdGmUkU6DHe4g0dmG1ZCxU8aFjHW+iWY6SZaADYE/ABuHI5YMFKxAO9Gl5ZRDJkCQI7HveRZMZ+m/9EGyXh3N+VFOdLQx3dnGBUGOqhKweaILTizYWMJuRUVgCbBLYGmRxQBgXEKvBsTFsQFhkAMb4JzBSY9EqSu1Hpk1z8bVrALHgG3FoiCFxwY4U6M4/jBMj+LMAmqB94nuvLFKWOwS34aicLHAu8CKuOPOYD8IrNvasvqP/up9GAuhNTiOxZootdT4PqsGBmgtF7YA7AFrgE3AwkopFT2WM8MbN5+39tO8SXkBuMZiQmuM49jQGrEC00nfz102Mur/1nwOCz1bNixEd9KngQ2AFx8wioxibSrx/Xfbmzd8Mu4c9x113EIFk0IPRUQBixKgZAwcFKNdZd/0CsCLFd4EbpOydkdJe909n89/4rMjiR+zDq4oM6tJYUmqhUYgykSTFt1VTlEAoPDt1KeRFHrLGTtpstl9c7e2H03szRhcBbESHbTCI1ErYkGsiFoRRNEaVBvKhi0Aawa+BF4n+q6a1ULyQXfy65/2z93WKxgk1oaIoCoq8pca01URLMBxCAXeAT7mDKknuoArg9W/d7Y3vPJrINM2BqgQXUt9YL+BHSaROFrx/waXRU0GeFHRS4Fri0EIMO4MDv5Y39qe9VK50yWuAoJqYW2CRTUHHEbkENCfSSbH6/P5si4yp1hBuwr8FpLfpIRjJ1/MbPP4UwfmfNR+OPnVIMjJ7Y+2VzGqAqoBMAGkFL5yXPc9hS9uT6U6gfELsll6Dh+u8H+cGdaGMuSkGuts8zOeJh8RjPtvmgrC3sTuvTubNn476v7lm6igiaoiItPAhCoZQftETFcIJ1QIJtPpsLaxERyH7p6ef3xVLIOZEd5o9mYdw+baoOk6T2tuFAygDLt9f+6tf/vnEfeIb9R1FM0DGRE5DhwTkX7Xc4+i5K0NkHyouA5Nixbx+4EDRSV1Vux5rxfHVq2tDZtfdfAW+jIytqfhtR176t84aKjKCBxD9YjCQE0iMTg5NeWLCI7ncf6KFXy5ZcusPs4aLMDjc79INE1e8VQybHygL9H+7c5zHt+WM8O9oibtiGT7q6omFvo+1VVVdHR1lT3//5bBTEsG8/2Mm3rJtYkPBqsPZoYTPWn6Rv1ky2JUlZuGhtieTlc8/98L/TvfZZ49dwAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMy0wNS0yNVQwMDoyODo1OSswMDowMDPIuVsAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjMtMDUtMjRUMjM6MTA6MDQrMDA6MDATW3FEAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAABJRU5ErkJggg==",anchor:[.5,1]},{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAAgCAYAAACLmoEDAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH5wUZACIpx2TIswAABQpJREFUWMO9mNtvVFUUh7+1z5nOTKWUSsE2ahRUQiRootGIiQ++mJhIYoJ/gIlPPmhi4u3F+GR8MN4gBokaFRU0Jt4SlYSLQhSIKAhyibRMWy6l9xl6nTLnnJ8Pc4pFmOFMW1yTlZMz++y1v73WPmvtfYwZitD0WwOagUYgA/hAABSBAjAI/3YwbEZj+jOFnQZ5O7AKeAC4E2gB5gGjQA9wENgF7AWOTof+X0TlX4vQ00J7hZRA9wg9JXSd/g/eGNKElgt9KDSWEHRKx+J+y2M7VxXWhG4T+lKoVCPolJaEvhC6VWhmizehV5uE1s0CdDrw2tjeVYH1hNYIjcwSdEpHYnve1fBqs9COOQKd0q2x3UQcSVOXA+4A7q06p7vpYTUeTSwgT4HvCNlPC1RMrKuAlcDPzFVKE/KFXq24Vk2hVqtf7eqWNCopkDSqNnXrEfULRVXW7itCs833F8HWCX1bcdBbNKSDykkKdbGEOqCclmqoAmwU261LGt4kYlAlnDeTZSULL2PPcSfXsoRsFbvXQbL6W4v7MxVbUvgVC76RJkW1Nz5LQknqWYBzFVsGGCXPwGXbhhign7EqdgtzDRsBbUB42dajZNhARMjIRf+HjPAu4lhF74XA8dj+3EhcEJ4QmqiYMxs1qRfUrnadVJ8m1K6Tek7tmq/JKnl2IrY7d4Uh3hMsFTpRNcn7CjRfga6VNF+BfAVXKAonhJYk3SMkXQYCzgKbqoYswGMYjyFgGI+g6osVAZ9R3vMmKgiJdz1xSVwGfAzcN9MoTZM9wOOPtTx6fH/6T1wEYeTwvIjIlVNLfbHIAz09rI87JE5dhiHUAbwFvAm0zpRS6OyQG9qw5vo1/d2uc3HM4WINY6+fF4z3Z+uLyxYtpjUV1XYYir1bD7wMPAOkagWNiKJfM7/senbRM9/2eX1FX56vMqSVAy1hJiBCBIi8gyPm1FZTTY69Ow6sp3zeeogal1Iuletct+DtQ31eb5OHb7Lp1URlc1L5UuZvFSwJxdZaisIFYKCL8lLoqKXvOVcobG74dPfvmX15D1+GRVYOeaxWvppFYJGZIjNMqB5pQc2wMbCAbcA7wHiSPiVKwU/ZHb9vbtjU4XAJj+NmSCazbjnXNiPYWELgI+AbrpB6hDiSPnxs3YK1B87b+SgBqAFO5e8OBx384DKZM7PdR+aB14SWA3dVgujzens3NK7f3ZXqHL/0GRkYUjwvI0IaB9ox+xs4lc9mRxtLpZo2Mv+ZuhF79FCJ0psh4cjlnitSnPx63le7t2e39xo21a8cXuEkAykAxoBOwXbP9z8RbHm4s/MYMHpjoUCuvX12X2Ti7BB1e93fL4oWfeTknnS4CzZDgnBvZs+BTxs2Hg+sJA/PAJOEmZ03GJPIA13OrC2EfhnBcH9/eE1TEz8uXcqJXO7CeLM+ThjGPrevgOP95qD57nrV3+9wCNHld538oPG9P077p4u+fE+oBOTNrA84a2an/JR/BlGKogArhcL3aL7pJg7/9dclY83J2eee0j3qSHUcGnbDb6TD9BKHax224ZEvGj7/bVd2Z2+KurwZZ5FOC3qy6XTvxORksTxb44ZV97Ft48YEjplD2dKwJbNiYsVLTWHTE3syu3e+uPj5TXk31OHkBj2zwqm6urHWYpF0XR1H29pqtj93p0pgYbCw2Ol3vp6JMpsPp4/kc5ncoN81XGxsuRlJPDgwwPeDgzO2/w/IRTXCFJZFPwAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMy0wNS0yNVQwMDoyODo1OSswMDowMDPIuVsAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjMtMDUtMjRUMjM6MTA6MTMrMDA6MDAaVk9UAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAABJRU5ErkJggg==",anchor:[.5,1]},{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAAgCAYAAACLmoEDAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH5wUZACIpx2TIswAABfVJREFUWMO9mE1sXFcVx3/nvnn2PI/leEZDHSNQ04gUUgGVQIIGqQuqgMSuYtEFRUoqNlRIlVixoKiqukIIwgZVhEr9CAS1Vj+Q2oJE+EijpmnTNiRNaxKnSWyntmM/z0wyiXnjmXf/LGZchXbGvHECR7q6i3vPub93znnnnveMDUq9XqfVaiGJarVqo6OjZTPbBOSBHNACEkm1hYWF5fHxcQE45xgdHd3QmbZR2DiOGRkZsXq9fhuwA7jTzG4HNgPDwBVgQdJx4BXgSD6ff6/RaKhUKv3/YKvVKmmabnbO3QN8B/hqBrUjwH4zewa4WCwW/7ewcRwTBIEBn5X0I0n3mNlQHyZWgGfM7KfAKUD9QOf6gfXem3PuM8AjwN1m1pe+pCEz+25n/rFz7n1AWfVd1o2VSoUgCEYlPQDcLakvUAAzo6P3bUkPeO9HK5VKZv3MsEBgZncBu4Gc2cbezY5eDrhP0l1AcENh4zhGUlHSD8xsuNseST1HDxmW9H1JxTiOM8FmDaUDvgh8pReomSkIgoUwDAMzG5VUazabaZqmmyVZj0jsAL4A/J0MuZvJs2bmgG8Agz1AfRiGy4VCgSiKCvl8PoiiqFAoFAjDcNnM1MPDg8BOM8uUCplhzey2Xkadc5eiKKoHQTAGFGjnYSEIgrEoiurOuVoP0wHw+awcWdPAaN9MXWPpnIucc0GXQ51zruScG0zTtJfdMTLW+37KT349O72S0swG6fHGd1SirAD9lK5LvRYkXZEU91iLJV1dR7e2TsXoH1aSlzQlqWss0zTNNxoNL6n+Eb16o9FQmqa9vJea2Wkz8zcM1sy8mR02s2aXNSTlkyQZS5Jk0Xs/671PvPezSZIsJkkyJmmwh+kmcCQrbKacdc75NE3/BsyZ2dZuwN77gSRJtjQaDWjn6Cc7l0KwtqeLzEn66w31rNoyD+yX1NVwx8OB9z7w3uO9DyQFZtYVtGPnd865BTI2M5kv+DiOMbNbgSfN7I6seus44LUgCHbvvvfe08dPnsR5SL0jCDzeGQYMJQl3LizwaEcnc+kql8tUKpVzwC+BPcD4dYDOV6vVX+/atWtp8cKFmzocrjNSwAOrgpWlaCi59RM3MR76/prvTjs3BDwE/BAI+wBcy23/xuuvv/LQgw/+YSmOk5xzObUhrR1oCTMBHtFCVB28a05TffWkpVKJSqWyAjwq6XYz+yYZU2ktb6enp8//Zu/eE0tLS8UgCExm1xhQ25zUntr844JbUvHnfi6FD4GBaTPbA5zLWtABLtVqtecmJg7/4+23q0EQyMy8tUPeGdaezTyYN5M3w4SGkEb7hu0Aa3h4+ADwKzNbyaLTarVahw4devO5Z58955wjW/NuhmQym5NzUxuCBQjDMDWzJ4AXtI571xrwycnJycf27j22urrqM4Aa4AQJcNzByy6f/6Dv76g1qdfrrK6uVsMw/JmZfU7Sl7pBmBmLi4sXn3z88cMXZmdXPr5HBkbncYXhkVaAM5idAmarUXRlU7PZVyPzHzIyMkIYhnLOnWg2m3vSNK2vefLaudFoNF5+8cXDhw4evHjNBdEOr3CSgdQCrgLnBX8Jcrl9gj996/z5SeDKp2s1zp4509+n+EelVCpRrVb9/Pz8S+Vy+Qnn3P3Oudw1ZSp96+jRYxNPP3261Wqp88/BOuurBlclqsC0M5tKYUlG6/LSUlooFvnj1q28f/bsh+ddFyxAsVjkwIEDNUmPlcvlL0dR9DXn2gGbnZmZ+e2+fW/Nzc0luVwukNQEqma2CMyb2WwuzH2AaHrfwpqpyAWUb76Zk++887GzrhsWYOfOnTp27NiJer3+i4GBgVucc+OXL1+uv/D882+89uqrF3MDA1WDeaQLgoVocPDivxqNBAAzPrXjDg489dR/PWfDP+a6ycTERH779u0/2bRp0/fePHr04CMPP7y/Vqudc2bLgVltdmDg6niSMDgwwHtTU33bvyGeXZNSqZTMzMz8fNu2bb//5+Sp6vT09HJQqyUjW7Ygia/HMS8tL2/Y/r8BRVECE4yt2dgAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjMtMDUtMjVUMDA6Mjg6NTkrMDA6MDAzyLlbAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIzLTA1LTI0VDIzOjEwOjMxKzAwOjAwz+xZAAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAASUVORK5CYII=",anchor:[.5,1]},{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAAgCAYAAACLmoEDAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH5wUZACIpx2TIswAABihJREFUWMO1mF9sW2cVwH/n+6597aRVbLykf0S0iiJGpwLSGkGHtAcmQOINDWlIEw9DvIAmTeKhoAnxgHhCCFVa1UIRDxBEkaZ1He2YUCnQDalUqdextmvnpUs60sVxbMdO4tROfO93eMhNadO4vXbLka6u7v3uOefn853zfeez0KMUCgWazSbOOWZnZyWXyz0EDIhICvBUNRCRFlDPZDLVubk5tdbi+z67d+/uyafXK+z8/Dy7du2SQqHwaC6Xexx4AvgcsBXYBDSAGeCder3+pjHm7NDQ0OVSqaS9+pRelPL5PM65rcaYp4FngC9s9J3q/7hE5CxwREReUtXSyMjI/xd2bGwMa62o6iOq+kPgaaBP5N5mVBURuQG8BPxMVQvGGN2zZ09s/12lQRiGYoz5JPBT4OsiEls/+kF9qvotEekTkR+JyAdA7LQw3UTV87yMqj7fLeg6aE9VnwKeV9VMPp+PrRsbVkQs8CTwLPdRmGvAwLdV9UlVtQ8UNiqoLPAcq5V+h6gqqopz7ua19q6DbAK+a63Njo2NxYKNGyFjjPmsiHy+Eyig/f39MwMDA9bzvEwQBPX5+flwaWlpq6pKhyJ8PAzDzwCniZG7sWBV1QBfUVV/vdMI1GUymbnh4WF83+8HLNCfy+UWpqamqvV6PbcRsKr6wJdF5J9AcM+IxY0s8GgEcYekUqn57du3L/q+vwW4Cev7/pbofb2DXQvsjssRK7JRSLbSYV1OJpPpdDptN3Bq0un0x3zf95eXlzc0DWwh5nrfTVWnNnoZLfZep6QUEV9EbPTd+jGAdFyA2EsXMN8BhiAIGkEQVDYaD4KgEgTBUqddTlXrd1kxuodVVaeq40C40Xiz2UyVy2Wnqovr9BbL5bI2m81O0QtF5H0RcXE44qaBA86o6jPR5nBbZJ1zqVKptCUMw6nBwcG6MWbQOVcul8srlUpl2DmX3CiyqtoGzkb2Hwysqjpr7T+cc9PAJ9aPR6mQLJVKOyqVCqxW+fYwDFFV2ykFRGQa+HsYhrFg4+ashmFYBI50ioKIoKo2CAIbBAFBENi7gUZ2/gDMiEispI3dIkbt4adU9XfA3rh6d5F/WWuffWHfvvcL4+MYB6EzWOtwRhCgr9XiiZkZftktLMC5c+cSIvIUsB/Y1iulqhYXFhZe+MG+fccXqtVEAJ5xmNAZY60LnREnsJJutW7sml9oXRgcYlvCddc9iUgbOAE8BnwfSHQBuFaM7uKFC4WDL76YrdVq37TGeAYMBrFmtccwq32Ca/mp4O3BVM3Au8VQxrs+1kT95w7gV8BXu52d69evTxw+dOi1K5cv1z3PE73NQPSkGt0EwAk0HfrXbjYFAKKz04equl9VJ7vRXVxcrJ86efJM4b33atZajUAcNy9ZvYs4ECeiTgRRtA/VTNewEbA2m81TwEFVvRFHJwiC4Hw+nz918uSkiBDn3AYiqIqKTKsx4z3BAjQajVBEfisir3KXXnStAZ+cmLhy9OWX32632y4GqABGoQW8Y+B1k0p91PPxZGhoiGQyWVtZWfm5qn4aeGwjCBFhbm6u9Kdjx87MFIs37vxGBYSoPVAEx+psXUWkAEzV0unGQLvdVSNzm4yMjNBut1VVLwRBsN85t7gWyVvvK8vLy2+ePn3mrXy+dMv0r06vYlQFVANgCbim8Dfreb9X+MvXrl27AjSG63Umrl7t7U+OWyWfzzM9PZ3NZrM/8X3/e8YYb22ZUtXw3+fPn/v14cNvVCuVljFGAInGV4AlVWqCfihixkMoqxA0q9WwP5sFa/lgYuKmr/s6pa5FeHR0tC4iv8lkMntSqdQX16a6WCz+57UTJ94qz862rLU2alxqIjILFEVkykt4H6G0nQuQdqh4locefphLFy/emVL3C7smx48fJ5FIfCObzR7wPG9bo9FYfPWVV14/dvTou14iURMoonpdYaYvlSo1l5dbIoJNJPj43r2cGh29p48HBgtw4MCB1M6dO3+8efPm71y6eOmNw4cOHllYXJw0IlUrUp9KJpe2tVr4ySSXx8e7tn/faXCrZDKZVqlU+kUymfzj5ORkbbpYrJpqtbVpxw5UlS9VKvy5Wu3Z/n8BcY8RVtNG93EAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjMtMDUtMjVUMDA6Mjg6NTkrMDA6MDAzyLlbAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIzLTA1LTI0VDIzOjEwOjQwKzAwOjAwY15brQAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAASUVORK5CYII=",anchor:[.5,1]},{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAAgCAYAAACLmoEDAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH5wUZACIpx2TIswAABh5JREFUWMO1mF9sW3cVxz/nd23Xf26bhFGaNEyNKrTB0lFpD9Ah7QEESPRpAimVKA9DvIAmTdoTQoiHiidUsWpCZTxVMESJHG3lb4VEl64gteWPuiZjTZrUdqZQ203sxk7s1H/u/R0e7FTpZqfXXvlK1pX98zm/zz3n/H6/c6/Qp86cOUM0GsUYw+joqOTz+Y+r6oCqRkUkBHhADSipalFE1HEcYrEYR48e7WvOUL+wruuSyWRkbGzsqVwu9yzwHHAYGAZcoALkgRkR+RtwdXx8/Mbs7Kz2O6f0Y5RMJlHVYWAC+Cbw+fsOpavLq8BZEUlaa+8cO3bs/wubTCYREVHVJ1X1+yIyAcSD2KoqIrKpqkngJ8aYm6qqExMTgefvqQystWKM+RTwY+D5XuzbEY8D3xKRuKr+UERSQOCyML1E1RgzCLwEPN9eRD2rbfd14CVr7eDk5GRg28CwquoAXwJe6CWiXRRS1W+3/TmPFHZqagpjzBDwIq2V3ulmUFWstfi+j7X2/m9d5ALfFZGhoNENGiEDfBb4XDdQEdGhoaH8yMiIE4lEBhuNRimXy/l3794dVlX54C4hIqjqs8DTwNsEqN3AsKr6FWBXJ1DA7t+//+7hw4dxXTdBK7WJAwcOrF+/fr2YzWYf6wTc9vdl4O+0DpGHRuyhUlUDPEWX+nJdtzw+Pr7huu4+4D6s67r7Dh06tOG6bqmLawc4JCKBOILCSvsQkA5jJBKJ2MDAwGMd/JmBgYGPJRKJWKfalZb2yQ4nyXYFKoO2r2jXOzYm1G1CEdlljNlpxceCMASObFvlbgP1er3SaDQKncYajUahXq9Xu9mqammHHaMvWAssAn6HyFEul6PpdNqq6sYHQDZSqZSWy+VYl8D7IrIgIjYIRNDdwAKXaTUtD6RURPB9Pzo/P7+v0WgsHzx4sBQOh/c2m83VdDrdSKfTj/u+H+kC26TV4Dw6WBGxqnpRVbMicrBTdBuNRmRhYWEslUphjHGstfvbh4PTbf2oalZVp4NGNmgZqLU2B5xV1Y6ORQRrrdNsNp16vU6z2XR2Am1H8zcikheRQEUbuEWcnJxERJ4AfiUiR4La7aArIvLCz199dWFpeRljwbcGx7FYIwgQr9V4Lp/ntV5hAZLJZJhWx3QKGOmXUlVzlUrlB6deeeUP9Uol7EHIWIxvjXEc61sjVqARq9U2P1Ner83u/QQjYdtz99QE/gg8A7wMhHsA3OoH7OLCws2pycmh6vr6MceYkAGDQRyjAGpafYKt7Yp67+yNrhl4L+fLYs+PNclkEmBMVX8BfDXo6bOllZWV9JtTU3/KpNMlx3FE2Z7e9jfV9kUArMA9i/61l0MBgPZjyPu0SiHTi+1mtVr655Url5cymTVjjLZBLPc/0rqKWBArolYEUTSO6mDPsG1gHRwcvACcVtXNIDa+73vzc3P//sfVqxkRIVhCRFAVFcmqMYt9wQKMjo76qvpL4Hfs0ItuNeDZ27fn3rpw4R3P82wAUAGMtt47zBg4b6LR230/nszMzBCLxdY8zzupqp8GnukEISKsl8t3Ll28eLlYKGx++D8qILTbA0WwtLJ1C5GbwPJaLFYZaDZ7amQe0PHjx/E8T4FZz/NOWWs3tiK5/dpsNuvXrl27PHfjxp1t6W+lVzGqAqoeUAWWFN5yQqFfK/zla0tLc0Dl8VKJ9K1b/b3k2K5kMkmhUBjavXv3iXA4/D1jTGjbNuUvzM//69wbb1wqlUo1Y4wA0h5vAFVV1gR9X8Qs+rCqgnevWPQTQ0PgOKTS6Qdq4yPr5MmTEo/Hn96zZ89rkUjkC1upXl1dzfz+3Lnzi/PzBeM4Dq19ek1EVoCciCw7odBtlKa1Hn7TVw05xF2X/7z77odL6lHAApw+fZpIJPIN13V/5jjOyL3NzY2L09Pn356efs8JhdYEcqj+VyEfj0bv3KvXayKCEw7zySNHuPD66w+d45HBApw4cSI6PDz8o3g8/p3UrdSlN6eSZyvVasaIFB2R0nIkUh2p1dgViXBjcbFn/x/1ZcUDSiQStWKx+NNQKPTbbDa7tlooFGVlpRYfG0NV+WKhwJ+Lxb79/w9bQvQtKYEySwAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMy0wNS0yNVQwMDoyODo1OSswMDowMDPIuVsAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjMtMDUtMjRUMjM6MTA6NTArMDA6MDCv9FszAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAABJRU5ErkJggg==",anchor:[.5,1]},{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAAgCAYAAACLmoEDAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH5wUZACIpx2TIswAABjJJREFUWMO1mE1sFOcZx3//d9beXePixQvCpFSp0qopNGlFKlGn2EhF5VIulSqlUsQhqDduPfClqqdeiEJPPeTApY1UKuVUCcIhaikpBrxRKEmJ7RrMR7CNd8GuP3a9O/bszNPDrhE4Xjy7oY80GmneeZ/nN8/832eed0SLduLECaIoAqCtrU1BEGw2sy5JKSBhZlVJPjCXyWRmZmZmLIoiisUip0+fbilmolXYarVKKpXS0tLSziAIXgf6gR8APUAnUALywGdzc3P/dM4NDgwMDO/du9dajalWJh09ehQz65H0hqQ3gR+ZGdLT7sye4hoEzpjZ+2ZWOHXq1P8X9siRIwCS9DJwDHhDUkfc+WZWBt6Pouht59yoc85OnjwZO36zMhDwbeB3kn7e7HxJHWZ20DnXIek3zrnbQGxZeE1mdZOk48BBSS3pXZKrvxnPzAb7+/v9gYGBWHNdE3E8YB/wVqugT1gCOATsM7PYCYt14/HjxwGykt4BXl69kKC2mMyMMAyJouhxWatncy237UC3c+6Dvr6+cpzsxs2Qk/R9YPdag/VKYNu3b8/v2LHDS6fTmUqlMjcyMhJOTEz0mJkaAL9uZq8CF4mh3ViwZuaA/UByLVAg2rlz538PHDhANpvdQO2Nbdi1a9fCuXPnZoaHh7MNgJNm9lPgElBdN2NxYc1sJ2vIxszIZrPz+/fvL2az2a3AY9hsNru1fn1uVc1dMc/MXqknY12LdZNq1sMaddnM6O7uTvf09GTX8Oe2bdvW3d3dnW4AK0lbG2lktTWzqlMNn9i5RKOAkpLOuWct5HRcgGZK13yjgXK5XKpUKtMNxqYXFxcX1xqrV5BGEmkZNgJuAeGXHDhHPp9P5XK5KIqi4lOToqg4ODhohUIh7dyaoULgZt3/uhZXBhFwBXiTVYtMEkEQpC5evLi1UqmM7969ey6VSm3xff9RLpdbzuVy3wiCoL2BSgJqDc7zhZX0DzN7ALy0elASlUql/dKlS98cHBzEOedFUfRCEASEYeg9Y/08AC6YWSzYuDIwM5sCzjTKgiTCMPR83/fK5TK+73vrgEaS/kyt540l2tgt4rFjxwC+A/wJ6I077xl2VdJbFz788OajmRlcBGHk8LyIyAkBHb5Pfz7Pu/UJsZuIy5cvs2fPngVJ88Ae4GutUprZ1NLS0tvnzp69XikWN0bQJaPLTBnnrNOkTkEyUa3SEUZh9YWv65XNG5vrniQFwFngNTP7taS2FkCjQj4/+kkutynw/V86KeHA4ZDnDMBcTRaRn0xVr29JzToYmgp1K3ZmV7Lb19cXAGOSvgd8iyZ3G8WFhbv//vTTSwvz83LObTRpg6SO2mG1s9kGiU7QRsRmxEshlJqCfQJ4HngE7DGzTTG/liwvLc3dGh39+8T4+ANJSDLVslg/VDtLBjKp1v0Y1oZZoWnYFeB9+/bdq1arDuiPI4coiqqTExNXhoeGblitBYsRScJMJj0wKdfM5/Ypy2QyoZn9UdJfWaf0mBmzs7Mjw8PD18MwjGKACnAGPvCZg/MulZpseXsyOTlJV1fXbLlcfsfMvgu81gjC9/3CzZGRK4vFYnmNRxGIentgiIjaLngMaRQYn02nS11BEL90rbarV6/S29uLmT2MomgR2C8pufL/YOUcVqtLd27fvnBnbOwOPN7i1F4vciCEVUEVYNLEJ4lE4mIURUM/++KL/Fgms7xlcZGR+/dbhwUYGBigr6/PSqXSuOd5m5xzP5TkngAOHxYK14Y///xfQRBU622kq+8aAokFYEpww8l9FEk5k+4vTk8X29Pp6lg2y+1798iXSo+18ZXt0KFD6ujoeDWZTL6bSCR+vCKH4sLC3evXrp0v5PPTkjxqjcuspIfAlKRxL5GYxAiiqEoYhGYJj47OTj6/ceNLcZ4LLMDhw4dxzv0inU7/wTm3bXl5ufifoaHzoyMjQ87zZoEpzCYM8h2pVKGytORLwmtrY3tvL3977711Yzw3WICDBw+mMpnMb5PJ5K8eFgofXfv44zNLy8t3BTOeNDfe3r64zfdJtrczfOtW0/6/6s+KpyyZTPqlUun3nuf9ZW5ufnaxXJ6JJif95IsvYmb8ZHqaD2ZmWvb/PzZaBDRi9tDdAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIzLTA1LTI1VDAwOjI4OjU5KzAwOjAwM8i5WwAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMy0wNS0yNFQyMzoxMTowMCswMDowMAjWPmkAAAAZdEVYdFNvZnR3YXJlAHd3dy5pbmtzY2FwZS5vcmeb7jwaAAAAAElFTkSuQmCC",anchor:[.5,1]},{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAAgCAYAAACLmoEDAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH5wUZACIpx2TIswAABixJREFUWMO1mE1sVNcVx3//+549Y2MMDkTMTBHCNgpVmlApi2IagVQ0SFVXlYpSKcoC1BXLrlKp6qLqKoq66gKpqzZSqciGSnXYuEVJIwWjVkIRkAhMBtt82MYej8fz4fHMe/d0MQZR8Mcbhx7p6S3uu+f87rn/d+55T2zTTp8+TbVaxXtPqVRSf3//XmCXpDQQAhHQMLOl2dnZYjabtTiOWVlZYXx8fFsxw+3CLi4ucuTIEd28efP1/v7+Y8Bx4PtABugDqsAs8GUmk/mXmY1PT09/NTg4aNuNqe1MyufzeO8zzrl3gHeBo1vNMbNx4IKkj733c1euXPn/wp48eRLnnIDDwPtm9g7QKyV2Uzezj83sA0m3nXM2NjaWOH5HMjAzmdkhSb8DfiqpUxn1Au9J6pX0a+AbILEsgqQP5vN5gAFJv5L0npmFHWT0qUlykg4DgaTx4eHhRqFQSDTXdRAkkHQSOANsC/QZC4GzwElJiROW6MFTp04RRdEeSR+uZeUFMzPMjCiKiOMY7z1PFrTBwrqBV7z3nwwPD9eTZDep5pxz7oikH2wECtjhw4dnR0ZGgp07d+6uVCpL165di+/cuZMxM60HbGbHgDeBT0mg3USw3nsHnDKz1PNB10D9sWPHFs+dO0cul9tBe8d25PP55fPnzxevXr26Zz1gSSkgD3xO+xDZPGNJMwu8zjqyMTNyuVz57NmzlVwutw94CpvL5fadOXOmks1ml9YW9bwFwBtJORI9pLZl1ttL7z2ZTKZncHBwzzr+3NDQ0CvZbLbHe7+ua2AfCet9J3UyvaGTMAy1wVskKRUEwWYvck9SgMSlCyhvAEO5XK5Wq9WF9cYrlcpCuVyubVLqll4qrJl5M5sws/gFB84xOTmZHh0d9d77yrNj3vvK6OioTU5O9ji3bqgYuAN4EliiOjs0NCRgD/Dj549YSbRarXBiYqKnVqvNZDKZmvc+tbi4OHPx4sXlS5cu5er1emoD2CbwR+B6oVDYsnQlEnY+n5eZDQJjkoY2yD5hGMapVIogCII4juPV1VWiKAo2kUAByEuaHBsb2xI2qWYNmJF0gU22LIqioFarBcvLy9RqtWALUA/8RdIsCZuZxAd8Pp9H0mtm9mdgJOm8TeyqpDOPpqfv1BsNnIfYO4LA450Q0NtocHx2lvNrExI3EYVCgcHBwWVJZeBtYOe3AJ2J4/iDyXv3rvtWq9/DLhm7zLTbOeszqU+QCqOI3tjHUe47emNvf2f9qKQW8Hczewv4paSuTinNzDdWVm7Pz80NEMc/NwgdOBwKXLvHcG1Z+EYqHV1/NV1ycGsm1kTizD7J7tDQUAu4K+l7wDAdSMmAVrN5b7FY/LzVbEpSv0k71prxXsnad7MdEn2gfsRexFAM1Y5gnwAfOnSoDMwDb5vZQNLe1sfxUmVp6Z+1avXR2k6Z2mtYu9S+SwYyqd39GNaF2VzHsE+ADxw4MCnJAceTyMHMolq1+kW5VLph7RYsQSQJM5n0yKRrnRy3/2NdXV2xmf0J+BtblB4zY3V19eulUum6994nABXgDBrAlw4uu3T64bb/GzSbTXp6ekpRFH1oZt8F3toIwsfx3HKp9EXUbNbXWYpArHWQhvCY1YG7SLeB+6WenuquVit56XrepqamOHjwIMBjM6tJOrXWTD/NpiTM+9Xl5eUrlXK5AE8/cdrbixwIYRFoBXho4j9hGH7qvb/1k6mp2bu7dzdfrdX4enp6ez85nrV8Pk+j0Rjo6ur6rXPunKTwKahZ3KjX/73w+PFnURQ11tpIrY03gZoZJWFTkpuIYd5EtFIsxjsGBiAI+OaZb7NvDQswMjKi7u7uN8MwPC/ph0/k0Go27xXn5y+v1OsLtA+gFlCS9Jj28X0/CMOHGC3vI+JWbBYG9Pb1cfPGjRfivBRYgBMnTiDpZ2EY/kFSNo7jSnlx8fJSqXTLOVcCZjB7YDDbm07PrayuNiQRdHWxf2SEf3z00ZYxXhoswNGjR9PpdPo3QRD8olFf+aw4//hCFMf3BMVAWrrf3V3LNhqkurv5amKiY//brgbrWRAEjVar9Xsn99dms1WKvC/6Bw8awf79mBk/Wljgk2Jx2/7/C8D87PcyjeWGAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIzLTA1LTI1VDAwOjI4OjU5KzAwOjAwM8i5WwAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMy0wNS0yNFQyMzoxMTowOSswMDowMJ1Oe7oAAAAZdEVYdFNvZnR3YXJlAHd3dy5pbmtzY2FwZS5vcmeb7jwaAAAAAElFTkSuQmCC",anchor:[.5,1]},{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAAgCAYAAACLmoEDAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH5wUZACIpx2TIswAABNVJREFUWMO9l8trXHUUxz/nd+/NPJK5k5kmzbRG2iRWijZmESit0qUbaVb+A0JXLhRclK5EVETcuNCFLQhiF4K4asFVtbT1UZ8JsSbBzjQ1qU3zntQkzCRz7z0u7kRazKSTzI0HDhd+j+/5/n7n/M45V4hGBGgD0kAcsAEPKANLwAKgURhpdP9TwHHgBNAH5IAWYAWYBoaBa8APwGgUpHciOeDVKgmtQ68DrwAd/ydJAQ4DnwCrdRLd0NXqvsM07tW6iB4CvgAq2yS6oRXgc+CJ3SacAT5sgOiDhD+o4u2KWMCLwHKDRDd0uYpn7QbZNuByREQ39FIVty6x61xngGeAo1us0f7+/umBgQErk8m0FovFpYsXL/qDg4M5asfmcaAXuEKEKc0G3qVGrIqIPzAwMFcoFKZUdUVVPVVdyefzUydPnpwDAmrH7jvbuLS6pAm4UMtoT0/P4vDw8Liq+vqw+ENDQ+Pd3d2LNcgGVdymekiYOskKYRHY1J0HDx5M9Pb27tkEz/T19WW7uroSW+B2UGcK2871x2tNOI5ji8imBkUk5jjOVi8+QZ1S780C3K81MT8/v1IsFuc3m1tcXJyfm5tb3QJ3KWqyAZAH/M0mR0dH4+fOnQt8319+cNz3/eWzZ8/q2NhYrdvzgZtV/MjEAk4BJWrkzHQ6vXbmzJlCoVCYnJ2dLRUKhcnTp08XXNddo3aeLVVxIy0MAnQDt7YwrLZte67retlsVl3X9Wzb9ti6KNwCutiFHiEBvE3ouiiqlw+8xTYe2HZP9CTwKXAsgsNfB156PJe7acdimAD8wGBZAYERBEiWy5yYnuaj6obtxsrfhFnhOSDVANF7xpj3Ojs7h+KO4waQFiWtKq3GaIuKtAjEbM8j6Qe+t/8xOdLmyk5iJQm8AbwGODvYHyTj8Wt729sv2JZVRtXWMCtJ6GhVRMLqpngoRQMjYjS/k1dYAQrA00AP2wwlx3Fut2Wz38SamgRwVaRZRJKhavhVbRahBcRFaEPo9mFlpynjPjBHGA51N9DGmKVMOv11qrl5qjqk8tCjk/AroiAqoioioqiD6kwj+e1PQvedoL5w8FqSye/3ZDI3JHRzHSKCqqjIlIr82AhZBf4gzL9HeEQ4xGOxkfZs9lvLstbrYQkYhbLAqIhckXj8bqOVo0yY2I8C+2otsixrZk8mcykRjxc3ObOAiGr1sEKA6iowgsh3AoPFZHI+5nkaRZmbJfzFfh6IbXJFa67rXk6nUuMPNGahexEDgqAeSAm4q8Ivtm1fCYJg5IWJielCa+t6++oqY5OT0ZQ5y7IyQRC8qaov83Db6Sfj8Z/3trVdtW27HHJHVBURWQdWVSkKOiFi8j7MqeCVFhb85kwGLItb4+P/gkXyO2GMWTLGfOx5Xr+qPrsx7tj2ZGs6/att22VVtQjTXlFEZoF7InLHduy7KJUg8JCKr9gWbQcO8PuNG/+xEwnZSqWijuP8Zox53/f9LmCfEVl2U6mfkonETJXgPVT/UphOxGIzpbW1chgQQufxY3x1/vwj7UTa7aRSqXipVHrd9/1TyXjiasfe9s+MMbdRXbBElu40Na3uK5eJNTUxms9vGz9SsolEAlXNVtYr+9NuupjraF+oTEyUNZfDAIeWl/lyYWHH+P8AZ0RW2q2R2psAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjMtMDUtMjVUMDA6Mjg6NTkrMDA6MDAzyLlbAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIzLTA1LTI0VDIzOjExOjE5KzAwOjAwUeR7JAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAASUVORK5CYII=",anchor:[.5,1]}]},logger$u=LoggerByDefault.getLogger("DrawingDOM"),DrawingDOM={_addUID:function(_t){var e=this._uid?_t+"-"+this._uid:_t;return e},_createMainContainerElement:function(){var _t=document.createElement("div");return _t.id=this._addUID("GPdrawing"),_t.className="GPwidget gpf-widget gpf-widget-button gpf-mobile-fullscreen",_t},_createShowDrawingPictoElement:function(){var _t=this,e=document.createElement("button"),n=document.createElement("span");return e.appendChild(n),e.id=this._addUID("GPshowDrawingPicto"),e.classList.add("GPshowOpen","GPshowAdvancedToolPicto","GPshowDrawingPicto"),e.classList.add("gpf-btn","gpf-btn--tertiary","gpf-btn-icon","gpf-btn-icon-drawing"),e.classList.add("fr-btn","fr-btn--tertiary"),e.setAttribute("aria-label",this.options.labels.control),e.setAttribute("tabindex","0"),e.setAttribute("aria-pressed",!1),e.setAttribute("type","button"),e.addEventListener?e.addEventListener("click",function(ei){var ti=ei.target.ariaPressed==="true";ei.target.setAttribute("aria-pressed",!ti),_t.onShowDrawingClick(ei)}):e.attachEvent&&e.attachEvent("onclick",function(ei){var ti=ei.target.ariaPressed==="true";ei.target.setAttribute("aria-pressed",!ti),_t.onShowDrawingClick(ei)}),e},_createDrawingPanelElement:function(){var _t=document.createElement("dialog");return _t.id=this._addUID("GPdrawingPanel"),_t.className="GPpanel gpf-panel fr-modal",_t},_createDrawingPanelDivElement:function(){var _t=document.createElement("div");return _t.className="gpf-panel__body fr-modal__body",_t},_createDrawingToolsDivSections:function(){var _t=document.createElement("div");return _t.className="gpf-panel__content fr-px-3w fr-modal__content",_t},_createDrawingButtonsPluginDiv:function(){var _t=document.createElement("div");return _t.className="container-buttons-plugin fr-mx-2w",_t},_createDrawingPanelHeaderElement:function(){var _t=document.createElement("div");_t.className="GPpanelHeader gpf-panel__header fr-modal__header fr-m-1w";var e=document.createElement("div");e.className="GPpanelTitle gpf-panel__title fr-modal__title fr-pt-4w",e.innerHTML=this.options.controlLabel||"Annoter la carte",_t.appendChild(e);var n=document.createElement("button");n.id=this._addUID("GPdrawingPanelClose"),n.className="GPpanelClose GPdrawingPanelClose gpf-btn gpf-btn-icon-close fr-btn--close fr-btn fr-btn--tertiary-no-outline fr-m-1w",n.title="Fermer le panneau";var ei=this;n.addEventListener?n.addEventListener("click",function(){document.getElementById(ei._addUID("GPshowDrawingPicto")).click()},!1):n.attachEvent&&n.attachEvent("onclick",function(){document.getElementById(ei._addUID("GPshowDrawingPicto")).click()});var ti=document.createElement("span");return ti.className="GPelementHidden gpf-visible",ti.innerText="Fermer",n.appendChild(ti),_t.appendChild(n),_t},_createDrawingToolsSections:function(){var _t=[];return this.dtOptions={},this.options.tools.points&&(this.dtOptions.points={label:this.options.labels.points,active:!1,panel:"draw",id:"point"}),this.options.tools.lines&&(this.dtOptions.lines={label:this.options.labels.lines,active:!1,panel:"draw",id:"line"}),this.options.tools.polygons&&(this.dtOptions.polygons={label:this.options.labels.polygons,active:!1,panel:"draw",id:"polygon"}),this.options.tools.holes&&(this.dtOptions.holes={label:this.options.labels.holes,active:!1,panel:"draw",id:"holes"}),this.options.tools.text&&(this.dtOptions.text={label:this.options.labels.text,active:!1,panel:"draw",id:"text"}),this.options.tools.edit&&(this.dtOptions.edit={label:this.options.labels.edit,active:!1,panel:"edit",id:"edit"}),this.options.tools.display&&(this.dtOptions.display={label:this.options.labels.display,active:!1,panel:"edit",id:"display"}),this.options.tools.tooltip&&(this.dtOptions.tooltip={label:this.options.labels.tooltip,active:!1,panel:"edit",id:"tooltip"}),this.options.tools.remove&&(this.dtOptions.remove={label:this.options.labels.remove,active:!1,panel:"edit",id:"remove"}),(this.dtOptions.points||this.dtOptions.lines||this.dtOptions.polygons||this.dtOptions.text)&&_t.push(this._createDrawingToolSection(this.options.labels.creatingTools,"draw")),(this.dtOptions.edit||this.dtOptions.display||this.dtOptions.tooltip||this.dtOptions.remove)&&_t.push(this._createDrawingToolSection(this.options.labels.editingTools,"edit")),this.options.tools.export&&_t.push(this._createSavingSection(this.options.labels.export,this.options.labels.exportTitle)),_t},_createDrawingToolSection:function(_t,e){var n=document.createElement("div");n.className="drawing-tool-section fr-mx-2w";var ei=document.createElement("p");ei.className="drawing-tool-section-title",ei.innerHTML=_t,n.appendChild(ei);var ti=document.createElement("div");ti.className="drawing-tools-flex-display";var ii=this;function ri(ai){ii._handleDOMToolClick(ai,this.id,ii),ii._handleToolClick(ai,this.id,ii)}for(var ni in this.dtOptions)if(this.dtOptions[ni].panel===e){var si=document.createElement("button");si.className="drawing-tool fr-btn fr-btn--tertiary gpf-btn--tertiary",si.id=this._addUID("drawing-tool-"+this.dtOptions[ni].id),si.title=this.dtOptions[ni].label,si.addEventListener("click",ri),ti.appendChild(si)}return n.appendChild(ti),n},_createSavingSection:function(_t,e){var n=document.createElement("div");n.className="drawing-tool-section drawing-tools-flex-display fr-m-1w";var ei=document.createElement("button");ei.title=e,ei.className="tool-form-submit drawing-button fr-btn fr-btn--secondary gpf-btn--secondary fr-m-1w",ei.id=this._addUID("drawing-export"),ei.setAttribute("type","button"),ei.textContent=_t;var ti=this;return ei.onclick=function(){ti.onExportFeatureClick()},n.appendChild(ei),n},_createMarkersChooser:function(_t){var e=document.createElement("div");e.className=_t.className;var n=document.createElement("input");n.type="checkbox",n.className="gpf-custom-dropdown-toggle",n.id=this._addUID("gpf-custom-dropdown-toggle"),e.appendChild(n);var ei=document.createElement("span");ei.innerText="Slectionner le pictogramme :",e.appendChild(ei);for(var ti=0;ti<this.options.markersList.length;ti++){var ii=document.createElement("input");ii.type="radio",ii.name="gpf-dropdown-radio-style",ii.value=this.options.markersList[ti].src,ii.className="gpf-custom-dropdown-display",ii.id=this._addUID(`gpf-custom-dropdown-display-${ti}`),e.appendChild(ii),ti===0&&(ii.checked=!0);var ri=document.createElement("label");ri.htmlFor=this._addUID("gpf-custom-dropdown-toggle"),ri.className="fr-select GPselect gpf-select",e.appendChild(ri);var ni=document.createElement("img");ni.src=this.options.markersList[ti].src,ni.alt=`Option ${ti+1}`,ri.appendChild(ni)}var si=document.createElement("div");si.className="gpf-custom-dropdown-options",e.append(si);for(var ti=0;ti<this.options.markersList.length;ti++){var ai=document.createElement("label");ai.htmlFor=this._addUID(`gpf-custom-dropdown-display-${ti}`),ai.className="gpf-custom-dropdown-option",si.appendChild(ai);var oi=document.createElement("img");oi.src=this.options.markersList[ti].src,oi.alt=`Option ${ti+1}`,ai.appendChild(oi),ai.addEventListener("click",()=>{n.click()})}return e},_createStylingElement:function(_t){var e=document.createElement("div");e.className=_t.className;var n=document.createTextNode(_t.label);e.appendChild(n);var ei=document.createElement("input");try{ei.type=_t.type}catch{ei.type="text"}if(_t.type==="range"){e.dataset.frJsRange="true",e.title=_t.label;var ti=_t.defaultValue;ti=Math.round((ti-_t.min)/(_t.max-_t.min)*100),e.style.setProperty("--progress-right",ti+"%"),ei.addEventListener("change",ii=>{ii.target.parentNode.style.setProperty("--progress-right",`${(ii.target.value-_t.min)/(_t.max-_t.min)*100}%`)})}return ei.id=_t.id,ei.value=_t.defaultValue,_t.title&&(ei.title=_t.title),_t.checked!==void 0&&(ei.checked=_t.checked),_t.min!==void 0&&(ei.min=_t.min),_t.max!==void 0&&(ei.max=_t.max),_t.step!==void 0&&(ei.step=_t.step),e.appendChild(ei),e},_createStylingDiv:function(_t){var e=document.createElement("dialog");e.className="gp-styling-div gpf-panel fr-modal gpf-visible GPelementVisible";var n=document.createElement("div");if(n.className="gpf-modal__body fr-modal__body",e.appendChild(n),checkDsfr()){var ei=document.createElement("div");ei.className="GPpanelHeader gpf-panel__header fr-modal__header fr-m-1w";var ti=document.createElement("div");ti.className="GPpanelTitle gpf-panel__title fr-modal__title fr-pt-4w",ti.innerHTML="Modifier le style",ei.appendChild(ti);var ii=document.createElement("button");ii.id=this._addUID("GPdrawingStylePanelClose"),ii.className="GPpanelClose GPdrawingStylePanelClose gpf-btn gpf-btn-icon-close fr-btn--close fr-btn fr-btn--tertiary-no-outline fr-m-1w",ii.title="Fermer le panneau",ii.addEventListener?ii.addEventListener("click",function(){_t.applyFunc.call(this,"cancel")},!1):ii.attachEvent&&ii.attachEvent("onclick",function(){_t.applyFunc.call(this,"cancel")});var ri=document.createElement("span");ri.className="GPelementHidden gpf-visible",ri.innerText="Fermer",ii.appendChild(ri),ei.appendChild(ii),n.appendChild(ei)}var ni=document.createElement("div");ni.className="gpf-panel__content fr-px-3w fr-modal__content",n.appendChild(ni);var si=document.createElement("div"),ai=null,oi=_t.geomType.toLowerCase();switch(oi){case"point&text":case"point":ai=this._createMarkersChooser({className:"gp-styling-option",defaultValue:_t.initValues.markerSrc}),si.appendChild(ai),ai=this._createStylingElement({type:"range",className:"gp-styling-option fr-range fr-range--sm",label:this.options.labels.markerSize,title:"petit, moyen ou grand",id:this._addUID("markerSize"),min:5,max:15,step:5,defaultValue:_t.initValues.markerSize*10}),si.appendChild(ai),_t.initValues.markerCustom,oi==="point&text"&&(ai=this._createStylingElement({type:"checkbox",className:"gp-styling-option",label:this.options.labels.labelDisplay,id:this._addUID("labelDisplay"),checked:_t.initValues.labelDisplay,defaultValue:_t.initValues.labelDisplay}),si.appendChild(ai));break;case"text":ai=this._createStylingElement({type:"color",className:"gp-styling-option",label:this.options.labels.fillColor,id:this._addUID("fillColor"),defaultValue:_t.initValues.fillColor}),si.appendChild(ai),ai=this._createStylingElement({type:"color",className:"gp-styling-option",label:this.options.labels.strokeColor,id:this._addUID("strokeColor"),defaultValue:_t.initValues.strokeColor}),si.appendChild(ai),ai=this._createStylingElement({type:"range",className:"gp-styling-option",label:this.options.labels.strokeWidth,title:"1  10 pixels",id:this._addUID("strokeWidth"),min:1,max:10,step:1,defaultValue:_t.initValues.strokeWidth}),si.appendChild(ai);break;case"line":ai=this._createStylingElement({type:"color",className:"gp-styling-option",label:this.options.labels.strokeColor,id:this._addUID("strokeColor"),defaultValue:_t.initValues.strokeColor}),si.appendChild(ai),ai=this._createStylingElement({type:"range",className:"gp-styling-option fr-range fr-range--sm",label:this.options.labels.strokeWidth,title:"1  10 pixels",id:this._addUID("strokeWidth"),min:1,max:10,step:1,defaultValue:_t.initValues.strokeWidth}),si.appendChild(ai);break;case"polygon":ai=this._createStylingElement({type:"color",className:"gp-styling-option",label:this.options.labels.strokeColor,id:this._addUID("strokeColor"),defaultValue:_t.initValues.strokeColor}),si.appendChild(ai),ai=this._createStylingElement({type:"range",className:"gp-styling-option fr-range fr-range--sm",label:this.options.labels.strokeWidth,title:"1  10 pixels",id:this._addUID("strokeWidth"),min:1,max:10,step:1,defaultValue:_t.initValues.strokeWidth}),si.appendChild(ai),ai=this._createStylingElement({type:"color",className:"gp-styling-option",label:this.options.labels.fillColor,id:this._addUID("fillColor"),defaultValue:_t.initValues.fillColor}),si.appendChild(ai),ai=this._createStylingElement({type:"range",className:"gp-styling-option fr-range fr-range--sm",label:this.options.labels.fillOpacity,title:"0 (transparent)  100% (opaque)",id:this._addUID("fillOpacity"),min:0,max:10,step:1,defaultValue:_t.initValues.fillOpacity*10}),si.appendChild(ai);break;default:logger$u.log("Unhandled geometry type for styling.")}ni.appendChild(si);var li=document.createElement("div");li.className="gpf-flex-row",ni.appendChild(li);var ci=document.createElement("input");ci.type="button",ci.className="gp-styling-button fr-btn fr-btn--secondary",ci.value=this.options.labels.applyToObject,ci.onclick=function(){_t.applyFunc.call(this,"apply")};var ui=document.createElement("input");ui.type="button",ui.value=this.options.labels.setAsDefault,ui.className="gp-styling-button fr-btn fr-btn--tertiary",ui.onclick=function(){_t.applyFunc.call(this,"default")},li.appendChild(ui),li.appendChild(ci);var di=document.createElement("input");return di.type="button",di.className="gp-styling-button closer",di.onclick=function(){_t.applyFunc.call(this,"cancel")},ni.appendChild(di),e},_createLabelDiv:function(_t){var e=document.createElement("dialog");e.className="gp-label-div gpf-panel fr-modal gpf-visible GPelementVisible";var n=document.createElement("div");if(n.className="gpf-modal__body fr-modal__body",e.appendChild(n),checkDsfr()){var ei=document.createElement("div");ei.className="GPpanelHeader gpf-panel__header fr-modal__header fr-m-1w";var ti=document.createElement("div");ti.className="GPpanelTitle gpf-panel__title fr-modal__title fr-pt-4w",ti.innerHTML="Ajouter une description",_t.geomType==="Text"&&(ti.innerHTML="Texte de l'annotation"),ei.appendChild(ti);var ii=document.createElement("button");ii.id=this._addUID("GPdrawingStylePanelClose"),ii.className="GPpanelClose GPdrawingStylePanelClose gpf-btn gpf-btn-icon-close fr-btn--close fr-btn fr-btn--tertiary-no-outline fr-m-1w",ii.title="Fermer le panneau",ii.addEventListener?ii.addEventListener("click",function(){_t.applyFunc.call(this,"cancel")},!1):ii.attachEvent&&ii.attachEvent("onclick",function(){_t.applyFunc.call(this,"cancel")});var ri=document.createElement("span");ri.className="GPelementHidden gpf-visible",ri.innerText="Fermer",ii.appendChild(ri),ei.appendChild(ii),n.appendChild(ei)}var ni=document.createElement("div");ni.className="gpf-panel__content fr-px-3w fr-modal__content",n.appendChild(ni);var si=null;if(_t.geomType==="Text"?(si=document.createElement("input"),si.type="text",si.className="gp-input-label-style fr-input fr-mb-3w"):(si=document.createElement("textArea"),si.rows=2,si.cols=40,si.className="gp-textarea-att-label-style fr-input"),_t.text&&(si.value=_t.text),si.autocomplete="off",si.placeholder=_t.placeholder,si.id=_t.inputId,ni.appendChild(si),si.onkeyup=function(ci){_t.geomType==="Text"&&ci.keyCode===13&&_t.applyFunc.call(this,_t.key,si.value,!0),ci.keyCode===27&&_t.applyFunc.call(this,_t.key,si.value,!1)},_t.measure&&_t.geomType!=="Text"){var ai=document.createElement("input");ai.type="text",ai.readonly=!0,ai.className="gp-input-measure-style",ai.value=_t.measure,ni.appendChild(ai)}var oi=document.createElement("input");oi.type="button",oi.className="gp-styling-button fr-btn fr-btn--tertiary",oi.value=this.options.labels.saveDescription,oi.onclick=function(){_t.applyFunc.call(this,_t.key,si.value,!0)},ni.appendChild(oi);var li=document.createElement("input");return li.type="button",li.className="gp-styling-button closer",li.onclick=function(){_t.applyFunc.call(this,_t.key,si.value,!1)},ni.appendChild(li),e},_handleDOMToolClick:function(_t,e,n){for(var ei in n.dtOptions){var ti=n._addUID("drawing-tool-"+n.dtOptions[ei].id),ii=document.getElementById(ti);if(ti!==e){ii.className="drawing-tool fr-btn fr-btn--tertiary gpf-btn--tertiary",n.dtOptions[ei].active=!1;continue}n.dtOptions[ei].active?ii.className="drawing-tool fr-btn fr-btn--tertiary gpf-btn--tertiary":ii.className="drawing-tool drawing-tool-active fr-btn fr-btn--tertiary gpf-btn--tertiary",n.dtOptions[ei].active=!n.dtOptions[ei].active}}},logger$t=LoggerByDefault.getLogger("Drawing");const os=class os extends ControlExtended{constructor(e){if(e=e||{},super(e),!(this instanceof os))throw new TypeError("ERROR CLASS_CONSTRUCTOR");return this.CLASSNAME="Drawing",this._initialize(e),this._container=this._initContainer(),this.element?this.element.appendChild(this._container):this.element=this._container,this}setMap(e){super.setMap(e),this.getMap()&&this.eventKey&&unByKey(this.eventKey),e!=null&&(this.options.position&&this.setPosition(this.options.position),this.options.gutter===!1&&this.getContainer().classList.add("gpf-button-no-gutter"),this.draggable&&Draggable.dragElement(this._drawingPanel,this._drawingPanelHeader,e.getTargetElement()),this.collapsed||this._showDrawingButton.setAttribute("aria-pressed",!0),this.layer&&this.setLayer(this.layer),this.eventKey=this.getMap().getLayers().on("remove",n=>{n.element===this.layer&&(this.layer=null,this.interactionCurrent&&(this.getMap().removeInteraction(this.interactionCurrent),this.interactionCurrent=null))}))}exportFeatures(){var e=null;if(ControlExtended.prototype.getMap.call(this)==null)return logger$t.log("Impossible to export : control isn't attached to any map."),e;if(!this.layer)return logger$t.log("Impossible to export : no layer is hosting features."),e;if(!this.layer.getSource()||!this.layer.getSource().getFeatures()||!this.layer.getSource().getFeatures().length)return logger$t.log("Impossible to export : no features found."),e;this.featuresCollectionSelected&&this.featuresCollectionSelected.clear();var n=null;switch(this.getExportFormat()){case"KML":n=new KML({writeStyles:!0});break;case"GPX":n=new GPX({});break;case"GEOJSON":n=new GeoJSON({});break}if(!n)return logger$t.log("Impossible to export : format unknown !?"),e;var ei=this.layer.getSource().getProjection();return ei=ei||this.getMap().getView().getProjection(),e=n.writeFeatures(this.layer.getSource().getFeatures(),{dataProjection:"EPSG:4326",featureProjection:ei}),e}setCollapsed(e){if(e===void 0){logger$t.error("[ERROR] Drawing:setCollapsed - missing collapsed parameter");return}e&&this.collapsed||!e&&!this.collapsed||(this.onShowDrawingClick(),this._showDrawingButton.click())}setExportName(e){this._exportName=e}getExportName(){return this._exportName}setExportFormat(e){switch(this._exportFormat=e?e.toUpperCase():"KML",e.toUpperCase()){case"KML":this._exportExt=".kml",this._exportMimeType="application/vnd.google-earth.kml+xml";break;case"GPX":this._exportExt=".gpx",this._exportMimeType="application/gpx+xml";break;case"GEOJSON":this._exportExt=".geojson",this._exportMimeType="application/geo+json";break;default:this._exportFormat="KML";break}}getExportFormat(){return this._exportFormat}setLayer(e){if(!e){this.layer=null;return}if(!(e instanceof VectorLayer)){logger$t.log("no valid layer given for hosting drawn features.");return}var n=this.getMap().getLayers();if(n){var ei=!1;n.forEach(ti=>{ti===e&&(logger$t.trace("layer already in map. Not adding."),ei=!0)}),ei||(this.getMap().addLayer(e),this.dispatchEvent({type:this.ADD_AFTER_DRAWING_LAYER_EVENT,layer:e})),e.getSource().getFeatures().forEach(ti=>{var ii=ti.getStyle();if(typeof ii=="function"){var ri=ti.getStyleFunction();if(ri){var ni=ri.call(this,ti,0);ni&&ni.length!==0&&ti.setStyle(Array.isArray(ni)?ni[0]:ni)}}}),this.layer=e,this.getMap().getControls().forEach(ti=>{if(ti instanceof LayerSwitcher){var ii=this.layer.gpLayerId;ii&&ti._layers[ii].title===ii&&ti.addLayer(this.layer,{title:this.options.layerDescription.title,description:this.options.layerDescription.description})}})}}getLayer(){return this.layer}getContainer(){return this._container}disable(){var e=this.getMap();Interactions.unset(e);for(var n in this.dtOptions)if(this.dtOptions.hasOwnProperty(n)&&this.dtOptions[n].active){var ei=this._addUID("drawing-tool-"+this.dtOptions[n].id);document.getElementById(ei).className="drawing-tool fr-btn fr-btn--tertiary gpf-btn--tertiary",this.dtOptions[n].active=!1}}_getsMarkersOptionsFromSrc(e){for(var n=null,ei=0;ei<this.options.markersList.length;ei++)if(e&&this.options.markersList[ei].src===e)return n=this.options.markersList[ei],n;return n}_getIconStyleOptions(e){var n={};return Object.keys(e).forEach(ei=>{switch(ei){case"src":case"size":case"scale":case"color":case"anchor":case"anchorOrigin":case"anchorXUnits":case"anchorYUnits":n[ei]=e[ei];break}}),n}_initialize(e){this._uid=e.id||SelectorID.generate(),this._exportName="Croquis",this._exportFormat="KML",this._exportMimeType="application/vnd.google-earth.kml+xml",this._exportExt=".kml",e=e||{},this.options=e,this.options.layerDescription=Object.assign({title:"Croquis",description:"Mon croquis"},e.layerDescription),this.options.tools||(this.options.tools={}),Object.keys(os.DefaultTools).forEach(n=>{this.options.tools.hasOwnProperty(n)||(this.options.tools[n]=os.DefaultTools[n])}),this.options.cursorStyle||(this.options.cursorStyle={}),Object.keys(os.DefaultCursorStyle).forEach(n=>{this.options.cursorStyle.hasOwnProperty(n)||(this.options.cursorStyle[n]=os.DefaultCursorStyle[n])}),this.options.collapsed=e.collapsed!==void 0?e.collapsed:!0,this.collapsed=this.options.collapsed,this.options.draggable=e.draggable!==void 0?e.draggable:!1,this.draggable=this.options.draggable,this.options.markersList=e.markersList||MarkersOther.drawing_api,this.options.labels||(this.options.labels={}),Object.keys(os.DefaultLabels).forEach(n=>{this.options.labels.hasOwnProperty(n)||(this.options.labels[n]=os.DefaultLabels[n])}),this.options.defaultStyles||(this.options.defaultStyles={}),Object.keys(os.DefaultStyles).forEach(n=>{if(!e.defaultStyles.hasOwnProperty(n)){this.options.defaultStyles[n]=os.DefaultStyles[n];return}if(n==="polyFillOpacity"&&(e.defaultStyles[n]<0||e.defaultStyles[n]>1)){logger$t.log("Wrong value ("+e.defaultStyles[n]+") for defaultStyles.polyFillOpactity. Must be between 0 and 1"),this.options.defaultStyles[n]=os.DefaultStyles[n];return}if(n==="strokeWidth"||n==="polyStrokeWidth"){var ei=parseInt(e.defaultStyles[n],10);if(isNaN(ei)||ei<0){logger$t.log("Wrong value ("+e.defaultStyles[n]+") for defaultStyles.strokeWidth. Must be a positive interger value."),this.options.defaultStyles[n]=os.DefaultStyles[n];return}this.options.defaultStyles[n]=ei}if(n==="markerSize"){var ti=parseFloat(e.defaultStyles[n]);if(isNaN(ti)||ti<0){logger$t.log("Wrong value ("+e.defaultStyles[n]+") for defaultStyles.markerSize. Must be a positive value."),this.options.defaultStyles[n]=os.DefaultStyles[n];return}this.options.defaultStyles[n]=ti}}),this.interactionCurrent=null,this.interactionSelectEdit=null,this.featuresCollectionSelected=null,this.stylingOvl=null,this.popupOvl=null,this.tooltipOvl=null,this.tooltipElem=null,this.layer=null,this.options.layer&&this.options.layer instanceof VectorLayer&&(this.layer=this.options.layer),this._isDesktop=this._detectSupport(),this.options.popup||(this.options.popup={display:!0,apply:null}),this.ADD_AFTER_DRAWING_LAYER_EVENT="drawing:add:after",this.ADD_BEFORE_DRAWING_LAYER_EVENT="drawing:add:before"}_createEmptyLayer(){var e=new Collection,n=new VectorLayer({source:new VectorSource({features:e}),title:this.options.layerDescription.title,description:this.options.layerDescription.description});n.gpResultLayerId="drawing",this.dispatchEvent({type:this.ADD_BEFORE_DRAWING_LAYER_EVENT,layer:n}),this.setLayer(n)}_detectSupport(){var e=!0,n=window.navigator.userAgent.toLowerCase();return(n.indexOf("iphone")!==-1||n.indexOf("ipod")!==-1||n.indexOf("ipad")!==-1||n.indexOf("android")!==-1||n.indexOf("mobile")!==-1||n.indexOf("blackberry")!==-1||n.indexOf("tablet")!==-1||n.indexOf("phone")!==-1||n.indexOf("touch")!==-1)&&(e=!1),(n.indexOf("msie")!==-1||n.indexOf("trident")!==-1)&&(e=!0),e}_initContainer(){var e=this._createMainContainerElement(),n=this._showDrawingButton=this._createShowDrawingPictoElement();e.appendChild(n);var ei=this._drawingPanel=this._createDrawingPanelElement(),ti=this._createDrawingPanelDivElement();ei.appendChild(ti);var ii=this._drawingPanelHeader=this._createDrawingPanelHeaderElement();ti.appendChild(ii);var ri=this._createDrawingToolsDivSections();ti.appendChild(ri);for(var ni=this._createDrawingToolsSections(),si=0;si<ni.length;si++)ri.appendChild(ni[si]);var ai=this._createDrawingButtonsPluginDiv();return ri.appendChild(ai),e.appendChild(ei),e}_drawEndFeature(e,n){var ei=null;switch(n){case"Point":ei=new Style$1({image:new Icon(this._getIconStyleOptions(this.options.markersList[0]))});break;case"LineString":ei=new Style$1({stroke:new Stroke({color:this.options.defaultStyles.strokeColor,width:this.options.defaultStyles.strokeWidth})});break;case"Polygon":ei=new Style$1({fill:new Fill({color:ColorUtils.hexToRgba(this.options.defaultStyles.polyFillColor,this.options.defaultStyles.polyFillOpacity)}),stroke:new Stroke({color:this.options.defaultStyles.polyStrokeColor,width:this.options.defaultStyles.polyStrokeWidth})});break}if(e.setStyle(ei),this._updateMeasure(e,n),this.options.popup.display){var ti=this,ii=function(oi,li,ci){if(ti.getMap().removeOverlay(ti.popupOvl),ti.popupOvl=null,ci&&li&&li.trim().length>0){var ui={};ui[oi]=li.replace(/\n/g,"<br>"),e.setProperties(ui)}},ri=null,ni=!0,si=this.options.popup.function;si&&typeof si=="function"&&(ri=si.call(ti,{feature:e,geomType:n,closeFunc:function(){ii(null,!1)},saveFunc:function(oi){ii(oi,!0)}}),ri&&(ni=!1,ri.tabIndex=-1,ri.onblur=function(){ti.getMap().removeOverlay(ti.popupOvl),ti.popupOvl=null})),ni&&(ri=this._createLabelDiv({applyFunc:ii,inputId:this._addUID("att-input"),placeholder:"Saisir une description... (facultatif)",measure:this.options.tools.measure?e.getProperties().measure:null,geomType:n,key:"description"})),this.popupOvl&&(this.getMap().removeOverlay(this.popupOvl),this.popupOvl=null),this.popupOvl=new Overlay({element:ri,positioning:"top-center"}),this.getMap().addOverlay(this.popupOvl);var ai=e.getGeometry().getExtent();this.popupOvl.setPosition([(ai[0]+ai[2])/2,(ai[1]+ai[3])/2]),document.getElementById(this._addUID("att-input"))&&document.getElementById(this._addUID("att-input")).focus()}}_createRemoveInteraction(){var e=new Select({layers:[this.layer],style:!1});return e.on("select",n=>{!n||!n.selected||n.selected.length===0||(this.layer.getSource().removeFeature(n.selected[0]),this.getMap().removeInteraction(this.interactionCurrent),this.interactionCurrent=this._createRemoveInteraction(),this.getMap().addInteraction(this.interactionCurrent))}),e}_createStylingInteraction(){var e=new Select({layers:[this.layer],style:!1});return e.on("select",n=>{if(this.stylingOvl&&this.getMap().removeOverlay(this.stylingOvl),!(!n||!n.selected||n.selected.length===0)){var ei=null,ti=null,ii=null,ri=null,ni={},si=n.selected[0].getGeometry(),ai=n.selected[0].getStyle();if(si instanceof Point$1||si instanceof MultiPoint){if(ai&&ai.getImage()&&typeof ai.getImage().getSrc=="function"&&ai.getImage().getSrc()!==this.options.defaultStyles.textIcon1x1.src&&(ri="Point",typeof ai.getImage().getSrc=="function"?(ni.markerSrc=ai.getImage().getSrc(),ni.markerSize=ai.getImage().getScale()||1,ni.markerAnchor=ai.getImage().getAnchor(),ai.getImage().getColor()?(ei=ai.getImage().getColor(),Array.isArray(ei)?ei="rgba("+ei.join()+")":ni.markerColor=ei,ti=ColorUtils.isRGB(ei)?ColorUtils.rgbaToHex(ei):{hex:ei,opacity:1},ni.markerColor=ti.hex,ni.markerOpacity=ti.opacity):ni.markerColor=this.options.markersList[0].color||"#ffffff"):(ni.markerSrc=this.options.markersList[0].src,ni.markerSize=this.options.markersList[0].scale||1,ni.markerColor=this.options.markersList[0].color||"#ffffff",ni.markerAnchor=this.options.markersList[0].anchor),ni.markerCustom=!this._getsMarkersOptionsFromSrc(ni.markerSrc)),ai&&ai.getText()){var oi=n.selected[0].getProperties().name;if(oi&&(ri=ri==="Point"?"Point&Text":"Text",ai.getText().getStroke()&&ai.getText().getStroke().getColor()&&(ei=ai.getText().getStroke().getColor(),Array.isArray(ei)?ei="rgba("+ei.join()+")":ni.strokeColor=ei,ti=ColorUtils.isRGB(ei)?ColorUtils.rgbaToHex(ei):{hex:ei,opacity:1},ni.strokeColor=ti.hex,ni.strokeOpacity=ti.opacity),ai.getText().getStroke()&&ai.getText().getStroke().getWidth()&&(ni.strokeWidth=ai.getText().getStroke().getWidth()),ai.getText().getFill()&&ai.getText().getFill().getColor()&&(ei=ai.getText().getFill().getColor(),Array.isArray(ei)?ei="rgba("+ei.join()+")":ni.fillColor=ei,ti=ColorUtils.isRGB(ei)?ColorUtils.rgbaToHex(ei):{hex:ei,opacity:1},ni.fillColor=ti.hex,ni.fillOpacity=ti.opacity),ni.strokeColor=ni.hasOwnProperty("strokeColor")?ni.strokeColor:this.options.defaultStyles.textStrokeColor,ni.strokeWidth=ni.hasOwnProperty("strokeWidth")?ni.strokeWidth:this.options.defaultStyles.textStrokeWidth,ni.fillColor=ni.hasOwnProperty("fillColor")?ni.fillColor:this.options.defaultStyles.textFillColor,ri==="Point&Text")){var li=ai.getText().getText();li||ai.getText().setText(oi);var ci=n.selected[0].get("checked");ni.labelDisplay=ci===void 0?this.options.defaultStyles.labelDisplay:ci}}}else si instanceof LineString||si instanceof MultiLineString?(ri="Line",ai&&ai.getStroke()&&(ai.getStroke().getWidth()&&(ni.strokeWidth=ai.getStroke().getWidth()),ai.getStroke().getColor()&&(ei=ai.getStroke().getColor(),Array.isArray(ei)?ei="rgba("+ei.join()+")":ni.strokeColor=ei,ti=ColorUtils.isRGB(ei)?ColorUtils.rgbaToHex(ei):{hex:ei,opacity:1},ni.strokeColor=ti.hex,ni.strokeOpacity=ti.opacity)),ni.strokeWidth=ni.hasOwnProperty("strokeWidth")?ni.strokeWidth:this.options.defaultStyles.strokeWidth,ni.strokeColor=ni.hasOwnProperty("strokeColor")?ni.strokeColor:this.options.defaultStyles.strokeColor):(si instanceof Polygon||si instanceof MultiPolygon)&&(ri="Polygon",ai&&ai.getStroke()&&(ai.getStroke().getWidth()&&(ni.strokeWidth=ai.getStroke().getWidth()),ai.getStroke().getColor()&&(ei=ai.getStroke().getColor(),Array.isArray(ei)?ei="rgba("+ei.join()+")":ni.strokeColor=ei,ti=ColorUtils.isRGB(ei)?ColorUtils.rgbaToHex(ei):{hex:ei,opacity:1},ni.strokeColor=ti.hex,ni.strokeOpacity=ti.opacity)),ai&&ai.getFill()&&ai.getFill().getColor()&&(ei=ai.getFill().getColor(),Array.isArray(ei)?ei="rgba("+ei.join()+")":ni.fillColor=ei,ti=ColorUtils.isRGB(ei)?ColorUtils.rgbaToHex(ei):{hex:ei,opacity:1},ni.fillColor=ti.hex,ni.fillOpacity=ti.opacity),ni.strokeWidth=ni.hasOwnProperty("strokeWidth")?ni.strokeWidth:this.options.defaultStyles.polyStrokeWidth,ni.strokeColor=ni.hasOwnProperty("strokeColor")?ni.strokeColor:this.options.defaultStyles.polyStrokeColor,ni.fillColor=ni.hasOwnProperty("fillColor")?ni.fillColor:this.options.defaultStyles.polyFillColor,ni.fillOpacity=ni.hasOwnProperty("fillOpacity")?ni.fillOpacity:this.options.defaultStyles.polyFillOpacity);if(!ri){logger$t.log("Unhandled geometry type for styling.");return}var ui=this,di=function(hi){if(hi==="cancel"){ui.getMap().removeOverlay(ii);return}var pi=hi!=="apply",gi=document.getElementById(ui._addUID("fillColor")),vi=document.getElementById(ui._addUID("fillOpacity")),yi=document.getElementById(ui._addUID("strokeColor")),_i=document.getElementById(ui._addUID("strokeWidth")),Ai=document.getElementById(ui._addUID("markerSize"));switch(ri.toLowerCase()){case"text":pi?(ui.options.defaultStyles.textStrokeColor=yi.value,ui.options.defaultStyles.textStrokeWidth=_i.value,ui.options.defaultStyles.textFillColor=gi.value):n.selected[0].setStyle(new Style$1({text:new Text({font:"16px sans",textAlign:"left",text:ai.getText().getText(),fill:new Fill({color:gi.value}),stroke:new Stroke({color:yi.value,width:parseInt(_i.value,10)})})}));break;case"point&text":case"point":var Ei=document.querySelector("input[type='checkbox']"),Si=null,wi=parseInt(Ai.value,10)/10,Oi=document.querySelector("input[name='gpf-dropdown-radio-style']:checked");if(Oi&&(Si=ui._getsMarkersOptionsFromSrc(Oi.value),Si.scale=wi),pi){if(ui.options.defaultStyles.markerSize=wi,ui.options.markersList.length>1){var Ii=ui.options.markersList.findIndex(function(Ni){return Ni===Si});Ii>0&&(ui.options.markersList.splice(Ii,1),ui.options.markersList.splice(0,0,Si))}ri.toLowerCase()==="point&text"&&(ui.options.defaultStyles.textStrokeColor=ni.strokeColor,ui.options.defaultStyles.textStrokeWidth=ni.strokeWidth,ui.options.defaultStyles.textFillColor=ni.fillColor,ui.options.defaultStyles.labelDisplay=ni.labelDisplay)}else{var Li={};ri.toLowerCase()==="point&text"&&(n.selected[0].set("checked",Ei.checked),Li={text:new Text({font:"16px sans",textAlign:"left",text:Ei.checked?n.selected[0].get("name"):"",fill:new Fill({color:ni.fillColor}),stroke:new Stroke({color:ni.strokeColor,width:parseInt(ni.strokeWidth,10)})})}),Si?n.selected[0].setStyle(new Style$1(Object.assign({image:new Icon(ui._getIconStyleOptions(Si))},Li))):n.selected[0].setStyle(new Style$1(Object.assign({image:new Icon({src:ni.markerSrc,anchor:ni.markerAnchor,anchorOrigin:"top-left",anchorXUnits:"pixels",anchorYUnits:"pixels",scale:wi})},Li)))}break;case"line":pi?(ui.options.defaultStyles.strokeColor=yi.value,ui.options.defaultStyles.strokeWidth=parseInt(_i.value,10)):n.selected[0].setStyle(new Style$1({stroke:new Stroke({width:parseInt(_i.value,10),color:yi.value})}));break;case"polygon":var Di=parseInt(vi.value,10)/10;pi?(ui.options.defaultStyles.polyStrokeColor=yi.value,ui.options.defaultStyles.polyFillColor=gi.value,ui.options.defaultStyles.polyFillOpacity=Di,ui.options.defaultStyles.polyStrokeWidth=parseInt(_i.value,10)):n.selected[0].setStyle(new Style$1({stroke:new Stroke({width:parseInt(_i.value,10),color:yi.value}),fill:new Fill({color:ColorUtils.hexToRgba(gi.value,Di)})}));break}pi||ui.getMap().removeOverlay(ii)},fi=this._createStylingDiv({geomType:ri,initValues:ni,applyFunc:di});ii=new Overlay({element:fi,positioning:"top-center"}),this.getMap().addOverlay(ii),ii.setPosition(n.mapBrowserEvent.coordinate),this.stylingOvl=ii,this.getMap().removeInteraction(this.interactionCurrent),this.interactionCurrent=this._createStylingInteraction(),this.getMap().addInteraction(this.interactionCurrent)}}),e}_createLabelInteraction(){var e=new Select({layers:[this.layer],style:!1});return e.on("select",n=>{if(this.labelOvl&&this.getMap().removeOverlay(this.labelOvl),!(!n||!n.selected||n.selected.length===0)){var ei=null,ti=null,ii=null,ri=null,ni=n.selected[0].getGeometry(),si=n.selected[0].getStyle();if(ni instanceof Point$1||ni instanceof MultiPoint){var ai=n.selected[0].getProperties().name;si&&si.getText()&&ai?ti="Text":si&&si.getImage()&&(ti="Point")}else if(ni instanceof LineString||ni instanceof MultiLineString)ti="Line";else if(ni instanceof Polygon||ni instanceof MultiPolygon)ti="Polygon";else{logger$t.log("Geometry type for styling not supported .");return}if(!ti){logger$t.log("Unhandled geometry type for styling.");return}if(ti==="Text")ii=si.getText().getText();else{var oi=n.selected[0].getProperties();oi&&(oi.hasOwnProperty("description")||oi.hasOwnProperty("desc"))&&(ii=oi.description||oi.desc),oi&&oi.hasOwnProperty("measure")&&(ri=oi.measure)}var li=this,ci=function(di,fi,hi){if(li.getMap().removeOverlay(ei),!!hi){var pi=n.selected[0];if(ti==="Text"){var gi=pi.getStyle();gi.getText().setText(fi),pi.setProperties({name:fi}),pi.setStyle(gi);return}var vi={};vi[di]=fi.replace(/\n/g,"<br>"),pi.setProperties(vi)}},ui=this._createLabelDiv({applyFunc:ci,inputId:this._addUID("label-input"),placeholder:ti==="Text"?"Saisir un label...":"Saisir une description... (facultatif)",text:ii,key:"description",measure:this.options.tools.measure?ri:null,geomType:ti});ei=new Overlay({element:ui,positioning:"top-center"}),this.getMap().addOverlay(ei),ei.setPosition(n.mapBrowserEvent.coordinate),document.getElementById(this._addUID("label-input")).focus(),this.labelOvl=ei,this.getMap().removeInteraction(this.interactionCurrent),this.interactionCurrent=this._createLabelInteraction(),this.getMap().addInteraction(this.interactionCurrent)}}),e}_updateMeasure(e,n){logger$t.log(e);var ei=null,ti=this.getMap().getView().getProjection();function ii(_i,Ai){Ai=Ai||2;var Ei=Math.pow(10,Ai);return Math.round(_i*Ei)/Ei}var ri=n||e.getProperties().type;switch(ri){case"Point":var ni=e.getGeometry().getCoordinates(),si=transform$1(ni,ti,"EPSG:4326");ei="lon : ",ei+=ii(si[0],4)+"",ei+=" / ",ei+="lat : ",ei+=ii(si[1],4)+"";break;case"LineString":for(var ai=0,oi=e.getGeometry().getCoordinates(),li=0,ci=oi.length-1;li<ci;++li){var ui=transform$1(oi[li],ti,"EPSG:4326"),di=transform$1(oi[li+1],ti,"EPSG:4326");ai+=getDistance(ui,di)}ei=ai>1e3?ii(ai/1e3,3)+" km":ii(ai,3)+" m";break;case"Polygon":var fi=0,hi=e.getGeometry().clone(),pi=hi.getLinearRing(0).getCoordinates();fi=Math.abs(getArea$1(new Polygon([pi])));var gi=hi.getLinearRings();if(gi.length>1)for(var vi=1;vi<gi.length;vi++){var yi=gi[vi].getCoordinates();fi-=Math.abs(getArea$1(new Polygon([yi])))}ei=fi>1e6?ii(fi/1e6,3)+" km^2":ii(fi,2)+" m^2";break}e.setProperties({measure:ei,type:ri})}_handleToolClick(e,n,ei){var ti=ei.getMap();if(!ti){logger$t.trace("Drawing control not attached to any map.");return}Interactions.unset(ti,{current:"Drawing"}),ei.interactionCurrent&&(ti.removeInteraction(ei.interactionCurrent),ei.interactionCurrent=null),ei.interactionSelectEdit&&(ti.removeInteraction(ei.interactionSelectEdit),ei.interactionSelectEdit=null),ei.popupOvl&&(ei.getMap().removeOverlay(ei.popupOvl),ei.popupOvl=null),ei.stylingOvl&&(ei.getMap().removeOverlay(ei.stylingOvl),ei.stylingOvl=null),ei.tooltipOvl&&(ei.getMap().removeOverlay(ei.tooltipOvl),ei.tooltipOvl=null),this.layer||this._createEmptyLayer();const ii=ni=>{if(ni.dragging||!ei.tooltipOvl)return;const si=ni.coordinate;ei.tooltipOvl.setPosition(si)},ri=()=>{ei.tooltipOvl&&(ei.getMap().removeOverlay(ei.tooltipOvl),ei.tooltipOvl=null)};switch(n){case this._addUID("drawing-tool-point"):ei.dtOptions.points.active&&(ei.interactionCurrent=new Draw({stopClick:!0,source:ei.layer.getSource(),style:new Style$1({image:new Icon(this._getIconStyleOptions(this.options.markersList[0]))}),type:"Point"}),ei.interactionCurrent.on("drawend",function(ni){ei._drawEndFeature(ni.feature,"Point")},ei));break;case this._addUID("drawing-tool-line"):ei.dtOptions.lines.active&&(ei.interactionCurrent=new Draw({stopClick:!0,source:ei.layer.getSource(),style:new Style$1({image:new CircleStyle({radius:this.options.cursorStyle.radius,stroke:new Stroke({color:this.options.cursorStyle.strokeColor,width:this.options.cursorStyle.strokeWidth}),fill:new Fill({color:this.options.cursorStyle.fillColor})}),stroke:new Stroke({color:this.options.defaultStyles.strokeColor,width:this.options.defaultStyles.strokeWidth})}),type:"LineString",handleMoveEvent:ii}),ei.tootlTipElem||(ei.tootlTipElem=document.createElement("div"),ei.tootlTipElem.className="gpf-draw-linestring-tooltip"),ei.tootlTipElem.innerText="Double-cliquer pour terminer",ei.tooltipOvl=new Overlay({element:ei.tootlTipElem,positioning:"top-right"}),ei.interactionCurrent.on("drawend",function(ni){ei._drawEndFeature(ni.feature,"LineString"),ri()},ei),ei.interactionCurrent.on("drawabort",ri,ei));break;case this._addUID("drawing-tool-polygon"):ei.dtOptions.polygons.active&&(ei.interactionCurrent=new Draw({stopClick:!0,source:ei.layer.getSource(),style:new Style$1({image:new CircleStyle({radius:this.options.cursorStyle.radius,stroke:new Stroke({color:this.options.cursorStyle.strokeColor,width:this.options.cursorStyle.strokeWidth}),fill:new Fill({color:this.options.cursorStyle.fillColor})}),stroke:new Stroke({color:this.options.defaultStyles.polyStrokeColor,width:this.options.defaultStyles.polyStrokeWidth}),fill:new Fill({color:ColorUtils.hexToRgba(this.options.defaultStyles.polyFillColor,this.options.defaultStyles.polyFillOpacity)})}),type:"Polygon",handleMoveEvent:ii}),ei.tootlTipElem||(ei.tootlTipElem=document.createElement("div"),ei.tootlTipElem.className="gpf-draw-linestring-tooltip"),ei.tootlTipElem.innerText="Double-cliquer pour terminer",ei.tooltipOvl=new Overlay({element:ei.tootlTipElem,positioning:"top-right"}),ei.interactionCurrent.on("drawend",function(ni){ei._drawEndFeature(ni.feature,"Polygon"),ri()},ei),ei.interactionCurrent.on("drawabort",ri,ei));break;case this._addUID("drawing-tool-holes"):ei.dtOptions.holes.active&&(ei.interactionSelectEdit=new Select({stopClick:!0,condition:pointerMove,layers:[this.layer]}),ei.interactionSelectEdit.setProperties({name:"Drawing",source:ei}),ti.addInteraction(ei.interactionSelectEdit),ei.interactionCurrent=new Draw({stopClick:!0,features:this.interactionSelectEdit.getFeatures(),style:new Style$1({image:new CircleStyle({radius:this.options.cursorStyle.radius,stroke:new Stroke({color:this.options.cursorStyle.strokeColor,width:this.options.cursorStyle.strokeWidth}),fill:new Fill({color:this.options.cursorStyle.fillColor})}),stroke:new Stroke({color:this.options.defaultStyles.polyStrokeColor,width:this.options.defaultStyles.polyStrokeWidth}),fill:new Fill({color:ColorUtils.hexToRgba(this.options.defaultStyles.polyFillColor,this.options.defaultStyles.polyFillOpacity)})}),type:"Polygon"}),ei.interactionCurrent.on("drawstart",function(ni){},ei),ei.interactionCurrent.on("drawend",function(ni){var si=ei.interactionSelectEdit.getFeatures();if(si.getLength()){for(var ai=si.item(0),oi=ni.feature.getGeometry().getCoordinates()[0],li=!0,ci=0;ci<oi.length;ci++)if(!ai.getGeometry().intersectsCoordinate(oi[ci])){li=!1;break}if(!li)return;ai.getGeometry().appendLinearRing(new LinearRing(oi)),ni.feature=ai,ei._drawEndFeature(ni.feature,"Polygon")}},ei));break;case this._addUID("drawing-tool-text"):ei.dtOptions.text.active&&(ei.interactionCurrent=new Draw({stopClick:!0,source:ei.layer.getSource(),style:new Style$1({image:new CircleStyle({radius:this.options.cursorStyle.radius,stroke:new Stroke({color:this.options.cursorStyle.strokeColor,width:this.options.cursorStyle.strokeWidth}),fill:new Fill({color:this.options.cursorStyle.fillColor})})}),type:"Point"}),ei.interactionCurrent.on("drawend",ni=>{var si=function(oi,li,ci){if(ei.getMap().removeOverlay(ei.popupOvl),ei.popupOvl=null,!ci||!li){ei.layer.getSource().removeFeature(ni.feature);return}var ui={};ui[oi]=li,ni.feature.setProperties(ui),ni.feature.setStyle(new Style$1({image:new Icon(ei._getIconStyleOptions(ei.options.defaultStyles.textIcon1x1)),text:new Text({textAlign:"left",font:"16px sans",text:li,fill:new Fill({color:ei.options.defaultStyles.textFillColor}),stroke:new Stroke({color:ei.options.defaultStyles.textStrokeColor,width:3})})}))},ai=this._createLabelDiv({applyFunc:si,inputId:ei._addUID("label-input"),geomType:"Text",key:"name",placeholder:"Saisir un label..."});ei.popupOvl&&ei.popupOvl.element.querySelector(".gp-styling-button.closer").click(),ei.popupOvl=new Overlay({element:ai,positioning:"top-center"}),ei.getMap().addOverlay(ei.popupOvl),ei.popupOvl.setPosition(ni.feature.getGeometry().getCoordinates()),document.getElementById(ei._addUID("label-input")).focus()}));break;case this._addUID("drawing-tool-edit"):ei.dtOptions.edit.active&&(this.featuresCollectionSelected=new Collection,ei.interactionSelectEdit=new Select({condition:singleClick,layers:[this.layer],features:this.featuresCollectionSelected}),ei.interactionSelectEdit.on("select",ni=>{}),ei.interactionSelectEdit.setProperties({name:"Drawing",source:ei}),ti.addInteraction(ei.interactionSelectEdit),ei.interactionCurrent=new Modify({stopClick:!0,features:this.interactionSelectEdit.getFeatures(),style:new Style$1({image:new CircleStyle({radius:this.options.cursorStyle.radius,stroke:new Stroke({color:this.options.cursorStyle.strokeColor,width:this.options.cursorStyle.strokeWidth}),fill:new Fill({color:this.options.cursorStyle.fillColor})})})}),ei.interactionCurrent.on("modifyend",ni=>{var si=ni.features.item(0);ei._updateMeasure(si)}));break;case this._addUID("drawing-tool-display"):ei.dtOptions.display.active&&(ei.interactionCurrent=this._createStylingInteraction());break;case this._addUID("drawing-tool-tooltip"):ei.dtOptions.tooltip.active&&(ei.interactionCurrent=this._createLabelInteraction());break;case this._addUID("drawing-tool-remove"):ei.dtOptions.remove.active&&(ei.interactionCurrent=ei._createRemoveInteraction());break;default:logger$t.trace("unhandled tool type")}ei.interactionCurrent&&(ei.interactionCurrent.setProperties({name:"Drawing",source:this}),ti.addInteraction(ei.interactionCurrent),ei.tooltipOvl&&ti.addOverlay(ei.tooltipOvl)),logger$t.log("interactions",ti.getInteractions())}onShowDrawingClick(e){var n=this._showDrawingButton.ariaPressed;n==="true"?this.onPanelOpen():this.popupOvl&&this.getMap().removeOverlay(this.popupOvl),this.disable(),this.collapsed=n!=="true",this.dispatchEvent("change:collapsed"),this.options.position&&!this.collapsed&&this.updatePosition(this.options.position)}onExportFeatureClick(){var e=this.exportFeatures();if(e){var n=document.createElement("a"),ei="utf-8";if(n.setAttribute("href","data:"+this._exportMimeType+";charset="+ei+","+encodeURIComponent(e)),n.setAttribute("download",this.getExportName()+this._exportExt),document.createEvent){var ti=document.createEvent("MouseEvents");ti.initEvent("click",!0,!0),n.dispatchEvent(ti)}else n.click()}}};qr(os,"DefaultTools",{points:!0,lines:!0,polygons:!0,holes:!1,text:!0,remove:!0,display:!0,tooltip:!0,edit:!0,export:!0,measure:!1}),qr(os,"DefaultLabels",{control:"Annoter la carte",creatingTools:"Crer",points:"Placer des points",lines:"Dessiner des lignes",polygons:"Dessiner des polygones",holes:"Crer des trous sur un polygone",text:"Ecrire sur la carte",editingTools:"diter",edit:"Editer les tracs",display:"Modifier l'apparence des objets",tooltip:"Modifier les textes / infos-bulles",remove:"Supprimer des objets",export:"Exporter",exportTitle:"Exporter en KML",applyToObject:"Appliquer  l'objet",saveDescription:"Enregistrer",setAsDefault:"Dfinir par dfaut",strokeColor:"Couleur du trait : ",strokeWidth:"Epaisseur du trait : ",fillColor:"Couleur de remplissage : ",fillOpacity:"Opacit du remplissage : ",markerSize:"Taille du pictogramme : ",markerColor:"Couleur du pictogramme : ",labelDisplay:"Afficher le label : "}),qr(os,"DefaultStyles",{textFillColor:"#000000",textStrokeColor:"#FFFFFF",textStrokeWidth:6,textIcon1x1:{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR4nGNiYAAAAAkAAxkR2eQAAAAASUVORK5CYII=",anchor:[0,0]},polyFillColor:"#000091",polyFillOpacity:.7,polyStrokeColor:"#000091",polyStrokeWidth:4,strokeColor:"#FF7F00",strokeWidth:4,markerSize:1,markerColor:"#ffcc33",labelDisplay:!0}),qr(os,"DefaultCursorStyle",{radius:6,strokeColor:"#FFF",strokeWidth:1,fillColor:"rgba(0, 153, 255, 1)"});let Drawing=os;Object.assign(Drawing.prototype,DrawingDOM);Object.assign(Drawing.prototype,Widget);window.ol&&window.ol.control&&(window.ol.control.Drawing=Drawing);var logger$s=LoggerByDefault.getLogger("LocationSelectorDOM"),LocationSelectorDOM={_addUID:function(_t){var e=this._uid?_t+"-"+this._uid:_t;return e},_createMainContainerElement:function(){var _t=document.createElement("div");return _t.className=this._addUID("GPlocationPoint"),_t.className+=" GPwidget gpf-widget ",_t},_createLocationPointElement:function(_t,e){var n=document.createElement("div");return n.id=this._addUID("GPlocationPoint_"+_t),n.className=e?"GPflexInput GPlocationStageFlexInput gpf-flex":"GPflexInput GPelementHidden gpf-flex gpf-hidden",n.style.cssText="",n},_createLocationPointLabelElement:function(_t,e){var n=this,ei=document.createElement("button");return ei.id=this._addUID("GPlocationOriginLabel_"+_t),ei.innerHTML=e,ei.className="GPlocationOriginLabel gpf-btn gpf-btn-icon-label fr-btn fr-btn--secondary gpf-btn--secondary",ei.setAttribute("type","button"),ei.addEventListener("click",function(ti){for(var ii=SelectorID.index(this.id),ri=document.getElementsByClassName(n._addUID("GPlocationPoint")),ni=0;ni<ri.length;ni++){var si=ri[ni].childNodes[0].id,ai=SelectorID.index(si);document.getElementById(n._addUID("GPlocationPoint_"+ai)).style.cssText=""}document.getElementById(n._addUID("GPlocationOriginCoords_"+ii)).value="",document.getElementById(n._addUID("GPlocationOrigin_"+ii)).value="",document.getElementById(n._addUID("GPlocationPoint_"+ii)).style.cssText="",document.getElementById(n._addUID("GPlocationOriginPointer_"+ii)).checked=!1,document.getElementById(n._addUID("GPlocationOrigin_"+ii)).className="GPelementShow gpf-show  gpf-input fr-input",document.getElementById(n._addUID("GPlocationOriginCoords_"+ii)).className="GPelementHidden gpf-hidden",document.getElementById(n._addUID("GPlocationStageRemove_"+ii))&&(document.getElementById(n._addUID("GPlocationStageRemove_"+ii)).className="GPlocationStageRemove gpf-btn gpf-btn-icon-remove fr-btn--sm fr-btn--secondary gpf-btn--secondary"),document.getElementById(n._addUID("GPlocationStageAdd"))&&(document.getElementById(n._addUID("GPlocationStageAdd")).className="GPlocationStageAdd gpf-btn gpf-btn-icon-add fr-btn--sm fr-btn--secondary gpf-btn--secondary fr-mt-2w"),n.onLocationClearPointClick(ti)}),ei},_createLocationAutoCompleteteInputElement:function(_t){var e=this,n=document.createElement("input");return n.id=this._addUID("GPlocationOrigin_"+_t),n.className="GPelementShow gpf-show gpf-input fr-input",n.type="text",n.placeholder="Saisir une adresse, un lieu...",n.autocomplete="off",n.addEventListener("keyup",function(ei){var ti=ei.which||ei.keyCode;if(!(ti===13||ti===10||ti===38||ti===40)){var ii=SelectorID.index(this.id);document.getElementById(e._addUID("GPlocationOrigin_"+ii)).value.length>2?(document.getElementById(e._addUID("GPlocationAutoCompleteList_"+ii)).classList.replace("GPelementHidden","GPelementVisible"),document.getElementById(e._addUID("GPlocationAutoCompleteList_"+ii)).classList.replace("gpf-hidden","gpf-visible")):(document.getElementById(e._addUID("GPlocationAutoCompleteList_"+ii)).classList.replace("GPelementVisible","GPelementHidden"),document.getElementById(e._addUID("GPlocationAutoCompleteList_"+ii)).classList.replace("gpf-visible","gpf-hidden")),e.onAutoCompleteSearchText(ei)}}),n.addEventListener("keydown",function(ei){var ti=ei.which||ei.keyCode,ii=document.getElementById(e._addUID("GPlocationAutoCompleteResult_"+_t));if(ii){var ri=ii.getElementsByClassName("GPautoCompleteProposal current"),ni=ii.getElementsByClassName("GPautoCompleteProposal"),si=ni.length;if(si){var ai=null;if(ri.length)ai=ri[0];else{ai=ni[0],ai.className="GPautoCompleteProposal current",ai.style.color="#000000",ai.style["background-color"]="#CEDBEF";return}var oi=parseInt(SelectorID.index(ai.id),10),li=oi===si-1?ni[0]:ni[oi+1],ci=oi===0?ni[si-1]:ni[oi-1];switch(ai.style["background-color"]="",ai.style.color="",ci.style["background-color"]="",ci.style.color="",li.style["background-color"]="",li.style.color="",ti){case 38:logger$s.log("arrow up"),ai.className="GPautoCompleteProposal",ci.className="GPautoCompleteProposal current",ci.style.color="#000000",ci.style["background-color"]="#CEDBEF";break;case 40:logger$s.log("arrow down"),ai.className="GPautoCompleteProposal",li.className="GPautoCompleteProposal current",li.style.color="#000000",li.style["background-color"]="#CEDBEF";break;case 13:logger$s.log("enter"),ai.click(ei);break}ai.focus()}}}),n},_createLocationCoordinateInputElement:function(_t){var e=this,n=document.createElement("input");return n.id=this._addUID("GPlocationOriginCoords_"+_t),n.className="GPelementHidden gpf-input gpf-hidden fr-input",n.type="text",n.disabled=!1,n.addEventListener("click",function(){var ei=SelectorID.index(this.id);document.getElementById(e._addUID("GPlocationOriginLabel_"+ei)).click()}),n},_createLocationPointerShowInputElement:function(_t){var e=document.createElement("input");return e.id=this._addUID("GPlocationOriginPointer_"+_t),e.className="GPelementHidden gpf-hidden",e.type="checkbox",e},_createLocationPointerInputElement:function(_t){var e=this,n=document.createElement("button");return n.id=this._addUID("GPlocationOriginPointerImg_"+_t),n.htmlFor=this._addUID("GPlocationOriginPointer_"+_t),n.className="GPlocationOriginPointerImg gpf-btn gpf-btn-icon-pointer fr-btn",n.title="Pointer un lieu sur la carte",n.setAttribute("type","button"),n.addEventListener("click",function(ei){ei.preventDefault(),ei.stopPropagation();var ti=SelectorID.index(this.id),ii=document.getElementsByClassName(e._addUID("GPlocationPoint")),ri,ni,si;for(ri=0;ri<ii.length;ri++)ni=ii[ri].childNodes[0].id,si=SelectorID.index(ni),ti!==si&&(document.getElementById(e._addUID("GPlocationOriginPointer_"+si)).checked=!1,document.getElementById(e._addUID("GPlocationOriginCoords_"+si)).value==="Pointer un lieu sur la carte"&&(document.getElementById(e._addUID("GPlocationOriginCoords_"+si)).value="",document.getElementById(e._addUID("GPlocationOrigin_"+si)).className="GPelementShow gpf-show  gpf-input fr-input",document.getElementById(e._addUID("GPlocationOriginCoords_"+si)).className="GPelementHidden gpf-hidden"));if(document.getElementById(e._addUID("GPlocationOriginPointer_"+ti)).checked){for(document.getElementById(e._addUID("GPlocationOriginCoords_"+ti)).value="",ri=0;ri<ii.length;ri++)ni=ii[ri].childNodes[0].id,si=SelectorID.index(ni),document.getElementById(e._addUID("GPlocationPoint_"+si)).style.cssText="";document.getElementById(e._addUID("GPlocationStageRemove_"+ti))&&(document.getElementById(e._addUID("GPlocationStageRemove_"+ti)).className="GPlocationStageRemove  gpf-btn gpf-btn-icon-remove fr-btn--sm fr-btn--secondary gpf-btn--secondary"),document.getElementById(e._addUID("GPlocationStageAdd"))&&(document.getElementById(e._addUID("GPlocationStageAdd")).className="GPlocationStageAdd gpf-btn gpf-btn-icon-add fr-btn--sm fr-btn--secondary gpf-btn--secondary fr-mt-2w"),document.getElementById(e._addUID("GPlocationOriginPointer_"+ti)).checked=!1,document.getElementById(e._addUID("GPlocationOrigin_"+ti)).className="GPelementShow gpf-show  gpf-input fr-input",document.getElementById(e._addUID("GPlocationOriginCoords_"+ti)).className="GPelementHidden gpf-hidden"}else{for(document.getElementById(e._addUID("GPlocationOriginCoords_"+ti)).value="Pointer un lieu sur la carte",ri=0;ri<ii.length;ri++)ni=ii[ri].childNodes[0].id,si=SelectorID.index(ni),ti===si?document.getElementById(e._addUID("GPlocationPoint_"+si)).style.cssText="":document.getElementById(e._addUID("GPlocationPoint_"+si)).style.display="none";document.getElementById(e._addUID("GPlocationStageRemove_"+ti))&&(document.getElementById(e._addUID("GPlocationStageRemove_"+ti)).className="GPelementHidden gpf-hidden"),document.getElementById(e._addUID("GPlocationStageAdd"))&&(document.getElementById(e._addUID("GPlocationStageAdd")).className="GPelementHidden gpf-hidden"),document.getElementById(e._addUID("GPlocationOriginPointer_"+ti)).checked=!0,document.getElementById(e._addUID("GPlocationOrigin_"+ti)).className="GPelementHidden gpf-hidden",document.getElementById(e._addUID("GPlocationOriginCoords_"+ti)).className="GPelementShow gpf-show gpf-input fr-input",document.getElementById(e._addUID("GPlocationOriginCoords_"+ti)).disabled=!0}e.onActivateMapPointClick(ei)}),n},_createLocationRemovePointElement:function(_t){var e=this,n=document.createElement("button");return n.id=this._addUID("GPlocationStageRemove_"+_t),n.className="GPlocationOpen GPlocationStageRemove gpf-btn gpf-btn-icon-remove fr-btn--sm fr-btn--secondary gpf-btn--secondary",n.title="Supprimer l'tape",n.setAttribute("tabindex","0"),n.setAttribute("aria-pressed",!1),n.setAttribute("type","button"),n.addEventListener("click",function(ei){var ti=ei.target.ariaPressed==="true";ei.target.setAttribute("aria-pressed",!ti);var ii=document.getElementsByClassName(e._addUID("GPlocationPoint")),ri=ii.length-1,ni=ii[0].childNodes[0].id,si=ii[ri].childNodes[0].id,ai=SelectorID.index(ni),oi=SelectorID.index(si);if(_t!==ai&&_t!==oi){var li=SelectorID.index(this.id);document.getElementById(e._addUID("GPlocationPoint_"+li)).className="GPflexInput GPelementHidden gpf-flex gpf-hidden",document.getElementById(e._addUID("GPlocationOrigin_"+li)).value="",document.getElementById(e._addUID("GPlocationOrigin_"+li)).className="GPelementShow gpf-show gpf-input fr-input",document.getElementById(e._addUID("GPlocationOriginCoords_"+li)).value="",document.getElementById(e._addUID("GPlocationOriginCoords_"+li)).className="GPelementHidden gpf-hidden",document.getElementById(e._addUID("GPlocationStageAdd")).style.display="",document.getElementById(e._addUID("GPlocationPoint_"+li)).parentElement.previousSibling.classList.add("GPelementHidden","gpf-hidden"),e.onLocationRemovePointClick(ei)}}),n},_createLocationAddPointElement:function(){var _t=this,e=document.createElement("button");return e.id=this._addUID("GPlocationStageAdd"),e.className="GPlocationOpen GPlocationStageAdd gpf-btn gpf-btn-icon-add fr-btn--sm fr-btn--secondary gpf-btn--secondary fr-mt-2w",e.title="Ajouter une tape",checkDsfr()&&(e.innerText="Ajouter une tape"),e.setAttribute("tabindex","0"),e.setAttribute("aria-pressed",!1),e.setAttribute("type","button"),e.addEventListener("click",function(n){for(var ei=1,ti=0,ii=document.getElementsByClassName(_t._addUID("GPlocationPoint")),ri=1;ri<ii.length-1;ri++){var ni=ii[ri].childNodes[0].id,si=SelectorID.index(ni);document.getElementById(_t._addUID("GPlocationPoint_"+si))&&(document.getElementById(_t._addUID("GPlocationPoint_"+si)).className==="GPflexInput GPelementHidden gpf-flex gpf-hidden"?ei===1&&(ei=si):ti++)}ei<ii.length&&(document.getElementById(_t._addUID("GPlocationPoint_"+ei)).className="GPflexInput GPlocationStageFlexInput gpf-flex",document.getElementById(_t._addUID("GPlocationPoint_"+ei)).parentElement.previousSibling.classList.remove("GPelementHidden","gpf-hidden")),ti===4&&(document.getElementById(_t._addUID("GPlocationStageAdd")).style.display="none");var ai=n.target.ariaPressed==="true";n.target.setAttribute("aria-pressed",!ai),_t.onLocationAddPointClick(n)}),e},_createLocationAutoCompleteElement:function(_t){var e=document.createElement("div");return e.id=this._addUID("GPlocationAutoCompleteList_"+_t),e.className="GPlocationAutoCompleteList GPelementHidden gpf-panel gpf-hidden fr-modal",e},_createLocationAutoCompleteResultElement:function(_t){var e=this,n=document.createElement("div");return n.id=this._addUID("GPlocationAutoCompleteResult_"+_t),n.className="GPadvancedAutoCompleteResult gpf-panel__list",n.addEventListener?n.addEventListener("click",function(ei){e.onAutoCompletedResultsItemClick(ei),document.getElementById(e._addUID("GPlocationAutoCompleteList_"+_t)).classList.replace("GPelementHidden","GPelementVisible"),document.getElementById(e._addUID("GPlocationAutoCompleteList_"+_t)).classList.replace("gpf-hidden","gpf-visible")},!1):n.attachEvent&&n.attachEvent("onclick",function(ei){e.onAutoCompletedResultsItemClick(ei),document.getElementById(e._addUID("GPlocationAutoCompleteList_"+_t)).classList.replace("GPelementHidden","GPelementVisible"),document.getElementById(e._addUID("GPlocationAutoCompleteList_"+_t)).classList.replace("gpf-hidden","gpf-visible")}),n},_createLocationAutoCompletedLocationElement:function(_t,e,n){var ei=document.getElementById(this._addUID("GPlocationAutoCompleteResult_"+_t)),ti=document.createElement("div");ti.id=this._addUID("AutoCompletedLocation_"+n),ti.className="GPautoCompleteProposal gpf-panel__items",ti.title=GeocodeUtils.getSuggestedLocationFreeform(e),ti.innerHTML=GeocodeUtils.getSuggestedLocationFreeform(e),ei.appendChild(ti)},GPdisplayCoordinate:function(_t){for(var e=document.getElementsByClassName(this._addUID("GPlocationPoint")),n=0;n<e.length;n++){var ei=e[n].childNodes[0].id,ti=SelectorID.index(ei);if(document.getElementById(this._addUID("GPlocationOriginPointer_"+ti)).checked){document.getElementById(this._addUID("GPlocationOriginCoords_"+ti)).value=_t,document.getElementById(this._addUID("GPlocationOriginCoords_"+ti)).disabled=!1;for(var ii=0;ii<e.length;ii++){ei=e[ii].childNodes[0].id;var ri=SelectorID.index(ei);document.getElementById(this._addUID("GPlocationPoint_"+ri)).style.cssText="",document.getElementById(this._addUID("GPlocationStageRemove_"+ri))&&(document.getElementById(this._addUID("GPlocationStageRemove_"+ri)).className="GPlocationStageRemove gpf-btn gpf-btn-icon-remove fr-btn--sm fr-btn--secondary gpf-btn--secondary")}document.getElementById(this._addUID("GPlocationOriginPointer_"+ti)).checked=!1,document.getElementById(this._addUID("GPlocationStageAdd"))&&(document.getElementById(this._addUID("GPlocationStageAdd")).className="GPlocationStageAdd gpf-btn gpf-btn-icon-add fr-btn--sm");return}}}},logger$r=LoggerByDefault.getLogger("locationselector");class LocationSelector extends Control{constructor(e){if(e=e||{},super({element:e.element||document.createElement("div"),render:e.render,target:e.target}),!(this instanceof LocationSelector))throw new TypeError("ERROR CLASS_CONSTRUCTOR");return this.CLASSNAME="LocationSelector",this.initialize(e),this._container=this._initContainer(),this.element?this.element.appendChild(this._container):this.element=this._container,this}initialize(e){this.options={tag:{id:1,groupId:null,label:">",display:!0,addOption:!1,removeOption:!1},displayInfo:!0,autocompleteOptions:{}},Helper.mergeParams(this.options,e),this._uid=this.options.tag.groupId||SelectorID.generate(),this._map=null,this._inputsContainer=null,this._buttonLabel=null,this._inputAutoComplete=null,this._inputShowPointerContainer=null,this._inputShowPointer=null,this._inputCoordinateContainer=null,this._addPointElement=null,this._removePointElement=null,this._coordinate=null,this._suggestedContainer=null,this._suggestedList=null,this._suggestedLocations=[],this._currentLocation=null,this._initMarker(),this._resources={},this.listenerKey=null}_initMarker(){if(this._marker=null,this._markerUrl="",this._markerOffset=[0,0],this.options.tag.markerOpts&&this.options.tag.markerOpts.url){this._markerUrl=this.options.tag.markerOpts.url;var e=this.options.tag.markerOpts.offset;e&&(Array.isArray(e)&&e.length===2?this._markerOffset=e:logger$r.log("markerOpts.offset should be an array. e.g. : [0,0]"))}else this._markerUrl=Marker.lightOrange,this._markerOffset=Marker.defaultOffset}getCoordinate(){return this._coordinate}setCoordinate(e,n){var ei=this.getMap(),ti=ei.getView().getProjection().getCode();n||(n=ti),this._setCoordinate(e,n),e=transform$1(e,n,ti),this._setMarker([e[0],e[1]],null,!1)}clear(){this.clearResults(),this._buttonLabel.click()}clearResults(){this._currentLocation=null,this._coordinate=null,this._hideSuggestedLocation(),this._clearSuggestedLocation(),this._setMarker(),unByKey(this.listenerKey)}_initContainer(){var e=this.options.tag.id,n=this._createMainContainerElement(),ei=this._inputsContainer=this._createLocationPointElement(e,this.options.tag.display);n.appendChild(ei);var ti=this._buttonLabel=this._createLocationPointLabelElement(e,this.options.tag.label);ei.appendChild(ti);var ii=this._inputAutoComplete=this._createLocationAutoCompleteteInputElement(e);ii.addEventListener?ii.addEventListener("click",()=>this.onAutoCompleteInputClick()):ii.attachEvent&&ii.attachEvent("onclick",()=>this.onAutoCompleteInputClick()),ei.appendChild(ii);var ri=this._inputCoordinateContainer=this._createLocationCoordinateInputElement(e);ei.appendChild(ri);var ni=this._inputShowPointerContainer=this._createLocationPointerShowInputElement(e);ei.appendChild(ni);var si=this._inputShowPointer=this._createLocationPointerInputElement(e);if(ei.appendChild(si),this.options.tag.addOption){var ai=this._addPointElement=this._createLocationAddPointElement();ei.appendChild(ai)}if(this.options.tag.removeOption){var oi=this._removePointElement=this._createLocationRemovePointElement(e);ei.appendChild(oi)}var li=this._suggestedContainer=this._createLocationAutoCompleteElement(e),ci=this._suggestedList=this._createLocationAutoCompleteResultElement(e);return li.appendChild(ci),n.appendChild(li),n}onAutoCompleteInputClick(){this._inputAutoComplete&&this._inputAutoComplete.value.length>2&&this._displaySuggestedLocation()}onAutoCompleteSearchText(e){var n=e.target.value;if(n){var ei=this.options.autocompleteOptions||{},ti=ei.onSuccess||null,ii=ei.onFailure||null;if(this._currentLocation=n,n.length<3){this._clearSuggestedLocation();return}var ri=this;this._requestAutoComplete({text:n,maximumResponses:5,onSuccess:function(si){if(si){var ai=si.suggestedLocations;ri._fillAutoCompletedLocationListContainer(ai),ti&&ti.call(this,si)}},onFailure:function(si){ri._clearSuggestedLocation(),logger$r.log(si.message),ii&&ii.call(this,si)}});var ni=this.getMap();ni.on("click",()=>this._hideSuggestedLocation()),ni.on("pointerdrag",()=>this._hideSuggestedLocation())}}onAutoCompletedResultsItemClick(e){var n=SelectorID.index(e.target.id);if(n){var ei=[this._suggestedLocations[n].position.x,this._suggestedLocations[n].position.y];this._coordinate=ei;var ti={type:this._suggestedLocations[n].type,fields:this._suggestedLocations[n]},ii=GeocodeUtils.getSuggestedLocationFreeform(this._suggestedLocations[n]);this._setLabel(ii);var ri=this.getMap().getView(),ni=ri.getProjection().getCode();ni!=="EPSG:4326"&&(ei=transform$1(ei,"EPSG:4326",ni)),this._setPosition(ei),this._setMarker(ei,ti,this.options.displayInfo)}}onActivateMapPointClick(){var e=this.getMap();this._inputShowPointerContainer.checked?(this.clearResults(),this.listenerKey=e.on("click",n=>this.onMouseMapClick(n)),this._setCursor("crosshair")):(unByKey(this.listenerKey),this._setCursor())}onLocationClearPointClick(){this._setCursor(),this.clearResults()}onLocationRemovePointClick(){this._setCursor(),this.clearResults()}onLocationAddPointClick(e){logger$r.log("onRouteAddPointClick",e)}onMouseMapClick(e){var n=e.coordinate;if(!(!e.map||!e.map.getView())){var ei=e.map.getView().getProjection();this._setCoordinate(n,ei),this._setMarker([n[0],n[1]],null,!1),this.onActivateMapPointClick(e)}}_setLabel(e){this._inputAutoComplete.value=e}_setCursor(e){var n=this.getMap(),ei=n.getTargetElement();e?ei.style.cursor=e:ei.style.cursor=null}_setCoordinate(e,n){this._coordinate=transform$1(e,n,"EPSG:4326");var ei=this._coordinate[0].toFixed(4),ti=this._coordinate[1].toFixed(4),ii=ti+" / "+ei;this.GPdisplayCoordinate(ii)}_setPosition(e){var n=this.getMap().getView();n.setCenter(e)}_setMarker(e,n,ei){var ti=this.getMap();if(this._marker!=null&&(ti.removeOverlay(this._marker),this._marker=null),e){var ii=document.createElement("img");ii.src=this._markerUrl,this._marker=new Overlay({position:e,offset:this._markerOffset,element:ii,stopEvent:!1}),ti.addOverlay(this._marker),ei&&logger$r.log("marker information : ",n)}}_clearSuggestedLocation(){if(this._suggestedLocations=[],this._suggestedList)for(;this._suggestedList.firstChild;)this._suggestedList.removeChild(this._suggestedList.firstChild)}_hideSuggestedLocation(){this._suggestedContainer&&(this._suggestedContainer.classList.replace("GPelementVisible","GPelementHidden"),this._suggestedContainer.classList.replace("gpf-visible","gpf-hidden"))}_displaySuggestedLocation(){this._suggestedContainer&&(this._suggestedContainer.classList.replace("GPelementHidden","GPelementVisible"),this._suggestedContainer.classList.replace("gpf-hidden","gpf-visible"))}_requestAutoComplete(e){if(logger$r.log("_requestAutoComplete()",e),!(!e||Object.keys(e).length===0)&&e.text){logger$r.log(e);var n={};Helper.assign(n,this.options.autocompleteOptions),Helper.assign(n,e);var ei=this._resources.AutoCompletion||null;ei&&Array.isArray(ei)&&(n.filterOptions||(n.filterOptions={}),n.filterOptions.type=ei),n.apiKey=n.apiKey||this.options.apiKey,typeof n.ssl!="boolean"&&(typeof this.options.ssl=="boolean"?n.ssl=this.options.ssl:n.ssl=!0),logger$r.log(n),Gp.Services.autoComplete(n)}}_fillAutoCompletedLocationListContainer(e){if(!(!e||e.length===0)){var n=this._suggestedList;if(n.childElementCount)for(;n.firstChild;)n.removeChild(n.firstChild);for(var ei=0;ei<e.length;ei++)this._createLocationAutoCompletedLocationElement(this.options.tag.id,e[ei],ei);this._suggestedLocations=e}}}Object.assign(LocationSelector.prototype,LocationSelectorDOM);window.ol&&window.ol.control&&(window.ol.control.LocationSelector=LocationSelector);var ExportDOM={_addUID:function(_t){var e=this.uid?_t+"-"+this.uid:_t;return e}},logger$q=LoggerByDefault.getLogger("export");class ButtonExport extends Control{constructor(e){if(e=e||{layer:null,control:null,target:null,format:"geojson",name:"export",description:"export",title:"Exporter",kind:"secondary",menu:!1,icons:{menu:" ",button:""},callback:null},logger$q.trace("[constructor] Export",e),super({element:document.createElement("div"),render:e.render,target:null}),!(this instanceof ButtonExport))throw new TypeError("ERROR CLASS_CONSTRUCTOR");this.CLASSNAME="Export",this.EXPORT_ROUTE={},this.EXPORT_ISOCHRON={},this.EXPORT_PROFILE={},this.uid=e.id||SelectorID.generate(),this.extension=null,this.mimeType=null,this.container=null,this.button=null,this.buttonOptions=null,this.inputName=null,this.inputDesc=null,this.menu=null,this.menuClassHidden="GPelementHidden gpf-hidden",this.initOptions(e),this.initContainer(),this.BUTTON_EXPORT_CLICKED_EVENT="button:clicked"}render(){if(!this.options.target&&this.options.control){var e=this.options.control.getContainer(),n=e.querySelector(".container-buttons-plugin");this.options.target=n||e.lastChild}this.container&&this.options.target.appendChild(this.container)}initOptions(e){this.options={layer:null,control:null,target:null,download:!0,format:"geojson",name:"export",description:"export",title:"Exporter",kind:"secondary",direction:"row",menu:!1,menuOptions:{above:!1,outside:!1,labelName:!0,labelDesc:!0,selectFormat:!0},icons:{menu:" ",button:"export"},callback:null};var n=Helper.assign(this.options.icons,e.icons),ei=Helper.assign(this.options.menuOptions,e.menuOptions);Helper.assign(this.options,e),Helper.assign(this.options.icons,n),Helper.assign(this.options.menuOptions,ei),logger$q.debug(this.options),this.options.layer,this.options.control,this.options.target;var ti=this.options.format;ti?this.setFormat(ti):this.setFormat(""),this.options.name||this.setName("export"),this.options.description||this.setDescription("export"),this.options.title||this.setTitle("Exporter"),this.options.kind||this.setKind("secondary"),this.options.menu===void 0&&this.setMenu(!1)}initContainer(){var e=this.options.title;this.options.menu&&(e=this.options.icons.menu+this.options.title);var n=document.createElement("div");n.id=this._addUID("GPexportContainer"),n.className="GPexportMenuContainer gpf-export-menu-container gpf-export-menu-container-row-reverse",this.options.direction==="column"&&n.classList.replace("gpf-export-menu-container-row-reverse","gpf-export-menu-container-column-reverse");var ei=this.stringToHTML(`
            <div class="GPexportMenuHidden gpf-accordion fr-accordion ${this.menuClassHidden}">
                <h3 class="gpf-accordion__title fr-accordion__title">
                    <button type="button" 
                        id="GPexportBtnMenuContent-${this.uid}"
                        class="gpf-accordion__btn fr-accordion__btn" 
                        aria-expanded="false" aria-controls="GPexportMenuContent-${this.uid}">options</button>
                </h3>
                <div id="GPexportMenuContent-${this.uid}"
                    class="GPexportMenuContent fr-collapse fr-mx-2w">
                    <div id="GPexportMenuName-${this.uid}" 
                        class="GPexportMenuName">
                        <label class="GPlabel gpf-label fr-label" for="GPexportMenuInputName-${this.uid}" title="Nom">Nom</label>
                        <input type="text" id="GPexportMenuInputName-${this.uid}" class="GPinput gpf-input fr-input">
                    </div>
                    <div id="GPexportMenuDesc-${this.uid}"
                        class="GPexportMenuDesc">
                        <label class="GPlabel gpf-label fr-label" for="GPexportMenuInputDesc-${this.uid}" title="Description">Description</label>
                        <input type="text" id="GPexportMenuInputDesc-${this.uid}" class="GPinput gpf-input fr-input">
                    </div>
                    <div id="GPexportMenuFormat-${this.uid}">
                        <label class="GPlabel gpf-label fr-label" title="Formats">Formats</label>
                        <div class="GPexportMenuFormat fr-radio-group fr-m-1w">
                            <input type="radio" 
                                id="GPmenuFormatGeojson-${this.uid}"
                                name="format" 
                                value="geojson">
                            <label class="fr-label container" for="GPmenuFormatGeojson-${this.uid}">GeoJSON
                                <span class="checkmark"></span>
                            </label>
                        </div>
                        <div class="GPexportMenuFormat fr-radio-group fr-m-1w">
                            <input type="radio" 
                                id="GPmenuFormatKml-${this.uid}"
                                name="format" 
                                value="kml">
                            <label class="fr-label container" for="GPmenuFormatKml-${this.uid}">KML
                                <span class="checkmark"></span>
                            </label>
                        </div>
                        <div class="GPexportMenuFormat fr-radio-group fr-m-1w">
                            <input type="radio" 
                                id="GPmenuFormatGpx-${this.uid}"
                                name="format" 
                                value="gpx">
                            <label class="fr-label container" for="GPmenuFormatGpx-${this.uid}">GPX
                                <span class="checkmark"></span>
                            </label>
                        </div>
                    </div>
                    <div id="GPexportMenuButtons-${this.uid}" 
                        class="GPexportMenuButtons">
                        <button 
                            type="button"
                            id="GPexportMenuButtonValidate-${this.uid}" 
                            class="GPexportMenuButtonValidate GPsubmit gpf-btn gpf-btn-icon-export-validate fr-btn fr-btn--secondary fr-m-1w">
                            Valider
                        </button>
                        <button 
                            type="button"
                            id="GPexportMenuButtonCancel-${this.uid}" 
                            class="GPexportMenuButtonIconCancel GPsubmit gpf-btn gpf-btn-icon-export-cancel fr-btn fr-btn--secondary fr-m-1w">
                            Annuler
                        </button>
                    </div>
                </div>
            </div>
        `);if(this.menu=ei.firstChild,this.menu){if(this.options.menu){var ti=this.menu.className;this.menu.className=ti.replace(this.menuClassHidden,"")}var ii=this.options.format.toUpperCase(),ri=this.menu.querySelectorAll('input[type=radio][name="format"]');for(let pi=0;pi<ri.length;pi++){var ni=ri[pi];ni.id.toUpperCase().includes(ii)&&(ni.checked=!0),ni.addEventListener("change",gi=>this.onChangeRadioFormat(gi))}this.buttonOptions=this.menu.querySelector("#GPexportBtnMenuContent-"+this.uid),this.buttonOptions&&this.buttonOptions.addEventListener("click",pi=>this.onClickButtonToggleOptions(pi)),this.inputName=this.menu.querySelector("#GPexportMenuInputName-"+this.uid),this.inputDesc=this.menu.querySelector("#GPexportMenuInputDesc-"+this.uid),this.inputName.addEventListener("change",pi=>this.onChangeInputName(pi)),this.inputName.addEventListener("focusin",pi=>this.onFocusInputName(pi)),this.inputDesc.addEventListener("change",pi=>this.onChangeInputDesc(pi)),this.inputDesc.addEventListener("focusin",pi=>this.onFocusInputDesc(pi));var si=this.menu.querySelector("#GPexportMenuButtonValidate-"+this.uid);si.addEventListener("click",pi=>this.onClickButtonValidate(pi));var ai=this.menu.querySelector("#GPexportMenuButtonCancel-"+this.uid);if(ai.addEventListener("click",pi=>this.onClickButtonCancel(pi)),this.options.menuOptions){if(this.options.menuOptions.outside){this.menu.classList.remove("gpf-accordion","fr-accordion");var oi=this.menu.querySelector("#GPexportBtnMenuContent-"+this.uid);oi.classList.add("gpf-hidden");var li=this.menu.querySelector("#GPexportMenuContent-"+this.uid);li.classList.remove("fr-collapse");var ci=this.menu.querySelector("#GPexportMenuButtons-"+this.uid);ci.classList.add("gpf-hidden")}if(this.options.menuOptions.above&&(n.classList.replace("gpf-export-menu-container-row-reverse","gpf-export-menu-container-row"),n.classList.replace("gpf-export-menu-container-column-reverse","gpf-export-menu-container-column")),!this.options.menuOptions.labelName){var ui=this.menu.querySelector("#GPexportMenuName-"+this.uid);ui.classList.add("gpf-hidden")}if(!this.options.menuOptions.labelDesc){var di=this.menu.querySelector("#GPexportMenuDesc-"+this.uid);di.classList.add("gpf-hidden")}if(!this.options.menuOptions.selectFormat){var fi=this.menu.querySelector("#GPexportMenuFormat-"+this.uid);fi.classList.add("gpf-hidden")}}}n.appendChild(this.menu);var hi=this.stringToHTML(`
            <button 
                type="button"
                id="${this._addUID("GPexportButton")}" 
                class="GPexportButtonExportIcon GPsubmit gpf-btn gpf-btn-icon-export-submit fr-btn fr-m-1w">
                ${e}
            </button>
        `);switch(this.button=hi.firstChild,this.button&&this.button.addEventListener("click",pi=>this.onClickButtonExport(pi)),this.options.kind){case"tertiary":this.button.classList.add("fr-btn--tertiary","gpf-btn--tertiary");break;case"secondary":this.button.classList.add("fr-btn--secondary","gpf-btn--secondary");break;case"primary":default:this.button.classList.add("fr-btn--primary","gpf-btn--primary");break}if(!this.options.icons.button)this.button.classList.remove("GPexportButtonExportIcon","gpf-btn-icon-export-submit");else switch(this.options.icons.button){case"export":break;case"save":this.button.classList.replace("GPexportButtonExportIcon","GPexportButtonSaveIcon"),this.button.classList.replace("gpf-btn-icon-export-submit","gpf-btn-icon-save-submit");break;default:this.button.classList.remove("GPexportButtonExportIcon","gpf-btn-icon-export-submit");break}n.appendChild(this.button),this.container=n}stringToHTML(e){var n=function(){if(!window.DOMParser)return!1;var ri=new DOMParser;try{ri.parseFromString("x","text/html")}catch{return!1}return!0};if(n()){var ei=new DOMParser,ti=ei.parseFromString(e,"text/html");return ti.body}var ii=document.createElement("div");return ii.innerHTML=e,ii}isPluggableControl(){return!!(this.options.control&&typeof this.options.control.getContainer=="function"&&typeof this.options.control.getLayer=="function")}exportFeatures(e,n,ei){var ti=null;if(!e)return logger$q.warn("Impossible to export : no layer is hosting features."),ti;if(!e.getSource()||!e.getSource().getFeatures()||!e.getSource().getFeatures().length)return logger$q.warn("Impossible to export : no features found."),ti;e.getSource().getFeatures().forEach(oi=>{var li=oi.getStyle();!li&&this.options.control&&typeof this.options.control.getStyle=="function"&&oi.setStyle(this.options.control.getStyle())});var ii={defaultStyle:ei,extensions:{}};n&&(ii.extensions={"geoportail:compute":n}),this.options.description&&(ii.extensions.description=this.inputDesc&&this.inputDesc.value?this.inputDesc.value:this.options.description);var ri=null;switch(this.options.format.toUpperCase()){case"KML":ii.writeStyles=!0,ii.showPointNames=!0,ri=new KML(ii);break;case"GPX":ri=new GPX(ii);break;case"GEOJSON":ri=new GeoJSON(ii);break}if(!ri)return logger$q.warn("Impossible to export : format unknown !?"),ti;var ni=e.getSource().getProjection(),si=this.getMap();si&&(ni=ni||si.getView().getProjection());var ai=e.getSource().getFeatures();return ti=ri.writeFeatures(ai,{dataProjection:"EPSG:4326",featureProjection:ni||"EPSG:3857"}),ti}onClickButtonExport(e){this.isPluggableControl()||logger$q.warn("Componant not pluggable with the control !");var n=this.options.control&&this.options.control.getLayer!==void 0?this.options.control.getLayer():this.options.layer,ei=this.options.control&&this.options.control.getData!==void 0?this.options.control.getData():{},ti=this.options.control&&this.options.control.getStyle!==void 0?this.options.control.getStyle():{},ii=this.exportFeatures(n,ei,ti);if(!(!ii||ii==="null")){if(this.dispatchEvent({type:this.BUTTON_EXPORT_CLICKED_EVENT,content:ii,name:this.options.name,description:this.options.description,format:this.options.format,layer:n}),this.options.download){var ri=document.createElement("a"),ni="utf-8";if(ri.setAttribute("href","data:"+this.mimeType+";charset="+ni+","+encodeURIComponent(ii)),ri.setAttribute("download",this.options.name+this.extension),document.createEvent){var si=document.createEvent("MouseEvents");si.initEvent("click",!0,!0),ri.dispatchEvent(si)}else ri.click()}this.options.callback&&typeof this.options.callback=="function"&&this.options.callback(ii,n)}}onChangeRadioFormat(e){this.setFormat(e.target.value)}onChangeInputName(e){this.setName(e.target.value)}onFocusInputName(e){var n=this.getMap();n&&this.options.control&&typeof this.options.control.disable=="function"&&this.options.control.disable()}onChangeInputDesc(e){this.setDescription(e.target.value)}onFocusInputDesc(e){var n=this.getMap();n&&this.options.control&&typeof this.options.control.disable=="function"&&this.options.control.disable()}onClickButtonToggleOptions(e){e.target.ariaExpanded=e.target.ariaExpanded!=="true";var n=this.menu.querySelector("#"+e.target.getAttribute("aria-controls"));n&&(e.target.ariaExpanded==="true"?(n.classList.add("fr-collapse--expanded"),this.menu.classList.add("gpf-full-container"),this.menu.classList.add("gpf-accordion--opened"),n.classList.remove("GPelementHidden")):(n.classList.remove("fr-collapse--expanded"),this.menu.classList.remove("gpf-full-container"),this.menu.classList.remove("gpf-accordion--opened"),n.classList.add("GPelementHidden")))}onClickButtonValidate(e){this.setName(this.inputName.value),this.setDescription(this.inputDesc.value),this.buttonOptions.click()}onClickButtonCancel(e){this.inputName.value="",this.inputDesc.value="",this.buttonOptions.click()}getContainer(){return this.container}setControl(e){this.options.control=e}setTarget(e){this.options.target=e}setFormat(e){switch(this.options.format=e.toUpperCase(),this.options.format){case"KML":this.extension=".kml",this.mimeType="application/vnd.google-earth.kml+xml";break;case"GPX":this.extension=".gpx",this.mimeType="application/gpx+xml";break;case"GEOJSON":this.extension=".geojson",this.mimeType="application/geo+json";break;default:this.options.format="GEOJSON",this.extension=".geojson",this.mimeType="application/geo+json";break}}setName(e){this.options.name=e}setDescription(e){this.options.description=e}setTitle(e){this.options.title=e,this.button&&(this.button.textContent=this.options.menu?this.options.icons.menu+e:e)}setKind(e){if(this.options.kind=e,this.button)switch(this.button.classList.remove("fr-btn--tertiary","gpf-btn--tertiary"),this.button.classList.remove("fr-btn--secondary","gpf-btn--secondary"),this.options.kind){case"tertiary":this.button.classList.add("fr-btn--tertiary","gpf-btn--tertiary");break;case"secondary":this.button.classList.add("fr-btn--secondary","gpf-btn--secondary");break;case"primary":default:this.button.classList.add("fr-btn--primary","gpf-btn--primary");break}}setMenu(e){if(this.options.menu=e,this.button&&(this.button.textContent=this.options.menu?this.options.icons.menu+this.options.title:this.options.title),this.menu&&this.options.menu){var n=this.menu.className;this.menu.className=n.replace(this.menuClassHidden,"");var ei=this.options.format.toUpperCase(),ti=this.menu.querySelectorAll('input[type=radio][name="format"]');for(let ri=0;ri<ti.length;ri++){var ii=ti[ri];ii.id.toUpperCase().includes(ei)&&(ii.checked=!0)}}}setMenuOptions(e){}setLayer(e){this.options.layer=e}setDownload(e){this.options.download=e}}Object.assign(ButtonExport.prototype,ExportDOM);Object.assign(ButtonExport.prototype,Widget);window.ol&&window.ol.control&&(window.ol.control.Export=ButtonExport);var logger$p=LoggerByDefault.getLogger("RouteDOM"),RouteDOM={_addUID:function(_t){var e=this._uid?_t+"-"+this._uid:_t;return e},_createMainContainerElement:function(){var _t=document.createElement("div");return _t.id=this._addUID("GProute"),_t.className="GPwidget gpf-widget gpf-widget-button gpf-mobile-fullscreen",_t},_createShowRoutePictoElement:function(){var _t=this,e=document.createElement("button"),n=document.createElement("span");return e.appendChild(n),e.id=this._addUID("GPshowRoutePicto"),e.classList.add("GPshowOpen","GPshowAdvancedToolPicto","GPshowRoutePicto"),e.classList.add("gpf-btn","gpf-btn--tertiary","gpf-btn-icon","gpf-btn-icon-route"),e.classList.add("fr-btn","fr-btn--tertiary"),e.setAttribute("aria-label","Itinraire"),e.setAttribute("tabindex","0"),e.setAttribute("aria-pressed",!1),e.setAttribute("type","button"),e.addEventListener?e.addEventListener("click",function(ei){var ti=ei.target.ariaPressed==="true";ei.target.setAttribute("aria-pressed",!ti),_t.onShowRoutePanelClick(ei)}):e.attachEvent&&e.attachEvent("onclick",function(ei){var ti=ei.target.ariaPressed==="true";ei.target.setAttribute("aria-pressed",!ti),_t.onShowRoutePanelClick(ei)}),e},_createRoutePanelElement:function(){var _t=document.createElement("dialog");return _t.id=this._addUID("GProutePanel"),_t.className="GPpanel gpf-panel fr-modal",_t},_createRoutePanelDivElement:function(){var _t=document.createElement("div");return _t.className="gpf-panel__body fr-modal__body",_t},_createDrawingButtonsPluginDiv:function(){var _t=document.createElement("div");return _t.className="container-buttons-plugin fr-mx-2w",_t},_createRoutePanelHeaderElement:function(){var _t=this,e=document.createElement("div");e.className="GPpanelHeader gpf-panel__header fr-modal__header";var n=document.createElement("div");n.className="GPpanelTitle gpf-panel__title fr-modal__title fr-pt-4w",n.innerHTML="Calcul d'itinraire",e.appendChild(n);var ei=document.createElement("button");ei.id=this._addUID("GProutePanelClose"),ei.className="GPpanelClose GProutePanelClose gpf-btn gpf-btn-icon-close fr-btn--close fr-btn fr-btn--tertiary-no-outline fr-m-1w",ei.title="Masquer le panneau",ei.addEventListener?ei.addEventListener("click",function(){document.getElementById(_t._addUID("GPshowRoutePicto")).click()},!1):ei.attachEvent&&ei.attachEvent("onclick",function(){document.getElementById(_t._addUID("GPshowRoutePicto")).click()});var ti=document.createElement("span");return ti.className="GPelementHidden gpf-visible",ti.innerText="Fermer",ei.appendChild(ti),e.appendChild(ei),e},_createRoutePanelFooterElement:function(){var _t=document.createElement("div");return _t.className="GPpanelFooter gpf-panel__footer fr-modal__footer",_t},_createRoutePanelFormPointLabel:function(_t,e=!0){var n=document.createElement("p");n.innerHTML=_t;var ei=e?"":" GPelementHidden gpf-hidden";return n.className="GProutePointLabelP gpf-label fr-label"+ei,n},_createRoutePanelFormElement:function(){var _t=this,e=document.createElement("form");return e.id=this._addUID("GProuteForm"),e.className="gpf-panel__content fr-modal__content",e.setAttribute("onkeypress","return event.keyCode != 13;"),e.addEventListener("submit",function(n){logger$p.log(n),n.preventDefault();var ei=document.getElementsByClassName(_t._addUID("GPlocationPoint")),ti=ei[0].childNodes[0].id,ii=ei[ei.length-1].childNodes[0].id,ri=SelectorID.index(ti),ni=SelectorID.index(ii);if(document.getElementById(_t._addUID("GPlocationOrigin_"+ri)).value===""&&document.getElementById(_t._addUID("GPlocationOriginCoords_"+ri)).value===""||document.getElementById(_t._addUID("GPlocationOrigin_"+ni)).value===""&&document.getElementById(_t._addUID("GPlocationOriginCoords_"+ni)).value==="")return!1;_t._addRouteResultsStagesValuesElement(ei);var si=null;document.getElementById(_t._addUID("GProuteComputationChoice"))&&(document.getElementById(_t._addUID("GProuteComputationFastest"))&&document.getElementById(_t._addUID("GProuteComputationFastest")).checked&&(si=document.getElementById(_t._addUID("GProuteComputationFastest")).value),document.getElementById(_t._addUID("GProuteComputationShortest"))&&document.getElementById(_t._addUID("GProuteComputationShortest")).checked&&(si=document.getElementById(_t._addUID("GProuteComputationShortest")).value));var ai=null;document.getElementById(_t._addUID("GProuteTransportCar"))&&document.getElementById(_t._addUID("GProuteTransportCar")).checked&&(ai=document.getElementById(_t._addUID("GProuteTransportCar")).value),document.getElementById(_t._addUID("GProuteTransportPedestrian"))&&document.getElementById(_t._addUID("GProuteTransportPedestrian")).checked&&(ai=document.getElementById(_t._addUID("GProuteTransportPedestrian")).value);for(var oi=[],li=document.getElementsByClassName("GProuteExclusionsOption"),ci=0;ci<li.length;ci++){var ui=li[ci].htmlFor,di=document.getElementById(ui);di.checked||oi.push(di.value)}return _t.onRouteComputationSubmit({computation:si,transport:ai,exclusions:oi}),!1}),e},_createRoutePanelResultsElement:function(){var _t=document.createElement("div");return _t.id=this._addUID("GProuteResultsPanel"),_t.className="GPelementHidden gpf-hidden",_t.appendChild(this._createRouteResultsStagesElement()),_t.appendChild(this._createRouteResultsElement()),_t.appendChild(this._createRouteShowResultsDetailsElement()),_t.appendChild(this._createRouteResultsDetailsElement()),_t},_createRouteWaitingElement:function(){var _t=document.createElement("div");_t.id=this._addUID("GProuteCalcWaitingContainer"),_t.className="GPwaitingContainer GPwaitingContainerHidden gpf-waiting gpf-waiting--hidden";var e=document.createElement("p");return e.className="GPwaitingContainerInfo gpf-waiting_info",e.innerHTML="Recherche en cours...",_t.appendChild(e),_t},_createRouteResultsStagesElement:function(){var _t=document.createElement("div");return _t.id=this._addUID("GProuteResultsStages"),_t},_addRouteResultsStagesValuesElement:function(_t){document.getElementById(this._addUID("GProuteResultsStages")).innerHTML="";for(var e=0;e<_t.length;e++){var n=_t[e].childNodes[0].id,ei=SelectorID.index(n);if(document.getElementById(this._addUID("GPlocationPoint_"+ei)).className==="GPflexInput GPlocationStageFlexInput gpf-flex"){var ti=document.createElement("div");ti.className="GProuteResultsStages fr-my-1w";var ii=document.createElement("span");ii.className="GProuteResultStageLabel",ii.innerHTML=document.getElementById(this._addUID("GPlocationOriginLabel_"+ei)).innerHTML+" : ",ti.appendChild(ii);var ri=document.createElement("span");ri.className="GProuteResultStageValue";var ni=document.getElementById(this._addUID("GPlocationOriginCoords_"+ei)),si=ni.value;si!==null&&si!==""?ri.innerHTML=si:ri.innerHTML=document.getElementById(this._addUID("GPlocationOrigin_"+ei)).value,ti.appendChild(ri),ri.innerHTML!==""&&document.getElementById(this._addUID("GProuteResultsStages")).appendChild(ti)}}},_createRouteResultsElement:function(){var _t=this,e=document.createElement("div");e.id=this._addUID("GProuteResults");var n=document.createElement("div");n.id=this._addUID("GProuteResultsValues"),e.appendChild(n);var ei=document.createElement("div");ei.id=this._addUID("GProuteResultsMode");var ti=document.createElement("select");ti.id=this._addUID("GProuteResultsComputationSelect"),ti.className="GPselect gpf-select fr-select",ti.addEventListener("change",function(ai){_t.onRouteModeComputationChangeAndRun(ai)});for(var ii=[{code:"fastest",label:"Plus rapide"},{code:"shortest",label:"Plus court"}],ri=0;ri<ii.length;ri++){var ni=document.createElement("option");ni.value=ii[ri].code,ni.text=ii[ri].label,ti.appendChild(ni)}ei.appendChild(ti),e.appendChild(ei);var si=document.createElement("div");return si.id=this._addUID("GProuteResultsNew"),si.className="GPresetPicto gpf-btn gpf-btn-icon-reset fr-btn fr-btn--secondary gpf-btn--secondary",si.title="Modifier le calcul",si.addEventListener("click",function(ai){document.getElementById(_t._addUID("GProuteResultsPanel")).className="GPelementHidden gpf-hidden",document.getElementById(_t._addUID("GProuteForm")).className="gpf-panel__content fr-modal__content",_t.onShowRouteResultsNewClick(ai)}),e.appendChild(si),e},_addRouteResultsValuesElement:function(_t,e,n){var ei=document.getElementById(this._addUID("GProuteResultsValues"));if(ei.childElementCount)for(;ei.firstChild;)ei.removeChild(ei.firstChild);var ti=document.createElement("div");ti.className="GProuteResultsValue";var ii=document.createElement("label");ii.className="GProuteResultsValueLabel",ii.innerHTML="Distance :",ti.appendChild(ii);var ri=0,ni=parseInt(_t/1e3,10);if(!ni)ri=Math.round(_t)+" m";else{var si=Math.round(_t);si=si/1e3,ri=si+" km"}var ai=document.createElement("div");ai.id=this._addUID("GProuteResultsValueDist"),ai.innerHTML=ri,ti.appendChild(ai),ei.appendChild(ti);var oi=document.createElement("div");oi.className="GProuteResultsValue";var li=document.createElement("label");li.className="GProuteResultsValueLabel",li.innerHTML="Dure :",oi.appendChild(li);var ci=document.createElement("div");return ci.id=this._addUID("GProuteResultsValueDist"),ci.innerHTML=n(e),oi.appendChild(ci),ei.appendChild(oi),ei},_createRouteShowResultsDetailsElement:function(){var _t=document.createElement("div");if(_t.className="GProuteResultsShowDetailsDiv gpf-flex fr-checkbox-group fr-m-1w",!checkDsfr()){var e=document.createElement("div");e.className="GPfakeBorder GPfakeBorderLeft",_t.appendChild(e)}var n=document.createElement("input");n.id=this._addUID("GProuteResultsShowDetails"),n.type="checkbox",_t.appendChild(n);var ei=document.createElement("label");if(ei.className="gpf-label fr-label",ei.htmlFor=this._addUID("GProuteResultsShowDetails"),ei.innerHTML="Afficher le dtail",_t.appendChild(ei),!checkDsfr()){var ti=document.createElement("label");ti.htmlFor=this._addUID("GProuteResultsShowDetails"),ti.innerHTML="Masquer le dtail",_t.appendChild(ti);var ii=document.createElement("div");ii.className="GPfakeBorder",_t.appendChild(ii)}return _t},_createRouteResultsDetailsElement:function(){var _t=document.createElement("div");return _t.id=this._addUID("GProuteResultsDetails"),_t},_addRouteResultsDetailsElement:function(_t,e){var n=this,ei=document.getElementById(this._addUID("GProuteResultsDetails"));if(ei.childElementCount)for(;ei.firstChild;)ei.removeChild(ei.firstChild);for(var ti=0,ii=0,ri=0;ri<_t.length;ri++){var ni=ri+1,si=_t[ri],ai=document.createElement("div");ai.className="GProuteResultsDetailsNumber",ai.innerHTML=ni+".",ei.appendChild(ai),ii+=parseFloat(si.duration),ti+=parseFloat(si.distance);var oi=0,li=parseInt(ti/1e3,10);if(!li)oi=Math.round(ti)+" m";else{var ci=Math.round(ti);ci=ci/1e3,oi=ci+" km"}var ui=document.createElement("div");ui.className="GProuteResultsDetailsInstruction",ui.id=this._addUID("GProuteResultsDetailsInstruction_"+ni),ui.title="distance : "+oi+" / temps : "+e(ii),ui.innerHTML=si.instruction,ui.addEventListener("mouseover",function(di){n.onRouteResultsDetailsMouseOver(di)}),ui.addEventListener("mouseout",function(di){n.onRouteResultsDetailsMouseOut(di)}),ui.addEventListener("click",function(di){typeof n.onRouteResultsDetailsClick=="function"&&n.onRouteResultsDetailsClick(di)}),ei.appendChild(ui)}return ei},_createRoutePanelFormPointElement:function(_t,e,n){var ei=this,ti=document.createElement("div");ti.id="GProutePoint"+_t,ti.className=n?"GPflexInput GProuteStageFlexInput":"GPflexInput GProuteStageFlexInputHidden";var ii=document.createElement("label");ii.id="GProuteOriginLabel"+_t,ii.htmlFor="GProuteOrigin"+_t,ii.innerHTML=e,ii.addEventListener("click",function(){var oi=this.id.charAt(this.id.length-1);document.getElementById("GProuteOriginCoords"+oi).value="";for(var li=1;li<8;li++)document.getElementById("GProutePoint"+li).style.display="flex";document.getElementById("GProuteForm").className="gpf-panel__content fr-modal__content",document.getElementById("GProuteOriginPointer"+oi).checked=!1,document.getElementById("GProuteOrigin"+oi).className="GPelementVisible gpf-visible",document.getElementById("GProuteOriginCoords"+oi).className="GPelementHidden gpf-hidden"}),ti.appendChild(ii);var ri=document.createElement("input");ri.id="GProuteOrigin"+_t,ri.className="GPelementVisible gpf-visible",ri.type="text",ri.placeholder="Saisir une adresse, un lieu...",ri.addEventListener("keyup",function(oi){var li=oi.which||oi.keyCode;if(!(li===13||li===10)){var ci=this.id.charAt(this.id.length-1);document.getElementById("GProuteOrigin"+ci).value.length>2?document.getElementById("GProuteAutoCompleteList"+ci).style.display="block":document.getElementById("GProuteAutoCompleteList"+ci).style.display="none",ei.onAutoCompleteSearchText(oi)}}),ri.addEventListener("blur",function(){var oi=this.id.charAt(this.id.length-1);document.getElementById("GProuteAutoCompleteList"+oi).style.display="none"}),ti.appendChild(ri);var ni=document.createElement("input");ni.id="GProuteOriginCoords"+_t,ni.className="GPelementHidden gpf-hidden",ni.type="text",ni.disabled=!0,ti.appendChild(ni);var si=document.createElement("input");si.id="GProuteOriginPointer"+_t,si.type="checkbox",ti.appendChild(si);var ai=document.createElement("label");return ai.id="GProuteOriginPointerImg"+_t,ai.htmlFor="GProuteOriginPointer"+_t,ai.className="GProuteOriginPointerImg",ai.title="Pointer un lieu sur la carte",ai.addEventListener("click",function(oi){oi.preventDefault(),oi.stopPropagation();var li=this.id.charAt(this.id.length-1),ci;for(ci=1;ci<8;ci++)li!==ci&&(document.getElementById("GProuteOriginPointer"+ci).checked=!1,document.getElementById("GProuteOriginCoords"+ci).value==="Pointer un lieu sur la carte"&&(document.getElementById("GProuteOriginCoords"+ci).value="",document.getElementById("GProuteOrigin"+ci).className="GPelementVisible gpf-visible",document.getElementById("GProuteOriginCoords"+ci).className="GPelementHidden gpf-hidden"));if(document.getElementById("GProuteOriginPointer"+li).checked){for(document.getElementById("GProuteOriginCoords"+li).value="",ci=1;ci<8;ci++)document.getElementById("GProutePoint"+ci).style.display="flex";document.getElementById("GProuteForm").className="gpf-panel__content fr-modal__content",document.getElementById("GProuteOriginPointer"+li).checked=!1,document.getElementById("GProuteOrigin"+li).className="GPelementVisible gpf-visible",document.getElementById("GProuteOriginCoords"+li).className="GPelementHidden gpf-hidden"}else{for(document.getElementById("GProuteOriginCoords"+li).value="Pointer un lieu sur la carte",ci=1;ci<8;ci++)li===ci?document.getElementById("GProutePoint"+ci).style.display="flex":document.getElementById("GProutePoint"+ci).style.display="none";document.getElementById("GProuteForm").className="GProuteFormMini gpf-panel__content fr-modal__content",document.getElementById("GProuteOriginPointer"+li).checked=!0,document.getElementById("GProuteOrigin"+li).className="GPelementHidden gpf-hidden",document.getElementById("GProuteOriginCoords"+li).className="GPelementVisible gpf-visible"}ei.onRouteMapPointClick(oi)}),ti.appendChild(ai),ti},_createRoutePanelFormRemoveStageElement:function(_t){var e=this,n=document.createElement("div");return n.id="GProuteStageRemove"+_t,n.className="GProuteStageRemove",n.title="Supprimer l'tape",_t!==1&&_t!==7&&n.addEventListener("click",function(ei){var ti=this.id.charAt(this.id.length-1);document.getElementById("GProutePoint"+ti).className="GPflexInput GProuteStageFlexInputHidden",document.getElementById("GProuteOrigin"+ti).value="",document.getElementById("GProuteOrigin"+ti).className="GPelementVisible gpf-visible",document.getElementById("GProuteOriginCoords"+ti).value="",document.getElementById("GProuteOriginCoords"+ti).className="GPelementHidden gpf-hidden",document.getElementById("GProuteStageAdd").style.display="",e.onRouteRemovePointClick(ei)}),n},_createRoutePanelFormAddStageElement:function(){var _t=this,e=document.createElement("div");return e.id="GProuteStageAdd",e.title="Ajouter une tape",e.addEventListener("click",function(n){for(var ei=1,ti=0,ii=2;ii<7;ii++)document.getElementById("GProutePoint"+ii).className==="GPflexInput GProuteStageFlexInputHidden"?ei===1&&(ei=ii):ti++;ei<7&&(document.getElementById("GProutePoint"+ei).className="GPflexInput GProuteStageFlexInput"),ti===4&&(document.getElementById("GProuteStageAdd").style.display="none"),_t.onRouteAddPointClick(n)}),e},_createRoutePanelFormAutoCompleteListElement:function(_t){var e=this,n=document.createElement("div");return n.id="GProuteAutoCompleteList"+_t,n.className="GPadvancedAutoCompleteList",n.addEventListener?n.addEventListener("click",function(ei){e.onAutoCompletedResultsItemClick(ei),document.getElementById("GProuteAutoCompleteList"+_t).style.display="none"},!1):n.attachEvent&&n.attachEvent("onclick",function(ei){e.onAutoCompletedResultsItemClick(ei),document.getElementById("GProuteAutoCompleteList"+_t).style.display="none"}),n},_createRouteAutoCompletedLocationElement:function(_t,e,n){var ei=document.getElementById("GProuteAutoCompleteList"+e),ti=document.createElement("div");ti.id="AutoCompletedLocation"+n,ti.className="GPautoCompleteProposal",ti.innerHTML=GeocodeUtils.getSuggestedLocationFreeform(_t),ei.appendChild(ti)},_createRoutePanelFormModeChoiceTransportElement:function(_t){var e=this,n=document.createElement("div");n.id=this._addUID("GProuteTransportChoice");var ei=document.createElement("label");ei.className="GProuteModeLabel gpf-label fr-label",ei.innerHTML="Choisir un mode de dplacement",n.appendChild(ei);var ti=document.createElement("div");ti.className="gpf-radio-btn-group";for(var ii=0;ii<_t.length;ii++){var ri=_t[ii],ni=document.createElement("div");if(ni.className="GProuteTransportChoice gpf-flex gpf-radio-group fr-radio-group fr-my-1w",ri==="Voiture"){var si=document.createElement("input");si.id=this._addUID("GProuteTransportCar"),si.type="radio",si.name="GProuteTransport",si.value="Voiture",ii===0&&(si.checked=!0),si.addEventListener?si.addEventListener("change",function(ci){e.onRouteModeTransportChange(ci)}):si.attachEvent&&si.attachEvent("onchange",function(ci){e.onRouteModeTransportChange(ci)}),ni.appendChild(si);var ai=document.createElement("label");ai.className="GProuteTransportImg gpf-label fr-label",ai.htmlFor=this._addUID("GProuteTransportCar"),ai.title="Voiture",ai.innerHTML="Voiture",ni.appendChild(ai)}if(ri==="Pieton"){var oi=document.createElement("input");oi.id=this._addUID("GProuteTransportPedestrian"),oi.type="radio",oi.name="GProuteTransport",oi.value="Pieton",ii===0&&(oi.checked=!0),oi.addEventListener?oi.addEventListener("change",function(ci){e.onRouteModeTransportChange(ci)}):oi.attachEvent&&oi.attachEvent("onchange",function(ci){e.onRouteModeTransportChange(ci)}),ni.appendChild(oi);var li=document.createElement("label");li.className="GProuteTransportImg gpf-label fr-label",li.htmlFor=this._addUID("GProuteTransportPedestrian"),li.title="Piton",li.innerHTML="Piton",ni.appendChild(li)}ti.appendChild(ni)}return n.appendChild(ti),n},_createRoutePanelFormModeChoiceComputeElement:function(){var _t=this,e=document.createElement("div");e.id=this._addUID("GProuteComputationChoice"),e.className="fr-mt-2w";var n=document.createElement("label");n.className="GProuteComputationLabel gpf-label fr-label",n.innerHTML="Mode de calcul",e.appendChild(n);var ei=document.createElement("div");ei.className="gpf-radio-btn-group";var ti=document.createElement("div");ti.className="GProuteComputationChoice gpf-flex gpf-radio-group fr-radio-group fr-my-1w";var ii=document.createElement("input");ii.id=this._addUID("GProuteComputationFastest"),ii.type="radio",ii.name="GProuteComputation",ii.value="fastest",ii.checked=!0,ii.addEventListener?ii.addEventListener("change",function(oi){_t.onRouteModeComputationChange(oi)}):ii.attachEvent&&ii.attachEvent("onchange",function(oi){_t.onRouteModeComputationChange(oi)}),ti.appendChild(ii);var ri=document.createElement("label");ri.className="gpf-label fr-label",ri.htmlFor=this._addUID("GProuteComputationFastest"),ri.title="Plus rapide",ri.innerHTML="Plus rapide",ti.appendChild(ri),ei.appendChild(ti);var ni=document.createElement("div");ni.className="GProuteComputationChoice gpf-flex gpf-radio-group fr-radio-group fr-my-1w";var si=document.createElement("input");si.id=this._addUID("GProuteComputationShortest"),si.type="radio",si.name="GProuteComputation",si.value="shortest",si.addEventListener?si.addEventListener("change",function(oi){_t.onRouteModeComputationChange(oi)}):si.attachEvent&&si.attachEvent("onchange",function(oi){_t.onRouteModeComputationChange(oi)}),ni.appendChild(si);var ai=document.createElement("label");return ai.className="gpf-label fr-label",ai.htmlFor=this._addUID("GProuteComputationShortest"),ai.title="Plus court",ai.innerHTML="Plus court",ni.appendChild(ai),ei.appendChild(ni),e.appendChild(ei),e},_createShowRouteExclusionsPictoElement:function(){var _t=this,e=document.createElement("button");e.id=this._addUID("GPshowRouteExclusionsPicto");var n="";return checkDsfr()&&(n="GPelementHidden gpf-hidden"),e.className=`GPshowAdvancedToolPicto GPshowMoreOptionsImage GPshowMoreOptions GPshowRouteExclusionsPicto ${n} gpf-btn fr-btn--sm fr-btn--tertiary gpf-btn--tertiary fr-icon-arrow-down-fill`,e.title="Exclusions",e.setAttribute("tabindex","0"),e.setAttribute("aria-pressed",!0),e.addEventListener?e.addEventListener("click",function(ei){ei.preventDefault();var ti=ei.target.ariaPressed==="true";ei.target.setAttribute("aria-pressed",!ti),_t.onShowRouteExclusionsClick(ei)}):e.attachEvent&&e.attachEvent("onclick",function(ei){ei.preventDefault();var ti=ei.target.ariaPressed==="true";ei.target.setAttribute("aria-pressed",!ti),_t.onShowRouteExclusionsClick(ei)}),e},_createRoutePanelFormExclusionsElement:function(){var _t=document.createElement("div");_t.id=this._addUID("GProuteExclusions"),_t.className="fr-mt-2w";var e=document.createElement("label");return e.className="GProuteExclusionsLabel fr-label",e.innerHTML="Passages autoriss",_t.appendChild(e),_t},_createRoutePanelFormExclusionOptionsElement:function(_t){var e=this,n=document.createElement("div");n.className="GProuteExclusionsOptions gpf-flex fr-checkbox-group fr-m-1w";for(var ei in _t)if(_t.hasOwnProperty(ei)){var ti=_t[ei];switch(ei){case"toll":var ii=document.createElement("input");ii.id=this._addUID("GProuteExclusionsToll"),ii.type="checkbox",ii.value="Toll",ii.name="Peage",ii.checked=!ti,ii.addEventListener?ii.addEventListener("change",function(li){e.onRouteExclusionsChange(li)}):ii.attachEvent&&ii.attachEvent("onchange",function(li){e.onRouteExclusionsChange(li)}),n.appendChild(ii);var ri=document.createElement("label");ri.className="GProuteExclusionsOption",ri.htmlFor=this._addUID("GProuteExclusionsToll"),ri.innerHTML="Pages",n.appendChild(ri);break;case"tunnel":var ni=document.createElement("input");ni.id=this._addUID("GProuteExclusionsTunnel"),ni.type="checkbox",ni.value="Tunnel",ni.name="Tunnel",ni.checked=!ti,ni.addEventListener?ni.addEventListener("change",function(li){e.onRouteExclusionsChange(li)}):ni.attachEvent&&ni.attachEvent("onchange",function(li){e.onRouteExclusionsChange(li)}),n.appendChild(ni);var si=document.createElement("label");si.className="GProuteExclusionsOption",si.htmlFor=this._addUID("GProuteExclusionsTunnel"),si.innerHTML="Tunnels",n.appendChild(si);break;case"bridge":var ai=document.createElement("input");ai.id=this._addUID("GProuteExclusionsBridge"),ai.type="checkbox",ai.value="Bridge",ai.name="Ponts",ai.checked=!ti,ai.addEventListener?ai.addEventListener("change",function(li){e.onRouteExclusionsChange(li)}):ai.attachEvent&&ai.attachEvent("onchange",function(li){e.onRouteExclusionsChange(li)}),n.appendChild(ai);var oi=document.createElement("label");oi.className="GProuteExclusionsOption",oi.htmlFor=this._addUID("GProuteExclusionsBridge"),oi.innerHTML="Ponts",n.appendChild(oi);break}}return n},_createRouteSubmitFormElement:function(){var _t=document.createElement("input");return _t.id=this._addUID("GProuteSubmit"),_t.className="GPsubmit gpf-btn gpf-btn-icon-submit fr-btn",_t.type="submit",_t.value="Calculer l'itinraire",_t},_createRouteFormResetElement:function(){var _t=this,e=document.createElement("button");return e.id=this._addUID("GProuteReset"),e.title="Rinitialiser les paramtres",e.className="GPresetPicto gpf-btn gpf-btn-icon-reset fr-btn fr-btn--secondary gpf-btn--secondary",e.title="Rinitialiser les paramtres",e.setAttribute("tabindex","0"),e.setAttribute("aria-pressed",!1),e.addEventListener("click",function(n){var ei=n.target.ariaPressed==="true";n.target.setAttribute("aria-pressed",!ei),_t.onRouteResetClick(n)}),e}},logger$o=LoggerByDefault.getLogger("route");class Route extends ControlExtended{constructor(e){if(e=e||{},super(e),!(this instanceof Route))throw new TypeError("ERROR CLASS_CONSTRUCTOR");return this.CLASSNAME="Route",this.initialize(e),this._container=this._createMainContainerElement(),this.element?this.element.appendChild(this._container):this.element=this._container,this}setMap(e){if(e){if(this._container=this._initContainer(e),this.element=this._container,this.options.export){var n=Helper.assign({control:this},this.options.export);this.export=new ButtonExport(n),this.export.render();var ei=this;this.export.on("button:clicked",ti=>{ei.dispatchEvent({type:"export:compute",content:ti.content})})}this.draggable&&Draggable.dragElement(this._panelRouteContainer,this._panelHeaderRouteContainer,e.getTargetElement()),this.collapsed||this._showRouteButton.setAttribute("aria-pressed",!0)}super.setMap(e),this.options.position&&this.setPosition(this.options.position),this.options.gutter===!1&&this.getContainer().classList.add("gpf-button-no-gutter")}getCollapsed(){return this.collapsed}setCollapsed(e){if(e===void 0){logger$o.log("[ERROR] Route:setCollapsed - missing collapsed parameter");return}e&&this.collapsed||!e&&!this.collapsed||(e?document.getElementById("GProutePanelClose-"+this._uid).click():this._showRouteButton.click(),this.collapsed=e)}getLayer(){return this._geojsonSections}setLayer(e){if(!e){this._geojsonSections=null;return}if(!(e instanceof VectorLayer)){logger$o.log("no valid layer given for hosting drawn features.");return}e.setStyle(this._defaultFeatureStyle),this._geojsonSections=e}getGeoJSON(){return JSON.stringify(this._geojsonObject)}setGeoJSON(e){try{this._geojsonObject=JSON.parse(e)}catch(n){logger$o.log("no valid geojson given :"+n.message)}}getData(){var e=[];for(let ei=0;ei<this._currentPoints.length;ei++){const ti=this._currentPoints[ei];e.push(ti.getCoordinate())}var n={type:"route",points:e,transport:this._currentTransport,exclusions:this._currentExclusions,computation:this._currentComputation,results:{}};return Helper.assign(n.results,this._currentRouteInformations),n}setData(e){this._currentTransport=e.transport,this._currentComputation=e.computation,this._currentExclusions=e.exclusions;for(var n=0;n<e.points.length;n++){const ni=e.points[n];ni&&this._currentPoints[n].setCoordinate(ni,"EPSG:4326")}for(var ei=0;ei<this._currentPoints.length;ei++){var ti=this._currentPoints[ei];if(ti.getCoordinate()){var ii=ei+1+"-"+this._uid,ri=ti.getCoordinate()[1].toFixed(4)+" / "+ti.getCoordinate()[0].toFixed(4);document.getElementById("GPlocationOriginCoords_"+ii).value=ri,document.getElementById("GPlocationOrigin_"+ii).value=ri,ei>0&&ei<6&&(document.getElementById("GPlocationPoint_"+ii).className="GPflexInput GPelementHidden gpf-flex gpf-hidden ")}}this._currentRouteInformations=e.results}getContainer(){return this._container}getStyle(){return this._defaultFeatureStyle}init(){for(let ui=0;ui<this._currentPoints.length;ui++){const di=this._currentPoints[ui];var e=ui+1,n=di.getCoordinate();if(n){var ei=document.getElementById("GPlocationOrigin_"+e+"-"+this._uid);ei.value=n[1].toFixed(4)+" / "+n[0].toFixed(4),ui>0&&ui<6&&(document.getElementById("GPlocationPoint_"+e+"-"+this._uid).className="GPflexInput GPlocationStageFlexInput gpf-flex")}}var ti=document.getElementsByClassName("GPlocationPoint-"+this._uid);this._addRouteResultsStagesValuesElement(ti);var ii;this._currentTransport==="Pieton"?(ii=document.getElementById("GProuteTransportPedestrian-"+this._uid),ii&&(ii.checked="true")):(ii=document.getElementById("GProuteTransportCar-"+this._uid),ii&&(ii.checked="true"));var ri=document.getElementById("GProuteComputationSelect-"+this._uid);ri&&(ri.value=this._currentComputation);var ni=document.getElementById("GProuteExclusionsToll-"+this._uid);ni&&(this._currentExclusions.indexOf("toll")!==-1?ni.checked=!1:ni.checked=!0);var si=document.getElementById("GProuteExclusionsTunnel-"+this._uid);si&&(this._currentExclusions.indexOf("tunnel")!==-1?si.checked=!1:si.checked=!0);var ai=document.getElementById("GProuteExclusionsBridge-"+this._uid);ai&&(this._currentExclusions.indexOf("bridge")!==-1?ai.checked=!1:ai.checked=!0);var oi=this._currentRouteInformations.totalDistance,li=this._currentRouteInformations.totalTime,ci=this._simplifiedInstructions(this._currentRouteInformations.routeInstructions);ci&&this._fillRouteResultsDetailsContainer(oi,li,ci),this._formRouteContainer.className="GPelementHidden gpf-hidden gpf-panel__content fr-modal__content",this._hideWaitingContainer(),this._resultsRouteContainer.className=""}clean(){this._currentTransport=null,this._currentExclusions=[],this._currentComputation=null;for(var e=0;e<this._currentPoints.length;e++)this._currentPoints[e].clear();this._removeRouteStepLocations(),this._clearRouteInputOptions(),this._clearRouteResultsDetails(),this.setLayer(),this._formRouteContainer.className="gpf-panel__content fr-modal__content",this._resultsRouteContainer.className="GPelementHidden gpf-hidden"}initialize(e){this._checkInputOptions(e),this.options={collapsed:!0,draggable:!1,export:!1,graphs:["Pieton","Voiture"],exclusions:{toll:!1,tunnel:!1,bridge:!1},routeOptions:{},autocompleteOptions:{},layerDescription:{title:"Itinraire",description:"Itinraire bas sur un graphe"}},Helper.assign(this.options,e);var n={departure:{url:Marker.red,offset:Marker.defaultOffset},stages:{url:Marker.lightOrange,offset:Marker.defaultOffset},arrival:{url:Marker.darkOrange,offset:Marker.defaultOffset}};this.options.markersOpts=Helper.assign(n,e.markersOpts),this.collapsed=this.options.collapsed,this.draggable=this.options.draggable,this._uid=this.options.id||SelectorID.generate(),this._showRouteButton=null,this._panelRouteContainer=null,this._panelHeaderRouteContainer=null,this._waitingContainer=null,this._formRouteContainer=null,this._resultsRouteContainer=null,this._showRouteExclusionsElement=null,this._currentPoints=[],this._currentTransport=null,this._initTransport(),this._currentComputation=null,this._initComputation(),this._currentExclusions=[],this._initExclusions(),this._waiting=!1,this._timer=null,this._geojsonRoute=null,this._geojsonSections=null,this._geojsonObject=null,this.export=null,this._popupContent=null,this._popupDiv=this._initPopupDiv(),this._popupOverlay=null,this._resultsSelectInteraction=null,this._resultsHoverInteraction=null,this._defaultFeatureStyle=new Style$1({stroke:new Stroke({color:"rgba(0,183,152,0.9)",width:12})}),this._selectedFeatureStyle=new Style$1({stroke:new Stroke({color:"rgba(255,102,0,0.9)",width:12})}),this._currentRouteInformations=null,this._resources={},this.listenerKey=null}_checkInputOptions(e){if(e.graphs)if(Array.isArray(e.graphs)&&e.graphs.length)for(var n=0;n<e.graphs.length;n++)typeof e.graphs[n]=="string"?(e.graphs[n].toLowerCase()==="pieton"&&(e.graphs[n]="Pieton"),e.graphs[n].toLowerCase()==="voiture"&&(e.graphs[n]="Voiture")):(logger$o.log("[ol.control.Route] ERROR : parameter 'graphs' elements should be of type 'string'"),e.graphs[n]=null);else logger$o.warn("'graphs' parameter should be an array"),e.graphs=null;e.collapsed==="true"&&(e.collapsed=!0),e.collapsed==="false"&&(e.collapsed=!1)}_initContainer(e){var n=this._container;if(n.childElementCount>0)return n;var ei=this._showRouteButton=this._createShowRoutePictoElement();n.appendChild(ei);var ti=this._panelRouteContainer=this._createRoutePanelElement(),ii=this._createRoutePanelDivElement();ti.appendChild(ii);var ri=this._panelHeaderRouteContainer=this._createRoutePanelHeaderElement();ii.appendChild(ri);var ni=this._formRouteContainer=this._createRoutePanelFormElement();ni.appendChild(this._createRoutePanelFormModeChoiceTransportElement(this.options.graphs));for(var si=this._createRoutePanelFormPointsElement(e),ai=0;ai<si.length;ai++)ni.appendChild(si[ai]);ni.appendChild(this._createRoutePanelFormModeChoiceComputeElement()),this._showRouteExclusionsElement=this._createShowRouteExclusionsPictoElement(),ni.appendChild(this._showRouteExclusionsElement);var oi=this._createRoutePanelFormExclusionsElement();oi.appendChild(this._createRoutePanelFormExclusionOptionsElement(this.options.exclusions)),ni.appendChild(oi);var li=this._createRoutePanelFooterElement();if(ni.appendChild(li),!checkDsfr()){var ci=this._createRouteFormResetElement();li.appendChild(ci)}var ui=this._createRouteSubmitFormElement();li.appendChild(ui),ii.appendChild(ni);var di=this._resultsRouteContainer=this._createRoutePanelResultsElement();ii.appendChild(di);var fi=this._createDrawingButtonsPluginDiv();ii.appendChild(fi);var hi=this._waitingContainer=this._createRouteWaitingElement();return ii.appendChild(hi),n.appendChild(ti),n.addEventListener&&n.addEventListener("click",pi=>this._hideRouteSuggestedLocations(pi)),n}_initTransport(){this._currentTransport="Pieton";var e=this.options.graphs;(!e||e.length===0)&&(this.options.graphs=["Pieton","Voiture"]),Array.isArray(e)&&e.length&&(e[0]==="Voiture"||e[0]==="Pieton")&&(this._currentTransport=e[0]);var n=this.options.routeOptions;n.graph&&(this._currentTransport=n.graph)}_initComputation(){this._currentComputation="fastest";var e=this.options.routeOptions;e.routePreference&&(this._currentComputation=e.routePreference)}_initExclusions(){this._currentExclusions=[];var e=this.options.exclusions;if((!e||typeof e=="object"&&Object.keys(e).length===0)&&(this.options.exclusions={toll:!1,tunnel:!1,bridge:!1}),e&&typeof e=="object"&&Object.keys(e).length)for(var n in e)e.hasOwnProperty(n)&&e[n]&&this._currentExclusions.push(n);var ei=this.options.routeOptions;Array.isArray(ei.exclusions)&&(this._currentExclusions=ei.exclusions)}_initPopupDiv(){var e=this,n=document.createElement("div");n.className="gp-feature-info-div";var ei=document.createElement("button");return ei.className="gp-styling-button closer",ei.onclick=function(){return e._popupOverlay!=null&&e._popupOverlay.setPosition(void 0),!1},this._popupContent=document.createElement("div"),this._popupContent.className="gp-features-content-div",n.appendChild(this._popupContent),n.appendChild(ei),n}_createRoutePanelFormPointsElement(e){var n=[],ei=1,ti=new LocationSelector({apiKey:this.options.apiKey||null,tag:{id:ei,label:"Dpart",groupId:this._uid,markerOpts:this.options.markersOpts.departure,display:!0},autocompleteOptions:this.options.autocompleteOptions||null});for(ti.setMap(e),this._addFormPointsEventListeners(ti),n.push(this._createRoutePanelFormPointLabel("Dpart")),n.push(ti._container),this._currentPoints.push(ti),ei=2;ei<7;ei++){var ii=new LocationSelector({apiKey:this.options.apiKey||null,tag:{id:ei,label:"Etape "+(ei-1),groupId:this._uid,markerOpts:this.options.markersOpts.stages,display:!1,removeOption:!0},autocompleteOptions:this.options.autocompleteOptions||null});ii.setMap(e),this._addFormPointsEventListeners(ii),n.push(this._createRoutePanelFormPointLabel("tape",!1)),n.push(ii._container),this._currentPoints.push(ii)}var ri=new LocationSelector({apiKey:this.options.apiKey||null,tag:{id:ei,label:"Arrive",groupId:this._uid,markerOpts:this.options.markersOpts.arrival,display:!0,addOption:!0},autocompleteOptions:this.options.autocompleteOptions||null});return ri.setMap(e),this._addFormPointsEventListeners(ri),n.push(this._createRoutePanelFormPointLabel("Arrive")),n.push(ri._container),this._currentPoints.push(ri),n}_addFormPointsEventListeners(e){e&&(e._buttonLabel.addEventListener?(e._buttonLabel.addEventListener("click",n=>this.onRouteOriginLabelClick(n)),e._inputShowPointer.addEventListener("click",n=>this.onRouteOriginPointerClick(n,e)),e._removePointElement&&e._removePointElement.addEventListener("click",n=>{logger$o.trace("click on _removePointElement",n)}),e._addPointElement&&e._addPointElement.addEventListener("click",n=>{logger$o.trace("click on _addPointElement",n)})):e._buttonLabel.attachEvent&&(e._buttonLabel.attachEvent("onclick",n=>this.onRouteOriginLabelClick(n)),e._inputShowPointer.attachEvent("onclick",n=>this.onRouteOriginPointerClick(n,e)),e._removePointElement&&e._removePointElement.attachEvent("onclick",n=>{}),e._addPointElement&&e._addPointElement.attachEvent("onclick",n=>{})))}onRouteComputationSubmit(e){logger$o.log("onRouteComputationSubmit",e);var n=this._currentPoints,ei;if(n[0]&&n[0].getCoordinate){var ti=n[0].getCoordinate();ei={x:ti[0].toFixed(5),y:ti[1].toFixed(5)},logger$o.log("start",ei)}var ii,ri=n[n.length-1];if(ri&&ri.getCoordinate){var ni=ri.getCoordinate();ii={x:ni[0].toFixed(5),y:ni[1].toFixed(5)},logger$o.log("end",ii)}for(var si=[],ai=1;ai<n.length-1;ai++)if(n[ai]&&n[ai].getCoordinate){var oi=n[ai].getCoordinate();if(oi){var li={x:oi[0].toFixed(5),y:oi[1].toFixed(5)};logger$o.log("step",li),si.push(li)}}this._currentTransport=e.transport,this._currentComputation=e.computation,this._currentExclusions=e.exclusions;var ci=this.options.routeOptions,ui;ci.resource?ui=ci.resource:this._currentComputation==="fastest"&&this._currentTransport==="Pieton"&&(ui="bdtopo-valhalla");var di=ci.protocol||"XHR",fi=ci.timeOut||0;di==="JSONP"&&fi===0&&(fi=15e3);var hi=ci.onFailure!==null&&typeof ci.onFailure=="function",pi=ci.onSuccess!==null&&typeof ci.onSuccess=="function",gi=this;this._requestRouting({startPoint:ei,endPoint:ii,viaPoints:si,graph:ci.graph||this._currentTransport,routePreference:ci.routePreference||this._currentComputation,exclusions:ci.exclusions||this._currentExclusions,geometryInInstructions:!0,distanceUnit:"m",timeOut:fi,protocol:di,resource:ui,onSuccess:function(vi){logger$o.log(vi),vi&&gi._fillRouteResultsDetails(vi),pi&&ci.onSuccess.call(gi,vi)},onFailure:function(vi){gi._hideWaitingContainer(),gi._clearRouteResultsDetails(),logger$o.log(vi.message),hi&&ci.onFailure.call(gi,vi)}})}onRouteOriginLabelClick(){this._formRouteContainer.className="gpf-panel__content gpf-mobile-form fr-modal__content",unByKey(this.listenerKey),this.dispatchEvent("route:drawend")}onRouteOriginPointerClick(e,n){var ei=this.getMap();n._inputShowPointerContainer.checked?(this._formRouteContainer.className="GProuteFormMini gpf-panel__content fr-modal__content",e.target.parentElement.parentElement.classList.add("selected"),this.listenerKey=ei.on("click",()=>{e.target.parentElement.parentElement.classList.remove("selected"),this._formRouteContainer.className==="GProuteFormMini gpf-panel__content fr-modal__content"&&(this._formRouteContainer.className="gpf-panel__content fr-modal__content"),unByKey(this.listenerKey),this.dispatchEvent("route:drawend")}),this.dispatchEvent("route:drawstart")):(this._formRouteContainer.className="",unByKey(this.listenerKey),this.dispatchEvent("route:drawend"))}onShowRoutePanelClick(e){var n=this._showRouteButton.ariaPressed;n==="true"&&this.onPanelOpen();var ei=this.getMap();Interactions.unset(ei),!this._geojsonSections&&!this._waiting&&this._clear(),this.collapsed=n!=="true",this.dispatchEvent("change:collapsed"),this.options.position&&!this.collapsed&&this.updatePosition(this.options.position)}onRouteModeComputationChange(e){var n=e.target.value;n&&(logger$o.log(n),this._currentComputation=n)}onRouteModeComputationChangeAndRun(e){this.onRouteModeComputationChange(e),this._clearRouteResultsDetails(),this._clearRouteResultsGeometry(),this._clearRouteResultsFeatureGeometry(),this.onRouteComputationSubmit({computation:this._currentComputation,transport:this._currentTransport,exclusions:this._currentExclusions})}onRouteModeTransportChange(e){var n=e.target.value;n&&(this._currentTransport=n)}onShowRouteExclusionsClick(e){logger$o.log("onShowRouteExclusionsClick",e)}onRouteExclusionsChange(e){var n=e.target.value,ei=e.target.checked;if(!(!n||typeof n!="string")){n=n.toLowerCase();for(var ti=!1,ii=null,ri=0;ri<this._currentExclusions.length;ri++)this._currentExclusions[ri]===n&&(ii=ri,ti=!0);!ti&&!ei&&this._currentExclusions.push(n),ti&&ei&&this._currentExclusions.splice(ii,1)}}onRouteResetClick(){for(var e=this._currentPoints,n=0;n<e.length;n++)e[n].clear();this._clear(),this._clearRouteInputOptions()}onShowRouteResultsNewClick(){this._clearRouteResultsDetails(),this._clearRouteResultsGeometry(),this._clearRouteResultsFeatureGeometry(),this.dispatchEvent("route:newresults")}onRouteResultsDetailsMouseOver(e){var n=e.target.id,ei=n.substring(n.indexOf("_")+1);if(e.target.classList&&e.target.classList.add("GProuteResultsDetailsInstructionHighlight"),!!this._geojsonSections){var ti=this._geojsonSections.getSource().getFeatureById(parseInt(ei,10));ti.setStyle(this._selectedFeatureStyle)}}onRouteResultsDetailsMouseOut(e){var n=e.target.id,ei=n.substring(n.indexOf("_")+1);if(e.target.classList&&e.target.classList.remove("GProuteResultsDetailsInstructionHighlight"),!!this._geojsonSections){var ti=this._geojsonSections.getSource().getFeatureById(parseInt(ei,10));ti.setStyle(null)}}_requestRouting(e){!e||typeof e=="object"&&Object.keys(e).length===0||e.startPoint&&e.endPoint&&(e.apiKey=this.options.routeOptions.apiKey||this.options.apiKey,typeof e.ssl!="boolean"&&(typeof this.options.ssl=="boolean"?e.ssl=this.options.ssl:e.ssl=!0),logger$o.log(e),this._displayWaitingContainer(),Gp.Services.route(e))}_fillRouteResultsDetails(e){var n=e.totalDistance,ei=e.totalTime,ti=this._simplifiedInstructions(e.routeInstructions);ti&&this._fillRouteResultsDetailsContainer(n,ei,ti);var ii=e.routeGeometry;ii&&this._fillRouteResultsDetailsGeometry(ii,this._defaultFeatureStyle),ti&&ti[0].geometry&&this._fillRouteResultsDetailsFeatureGeometry(ti,this._defaultFeatureStyle);var ri=e.bbox;if(ri){var ni=this.getMap(),si=[ri.left,ri.bottom,ri.right,ri.top],ai=ni.getView().getProjection().getCode();ai!=="EPSG:4326"&&(si=transformExtent(si,"EPSG:4326",ai)),ni.getView().fit(si,ni.getSize())}this._currentRouteInformations=e,this.dispatchEvent({type:"route:compute"}),this._formRouteContainer.className="GPelementHidden gpf-hidden gpf-panel__content fr-modal__content",this._hideWaitingContainer(),this._resultsRouteContainer.className=""}_fillRouteResultsDetailsContainer(e,n,ei){this._resultsRouteValuesContainer=this._addRouteResultsValuesElement(e,n,MathUtils.convertSecondsToTime),this._resultsRouteDetailsContainer=this._addRouteResultsDetailsElement(ei,MathUtils.convertSecondsToTime)}_fillRouteResultsDetailsGeometry(e,n){this._clearRouteResultsGeometry();var ei=this.getMap();if(e){var ti={type:"FeatureCollection",features:[{type:"Feature",crs:{type:"name",properties:{name:"EPSG:4326"}},geometry:e}]},ii=new GeoJSON({defaultDataProjection:"EPSG:4326",defaultStyle:n}),ri=ii.readFeatures(ti,{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"});this._geojsonRoute=new VectorLayer({source:new VectorSource({features:ri}),style:n,title:"Mon Itinraire"}),ei.addLayer(this._geojsonRoute)}}_fillRouteResultsDetailsFeatureGeometry(e,n){this._clearRouteResultsFeatureGeometry();var ei=this.getMap();this._geojsonObject={type:"FeatureCollection",crs:{type:"name",properties:{name:"EPSG:4326"}},features:[]};for(var ti=0;ti<e.length;ti++){for(var ii=e[ti],ri=ti+1,ni=ii.geometry.coordinates,si=0;si<ni.length;si++)typeof ni[si][0]=="string"&&(ni[si][0]=parseFloat(ni[si][0]),ni[si][1]=parseFloat(ni[si][1]));this._geojsonObject.features.push({type:"Feature",geometry:ii.geometry,properties:{popupContent:"("+ri+") distance : "+MathUtils.convertDistance(ii.distance)+" / temps : "+MathUtils.convertSecondsToTime(ii.duration)},id:ri})}this._geojsonObject.features.push({type:"Feature",geometry:{type:"Point",coordinates:this._currentPoints[0].getCoordinate()},properties:{description:"Point de dpart","marker-symbol":this.options.markersOpts.departure.url}});for(var ai=1;ai<this._currentPoints.length-1;ai++)if(this._currentPoints[ai]&&this._currentPoints[ai].getCoordinate){var oi=this._currentPoints[ai].getCoordinate();oi&&this._geojsonObject.features.push({type:"Feature",geometry:{type:"Point",coordinates:oi},properties:{description:"Point d'tape","marker-symbol":this.options.markersOpts.stages.url}})}this._geojsonObject.features.push({type:"Feature",geometry:{type:"Point",coordinates:this._currentPoints[this._currentPoints.length-1].getCoordinate()},properties:{description:"Point d'arrive","marker-symbol":this.options.markersOpts.arrival.url}});var li=new GeoJSON({defaultDataProjection:"EPSG:4326",defaultStyle:n}),ci=this.getMap().getView().getProjection().getCode(),ui=li.readFeatures(this._geojsonObject,{dataProjection:"EPSG:4326",featureProjection:ci});this._geojsonSections=new VectorLayer({source:new VectorSource({features:ui}),style:n,opacity:.9,title:"Mon Itinraire"});var di;this._currentTransport==="Pieton"?(di="piton",this._geojsonSections.gpResultLayerId="compute:Pieton$OGC:OPENLS;Itineraire"):(di="voiture",this._geojsonSections.gpResultLayerId="compute:Voiture$OGC:OPENLS;Itineraire"),ei.addLayer(this._geojsonSections),ei.getControls().forEach(fi=>{if(fi instanceof LayerSwitcher){var hi=this._geojsonSections.gpLayerId;fi._layers[hi].title===hi&&fi.addLayer(this._geojsonSections,{title:this.options.layerDescription.title+" ("+di+")",description:this.options.layerDescription.description})}},this),this._resultsHoverInteraction=new Select({condition:pointerMove,layers:[this._geojsonSections],style:this._selectedFeatureStyle}),this._resultsHoverInteraction.on("select",fi=>this._onResultsFeatureMouseOver(fi)),ei.addInteraction(this._resultsHoverInteraction),this._resultsSelectInteraction=new Select({layers:[this._geojsonSections],style:this._selectedFeatureStyle}),this._resultsSelectInteraction.on("select",fi=>this._onResultsFeatureSelect(fi)),ei.addInteraction(this._resultsSelectInteraction)}_onResultsFeatureMouseOver(e){if(e.selected.length!==0){var n=e.selected[0],ei=document.getElementById("GProuteResultsDetailsInstruction_"+n.getId()+"-"+this._uid);ei&&ei.classList&&ei.classList.add("GProuteResultsDetailsInstructionHighlight")}if(e.deselected.length!==0){var ti=e.deselected[0],ii=document.getElementById("GProuteResultsDetailsInstruction_"+ti.getId()+"-"+this._uid);ii&&ii.classList&&ii.classList.remove("GProuteResultsDetailsInstructionHighlight")}}_onResultsFeatureSelect(e){var n=this.getMap();if(e.selected.length!==0){var ei=e.selected[0];this._popupContent.innerHTML=ei.getProperties().popupContent,this._popupOverlay?this._popupOverlay.setPosition(e.mapBrowserEvent.coordinate):(this._popupOverlay=new Overlay({element:this._popupDiv,positioning:"bottom-center",position:e.mapBrowserEvent.coordinate}),n.addOverlay(this._popupOverlay))}else this._popupOverlay!=null&&this._popupOverlay.setPosition(void 0)}_clear(){this._currentTransport=null,this._currentExclusions=[],this._currentComputation=null,this._clearRouteResultsDetails(),this._clearRouteResultsGeometry(),this._clearRouteResultsFeatureGeometry();for(var e=0;e<this._currentPoints.length;e++)this._currentPoints[e].clear();this._removeRouteStepLocations()}_clearRouteInputOptions(){this._initTransport(),this._initComputation(),this._initExclusions();var e;this._currentTransport==="Pieton"?(e=document.getElementById("GProuteTransportPedestrian-"+this._uid),e&&(e.checked="true")):(e=document.getElementById("GProuteTransportCar-"+this._uid),e&&(e.checked="true"));var n=document.getElementById("GProuteComputationSelect-"+this._uid);n&&(n.value=this._currentComputation);var ei=document.getElementById("GProuteExclusionsToll-"+this._uid);ei&&(this._currentExclusions.indexOf("toll")!==-1?ei.checked=!1:ei.checked=!0);var ti=document.getElementById("GProuteExclusionsTunnel-"+this._uid);ti&&(this._currentExclusions.indexOf("tunnel")!==-1?ti.checked=!1:ti.checked=!0);var ii=document.getElementById("GProuteExclusionsBridge-"+this._uid);ii&&(this._currentExclusions.indexOf("bridge")!==-1?ii.checked=!1:ii.checked=!0)}_removeRouteStepLocations(){var e=document.querySelectorAll('div[id^="GPlocationPoint"]');if(e.length!==0){for(var n=[],ei=0;ei<e.length;ei++)e[ei].id.indexOf(this._uid)!==-1&&n.push(e[ei]);for(var ti=1;ti<n.length-1;ti++){var ii=n[ti].classList;if(ii.length!==0)for(var ri=0;ri<ii.length;ri++)ii[ri]==="GPlocationStageFlexInput"&&document.getElementById(this._addUID("GPlocationStageRemove_"+(ti+1))).click()}}}_clearRouteResultsDetails(){if(this._currentRouteInformations=null,this._resultsRouteDetailsContainer){var e=this._resultsRouteDetailsContainer;if(e.childElementCount)for(;e.firstChild;)e.removeChild(e.firstChild)}if(this._resultsRouteValuesContainer){var n=this._resultsRouteValuesContainer;if(n.childElementCount)for(;n.firstChild;)n.removeChild(n.firstChild)}}_clearRouteResultsGeometry(){var e=this.getMap();this._geojsonRoute!=null&&(e.removeLayer(this._geojsonRoute),this._geojsonRoute=null)}_clearRouteResultsFeatureGeometry(){var e=this.getMap();this._geojsonSections!=null&&(e.removeLayer(this._geojsonSections),this._geojsonSections=null,this._geojsonObject=null),this._popupOverlay!=null&&(e.removeOverlay(this._popupOverlay),this._popupOverlay=null),this._resultsSelectInteraction!=null&&(e.removeInteraction(this._resultsSelectInteraction),this._resultsSelectInteraction=null),this._resultsHoverInteraction!=null&&(e.removeInteraction(this._resultsHoverInteraction),this._resultsHoverInteraction=null)}_hideRouteSuggestedLocations(e){if(e.target&&e.target.id&&e.target.id.indexOf("GPlocationOrigin_")!==-1)for(var n=parseInt(e.target.id.split("_")[1][0],10)-1,ei=0;ei<this._currentPoints.length;ei++)ei!==parseInt(n,10)&&this._currentPoints[ei]._hideSuggestedLocation();else for(var ti=0;ti<this._currentPoints.length;ti++)this._currentPoints[ti]._hideSuggestedLocation()}_displayWaitingContainer(){this._waitingContainer.className="GPwaitingContainer GPwaitingContainerVisible gpf-waiting gpf-waiting--visible",this._waiting=!0;var e=this.options.routeOptions;if(e&&e.timeOut){this._timer&&(clearTimeout(this._timer),this._timer=null);var n=this;this._timer=setTimeout(function(){n._waiting===!0?n._hideWaitingContainer():n._timer&&clearTimeout(n._timer)},16e3)}}_hideWaitingContainer(){if(this._waiting){this._waitingContainer.className="GPwaitingContainer GPwaitingContainerHidden gpf-waiting gpf-waiting--hidden",this._waiting=!1;var e=this.options.routeOptions;e&&e.timeOut&&(clearTimeout(this._timer),this._timer=null)}}_simplifiedInstructions(e){var n=[],ei=e[0];e.length===1&&n.push(ei);for(var ti=1;ti<e.length;ti++){var ii=e[ti];if(ii.instruction===ei.instruction){ei.distance=(parseFloat(ii.distance)+parseFloat(ei.distance)).toString(),ei.duration=(parseFloat(ii.duration)+parseFloat(ei.duration)).toString();for(var ri=1;ri<ii.geometry.coordinates.length;ri++)ei.geometry.coordinates.push(ii.geometry.coordinates[ri])}else n.push(ei),ei=ii,ti===e.length-1&&(n.push(ii),ei=null)}return logger$o.log(n),n}}Object.assign(Route.prototype,RouteDOM);Object.assign(Route.prototype,Widget);window.ol&&window.ol.control&&(window.ol.control.Route=Route);var IsoDOM={_addUID:function(_t){var e=this._uid?_t+"-"+this._uid:_t;return e},_createMainContainerElement:function(){var _t=document.createElement("div");return _t.id=this._addUID("GPisochron"),_t.className="GPwidget gpf-widget gpf-widget-button gpf-mobile-fullscreen",_t},_createShowIsoPictoElement:function(){var _t=this,e=document.createElement("button"),n=document.createElement("span");return e.appendChild(n),e.id=this._addUID("GPshowIsochronPicto"),e.classList.add("GPshowOpen","GPshowAdvancedToolPicto","GPshowIsochronPicto"),e.classList.add("gpf-btn","gpf-btn--tertiary","gpf-btn-icon","gpf-btn-icon-isocurve"),e.classList.add("icon--ri","icon--ri--map-pin-time-line"),e.classList.add("fr-btn","fr-btn--tertiary"),e.setAttribute("aria-label","Zone selon le temps de trajet ou distance"),e.setAttribute("tabindex","0"),e.setAttribute("aria-pressed",!1),e.setAttribute("type","button"),e.addEventListener?e.addEventListener("click",function(ei){var ti=ei.target.ariaPressed==="true";ei.target.setAttribute("aria-pressed",!ti),_t.onShowIsoPanelClick(ei)}):e.attachEvent&&e.attachEvent("onclick",function(ei){var ti=ei.target.ariaPressed==="true";ei.target.setAttribute("aria-pressed",!ti),_t.onShowIsoPanelClick(ei)}),e},_createIsoPanelElement:function(){var _t=document.createElement("dialog");return _t.id=this._addUID("GPisochronPanel"),_t.className="GPpanel gpf-panel fr-modal",_t},_createIsoPanelDivElement:function(){var _t=document.createElement("div");return _t.className="gpf-panel__body fr-modal__body",_t},_createDrawingButtonsPluginDiv:function(){var _t=document.createElement("div");return _t.className="container-buttons-plugin fr-mx-2w",_t},_createIsoPanelHeaderElement:function(){var _t=this,e=document.createElement("div");e.className="GPpanelHeader gpf-panel__header fr-modal__header";var n=document.createElement("div");n.className="GPpanelTitle gpf-panel__title fr-modal__title fr-pt-4w",n.innerHTML="Calcul d'isochrone",e.appendChild(n);var ei=document.createElement("button");ei.id=this._addUID("GPisochronPanelClose"),ei.className="GPpanelClose GPisochronPanelClose gpf-btn gpf-btn-icon-close fr-btn--close fr-btn fr-btn--tertiary-no-outline fr-m-1w",ei.title="Fermer le panneau",ei.addEventListener?ei.addEventListener("click",function(){document.getElementById(_t._addUID("GPshowIsochronPicto")).click()},!1):ei.attachEvent&&ei.attachEvent("onclick",function(){document.getElementById(_t._addUID("GPshowIsochronPicto")).click()});var ti=document.createElement("span");return ti.className="GPelementHidden gpf-visible",ti.innerText="Fermer",ei.appendChild(ti),e.appendChild(ei),e},_createIsoPanelFormElement:function(){var _t=this,e=document.createElement("form");return e.id=this._addUID("GPisochronForm"),e.className="GPform gpf-panel__content gpf-mobile-form fr-modal__content",e.addEventListener("submit",function(n){return n.preventDefault(),_t.onIsoComputationSubmit(n),!1}),e},_createIsoPanelResultsElement:function(){var _t=this,e=document.createElement("div");e.id=this._addUID("GPisoResultsPanel"),e.className="GPelementHidden gpf-hidden";var n=document.createElement("div");return n.id=this._addUID("GPisoResultsNew"),n.className="GPresetPicto gpf-btn gpf-btn-icon-reset fr-btn fr-btn--secondary gpf-btn--secondary fr-m-2w",n.title="Modifier le calcul",n.addEventListener("click",function(ei){document.getElementById(_t._addUID("GPisoResultsPanel")).className="GPelementHidden gpf-hidden",document.getElementById(_t._addUID("GPisochronForm")).className="gpf-panel__content fr-modal__content",_t.onShowIsoResultsNewClick(ei)}),e.appendChild(n),e},_addIsoResultsValuesElement:function(_t,e,n){var ei=_t.distance,ti=_t.time,ii=_t.location,ri=e.graph,ni=e.method,si=e.exclusions,ai=document.getElementById(this._addUID("GPisoResultsPanel"));ai.childElementCount&&ai.firstChild.id===this._addUID("GPisoResultsValueDiv")&&ai.removeChild(ai.firstChild);var oi=document.createElement("div");oi.id=this._addUID("GPisoResultsValueDiv"),oi.className="fr-m-2w";var li=document.createElement("div");li.className="GPisoResultsValue";var ci=document.createElement("label");ci.className="GPisoResultsValueLabel",ci.innerHTML="Type :",li.appendChild(ci);var ui=document.createElement("div");ui.id=this._addUID("GPisoResultsValueType"),ni==="time"?ui.innerHTML="temps":ui.innerHTML="distance",li.appendChild(ui),oi.appendChild(li);var di=document.createElement("div");di.className="GPisoResultsValue";var fi=document.createElement("label");fi.className="GPisoResultsValueLabel",fi.innerHTML="Mode :",di.appendChild(fi);var hi=document.createElement("div");hi.id=this._addUID("GPisoResultsValueMode"),hi.innerHTML=ri,di.appendChild(hi),oi.appendChild(di);var pi=document.createElement("div");pi.className="GPisoResultsValue";var gi=document.createElement("label");gi.className="GPisoResultsValueLabel",gi.innerHTML="Centre :",pi.appendChild(gi);var vi=document.createElement("div");if(vi.id=this._addUID("GPisoResultsValueOrigin"),vi.innerHTML=parseFloat(ii.y).toFixed(4)+", "+parseFloat(ii.x).toFixed(4),pi.appendChild(vi),oi.appendChild(pi),ei&&ei.length!==0){var yi=document.createElement("div");yi.className="GPisoResultsValue";var _i=document.createElement("label");_i.className="GPisoResultsValueLabel",_i.innerHTML="Distance :",yi.appendChild(_i);var Ai=0,Ei=parseInt(ei/1e3,10);if(!Ei)Ai=Math.round(ei)+" m";else{var Si=Math.round(ei);Si=Si/1e3,Ai=Si+" km"}var wi=document.createElement("div");wi.id=this._addUID("GPisoResultsValueDist"),wi.innerHTML=Ai,yi.appendChild(wi),oi.appendChild(yi)}if(ti&&ti.length!==0){var Oi=document.createElement("div");Oi.className="GPisoResultsValue";var Ii=document.createElement("label");Ii.className="GPisoResultsValueLabel",Ii.innerHTML="Dure :",Oi.appendChild(Ii);var Li=document.createElement("div");Li.id=this._addUID("GPisoResultsValueTime"),Li.innerHTML=n(ti),Oi.appendChild(Li),oi.appendChild(Oi)}if(si.length>0){var Di=document.createElement("div");Di.className="GPisoResultsValue";var Ni=document.createElement("label");Ni.className="GPisoResultsValueLabel",Ni.innerHTML="Exclusions :",Di.appendChild(Ni);var $i=document.createElement("div");$i.id=this._addUID("GPisoResultsValueExclusions"),$i.innerHTML=si.join(", "),Di.appendChild($i),oi.appendChild(Di)}return ai.prepend(oi),ai},_createIsoWaitingElement:function(){var _t=document.createElement("div");_t.id=this._addUID("GPisochronCalcWaitingContainer"),_t.className="GPwaitingContainer GPwaitingContainerHidden gpf-waiting gpf-waiting--hidden";var e=document.createElement("p");return e.className="GPwaitingContainerInfo gpf-waiting_info",e.innerHTML="Recherche en cours...",_t.appendChild(e),_t},_createIsoPanelFooterElement:function(){var _t=document.createElement("div");return _t.className="GPpanelFooter gpf-panel__footer fr-modal__footer",_t},_createIsoPanelFormPointLabel:function(){var _t=document.createElement("p");return _t.id=this._addUID("GPisochronPointLabelP"),_t.className="gpf-label fr-label",_t.innerHTML="Dpart",_t},_createIsoPanelFormTypeChoiceElement:function(){var _t=document.createElement("div");return _t.id=this._addUID("GPisochronChoice"),_t.className="fr-mt-2w",_t},_createIsoPanelFormTypeChoiceChronElement:function(_t){var e=this,n=document.createElement("div");n.className="GPisochronChoiceAlt gpf-flex gpf-flex-isocurve gpf-radio-group fr-radio-group";var ei=document.createElement("input");ei.id=this._addUID("GPisochronChoiceAltChron"),ei.name="GPisochronChoiceMode",ei.type="radio",ei.checked=!!_t,ei.addEventListener?ei.addEventListener("change",function(ri){document.getElementById(e._addUID("GPisochronValueChron")).className="GPflexInput gpf-flex fr-mt-1w",document.getElementById(e._addUID("GPisochronValueDist")).className="GPelementHidden gpf-hidden",document.getElementById(e._addUID("GPisochronValueChronLabelP")).className="gpf-label fr-label",document.getElementById(e._addUID("GPisochronValueDistLabelP")).className="GPelementHidden gpf-hidden",document.getElementById(e._addUID("GPisochronSubmit")).value="Calculer l'isochrone",e.onIsoTypeChoiceChange(ri)},!1):ei.attachEvent&&ei.attachEvent("onchange",function(){document.getElementById(e._addUID("GPisochronValueChron")).className="GPflexInput gpf-flex fr-mt-1w",document.getElementById(e._addUID("GPisochronValueDist")).className="GPelementHidden gpf-hidden",document.getElementById(e._addUID("GPisochronValueChronLabelP")).className="gpf-label fr-label",document.getElementById(e._addUID("GPisochronValueDistLabelP")).className="GPelementHidden gpf-hidden",document.getElementById(e._addUID("GPisochronSubmit")).value="Calculer l'isochrone",e.onIsoTypeChoiceChange()}),ei.value="isochron",n.appendChild(ei);var ti=document.createElement("label");ti.className="GPisochronChoiceAltImg gpf-label fr-label",ti.htmlFor=this._addUID("GPisochronChoiceAltChron"),ti.innerHTML="Dure",ti.title="Dure",n.appendChild(ti);var ii=document.createElement("span");return ii.id=this._addUID("GPisochronChoiceAltChronTxt"),ii.className="gpf-hidden",ii.innerHTML="Dure",ii.addEventListener?ii.addEventListener("click",function(){document.getElementById(e._addUID("GPisochronChoiceAltChron")).click()},!1):ii.attachEvent&&ii.attachEvent("onclick",function(){document.getElementById(e._addUID("GPisochronChoiceAltChron")).click()}),n.appendChild(ii),n},_createIsoPanelFormTypeChoiceDistElement:function(_t){var e=this,n=document.createElement("div");n.className="GPisochronChoiceAlt gpf-flex gpf-flex-isocurve gpf-radio-group fr-radio-group";var ei=document.createElement("input");ei.id=this._addUID("GPisochronChoiceAltDist"),ei.name="GPisochronChoiceMode",ei.type="radio",ei.checked=!!_t,ei.addEventListener?ei.addEventListener("change",function(ri){document.getElementById(e._addUID("GPisochronValueDist")).className="GPflexInput gpf-flex fr-mt-1w",document.getElementById(e._addUID("GPisochronValueChron")).className="GPelementHidden gpf-hidden",document.getElementById(e._addUID("GPisochronValueDistLabelP")).className="gpf-label fr-label",document.getElementById(e._addUID("GPisochronValueChronLabelP")).className="GPelementHidden gpf-hidden",document.getElementById(e._addUID("GPisochronSubmit")).value="Calculer l'isodistance",e.onIsoTypeChoiceChange(ri)},!1):ei.attachEvent&&ei.attachEvent("onchange",function(){document.getElementById(e._addUID("GPisochronValueDist")).className="GPflexInput gpf-flex fr-mt-1w",document.getElementById(e._addUID("GPisochronValueChron")).className="GPelementHidden gpf-hidden",document.getElementById(e._addUID("GPisochronValueDistLabelP")).className="gpf-label fr-label",document.getElementById(e._addUID("GPisochronValueChronLabelP")).className="GPelementHidden gpf-hidden",document.getElementById(e._addUID("GPisochronSubmit")).value="Calculer l'isodistance",e.onIsoTypeChoiceChange()}),ei.value="isodistance",n.appendChild(ei);var ti=document.createElement("label");ti.className="GPisochronChoiceAltImg gpf-label fr-label",ti.htmlFor=this._addUID("GPisochronChoiceAltDist"),ti.innerHTML="Distance",ti.title="Distance",n.appendChild(ti);var ii=document.createElement("span");return ii.id=this._addUID("GPisochronChoiceAltDistTxt"),ii.className="gpf-hidden",ii.innerHTML="Distance",ii.addEventListener?ii.addEventListener("click",function(){document.getElementById(e._addUID("GPisochronChoiceAltDist")).click()},!1):ii.attachEvent&&ii.attachEvent("onclick",function(){document.getElementById(e._addUID("GPisochronChoiceAltDist")).click()}),n.appendChild(ii),n},_createIsoPanelFormLabelIsochronElement:function(_t){var e=document.createElement("p");return e.id=this._addUID("GPisochronValueChronLabelP"),e.className=_t?"gpf-label fr-label":"GPelementHidden gpf-hidden",e.innerHTML="Dfinir un temps de trajet",e},_createIsoPanelFormValueIsochronElement:function(_t){var e=this,n=document.createElement("div");n.id=this._addUID("GPisochronValueChron"),n.className=_t?"GPflexInput gpf-flex fr-mt-1w":"GPelementHidden gpf-hidden";var ei=document.createElement("input");ei.id=this._addUID("GPisochronValueChronInput1"),ei.className="gpf-input fr-input",ei.min="0",ei.step="1",ei.value="0",ei.type="number",ei.title="Temps",ei.addEventListener?ei.addEventListener("change",function(ni){typeof e.onIsoValueChronTimeMinuteChange=="function"&&e.onIsoValueChronTimeHourChange(ni)}):ei.attachEvent&&ei.attachEvent("onchange",function(ni){typeof e.onIsoValueChronTimeMinuteChange=="function"&&e.onIsoValueChronTimeHourChange(ni)}),n.appendChild(ei);var ti=document.createElement("label");ti.innerHTML="h",ti.className="gpf-label fr-label",n.appendChild(ti);var ii=document.createElement("input");ii.id=this._addUID("GPisochronValueChronInput2"),ii.className="gpf-input fr-input",ii.min="0",ii.max="59",ii.step="1",ii.value="0",ii.type="number",ii.title="Heures",ii.addEventListener?ii.addEventListener("change",function(ni){typeof e.onIsoValueChronTimeMinuteChange=="function"&&e.onIsoValueChronTimeMinuteChange(ni)}):ii.attachEvent&&ii.attachEvent("onchange",function(ni){typeof e.onIsoValueChronTimeMinuteChange=="function"&&e.onIsoValueChronTimeMinuteChange(ni)}),n.appendChild(ii);var ri=document.createElement("label");return ri.innerHTML="min",ri.className="gpf-label fr-label",n.appendChild(ri),n},_createIsoPanelFormLabelIsodistanceElement:function(_t){var e=document.createElement("p");return e.id=this._addUID("GPisochronValueDistLabelP"),e.className=_t?"gpf-label fr-label":"GPelementHidden gpf-hidden",e.innerHTML="Dfinir une distance",e},_createIsoPanelFormValueIsodistanceElement:function(_t){var e=this,n=document.createElement("div");n.id=this._addUID("GPisochronValueDist"),n.className=_t?"GPflexInput gpf-flex fr-mt-1w":"GPelementHidden gpf-hidden";var ei=document.createElement("input");ei.id=this._addUID("GPisochronValueDistInput"),ei.className="gpf-input fr-input fr-ml-1w",ei.min="0",ei.step="any",ei.value="0",ei.type="number",ei.title="Distance",ei.addEventListener?ei.addEventListener("change",function(ii){typeof e.onIsoValueDistChange=="function"&&e.onIsoValueDistChange(ii)}):ei.attachEvent&&ei.attachEvent("onchange",function(ii){typeof e.onIsoValueDistChange=="function"&&e.onIsoValueDistChange(ii)}),n.appendChild(ei);var ti=document.createElement("label");return ti.innerHTML="km",ti.className="gpf-label fr-label",n.appendChild(ti),n},_createIsoPanelFormModeChoiceTransportElement:function(_t){var e=this,n=document.createElement("div");n.id=this._addUID("GPisochronTransportChoice");var ei=document.createElement("label");ei.className="GPisochronModeLabel gpf-label fr-label",ei.innerHTML="Choisir un mode de dplacement",n.appendChild(ei);for(var ti=document.createElement("div"),ii=0;ii<_t.length;ii++){var ri=_t[ii],ni=document.createElement("div");if(ni.className="GPisochronTransportChoice gpf-flex gpf-radio-group fr-radio-group",ri==="Voiture"){var si=document.createElement("input");si.id=this._addUID("GPisochronTransportCar"),si.type="radio",si.name="GPisochronTransport",ii===0&&(si.checked=!0),si.addEventListener?si.addEventListener("change",function(ci){e.onIsoModeTransportChange(ci)}):si.attachEvent&&si.attachEvent("onchange",function(ci){e.onIsoModeTransportChange(ci)}),si.value="Voiture",ni.appendChild(si);var ai=document.createElement("label");ai.className="GPisochronTransportImg gpf-label fr-label",ai.htmlFor=this._addUID("GPisochronTransportCar"),ai.title="Voiture",ai.innerHTML="Voiture",ni.appendChild(ai)}if(ri==="Pieton"){var oi=document.createElement("input");oi.id=this._addUID("GPisochronTransportPedestrian"),oi.type="radio",oi.name="GPisochronTransport",ii===0&&(oi.checked=!0),oi.addEventListener?oi.addEventListener("change",function(ci){e.onIsoModeTransportChange(ci)}):oi.attachEvent&&oi.attachEvent("onchange",function(ci){e.onIsoModeTransportChange(ci)}),oi.value="Pieton",ni.appendChild(oi);var li=document.createElement("label");li.className="GPisochronTransportImg gpf-label fr-label",li.htmlFor=this._addUID("GPisochronTransportPedestrian"),li.title="Piton",li.innerHTML="Piton",ni.appendChild(li)}ti.appendChild(ni)}return n.appendChild(ti),n},_createIsoPanelFormModeChoiceDirectionElement:function(_t){var e=this,n=document.createElement("div");n.id=this._addUID("GPisochronDirectionChoice"),n.className="fr-my-2w";var ei=document.createElement("label");ei.innerHTML="Dfinir un sens de parcours",ei.className="fr-label",n.appendChild(ei);var ti=document.createElement("select");ti.id=this._addUID("GPisochronDirectionSelect"),ti.className="GPselect gpf-select fr-select",ti.title="Sens de parcours",ti.addEventListener("change",function(ai){e.onIsoModeDirectionChange(ai)});for(var ii=0;ii<_t.length;ii++){var ri=_t[ii];if(ri.toLowerCase()==="departure"){var ni=document.createElement("option");ii===0&&(ni.selected="selected"),ni.value="departure",ni.text="Dpart",ti.appendChild(ni)}if(ri.toLowerCase()==="arrival"){var si=document.createElement("option");ii===0&&(si.selected="selected"),si.value="arrival",si.text="Arrive",ti.appendChild(si)}}return n.appendChild(ti),n},_createShowIsoExclusionsPictoElement:function(){var _t=this,e=document.createElement("button");e.id=this._addUID("GPshowIsoExclusionsPicto");var n="";return checkDsfr()&&(n="GPelementHidden gpf-hidden"),e.className=`GPshowAdvancedToolPicto GPshowMoreOptionsImage GPshowMoreOptions GPshowIsoExclusionsPicto ${n} gpf-btn fr-btn--sm fr-btn--tertiary gpf-btn--tertiary fr-icon-arrow-down-fill`,e.title="Exclusions",e.setAttribute("tabindex","0"),e.setAttribute("aria-pressed",!0),e.addEventListener?e.addEventListener("click",function(ei){ei.preventDefault();var ti=ei.target.ariaPressed==="true";ei.target.setAttribute("aria-pressed",!ti),_t.onShowIsoSettingsClick(ei)}):e.attachEvent&&e.attachEvent("onclick",function(ei){ei.preventDefault();var ti=ei.target.ariaPressed==="true";ei.target.setAttribute("aria-pressed",!ti),_t.onShowIsoSettingsClick(ei)}),e},_createIsoPanelFormExclusionsElement:function(){var _t=document.createElement("div");_t.id=this._addUID("GPisoExclusions");var e=document.createElement("label");return e.className="GPisoExclusionsLabel gpf-label fr-label",e.innerHTML="Passages autoriss",_t.appendChild(e),_t},_createIsoPanelFormExclusionOptionsElement:function(_t){var e=this,n=document.createElement("div");n.className="GPisoExclusionsOptions gpf-flex fr-checkbox-group fr-m-1w";for(var ei in _t)if(_t.hasOwnProperty(ei)){var ti=_t[ei];switch(ei){case"toll":var ii=document.createElement("input");ii.id=this._addUID("GPisoExclusionsToll"),ii.type="checkbox",ii.name="Pages",ii.checked=!ti,ii.addEventListener?ii.addEventListener("change",function(li){e.onIsoExclusionsChange(li)}):ii.attachEvent&&ii.attachEvent("onchange",function(li){e.onIsoExclusionsChange(li)}),ii.value="Toll",n.appendChild(ii);var ri=document.createElement("label");ri.className="GPisoExclusionsOption",ri.htmlFor=this._addUID("GPisoExclusionsToll"),ri.innerHTML="Pages",n.appendChild(ri);break;case"tunnel":var ni=document.createElement("input");ni.id=this._addUID("GPisoExclusionsTunnel"),ni.type="checkbox",ni.name="Tunnel",ni.checked=!ti,ni.addEventListener?ni.addEventListener("change",function(li){e.onIsoExclusionsChange(li)}):ni.attachEvent&&ni.attachEvent("onchange",function(li){e.onIsoExclusionsChange(li)}),ni.value="Tunnel",n.appendChild(ni);var si=document.createElement("label");si.className="GPisoExclusionsOption",si.htmlFor=this._addUID("GPisoExclusionsTunnel"),si.innerHTML="Tunnels",n.appendChild(si);break;case"bridge":var ai=document.createElement("input");ai.id=this._addUID("GPisoExclusionsBridge"),ai.type="checkbox",ai.name="Ponts",ai.checked=!ti,ai.addEventListener?ai.addEventListener("change",function(li){e.onIsoExclusionsChange(li)}):ai.attachEvent&&ai.attachEvent("onchange",function(li){e.onIsoExclusionsChange(li)}),ai.value="Bridge",n.appendChild(ai);var oi=document.createElement("label");oi.className="GPisoExclusionsOption",oi.htmlFor=this._addUID("GPisoExclusionsBridge"),oi.innerHTML="Ponts",n.appendChild(oi);break}}return n},_createIsoSubmitFormElement:function(){var _t=document.createElement("input");return _t.id=this._addUID("GPisochronSubmit"),_t.className="GPsubmit gpf-btn fr-btn",_t.type="submit",_t.value="Calculer l'isochrone",_t},_createIsoFormResetElement:function(){var _t=this,e=document.createElement("button");return e.id=this._addUID("GPisochronReset"),e.className="GPresetPicto GPisochronReset gpf-btn gpf-btn-icon-reset gpf-btn-icon-isocurve-reset fr-btn fr-btn--secondary gpf-btn--secondary",e.title="Rinitialiser les paramtres",e.setAttribute("tabindex","0"),e.setAttribute("aria-pressed",!1),e.addEventListener("click",function(n){var ei=n.target.ariaPressed==="true";n.target.setAttribute("aria-pressed",!ei),_t.onIsoResetClick(n)}),e}},logger$n=LoggerByDefault.getLogger("isocurve");class Isocurve extends ControlExtended{constructor(e){if(e=e||{},super(e),!(this instanceof Isocurve))throw new TypeError("ERROR CLASS_CONSTRUCTOR");return this.CLASSNAME="Isocurve",this.initialize(e),this._container=this._createMainContainerElement(),this.element?this.element.appendChild(this._container):this.element=this._container,this}setMap(e){if(e){if(this._container=this._initContainer(e),this.options.export){var n=Helper.assign({control:this},this.options.export);this.export=new ButtonExport(n),this.export.render();var ei=this;this.export.on("button:clicked",ti=>{ei.dispatchEvent({type:"export:compute",content:ti.content})})}this.draggable&&Draggable.dragElement(this._IsoPanelContainer,this._IsoPanelHeaderContainer,e.getTargetElement()),this.collapsed||this._pictoIsoButton.setAttribute("aria-pressed",!0)}super.setMap(e),this.options.position&&this.setPosition(this.options.position),this.options.gutter===!1&&this.getContainer().classList.add("gpf-button-no-gutter")}getCollapsed(){return this.collapsed}setCollapsed(e){if(e===void 0){logger$n.log("[ERROR] Isocurve:setCollapsed - missing collapsed parameter");return}e&&this.collapsed||!e&&!this.collapsed||(e?document.getElementById("GPisochronPanelClose-"+this._uid).click():this._pictoIsoButton.click(),this.collapsed=e)}getLayer(){return this._geojsonLayer}setLayer(e){if(!e){this._geojsonLayer=null;return}if(!(e instanceof VectorLayer)){logger$n.log("no valid layer given for hosting drawn features.");return}e.setStyle(this._defaultFeatureStyle),this._geojsonLayer=e}getGeoJSON(){return JSON.stringify(this._geojsonObject)}setGeoJSON(e){try{this._geojsonObject=JSON.parse(e)}catch(n){logger$n.log("no valid geojson given :"+n.message)}}getData(){var e={type:"isocurve",transport:this._currentTransport,computation:this._currentComputation,exclusions:this._currentExclusions,direction:this._currentDirection,point:this._originPoint.getCoordinate(),results:{}};return Helper.assign(e.results,this._currentIsoResults),e}setData(e){this._currentTransport=e.transport,this._currentComputation=e.computation,this._currentExclusions=e.exclusions,this._currentDirection=e.direction;var n=document.getElementById("GPlocationOriginPointer_1-"+this._uid);n.checked=!0;var ei=document.getElementById("GPlocationOrigin_1-"+this._uid),ti=document.getElementById("GPlocationOriginCoords_1-"+this._uid);ti.value=e.point,ei.value=e.point[1].toFixed(4)+" / "+e.point[0].toFixed(4),this._originPoint.setCoordinate(e.point,"EPSG:4326"),this._currentIsoResults=e.results}getContainer(){return this._container}getStyle(){return this._defaultFeatureStyle}compute(e,n,ei){this._clear();var ti=this._pictoIsoButton.ariaPressed;ti!=="true"&&this._pictoIsoButton.click();var ii=this.getMap();if(ii){var ri={direction:"departure",method:"time",transport:"Voiture",exclusions:[]};Helper.assign(ri,ei),this._originPoint.setCoordinate(e);var ni=this._originPoint.getCoordinate(),si=document.getElementById("GPlocationOrigin_1-"+this._uid);if(si.value=ni[0].toFixed(4)+" / "+ni[1].toFixed(4),this._currentTransport=ri.transport,ri.transport==="Voiture"?document.getElementById("GPisochronTransportCar-"+this._uid).checked=!0:document.getElementById("GPisochronTransportPedestrian-"+this._uid).checked=!0,this._currentExclusions=ri.exclusions,this._currentComputation=ri.method,ri.method==="time"){var ai=n.split(".");this._currentTimeHour=ai[0]||0,document.getElementById("GPisochronValueChronInput1-"+this._uid).value=this._currentTimeHour,this._currentTimeMinute=ai[1]||0,document.getElementById("GPisochronValueChronInput2-"+this._uid).value=this._currentTimeMinute,document.getElementById("GPisochronChoiceAltChron-"+this._uid).click()}else this._currentDistance=n,document.getElementById("GPisochronValueDistInput-"+this._uid).value=this._currentDistance,document.getElementById("GPisochronChoiceAltDist-"+this._uid).click();this._currentDirection=ri.direction,ri.direction==="departure"?document.getElementById("GPisochronDirectionSelect-"+this._uid).selectedIndex=0:document.getElementById("GPisochronDirectionSelect-"+this._uid).selectedIndex=1,this.onIsoComputationSubmit()}}init(){var e=this._originPoint.getCoordinate(),n=document.getElementById("GPlocationOrigin_1-"+this._uid);if(n.value=e[1].toFixed(4)+" / "+e[0].toFixed(4),this._currentTransport==="Voiture"?document.getElementById("GPisochronTransportCar-"+this._uid).checked=!0:document.getElementById("GPisochronTransportPedestrian-"+this._uid).checked=!0,this._currentComputation==="time"){var ei=this._currentIsoResults.time/60;this._currentTimeHour=Math.floor(ei/60),document.getElementById("GPisochronValueChronInput1-"+this._uid).value=this._currentTimeHour,this._currentTimeMinute=Math.round((ei/60-this._currentTimeHour)*60),document.getElementById("GPisochronValueChronInput2-"+this._uid).value=this._currentTimeMinute,document.getElementById("GPisochronChoiceAltChron-"+this._uid).click()}else this._currentDistance=this._currentIsoResults.distance/1e3,document.getElementById("GPisochronValueDistInput-"+this._uid).value=this._currentDistance,document.getElementById("GPisochronChoiceAltDist-"+this._uid).click();this._currentDirection==="departure"?document.getElementById("GPisochronDirectionSelect-"+this._uid).selectedIndex=0:document.getElementById("GPisochronDirectionSelect-"+this._uid).selectedIndex=1,this._fillIsoResultsDetails(this._currentIsoResults,{graph:this._currentTransport,exclusions:this._currentExclusions,method:this._currentComputation})}clean(){this._clearIsoInputs(),this._originPoint.clearResults(),document.getElementById("GPlocationPoint_1-"+this._uid).style.cssText="",document.getElementById("GPlocationOriginCoords_1-"+this._uid).value="",document.getElementById("GPlocationOrigin_1-"+this._uid).value="",document.getElementById("GPlocationPoint_1-"+this._uid).style.cssText="",document.getElementById("GPlocationOriginPointer_1-"+this._uid).checked=!1,document.getElementById("GPlocationOrigin_1-"+this._uid).className="GPlocationOriginVisible gpf-visible",document.getElementById("GPlocationOriginCoords_1-"+this._uid).className="GPlocationOriginHidden gpf-hidden",this._currentIsoResults=null,this.setLayer(),this._resultsIsoContainer.className="GPelementHidden gpf-hidden",this._formContainer.className="gpf-panel__content fr-modal__content"}initialize(e){this._checkInputOptions(e),this.options={collapsed:!0,draggable:!1,export:!1,methods:["time","distance"],graphs:["Pieton","Voiture"],exclusions:{toll:!1,tunnel:!1,bridge:!1},directions:["departure","arrival"],markerOpts:{url:Marker.lightOrange,offset:Marker.defaultOffset},isocurveOptions:{},autocompleteOptions:{},layerDescription:{title:"Isochrone/Isodistance",description:"isochrone/isodistance bas sur un graphe"}},Helper.assign(this.options,e),this.collapsed=this.options.collapsed,this.draggable=this.options.draggable,this._uid=this.options.id||SelectorID.generate(),this._currentTransport=null,this._initTransport(),this._currentComputation=null,this._initComputation(),this._currentExclusions=[],this._initExclusions(),this._currentDirection=null,this._initDirection(),this._originPoint=null,this._pictoIsoButton=null,this._waitingContainer=null,this._formContainer=null,this._resultsIsoContainer=null,this._IsoPanelContainer=null,this._IsoPanelHeaderContainer=null,this._currentIsoResults=null,this._geojsonLayer=null,this._geojsonObject=null,this.export=null,this._waiting=!1,this._timer=null,this._defaultFeatureStyle=new Style$1({fill:new Fill({color:"rgba(0, 183, 152, 0.7)"}),stroke:new Stroke({color:"rgba(0, 183, 152, 0)",width:1})}),this._resources={},this.listenerKey=null,this.COMPUTE_ISOCURVE_EVENT="isocurve:comput",this.RESULTS_ISOCURVE_EVENT="isocurve:newresults",this.DRAW_START_ISOCURVE_EVENT="isocurve:drawstart",this.DRAW_END_ISOCURVE_EVENT="isocurve:drawend"}_checkInputOptions(e){var n;if(e.methods)if(Array.isArray(e.methods))if(e.methods.length===0)e.methods=null;else for(n=0;n<e.methods.length;n++)typeof e.methods[n]!="string"&&logger$n.log("[ol.control.Isocurve] ERROR : parameter 'methods' elements should be of type 'string'");else logger$n.warn("'methods' parameter should be an array"),e.methods=null;if(e.graphs)if(Array.isArray(e.graphs))if(e.graphs.length===0)e.graphs=null;else for(n=0;n<e.graphs.length;n++)typeof e.graphs[n]!="string"?logger$n.log("[ol.control.Isocurve] ERROR : parameter 'graphs' elements should be of type 'string'"):(e.graphs[n].toLowerCase()==="pieton"&&(e.graphs[n]="Pieton"),e.graphs[n].toLowerCase()==="voiture"&&(e.graphs[n]="Voiture"));else logger$n.warn("'graphs' parameter should be an array"),e.graphs=null;if(e.directions)if(Array.isArray(e.directions))if(e.directions.length===0)e.directions=null;else for(n=0;n<e.directions.length;n++)typeof e.directions[n]!="string"&&logger$n.log("[ol.control.Isocurve] ERROR : parameter 'directions' elements should be of type 'string'");else logger$n.warn("'directions' parameter should be an array"),e.directions=null;e.collapsed==="true"&&(e.collapsed=!0),e.collapsed==="false"&&(e.collapsed=!1)}_initTransport(){this._currentTransport="Piton";var e=this.options.graphs;(!e||e.length===0)&&(this.options.graphs=["Pieton","Voiture"]),Array.isArray(e)&&e.length&&(e[0]==="Voiture"||e[0]==="Pieton")&&(this._currentTransport=e[0]);var n=this.options.isocurveOptions;n.graph&&(this._currentTransport=n.graph)}_initComputation(){this._currentComputation="time";var e=this.options.methods;(!e||e.length===0)&&(this.options.methods=["time","distance"]),Array.isArray(e)&&e.length&&(e[0]==="time"||e[0]==="distance")&&(this._currentComputation=e[0]);var n=this.options.isocurveOptions;n.method&&(this._currentComputation=n.method),n.time&&(this._currentComputation="time"),n.distance&&(this._currentComputation="distance")}_initDirection(){this._currentDirection="departure";var e=this.options.directions;(!e||e.length===0)&&(this.options.directions=["departure","arrival"]),Array.isArray(e)&&e.length&&(e[0]==="departure"||e[0]==="arrival")&&(this._currentDirection=e[0]);var n=this.options.isocurveOptions;n.reverse||(this._currentDirection="departure"),n.reverse===!0&&(this._currentDirection="arrival",this.options.directions=["arrival","departure"])}_initExclusions(){this._currentExclusions=[];var e=this.options.exclusions;if((!e||typeof e=="object"&&Object.keys(e).length===0)&&(this.options.exclusions={toll:!1,tunnel:!1,bridge:!1}),e&&typeof e=="object"&&Object.keys(e).length)for(var n in e)e.hasOwnProperty(n)&&e.k&&this._currentExclusions.push(n);var ei=this.options.isocurveOptions;Array.isArray(ei.exclusions)&&(this._currentExclusions=ei.exclusions)}_initContainer(e){var n=this._container;if(n.childElementCount>0)return n;var ei=this._pictoIsoButton=this._createShowIsoPictoElement();n.appendChild(ei);var ti=this._IsoPanelContainer=this._createIsoPanelElement(),ii=this._createIsoPanelDivElement();ti.appendChild(ii);var ri=this._IsoPanelHeaderContainer=this._createIsoPanelHeaderElement();ii.appendChild(ri);var ni=this._formContainer=this._createIsoPanelFormElement();ni.appendChild(this._createIsoPanelFormModeChoiceTransportElement(this.options.graphs)),ni.appendChild(this._createIsoPanelFormPointLabel());var si=this._createIsoPanelFormPointElement(e);ni.appendChild(si);for(var ai=!1,oi=!1,li=this._createIsoPanelFormTypeChoiceElement(),ci=0;ci<this.options.methods.length;ci++)this.options.methods[ci]==="time"&&(ai=ci===0,li.appendChild(this._createIsoPanelFormTypeChoiceChronElement(ai))),this.options.methods[ci]==="distance"&&(oi=ci===0,li.appendChild(this._createIsoPanelFormTypeChoiceDistElement(oi)));if(ni.appendChild(li),ni.appendChild(this._createIsoPanelFormLabelIsochronElement(ai)),ni.appendChild(this._createIsoPanelFormValueIsochronElement(ai)),ni.appendChild(this._createIsoPanelFormLabelIsodistanceElement(oi)),ni.appendChild(this._createIsoPanelFormValueIsodistanceElement(oi)),ni.appendChild(this._createIsoPanelFormModeChoiceDirectionElement(this.options.directions)),this.options.exclusions&&typeof this.options.exclusions=="object"&&Object.keys(this.options.exclusions).length!==0){ni.appendChild(this._createShowIsoExclusionsPictoElement());var ui=this._createIsoPanelFormExclusionsElement();ui.appendChild(this._createIsoPanelFormExclusionOptionsElement(this.options.exclusions)),ni.appendChild(ui)}var di=this._createIsoPanelFooterElement();if(ni.appendChild(di),!checkDsfr()){var fi=this._createIsoFormResetElement();di.appendChild(fi)}var hi=this._submitContainer=this._createIsoSubmitFormElement();di.appendChild(hi),ii.appendChild(ni);var pi=this._resultsIsoContainer=this._createIsoPanelResultsElement();ii.appendChild(pi);var gi=this._createDrawingButtonsPluginDiv();ii.appendChild(gi);var vi=this._waitingContainer=this._createIsoWaitingElement();return ti.appendChild(vi),n.appendChild(ti),n.addEventListener&&n.addEventListener("click",yi=>this._hideIsoSuggestedLocations(yi)),n}_createIsoPanelFormPointElement(e){this._originPoint=new LocationSelector({apiKey:this.options.apiKey||null,tag:{id:1,groupId:this._uid,markerOpts:this.options.markerOpts,display:!0},autocompleteOptions:this.options.autocompleteOptions||null}),this._originPoint.setMap(e);var n=this;return document.getElementById("GPlocationOriginPointerImg_1-"+this._uid).onclick=function(){n._clearGeojsonLayer();var ei=n.getMap();n._originPoint._inputShowPointerContainer.checked?(n._formContainer.className="GPisochronFormMini gpf-panel__content fr-modal__content",this.listenerKey=ei.on("click",()=>{n._formContainer.className="gpf-panel__content fr-modal__content",n.dispatchEvent(n.DRAW_END_ISOCURVE_EVENT)})):(n._formContainer.className="gpf-panel__content fr-modal__content",unByKey(this.listenerKey)),n.dispatchEvent(n.DRAW_START_ISOCURVE_EVENT)},document.getElementById("GPlocationOriginLabel_1-"+this._uid).onclick=function(){n._clearGeojsonLayer(),n._formContainer.className="gpf-panel__content fr-modal__content",e.un("click",()=>{n._formContainer.className="gpf-panel__content fr-modal__content"}),n.dispatchEvent(n.DRAW_END_ISOCURVE_EVENT)},document.getElementById("GPlocationOrigin_1-"+this._uid).onclick=function(){n._clearGeojsonLayer(),n.dispatchEvent(n.DRAW_END_ISOCURVE_EVENT)},this._originPoint._container}onIsoComputationSubmit(){if(!this._originPoint||!this._originPoint.getCoordinate||!this._originPoint.getCoordinate()){logger$n.log("[Isocurve] Missing position parameter to submit isocurve request");return}var e=this._originPoint.getCoordinate(),n={x:e[0].toFixed(5),y:e[1].toFixed(5)};logger$n.log("origin : ",n);var ei,ti;if(this._currentComputation.toLowerCase()==="time"){var ii=document.getElementById("GPisochronValueChronInput1-"+this._uid),ri=parseInt(ii.value,10);isNaN&&isNaN(ri)&&(ri=0);var ni=document.getElementById("GPisochronValueChronInput2-"+this._uid),si=parseInt(ni.value,10);isNaN&&isNaN(si)&&(si=0),ei=ri*3600+si*60,logger$n.log("time : "+ei)}if(this._currentComputation.toLowerCase()==="distance"){var ai=document.getElementById("GPisochronValueDistInput-"+this._uid);ti=parseFloat(ai.value)*1e3,logger$n.log("distance : "+ti)}if(!ei&&!ti){logger$n.log("[Isocurve] Missing time or distance parameter to submit isocurve request");return}var oi=this.options.isocurveOptions||{},li=oi.protocol||"XHR",ci=oi.timeOut||0;li==="JSONP"&&ci===0&&(ci=15e3);var ui=oi.onFailure!==null&&typeof oi.onFailure=="function",di=oi.onSuccess!==null&&typeof oi.onSuccess=="function",fi=this,hi={position:n,graph:oi.graph||this._currentTransport,exclusions:oi.exclusions||this._currentExclusions,method:oi.method||this._currentComputation,smoothing:oi.smoothing||!0,timeOut:ci,protocol:li,resource:oi.resource,onSuccess:function(pi){logger$n.log(pi),pi&&(fi._fillIsoResultsDetails(pi,hi),fi._drawIsoResults(pi)),di&&oi.onSuccess.call(fi,pi)},onFailure:function(pi){fi._hideWaitingContainer(),logger$n.log(pi.message),ui&&oi.onFailure.call(fi,pi)}};(this._currentDirection.toLowerCase()==="arrival"||oi.reverse)&&(hi.reverse=!0),ei&&(hi.time=ei),ti&&(hi.distance=ti),this._requestIsoCurve(hi)}onShowIsoPanelClick(e){var n=this._pictoIsoButton.ariaPressed;n==="true"&&this.onPanelOpen();var ei=this.getMap();Interactions.unset(ei),this.collapsed=n!=="true",this.dispatchEvent("change:collapsed"),this.options.position&&!this.collapsed&&this.updatePosition(this.options.position)}onIsoTypeChoiceChange(e){var n=e.target.value;n&&(n==="isodistance"&&(this._currentComputation="distance"),n==="isochron"&&(this._currentComputation="time"))}onIsoModeTransportChange(e){var n=e.target.value;n&&(this._currentTransport=n)}onIsoModeDirectionChange(e){var n=e.target.value;n&&(n.toLowerCase()==="arrival"?document.getElementById("GPisochronPointLabelP-"+this._uid).innerHTML="Arrive":document.getElementById("GPisochronPointLabelP-"+this._uid).innerHTML="Dpart",this._currentDirection=n)}onIsoExclusionsChange(e){var n=e.target.value,ei=e.target.checked;if(n){for(var ti=!1,ii=null,ri=0;ri<this._currentExclusions.length;ri++)deepEqual(this._currentExclusions[ri],n.toLowerCase())&&(ii=ri,ti=!0);!ti&&!ei&&this._currentExclusions.push(n.toLowerCase()),ti&&ei&&(this._currentExclusions[ii]=null)}}onIsoResetClick(){this._clear()}onShowIsoResultsNewClick(){this._clearGeojsonLayer(),this.dispatchEvent(this.RESULTS_ISOCURVE_EVENT)}onShowIsoSettingsClick(){}_requestIsoCurve(e){!e||typeof e=="object"&&Object.keys(e).length===0||e.position&&(typeof e.ssl!="boolean"&&(typeof this.options.ssl=="boolean"?e.ssl=this.options.ssl:e.ssl=!0),logger$n.log(e),this._clearGeojsonLayer(),this._displayWaitingContainer(),Gp.Services.isoCurve(e))}_fillIsoResultsDetails(e,n){this._fillIsoResultsDetailsContainer(e,n),this._currentIsoInformations=e,this.dispatchEvent({type:this.COMPUTE_ISOCURVE_EVENT}),this._formContainer.className="GPelementHidden gpf-hidden gpf-panel__content fr-modal__content",this._hideWaitingContainer(),this._resultsIsoContainer.className="gpf-flex GPflex"}_fillIsoResultsDetailsContainer(e,n){this._resultsIsoValuesContainer=this._addIsoResultsValuesElement(e,n,MathUtils.convertSecondsToTime)}_drawIsoResults(e){if(this._currentIsoResults=e,this._hideWaitingContainer(),!!e.geometry){var n=this.getMap();this._geojsonObject={type:"FeatureCollection",crs:{type:"name",properties:{name:"EPSG:4326"}},features:[{type:"Feature",crs:{type:"name",properties:{name:"EPSG:4326"}},geometry:e.geometry}]},this._geojsonObject.features.push({type:"Feature",geometry:{type:"Point",coordinates:this._originPoint.getCoordinate()},properties:{description:"Point d'origine","marker-symbol":this.options.markerOpts.url}});var ei=new GeoJSON({defaultDataProjection:"EPSG:4326",defaultStyle:this._defaultFeatureStyle}),ti=n.getView().getProjection().getCode(),ii=ei.readFeatures(this._geojsonObject,{dataProjection:"EPSG:4326",featureProjection:ti}),si=this._currentComputation==="time"?"Isochrone":"Isodistance";this._geojsonLayer=new VectorLayer({source:new VectorSource({features:ii}),style:this._defaultFeatureStyle,opacity:.9,title:"Mon "+si});var ri;if(this._currentTransport==="Pieton"?(ri="piton",this._geojsonLayer.gpResultLayerId="compute:Pieton$GEOPORTAIL:GPP:Isocurve"):(ri="voiture",this._geojsonLayer.gpResultLayerId="compute:Voiture$GEOPORTAIL:GPP:Isocurve"),n.addLayer(this._geojsonLayer),this.dispatchEvent({type:this.COMPUTE_ISOCURVE_EVENT}),ii[0]&&ii[0].getGeometry()&&ii[0].getGeometry().getExtent()){var ni=ii[0].getGeometry().getExtent();n.getView().fit(ni,n.getSize())}var si=this._currentComputation==="time"?"Isochrone":"Isodistance";n.getControls().forEach(ai=>{if(ai instanceof LayerSwitcher){var oi=this._geojsonLayer.gpLayerId;ai._layers[oi].title===oi&&ai.addLayer(this._geojsonLayer,{title:this.options.layerDescription.title+" ("+si+"/"+ri+")",description:this.options.layerDescription.description})}})}}_clear(){this._clearIsoInputs(),this._originPoint.clear(),this._clearGeojsonLayer(),this._currentIsoResults=null}_clearIsoInputs(){var e=document.getElementById("GPisochronValueChronInput1-"+this._uid);e&&(e.value="0");var n=document.getElementById("GPisochronValueChronInput2-"+this._uid);n&&(n.value="0");var ei=document.getElementById("GPisochronValueDistInput-"+this._uid);ei&&(ei.value="0"),this._initTransport(),this._initComputation(),this._initDirection(),this._initExclusions();var ti;this._currentTransport==="Pieton"?(ti=document.getElementById("GPisochronTransportPedestrian-"+this._uid),ti&&(ti.checked="true")):(ti=document.getElementById("GPisochronTransportCar-"+this._uid),ti&&(ti.checked="true"));var ii;this._currentComputation.toLowerCase()==="distance"?(ii=document.getElementById("GPisochronChoiceAltDist-"+this._uid),ii&&(ii.checked="true"),document.getElementById("GPisochronValueDist-"+this._uid)&&(document.getElementById("GPisochronValueDist-"+this._uid).className="GPflexInput gpf-flex"),document.getElementById("GPisochronValueChron-"+this._uid)&&(document.getElementById("GPisochronValueChron-"+this._uid).className="GPelementHidden gpf-hidden")):(ii=document.getElementById("GPisochronChoiceAltChron-"+this._uid),ii&&(ii.checked="true"),document.getElementById("GPisochronValueChron-"+this._uid)&&(document.getElementById("GPisochronValueChron-"+this._uid).className="GPflexInput gpf-flex"),document.getElementById("GPisochronValueDist-"+this._uid)&&(document.getElementById("GPisochronValueDist-"+this._uid).className="GPelementHidden gpf-hidden"));var ri=document.getElementById("GPisochronDirectionSelect-"+this._uid);ri&&(ri.value=this._currentDirection),ri.value.toLowerCase()==="arrival"?document.getElementById("GPisochronPointLabelP-"+this._uid).innerHTML="Arrive":document.getElementById("GPisochronPointLabelP-"+this._uid).innerHTML="Dpart";var ni=document.getElementById("GPisoExclusionsToll-"+this._uid);ni&&(this._currentExclusions.indexOf("toll")!==-1?ni.checked=!1:ni.checked=!0);var si=document.getElementById("GPisoExclusionsTunnel-"+this._uid);si&&(this._currentExclusions.indexOf("tunnel")!==-1?si.checked=!1:si.checked=!0);var ai=document.getElementById("GPisoExclusionsBridge-"+this._uid);ai&&(this._currentExclusions.indexOf("bridge")!==-1?ai.checked=!1:ai.checked=!0)}_clearGeojsonLayer(){var e=this.getMap();this._geojsonLayer&&(e.removeLayer(this._geojsonLayer),this._geojsonLayer=null),this._geojsonObject=null}_hideIsoSuggestedLocations(e){e.target&&e.target.id&&e.target.id.indexOf("GPlocationOrigin_")!==-1||this._originPoint._hideSuggestedLocation()}_displayWaitingContainer(){this._waitingContainer.className="GPwaitingContainer GPwaitingContainerVisible gpf-waiting gpf-waiting--visible",this._waiting=!0;var e=this.options.isocurveOptions;if(e&&e.timeOut){this._timer&&(clearTimeout(this._timer),this._timer=null);var n=this;this._timer=setTimeout(function(){n._waiting===!0?n._hideWaitingContainer():n._timer&&clearTimeout(n._timer)},16e3)}}_hideWaitingContainer(){if(this._waiting){this._waitingContainer.className="GPwaitingContainer GPwaitingContainerHidden gpf-waiting gpf-waiting--hidden",this._waiting=!1;var e=this.options.isocurveOptions;e&&e.timeOut&&(clearTimeout(this._timer),this._timer=null)}}}Object.assign(Isocurve.prototype,IsoDOM);Object.assign(Isocurve.prototype,Widget);window.ol&&window.ol.control&&(window.ol.control.Isocurve=Isocurve);const deepEqual=function(_t,e){if(_t===e)return!0;if(typeof _t=="object"&&_t!=null&&typeof e=="object"&&e!=null){if(Object.keys(_t).length!==Object.keys(e).length)return!1;for(var n in _t)if(e.hasOwnProperty(n)){if(!deepEqual(_t[n],e[n]))return!1}else return!1;return!0}else return!1};var ReverseGeocodeDOM={_addUID:function(_t){var e=this._uid?_t+"-"+this._uid:_t;return e},_createMainContainerElement:function(){var _t=document.createElement("div");return _t.id=this._addUID("GPreverseGeocoding"),_t.className="GPwidget gpf-widget gpf-widget-button gpf-mobile-fullscreen",_t},_createShowReverseGeocodingPictoElement:function(){var _t=this,e=document.createElement("button"),n=document.createElement("span");return e.appendChild(n),e.id=this._addUID("GPshowReverseGeocodingPicto"),e.classList.add("GPshowOpen","GPshowAdvancedToolPicto","GPshowReverseGeocodingPicto"),e.classList.add("gpf-btn","gpf-btn--tertiary","gpf-btn-icon","gpf-btn-icon-reverse"),e.classList.add("fr-btn","fr-btn--tertiary"),e.setAttribute("aria-label","Trouver une adresse"),e.setAttribute("tabindex","0"),e.setAttribute("aria-pressed",!1),e.setAttribute("type","button"),e.addEventListener?e.addEventListener("click",function(ei){var ti=ei.target.ariaPressed==="true";ei.target.setAttribute("aria-pressed",!ti),_t.onShowReverseGeocodingClick(ei)}):e.attachEvent&&e.attachEvent("onclick",function(ei){var ti=ei.target.ariaPressed==="true";ei.target.setAttribute("aria-pressed",!ti),_t.onShowReverseGeocodingClick(ei)}),e},_createReverseGeocodingWaitingElement:function(){var _t=document.createElement("div");_t.id=this._addUID("GPreverseGeocodingCalcWaitingContainer"),_t.className="GPwaitingContainer GPwaitingContainerHidden gpf-waiting gpf-waiting--hidden";var e=document.createElement("p");return e.className="GPwaitingContainerInfo gpf-waiting_info",e.innerHTML="Recherche en cours...",_t.appendChild(e),_t},_createReverseGeocodingResultsPanelElement:function(){var _t=document.createElement("div");return _t.id=this._addUID("GPreverseGeocodingResultsPanel"),_t.className="GPpanel GPelementHidden gpf-panel gpf-panel-reverse gpf-panel--hidden",_t},_createReverseGeocodingResultsListElement:function(){var _t=document.createElement("div");return _t.id=this._addUID("GPreverseGeocodingResultsList"),_t.className="gpf-panel__list",_t.setAttribute("tabindex","0"),_t},_createReverseGeocodingResultElement:function(_t,e){var n=this,ei=document.getElementById(this._addUID("GPreverseGeocodingResultsList")),ti=document.createElement("div");if(_t){ti.id=this._addUID("GPreverseGeocodedLocationResultDiv_"+e);var ii=document.createElement("div");ii.id=this._addUID("GPreverseGeocodedLocation_"+e),ii.setAttribute("tabindex","0"),ii.className="GPautoCompleteProposal gpf-panel__items",ii.innerHTML=_t,ii.title=_t,ii.addEventListener?(ii.addEventListener("mouseover",function(si){n.onReverseGeocodingResultMouseOver(si)}),ii.addEventListener("focus",function(si){n.onReverseGeocodingResultMouseOver(si)}),ii.addEventListener("mouseout",function(si){n.onReverseGeocodingResultMouseOut(si)}),ii.addEventListener("blur",function(si){n.onReverseGeocodingResultMouseOut(si)}),ii.addEventListener("click",function(si){typeof n.onReverseGeocodingResultClick=="function"&&n.onReverseGeocodingResultClick(si)})):ii.attachEvent&&(ii.attachEvent("onmouseover",function(si){n.onReverseGeocodingResultMouseOver(si)}),ii.attachEvent("onmouseout",function(si){n.onReverseGeocodingResultMouseOut(si)}),ii.attachEvent("onclick",function(si){typeof n.onReverseGeocodingResultClick=="function"&&n.onReverseGeocodingResultClick(si)}));var ri=document.createElement("button");ri.type="button",ri.id=this._addUID("GPreverseGeocodedLocationResultCopy_"+e),ri.setAttribute("data-text-geolocate",ii.innerHTML),ri.setAttribute("title","Copier le rsultat"),ri.classList.add("gpf-btn-icon-copy-result","fr-btn","fr-btn--tertiary","gpf-btn","gpf-btn--tertiary","gpf-btn-icon"),ri.addEventListener?ri.addEventListener("click",function(si){typeof n.onReverseGeocodingResultCopyButtonClick=="function"&&(n.onReverseGeocodingResultCopyButtonClick(si),ri.classList.add("GPcopiedLocation"),setTimeout(()=>{ri.classList.remove("GPcopiedLocation")},1e3))}):ri.attachEvent&&ri.attachEvent("onclick",function(si){typeof n.onReverseGeocodingResultCopyButtonClick=="function"&&n.onReverseGeocodingResultCopyButtonClick(si)}),ti.appendChild(ii),ti.appendChild(ri)}else{ti.id=this._addUID("GPreverseGeocodedLocationNoResultDiv");var ii=document.createElement("div");ii.id=this._addUID("GPreverseGeocodedNoResult"),ii.setAttribute("tabindex","0"),ii.className="GPautoCompleteProposal gpf-panel__items",ii.innerHTML="Aucun rsultat trouv",ii.title="Aucun rsultat trouv",ti.appendChild(ii)}ei.appendChild(ti)},_createReverseGeocodingPanelElement:function(){var _t=document.createElement("dialog");return _t.id=this._addUID("GPreverseGeocodingPanel"),_t.className="GPpanel gpf-panel fr-modal",_t},_createReverseGeocodingPanelDivElement:function(){var _t=document.createElement("div");return _t.className="gpf-panel__body fr-modal__body",_t},_createReverseGeocodingPanelHeaderElement:function(){var _t=document.createElement("div");return _t.className="GPpanelHeader gpf-panel__header fr-modal__header",_t},_createReverseGeocodingPanelReturnPictoElement:function(){var _t=this,e=document.createElement("button");if(e.id=this._addUID("GPreverseGeocodingReturnPicto"),e.title="Nouvelle recherche",e.className="GPreturnPicto GPimportPanelReturnPicto gpf-btn gpf-btn-icon-return fr-btn fr-btn--close fr-btn--tertiary-no-outline fr-m-1w",e.classList.add("GPelementHidden"),e.classList.add("gpf-hidden"),checkDsfr()){var n=document.createElement("span");n.className="GPelementHidden gpf-visible",n.innerHTML="Retour",e.appendChild(n)}return e.addEventListener?e.addEventListener("click",function(ei){document.getElementById(_t._addUID("GPreverseGeocodingResultsPanel")).className="GPelementHidden gpf-panel--hidden",document.getElementById(_t._addUID("GPreverseGeocodingForm")).className="GPform gpf-panel__content fr-modal__content",document.getElementById(_t._addUID("GPreverseGeocodingHeaderTitle")).innerHTML="Trouver une adresse",document.getElementById(_t._addUID("GPreverseGeocodingReturnPicto")).classList.add("GPelementHidden"),document.getElementById(_t._addUID("GPreverseGeocodingReturnPicto")).classList.add("gpf-hidden"),_t.onGPreverseGeocodingReturnPictoClick(ei)}):e.attachEvent&&e.attachEvent("onclick",function(ei){document.getElementById(_t._addUID("GPreverseGeocodingResultsPanel")).className="GPelementHidden gpf-panel--hidden",document.getElementById(_t._addUID("GPreverseGeocodingForm")).className="GPform gpf-panel__content fr-modal__content",document.getElementById(_t._addUID("GPreverseGeocodingHeaderTitle")).innerHTML="Trouver une adresse",document.getElementById(_t._addUID("GPreverseGeocodingReturnPicto")).classList.add("GPelementHidden"),document.getElementById(_t._addUID("GPreverseGeocodingReturnPicto")).classList.add("gpf-hidden"),_t.onGPreverseGeocodingReturnPictoClick(ei)}),e},_createReverseGeocodingPanelTitleElement:function(){var _t=document.createElement("div");return _t.className="GPpanelTitle gpf-panel__title fr-modal__title fr-pt-4w",_t.id=this._addUID("GPreverseGeocodingHeaderTitle"),_t.innerHTML="Trouver une adresse",_t},_createReverseGeocodingPanelCloseElement:function(){var _t=this,e=document.createElement("button");e.id=this._addUID("GPreverseGeocodingPanelClose"),e.className="GPpanelClose GPreverseGeocodingPanelClose gpf-btn gpf-btn-icon-close fr-btn--close fr-btn fr-btn--tertiary-no-outline fr-m-1w",e.title="Fermer le panneau",e.addEventListener?(e.addEventListener("click",function(){document.getElementById(_t._addUID("GPshowReverseGeocodingPicto")).click()},!1),e.addEventListener("keydown",function(ei){ei.keyCode===13&&document.getElementById(_t._addUID("GPshowReverseGeocodingPicto")).click()},!1)):e.attachEvent&&(e.attachEvent("onclick",function(){document.getElementById(_t._addUID("GPshowReverseGeocodingPicto")).click()}),e.attachEvent("onkeydown",function(ei){ei.keyCode===13&&document.getElementById(_t._addUID("GPshowReverseGeocodingPicto")).click()}));var n=document.createElement("span");return n.className="GPelementHidden gpf-visible",n.innerText="Fermer",e.appendChild(n),e},_createReverseGeocodingPanelFormElement:function(){var _t=this,e=document.createElement("form");return e.id=this._addUID("GPreverseGeocodingForm"),e.className="GPform gpf-panel__content fr-modal__content",e.addEventListener?e.addEventListener("submit",function(n){n.preventDefault(),_t.onReverseGeocodingSubmit()}):e.attachEvent&&e.attachEvent("onsubmit",function(n){n.preventDefault(),_t.onReverseGeocodingSubmit()}),e},_createReverseGeocodingFormModeChoiceGeocodingTypeElement:function(_t){var e=this,n=document.createElement("div");n.className="GPflexInput gpf-flex gpf-flex-reverse fr-mb-1w";var ei=document.createElement("label");ei.id="label-recherche-par",ei.className="GPlabel gpf-label fr-label",ei.innerHTML="Recherche par",ei.title="Recherche par",n.appendChild(ei);var ti=document.createElement("select");ti.setAttribute("aria-labelledby","label-recherche-par"),ti.className="GPselect gpf-select fr-select",ti.addEventListener?ti.addEventListener("change",function(ai){e.onReverseGeocodingTypeChange(ai)}):ti.attachEvent&&ti.attachEvent("onchange",function(ai){e.onReverseGeocodingTypeChange(ai)}),(!_t||!Array.isArray(_t))&&(_t=["StreetAddress","PositionOfInterest","CadastralParcel"]);for(var ii=0;ii<_t.length;ii++)switch(_t[ii]){case"PositionOfInterest":var ri=document.createElement("option");ri.value="PositionOfInterest",ri.text="Lieux/toponymes",ti.appendChild(ri);break;case"StreetAddress":var ni=document.createElement("option");ni.value="StreetAddress",ni.text="Adresses",ti.appendChild(ni);break;case"CadastralParcel":var si=document.createElement("option");si.value="CadastralParcel",si.text="Parcelles cadastrales",ti.appendChild(si);break}return n.appendChild(ti),n},_createReverseGeocodingFormModeChoiceGeocodingDelimitationElement:function(_t){var e=this,n=document.createElement("div");n.className="GPflexInput gpf-flex gpf-flex-reverse fr-mb-2w";var ei=document.createElement("label");ei.id="label-delimitation",ei.className="GPlabel gpf-label fr-label",ei.innerHTML="Dlimitation",ei.title="Dlimitation",n.appendChild(ei);var ti=document.createElement("select");ti.setAttribute("aria-labelledby","label-delimitation"),ti.className="GPselect gpf-select fr-select",ti.addEventListener?ti.addEventListener("change",function(ai){e.onReverseGeocodingDelimitationChange(ai)}):ti.attachEvent&&ti.attachEvent("onchange",function(ai){e.onReverseGeocodingDelimitationChange(ai)}),(!_t||!Array.isArray(_t))&&(_t=["Point","Circle","Extent"]);for(var ii=0;ii<_t.length;ii++)switch(_t[ii].toLowerCase()){case"point":var ri=document.createElement("option");ri.value="point",ri.text="Pointer un lieu",ti.appendChild(ri);break;case"circle":var ni=document.createElement("option");ni.value="circle",ni.text="Dessiner un cercle",ti.appendChild(ni);break;case"extent":var si=document.createElement("option");si.value="extent",si.text="Dessiner une emprise",ti.appendChild(si);break}return n.appendChild(ti),n},_createReverseGeocodingSubmitFormElement:function(){var _t=document.createElement("input");return _t.id=this._addUID("GPreverseGeocodingSubmit"),_t.className="GPsubmit gpf-btn fr-btn",_t.type="submit",_t.value="Rechercher",_t}},logger$m=LoggerByDefault.getLogger("reversegeocoding");class ReverseGeocode extends ControlExtended{constructor(e){if(e=e||{},super(e),!(this instanceof ReverseGeocode))throw new TypeError("ERROR CLASS_CONSTRUCTOR");return this.CLASSNAME="ReverseGeocode",this.initialize(e),this.container=this._initContainer(),this.element?this.element.appendChild(this.container):this.element=this.container,this}getCollapsed(){return this.collapsed}setCollapsed(e){if(e===void 0){logger$m.log("[ERROR] ReverseGeocode:setCollapsed - missing collapsed parameter");return}e&&this.collapsed||!e&&!this.collapsed||(e?this._panelCloseButton.click():this._showReverseGeocodingButton.click(),this.collapsed=e)}setMap(e){if(e)this._activateMapInteraction(e),this.draggable&&Draggable.dragElement(this._panelContainer,this._panelHeaderContainer,e.getTargetElement()),this.collapsed||this._showReverseGeocodingButton.setAttribute("aria-pressed",!0);else{var n=this.getMap();this._clearResults(),this._clearInputFeatures(),this._removeMapInteraction(n),this._inputFeaturesLayer!=null&&(n.removeLayer(this._inputFeaturesLayer),this._inputFeaturesLayer=null,this._inputFeaturesSources=null,this._inputFeatures=null)}super.setMap(e),this.options.position&&this.setPosition(this.options.position),this.options.gutter===!1&&this.getContainer().classList.add("gpf-button-no-gutter")}getData(){return this._reverseGeocodingLocations}getContainer(){return this.container}initialize(e){this._checkInputOptions(e),this.options={collapsed:!0,draggable:!1,resources:["StreetAddress","PositionOfInterest","CadastralParcel"],delimitations:["Point","Circle","Extent"],reverseGeocodeOptions:{},layerDescription:{title:"Saisie (recherche inverse)",description:"Couche de saisie d'une zone de recherche pour la recherche inverse"}},Helper.assign(this.options,e),this.collapsed=this.options.collapsed,this.draggable=this.options.draggable,this._uid=this.options.id||SelectorID.generate(),this._currentGeocodingType=null,this._initGeocodingType(),this._currentGeocodingDelimitation=null,this._initGeocodingDelimitation(),this._showReverseGeocodingButton=null,this._panelContainer=null,this._panelHeaderContainer=null,this._panelTitleContainer=null,this._returnPictoContainer=null,this._panelCloseButton=null,this._formContainer=null,this._resultsContainer=null,this._resultsListContainer=null,this._waitingContainer=null,this._inputFeatures=null,this._inputFeaturesSource=null,this._inputFeaturesLayer=null,this._mapInteraction=null,this._requestOptions=null,this._requestGeom=null,this._requestPosition=null,this._waiting=!1,this._timer=null,this._reverseGeocodingLocations=[],this._reverseGeocodingLocationsMarkers=[],this._resultsDefaultStyle=new Style$1({image:new Icon({src:Marker.lightOrange,anchor:[.5,1]})}),this._resultsSelectedStyle=new Style$1({image:new Icon({src:Marker.red,anchor:[.5,1]})}),this._resultsHoverInteraction=null,this._resultsSelectInteraction=null,this._popupContent=null,this._popupDiv=this._initPopupDiv(),this._popupOverlay=null}_checkInputOptions(e){var n,ei;if(e.resources){var ti=e.resources;if(Array.isArray(ti)){var ii=["StreetAddress","PositionOfInterest","CadastralParcel"],ri=[];for(n=0;n<ti.length;n++)ii.indexOf(ti[n])===-1&&(ri.push(n),logger$m.log("[ReverseGeocode] options.resources : "+ti[n]+" is not a resource for reverse geocode"));if(ri.length!==0)for(ei=0;ei<ri.length;ei++)ti.splice(ri[ei],1)}else logger$m.log("[ReverseGeocode] 'options.resources' parameter should be an array"),ti=null}if(e.delimitations){var ni=e.delimitations;if(Array.isArray(ni)){var si=["Circle","Point","Extent"],ai=[];for(n=0;n<ni.length;n++)si.indexOf(ni[n])===-1&&(ai.push(n),logger$m.log("[ReverseGeocode] options.delimitations : "+ni[n]+" is not a delimitation for reverse geocode"));if(ai.length!==0)for(ei=0;ei<ai.length;ei++)ni.splice(ai[ei],1)}else logger$m.log("[ReverseGeocode] 'options.delimitations' parameter should be an array"),ni=null}}_initGeocodingType(){this._currentGeocodingType="StreetAddress";var e=this.options.resources;(!e||e.length===0)&&(this.options.resources=["StreetAddress","PositionOfInterest","CadastralParcel"]),Array.isArray(e)&&e.length&&(e[0]==="StreetAddress"||e[0]==="PositionOfInterest"||e[0]==="CadastralParcel")&&(this._currentGeocodingType=e[0]);var n=this.options.reverseGeocodeOptions;n.filterOptions&&Array.isArray(n.filterOptions.type)&&n.filterOptions.type.length!==0&&(this._currentGeocodingType=n.filterOptions.type[0])}_initGeocodingDelimitation(){this._currentGeocodingDelimitation="Point";var e=this.options.delimitations;if((!e||e.length===0)&&(this.options.delimitations=["Point","Circle","Extent"]),Array.isArray(e)&&e.length){var n=e[0].toLowerCase();(n==="point"||n==="circle"||n==="extent")&&(this._currentGeocodingDelimitation=e[0])}}_initPopupDiv(){var e=this,n=document.createElement("div");n.className="gp-feature-info-div";var ei=document.createElement("button");return ei.className="gp-styling-button closer",ei.onclick=function(){return e._popupOverlay!=null&&e._popupOverlay.setPosition(void 0),!1},this._popupContent=document.createElement("div"),this._popupContent.className="gp-features-content-div",n.appendChild(this._popupContent),n.appendChild(ei),n}_initContainer(){var e=this._createMainContainerElement(),n=this._showReverseGeocodingButton=this._createShowReverseGeocodingPictoElement();e.appendChild(n);var ei=this._panelContainer=this._createReverseGeocodingPanelElement(),ti=this._createReverseGeocodingPanelDivElement();ei.appendChild(ti);var ii=this._panelHeaderContainer=this._createReverseGeocodingPanelHeaderElement(),ri=this._returnPictoContainer=this._createReverseGeocodingPanelReturnPictoElement();ii.appendChild(ri);var ni=this._panelTitleContainer=this._createReverseGeocodingPanelTitleElement();ii.appendChild(ni);var si=this._panelCloseButton=this._createReverseGeocodingPanelCloseElement();ii.appendChild(si),ti.appendChild(ii);var ai=this._formContainer=this._createReverseGeocodingPanelFormElement();ai.appendChild(this._createReverseGeocodingFormModeChoiceGeocodingTypeElement(this.options.resources)),ai.appendChild(this._createReverseGeocodingFormModeChoiceGeocodingDelimitationElement(this.options.delimitations));var oi=this._createReverseGeocodingSubmitFormElement();ai.appendChild(oi),ti.appendChild(ai);var li=this._waitingContainer=this._createReverseGeocodingWaitingElement();ti.appendChild(li);var ci=this._resultsContainer=this._createReverseGeocodingResultsPanelElement(),ui=this._resultsListContainer=this._createReverseGeocodingResultsListElement();return ci.appendChild(ui),ti.appendChild(ci),e.appendChild(ei),logger$m.log(e),e}_activateMapInteraction(e){if(!this.collapsed){this._inputFeaturesLayer==null&&(this._inputFeatures=new Collection,this._inputFeaturesSource=new VectorSource({features:this._inputFeatures}),this._inputFeaturesLayer=new VectorLayer({source:this._inputFeaturesSource,style:new Style$1({fill:new Fill({color:"rgba(0, 183, 152, 0.3)"}),stroke:new Stroke({color:"rgba(0, 183, 152, 0.8)",width:3}),image:new Icon({src:Marker.turquoiseBlue,anchor:[.5,1]})})}),this._inputFeaturesLayer.gpResultLayerId="reverseGeocoding",e.addLayer(this._inputFeaturesLayer));var n=this._currentGeocodingDelimitation.toLowerCase();switch(n){case"point":this._activatePointInteraction(e);break;case"circle":this._activateCircleInteraction(e);break;case"extent":this._activateBoxInteraction(e);break}e.getControls().forEach(ei=>{if(ei instanceof LayerSwitcher){var ti=this._inputFeaturesLayer.gpLayerId;ei._layers[ti].title===ti&&(ei.addLayer(this._inputFeaturesLayer,{title:this.options.layerDescription.title,description:this.options.layerDescription.description}),ei.setRemovable(this._inputFeaturesLayer,!1))}})}}_activatePointInteraction(e){this._mapInteraction=new Draw({style:new Style$1({image:new CircleStyle({radius:0,fill:new Fill({color:"rgba(0, 183, 152, 0.8)"})})}),type:"Point",source:this._inputFeaturesSource}),this._mapInteraction.on("drawstart",n=>{logger$m.log("on drawstart ",n),this._inputFeatures.clear(),this._onDrawStart(n,"point")}),this._mapInteraction.on("drawend",n=>{logger$m.log("on drawend",n),n.feature&&n.feature.getGeometry&&(this._requestGeom={type:"Point",coordinates:[this._requestPosition.lon,this._requestPosition.lat]})}),e.addInteraction(this._mapInteraction),this._setCursor("crosshair",e)}_activateCircleInteraction(e){this._mapInteraction=new Draw({style:new Style$1({fill:new Fill({color:"rgba(0, 183, 152, 0.3)"}),stroke:new Stroke({color:"rgba(0, 183, 152, 0.8)",width:3}),image:new CircleStyle({radius:4,fill:new Fill({color:"rgba(0, 183, 152, 0.8)"})})}),type:"Circle",source:this._inputFeaturesSource,geometryFunction:function(n,ei){const ti=n[0],ii=n[n.length-1],ri=ti[0]-ii[0],ni=ti[1]-ii[1],ai=Math.min(Math.sqrt(ri*ri+ni*ni),500);return ei?ei.setCenterAndRadius(ti,ai):ei=new Circle(ti,ai),ei}}),this._mapInteraction.on("drawstart",n=>{logger$m.log("on drawstart ",n),this._inputFeatures.clear(),this._onDrawStart(n,"circle")}),this._mapInteraction.on("drawend",n=>{if(logger$m.log("on drawend",n),n.feature&&n.feature.getGeometry){var ei=n.feature.getGeometry().getRadius();this._requestGeom={},this._requestGeom.type="Circle",this._requestGeom.radius=ei,this._requestPosition&&(this._requestGeom.coordinates=[this._requestPosition.lon,this._requestPosition.lat]),logger$m.log("circle radius : ",ei)}}),e.addInteraction(this._mapInteraction)}_activateBoxInteraction(e){var n=function(ei,ti){ti||(ti=new Polygon([]));var ii=ei[0],ri=ei[1];const ni=ii[0]-ri[0],si=ii[1]-ri[1],ai=1e3,oi=Math.max(-ai,Math.min(ni,ai)),li=Math.max(-ai,Math.min(si,ai));return ti.setCoordinates([[ii,[ii[0],ii[1]-li],[ii[0]-oi,ii[1]-li],[ii[0]-oi,ii[1]],ii]]),ti};this._mapInteraction=new Draw({style:new Style$1({fill:new Fill({color:"rgba(0, 183, 152, 0.3)"}),stroke:new Stroke({color:"rgba(0, 183, 152, 0.8)",width:3}),image:new CircleStyle({radius:4,fill:new Fill({color:"rgba(0, 183, 152, 0.8)"})})}),type:"LineString",source:this._inputFeaturesSource,maxPoints:2,geometryFunction:n}),this._mapInteraction.on("drawstart",ei=>{logger$m.log("on drawstart",ei),this._inputFeatures.clear(),this._onDrawStart(ei,"polygon")}),this._mapInteraction.on("drawend",ei=>{logger$m.log("on drawend",ei),this._onBoxDrawEnd(ei)}),e.addInteraction(this._mapInteraction)}_removeMapInteraction(e){this._mapInteraction!=null&&(e.removeInteraction(this._mapInteraction),this._mapInteraction=null),this._setCursor()}_onDrawStart(e,n){var ei;if(e.feature&&e.feature.getGeometry){var ti=e.feature.getGeometry();n==="point"&&(ei=ti.getCoordinates()),n==="circle"&&(ei=ti.getCenter()),n==="polygon"&&(ei=ti.getFirstCoordinate())}if(ei){var ii;if(this.options.reverseGeocodeOptions&&this.options.reverseGeocodeOptions.srs)ii=this.options.reverseGeocodeOptions.srs;else{var ri=this.getMap();if(!ri||!ri.getView())return;ii=ri.getView().getProjection()}var ni=transform$1(ei,ii,"EPSG:4326");this._requestPosition={lon:ni[0],lat:ni[1]},logger$m.log("position coordinates : ",this._requestPosition)}}_onBoxDrawEnd(e){if(e.feature&&e.feature.getGeometry){var n=e.feature.getGeometry().getCoordinates()[0],ei=n[0],ti=n[2],ii;if(this.options.reverseGeocodeOptions&&this.options.reverseGeocodeOptions.srs)ii=this.options.reverseGeocodeOptions.srs;else{var ri=this.getMap();if(!ri||!ri.getView())return;ii=ri.getView().getProjection()}var ni=transform$1(ei,ii,"EPSG:4326"),si=transform$1(ti,ii,"EPSG:4326"),ai={};ni[0]<si[0]?(ai.left=ni[0],ai.right=si[0]):(ai.left=si[0],ai.right=ni[0]),ni[1]<si[1]?(ai.bottom=ni[1],ai.top=si[1]):(ai.bottom=si[1],ai.top=ni[1]),this._requestGeom={type:"Polygon",coordinates:[[[ai.left,ai.top],[ai.left,ai.bottom],[ai.right,ai.bottom],[ai.right,ai.top],[ai.left,ai.top]]]},logger$m.log("searchGeometry filter : ",this._requestGeom)}}_setCursor(e,n){if(n=n||this.getMap(),!!n){var ei=n.getTargetElement();e?ei.style.cursor=e:ei.style.cursor=null}}_reverseGeocodingRequest(){var e=this.getMap();this._requestOptions=this._getReverseGeocodingRequestOptions(),this._removeMapInteraction(e),this._displayWaitingContainer(),Gp.Services.reverseGeocode(this._requestOptions)}_getReverseGeocodingRequestOptions(){var e=this.getMap(),n=this.options.reverseGeocodeOptions,ei=this;typeof this.options.ssl!="boolean"&&(this.options.ssl=!0);var ti=n.onFailure!==null&&typeof n.onFailure=="function",ii=n.onSuccess!==null&&typeof n.onSuccess=="function",ri={apiKey:n.apiKey||this.options.apiKey,ssl:this.options.ssl,position:this._requestPosition,filterOptions:{type:[this._currentGeocodingType]},srs:"CRS:84",returnFreeForm:!1,maximumResponses:n.maximumResponses||18,timeOut:n.timeOut||3e4,onSuccess:function(ni){ni.locations&&(logger$m.log("reverseGeocode results : ",ni.locations),ei._displayGeocodedLocations(ni.locations)),ii&&n.onSuccess.call(ei,ni.locations)},onFailure:function(ni){ei._hideWaitingContainer(),ei._clearResults(),ei._clearInputFeatures(),ei._activateMapInteraction(e),logger$m.log(ni.message),ti&&n.onFailure.call(ei,ni)}};return this._requestGeom.type.toLowerCase()==="circle"?(this._requestGeom.radius>500&&(logger$m.log("INFO : initial circle radius ("+this._requestGeom.radius+") limited to 1000m."),this._requestGeom.radius=500),ri.searchGeometry=this._requestGeom):this._requestGeom.type.toLowerCase()==="polygon"?ri.searchGeometry=this._requestGeom:this._requestGeom.type.toLowerCase()==="point"&&(this._currentGeocodingType==="StreetAddress"?(ri.searchGeometry={type:"Circle",radius:50,coordinates:this._requestGeom.coordinates},ri.maximumResponses=1):ri.searchGeometry=this._requestGeom),logger$m.log("reverseGeocode request options : ",ri),ri}_displayGeocodedLocations(e){this._clearResults(),this._reverseGeocodingLocations=e,this.dispatchEvent({type:"reversegeocode:compute"}),this._formContainer.className="GPelementHidden gpf-hidden",this._hideWaitingContainer(),this._panelTitleContainer.innerHTML="Rsultats de la recherche",this._returnPictoContainer.classList.remove("GPelementHidden"),this._returnPictoContainer.classList.remove("gpf-hidden"),this._resultsContainer.className="GPform gpf-panel__content fr-modal__content",this._fillGeocodedLocationListContainer(e),this._displayGeocodedLocationsOnMap(e)}_fillGeocodedLocationListContainer(e){e.length===0&&this._createReverseGeocodingResultElement();for(var n=0;n<e.length;n++){var ei=e[n];logger$m.log(ei);var ti=this._fillGeocodedLocationDescription(ei);ti&&ti.length!==0&&this._createReverseGeocodingResultElement(ti,n)}}_fillGeocodedLocationDescription(e){if(!(!e||!e.placeAttributes)){var n=e.placeAttributes,ei="";switch(e.type){case"StreetAddress":n.street&&(ei+=n.housenumber?n.housenumber+" ":"",ei+=n.street+", "),ei+=n.postcode+" "+n.city;break;case"PositionOfInterest":ei+=n.toponym,n.postcode&&n.postcode.length===1&&(ei+=", "+n.postcode[0]),ei+=" ("+n.category.join(",")+")";break;case"CadastralParcel":ei+=n.id,ei+=n.city?" ("+n.city+")":"";break;default:ei+=n.city?n.city:"";break}return ei}}_displayGeocodedLocationsOnMap(e){if(this._reverseGeocodingLocations.length!==0){var n=this.getMap();this._createResultsLayer();for(var ei=0;ei<e.length;ei++)this._addResultFeature(e[ei],ei);if(this._resultsFeatures.getLength()>1){if(this._resultsFeaturesSource&&this._resultsFeaturesSource.getExtent){var ti=this._resultsFeaturesSource.getExtent();n.getView().fit(ti,n.getSize())}}else{var ii=this._resultsFeatures.item(0),ri=ii.getGeometry().getCoordinates();n.getView().setCenter(ri),n.getView().setZoom(17)}this._resultsHoverInteraction=new Select({condition:pointerMove,layers:[this._resultsFeaturesLayer]}),this._resultsHoverInteraction.on("select",si=>this._onResultsFeatureMouseOver(si)),n.addInteraction(this._resultsHoverInteraction),this._resultsSelectInteraction=new Select({layers:[this._resultsFeaturesLayer]}),this._resultsSelectInteraction.on("select",si=>this._onResultsFeatureSelect(si)),n.addInteraction(this._resultsSelectInteraction);var ni="";switch(this._currentGeocodingType){case"StreetAddress":ni="adresses";break;case"PositionOfInterest":ni="toponymes";break;case"CadastralParcel":ni="parcelles cadastrales";break}n.getControls().forEach(si=>{if(si instanceof LayerSwitcher){var ai=this._resultsFeaturesLayer.gpLayerId;si._layers[ai].title===ai&&(si.addLayer(this._resultsFeaturesLayer,{title:"Rsultats de la recherche inverse",description:"Rsultats de la recherche inverse sur les "+ni}),si.setRemovable(this._resultsFeaturesLayer,!1))}})}}_createResultsLayer(){var e=this.getMap();this._resultsFeatures=new Collection,this._resultsFeaturesSource=new VectorSource({features:this._resultsFeatures}),this._resultsFeaturesLayer=new VectorLayer({source:this._resultsFeaturesSource}),this._resultsFeaturesLayer.gpResultLayerId="reverseGeocodingResults",e.addLayer(this._resultsFeaturesLayer)}_addResultFeature(e,n){var ei=this.getMap(),ti=[e.position.lon,e.position.lat];if(ti.length!==0){var ii=ei.getView(),ri=ii.getProjection().getCode();ri!=="EPSG:4326"&&(ti=transform$1(ti,"EPSG:4326",ri));var ni=new Feature({geometry:new Point$1(ti)});ni.setStyle(this._resultsDefaultStyle),ni.setId(n),ni.setProperties({location:e,popupContent:this._fillPopupContent(e)}),this._resultsFeatures.push(ni)}}_fillPopupContent(e){var n="<ul>",ei=e.placeAttributes;for(var ti in ei)ei.hasOwnProperty(ti)&&ti!=="trueGeometry"&&ti!=="extraFields"&&ti!=="houseNumberInfos"&&ti!=="_count"&&(n+="<li>",n+='<span class="gp-attname-others-span">'+ti.toUpperCase()+" : </span>",n+=ei[ti],n+=" </li>");return n+=" </ul>",n}_onResultsFeatureMouseOver(e){var n;if(e.selected.length!==0){if(n=e.selected[0],n.setStyle(this._resultsSelectedStyle),n.getId()!=null){var ei=document.getElementById("GPreverseGeocodedLocation_"+n.getId()+"-"+this._uid);ei&&ei.classList&&ei.classList.add("GPlocationHighlight")}document.getElementById("GPreverseGeocodedLocation_"+n.getId()+"-"+this._uid)}if(e.deselected.length!==0){n=e.deselected[0],n.setStyle(this._resultsDefaultStyle);var ti=document.getElementById("GPreverseGeocodedLocation_"+n.getId()+"-"+this._uid);ti&&ti.classList&&ti.classList.remove("GPlocationHighlight")}}_onResultsFeatureSelect(e){var n=this.getMap();if(e.selected.length!==0){var ei=e.selected[0];this._popupContent.innerHTML=ei.getProperties().popupContent,this._popupOverlay?this._popupOverlay.setPosition(e.mapBrowserEvent.coordinate):(this._popupOverlay=new Overlay({element:this._popupDiv,positioning:"bottom-center",position:e.mapBrowserEvent.coordinate}),n.addOverlay(this._popupOverlay)),this.dispatchEvent({type:"reversegeocode:onclickresult",location:ei.getProperties().location})}else this._popupOverlay!=null&&this._popupOverlay.setPosition(void 0)}onShowReverseGeocodingClick(e){e.target.ariaPressed==="true"&&this.onPanelOpen();var n=this.getMap();if(n){Interactions.unset(n);var ei=this._showReverseGeocodingButton.ariaPressed;this.collapsed=ei!=="true",this.dispatchEvent("change:collapsed"),this.options.position&&!this.collapsed&&this.updatePosition(this.options.position),!this._waiting&&!this._reverseGeocodingLocations.length&&(this.collapsed?(this._clearResults(),this._clearInputFeatures(),this._removeMapInteraction(n),this._inputFeaturesLayer!=null&&(n.removeLayer(this._inputFeaturesLayer),this._inputFeaturesLayer=null,this._inputFeaturesSources=null,this._inputFeatures=null)):this._activateMapInteraction(n))}}onReverseGeocodingTypeChange(e){var n=e.target.selectedIndex,ei=e.target.options[n].value;ei&&(logger$m.log(ei),this._currentGeocodingType=ei)}onReverseGeocodingDelimitationChange(e){var n=e.target.selectedIndex,ei=e.target.options[n].value;if(ei){logger$m.log(ei),this._currentGeocodingDelimitation=ei;var ti=this.getMap();this._clearInputFeatures(),this._removeMapInteraction(ti),this._activateMapInteraction(ti)}}onGPreverseGeocodingReturnPictoClick(){this._clearResults(),this._clearInputFeatures(),this._activateMapInteraction(this.getMap())}onReverseGeocodingSubmit(){if(!this._requestPosition){logger$m.log("missing position");return}this._reverseGeocodingRequest()}onReverseGeocodingResultClick(e){var n=e.target.id,ei=n.substring(n.indexOf("_")+1),ti=this._resultsFeaturesSource.getFeatureById(parseInt(ei,10));this.dispatchEvent({type:"reversegeocode:onclickresult",location:ti.getProperties().location})}onReverseGeocodingResultMouseOver(e){var n=e.target.id,ei=n.substring(n.indexOf("_")+1);if(e.target.classList&&e.target.classList.add("GPlocationHighlight"),!!this._resultsFeaturesSource){var ti=this._resultsFeaturesSource.getFeatureById(parseInt(ei,10));ti.setStyle(this._resultsSelectedStyle)}}onReverseGeocodingResultMouseOut(e){var n=e.target.id,ei=n.substring(n.indexOf("_")+1);if(e.target.classList&&e.target.classList.remove("GPlocationHighlight"),!!this._resultsFeaturesSource){var ti=this._resultsFeaturesSource.getFeatureById(parseInt(ei,10));ti.setStyle(this._resultsDefaultStyle)}}onReverseGeocodingResultCopyButtonClick(e){navigator.clipboard.writeText(e.target.getAttribute("data-text-geolocate")).then(()=>console.log("Texte copi !")).catch(n=>console.error("Erreur de copie :",n))}_clearResults(){var e=this.getMap();if(this._reverseGeocodingLocations=[],this._resultsListContainer)for(;this._resultsListContainer.firstChild;)this._resultsListContainer.removeChild(this._resultsListContainer.firstChild);this._resultsFeaturesLayer&&(e.removeLayer(this._resultsFeaturesLayer),this._resultsFeaturesLayer=null),this._popupOverlay!=null&&(e.removeOverlay(this._popupOverlay),this._popupOverlay=null),this._resultsSelectInteraction!=null&&(e.removeInteraction(this._resultsSelectInteraction),this._resultsSelectInteraction=null),this._resultsHoverInteraction!=null&&(e.removeInteraction(this._resultsHoverInteraction),this._resultsHoverInteraction=null)}_clearInputFeatures(){this._inputFeatures&&this._inputFeatures.clear(),this._requestGeom=null,this._requestPosition=null}_displayWaitingContainer(){this._waitingContainer.className="GPwaitingContainer GPwaitingContainerVisible gpf-waiting gpf-waiting--visible",this._waiting=!0,this._timer&&(clearTimeout(this._timer),this._timer=null);var e=this;this._timer=setTimeout(function(){e._waiting===!0?e._hideWaitingContainer():e._timer&&clearTimeout(e._timer)},16e3)}_hideWaitingContainer(){this._waiting&&(this._waitingContainer.className="GPwaitingContainer GPwaitingContainerHidden gpf-waiting gpf-waiting--hidden",this._waiting=!1,clearTimeout(this._timer),this._timer=null)}}Object.assign(ReverseGeocode.prototype,ReverseGeocodeDOM);Object.assign(ReverseGeocode.prototype,Widget);window.ol&&window.ol.control&&(window.ol.control.ReverseGeocode=ReverseGeocode);class XML{read(e){if(!e)return null;if(typeof e=="string"){const n=parse$1(e);return this.readFromDocument(n)}return isDocument(e)?this.readFromDocument(e):this.readFromNode(e)}readFromDocument(e){for(let n=e.firstChild;n;n=n.nextSibling)if(n.nodeType==Node.ELEMENT_NODE)return this.readFromNode(n);return null}readFromNode(e){abstract()}}const NAMESPACE_URI="http://www.w3.org/1999/xlink";function readHref(_t){return _t.getAttributeNS(NAMESPACE_URI,"href")}const NAMESPACE_URIS$2=[null,"http://www.opengis.net/wms","http://www.opengis.net/sld"];function isV13(_t){return compareVersions(_t[0].version,"1.3")>=0}const PARSERS$2=makeStructureNS(NAMESPACE_URIS$2,{Service:makeObjectPropertySetter(readService),Capability:makeObjectPropertySetter(readCapability)}),CAPABILITY_PARSERS=makeStructureNS(NAMESPACE_URIS$2,{Request:makeObjectPropertySetter(readRequest),Exception:makeObjectPropertySetter(readException),Layer:makeObjectPropertySetter(readCapabilityLayer),UserDefinedSymbolization:makeObjectPropertySetter(readUserDefinedSymbolization)});class WMSCapabilities extends XML{constructor(){super(),this.version=void 0}readFromNode(e){this.version=e.getAttribute("version").trim();const n=pushParseAndPop({version:this.version},PARSERS$2,e,[]);return n||null}}const COMMON_SERVICE_PARSERS={Name:makeObjectPropertySetter(readString),Title:makeObjectPropertySetter(readString),Abstract:makeObjectPropertySetter(readString),KeywordList:makeObjectPropertySetter(readKeywordList),OnlineResource:makeObjectPropertySetter(readHref),ContactInformation:makeObjectPropertySetter(readContactInformation),Fees:makeObjectPropertySetter(readString),AccessConstraints:makeObjectPropertySetter(readString)},SERVICE_PARSERS=makeStructureNS(NAMESPACE_URIS$2,COMMON_SERVICE_PARSERS),SERVICE_PARSERS_V13=makeStructureNS(NAMESPACE_URIS$2,{...COMMON_SERVICE_PARSERS,LayerLimit:makeObjectPropertySetter(readPositiveInteger),MaxWidth:makeObjectPropertySetter(readPositiveInteger),MaxHeight:makeObjectPropertySetter(readPositiveInteger)}),CONTACT_INFORMATION_PARSERS=makeStructureNS(NAMESPACE_URIS$2,{ContactPersonPrimary:makeObjectPropertySetter(readContactPersonPrimary),ContactPosition:makeObjectPropertySetter(readString),ContactAddress:makeObjectPropertySetter(readContactAddress),ContactVoiceTelephone:makeObjectPropertySetter(readString),ContactFacsimileTelephone:makeObjectPropertySetter(readString),ContactElectronicMailAddress:makeObjectPropertySetter(readString)}),CONTACT_PERSON_PARSERS=makeStructureNS(NAMESPACE_URIS$2,{ContactPerson:makeObjectPropertySetter(readString),ContactOrganization:makeObjectPropertySetter(readString)}),CONTACT_ADDRESS_PARSERS=makeStructureNS(NAMESPACE_URIS$2,{AddressType:makeObjectPropertySetter(readString),Address:makeObjectPropertySetter(readString),City:makeObjectPropertySetter(readString),StateOrProvince:makeObjectPropertySetter(readString),PostCode:makeObjectPropertySetter(readString),Country:makeObjectPropertySetter(readString)}),EXCEPTION_PARSERS=makeStructureNS(NAMESPACE_URIS$2,{Format:makeArrayPusher(readString)}),COMMON_LAYER_PARSERS={Name:makeObjectPropertySetter(readString),Title:makeObjectPropertySetter(readString),Abstract:makeObjectPropertySetter(readString),KeywordList:makeObjectPropertySetter(readKeywordList),BoundingBox:makeObjectPropertyPusher(readBoundingBox$1),Dimension:makeObjectPropertyPusher(readDimension),Attribution:makeObjectPropertySetter(readAttribution),AuthorityURL:makeObjectPropertyPusher(readAuthorityURL),Identifier:makeObjectPropertyPusher(readString),MetadataURL:makeObjectPropertyPusher(readMetadataURL),DataURL:makeObjectPropertyPusher(readFormatOnlineresource),FeatureListURL:makeObjectPropertyPusher(readFormatOnlineresource),Style:makeObjectPropertyPusher(readStyle$1),Layer:makeObjectPropertyPusher(readLayer$1)},LAYER_PARSERS$1=makeStructureNS(NAMESPACE_URIS$2,{...COMMON_LAYER_PARSERS,SRS:makeObjectPropertyPusher(readString),Extent:makeObjectPropertySetter(readExtent),ScaleHint:makeObjectPropertyPusher(readScaleHint),LatLonBoundingBox:makeObjectPropertySetter((_t,e)=>readBoundingBox$1(_t,e,!1)),Layer:makeObjectPropertyPusher(readLayer$1)}),LAYER_PARSERS_V13=makeStructureNS(NAMESPACE_URIS$2,{...COMMON_LAYER_PARSERS,CRS:makeObjectPropertyPusher(readString),EX_GeographicBoundingBox:makeObjectPropertySetter(readEXGeographicBoundingBox),MinScaleDenominator:makeObjectPropertySetter(readDecimal),MaxScaleDenominator:makeObjectPropertySetter(readDecimal),Layer:makeObjectPropertyPusher(readLayer$1)}),ATTRIBUTION_PARSERS=makeStructureNS(NAMESPACE_URIS$2,{Title:makeObjectPropertySetter(readString),OnlineResource:makeObjectPropertySetter(readHref),LogoURL:makeObjectPropertySetter(readSizedFormatOnlineresource)}),EX_GEOGRAPHIC_BOUNDING_BOX_PARSERS=makeStructureNS(NAMESPACE_URIS$2,{westBoundLongitude:makeObjectPropertySetter(readDecimal),eastBoundLongitude:makeObjectPropertySetter(readDecimal),southBoundLatitude:makeObjectPropertySetter(readDecimal),northBoundLatitude:makeObjectPropertySetter(readDecimal)}),REQUEST_PARSERS=makeStructureNS(NAMESPACE_URIS$2,{GetCapabilities:makeObjectPropertySetter(readOperationType),GetMap:makeObjectPropertySetter(readOperationType),GetFeatureInfo:makeObjectPropertySetter(readOperationType),DescribeLayer:makeObjectPropertySetter(readOperationType),GetLegendGraphic:makeObjectPropertySetter(readOperationType)}),OPERATIONTYPE_PARSERS=makeStructureNS(NAMESPACE_URIS$2,{Format:makeObjectPropertyPusher(readString),DCPType:makeObjectPropertyPusher(readDCPType)}),DCPTYPE_PARSERS=makeStructureNS(NAMESPACE_URIS$2,{HTTP:makeObjectPropertySetter(readHTTP)}),HTTP_PARSERS$1=makeStructureNS(NAMESPACE_URIS$2,{Get:makeObjectPropertySetter(readFormatOnlineresource),Post:makeObjectPropertySetter(readFormatOnlineresource)}),STYLE_PARSERS$1=makeStructureNS(NAMESPACE_URIS$2,{Name:makeObjectPropertySetter(readString),Title:makeObjectPropertySetter(readString),Abstract:makeObjectPropertySetter(readString),LegendURL:makeObjectPropertyPusher(readSizedFormatOnlineresource),StyleSheetURL:makeObjectPropertySetter(readFormatOnlineresource),StyleURL:makeObjectPropertySetter(readFormatOnlineresource)}),FORMAT_ONLINERESOURCE_PARSERS=makeStructureNS(NAMESPACE_URIS$2,{Format:makeObjectPropertySetter(readString),OnlineResource:makeObjectPropertySetter(readHref)}),KEYWORDLIST_PARSERS=makeStructureNS(NAMESPACE_URIS$2,{Keyword:makeArrayPusher(readString)});function readAttribution(_t,e){return pushParseAndPop({},ATTRIBUTION_PARSERS,_t,e)}function readUserDefinedSymbolization(_t,e){return{SupportSLD:!!readBooleanString(_t.getAttribute("SupportSLD")),UserLayer:!!readBooleanString(_t.getAttribute("UserLayer")),UserStyle:!!readBooleanString(_t.getAttribute("UserStyle")),RemoteWFS:!!readBooleanString(_t.getAttribute("RemoteWFS")),InlineFeatureData:!!readBooleanString(_t.getAttribute("InlineFeatureData")),RemoteWCS:!!readBooleanString(_t.getAttribute("RemoteWCS"))}}function readBoundingBox$1(_t,e,n=!0){const ei=[readDecimalString(_t.getAttribute("minx")),readDecimalString(_t.getAttribute("miny")),readDecimalString(_t.getAttribute("maxx")),readDecimalString(_t.getAttribute("maxy"))],ti=[readDecimalString(_t.getAttribute("resx")),readDecimalString(_t.getAttribute("resy"))],ii={extent:ei,res:ti};return n&&(isV13(e)?ii.crs=_t.getAttribute("CRS"):ii.srs=_t.getAttribute("SRS")),ii}function readEXGeographicBoundingBox(_t,e){const n=pushParseAndPop({},EX_GEOGRAPHIC_BOUNDING_BOX_PARSERS,_t,e);if(!n)return;const ei=n.westBoundLongitude,ti=n.southBoundLatitude,ii=n.eastBoundLongitude,ri=n.northBoundLatitude;if(!(ei===void 0||ti===void 0||ii===void 0||ri===void 0))return[ei,ti,ii,ri]}function readCapability(_t,e){return pushParseAndPop({},CAPABILITY_PARSERS,_t,e)}function readService(_t,e){return pushParseAndPop({},isV13(e)?SERVICE_PARSERS_V13:SERVICE_PARSERS,_t,e)}function readContactInformation(_t,e){return pushParseAndPop({},CONTACT_INFORMATION_PARSERS,_t,e)}function readContactPersonPrimary(_t,e){return pushParseAndPop({},CONTACT_PERSON_PARSERS,_t,e)}function readContactAddress(_t,e){return pushParseAndPop({},CONTACT_ADDRESS_PARSERS,_t,e)}function readException(_t,e){return pushParseAndPop([],EXCEPTION_PARSERS,_t,e)}function readCapabilityLayer(_t,e){const n=pushParseAndPop({},isV13(e)?LAYER_PARSERS_V13:LAYER_PARSERS$1,_t,e);return n.Layer===void 0?Object.assign(n,readLayer$1(_t,e)):n}function readLayer$1(_t,e){const n=isV13(e),ei=e[e.length-1],ti=pushParseAndPop({},n?LAYER_PARSERS_V13:LAYER_PARSERS$1,_t,e);if(!ti)return;let ii=readBooleanString(_t.getAttribute("queryable"));ii===void 0&&(ii=ei.queryable),ti.queryable=ii!==void 0?ii:!1;let ri=readNonNegativeIntegerString(_t.getAttribute("cascaded"));ri===void 0&&(ri=ei.cascaded),ti.cascaded=ri;let ni=readBooleanString(_t.getAttribute("opaque"));ni===void 0&&(ni=ei.opaque),ti.opaque=ni!==void 0?ni:!1;let si=readBooleanString(_t.getAttribute("noSubsets"));si===void 0&&(si=ei.noSubsets),ti.noSubsets=si!==void 0?si:!1;let ai=readDecimalString(_t.getAttribute("fixedWidth"));ai||(ai=ei.fixedWidth),ti.fixedWidth=ai;let oi=readDecimalString(_t.getAttribute("fixedHeight"));oi||(oi=ei.fixedHeight),ti.fixedHeight=oi;const li=["Style","AuthorityURL"];n?li.push("CRS"):li.push("SRS","Dimension"),li.forEach(function(ui){if(ui in ei){const di=ti[ui]||[];ti[ui]=di.concat(ei[ui])}});const ci=["BoundingBox","Attribution"];return n?ci.push("Dimension","EX_GeographicBoundingBox","MinScaleDenominator","MaxScaleDenominator"):ci.push("LatLonBoundingBox","ScaleHint","Extent"),ci.forEach(function(ui){if(!(ui in ti)){const di=ei[ui];ti[ui]=di}}),ti}function readDimension(_t,e){const n={name:_t.getAttribute("name"),units:_t.getAttribute("units"),unitSymbol:_t.getAttribute("unitSymbol")};return isV13(e)&&Object.assign(n,{default:_t.getAttribute("default"),multipleValues:readBooleanString(_t.getAttribute("multipleValues")),nearestValue:readBooleanString(_t.getAttribute("nearestValue")),current:readBooleanString(_t.getAttribute("current")),values:readString(_t)}),n}function readExtent(_t,e){return{name:_t.getAttribute("name"),default:_t.getAttribute("default"),nearestValue:readBooleanString(_t.getAttribute("nearestValue"))}}function readScaleHint(_t,e){return{min:readDecimalString(_t.getAttribute("min")),max:readDecimalString(_t.getAttribute("max"))}}function readFormatOnlineresource(_t,e){return pushParseAndPop({},FORMAT_ONLINERESOURCE_PARSERS,_t,e)}function readRequest(_t,e){return pushParseAndPop({},REQUEST_PARSERS,_t,e)}function readDCPType(_t,e){return pushParseAndPop({},DCPTYPE_PARSERS,_t,e)}function readHTTP(_t,e){return pushParseAndPop({},HTTP_PARSERS$1,_t,e)}function readOperationType(_t,e){return pushParseAndPop({},OPERATIONTYPE_PARSERS,_t,e)}function readSizedFormatOnlineresource(_t,e){const n=readFormatOnlineresource(_t,e);if(n){const ei=[readNonNegativeIntegerString(_t.getAttribute("width")),readNonNegativeIntegerString(_t.getAttribute("height"))];return n.size=ei,n}}function readAuthorityURL(_t,e){const n=readFormatOnlineresource(_t,e);if(n)return n.name=_t.getAttribute("name"),n}function readMetadataURL(_t,e){const n=readFormatOnlineresource(_t,e);if(n)return n.type=_t.getAttribute("type"),n}function readStyle$1(_t,e){return pushParseAndPop({},STYLE_PARSERS$1,_t,e)}function readKeywordList(_t,e){return pushParseAndPop([],KEYWORDLIST_PARSERS,_t,e)}const NAMESPACE_URIS$1=[null,"http://www.opengis.net/ows/1.1"],PARSERS$1=makeStructureNS(NAMESPACE_URIS$1,{ServiceIdentification:makeObjectPropertySetter(readServiceIdentification),ServiceProvider:makeObjectPropertySetter(readServiceProvider),OperationsMetadata:makeObjectPropertySetter(readOperationsMetadata)});class OWS extends XML{constructor(){super()}readFromNode(e){const n=pushParseAndPop({},PARSERS$1,e,[]);return n||null}}const ADDRESS_PARSERS=makeStructureNS(NAMESPACE_URIS$1,{DeliveryPoint:makeObjectPropertySetter(readString),City:makeObjectPropertySetter(readString),AdministrativeArea:makeObjectPropertySetter(readString),PostalCode:makeObjectPropertySetter(readString),Country:makeObjectPropertySetter(readString),ElectronicMailAddress:makeObjectPropertySetter(readString)}),ALLOWED_VALUES_PARSERS=makeStructureNS(NAMESPACE_URIS$1,{Value:makeObjectPropertyPusher(readValue)}),CONSTRAINT_PARSERS=makeStructureNS(NAMESPACE_URIS$1,{AllowedValues:makeObjectPropertySetter(readAllowedValues)}),CONTACT_INFO_PARSERS=makeStructureNS(NAMESPACE_URIS$1,{Phone:makeObjectPropertySetter(readPhone),Address:makeObjectPropertySetter(readAddress)}),DCP_PARSERS=makeStructureNS(NAMESPACE_URIS$1,{HTTP:makeObjectPropertySetter(readHttp)}),HTTP_PARSERS=makeStructureNS(NAMESPACE_URIS$1,{Get:makeObjectPropertyPusher(readGet),Post:void 0}),OPERATION_PARSERS=makeStructureNS(NAMESPACE_URIS$1,{DCP:makeObjectPropertySetter(readDcp)}),OPERATIONS_METADATA_PARSERS=makeStructureNS(NAMESPACE_URIS$1,{Operation:readOperation}),PHONE_PARSERS=makeStructureNS(NAMESPACE_URIS$1,{Voice:makeObjectPropertySetter(readString),Facsimile:makeObjectPropertySetter(readString)}),REQUEST_METHOD_PARSERS=makeStructureNS(NAMESPACE_URIS$1,{Constraint:makeObjectPropertyPusher(readConstraint)}),SERVICE_CONTACT_PARSERS=makeStructureNS(NAMESPACE_URIS$1,{IndividualName:makeObjectPropertySetter(readString),PositionName:makeObjectPropertySetter(readString),ContactInfo:makeObjectPropertySetter(readContactInfo)}),SERVICE_IDENTIFICATION_PARSERS=makeStructureNS(NAMESPACE_URIS$1,{Abstract:makeObjectPropertySetter(readString),AccessConstraints:makeObjectPropertySetter(readString),Fees:makeObjectPropertySetter(readString),Title:makeObjectPropertySetter(readString),ServiceTypeVersion:makeObjectPropertySetter(readString),ServiceType:makeObjectPropertySetter(readString)}),SERVICE_PROVIDER_PARSERS=makeStructureNS(NAMESPACE_URIS$1,{ProviderName:makeObjectPropertySetter(readString),ProviderSite:makeObjectPropertySetter(readHref),ServiceContact:makeObjectPropertySetter(readServiceContact)});function readAddress(_t,e){return pushParseAndPop({},ADDRESS_PARSERS,_t,e)}function readAllowedValues(_t,e){return pushParseAndPop({},ALLOWED_VALUES_PARSERS,_t,e)}function readConstraint(_t,e){const n=_t.getAttribute("name");if(n)return pushParseAndPop({name:n},CONSTRAINT_PARSERS,_t,e)}function readContactInfo(_t,e){return pushParseAndPop({},CONTACT_INFO_PARSERS,_t,e)}function readDcp(_t,e){return pushParseAndPop({},DCP_PARSERS,_t,e)}function readGet(_t,e){const n=readHref(_t);if(n)return pushParseAndPop({href:n},REQUEST_METHOD_PARSERS,_t,e)}function readHttp(_t,e){return pushParseAndPop({},HTTP_PARSERS,_t,e)}function readOperation(_t,e){const n=_t.getAttribute("name"),ei=pushParseAndPop({},OPERATION_PARSERS,_t,e);if(!ei)return;const ti=e[e.length-1];ti[n]=ei}function readOperationsMetadata(_t,e){return pushParseAndPop({},OPERATIONS_METADATA_PARSERS,_t,e)}function readPhone(_t,e){return pushParseAndPop({},PHONE_PARSERS,_t,e)}function readServiceIdentification(_t,e){return pushParseAndPop({},SERVICE_IDENTIFICATION_PARSERS,_t,e)}function readServiceContact(_t,e){return pushParseAndPop({},SERVICE_CONTACT_PARSERS,_t,e)}function readServiceProvider(_t,e){return pushParseAndPop({},SERVICE_PROVIDER_PARSERS,_t,e)}function readValue(_t,e){return readString(_t)}const NAMESPACE_URIS=[null,"http://www.opengis.net/wmts/1.0"],OWS_NAMESPACE_URIS=[null,"http://www.opengis.net/ows/1.1"],PARSERS=makeStructureNS(NAMESPACE_URIS,{Contents:makeObjectPropertySetter(readContents)});class WMTSCapabilities extends XML{constructor(){super(),this.owsParser_=new OWS}readFromNode(e){let n=e.getAttribute("version");n&&(n=n.trim());let ei=this.owsParser_.readFromNode(e);return ei?(ei.version=n,ei=pushParseAndPop(ei,PARSERS,e,[]),ei||null):null}}const CONTENTS_PARSERS=makeStructureNS(NAMESPACE_URIS,{Layer:makeObjectPropertyPusher(readLayer),TileMatrixSet:makeObjectPropertyPusher(readTileMatrixSet)}),LAYER_PARSERS=makeStructureNS(NAMESPACE_URIS,{Style:makeObjectPropertyPusher(readStyle),Format:makeObjectPropertyPusher(readString),TileMatrixSetLink:makeObjectPropertyPusher(readTileMatrixSetLink),Dimension:makeObjectPropertyPusher(readDimensions),ResourceURL:makeObjectPropertyPusher(readResourceUrl)},makeStructureNS(OWS_NAMESPACE_URIS,{Title:makeObjectPropertySetter(readString),Abstract:makeObjectPropertySetter(readString),WGS84BoundingBox:makeObjectPropertySetter(readBoundingBox),BoundingBox:makeObjectPropertyPusher(readBoundingBoxWithCrs),Identifier:makeObjectPropertySetter(readString)})),STYLE_PARSERS=makeStructureNS(NAMESPACE_URIS,{LegendURL:makeObjectPropertyPusher(readLegendUrl)},makeStructureNS(OWS_NAMESPACE_URIS,{Title:makeObjectPropertySetter(readString),Identifier:makeObjectPropertySetter(readString)})),TMS_LINKS_PARSERS=makeStructureNS(NAMESPACE_URIS,{TileMatrixSet:makeObjectPropertySetter(readString),TileMatrixSetLimits:makeObjectPropertySetter(readTileMatrixLimitsList)}),TMS_LIMITS_LIST_PARSERS=makeStructureNS(NAMESPACE_URIS,{TileMatrixLimits:makeArrayPusher(readTileMatrixLimits)}),TMS_LIMITS_PARSERS=makeStructureNS(NAMESPACE_URIS,{TileMatrix:makeObjectPropertySetter(readString),MinTileRow:makeObjectPropertySetter(readPositiveInteger),MaxTileRow:makeObjectPropertySetter(readPositiveInteger),MinTileCol:makeObjectPropertySetter(readPositiveInteger),MaxTileCol:makeObjectPropertySetter(readPositiveInteger)}),DIMENSION_PARSERS=makeStructureNS(NAMESPACE_URIS,{Default:makeObjectPropertySetter(readString),Value:makeObjectPropertyPusher(readString)},makeStructureNS(OWS_NAMESPACE_URIS,{Identifier:makeObjectPropertySetter(readString)})),WGS84_BBOX_READERS=makeStructureNS(OWS_NAMESPACE_URIS,{LowerCorner:makeArrayPusher(readCoordinates),UpperCorner:makeArrayPusher(readCoordinates)}),TMS_PARSERS=makeStructureNS(NAMESPACE_URIS,{WellKnownScaleSet:makeObjectPropertySetter(readString),TileMatrix:makeObjectPropertyPusher(readTileMatrix)},makeStructureNS(OWS_NAMESPACE_URIS,{SupportedCRS:makeObjectPropertySetter(readString),Identifier:makeObjectPropertySetter(readString),BoundingBox:makeObjectPropertySetter(readBoundingBox)})),TM_PARSERS=makeStructureNS(NAMESPACE_URIS,{TopLeftCorner:makeObjectPropertySetter(readCoordinates),ScaleDenominator:makeObjectPropertySetter(readDecimal),TileWidth:makeObjectPropertySetter(readPositiveInteger),TileHeight:makeObjectPropertySetter(readPositiveInteger),MatrixWidth:makeObjectPropertySetter(readPositiveInteger),MatrixHeight:makeObjectPropertySetter(readPositiveInteger)},makeStructureNS(OWS_NAMESPACE_URIS,{Identifier:makeObjectPropertySetter(readString)}));function readContents(_t,e){return pushParseAndPop({},CONTENTS_PARSERS,_t,e)}function readLayer(_t,e){return pushParseAndPop({},LAYER_PARSERS,_t,e)}function readTileMatrixSet(_t,e){return pushParseAndPop({},TMS_PARSERS,_t,e)}function readStyle(_t,e){const n=pushParseAndPop({},STYLE_PARSERS,_t,e);if(!n)return;const ei=_t.getAttribute("isDefault")==="true";return n.isDefault=ei,n}function readTileMatrixSetLink(_t,e){return pushParseAndPop({},TMS_LINKS_PARSERS,_t,e)}function readDimensions(_t,e){return pushParseAndPop({},DIMENSION_PARSERS,_t,e)}function readResourceUrl(_t,e){const n=_t.getAttribute("format"),ei=_t.getAttribute("template"),ti=_t.getAttribute("resourceType"),ii={};return n&&(ii.format=n),ei&&(ii.template=ei),ti&&(ii.resourceType=ti),ii}function readBoundingBox(_t,e){const n=pushParseAndPop([],WGS84_BBOX_READERS,_t,e);if(n.length==2)return boundingExtent(n)}function readBoundingBoxWithCrs(_t,e){const n=_t.getAttribute("crs"),ei=pushParseAndPop([],WGS84_BBOX_READERS,_t,e);if(ei.length==2)return{extent:boundingExtent(ei),crs:n}}function readLegendUrl(_t,e){const n={};return n.format=_t.getAttribute("format"),n.href=readHref(_t),n}function readCoordinates(_t,e){const n=readString(_t).split(/\s+/);if(!n||n.length!=2)return;const ei=+n[0],ti=+n[1];if(!(isNaN(ei)||isNaN(ti)))return[ei,ti]}function readTileMatrix(_t,e){return pushParseAndPop({},TM_PARSERS,_t,e)}function readTileMatrixLimitsList(_t,e){return pushParseAndPop([],TMS_LIMITS_LIST_PARSERS,_t,e)}function readTileMatrixLimits(_t,e){return pushParseAndPop({},TMS_LIMITS_PARSERS,_t,e)}var eventbus_min$1={exports:{}},eventbus_min=eventbus_min$1.exports,hasRequiredEventbus_min;function requireEventbus_min(){return hasRequiredEventbus_min||(hasRequiredEventbus_min=1,(function(_t,e){(function(n,ei){_t.exports=ei()})(eventbus_min,function(){var n={};n=function(){this.listeners={}},n.prototype={addEventListener:function(ti,ii,ri){for(var ni=[],si=arguments.length,ai=0;ai<si;ai++)ni.push(arguments[ai]);ni=ni.length>3?ni.splice(3,ni.length-1):[],typeof this.listeners[ti]<"u"?this.listeners[ti].push({scope:ri,callback:ii,args:ni}):this.listeners[ti]=[{scope:ri,callback:ii,args:ni}]},removeEventListener:function(ti,ii,ri){if(typeof this.listeners[ti]<"u"){for(var ni=this.listeners[ti].length,si=[],ai=0;ai<ni;ai++){var oi=this.listeners[ti][ai];oi.scope==ri&&oi.callback==ii||si.push(oi)}this.listeners[ti]=si}},hasEventListener:function(ti,ii,ri){if(typeof this.listeners[ti]<"u"){var ni=this.listeners[ti].length;if(ii===void 0&&ri===void 0)return ni>0;for(var si=0;si<ni;si++){var ai=this.listeners[ti][si];if((!ri||ai.scope==ri)&&ai.callback==ii)return!0}}return!1},dispatch:function(ti,ii){for(var ri={type:ti,target:ii},ni=[],si=arguments.length,ai=0;ai<si;ai++)ni.push(arguments[ai]);if(ni=ni.length>2?ni.splice(2,ni.length-1):[],ni=[ri].concat(ni),typeof this.listeners[ti]<"u")for(var oi=this.listeners[ti].slice(),li=oi.length,ai=0;ai<li;ai++){var ci=oi[ai];if(ci&&ci.callback){var ui=ni.concat(ci.args);ci.callback.apply(ci.scope,ui)}}},getEvents:function(){var ti="";for(var ii in this.listeners)for(var ri=this.listeners[ii].length,ni=0;ni<ri;ni++){var si=this.listeners[ii][ni];ti+=si.scope&&si.scope.className?si.scope.className:"anonymous",ti+=" listen for '"+ii+`'
`}return ti}};var ei=new n;return ei})})(eventbus_min$1)),eventbus_min$1.exports}var eventbus_minExports=requireEventbus_min();const EventBus=getDefaultExportFromCjs$1(eventbus_minExports);var EventEditor={onloaded:"editor:onloaded",layer:{onclickvisibility:"editor:layer:onclickvisibility",onclickclone:"editor:layer:onclickclone",onclickremove:"editor:layer:onclickremove"},legend:{onclickedition:"editor:legend:onclickedition",onchangevalue:"editor:legend:onchangevalue"},group:{oncollapse:"editor:group:oncollapse"},style:{oneditjson:"editor:style:oneditjson",scale:{onchangemin:"editor:style:scale:onchangemin",onchangemax:"editor:style:scale:onchangemax"}},filter:{oneditjson:"editor:filter:oneditjson"},themes:{onclickimage:"editor:themes:onclickimage",onclicktitle:"editor:themes:onclicktitle"},search:{onsubmit:"editor:search:onsubmit",onautocomplete:"editor:search:onautocomplete"}},logger$l=LoggerByDefault.getLogger("editor-style");class Style{constructor(e){if(logger$l.trace("[constructor] Style",e),this.options=e||{target:null,position:0,tools:null,title:null,obj:null},!(this instanceof Style))throw new TypeError("ERROR CLASS_CONSTRUCTOR");this._initialize(),this._initContainer()}_initialize(){this.id=this.options.id||null,this.options.target,this.options.position||(this.options.position=0);var e={scale:!0,edition:!1};this.options.tools||(this.options.tools=e),Helper.mergeParams(this.options.tools,e,!1),this.options.obj||(this.options.obj={paint:{},layout:{}}),this.options.title||(this.options.title="JSON Styles :"),this.container=null,this.name={target:"GPEditorMapBoxStyleTarget",container:"GPEditorMapBoxStyleContainer",containerjson:"GPEditorMapBoxStyleJsonContainer",jsonlabel:"GPEditorMapBoxStyleJsonTitle",jsondisplay:"GPEditorMapBoxStyleJsonDisplay",containertoolsscale:"GPEditorMapBoxStyleToolsScaleContainer",scaletitle:"GPEditorMapBoxStyleScaleTitle",containertoolsminscale:"GPEditorMapBoxStyleToolsScaleMinContainer",scalelabelmin:"GPEditorMapBoxStyleScaleLabelMin",scaleinputmin:"GPEditorMapBoxStyleScaleInputMin",containertoolsmaxscale:"GPEditorMapBoxStyleToolsScaleMaxContainer",scalelabelmax:"GPEditorMapBoxStyleScaleLabelMax",scaleinputmax:"GPEditorMapBoxStyleScaleInputMax",containertoolsedit:"GPEditorMapBoxStyleToolsEditionContainer"}}_initContainer(){var e=this,n=!1,ei=JSON.parse(JSON.stringify(this.options.obj)),ti={};ei.paint&&(n=!0,ti.paint=ei.paint,Object.keys(ei.paint).length===0&&logger$l.info("tag 'paint' is empty !")),ei.layout&&(n=!0,ti.layout=ei.layout,ei.layout.visibility&&delete ti.visibility,Object.keys(ei.layout).length===0&&logger$l.info("tag 'layout' is empty !"));var ii=document.createElement("div");ii.className=this.name.container;var ri=null;if(n){var ni=JSON.stringify(ti,null,4);ri=this._syntaxHighlight(ni)}var si=document.createElement("div");si.className=this.name.containerjson;var ai=document.createElement("label");ai.className=this.name.jsonlabel,ai.innerHTML=this.options.title,si.appendChild(ai);var oi=document.createElement("pre");oi.className=this.name.jsondisplay,oi.innerHTML=ri,oi.addEventListener?oi.addEventListener("click",function(li){e.options.tools.edition&&e.onEditJsonStyleMapBox(li)}):oi.attachEvent&&oi.attachEvent("onclick",function(li){e.options.tools.edition&&e.onEditJsonStyleMapBox(li)}),si.appendChild(oi),ii.appendChild(si),this.options.tools.scale&&ii.appendChild(this._createElementToolsScale({min:ti.layout?ti.layout.minzoom:0,max:ti.layout?ti.layout.maxzoom:21})),this.options.tools.edition&&ii.appendChild(this._createElementToolsEdition()),this.container=ii}_createElementToolsScale(e){logger$l.trace("_createElementToolsScale");var n=this,ei=this.options.obj,ti=document.createElement("div");ti.className=this.name.containertoolsscale;var ii=document.createElement("div");ii.className=this.name.containertoolsminscale;var ri=document.createElement("label");ri.className=this.name.scalelabelmin,ri.innerHTML="min :",ii.appendChild(ri);var ni=document.createElement("input");ni.className=this.name.scaleinputmin,ni.type="range",ni.value=e.min||0,ni.title=e.min||0,ni.disabled=!1,ni.min=0,ni.max=21,ni.data=ei,ni.addEventListener?ni.addEventListener("change",function(li){n.onChangeStyleScaleMinMapBox(li)}):ni.appendChild&&ni.appendChild("onchange",function(li){n.onChangeStyleScaleMinMapBox(li)}),ii.appendChild(ni),ti.appendChild(ii);var si=document.createElement("div");si.className=this.name.containertoolsmaxscale;var ai=document.createElement("label");ai.className=this.name.scalelabelmax,ai.innerHTML="max :",si.appendChild(ai);var oi=document.createElement("input");return oi.className=this.name.scaleinputmin,oi.type="range",oi.value=e.max||21,oi.title=e.max||21,oi.disabled=!1,oi.min=0,oi.max=21,oi.data=ei,oi.addEventListener?oi.addEventListener("change",function(li){n.onChangeStyleScaleMaxMapBox(li)}):oi.appendChild&&oi.appendChild("onchange",function(li){n.onChangeStyleScaleMaxMapBox(li)}),si.appendChild(oi),ti.appendChild(si),ti}_createElementToolsEdition(){logger$l.warn("_createElementToolsEdition, it's not yet implemented !");var e=document.createElement("div");return e.className=this.name.containertoolsedit,e}_syntaxHighlight(e){return e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),e.replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+-]?\d+)?)/g,function(n){var ei="gp-json-number";return/^"/.test(n)?/:$/.test(n)?ei="gp-json-key":ei="gp-json-string":/true|false/.test(n)?ei="gp-json-boolean":/null/.test(n)&&(ei="gp-json-null"),"<span class='"+ei+"'>"+n+"</span>"})}add(){if(!this.options.target){if(!document.getElementById(this.name.target)){var e=document.createElement("div");e.id=this.name.target;var n=document.documentElement||document.getElementsByTagName("body")[0]||document.getElementsByTagName("head")[0];n.appendChild(e)}this.options.target=document.getElementById(this.name.target)}return this.container&&this.options.target.appendChild(this.container),this}display(e){return logger$l.trace("display()",e),typeof e<"u"&&(this.container.style.display=e?"flex":"none"),this.container.style.display==="flex"}getContainer(){return this.container}onEditJsonStyleMapBox(e){logger$l.trace("onEditJsonStyleMapBox",e),e.editorID=this.id,e.data=this.options,EventBus.dispatch(EventEditor.style.oneditjson,e)}onChangeStyleScaleMinMapBox(e){logger$l.trace("onChangeStyleScaleMinMapBox",e),e.editorID=this.id,e.data=this.options,EventBus.dispatch(EventEditor.style.scale.onchangemin,e)}onChangeStyleScaleMaxMapBox(e){logger$l.trace("onChangeStyleScaleMaxMapBox",e),e.editorID=this.id,e.data=this.options,EventBus.dispatch(EventEditor.style.scale.onchangemax,e)}}window.ol&&window.ol.style&&(window.ol.style.editor||(window.ol.style.editor={}),window.ol.style.editor.Style=Style);var logger$k=LoggerByDefault.getLogger("editor-themes");class Themes{constructor(e){if(logger$k.trace("[constructor] Themes",e),this.options=e||{},!(this instanceof Themes))throw new TypeError("ERROR CLASS_CONSTRUCTOR");this._initialize(),this._initContainer()}_initialize(){this.id=this.options.id||null,this.options.target;var e={thumbnails:!0,button:{visible:!0,type:"radio"}};(!this.options.tools||Object.keys(this.options.tools).length===0)&&(this.options.tools=e),Helper.mergeParams(this.options.tools,e,!1),(typeof this.options.obj>"u"||this.options.obj===null||!this.options.obj)&&(this.options.obj={themesSummary:"",themes:[]}),this.container=null,this.name={target:"GPEditorMapBoxThemeTarget",container:"GPEditorMapBoxThemesContainer",containertheme:"GPEditorMapBoxThemeContainer",containerthemeID:"GPEditorMapBoxThemeContainer_ID_",input:"GPEditorMapBoxThemeInput",inputID:"GPEditorMapBoxThemeInput_ID_",label:"GPEditorMapBoxThemeTitle",labelID:"GPEditorMapBoxThemeTitle_ID_",image:"GPEditorMapBoxThemeImage",imageID:"GPEditorMapBoxThemeImage_ID_",message:"GPEditorMapBoxThemeMessage"}}_initContainer(){var e=this,n=this.options.obj,ei=this.id||SelectorID.generate(),ti=document.createElement("div");ti.className=this.name.container,ti.title=n.themesSummary||"";var ii=n.themes;if(ii)for(var ri=0;ri<ii.length;ri++){var ni=ii[ri],si=document.createElement("div");si.id=this.name.containerthemeID+ri+"_"+ei,si.className=this.name.containertheme,si.tabIndex=ri;var ai=ni.url,oi=ni.selected||!1;if(ai){var li=this.options.tools.button;if(li.visible){var ci=li.type==="checkbox"?"checkbox":"radio",ui=document.createElement("input");ui.type=ci,ui.id=this.name.inputID+ri+"_"+ei,ui.className=this.name.input,ui.name=ei,ui.checked=oi,ui.data=ai,ui.addEventListener?ui.addEventListener("click",function(pi){e.onClickThemeTitleMapBox(pi)}):ui.attachEvent&&ui.attachEvent("onclick",function(pi){e.onClickThemeTitleMapBox(pi)}),si.appendChild(ui)}if(this.options.tools.thumbnails&&ni.thumbnail){var di=document.createElement("img");di.id=this.name.imageID+ri+"_"+ei,di.className=this.name.image,di.src=ni.thumbnail,di.alt=ni.thumbnail,di.title=ni.description||"",di.data=ai,di.addEventListener?di.addEventListener("click",function(pi){e.onClickThemeImageMapBox(pi);var gi=pi.target.parentElement.childNodes;if(gi){var vi=gi[0];vi.tagName.toLowerCase()==="input"&&(vi.checked=!vi.checked)}}):di.attachEvent&&di.attachEvent("onclick",function(pi){e.onClickThemeImageMapBox(pi);var gi=pi.target.parentElement.childNodes;if(gi){var vi=gi[0];vi.tagName.toLowerCase()==="input"&&(vi.checked=!vi.checked)}}),si.appendChild(di)}if(ni.name){var fi=document.createElement("label");fi.id=this.name.labelID+ri+"_"+ei,this.options.tools.button.visible&&(fi.htmlFor=ui.id),fi.className=this.name.label,fi.innerHTML=ni.name,fi.title=ni.description||"",fi.data=ai,this.options.tools.button.visible||(fi.addEventListener?fi.addEventListener("click",function(pi){e.onClickThemeTitleMapBox(pi)}):fi.attachEvent&&fi.attachEvent("onclick",function(pi){e.onClickThemeTitleMapBox(pi)})),si.appendChild(fi)}}else{var hi=document.createElement("label");hi.className=this.name.message,hi.innerHTML="Thme non disponible...",si.appendChild(hi)}ti.appendChild(si)}this.container=ti}add(){if(!this.options.target){if(!document.getElementById(this.name.target)){var e=document.createElement("div");e.id=this.name.target;var n=document.documentElement||document.getElementsByTagName("body")[0]||document.getElementsByTagName("head")[0];n.appendChild(e)}this.options.target=document.getElementById(this.name.target)}return this.container&&this.options.target.appendChild(this.container),this}display(e){return logger$k.trace("display()",e),typeof e<"u"&&(this.container.style.display=e?"flex":"none"),this.container.style.display==="flex"}getContainer(){return this.container}onClickThemeImageMapBox(e){if(logger$k.trace("onClickThemeImageMapBox",e),e.editorID=this.id,e.data=this.options,this.options.tools.button.type==="checkbox")for(var n=e.target.previousSibling.id.substring(e.target.previousSibling.id.lastIndexOf("_")+1),ei=document.getElementsByClassName(this.name.input),ti=0;ti<ei.length;ti++){var ii=ei[ti];if(ii.id!==e.target.previousSibling.id){var ri=ii.id.substring(ii.id.lastIndexOf("_")+1);ri===n&&(ii.checked=!1)}}EventBus.dispatch(EventEditor.themes.onclickimage,e)}onClickThemeTitleMapBox(e){if(logger$k.trace("onClickThemeTitleMapBox",e),e.editorID=this.id,e.data=this.options,this.options.tools.button.type==="checkbox")for(var n=e.target.id.substring(e.target.id.lastIndexOf("_")+1),ei=document.getElementsByClassName(this.name.input),ti=0;ti<ei.length;ti++){var ii=ei[ti];if(ii.id!==e.target.id){var ri=ii.id.substring(ii.id.lastIndexOf("_")+1);ri===n&&(ii.checked=!1)}}EventBus.dispatch(EventEditor.themes.onclicktitle,e)}}window.ol&&window.ol.style&&(window.ol.style.editor||(window.ol.style.editor={}),window.ol.style.editor.Themes=Themes);var logger$j=LoggerByDefault.getLogger("editor-filter");class Filter{constructor(e){if(logger$j.trace("[constructor] Filter",e),this.options=e||{target:null,position:0,tools:null,title:null,obj:null},!(this instanceof Filter))throw new TypeError("ERROR CLASS_CONSTRUCTOR");this._initialize(),this._initContainer()}_initialize(){this.id=this.options.id||null,this.options.target,this.options.position||(this.options.position=0);var e={edition:!1};this.options.tools||(this.options.tools=e),Helper.mergeParams(this.options.tools,e,!1),this.options.obj||(this.options.obj={filter:[]}),this.options.title||(this.options.title="JSON Filtres :"),this.container=null,this.name={target:"GPEditorMapBoxFilterTarget",container:"GPEditorMapBoxFilterContainer",containerjson:"GPEditorMapBoxFilterJsonContainer",jsonlabel:"GPEditorMapBoxFilterTitleJson",jsondisplay:"GPEditorMapBoxFilterDisplayJson",containertoolsedit:"GPEditorMapBoxFilterToolsEditionContainer"}}_initContainer(){var e=this,n=!1,ei=JSON.parse(JSON.stringify(this.options.obj));ei.filter&&(n=!0,ei.filter.length===0&&logger$j.info("tag 'filter' is empty !"));var ti=document.createElement("div");ti.className=this.name.container;var ii=null;n&&(ii=JSON.stringify(ei.filter,null,4));var ri=document.createElement("div");ri.className=this.name.containerjson;var ni=document.createElement("label");ni.className=this.name.jsonlabel,ni.innerHTML=this.options.title,ri.appendChild(ni);var si=document.createElement("pre");if(si.className=this.name.jsondisplay,si.innerHTML=ii,si.addEventListener?si.addEventListener("click",function(oi){e.options.tools.edition&&e.onEditJsonFilterMapBox(oi)}):si.attachEvent&&si.attachEvent("onclick",function(oi){e.options.tools.edition&&e.onEditJsonFilterMapBox(oi)}),ri.appendChild(si),ti.appendChild(ri),this.options.tools.edition){var ai=document.createElement("div");ai.className=this.name.containertoolsedit,ti.appendChild(ai)}this.container=ti}add(){if(!this.options.target){if(!document.getElementById(this.name.target)){var e=document.createElement("div");e.id=this.name.target;var n=document.documentElement||document.getElementsByTagName("body")[0]||document.getElementsByTagName("head")[0];n.appendChild(e)}this.options.target=document.getElementById(this.name.target)}return this.container&&this.options.target.appendChild(this.container),this}display(e){return logger$j.trace("display()",e),typeof e<"u"&&(this.container.style.display=e?"flex":"none"),this.container.style.display==="flex"}getContainer(){return this.container}onEditJsonFilterMapBox(e){logger$j.trace("onEditJsonFilterMapBox",e),e.editorID=this.id,e.data=this.options,EventBus.dispatch(EventEditor.filter.oneditjson,e)}}window.ol&&window.ol.style&&(window.ol.style.editor||(window.ol.style.editor={}),window.ol.style.editor.Filter=Filter);var logger$i=LoggerByDefault.getLogger("editor-legend");class Legend{constructor(e){if(logger$i.trace("[constructor] Legend",e),this.options=e||{target:null,position:0,sprites:null,obj:null},!(this instanceof Legend))throw new TypeError("ERROR CLASS_CONSTRUCTOR");this._initialize(),this._initContainer()}_initialize(){this.id=this.options.id||null,this.options.target,this.options.position||(this.options.position=0),this.options.obj||(this.options.obj={title:"vide...",editable:!0,paint:{"fill-color":"#FFFFFF"}});var e=this.options.obj.editable;this.editable=typeof e<"u"?e:!1,this.legendRender={type:"fill",values:{width:1,stroke:"#FFFFFF",color:"#000000",opacity:1}},this.container=null,this.rendercontainer=null,this.toolscontainer=null,this.name={target:"GPEditorMapBoxLegendTarget",container:"GPEditorMapBoxLegendContainer",containerlegendrender:"GPEditorMapBoxLegendRenderContainer",legendrender:"GPEditorMapBoxLegendRender",legendeditable:"GPEditorMapBoxLegendEditable",legendtitle:"GPEditorMapBoxLegendTitle",containerlegendtools:"GPEditorMapBoxLegendToolsContainer"},this.labels={"line-color":"Couleur du trait","line-width":"Epaisseur du trait","line-opacity":"Opacit du trait","fill-color":"Couleur de remplissage","fill-opacity":"Opacit du remplissage"}}_initContainer(){var e=this.options.obj,n=document.createElement("div");n.className=this.name.container;var ei=Object.assign({},e.paint,e.layout),ti=Object.keys(ei);if(ti.length===0){logger$i.info("tag 'paint' or 'layout' is empty !");return}for(var ii={},ri=!1,ni=0;ni<ti.length;ni++){var si=ti[ni];if(/fill-/.test(si)||/line-/.test(si)||/circle-/.test(si)||/background-/.test(si)||/text-/.test(si)||/icon-/.test(si)){ri=!0;var ai=e.title||"",oi=si.split("-")[0];(oi==="text"||oi==="icon")&&(oi="symbol"),this.legendRender=this._getProperties(oi,ei),ii={edit:this.editable,title:ai,type:this.legendRender.type,values:this.legendRender.values},n.appendChild(this._createElementIconLegend(ii));break}}ri||(ii={edit:this.editable,title:"",type:this.legendRender.type,values:this.legendRender.values},n.appendChild(this._createElementIconLegend(ii)),logger$i.warn("legend type unknown, default legend used...")),this.toolscontainer=this._createElementEditionLegend(ii),n.appendChild(this.toolscontainer),this.container=n}_getProperties(e,n){if(e==="symbol"){var ei=n["text-field"],ti=n["icon-image"];if(e=ei&&ti?"icon":ei?"text":ti?"icon":"unknow",e==="unknow"){logger$i.warn("type unknow !?");return}}var ii={};for(const ai in n)if(Object.hasOwnProperty.call(n,ai)){const oi=n[ai];if(Legend.PROPERTIES[e].includes(ai)){var ri=ai.replace(e,"").slice(1),ni=this._getValue(oi);if(ni){if((ri==="pattern"||ri==="image")&&(!this.options.sprites||!this.options.sprites.json||!this.options.sprites.json[ni])){var si=e+":"+ri;logger$i.warn("sprites mandatory for key ",si);break}ii[ri]=ni}}else logger$i.warn("property not supported : ",ai)}return{type:e,values:ii}}_renderThumbnail(e,n){var ei=this.rendercontainer;if(!ei)return!1;var ti=null,ii=3;switch(n.color||(n.color="#FFFFFF"),e){case"text":var ri="font-size: 5em;font-weight: bold;";ti=`url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' viewBox='0 0 100 100'><text x='50' y='50' fill='%color%' fill-opacity='%opacity%'  text-anchor='middle' dominant-baseline='central' style='%style%'> T </text></svg>")`,ei.style.background=ti.replace("%color%",n.color.indexOf("rgb")===0?n.color:ColorUtils.hexToRgba(n.color,1)).replace("%opacity%",n.opacity||1).replace("%style%",ri);break;case"icon":if(n.image)ti="<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' width='27px' height='27px' x='0' y='0' viewBox='%x% %y% %w% %h%'><image width='%W%px' height='%H%px' href='%URL%'/></svg>".replace("%x%",this.options.sprites.json[n.image].x).replace("%y%",this.options.sprites.json[n.image].y).replace(/%w%/g,this.options.sprites.json[n.image].width).replace(/%h%/g,this.options.sprites.json[n.image].height).replace("%W%",this.options.sprites.size.w).replace("%H%",this.options.sprites.size.h).replace("%URL%",this.options.sprites.url),ei.innerHTML=ti;else{var ni="fill: transparent;stroke-width: 10;";ti=`url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' viewBox='0 0 100 100'><path d='M 50,20 80,82.5 20,82.5 z' stroke='%color%' style='%style%'/></svg>")`,ei.style.background=ti.replace("%color%",n.color.indexOf("rgb")===0?n.color:ColorUtils.hexToRgba(n.color,1)).replace("%style%",ni)}break;case"line":var si=Array.isArray(n.dasharray)?n.dasharray.join(" "):0;ti=`url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' viewBox='0 0 100 100'><line x1='0' y1='100' x2='100' y2='0' stroke='%color%' stroke-width='%stroke-width%' stroke-opacity='%stroke-opacity%' stroke-dasharray='%stroke-dasharray%' /></svg>")`,ei.style.background=ti.replace("%color%",n.color.indexOf("rgb")===0?n.color:ColorUtils.hexToRgba(n.color,1)).replace("%stroke-opacity%",n.opacity||1).replace("%stroke-dasharray%",si).replace("%stroke-width%",(n.width||0)*ii);break;case"circle":var ai=n["stroke-color"]||"#FFFFFF";ti=`url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' viewBox='0 0 100 100'><circle cx='50' cy='50' r='40' stroke='%stroke-color%' stroke-width='%stroke-width%' stroke-opacity='%strock-opacity%' fill='%color%' fill-opacity='%opacity%' /></svg>")`,ei.style.background=ti.replace("%color%",n.color.indexOf("rgb")===0?n.color:ColorUtils.hexToRgba(n.color,1)).replace("%opacity%",n.opacity||1).replace("%stroke-color%",ai.indexOf("rgb")===0?ai:ColorUtils.hexToRgba(ai,1)).replace("%stroke-opacity%",n["stroke-opacity"]||1).replace("%stroke-width%",(n["stroke-width"]||0)*ii);break;case"background":case"fill":if(n.pattern)ti="<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' width='27px' height='27px' x='0' y='0' viewBox='%x% %y% %w% %h%'><image width='%W%px' height='%H%px' href='%URL%'/></svg>".replace("%x%",this.options.sprites.json[n.pattern].x).replace("%y%",this.options.sprites.json[n.pattern].y).replace(/%w%/g,this.options.sprites.json[n.pattern].width).replace(/%h%/g,this.options.sprites.json[n.pattern].height).replace("%W%",this.options.sprites.size.w).replace("%H%",this.options.sprites.size.h).replace("%URL%",this.options.sprites.url),ei.innerHTML=ti;else{var oi=n["outline-color"]||"#FFFFFF";ti=`url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' viewBox='0 0 100 100'><rect x='0' y='0' width='100' height='100' rx='5' ry='5' stroke='%stroke-color%' stroke-width='3' fill='%color%' fill-opacity='%opacity%' /></svg>")`,ei.style.background=ti.replace("%color%",n.color.indexOf("rgb")===0?n.color:ColorUtils.hexToRgba(n.color,1)).replace("%opacity%",n.opacity||1).replace("%stroke-color%",oi.indexOf("rgb")===0?oi:ColorUtils.hexToRgba(oi,1))}break;default:return logger$i.warn("type not found, no thumbnail..."),!1}return!0}_getValue(e){var n=null;if(typeof e=="string")n=e;else if(typeof e=="number")n=e;else if(Array.isArray(e)){var ei=!0;e.forEach(ii=>{typeof ii!="number"&&(ei=!1)}),ei&&(n=e)}else if(typeof e=="object"){if(n=null,"stops"in e){e.stops.sort((ii,ri)=>{var ni=ii[0],si=ri[0];return ni>si?-1:ni<si?1:0});var ti=e.stops.slice(-1);n=ti[0][1]}}else logger$i.warn("value not supported !");return n}_createElementIconLegend(e){var n=this,ei=document.createElement("div");ei.className=this.name.containerlegendrender;var ti=this.rendercontainer=document.createElement("div");ti.className=this.name.legendrender,e.edit&&(ti.className+=" ",ti.className+=this.name.legendeditable,ti.addEventListener?ti.addEventListener("click",function(ni){n.onEditionLegendMapBox(ni)}):ti.attachEvent&&ti.attachEvent("onclick",function(ni){n.onEditionLegendMapBox(ni)}));var ii=e.type;this._renderThumbnail(ii,e.values)?ti.className+=e.edit?" legend-"+ii:" legend-"+ii+"-not-editable":ti.className+=" legend-unknow",ei.appendChild(ti);var ri=document.createElement("span");return ri.className=this.name.legendtitle,ri.innerHTML=e.title||"",ei.appendChild(ri),ei}_createElementEditionLegend(e){var n=this,ei=document.createElement("div");if(ei.className=this.name.containerlegendtools,!e.edit)return ei;switch(e.type){case"line":ti.call(n),ii.call(n),ri.call(n);break;case"background":case"fill":ni.call(n),si.call(n);break}function ti(){var ai=document.createElement("div");ai.className="legend-styling-div";var oi=document.createElement("label");oi.className="legend-line",oi.htmlFor=this.id?"line-color-"+this.id:"line-color",oi.innerHTML=this.labels["line-color"];var li=document.createElement("input");li.className="legend-styling",li.id=this.id?"line-color-"+this.id:"line-color",li.title="Selectionner une couleur de trait",li.type="color",li.value=e.values.color,li.setAttribute("data-id","line-color"),li.addEventListener?li.addEventListener("change",function(ci){n._renderThumbnail(e.type,Object.assign(e.values,{color:ci.target.value})),n.onChangeValueLegendMapBox(ci)}):li.attachEvent&&li.attachEvent("onchange",function(ci){n._renderThumbnail(e.type,Object.assign(e.values,{color:ci.target.value})),n.onChangeValueLegendMapBox(ci)}),ai.appendChild(oi),ai.appendChild(li),ei.appendChild(ai)}function ii(){var ai=document.createElement("div");ai.className="legend-styling-div";var oi=document.createElement("label");oi.className="legend-line",oi.htmlFor=this.id?"line-width-"+this.id:"line-width",oi.innerHTML=this.labels["line-width"];var li=document.createElement("input");li.className="legend-styling",li.id=this.id?"line-width-"+this.id:"line-width",li.title=e.values.width,li.type="range",li.min="0",li.max="10",li.step="1",li.defaultValue=e.values.width,li.setAttribute("data-id","line-width"),li.addEventListener?li.addEventListener("change",function(ci){logger$i.trace(ci),ci.target.title=ci.target.value,n._renderThumbnail(e.type,Object.assign(e.values,{width:ci.target.value})),n.onChangeValueLegendMapBox(ci)}):li.attachEvent&&li.attachEvent("onchange",function(ci){logger$i.trace(ci),ci.target.title=ci.target.value,n._renderThumbnail(e.type,Object.assign(e.values,{width:ci.target.value})),n.onChangeValueLegendMapBox(ci)}),ai.appendChild(oi),ai.appendChild(li),ei.appendChild(ai)}function ri(){var ai=document.createElement("div");ai.className="legend-styling-div";var oi=document.createElement("label");oi.className="legend-line",oi.htmlFor=this.id?"line-opacity-"+this.id:"line-opacity",oi.innerHTML=this.labels["line-opacity"];var li=document.createElement("input");li.className="legend-styling",li.id=this.id?"line-opacity-"+this.id:"line-opacity",li.title=e.values.opacity,li.type="range",li.min="0",li.max="1",li.step="0.1",li.defaultValue=e.values.opacity,li.setAttribute("data-id","line-opacity"),li.addEventListener?li.addEventListener("change",function(ci){logger$i.trace(ci),ci.target.title=ci.target.value,n._renderThumbnail(e.type,Object.assign(e.values,{opacity:ci.target.value})),n.onChangeValueLegendMapBox(ci)}):li.attachEvent&&li.attachEvent("onchange",function(ci){logger$i.trace(ci),ci.target.title=ci.target.value,n._renderThumbnail(e.type,Object.assign(e.values,{opacity:ci.target.value})),n.onChangeValueLegendMapBox(ci)}),ai.appendChild(oi),ai.appendChild(li),ei.appendChild(ai)}function ni(){var ai=document.createElement("div");ai.className="legend-styling-div";var oi=document.createElement("label");oi.className="legend-fill",oi.htmlFor=this.id?"fill-color-"+this.id:"fill-color",oi.innerHTML=this.labels["fill-color"];var li=document.createElement("input");li.className="legend-styling",li.id=this.id?"fill-color-"+this.id:"fill-color",li.title="Selectionner une couleur de remplissage",li.type="color",li.value=e.values.color,li.setAttribute("data-id","fill-color"),li.addEventListener?li.addEventListener("change",function(ci){n._renderThumbnail(e.type,Object.assign(e.values,{color:ci.target.value})),n.onChangeValueLegendMapBox(ci)}):li.attachEvent&&li.attachEvent("onchange",function(ci){n._renderThumbnail(e.type,Object.assign(e.values,{color:ci.target.value})),n.onChangeValueLegendMapBox(ci)}),ai.appendChild(oi),ai.appendChild(li),ei.appendChild(ai)}function si(){var ai=document.createElement("div");ai.className="legend-styling-div";var oi=document.createElement("label");oi.className="legend-fill",oi.htmlFor=this.id?"fill-opacity-"+this.id:"fill-opacity",oi.innerHTML=this.labels["fill-opacity"];var li=document.createElement("input");li.className="legend-styling",li.id=this.id?"fill-opacity-"+this.id:"fill-opacity",li.title=e.values.opacity,li.type="range",li.min="0",li.max="1",li.step="0.1",li.defaultValue=e.values.opacity,li.setAttribute("data-id","fill-opacity"),li.addEventListener?li.addEventListener("change",function(ci){ci.target.title=ci.target.value,n._renderThumbnail(e.type,Object.assign(e.values,{opacity:ci.target.value})),n.onChangeValueLegendMapBox(ci)}):li.attachEvent&&li.attachEvent("onchange",function(ci){ci.target.title=ci.target.value,n._renderThumbnail(e.type,Object.assign(e.values,{opacity:ci.target.value})),n.onChangeValueLegendMapBox(ci)}),ai.appendChild(oi),ai.appendChild(li),ei.appendChild(ai)}return ei}add(){if(!this.options.target){if(!document.getElementById(this.name.target)){var e=document.createElement("div");e.id=this.name.target;var n=document.documentElement||document.getElementsByTagName("body")[0]||document.getElementsByTagName("head")[0];n.appendChild(e)}this.options.target=document.getElementById(this.name.target)}return this.container&&this.options.target.appendChild(this.container),this}display(e){return logger$i.trace("display()",e),typeof e<"u"&&(this.container.style.display=e?"flex":"none"),this.container.style.display==="flex"}isEditable(){return this.editable}getRenderContainer(){return this.rendercontainer}getToolsContainer(){return this.toolscontainer}getContainer(){return this.container}onEditionLegendMapBox(e){logger$i.trace("onEditionLegendMapBox",e),e.editorID=this.id,e.data=this.options,EventBus.dispatch(EventEditor.legend.onclickedition,e)}onChangeValueLegendMapBox(e){logger$i.trace("onChangeValueLegendMapBox",e),e.editorID=this.id,e.data=this.options,EventBus.dispatch(EventEditor.legend.onchangevalue,e)}}Legend.PROPERTIES={line:["line-color","line-dasharray","line-opacity","line-width"],fill:["fill-color","fill-opacity","fill-outline-color","fill-pattern"],background:["background-color","background-opacity","background-pattern"],circle:["circle-color","circle-opacity","circle-stroke-color","circle-stroke-opacity","circle-stroke-width"],icon:["icon-color","icon-image","icon-opacity","__icon-size"],text:["__text-anchor","text-color","text-field","__text-font","__text-opacity","__text-size"]};window.ol&&window.ol.style&&(window.ol.style.editor||(window.ol.style.editor={}),window.ol.style.editor.Legend=Legend);var logger$h=LoggerByDefault.getLogger("editor-layer");class Layer{constructor(e){if(logger$h.trace("[constructor] Layer",e),this.options=e||{},!(this instanceof Layer))throw new TypeError("ERROR CLASS_CONSTRUCTOR");this._initialize(),this._initContainer()}_initialize(){this.id=this.options.id||null,this.options.target,this.options.position||(this.options.position=0);var e={visibility:!0,icon:{image:!0,anchor:"end"},type:!0,pin:!0,remove:!1,clone:!1};this.options.tools||(this.options.tools=e),Helper.mergeParams(this.options.tools,e,!1);var n={id:"",type:"",source:"","source-layer":""};this.options.obj||(this.options.obj=n),Helper.mergeParams(this.options.obj,n,!1),this.bSlotLegend=!1,this.oFilter=null,this.oStyle=null,this.oLegend=null,this.container=null,this.DomVisibility=null,this.DomToggle=null,this.name={target:"GPEditorMapBoxLayerTarget",container:"GPEditorMapBoxLayerContainer",containerlegend:"GPEditorMapBoxLayerLegendContainer",containertitle:"GPEditorMapBoxLayerTitleContainer",imagelabelinput:"GPEditorMapBoxLayerImageInput",imagelabel:"GPEditorMapBoxLayerImageLabel",typeimg:"GPEditorMapBoxLayerTypeImage",titleinput:"GPEditorMapBoxLayerTitleInput",titlelabel:"GPEditorMapBoxLayerTitleLabel",containertools:"GPEditorMapBoxToolsContainer",visibilityinput:"GPEditorMapBoxToolsVisibilityInput",visibilitylabel:"GPEditorMapBoxToolsVisibilityLabel",visibilityinputdisable:"GPEditorMapBoxToolsVisibilityInputDisable",visibilitylabeldisable:"GPEditorMapBoxToolsVisibilityLabelDisable"}}_initContainer(){var e=this,n=this.options.obj,ei=document.createElement("div");ei.className=this.name.container;var ti=document.createElement("div");if(ti.id=this.name.containertitle+"-"+this.options.position,ti.className=this.name.containertitle,this.options.tools.pin){var ii=document.createElement("input");ii.id=this.name.imagelabelinput+"-"+this.options.position,ii.className=this.name.imagelabelinput,ii.type="checkbox",ti.appendChild(ii);var ri=document.createElement("label");ri.className=this.name.imagelabel,ri.htmlFor=ii.id,ri.addEventListener?ri.addEventListener("click",function(ci){e.onClickLayerMapBox(ci)}):ri.attachEvent&&ri.attachEvent("onclick",function(ci){e.onClickLayerMapBox(ci)}),ti.appendChild(ri)}var ni=function(){var ci=document.createElement("div");if(ci.id=this.name.containertools+"-"+this.options.position,ci.className=this.name.containertools,this.options.tools.visibility){var ui=document.createElement("input");ui.id=this.name.visibilityinput+"-"+this.options.position,ui.className=this.options.tools.icon.image?this.name.visibilityinput:this.name.visibilityinputdisable,ui.type="checkbox",ui.checked="checked",ui.addEventListener?ui.addEventListener("click",function(fi){e.onVisibilityLayerMapBox(fi)}):ui.attachEvent&&ui.attachEvent("onclick",function(fi){e.onVisibilityLayerMapBox(fi)}),ci.appendChild(ui),this.DomVisibility=ui;var di=document.createElement("label");di.htmlFor=this.name.visibilityinput+"-"+this.options.position,di.id=this.name.visibilitylabel+"-"+this.options.position,di.className=this.options.tools.icon.image?this.name.visibilitylabel:this.name.visibilitylabeldisable,di.title="Afficher/masquer la couche",ci.appendChild(di),ei.appendChild(ci)}this.options.tools.clone&&logger$h.warn("Dom for tools clone, it's not yet implemented !"),this.options.tools.remove&&logger$h.warn("Dom for tools remove, it's not yet implemented !")};if(this.options.tools.icon.anchor==="start"&&ni.apply(this),this.options.tools.type&&n.type){var si=document.createElement("img");switch(si.className=this.name.typeimg,n.type.toUpperCase()){case"SYMBOL-ICON":si.style["background-position"]="0px 0";break;case"SYMBOL-TEXT":si.style["background-position"]="-194px 0";break;case"SYMBOL":si.style["background-position"]="-84px 0";break;case"LINE":si.style["background-position"]="-28px 0";break;case"FILL":si.style["background-position"]="-56px 0";break;case"BACKGROUND":si.style["background-position"]="-140px 0";break;case"CIRCLE":si.style["background-position"]="-168px 0";break;default:si.style["background-position"]="-112px 0"}ti.appendChild(si)}var ai=document.createElement("div");ai.id=this.name.containerlegend+"-"+this.options.position,ai.className=this.name.containerlegend,ti.appendChild(ai);var oi=document.createElement("input");oi.id=this.name.titleinput+"-"+this.options.position,oi.className=this.name.titleinput,oi.type="checkbox",ti.appendChild(oi);var li=document.createElement("label");li.className=this.name.titlelabel,li.htmlFor=oi.id,li.innerHTML=n.id||n["source-layer"]||n.source,li.title=n["source-layer"]||n.source||n.id,li.addEventListener?li.addEventListener("click",function(ci){e.onClickLayerMapBox(ci)}):li.attachEvent&&li.attachEvent("onclick",function(ci){e.onClickLayerMapBox(ci)}),ti.appendChild(li),this.DomToggle=li,ei.appendChild(ti),this.options.tools.icon.anchor==="end"&&ni.apply(this),this.container=ei}add(){if(logger$h.trace("add()"),!this.options.target){if(!document.getElementById(this.name.target)){var e=document.createElement("div");e.id=this.name.target;var n=document.documentElement||document.getElementsByTagName("body")[0]||document.getElementsByTagName("head")[0];n.appendChild(e)}this.options.target=document.getElementById(this.name.target)}return this.container&&this.options.target.appendChild(this.container),this}addStyle(e){logger$h.trace("addStyle()",e),e&&typeof e=="object"&&e instanceof Style&&(this.oStyle=e,this.oStyle.display(!1))}addFilter(e){logger$h.trace("addFilter()",e),e&&typeof e=="object"&&e instanceof Filter&&(this.oFilter=e,this.oFilter.display(!1))}addLegend(e){logger$h.trace("addLegend()",e),e&&typeof e=="object"&&e instanceof Legend&&(this.oLegend=e,this.oLegend.display(!1))}slotLegend(){var e=this.oLegend;if(e){var n=null,ei=this.container.childNodes;if(ei.length)for(var ti=this.options.tools.icon.anchor==="start"?1:0,ii=ei[ti].childNodes,ri=0;ri<ii.length;ri++){var ni=ii[ri];ni.id.indexOf(this.name.containerlegend)!==-1&&(n=ni)}if(n){var si=e.getRenderContainer();si&&(n.appendChild(si),this.bSlotLegend=!0)}}}visibility(e){if(logger$h.trace("visibility()",e),!!this.options.tools.visibility)return typeof e<"u"&&(this.DomVisibility.checked=e?"checked":""),this.DomVisibility.checked}collapse(){logger$h.trace("collapse()"),this.DomToggle.click()}visible(){logger$h.trace("visible()"),this.options.tools.visibility&&this.DomVisibility.click()}display(e){logger$h.trace("display()",e);var n=document.getElementById(this.DomToggle.htmlFor).checked;return typeof e<"u"&&(this.container.style.display=e?"inline-flex":"none",this.oStyle&&this.oStyle.display(e&&n),this.oFilter&&this.oFilter.display(e&&n),this.oLegend&&this.oLegend.display(e&&n)),n}active(e){return logger$h.trace("active()",e),typeof e<"u"&&(this.container.className=e?this.name.container:this.name.container+" disabled"),this.container.className===this.name.container}getContainer(){return this.container}onClickLayerMapBox(e){logger$h.trace("onClickLayerMapBox",e);var n=e.target.htmlFor.substring(e.target.htmlFor.indexOf("-")),ei=document.getElementById(e.target.htmlFor).checked;e.target.htmlFor===this.name.imagelabelinput+n&&(document.getElementById(this.name.titleinput+n).checked=!ei),e.target.htmlFor===this.name.titleinput+n&&document.getElementById(this.name.imagelabelinput+n)&&(document.getElementById(this.name.imagelabelinput+n).checked=!ei),this.oStyle&&this.oStyle.display(!ei),this.oFilter&&this.oFilter.display(!ei),this.oLegend&&this.oLegend.isEditable()&&this.oLegend.display(!ei)}onVisibilityLayerMapBox(e){logger$h.trace("onVisibilityLayerMapBox",e),e.editorID=this.id,e.data=this.options,EventBus.dispatch(EventEditor.layer.onclickvisibility,e)}onCloneLayerMapBox(e){logger$h.trace("onCloneLayerMapBox",e),e.editorID=this.id,e.data=this.options,EventBus.dispatch(EventEditor.layer.onclickclone,e)}onRemoveLayerMapBox(e){logger$h.trace("onRemoveLayerMapBox",e),e.editorID=this.id,e.data=this.options,EventBus.dispatch(EventEditor.layer.onclickremove,e)}}window.ol&&window.ol.style&&(window.ol.style.editor||(window.ol.style.editor={}),window.ol.style.editor.Layer=Layer);var logger$g=LoggerByDefault.getLogger("editor-group");class Group{constructor(e){if(logger$g.trace("[constructor] Group",e),this.options=e||{},!(this instanceof Group))throw new TypeError("ERROR CLASS_CONSTRUCTOR");this._initialize(),this._initContainer()}_initialize(){this.id=this.options.id||null,this.options.target,this.options.title||(this.options.title="Dtails du groupe..."),typeof this.options.collapse>"u"&&(this.options.collapse=!0),this.container=null,this.name={target:"GPEditorMapBoxGroupTarget",container:"GPEditorMapBoxGroupContainer",details:"GPEditorMapBoxGroupDetails",summary:"GPEditorMapBoxGroupSummary"}}_initContainer(){var e=document.createElement("div");e.className=this.name.container;var n=document.createElement("details");n.className=this.name.details,n.open=!this.options.collapse,e.appendChild(n);var ei=document.createElement("summary");ei.className=this.name.summary,ei.innerHTML=this.options.title,n.appendChild(ei),this.container=e}add(){if(!this.options.target){if(!document.getElementById(this.name.target)){var e=document.createElement("div");e.id=this.name.target;var n=document.documentElement||document.getElementsByTagName("body")[0]||document.getElementsByTagName("head")[0];n.appendChild(e)}this.options.target=document.getElementById(this.name.target)}this.container&&this.options.target.appendChild(this.container)}display(e){this.container.style.display=e?"flex":"none"}getContainer(){var e=this.container.childNodes;return e.length?e[0]:this.container}onCollapseGroupMapBox(e){logger$g.trace("onCollapseGroupMapBox",e),e.editorID=this.id,e.data=this.options,EventBus.dispatch(EventEditor.group.oncollapse,e)}}var logger$f=LoggerByDefault.getLogger("editor-search");class Search{constructor(e){if(logger$f.trace("[constructor] Search",e),this.options=e||{target:null,tools:null,title:null,obj:null},!(this instanceof Search))throw new TypeError("ERROR CLASS_CONSTRUCTOR");this._initialize(),this._initContainer()}_initialize(){this.id=this.options.id||null,this.options.target;var e={};this.options.tools||(this.options.tools=e),Helper.mergeParams(this.options.tools,e,!1),this.options.obj||(this.options.obj={}),this.options.title||(this.options.title="Recherche de couches :"),this.container=null,this.name={target:"GPEditorMapBoxSearchTarget",container:"GPEditorMapBoxSearchContainer"}}_initContainer(){var e=JSON.parse(JSON.stringify(this.options.obj));e.layers&&e.layers.length===0&&logger$f.info("tag 'layers' is empty !");var n=document.createElement("div");n.className=this.name.container,this.container=n}add(){if(!this.options.target){if(!document.getElementById(this.name.target)){var e=document.createElement("div");e.id=this.name.target;var n=document.documentElement||document.getElementsByTagName("body")[0]||document.getElementsByTagName("head")[0];n.appendChild(e)}this.options.target=document.getElementById(this.name.target)}return this.container&&this.options.target.appendChild(this.container),this}display(e){return logger$f.trace("display()",e),typeof e<"u"&&(this.container.style.display=e?"flex":"none"),this.container.style.display==="flex"}getContainer(){return this.container}onSubmitSearchLayersMapBox(e){logger$f.trace("onSubmitSearchLayersMapBox",e),e.editorID=this.id,e.data=this.options,EventBus.dispatch(EventEditor.search.onsubmit,e)}onAutocompleteSearchLayersMapBox(e){logger$f.trace("onAutocompleteSearchLayersMapBox",e),e.editorID=this.id,e.data=this.options,EventBus.dispatch(EventEditor.search.onautocomplete,e)}}var EditorDOM={_addUID:function(_t){var e=this._uid?_t+"-"+this._uid:_t;return e}},logger$e=LoggerByDefault.getLogger("editor");class Editor{constructor(e){if(logger$e.trace("[constructor] Editor",e),this.options=e||{},!(this instanceof Editor))throw new TypeError("ERROR CLASS_CONSTRUCTOR");this._initialize()}_initialize(){if(this.options.target||logger$e.info("La 'target' n'est pas renseigne (options.target)."),!this.options.style){logger$e.error("Le 'style' MapBox n'est pas renseign (options.style) !");return}this.options.events?this._initEvents():logger$e.warn("Les 'handlers' ne sont pas renseigns (options.events) !"),this.options.themes||logger$e.info("Les 'themes' MapBox ne sont pas renseigns (options.themes).");var e={themes:!1,layers:!0,search:!1,style:!1,filter:!1,legend:!1,group:!1,groupAuto:!1,sort:!0,sortBy:"id",sortOrder:"asc",title:!0,collapse:void 0,type:!0,pin:!0,visibility:!0,icon:{image:!0,anchor:"end"},editable:!0};this.options.tools||(logger$e.trace("Utilisation des outils MapBox par dfaut (options.tools)."),this.options.tools=e),Helper.mergeParams(this.options.tools,e,!1),this.id=this.options.id||SelectorID.generate(),this.context={},this.layers=[],this.container=null,this.name={target:"GPEditorMapBoxTarget",container:"GPEditorMapBoxContainer",containerID:"GPEditorMapBoxContainer_ID_",containerLayers:"GPEditorMapBoxLayersContainer",titleLayers:"GPEditorMapBoxLayersTitle",titleLayersID:"GPEditorMapBoxLayersTitle_ID_",titleThemes:"GPEditorMapBoxThemesTitle",titleThemesID:"GPEditorMapBoxThemesTitle_ID_",sep:"GPEditorMapBoxSep"},this.mapbox={},this.sprites={}}_initEvents(){var e=this.options.scope||this,n=this.options.events;if(n){for(var ei in n)if(n.hasOwnProperty(ei)){var ti=n[ei];ti&&(EventBus.hasEventListener(ei,ti,e)||EventBus.addEventListener(ei,ti,e))}}}_initContainer(){logger$e.trace(this.mapbox);var e=document.createElement("div");e.id=this.name.containerID+this.id,e.className=this.name.container;var n=this.options.tools.themes;if(n&&this.options.themes){if(this.options.tools.title){var ei=document.createElement("div");ei.id=this.name.titleThemesID+this.id,ei.className=this.name.titleThemes,ei.innerHTML="Liste des 'thmes'",e.appendChild(ei)}var ti=new Themes({id:this.id,target:e,tools:typeof n=="object"?n:{},obj:this.options.themes});ti.add()}if(this.options.tools.search){var ii=new Search({id:this.id,target:e,tools:{},obj:this.mapbox.layers});ii.add()}for(var ri in this.mapbox.sources)if(this.mapbox.sources.hasOwnProperty(ri)){if(this.options.tools.layers){var ni=Object.keys(this.mapbox.sources).length>1?1:0;if(ni){var si=document.createElement("hr");si.className=this.name.sep,e.appendChild(si)}if(this.options.tools.title){var ai=document.createElement("div");ai.id=this.name.titleLayersID+this.id,ai.className=this.name.titleLayers,ai.innerHTML=ni?"Liste des 'couches' ("+ri+")":"Liste des 'couches'",e.appendChild(ai)}}var oi=this.mapbox.layers.slice();if(oi.forEach(function(Vi,nr){var zi=Vi.metadata;zi?zi["geoportail:order"]=nr:Vi.metadata={"geoportail:order":nr}}),this.options.tools.sort){var li=this.options.tools.sortBy,ci=this.options.tools.sortOrder,ui=function(Vi,nr){var zi=0;if(Vi.metadata&&Vi.metadata["geoportail:group"]&&nr.metadata&&nr.metadata["geoportail:group"]){var Wi=null,Ti=null;Wi=Vi.metadata["geoportail:group"],Ti=nr.metadata["geoportail:group"],zi=Wi.localeCompare(Ti)}else switch(li){case"geom":zi=ci==="asc"?Vi.type.localeCompare(nr.type)||Vi.id.localeCompare(nr.id):nr.type.localeCompare(Vi.type)||nr.id.localeCompare(Vi.id);break;case"class":zi=ci==="asc"?Vi["source-layer"].localeCompare(nr["source-layer"])||Vi.id.localeCompare(nr.id):nr["source-layer"].localeCompare(Vi["source-layer"])||nr.id.localeCompare(Vi.id);break;case"id":default:zi=ci==="asc"?Vi.id.localeCompare(nr.id):nr.id.localeCompare(Vi.id);break}return zi};oi.sort(ui)}logger$e.trace("Layers : ",oi);var di=this.options.tools.sortBy,fi=this.options.tools.groupAuto,hi={};oi.forEach(function(Vi){var nr=Vi.metadata;if(nr&&nr["geoportail:group"]){var zi=nr["geoportail:group"];hi[zi]=hi[zi]?hi[zi]+1:1}else{var Wi=null;switch(di){case"class":Wi=Vi["source-layer"];break;case"geom":Wi=Vi.type;break;case"id":default:Wi=Vi.id;break}var Ti=Wi;if(fi){var ki=/_|-|:|=/,xi=Wi.search(ki);Ti=xi!==-1?Wi.substring(0,xi).trim():Wi}hi[Ti]=hi[Ti]?hi[Ti]+1:1,nr?nr["geoportail:group"]=Ti:Vi.metadata={"geoportail:group":Ti}}}),logger$e.trace("Groups : ",hi);var pi=document.createElement("div");pi.className=this.name.containerLayers,e.appendChild(pi);var gi;if(this.options.tools.collapse!==void 0){gi=document.createElement("details"),gi.className="",gi.open=!this.options.tools.collapse,pi.appendChild(gi);var vi=document.createElement("summary");vi.className="",vi.innerHTML="",gi.appendChild(vi)}for(var yi=this.options.tools.collapse!==void 0?gi:pi,_i=-1,Ai=0;Ai<oi.length;Ai++){var Ei=oi[Ai];if(_i++,Ei.source===ri){if(this.options.tools.group&&this.options.tools.sort){var Si=Ei.metadata;if(Si){var wi=Ei.metadata["geoportail:group"];if(wi)if(hi[wi]>1){hi[wi]=-1;var Oi=new Group({id:this.id,target:this.options.tools.collapse!==void 0?gi:pi,title:wi,collapse:!0});Oi.add(),yi=Oi.getContainer()}else hi[wi]===1&&(yi=this.options.tools.collapse!==void 0?gi:pi);else yi=this.options.tools.collapse!==void 0?gi:pi}else yi=this.options.tools.collapse!==void 0?gi:pi}if(this.options.tools.layers){var Ii=new Layer({id:this.id,target:yi,position:_i+"_"+this.id,tools:{visibility:this.options.tools.visibility,icon:this.options.tools.icon,type:this.options.tools.type,pin:this.options.tools.pin},obj:{id:Ei.id,type:Ei.type,source:Ei.source,"source-layer":Ei["source-layer"]}});Ii.add(),Ei.layout&&Ei.layout.visibility&&Ei.layout.visibility==="none"&&Ii.visibility(!1),this.layers.push(Ii)}if(this.options.tools.legend){var Li=this.options.tools.editable;typeof Li>"u"&&(Li=Ei.editable);var Di=new Legend({id:this.id,target:yi,sprites:this.sprites,obj:{id:Ei.id,source:Ei.source,title:Ei.id,editable:typeof Li<"u"?Li:!1,paint:Ei.paint,layout:Ei.layout}});Di.add(),Di.display(!1),Ii&&(Ii.addLegend(Di),Ii.slotLegend())}if(this.options.tools.style){var Ni=new Style({id:this.id,target:yi,position:_i+"_"+this.id,obj:{id:Ei.id,source:Ei.source,layout:Ei.layout,paint:Ei.paint}});Ni.add(),Ni.display(!1),Ii&&Ii.addStyle(Ni),Ei.layout&&Ei.layout.visibility&&Ei.layout.visibility==="none"&&Ii.visibility(!1)}if(this.options.tools.filter){var $i=new Filter({id:this.id,target:yi,position:_i+"_"+this.id,obj:{id:Ei.id,source:Ei.source,filter:Ei.Filter}});$i.add(),$i.display(!1),Ii&&Ii.addFilter($i)}}else _i>=0&&_i--}}if(this.container=e,!this.options.target){if(!document.getElementById(this.name.target)){var Ki=document.createElement("div");Ki.id=this.name.target;var er=document.getElementsByTagName("body")[0]||document.getElementsByTagName("head")[0]||document.documentElement;er.appendChild(Ki)}this.options.target=document.getElementById(this.name.target)}this.container&&this.options.target.appendChild(this.container),EventBus.dispatch(EventEditor.onloaded,this)}_getSprites(e){var n=this;if(e&&e.startsWith("mapbox://"))return new Promise((ii,ri)=>{logger$e.error("Protocole mapbox:// non gr !"),ii(n)});if(!e)return new Promise((ii,ri)=>{logger$e.error("Auncun sprites disponibles !"),ii(n)});var ei=function(){var ii=e+".png";return fetch(ii,{credentials:"same-origin"}).then(function(ri){if(ri.ok)return ri.blob().then(function(si){n.sprites.url=ii;var ai=new Image;return ai.src=ii,ai.decode().then(function(){n.sprites.size={},n.sprites.size.h=ai.height,n.sprites.size.w=ai.width})}).catch(si=>{logger$e.warn("fetch image sprites exception :",si)});var ni=new Error("HTTP status code: "+ri.status);throw ni}).catch(ri=>new Promise((ni,si)=>{logger$e.error("fetch image sprites exception :",ri),si(ri)}))},ti=function(){var ii=e+".json";return fetch(ii,{credentials:"same-origin"}).then(function(ri){if(ri.ok)return ri.json().then(function(si){n.sprites.json=si}).catch(si=>{logger$e.warn("fetch json sprites exception :",si)});var ni=new Error("HTTP status code: "+ri.status);throw ni}).catch(ri=>new Promise((ni,si)=>{logger$e.error("fetch json sprites exception :",ri),si(ri)}))};return Promise.all([ei(),ti()])}createElement(){var e=this;if(typeof this.options.style=="object")return this.mapbox=this.options.style,this.options.tools.legend?this._getSprites(this.mapbox.sprite).then(function(){return e._initContainer(),e}).catch(n=>{logger$e.warn("fetch sprites exception :",n)}):new Promise((n,ei)=>{e._initContainer(),n(e)});if(typeof this.options.style=="string")return fetch(this.options.style,{credentials:"same-origin"}).then(n=>n.json().then(ei=>{e.mapbox=ei}).then(function(){return e.options.tools.legend?e._getSprites(e.mapbox.sprite).then(function(){return e._initContainer(),e}).catch(ei=>{logger$e.warn("fetch sprites exception :",ei)}):new Promise((ei,ti)=>{e._initContainer(),ei(e)})}).catch(ei=>{logger$e.error("json exception :",ei)})).catch(n=>{logger$e.error("fetch exception :",n)})}display(e){this.container.style.display=e?"block":"none"}setContext(e,n){this.context[e]=n}getContext(e){return this.context[e]}getID(){return this.id}getContainer(){return this.container}getStyle(){return this.mapbox}getStyleLayer(e){for(var n=null,ei=this.getLayer(e),ti=ei.options.obj.id,ii=0;ii<this.mapbox.layers.length;ii++){var ri=this.mapbox.layers[ii];if(ri.id===ti){n=ri;break}}return n}getLayerFromStyle(e){for(var n=null,ei=this.mapbox.layers[e],ti=0;ti<this.getLayers().length;ti++){var ii=this.getLayer(ti);if(ei.id===ii.options.obj.id){n=ii;break}}return n}getLayers(){return this.layers}getLayer(e){return this.layers[e]}}Helper.assign(Editor.prototype,EditorDOM);window.ol&&window.ol.style&&(window.ol.style.Editor=Editor);var LayerImportDOM={_addUID:function(_t){var e=this._uid?_t+"-"+this._uid:_t;return e},_createLoadingElement:function(){var _t=document.createElement("div");return _t.id="GPmapLoading",_t.className="",_t},_createMainContainerElement:function(){var _t=document.createElement("div");return _t.id=this._addUID("GPimport"),_t.className="GPwidget gpf-widget gpf-widget-button gpf-mobile-fullscreen",_t},_createShowImportPictoElement:function(){var _t=this,e=document.createElement("button"),n=document.createElement("span");return e.appendChild(n),e.id=this._addUID("GPshowImportPicto"),e.classList.add("GPshowOpen","GPshowAdvancedToolPicto","GPshowImportPicto"),e.classList.add("gpf-btn","gpf-btn--tertiary","gpf-btn-icon","gpf-btn-icon-import"),e.classList.add("fr-btn","fr-btn--tertiary"),e.setAttribute("aria-label","Ouvrir l'import de couches"),e.setAttribute("tabindex","0"),e.setAttribute("aria-pressed",!1),e.setAttribute("type","button"),e.addEventListener?e.addEventListener("click",function(ei){var ti=ei.target.ariaPressed==="true";ei.target.setAttribute("aria-pressed",!ti),_t._onShowImportClick(ei)}):e.attachEvent&&e.attachEvent("onclick",function(ei){var ti=ei.target.ariaPressed==="true";ei.target.setAttribute("aria-pressed",!ti),_t._onShowImportClick(ei)}),e},_createImportPanelElement:function(){var _t=document.createElement("dialog");return _t.id=this._addUID("GPimportPanel"),_t.className="GPpanel gpf-panel fr-modal",_t},_createImportPanelDivElement:function(){var _t=document.createElement("div");return _t.className="gpf-panel__body fr-modal__body",_t},_createImportPanelHeaderElement:function(){var _t=document.createElement("div");return _t.className="GPpanelHeader GPelementVisible gpf-visible gpf-panel__header fr-modal__header",_t},_createImportPanelReturnPictoElement:function(){var _t=this,e=document.createElement("button");if(e.id=this._addUID("GPimportPanelReturnPicto"),e.title="Masquer le panneau",e.className="GPreturnPicto GPimportPanelReturnPicto GPelementHidden gpf-hidden gpf-btn gpf-btn-icon-return fr-btn fr-btn--close fr-btn--tertiary-no-outline",checkDsfr()){var n=document.createElement("span");n.className="GPelementHidden",n.innerHTML="Retour",e.appendChild(n)}return e.addEventListener?e.addEventListener("click",function(ei){document.getElementById(_t._addUID("GPshowImportPicto")).click(),_t._onReturnPictoClick(ei),document.getElementById(_t._addUID("GPshowImportPicto")).click()}):e.attachEvent&&e.attachEvent("onclick",function(ei){document.getElementById(_t._addUID("GPshowImportPicto")).click(),_t._onReturnPictoClick(ei),document.getElementById(_t._addUID("GPshowImportPicto")).click()}),e},_createImportPanelTitleElement:function(){var _t=document.createElement("div");return _t.id=this._addUID("GPimportHeaderTitle"),_t.className="GPpanelTitle gpf-panel__title fr-modal__title fr-pt-4w",_t.innerHTML="Import de donnes",_t},_createImportPanelCloseElement:function(){var _t=this,e=document.createElement("button");e.id=this._addUID("GPimportPanelClose"),e.className="GPpanelClose GPimportPanelClose gpf-btn gpf-btn-icon-close fr-btn--close fr-btn fr-btn--tertiary-no-outline",e.title="Fermer le panneau",e.addEventListener?e.addEventListener("click",function(){document.getElementById(_t._addUID("GPshowImportPicto")).click()},!1):e.attachEvent&&e.attachEvent("onclick",function(){document.getElementById(_t._addUID("GPshowImportPicto")).click()});var n=document.createElement("span");return n.className="GPelementHidden gpf-visible",n.innerText="Fermer",e.appendChild(n),e},_createImportPanelFormElement:function(){var _t=this,e=document.createElement("form");return e.id=this._addUID("GPimportForm"),e.className="GPform GPelementVisible gpf-visible gpf-mobile-form gpf-panel__content fr-modal__content",e.addEventListener?e.addEventListener("submit",function(n){n.preventDefault(),_t._onImportSubmit()}):e.attachEvent&&e.attachEvent("onsubmit",function(n){n.preventDefault(),_t._onImportSubmit()}),e},_createImportTypeLineElement:function(_t){var e=this,n=document.createElement("div");n.id=this._addUID("GPimportTypeLine"),n.className="GPimportInputLine";var ei=document.createElement("label");ei.id=this._addUID("GPimportTypeLabel"),ei.className="GPlabel gpf-label fr-label",ei.innerHTML="Type de donne",ei.title="Type de donne",n.appendChild(ei);var ti=document.createElement("select");ti.setAttribute("aria-labelledby",this._addUID("GPimportTypeLabel")),ti.className="GPselect gpf-select fr-select",ti.addEventListener?ti.addEventListener("change",function(ni){this.value==="KML"||this.value==="GPX"||this.value==="GeoJSON"||this.value==="MAPBOX"?(document.getElementById(e._addUID("GPimportStaticParams")).className="GPelementVisible gpf-visible fr-my-4w",document.getElementById(e._addUID("GPimportServiceParams")).className="GPelementHidden gpf-hidden"):(this.value==="WMS"||this.value==="WMTS"||this.value==="WFS")&&(document.getElementById(e._addUID("GPimportServiceParams")).className="GPelementVisible gpf-visible fr-my-4w",document.getElementById(e._addUID("GPimportStaticParams")).className="GPelementHidden gpf-hidden"),e._onImportTypeChange(ni)}):ti.attachEvent&&ti.attachEvent("onchange",function(){this.value==="KML"||this.value==="GPX"||this.value==="GeoJSON"||this.value==="MAPBOX"?(document.getElementById(e._addUID("GPimportStaticParams")).className="GPelementVisible gpf-visible fr-my-4w",document.getElementById(e._addUID("GPimportServiceParams")).className="GPelementHidden gpf-hidden"):(this.value==="WMS"||this.value==="WMTS"||this.value==="WFS")&&(document.getElementById(e._addUID("GPimportServiceParams")).className="GPelementVisible gpf-visible fr-my-4w",document.getElementById(e._addUID("GPimportStaticParams")).className="GPelementHidden gpf-hidden"),e._onImportTypeChange()}),ti.id=this._addUID("GPimportTypeSelect"),(!_t||!Array.isArray(_t))&&(_t=["KML","GPX","GeoJSON","MAPBOX","WMS","WMTS","WFS"]);for(var ii,ri=0;ri<_t.length;ri++)ii=document.createElement("option"),ii.value=_t[ri],ii.text=_t[ri]==="MAPBOX"?"Tuiles vectorielles":_t[ri],ti.appendChild(ii);return n.appendChild(ti),n},_createImportWaitingElement:function(){var _t=document.createElement("div");_t.id=this._addUID("GPimportWaitingContainer"),_t.className="GPwaitingContainer GPwaitingContainerHidden gpf-waiting gpf-waiting--hidden";var e=document.createElement("p");return e.className="GPwaitingContainerInfo gpf-waiting_info",e.innerHTML="Recherche en cours...",_t.appendChild(e),_t},_createImportStaticParamsContainer:function(_t){var e=document.createElement("div");return e.id=this._addUID("GPimportStaticParams"),_t==="KML"||_t==="GPX"||_t==="GeoJSON"||_t==="MAPBOX"?e.className="GPelementVisible gpf-visible fr-my-4w":e.className="GPelementHidden gpf-hidden",e},_createStaticNameLabel:function(){var _t=document.createElement("div");_t.className="GPimportInputLine fr-mb-1w";var e=document.createElement("label");e.className="GPlabel gpf-label fr-label",e.htmlFor=this._addUID("GPimportName"),e.innerHTML="Nom",e.title="Nom",_t.appendChild(e);var n=document.createElement("input");return n.type="text",n.id=this._addUID("GPimportName"),n.className="GPinput gpf-input fr-input",_t.appendChild(n),_t},_createStaticModeChoiceDiv:function(){var _t=document.createElement("div");return _t.id=this._addUID("GPimportChoice"),_t.className="fr-my-1w",_t},_createStaticLocalChoiceDiv:function(){var _t=this,e=document.createElement("div");e.className="GPimportChoiceAlt gpf-radio-group fr-radio-group";var n=document.createElement("input");n.type="radio",n.addEventListener?n.addEventListener("change",function(ti){document.getElementById(_t._addUID("GPimportValueLocal")).className="GPimportInputLine fr-mb-1w",document.getElementById(_t._addUID("GPimportValueUrl")).className="GPelementHidden gpf-hidden",_t._onStaticImportTypeChange(ti)}):n.appendChild&&n.appendChild("onchange",function(){document.getElementById(_t._addUID("GPimportValueLocal")).className="GPimportInputLine fr-mb-1w",document.getElementById(_t._addUID("GPimportValueUrl")).className="GPelementHidden gpf-hidden",_t._onStaticImportTypeChange()}),n.name="GPimportChoiceMode",n.value="local",n.checked=!0,n.id=this._addUID("GPimportChoiceAltLocal"),e.appendChild(n);var ei=document.createElement("label");return ei.className="GPimportChoiceAltTxt gpf-label fr-label",ei.htmlFor=this._addUID("GPimportChoiceAltLocal"),ei.innerHTML="par fichier local",ei.title="par fichier local",e.appendChild(ei),e},_createStaticUrlChoiceDiv:function(){var _t=this,e=document.createElement("div");e.className="GPimportChoiceAlt gpf-radio-group fr-radio-group";var n=document.createElement("input");n.type="radio",n.addEventListener?n.addEventListener("change",function(ti){document.getElementById(_t._addUID("GPimportValueUrl")).className="GPimportInputLine",document.getElementById(_t._addUID("GPimportValueLocal")).className="GPelementHidden gpf-hidden",_t._onStaticImportTypeChange(ti)}):n.appendChild&&n.appendChild("onchange",function(){document.getElementById(_t._addUID("GPimportValueUrl")).className="GPimportInputLine",document.getElementById(_t._addUID("GPimportValueLocal")).className="GPelementHidden gpf-hidden",_t._onStaticImportTypeChange()}),n.id=this._addUID("GPimportChoiceAltUrl"),n.name="GPimportChoiceMode",n.value="url",n.checked=!1,e.appendChild(n);var ei=document.createElement("label");return ei.className="GPimportChoiceAltTxt gpf-label fr-label",ei.htmlFor=this._addUID("GPimportChoiceAltUrl"),ei.innerHTML="par URL",ei.title="par URL",e.appendChild(ei),e},_createStaticLocalInputDiv:function(){var _t=document.createElement("div");return _t.id=this._addUID("GPimportValueLocal"),_t.className="GPimportInputLine",_t},_createStaticLocalInputLabel:function(){var _t=document.createElement("label");return _t.className="GPlabel gpf-label fr-label fr-mb-1w",_t.htmlFor=this._addUID("GPimportFile"),_t.innerHTML="Fichier local",_t.title="Fichier local",_t},_createStaticLocalInput:function(){var _t=document.createElement("input");return _t.type="file",_t.id=this._addUID("GPimportFile"),_t.className="GPimportInputFile gpf-upload fr-upload",_t},_createStaticUrlInputDiv:function(){var _t=document.createElement("div");return _t.id=this._addUID("GPimportValueUrl"),_t.className="GPelementHidden gpf-hidden",_t},_createStaticUrlInputLabel:function(){var _t=document.createElement("label");return _t.className="GPlabel gpf-label fr-label",_t.htmlFor=this._addUID("GPimportUrl"),_t.innerHTML="URL",_t.title="URL",_t},_createStaticUrlInput:function(){var _t=document.createElement("input");return _t.type="text",_t.id=this._addUID("GPimportUrl"),_t.className="GPinput gpf-input fr-input",_t},_createServiceParamsContainer:function(_t){var e=document.createElement("div");return e.id=this._addUID("GPimportServiceParams"),_t==="WMS"||_t==="WMTS"||_t==="WFS"?e.className="GPelementVisible gpf-visible":e.className="GPelementHidden gpf-hidden",e},_createServiceUrlDiv:function(){var _t=document.createElement("div");return _t.className="GPimportInputLine",_t},_createServiceUrlInputLabel:function(){var _t=document.createElement("label");return _t.className="GPlabel gpf-label fr-label",_t.htmlFor=this._addUID("GPimportServiceUrl"),_t.innerHTML="URL du service",_t.title="URL du service",_t},_createServiceUrlInput:function(){var _t=document.createElement("input");return _t.type="text",_t.id=this._addUID("GPimportServiceUrl"),_t.className="GPinput gpf-input fr-input",_t},_createImportSubmitFormElement:function(){var _t=document.createElement("input");return _t.id=this._addUID("GPimportSubmit"),_t.className="GPsubmit gpf-btn fr-btn",_t.type="submit",_t.value="Importer",_t},_createImportGetCapPanelElement:function(){var _t=document.createElement("div");return _t.id=this._addUID("GPimportGetCapPanel"),_t.className="GPpanel GPelementHidden gpf-panel fr-modal gpf-hidden",_t},_createImportGetCapPanelHeaderElement:function(){var _t=this,e=document.createElement("div");e.className="GPpanelHeader gpf-panel__header fr-modal__header";var n=document.createElement("div");n.className="GPpanelTitle gpf-panel__title fr-modal__title fr-pt-4w",n.innerHTML="Couches accessibles",n.title="Couches accessibles",e.appendChild(n);var ei=document.createElement("button");ei.className="GPpanelClose GPimportGetCapPanelClose gpf-btn gpf-btn-icon-close fr-btn--close fr-btn fr-btn--tertiary-no-outline fr-m-1w",ei.title="Fermer le panneau",ei.id=this._addUID("GPimportGetCapPanelClose"),ei.addEventListener?ei.addEventListener("click",function(){document.getElementById(_t._addUID("GPshowImportPicto")).click(),document.getElementById(_t._addUID("GPimportGetCapPanel")).classList.replace("GPelementVisible","GPelementHidden"),document.getElementById(_t._addUID("GPimportGetCapPanel")).classList.replace("gpf-visible","gpf-hidden"),_t._onGetCapPanelClose()}):ei.attachEvent&&ei.attachEvent("click",function(){document.getElementById(_t._addUID("GPshowImportPicto")).click(),document.getElementById(_t._addUID("GPimportGetCapPanel")).classList.replace("GPelementVisible","GPelementHidden"),document.getElementById(_t._addUID("GPimportGetCapPanel")).classList.replace("gpf-visible","gpf-hidden"),_t._onGetCapPanelClose()});var ti=document.createElement("span");return ti.className="GPelementHidden gpf-visible",ti.innerText="Fermer",ei.appendChild(ti),e.appendChild(ei),e},_createImportGetCapResultsContainer:function(){var _t=document.createElement("div");return _t.className="GPimportGetCapRoot gpf-panel__list",_t.id=this._addUID("GPimportGetCapResults"),_t},_addImportGetCapResultListRubrique:function(_t,e){var n=document.createElement("ul");return n.className="GPimportGetCapListRubrique",n.title=_t,e.appendChild(n),e},_addImportGetCapResultRubrique:function(_t,e){var n=document.createElement("li");n.className="GPimportGetCapRubrique gpf-panel__items_layerimport";var ei=document.createElement("input");ei.id="GPimportGetCapRubrique-"+SelectorID.generate(),ei.className="GPimportGetCapRubrique",ei.type="checkbox",n.appendChild(ei);var ti=document.createElement("label");return ti.className="GPimportGetCapRubriqueTitle gpf-label fr-btn fr-btn--secondary",ti.htmlFor=ei.id,ti.innerHTML=_t,ti.title=_t,n.appendChild(ti),e.appendChild(n),e},_addImportGetCapResultListLayer:function(_t){var e=document.createElement("ul");return e.className="GPimportGetCapListLayer",_t.appendChild(e),_t},_addImportGetCapResultLayer:function(_t,e,n){var ei=document.createElement("li");ei.className="GPimportGetCapProposal gpf-panel__items_layerimport gpf-panel__items",ei.innerHTML=_t.content,ei.title=_t.title,ei.id="GPimportGetCapProposal_"+e;var ti=this;return ei.addEventListener?ei.addEventListener("click",function(ii){ti._onGetCapResponseLayerClick(ii)}):ei.attachEvent&&ei.attachEvent("onclick",function(){ti._onGetCapResponseLayerClick()}),n.appendChild(ei),n},_createImportMapBoxPanelElement:function(){var _t=document.createElement("div");return _t.id=this._addUID("GPimportMapBoxPanel"),_t.className="GPpanel GPelementHidden gpf-panel fr-modal gpf-hidden",_t},_createImportMapBoxPanelHeaderElement:function(){var _t=this,e=document.createElement("div");e.className="GPpanelHeader gpf-panel__header fr-modal__header";var n=document.createElement("button");n.id=this._addUID("GPimportMapBoxPanelReturnPicto"),n.title="Nouvel import",n.className="GPreturnPicto GPimportMapBoxPanelReturnPicto gpf-btn gpf-btn-icon-return fr-btn fr-btn--secondary gpf-btn--secondary",n.addEventListener?n.addEventListener("click",function(ri){document.getElementById(_t._addUID("GPshowImportPicto")).click(),_t._onMapBoxReturnPictoClick(ri)}):n.attachEvent&&n.attachEvent("onclick",function(ri){document.getElementById(_t._addUID("GPshowImportPicto")).click(),_t._onMapBoxReturnPictoClick(ri)}),e.appendChild(n);var ei=document.createElement("div");ei.className="GPpanelTitle gpf-panel__title fr-modal__title fr-pt-4w",ei.innerHTML="Edition des styles",ei.title="Edition des styles",e.appendChild(ei);var ti=document.createElement("button");ti.className="GPpanelClose GPimportMapBoxPanelClose gpf-btn gpf-btn-icon-close fr-btn--close fr-btn fr-btn--tertiary-no-outline fr-m-1w",ti.title="Fermer le panneau",ti.id=this._addUID("GPimportMapBoxPanelClose"),ti.addEventListener?ti.addEventListener("click",function(){document.getElementById(_t._addUID("GPshowImportPicto")).click(),document.getElementById(_t._addUID("GPimportMapBoxPanel")).style.display="none",_t._onMapBoxPanelClose()}):ti.attachEvent&&ti.attachEvent("click",function(){document.getElementById(_t._addUID("GPshowImportPicto")).click(),document.getElementById(_t._addUID("GPimportMapBoxPanel")).style.display="none",_t._onMapBoxPanelClose()});var ii=document.createElement("span");return ii.className="GPelementHidden gpf-visible",ii.innerText="Fermer",ti.appendChild(ii),e.appendChild(ti),e},_createImportMapBoxResultsContainer:function(){var _t=document.createElement("div");return _t.className="GPimportMapBoxpRoot",_t.id=this._addUID("GPimportMapBoxResults"),_t}},MeasureToolBoxDOM={_toolboxId:"GPtoolbox-measure-main",_buttonId:"GPtoolbox-measure-button",_widgetId:"GPtoolbox-measure-widget",getToolBoxID:function(_t){return _t?this._toolboxId+"-"+_t:this._toolboxId},getButtonID:function(_t){return _t?this._buttonId+"-"+_t:this._buttonId},getWidgetID:function(_t){return _t?this._widgetId+"-"+_t:this._widgetId},_createToolBoxContainerElement:function(_t){var e=document.createElement("div");e.id=this.getToolBoxID(_t),e.className="GPshowAdvancedToolPicto";var n=document.createElement("button");n.id=this.getButtonID(_t),n.className="GPshowOpen GPshowAdvancedToolPicto GPshowToolBoxPicto gpf-btn gpf-btn-icon-toolbox fr-btn",n.setAttribute("tabindex","0"),n.setAttribute("aria-pressed",!1),n.setAttribute("type","button");var ei=this;n.addEventListener("click",function(ii){var ri=ii.target.ariaPressed==="true";ii.target.setAttribute("aria-pressed",!ri),this.blur();var ni=document.getElementById(ei.getWidgetID(_t));ni.style.display==="block"?ni.style.display="none":ni.style.display="block"}),e.appendChild(n);var ti=document.createElement("div");return ti.id=this.getWidgetID(_t),ti.addEventListener("click",function(){},!1),e.appendChild(ti),e}},logger$d=LoggerByDefault.getLogger("toolbox"),MeasureToolBox={_toolbox:{},add:function(_t,e){if(logger$d.trace("ToolBox.add()",e),!_t){logger$d.trace("map doesn't exist !?");return}var n=typeof window<"u"?window:typeof self<"u"?self:null;n&&(this._toolbox=n.gpShareMeasureToolBox||{});var ei=_t.getTargetElement(),ti=ei.ownerDocument,ii=ei.id;!this._toolbox||Object.keys(this._toolbox).length===0?(this._toolbox={},this._toolbox[ii]=SelectorID.generate()):this._toolbox[ii]||(this._toolbox[ii]=SelectorID.generate());var ri=this._toolbox[ii];if(!ti.getElementById(this.getToolBoxID(ri))){logger$d.trace("create toolbox !");var ni=this._createToolBoxContainerElement(ri);ni.style.pointerEvents="auto";var si=ei.getElementsByClassName("ol-overlaycontainer-stopevent");si[0].appendChild(ni)}var ai=ti.getElementById(this.getWidgetID(ri));e.setTarget(ai),n&&(n.gpShareMeasureToolBox=this._toolbox),logger$d.trace("add control to toolbox !")}};Helper.assign(MeasureToolBox,MeasureToolBoxDOM);var logger$c=LoggerByDefault.getLogger("measures"),Measures={DEFAULT_POINTER_STYLE:new CircleStyle({radius:5,stroke:new Stroke({color:"#002A50",width:2}),fill:new Fill({color:"rgba(255, 155, 0, 0.7)"})}),DEFAULT_DRAW_START_STYLE:new Style$1({fill:new Fill({color:"rgba(0, 183, 152, 0.2)"}),stroke:new Stroke({color:"#002A50",lineDash:[10,10],width:2})}),DEFAULT_DRAW_FINISH_STYLE:new Style$1({fill:new Fill({color:"rgba(0, 183, 152, 0.3)"}),stroke:new Stroke({color:"#002A50",width:3})}),tools:{MeasureLength:[],MeasureArea:[],MeasureAzimuth:[]},measureDraw:null,measureSource:null,measureVector:null,eventLayerRemove:null,sketch:null,measureTooltipElement:null,measureTooltip:null,helpTooltipElement:null,helpTooltip:null,clean:function(){var _t=this.CLASSNAME;logger$c.trace("["+_t+"] deactived tool !"),this.clearMeasure(),this.clearMeasureToolTip(),this.removeMeasureEvents(),this._pictoContainer.setAttribute("aria-pressed",!1)},onPointerMoveHandler:function(_t){if(!_t.dragging){var e=_t.coordinate;if(this.sketch){var n,ei=this.sketch.getGeometry();if(n=this.format(ei),ei.getType()==="LineString")e=ei.getLastCoordinate();else if(ei.getType()==="Polygon")e=ei.getInteriorPoint().getCoordinates();else return;this.measureTooltipElement.innerHTML=n,this.measureTooltip.setPosition(e)}}},onShowMeasureClick:function(_t,e){_t.target.ariaPressed==="true"&&this.onPanelOpen();var n=this.getMap(),ei=n.getTargetElement().id,ti=typeof window<"u"?window:typeof self<"u"?self:null;ti&&(this.tools=ti.gpShareMeasures||{});var ii=this.CLASSNAME;for(var ri in this.tools)if(this.tools.hasOwnProperty(ri))for(var ni=this.tools[ri],si=0;si<ni.length;si++){var ai=ni[si];ai&&ai.active&&ri!==ii&&ai.map.id===ei&&(ai.active=!1,ai.instance!==null&&ai.instance.clean())}Interactions.unset(n,{current:"Measures"});var oi=this._pictoContainer.ariaPressed;if(oi==="true"){this.addMeasureEvents(),this.initMeasureInteraction(),this.addMeasureInteraction(e);for(var li=0;li<this.tools[ii].length;li++)this.tools[ii][li].map.id===ei&&(this.tools[ii][li].active=!0)}else{this.clearMeasure(),this.clearMeasureToolTip(),this.removeMeasureEvents();for(var ci=0;ci<this.tools[ii].length;ci++)this.tools[ii][ci].map.id===ei&&(this.tools[ii][ci].active=!1)}},clearMeasureToolTip:function(){var _t=this.getMap();if(_t)for(var e=_t.getTargetElement(),n=e.getElementsByClassName("ol-overlaycontainer"),ei=0;ei<n.length;ei++){for(var ti=n[ei],ii=ti.children.length,ri=[],ni=0;ni<ii;ni++){var si=ti.children[ni];if(si.children.length!==0){var ai=si.children[0];(ai.className==="GPmeasureTooltip GPmeasureTooltip-static"||ai.className==="GPmeasureTooltip GPmeasureTooltip-measure")&&ri.push(si)}}for(var oi=0;oi<ri.length;oi++)ti.removeChild(ri[oi])}},clearMeasure:function(){var _t=this.getMap();this.measureVector&&(_t.removeLayer(this.measureVector),this.measureVector=null),this.measureDraw&&(_t.removeInteraction(this.measureDraw),this.measureDraw=null)},createMeasureTooltip:function(_t){this.measureTooltipElement&&this.measureTooltipElement.parentNode.removeChild(this.measureTooltipElement),this.measureTooltipElement=document.createElement("div"),this.measureTooltipElement.className="GPmeasureTooltip GPmeasureTooltip-measure",this.measureTooltip=new Overlay({element:this.measureTooltipElement,stopEvent:!1,offset:[0,-15],positioning:"bottom-center"}),_t.addOverlay(this.measureTooltip)},createHelpTooltip:function(_t){this.helpTooltipElement&&this.helpTooltipElement.parentNode.removeChild(this.helpTooltipElement),this.helpTooltipElement=document.createElement("div"),this.helpTooltipElement.className="tooltip hidden",this.helpTooltip=new Overlay({element:this.helpTooltipElement,stopEvent:!1,offset:[15,0],positioning:"center-left"}),_t.addOverlay(this.helpTooltip)},createStylingMeasureInteraction:function(_t){this.options.styles=_t||{},logger$c.trace("style start",this.options.styles.start);var e={image:Measures.DEFAULT_POINTER_STYLE,fill:Measures.DEFAULT_DRAW_START_STYLE.getFill(),stroke:Measures.DEFAULT_DRAW_START_STYLE.getStroke()};this.options.styles.hasOwnProperty("pointer")&&this.options.styles.pointer instanceof Image&&(e.image=this.options.styles.pointer),this.options.styles.hasOwnProperty("start")&&this.options.styles.start instanceof Style$1&&(this.options.styles.start.getFill()!=null&&(e.fill=this.options.styles.start.getFill()),this.options.styles.start.getStroke()!=null&&(e.stroke=this.options.styles.start.getStroke())),this.options.styles.start=new Style$1(e),logger$c.trace("style finish",this.options.styles.finish);var n={fill:Measures.DEFAULT_DRAW_FINISH_STYLE.getFill(),stroke:Measures.DEFAULT_DRAW_FINISH_STYLE.getStroke()};this.options.styles.hasOwnProperty("finish")&&this.options.styles.finish instanceof Style$1&&(this.options.styles.finish.getFill()!=null&&(n.fill=this.options.styles.finish.getFill()),this.options.styles.finish.getStroke()!=null&&(n.stroke=this.options.styles.finish.getStroke())),this.options.styles.finish=new Style$1(n)},addMeasureInteraction:function(_t){var e=this.getMap(),n=this;this.measureDraw=new Draw({source:this.measureSource,condition:function(ei){return ei.originalEvent.ctrlKey?(n.sketch&&this.removeLastPoint(),!1):!0},type:_t,style:this.options.styles.start||Measures.DEFAULT_DRAW_START_STYLE}),this.measureDraw.setProperties({name:"Measures",source:this}),e.addInteraction(this.measureDraw),this.createMeasureTooltip(e),this.measureDraw.on("drawstart",ei=>{n.sketch=ei.feature}),this.measureDraw.on("drawend",()=>{if(n.sketch){var ei,ti,ii=n.sketch.getGeometry();if(ei=n.format(ii),ii.getType()==="LineString")ti=ii.getLastCoordinate();else if(ii.getType()==="Polygon")ti=ii.getInteriorPoint().getCoordinates();else return;n.measureTooltipElement.innerHTML=ei,n.measureTooltip.setPosition(ti)}n.measureTooltipElement.className="GPmeasureTooltip GPmeasureTooltip-static",n.measureTooltip.setOffset([0,-7]),n.sketch=null,n.measureTooltipElement=null,n.createMeasureTooltip(e)})},initMeasureInteraction:function(){var _t=this.getMap();this.measureSource=new VectorSource,this.measureVector=new VectorLayer({source:this.measureSource,style:this.options.styles.finish||Measures.DEFAULT_DRAW_FINISH_STYLE}),this.measureVector.gpResultLayerId="measure",_t.addLayer(this.measureVector),_t.getControls().forEach(e=>{if(e.CLASSNAME==="LayerSwitcher"){var n=this.measureVector.gpLayerId;e._layers[n].title===n&&e.addLayer(this.measureVector,{title:this.options.layerDescription.title,description:this.options.layerDescription.description})}})}},ElevationPathDOM={_addUID:function(_t){var e=this._uid?_t+"-"+this._uid:_t;return e},_createMainContainerElement:function(){var _t=document.createElement("div");return _t.id=this._addUID("GPelevationPath"),_t.className="GPwidget gpf-widget gpf-widget-button gpf-mobile-fullscreen",_t},_createShowElevationPathPictoElement:function(){var _t=this,e=document.createElement("button"),n=document.createElement("span");return e.appendChild(n),e.id=this._addUID("GPshowElevationPathPicto"),e.classList.add("GPshowOpen","GPshowAdvancedToolPicto","GPshowElevationPathPicto"),e.classList.add("gpf-btn","gpf-btn--tertiary","gpf-btn-icon","gpf-btn-icon-elevation"),e.classList.add("fr-btn","fr-btn--tertiary"),e.setAttribute("aria-label","Profil altimtrique"),e.setAttribute("tabindex","0"),e.setAttribute("aria-pressed",!1),e.setAttribute("type","button"),e.addEventListener?e.addEventListener("click",function(ei){var ti=ei.target.ariaPressed==="true";ei.target.setAttribute("aria-pressed",!ti),_t.onShowElevationPathClick(ei)}):e.attachEvent&&e.attachEvent("onclick",function(ei){var ti=ei.target.ariaPressed==="true";ei.target.setAttribute("aria-pressed",!ti),_t.onShowElevationPathClick(ei)}),e},_createElevationPathPanelElement:function(){var _t=document.createElement("dialog");return _t.id=this._addUID("GPelevationPathPanel"),_t.className="GPpanel gpf-panel fr-modal",_t},_createElevationPathPanelDivElement:function(){var _t=document.createElement("div");return _t.className="gpf-panel__body fr-modal__body",_t},_createDrawingButtonsPluginDiv:function(){var _t=document.createElement("div");return _t.className="container-buttons-plugin fr-mx-2w",_t},_createElevationPathPanelHeaderElement:function(){var _t=this,e=document.createElement("div");if(e.className="GPpanelHeader gpf-panel__header fr-modal__header",!checkDsfr()){var n=document.createElement("button");n.id=this._addUID("GPelevationPathPanelInfo"),n.className="GPpanelInfo gpf-btn gpf-btn-icon-info fr-btn fr-btn--secondary gpf-btn--secondary fr-m-1w",n.title="Informations",n.addEventListener?n.addEventListener("click",function(){_t.onOpenElevationPathInfoClick()}):n.attachEvent&&n.attachEvent("onclick",function(){_t.onOpenElevationPathInfoClick()}),e.appendChild(n)}var ei=document.createElement("div");ei.className="GPpanelTitle gpf-panel__title fr-modal__title fr-pt-4w",ei.innerHTML="Profil Altimtrique",e.appendChild(ei);var ti=document.createElement("button");ti.id=this._addUID("GPelevationPathPanelReduce"),ti.className="GPpanelReduce gpf-btn gpf-btn-icon-reduce fr-btn fr-btn--secondary gpf-btn--secondary",ti.title="Masquer le panneau",ti.addEventListener?ti.addEventListener("click",function(ni){typeof _t.onReduceElevationPathPanelClick=="function"&&_t.onReduceElevationPathPanelClick()},!1):ti.attachEvent&&ti.attachEvent("onclick",function(ni){typeof _t.onReduceElevationPathPanelClick=="function"&&_t.onReduceElevationPathPanelClick()}),e.appendChild(ti);var ii=document.createElement("button");ii.id=this._addUID("GPelevationPathPanelClose"),ii.className="GPpanelClose gpf-btn gpf-btn-icon-close fr-btn--close fr-btn fr-btn--tertiary-no-outline fr-m-1w",ii.title="Fermer le panneau",ii.addEventListener?ii.addEventListener("click",function(){document.getElementById(_t._addUID("GPshowElevationPathPicto")).click()},!1):ii.attachEvent&&ii.attachEvent("onclick",function(){document.getElementById(_t._addUID("GPshowElevationPathPicto")).click()});var ri=document.createElement("span");return ri.className="GPelementHidden gpf-visible",ri.innerText="Fermer",ii.appendChild(ri),e.appendChild(ii),e},_createElevationPathPanelProfilElement:function(){var _t=document.createElement("div");_t.className="GPelevationPathProfilWrapper";var e=document.createElement("div");return e.id="GPelevationPathProfil",_t.appendChild(e),_t},_createElevationPathWaitingElement:function(){var _t=document.createElement("div");_t.id=this._addUID("GPelevationPathCalcWaitingContainer"),_t.className="GPwaitingContainer GPwaitingContainerHidden gpf-waiting gpf-waiting--hidden";var e=document.createElement("p");return e.className="GPwaitingContainerInfo gpf-waiting_info",e.innerHTML="Recherche en cours...",_t.appendChild(e),_t},_createElevationPathInformationsElement:function(){var _t=document.createElement("div");_t.id=this._addUID("GPelevationPathInformationsContainer"),checkDsfr()||(_t.className="GPelementHidden gpf-hidden");var e=document.createElement("p");return e.className="GPelevationPathInformations",e.innerHTML="Aucune information...",_t.appendChild(e),_t},_addElevationPathInformationsItem:function(_t,e){var n=document.getElementById(this._addUID("GPelevationPathInformationsContainer"));if(n){var ei=document.createElement("p");ei.className="GPelevationPathInformations";var ti=document.createElement("span");ti.innerText=_t;var ii=document.createElement("span");ii.innerText=e,ei.appendChild(ti),ei.appendChild(ii),n.appendChild(ei)}return n}},ProfileElevationPathDOM={_getCssProperty:function(_t,e){return window.getComputedStyle(_t,null).getPropertyValue(e)},_getTextWidth:function(_t,e,n=null){var ei=this.canvas||(this.canvas=document.createElement("canvas")),ti=ei.getContext("2d");n===null?ti.font=`${this._getCssProperty(e,"font-weight")} ${this._getCssProperty(e,"font-size")} ${this._getCssProperty(e,"font-family")}`:ti.font=n;var ii=ti.measureText(_t);return ii.width},_dataZToSvgY:function(_t,e,n,ei){return e-(_t-n)*ei-.5},_dataDistToSvgX:function(_t,e,n,ei){return e-n+_t*ei},_svgXToDataDist:function(_t,e,n,ei){return(_t+n-e)/ei},_arrayBisect:function(_t,e){let n;if(_t.length===0)return 0;for(n=0;n<_t.length;n++)if(e<_t[n].dist)return n;return n-1},displayProfileByDefault:function(_t,e,n,ei){var ti=n;if(!e||!_t)return;const ii={fontFamily:"Arial",strokeColor:"#0B6BA7",fillColor:"#00B798",focusLineColor:"#F90"};for(checkDsfr()&&(ii.fontFamily="Marianne",ii.strokeColor="#2F4077",ii.fillColor="#2F4077",ii.focusLineColor="#639f6a");e.firstChild;)e.removeChild(e.firstChild);const ri={top:25,right:15,bottom:10,left:10};var ni=ti.options.displayProfileOptions,si=_t.points,ai=JSON.parse(JSON.stringify(si));ai.sort(function(Ur,Tn){return Ur.z-Tn.z});var oi=ai[0].z,li=ai[ai.length-1].z,ci=_t.distance;let ui="m";const di=document.createElement("div");di.id="profileElevationByDefault",e.appendChild(di);var fi=window.getComputedStyle(e).getPropertyValue("width").replace(/px/,""),hi=window.getComputedStyle(e).getPropertyValue("height").replace(/px/,"");const pi=hi-ri.top-ri.bottom,gi=fi-ri.left-ri.right,vi=17,yi=this._getTextWidth(Math.round(li).toLocaleString()+",88",e,`400 10 ${ii.fontFamily}`),_i=17,Ai=15,Ei=15,Si=this._getTextWidth(Math.round(ci).toLocaleString()+",5",e),wi=1,Oi=pi-_i-Ai,Ii=gi-vi-yi,Li=document.createElementNS("http://www.w3.org/2000/svg","svg");Li.id="profileElevationByDefaultSvg",Li.setAttribute("style","display: block; margin: auto; overflow: visible;"),Li.setAttribute("viewBox",`0 0 ${fi} ${hi}`),Li.setAttribute("width","100%"),Li.setAttribute("height","100%");const Di=Math.floor(Oi/Ei);let Ni;li===oi?Ni=.1:Ni=Math.pow(10,Math.ceil(Math.log((li-oi)/Di)/Math.log(10)))/2;let $i=Math.floor(oi/Ni)*Ni,Ki=Math.ceil(li/Ni)*Ni;Ki===li&&(Ki+=Ni),$i=Math.round($i*100)/100,Ki=Math.round(Ki*100)/100;let er=Math.round((Ki-$i)/Ni);er+1>Di&&(Ni=Math.pow(10,Math.ceil(Math.log((li-oi)/Di)/Math.log(10))),$i=Math.floor(oi/Ni)*Ni,Ki=Math.ceil(li/Ni)*Ni,Ki===li&&(Ki+=Ni),$i=Math.round($i*100)/100,Ki=Math.round(Ki*100)/100,er=Math.floor((Ki-$i)/Ni)),er=Math.max(Math.round(er),1);const Vi=document.createElementNS("http://www.w3.org/2000/svg","g");Vi.setAttribute("class","profile-z-vertical");const nr=document.createElementNS("http://www.w3.org/2000/svg","g"),zi=Oi/er;let Wi;li===oi?Wi=Oi/.2:Wi=Oi/(Ki-$i);let Ti,ki,xi,Mi,Ui,Yi;for(let Ur=0;Ur<=er;Ur++)Ti=document.createElementNS("http://www.w3.org/2000/svg","text"),Ti.setAttribute("class","profile-z-graduation"),Ti.setAttribute("font-family",ii.fontFamily),Ti.setAttribute("font-size","10px"),Ti.setAttribute("fill","#5E5E5E"),Ti.textContent=(Math.round(100*($i+Ur*Ni))/100).toLocaleString(),ki=Oi-Ur*zi,Ti.setAttribute("transform",`translate(${vi+yi-8}, ${ki+5})`),Ti.setAttribute("text-anchor","end"),Vi.appendChild(Ti),xi=Math.round(ki)-.5,Mi=document.createElementNS("http://www.w3.org/2000/svg","g"),Ui=document.createElementNS("http://www.w3.org/2000/svg","path"),Ui.setAttribute("cs","100,100"),Ui.setAttribute("stroke-width","1"),Ur!==0?Ui.setAttribute("stroke-opacity","0.2"):Ui.setAttribute("stroke-opacity","1"),Ui.setAttribute("stroke","#000000"),Ui.setAttribute("fill","none"),Ui.setAttribute("d",`M${vi+yi},${xi} L${Ii+vi+yi},${xi}`),Yi=document.createElementNS("http://www.w3.org/2000/svg","path"),Yi.setAttribute("cs","100,100"),Yi.setAttribute("stroke-width","1"),Yi.setAttribute("stroke-opacity","1"),Yi.setAttribute("stroke","#000000"),Yi.setAttribute("fill","none"),Yi.setAttribute("d",`M${vi+yi},${xi} L${vi+yi+5},${xi}`),Yi.setAttribute("transform","translate(-5, 0)"),Mi.appendChild(Yi),Mi.appendChild(Ui),nr.appendChild(Mi);var sr=document.createElementNS("http://www.w3.org/2000/svg","text");sr.setAttribute("class","profile-z-legend"),sr.setAttribute("font-family",ii.fontFamily),sr.setAttribute("font-size","11px"),sr.setAttribute("fill","#5E5E5E"),sr.textContent="Altitude (m)",sr.setAttribute("transform",`translate(${vi-8}, ${Math.round(Oi/2)}) rotate(-90)`),sr.setAttribute("text-anchor","middle"),Vi.appendChild(sr),Li.appendChild(Vi),Li.appendChild(nr),ci>2e3&&(ci/=1e3,ui="km");const cr=Math.floor(Ii/Si);let ir=Math.pow(10,Math.ceil(Math.log(ci/cr)/Math.log(10)))/2;const Zi=ci;let rr=Math.floor(Zi/ir);rr>cr?(ir=Math.pow(10,Math.ceil(Math.log(ci/cr)/Math.log(10))),rr=Math.floor(Zi/ir)):rr<wi&&(ir=Math.pow(10,Math.ceil(Math.log(ci/cr)/Math.log(10))-1),rr=Math.floor(Zi/ir)),rr=Math.max(rr,1);const ar=ir*rr,pr=document.createElementNS("http://www.w3.org/2000/svg","g");pr.setAttribute("class","profile-x-vertical");const Gi=document.createElementNS("http://www.w3.org/2000/svg","g"),gr=Ii/Zi,Br=(Zi-ar)*gr,Nr=Math.round((Ii-Br)/rr);let mr,Mr,Er,Fr,or,yr;for(let Ur=0;Ur<=rr+1;Ur++)mr=document.createElementNS("http://www.w3.org/2000/svg","text"),mr.setAttribute("class","profile-x-graduation"),mr.setAttribute("font-family",ii.fontFamily),mr.setAttribute("font-size","10px"),mr.setAttribute("fill","#5E5E5E"),Ur!==rr+1&&(mr.textContent=(Math.round(100*Ur*ir)/100).toLocaleString()),Mr=vi+yi+Ur*Nr,Ur===rr+1&&(Mr=vi+yi+Ii),mr.setAttribute("transform",`translate(${Mr}, ${Oi+Ai+5})`),mr.setAttribute("text-anchor","middle"),pr.appendChild(mr),Er=Mr-.5,Fr=document.createElementNS("http://www.w3.org/2000/svg","g"),or=document.createElementNS("http://www.w3.org/2000/svg","path"),or.setAttribute("cs","100,100"),or.setAttribute("stroke-width","1"),Ur!==0?or.setAttribute("stroke-opacity","0.2"):or.setAttribute("stroke-opacity","1"),or.setAttribute("stroke","#000000"),or.setAttribute("fill","none"),or.setAttribute("d",`M${Er},${Oi} L${Er},0`),yr=document.createElementNS("http://www.w3.org/2000/svg","path"),yr.setAttribute("cs","100,100"),yr.setAttribute("stroke-width","1"),yr.setAttribute("stroke-opacity","1"),yr.setAttribute("stroke","#000000"),yr.setAttribute("fill","none"),yr.setAttribute("d",`M${Er},${Oi} L${Er},${Oi-5}`),yr.setAttribute("transform","translate(0, 5)"),Fr.appendChild(yr),Fr.appendChild(or),Gi.appendChild(Fr);var _r=document.createElementNS("http://www.w3.org/2000/svg","text");_r.setAttribute("class","profile-x-legend"),_r.setAttribute("font-family",ii.fontFamily),_r.setAttribute("font-size","11px"),_r.setAttribute("fill","#5E5E5E"),_r.textContent=`Distance (${ui})`,_r.setAttribute("transform",`translate(${vi+yi+Ii/2}, ${Oi+Ai+_i+3})`),_r.setAttribute("text-anchor","middle"),pr.appendChild(_r),Li.appendChild(pr),Li.appendChild(Gi);const Ar=document.createElementNS("http://www.w3.org/2000/svg","g");let wr=1;ui==="km"&&(wr=1e3);let Rr=this._dataDistToSvgX(si[0].dist/wr,gi,Ii,gr),Sr=this._dataZToSvgY(si[0].z,Oi,$i,Wi),Gr=`M${Rr},${Sr}`;for(let Ur=1;Ur<si.length;Ur++)Rr=this._dataDistToSvgX(si[Ur].dist/wr,gi,Ii,gr),Sr=this._dataZToSvgY(si[Ur].z,Oi,$i,Wi),Gr+=` L${Rr},${Sr}`;const Or=document.createElementNS("http://www.w3.org/2000/svg","path");Or.setAttribute("cs","100,100"),Or.setAttribute("stroke-width","1"),Or.setAttribute("stroke-opacity","1"),Or.setAttribute("stroke",ii.strokeColor),Or.setAttribute("fill","none"),Or.setAttribute("d",Gr),Gr+=` L${Rr},${Oi}`,Gr+=` L${gi-Ii},${Oi}`;const nn=document.createElementNS("http://www.w3.org/2000/svg","path");nn.setAttribute("cs","100,100"),nn.setAttribute("stroke-width","1"),nn.setAttribute("stroke-opacity","0"),nn.setAttribute("stroke","#000000"),nn.setAttribute("fill",ii.fillColor),nn.setAttribute("fill-opacity","0.2"),nn.setAttribute("d",Gr),Ar.appendChild(Or),Ar.appendChild(nn),Li.appendChild(Ar);const en=document.createElementNS("http://www.w3.org/2000/svg","g"),Vr=document.createElementNS("http://www.w3.org/2000/svg","rect");Vr.setAttribute("width",Ii),Vr.setAttribute("height",Oi),Vr.setAttribute("transform",`translate(${gi-Ii},0)`),Vr.setAttribute("visibility","hidden"),Vr.setAttribute("pointer-events","all");const Xr=JSON.parse(JSON.stringify(si));Xr.sort(function(Ur,Tn){return Ur.dist-Tn.dist});const tn=document.createElementNS("http://www.w3.org/2000/svg","line");tn.setAttribute("id","focusLineX"),tn.setAttribute("class","focusLine-default"),tn.setAttribute("fill","none"),tn.setAttribute("stroke",ii.focusLineColor),tn.setAttribute("stroke-width","0.5px"),tn.setAttribute("visibility","hidden");const Dr=document.createElementNS("http://www.w3.org/2000/svg","line");Dr.setAttribute("id","focusLineY"),Dr.setAttribute("class","focusLine-default"),Dr.setAttribute("fill","none"),Dr.setAttribute("stroke",ii.focusLineColor),Dr.setAttribute("stroke-width","0.5px"),Dr.setAttribute("visibility","hidden");const rn=document.createElementNS("http://www.w3.org/2000/svg","circle");rn.setAttribute("id","focusCircle"),rn.setAttribute("r",4),rn.setAttribute("class","circle-default focusCircle-default"),rn.setAttribute("fill",ii.focusLineColor),rn.setAttribute("visibility","hidden"),en.appendChild(rn),en.appendChild(tn),en.appendChild(Dr);const jr=document.createElementNS("http://www.w3.org/2000/svg","text"),$r=document.createElementNS("http://www.w3.org/2000/svg","tspan"),un=document.createElementNS("http://www.w3.org/2000/svg","tspan"),sn=document.createElementNS("http://www.w3.org/2000/svg","tspan");jr.setAttribute("style",`text-align:center; max-width:220px; font-size:10px; color:#000000; font-family:${ii.fontFamily}; z-index:50;`),jr.style.pointerEvents="none",jr.style.position="fixed",jr.setAttribute("class","tooltipInit"),jr.setAttribute("text-anchor","middle"),di.appendChild(jr),$r.setAttribute("class","altiPathValue"),$r.setAttribute("x","0"),$r.setAttribute("dy","-.7em"),un.setAttribute("class","altiPathValue"),un.setAttribute("x","0"),un.setAttribute("dy","1em"),sn.setAttribute("class","altiPathCoords"),sn.setAttribute("x","0"),sn.setAttribute("dy","1em"),jr.appendChild($r),ni.currentSlope&&jr.appendChild(un),jr.appendChild(sn);const Wr=document.createElementNS("http://www.w3.org/2000/svg","g");en.appendChild(Wr);const an=document.createElementNS("http://www.w3.org/2000/svg","path");an.setAttribute("cs","100,100"),an.setAttribute("fill","#FFFFFF"),an.setAttribute("stroke","#CCCCCC"),an.setAttribute("fill-opacity","0.8"),an.setAttribute("stroke-width","1"),an.setAttribute("stroke-opacity","1");const En=document.createElementNS("http://www.w3.org/2000/svg","path");En.setAttribute("cs","100,100"),En.setAttribute("fill","#FFFFFF"),En.setAttribute("stroke","#000000"),En.setAttribute("fill-opacity","0"),En.setAttribute("stroke-width","1"),En.setAttribute("stroke-opacity","0.4"),En.setAttribute("transform","translate(1,1)"),Wr.appendChild(En),Wr.appendChild(an),Wr.appendChild(jr),Wr.setAttribute("class","tooltipInit"),Wr.style.pointerEvents="none";function Pn(){tn.setAttribute("visibility","visible"),Dr.setAttribute("visibility","visible"),rn.setAttribute("visibility","visible"),ei.__createProfileMarker(ti,si[0]),jr.classList.remove("tooltipInit"),Wr.classList.remove("tooltipInit"),jr.classList.remove("tooltipFadeOut"),Wr.classList.remove("tooltipFadeOut"),jr.classList.add("tooltipFadeIn"),Wr.classList.add("tooltipFadeIn")}function Dn(){tn.setAttribute("visibility","hidden"),Dr.setAttribute("visibility","hidden"),rn.setAttribute("visibility","hidden"),ei.__removeProfileMarker(ti),jr.classList.remove("tooltipFadeIn"),Wr.classList.remove("tooltipFadeIn"),jr.classList.add("tooltipFadeOut"),Wr.classList.add("tooltipFadeOut")}function Gn(Ur){const Tn=Li.createSVGPoint();Tn.x=Ur.clientX,Tn.y=Ur.clientY;const $n=Tn.matrixTransform(Li.getScreenCTM().inverse()),mn=this._svgXToDataDist($n.x,gi,Ii,gr)*wr,bn=Math.max(1,this._arrayBisect(Xr,mn)),yn=si[bn-1],Fn=si[bn];let Ln=yn;mn-yn.dist>Fn.dist-mn&&(Ln=Fn);const Is=this._dataDistToSvgX(Ln.dist/wr,gi,Ii,gr),_s=this._dataZToSvgY(Ln.z,Oi,$i,Wi);rn.setAttribute("cx",Is),rn.setAttribute("cy",_s),tn.setAttribute("x1",Is),tn.setAttribute("y1",Oi),tn.setAttribute("x2",Is),tn.setAttribute("y2",0),Dr.setAttribute("x1",vi+yi),Dr.setAttribute("y1",_s),Dr.setAttribute("x2",Ii+vi+yi),Dr.setAttribute("y2",_s),ei.__updateProfileMarker(ti,Ln);const Cs=`Altitude : ${Ln.z.toLocaleString()} m`,ks=`Pente : ${Ln.slope} %`,As=`(lat : ${Ln.lat.toLocaleString()} / lon : ${Ln.lon.toLocaleString()})`;$r.innerHTML=Cs,un.innerHTML=ks,sn.innerHTML=As;const as=Math.max(this._getTextWidth(As,sn),this._getTextWidth(Cs,$r));let ls;Ln.dist>ci*wr/2?(ls=`M -0.5 -0.5 l -6 6 l 0 16 l -${as+10} 0 l 0 -44 l ${as+10} 0 l 0 16 l 6 6`,jr.setAttribute("transform",`translate(${-(as/2+12)},0)`)):Ln.dist<=ci*wr/2&&(ls=`M -0.5 -0.5 l 6 6 l 0 16 l ${as+10} 0 l 0 -44 l -${as+10} 0 l 0 16 l -6 6`,jr.setAttribute("transform",`translate(${as/2+12},0)`)),an.setAttribute("d",ls),En.setAttribute("d",ls),Wr.setAttribute("transform",`translate(${Is},${_s})`),Wr.style.transform=`translate(${Is}px,${_s}px)`}return Vr.addEventListener("pointerover",Pn),Vr.addEventListener("pointerout",Dn),Vr.addEventListener("pointermove",Gn.bind(this)),en.appendChild(Vr),Li.appendChild(en),di.appendChild(Li),e},displayProfileRaw:function(_t,e,n,ei){if(e){for(;e.firstChild;)e.removeChild(e.firstChild);var ti=_t&&_t.points?_t.points:{},ii=document.createElement("textarea");return ii.id="profilElevationResults",ii.rows=10,ii.cols=50,ii.style.width="100%",ii.innerHTML=JSON.stringify(ti,void 0,4),ii.addEventListener("mouseover",function(ri){ei.__customRawProfileMouseOverEvent(n,ri)}),e.appendChild(ii),e}},displayProfileLibD3:function(_t,e,n,ei){var ti=n;if(e&&_t){for(;e.firstChild;)e.removeChild(e.firstChild);var ii=_t.points;if(_t.distance>2e3){_t.unit="km";for(let Si=0;Si<ii.length;Si++)ii[Si].dist/=1e3}var ri=ti.options.displayProfileOptions,ni={top:20,right:20,bottom:30,left:40},si=window.getComputedStyle(e).getPropertyValue("width"),ai=window.getComputedStyle(e).getPropertyValue("height"),oi=si.replace(/px/,"")-ni.left-ni.right,li=ai.replace(/px/,"")-ni.top-ni.bottom,ci=d3.scale.linear().range([0,oi]),ui=d3.scale.linear().range([li,0]),di=d3.svg.axis().scale(ci).orient("bottom").ticks(5),fi=d3.svg.axis().scale(ui).orient("left").ticks(5),hi=d3.svg.line().interpolate("basis").x(function(Si){return ci(Si.dist)}).y(function(Si){return ui(Si.z)}),pi=d3.svg.area().interpolate("basis").x(function(Si){return ci(Si.dist)}).y0(li).y1(function(Si){return ui(Si.z)}),gi=d3.select(e).append("svg").attr("width",oi+ni.left+ni.right).attr("height",li+ni.top+ni.bottom).append("g").attr("transform","translate("+ni.left+","+ni.top+")"),vi=d3.extent(ii,function(Si){return Si.dist});ci.domain(vi);var yi=[0,d3.max(ii,function(Si){return Si.z})];ui.domain(yi),gi.append("path").datum(ii).attr("class","area-d3").attr("d",pi),gi.append("g").attr("class","x axis-d3").attr("transform","translate(0,"+li+")").call(di).append("text").attr("y",-15).attr("dy",".71em").attr("x",oi).text("Distance ("+_t.unit+")"),gi.append("g").attr("class","y axis-d3").call(fi).append("text").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").text("Altitude (m)"),gi.append("g").attr("class","grid-d3 vertical").attr("transform","translate(0,"+li+")").call(di.orient("bottom").tickSize(-li,0,0).tickFormat("")),gi.append("g").attr("class","grid-d3 horizontal").call(fi.orient("left").tickSize(-oi,0,0).tickFormat("")),gi.append("path").datum(ii).attr("class","line-d3").attr("d",hi),gi.selectAll("circle").data(ii).enter().append("circle").attr("cx",function(Si){return ci(Si.dist)}).attr("cy",function(Si){return ui(Si.z)}).attr("r",0).attr("class","circle-d3");var _i=gi.append("g").style("display","none");_i.append("line").attr("id","focusLineX").attr("class","focusLine-d3"),_i.append("line").attr("id","focusLineY").attr("class","focusLine-d3"),_i.append("circle").attr("id","focusCircle").attr("r",4).attr("class","circle-d3 focusCircle-d3");var Ai=d3.select(e).append("div").attr("class","tooltip-d3").style("opacity",0),Ei=d3.bisector(function(Si){return Si.dist}).left;return gi.append("rect").attr("class","overlay-d3").attr("width",oi).attr("height",li).on("mouseover",function(){_i.style("display",null),ei.__createProfileMarker(ti,ii[0])}).on("mouseout",function(){_i.style("display","none"),ei.__removeProfileMarker(ti),Ai.transition().duration(500).style("opacity",0)}).on("mousemove",function(){var Si=d3.mouse(this),wi=ci.invert(Si[0]),Oi=Math.max(1,Ei(ii,wi)),Ii=ii[Oi-1],Li=ii[Oi],Di=wi-Ii[0]>Li[0]-wi?Li:Ii,Ni=ci(Di.dist),$i=ui(Di.z);_i.select("#focusCircle").attr("cx",Ni).attr("cy",$i),_i.select("#focusLineX").attr("x1",Ni).attr("y1",ui(yi[0])).attr("x2",Ni).attr("y2",ui(yi[1])),_i.select("#focusLineY").attr("x1",ci(vi[0])).attr("y1",$i).attr("x2",ci(vi[1])).attr("y2",$i),ei.__updateProfileMarker(ti,Di),Ai.transition().duration(200).style("opacity",.9);var Ki="";Ki+=" Altitude : "+Di.z+" m",ri.currentSlope&&(Ki+="<br/> Pente : "+Di.slope+" %"),Ki+="<br/> (Lat : "+Di.lat+"/ Lon : "+Di.lon+")",Ai.html(Ki).style("left",d3.event.pageX+"px").style("top",d3.event.pageY-28+"px")}),gi}},displayProfileLibAmCharts:function(_t,e,n,ei){var ti=n;if(e&&_t){var ii=_t.points,ri="<span class='altiPathValue'>[[title]] : [[value]]m</span><br/>",ni=ti.options.displayProfileOptions.currentSlope;if(ni&&(ri+="<span class='altiPathValue'>Pente : [[slope]] %</span><br/>"),ri+="<span class='altiPathCoords'>(Lat: [[lat]] / Lon:[[lon]])</span>",AmCharts.addInitHandler(function(){}),_t.distance>2e3){_t.unit="km";for(let ci=0;ci<ii.length;ci++)ii[ci].dist/=1e3}for(let ci=0;ci<ii.length;ci++){var si=ii[ci].dist,ai=100;si>100?ai=1:si>10&&(ai=10),si=Math.round(si*ai)/ai,ii[ci].dist=si}var oi={type:"serial",pathToImages:"http://cdn.amcharts.com/lib/3/images/",categoryField:"dist",autoMarginOffset:0,marginRight:10,marginTop:10,startDuration:0,color:"#5E5E5E",fontSize:8,theme:"light",thousandsSeparator:"",numberFormatter:{precision:-1,decimalSeparator:",",thousandsSeparator:" "},categoryAxis:{color:"#5E5E5E",gridPosition:"start",minHorizontalGap:40,tickPosition:"start",title:"Distance ("+_t.unit+")",titleColor:"#5E5E5E",labelOffset:0,startOnAxis:!0},chartCursor:{animationDuration:0,bulletsEnabled:!0,bulletSize:10,categoryBalloonEnabled:!1,cursorColor:"#F90",graphBulletAlpha:1,graphBulletSize:1,zoomable:!1},trendLines:[],graphs:[{balloonColor:"#CCCCCC",balloonText:ri,bullet:"round",bulletAlpha:0,bulletBorderColor:"#FFF",bulletBorderThickness:2,bulletColor:"#F90",bulletSize:6,hidden:!1,id:"AmGraph-1",fillAlphas:.4,fillColors:"#C77A04",lineAlpha:1,lineColor:"#C77A04",lineThickness:1,title:"Altitude",valueField:"z"}],guides:[],valueAxes:[{id:"ValueAxis-1",minVerticalGap:20,title:"Altitude (m)"}],balloon:{borderColor:"#CCCCCC",borderThickness:1,fillColor:"#FFFFFF",showBullet:!0},titles:[],allLabels:[],dataProvider:ii},li=AmCharts.makeChart(e,oi);return li.addListener("changed",function(ci){var ui=ci.chart.dataProvider[ci.index];ei.__updateProfileMarker(ti,ui)}),li}}},logger$b=LoggerByDefault.getLogger("elevationpath");const Ss=class Ss extends ControlExtended{constructor(e){if(logger$b.trace("ElevationPath()"),e=e||{},super(e),!(this instanceof Ss))throw new TypeError("ERROR CLASS_CONSTRUCTOR");return this.CLASSNAME="ElevationPath",this._uid=e.id||SelectorID.generate(),this._showContainer=null,this._pictoButton=null,this._panelContainer=null,this._profileContainer=null,this._waitingContainer=null,this._infoContainer=null,this._timerHdlr=null,this._drawStyleStart=null,this._drawStyleFinish=null,this._markerStyle=null,this._profile=null,this._data={},this._measureSource=null,this._measureVector=null,this._measureDraw=null,this._lastSketch=null,this._currentSketch=null,this._marker=null,this._initialize(e),this._container=this._initializeContainer(),this.element?this.element.appendChild(this._container):this.element=this._container,this}static __removeProfileMarker(e){var n=e;n._marker&&(n._measureSource.removeFeature(n._marker),n._marker=null)}static __createProfileMarker(e,n){var ei=e;ei._marker&&(ei._measureSource.removeFeature(ei._marker),ei._marker=null);var ti=ei.getMap(),ii=ti.getView().getProjection(),ri=transform$1([n.lon,n.lat],"EPSG:4326",ii),ni=ei._measureSource.getFeatures()[0].getGeometry().getClosestPoint(ri),si=new Point$1(ni);ei._marker=new Feature({geometry:si}),logger$b.trace(si),ei._marker.setStyle(ei._markerStyle),ei._measureSource.addFeature(ei._marker)}static __updateProfileMarker(e,n){var ei=e;Ss.__removeProfileMarker(ei),Ss.__createProfileMarker(ei,n)}static __customRawProfileOperation(e,n){logger$b.log("__customRawProfileOperation");for(var ei=e,ti=n.points,ii=ei.getMap().getView().getProjection(),ri=0;ri<ti.length;ri++){var ni=ti[ri],si=transform$1([ni.lon,ni.lat],"EPSG:4326",ii),ai=new Point$1(si);ei._marker=new Feature({geometry:ai}),logger$b.trace(ai);var oi=Ss.DEFAULT_STYLES.RESULTS,li=new CircleStyle({radius:oi.imageRadius,stroke:new Stroke({color:oi.imageStrokeColor,width:oi.imageStrokeWidth}),fill:new Fill({color:oi.imageFillColor})});ei._marker.setStyle(new Style$1({image:li})),ei._measureSource.addFeature(ei._marker)}}static __customRawProfileMouseOverEvent(e,n){logger$b.log("__customRawProfileMouseOverEvent",e,n)}static DISPLAY_PROFILE_LIB_AMCHARTS(e,n,ei){if(logger$b.trace("ElevationPath.DISPLAY_PROFILE_LIB_AMCHARTS"),typeof AmCharts>"u"){logger$b.log("Lib. AmCharts is not loaded !");return}var ti=ProfileElevationPathDOM.displayProfileLibAmCharts(e,n,ei,Ss);ti&&(this._profile=ti)}static DISPLAY_PROFILE_LIB_D3(e,n,ei){if(logger$b.trace("ElevationPath.DISPLAY_PROFILE_LIB_D3"),typeof d3>"u"){logger$b.log("Lib. D3 is not loaded !");return}var ti=ProfileElevationPathDOM.displayProfileLibD3(e,n,ei,Ss);ti&&(this._profile=ti)}static DISPLAY_PROFILE_RAW(e,n,ei){logger$b.trace("ElevationPath.DISPLAY_PROFILE_RAW");var ti=ProfileElevationPathDOM.displayProfileRaw(e,n,ei,Ss);ti&&(this._profile=ti)}static DISPLAY_PROFILE_BY_DEFAULT(e,n,ei){logger$b.trace("ElevationPath.DISPLAY_PROFILE_BY_DEFAULT");var ti=ProfileElevationPathDOM.displayProfileByDefault(e,n,ei,Ss);ti&&(this._profile=ti)}setMap(e){if(logger$b.trace("ElevationPath::setMap"),e&&(this.options.active&&(this._profile===null&&(this._panelContainer.style.display="none"),this._initMeasureInteraction(e),this._addMeasureInteraction(e)),!this.options.target&&!this.options.position&&MeasureToolBox.add(e,this),this.options.export)){var n=Helper.assign({control:this},this.options.export);this.export=new ButtonExport(n),this.export.render();var ei=this;this.export.on("button:clicked",ti=>{ei.dispatchEvent({type:"export:compute",content:ti.content})})}super.setMap(e),this.options.position&&this.setPosition(this.options.position),this.options.gutter===!1&&this.getContainer().classList.add("gpf-button-no-gutter")}getActive(){return logger$b.trace("ElevationPath::getActive"),this.options.active}setActive(e){logger$b.trace("ElevationPath::setActive"),this.options.active=e}getData(){return Helper.assign({type:"elevationpath"},this._data)}setData(e){this._data=e}getContainer(){return this._container}getLayer(){return this._measureVector}setLayer(e){if(!e){this._measureVector=null;return}if(!(e instanceof VectorLayer)){logger$b.log("no valid layer given for hosting drawn features.");return}e.setStyle(this._drawStyleFinish),this._measureVector=e,this._measureSource=e.getSource()}getGeoJSON(){var e=this._measureVector.getSource().getFeatures(),n=new GeoJSON({defaultStyle:this._drawStyleFinish}),ei=n.writeFeatures(e,{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"});return ei}getStyle(){return this._drawStyleFinish}clean(e){logger$b.trace("ElevationPath::clean");var n=this.getMap();this._panelContainer.style.display="none",this._pictoButton.setAttribute("aria-pressed",!1),this._removeProfile(),this._removeMeasureInteraction(n,typeof e<"u"?e:!1),this.setLayer()}init(){this._pictoButton.setAttribute("aria-pressed",!0),this._panelContainer.style.display="block",this._displayProfile(this._data),this._waitingContainer.className="GPwaitingContainer GPwaitingContainerHidden gpf-waiting gpf-waiting--hidden"}_initialize(e){logger$b.trace("ElevationPath::_initialize : ",e),this.options={target:null,render:null,active:!1,apiKey:null,export:!1,elevationOptions:{outputFormat:"json"},layerDescription:{title:"Profil altimtrique",description:"Mon profil altimtrique"},displayProfileOptions:{totalDistance:!0,greaterSlope:!0,meanSlope:!0,ascendingElevation:!0,descendingElevation:!0,currentSlope:!0,apply:null,target:null},stylesOptions:{profile:null,draw:null,marker:null}},Helper.mergeParams(this.options,e),this.options.target=e.target||null,this.options.apiKey=e.apiKey;var n=e.displayProfileOptions||{};this.export=null;var ei=n.apply;this.options.displayProfileOptions.apply=typeof ei=="function"?ei:Ss.DISPLAY_PROFILE_BY_DEFAULT;var ti=n.target;this.options.displayProfileOptions.target=typeof ti<"u"?ti:null;var ii=e.stylesOptions||{};this.options.stylesOptions.draw=ii.draw||{},this._createStylingDraw(),this.options.stylesOptions.marker=ii.marker||{},this._createStylingMarker(),this.COMPUTE_ELEVATION_EVENT="elevationpath:compute",this.DRAW_START_ELEVATION_EVENT="elevationpath:drawstart",this.DRAW_END_ELEVATION_EVENT="elevationpath:drawend"}_initializeContainer(){logger$b.trace("ElevationPath::_initializeContainer : ",this._uid);var e=this._createMainContainerElement(),n=this._pictoButton=this._createShowElevationPathPictoElement();e.appendChild(n),this.options.active&&this._pictoButton.click();var ei=this._panelContainer=this._createElevationPathPanelElement(),ti=this._createElevationPathPanelDivElement();ei.appendChild(ti);var ii=this._createElevationPathPanelHeaderElement();ti.appendChild(ii);var ri=this._createElevationPathPanelProfilElement();this._profileContainer=ri.firstChild,ti.appendChild(ri);var ni=this._waitingContainer=this._createElevationPathWaitingElement();ti.appendChild(ni);var si=this._infoContainer=this._createElevationPathInformationsElement();ti.appendChild(si);var ai=this._createDrawingButtonsPluginDiv();return ti.appendChild(ai),this.options.displayProfileOptions.target===null&&e.appendChild(ei),e}_createStylingMarker(){logger$b.trace("ElevationPath::_createStylingMarker ");var e=Ss.DEFAULT_STYLES.MARKER;logger$b.trace("style marker",e),this.options.stylesOptions.marker instanceof ImageStyle&&(e=this.options.stylesOptions.marker),this._markerStyle=new Style$1({image:e})}_createStylingDraw(){logger$b.trace("ElevationPath::_createStylingDraw");var e=this.options.stylesOptions.draw;logger$b.trace("style start",e.start);var n={image:Measures.DEFAULT_POINTER_STYLE,stroke:Measures.DEFAULT_DRAW_START_STYLE.getStroke()};e.hasOwnProperty("pointer")&&e.pointer instanceof ImageStyle&&(n.image=e.pointer),e.hasOwnProperty("start")&&e.start instanceof Stroke&&(n.stroke=e.start),this._drawStyleStart=new Style$1(n),logger$b.trace("style finish",e.finish);var ei={stroke:Measures.DEFAULT_DRAW_FINISH_STYLE.getStroke()};e.hasOwnProperty("finish")&&e.finish instanceof Stroke&&(ei.stroke=e.finish),this._drawStyleFinish=new Style$1(ei)}_createStylingProfile(){logger$b.trace("ElevationPath::_createStylingProfile");var e=this.options.stylesOptions.profile;logger$b.trace("style profile",e);var n=Ss.DEFAULT_STYLES.PROFILE;Object.keys(n).forEach(ei=>{if(!e.hasOwnProperty(ei))e[ei]=n[ei];else{var ti=n[ei];typeof ti=="object"&&(Helper.mergeParams(ti,e[ei]),e[ei]=ti)}})}_initMeasureInteraction(e){logger$b.trace("ElevationPath::_initMeasureInteraction()"),e&&(this._measureSource=new VectorSource,this._measureVector=new VectorLayer({source:this._measureSource,style:this._drawStyleFinish}),this._measureVector.gpResultLayerId="measure:profil",e.addLayer(this._measureVector),e.getControls().forEach(n=>{if(n instanceof LayerSwitcher){var ei=this._measureVector.gpLayerId;n._layers[ei].title===ei&&n.addLayer(this._measureVector,{title:this.options.layerDescription.title,description:this.options.layerDescription.description})}}))}_addMeasureInteraction(e){logger$b.trace("ElevationPath::_addMeasureInteraction()"),e&&(this._measureDraw=new Draw({source:this._measureSource,type:"LineString",style:this._drawStyleStart,stopClick:!0}),this._measureDraw.setProperties({name:"ElevationPath",source:this}),e.addInteraction(this._measureDraw),this._measureDraw.on("drawstart",n=>{logger$b.trace("drawstart",n),this._marker!==null&&(this._measureSource.removeFeature(this._marker),this._marker=null),this._lastSketch!==null&&(this._measureSource.removeFeature(this._lastSketch),this._lastSketch=null),this._currentSketch=n.feature;for(var ei=this._measureSource.getFeatures(),ti=0;ti<ei.length;ti++)this._measureSource.removeFeature(ei[ti]);this.dispatchEvent(this.DRAW_START_ELEVATION_EVENT)}),this._measureDraw.on("drawend",n=>{logger$b.trace("drawend",n),this.dispatchEvent(this.DRAW_END_ELEVATION_EVENT),this._lastSketch=this._currentSketch,typeof this.options.elevationOptions.onSuccess>"u"&&this.options.displayProfileOptions.target===null&&(this._panelContainer.style.display="block"),this._measureDraw.setActive(!1),this._requestService()}))}_removeMeasureInteraction(e,n){logger$b.trace("ElevationPath::_removeMeasureInteraction()"),e&&(n&&this._measureVector&&(e.removeLayer(this._measureVector),this._measureVector=null),this._measureDraw&&(e.removeInteraction(this._measureDraw),this._measureDraw=null))}_getGeometry(){if(this._currentSketch===null){logger$b.warn("Current Feature undefined !?");return}for(var e=[],n=this.getMap(),ei=n.getView().getProjection(),ti="EPSG:4326",ii=this._currentSketch.getGeometry().getCoordinates(),ri=0;ri<ii.length;ri++){var ni=ii[ri],si=ni;ei!==ti&&(si=transform$1(ni,ei,ti)),e.push({lon:Math.round(si[0]*1e8)/1e8,lat:Math.round(si[1]*1e8)/1e8})}return e}_getLength(){if(this._currentSketch===null){logger$b.warn("Current Feature undefined !?");return}for(var e=0,n=this.getMap(),ei=n.getView().getProjection(),ti="EPSG:4326",ii=this._currentSketch.getGeometry().getCoordinates(),ri=0,ni=ii.length-1;ri<ni;++ri){var si=transform$1(ii[ri],ei,ti),ai=transform$1(ii[ri+1],ei,ti);si[0]=Math.round(si[0]*1e8)/1e8,si[1]=Math.round(si[1]*1e8)/1e8,ai[0]=Math.round(ai[0]*1e8)/1e8,ai[1]=Math.round(ai[1]*1e8)/1e8,e+=getDistance(si,ai)}return e}_getSketchCoords(){if(this._currentSketch===null){logger$b.warn("Current Feature undefined !?");return}for(var e=this.getMap(),n=e.getView().getProjection(),ei="EPSG:4326",ti=[],ii=this._currentSketch.getGeometry().getCoordinates(),ri=0;ri<ii.length;ri++){var ni=transform$1(ii[ri],n,ei);ni[0]=Math.round(ni[0]*1e8)/1e8,ni[1]=Math.round(ni[1]*1e8)/1e8,ti.push(ni)}return ti}_requestService(){logger$b.trace("ElevationPath::_requestService");var e=this._getGeometry();if(logger$b.trace("geometry",e),!e){logger$b.warn("missing geometry !?");return}var n={};Helper.mergeParams(n,this.options.elevationOptions),Helper.mergeParams(n,{apiKey:n.apiKey||this.options.apiKey}),typeof n.ssl!="boolean"&&(typeof this.options.ssl=="boolean"?n.ssl=this.options.ssl:n.ssl=!0),Helper.mergeParams(n,{ssl:n.ssl});var ei=this,ti=this.options.elevationOptions.onFailure!==null&&typeof this.options.elevationOptions.onFailure=="function",ii=this.options.elevationOptions.onSuccess!==null&&typeof this.options.elevationOptions.onSuccess=="function",ri=function(oi){logger$b.trace(oi),oi&&(ei._panelContainer.style.display="block",ei._data&&(ei._data={}),ei._data=ei._computeElevationMeasure(oi.elevations),ei._displayProfile(ei._data),ei._waitingContainer.className="GPwaitingContainer GPwaitingContainerHidden gpf-waiting gpf-waiting--hidden",ei._waiting=!1,ei._measureDraw.setActive(!0)),ii&&ei.options.elevationOptions.onSuccess.call(ei,ei.getData())},ni=function(oi){ei._panelContainer.style.display="none",logger$b.error(oi.message),ei._waitingContainer.className="GPwaitingContainer GPwaitingContainerHidden gpf-waiting gpf-waiting--hidden",ei._waiting=!1,ei._measureDraw.setActive(!0),ti&&ei.options.elevationOptions.onFailure.call(ei,oi)};Helper.mergeParams(n,{onSuccess:ri,onFailure:ni});var si=n.sampling||200,ai=Math.max(50,Math.floor(this._getLength())/5);ai>200?si=200:si=Math.floor(ai),si>0&&Helper.mergeParams(n,{sampling:si}),Helper.mergeParams(n,{positions:e}),logger$b.trace("options du service",n),this._waitingContainer.className="GPwaitingContainer GPwaitingContainerVisible gpf-waiting gpf-waiting--visible",Gp.Services.getAltitude(n)}_computeElevationMeasure(e){logger$b.trace("ElevationPath::_computeElevationMeasure",e);var n=e,ei="m",ti=this._getSketchCoords();if(ti){n[0].dist=0,n[0].slope=0,n[0].oldlat=n[0].lat,n[0].oldlon=n[0].lon,n[0].lat=Math.round(n[0].lat*1e5)/1e5,n[0].lon=Math.round(n[0].lon*1e5)/1e5;for(var ii=0,ri=0,ni=0,si=0,ai=0,oi=0,li=[],ci=1;ci<n.length;ci++){var ui=[n[ci].lon,n[ci].lat],di=getDistance(ui,[n[ci-1].oldlon,n[ci-1].oldlat]),fi=di+ai,hi=n[ci].z,pi=n[ci-1].z;hi<0&&(hi=0),pi<0&&(pi=0);var gi=hi-pi;gi<0?(ii+=di,si+=gi):gi>0&&(ri+=di,ni+=gi),ai=fi,n[ci].dist=fi,oi+=gi?Math.abs(Math.round(gi/di*100)):0,n[ci].slope=gi?Math.abs(Math.round(gi/di*100)):0;var vi=n[ci].slope;vi>15&&vi<30?n[ci].color="#005b4c":vi>30&&vi<45?n[ci].color="#00362d":vi>45?n[ci].color="#00120f":n[ci].color="#00B798",n[ci].oldlat=n[ci].lat,n[ci].oldlon=n[ci].lon,n[ci].lat=Math.round(n[ci].lat*1e5)/1e5,n[ci].lon=Math.round(n[ci].lon*1e5)/1e5}logger$b.trace("List Distances",li);for(var yi=n[0].z,_i=n[0].z,Ai=n[0].slope,Ei=0;Ei<n.length;Ei++){var Si=n[Ei];Si.z<-100&&(Si.z=0),Si.z>_i&&(_i=Si.z),Si.z<yi&&(yi=Si.z),Si.slope>Ai&&(Ai=Si.slope)}return{greaterSlope:Ai,meanSlope:Math.round(oi/n.length),distancePlus:ri,distanceMinus:ii,ascendingElevation:ni,descendingElevation:si,altMin:yi.toLocaleString(),altMax:_i.toLocaleString(),distance:this._getLength(),unit:ei,points:n}}}_displayProfile(e){logger$b.trace("ElevationPath::_displayProfile",e),this._updateInfoContainer();var n=this.options.displayProfileOptions.target;n&&n.appendChild(this._panelContainer),n=this._profileContainer;var ei=this,ti=this.options.displayProfileOptions.apply;ti.call(this,e,n,ei);var ii=this.options.displayProfileOptions,ri=document.getElementById("GPelevationPathPanelInfo-"+this._uid);ri&&(ii.totalDistance||ii.greaterSlope||ii.meanSlope||ii.ascendingElevation||ii.descendingElevation)&&(ri.style.display="block"),this.dispatchEvent(this.COMPUTE_ELEVATION_EVENT)}_updateInfoContainer(){logger$b.trace("ElevationPath::_updateInfoContainer");var e=this.options.displayProfileOptions.totalDistance,n=this.options.displayProfileOptions.meanSlope,ei=this.options.displayProfileOptions.greaterSlope,ti=this.options.displayProfileOptions.ascendingElevation,ii=this.options.displayProfileOptions.descendingElevation,ri=this._infoContainer;if(ri.childElementCount)for(;ri.firstChild;)ri.removeChild(ri.firstChild);e&&this._addElevationPathInformationsItem("Distance totale",Math.round(this._data.distance).toLocaleString()+" m"),ti&&this._addElevationPathInformationsItem("Dnivel positif",this._data.ascendingElevation.toLocaleString()+" m"),ii&&this._addElevationPathInformationsItem("Dnivel ngatif",this._data.descendingElevation.toLocaleString()+" m"),n&&this._addElevationPathInformationsItem("Pente moyenne",this._data.meanSlope.toLocaleString()+" %"),ei&&this._addElevationPathInformationsItem("Plus forte pente",this._data.greaterSlope.toLocaleString()+" %")}_removeMeasure(){if(this._lastSketch=null,this._currentSketch=null,this._measureSource){this._marker&&(this._measureSource.removeFeature(this._marker),this._marker=null);for(var e=this._measureSource.getFeatures(),n=0;n<e.length;n++)this._measureSource.removeFeature(e[n])}}_removeProfile(){if(this._profile=null,this._profileContainer)for(;this._profileContainer.firstChild;)this._profileContainer.removeChild(this._profileContainer.firstChild)}onShowElevationPathClick(e){var n=this._pictoButton.ariaPressed;n==="true"&&this.onPanelOpen();var ei=this.getMap();Interactions.unset(ei,{current:"ElevationPath"}),n==="true"?(this._profile===null&&(this._panelContainer.style.display="none"),this._initMeasureInteraction(ei),this._addMeasureInteraction(ei)):(this._panelContainer.style.display="none",e&&e.target.dataset&&e.target.dataset.removeMeasure?e.target.dataset.removeMeasure==="true"?this._removeMeasure():(this._lastSketch=null,this._currentSketch=null):this._removeMeasure(),this._removeProfile(),e&&e.target.dataset&&e.target.dataset.removeLayer?this._removeMeasureInteraction(ei,e.target.dataset.removeLayer==="true"):this._removeMeasureInteraction(ei,!0)),this.collapsed=n!=="true",this.dispatchEvent("change:collapsed")}onOpenElevationPathInfoClick(){var e=this._infoContainer;e.className==="GPelementVisible gpf-visible"?(clearTimeout(this._timerHdlr),e.className="GPelementHidden gpf-hidden"):e.className="GPelevationPathInformationsContainerVisible",this._timerHdlr=setTimeout(function(){e.className="GPelementHidden gpf-hidden"},4e3)}};qr(Ss,"DEFAULT_STYLES",{MARKER:new Icon({src:Marker.lightOrange,anchor:[.5,1],snapToPixel:!0}),RESULTS:{imageRadius:5,imageFillColor:"rgba(128, 128, 128, 0.2)",imageStrokeColor:"rgba(0, 0, 0, 0.7)",imageStrokeWidth:2}});let ElevationPath=Ss;Object.assign(ElevationPath.prototype,ElevationPathDOM);Object.assign(ElevationPath.prototype,Widget);window.ol&&window.ol.control&&(window.ol.control.ElevationPath=ElevationPath);var logger$a=LoggerByDefault.getLogger("layerimport");const Qn=class Qn extends ControlExtended{constructor(e){if(e=e||{},super(e),this.CLASSNAME="LayerImport",!(this instanceof Qn))throw new TypeError("ERROR CLASS_CONSTRUCTOR");return this._initialize(e),this._container=this._initContainer(e),this.element?this.element.appendChild(this._container):this.element=this._container,this}setMap(e){if(e){var n=this;e.getLayers().on("remove",function(ei){ei.element.gpResultLayerId==="layerimport:MAPBOX"&&ei.element.gpEditorId&&n._mapBoxPanel&&n._importPanel&&(n.cleanMapBoxResults(ei.element.gpEditorId),n._mapBoxPanel.classList.replace("GPelementVisible","GPelementHidden"),n._mapBoxPanel.classList.replace("gpf-visible","gpf-hidden"))},n),this.draggable&&Draggable.dragElement(this._importPanel,this._importPanelHeader,e.getTargetElement()),this.collapsed||this._showImportButton.setAttribute("aria-pressed",!0)}super.setMap(e),this.options.position&&this.setPosition(this.options.position),this.options.gutter===!1&&this.getContainer().classList.add("gpf-button-no-gutter")}getCollapsed(){return this.collapsed}setCollapsed(e){if(e===void 0){logger$a.error("[ERROR] LayerImport:setCollapsed - missing collapsed parameter");return}e&&this.collapsed||!e&&!this.collapsed||(e?this._panelCloseButton.click():this._showImportButton.click(),this.collapsed=e)}getStaticImportContent(){return this.contentStatic}getServiceImportContent(){return this.contentService}getName(){return this._name}getContainer(){return this._container}_initialize(e){if(this._checkInputOptions(e),this.options={collapsed:!0,draggable:!1,layerTypes:["KML","GPX","GeoJSON","WMS","WMTS","MAPBOX"],webServicesOptions:{},vectorStyleOptions:{KML:{extractStyles:!0,showPointNames:!0,defaultStyle:{}},GPX:{defaultStyle:{}},GeoJSON:{defaultStyle:{}},MapBox:{defaultStyle:{},editor:{}}}},e.vectorStyleOptions&&e.vectorStyleOptions.KML&&e.vectorStyleOptions.KML.extractStyles&&(this.options.vectorStyleOptions.KML.extractStyles=e.vectorStyleOptions.KML.extractStyles),e.vectorStyleOptions&&e.vectorStyleOptions.KML&&e.vectorStyleOptions.KML.showPointNames&&(this.options.vectorStyleOptions.KML.showPointNames=e.vectorStyleOptions.KML.showPointNames),e.vectorStyleOptions&&e.vectorStyleOptions.KML&&e.vectorStyleOptions.KML.defaultStyle?this.options.vectorStyleOptions.KML.defaultStyle=e.vectorStyleOptions.KML.defaultStyle:this.options.vectorStyleOptions.KML.defaultStyle=new Style$1({image:Qn.DefaultStyles.image,stroke:Qn.DefaultStyles.stroke,fill:Qn.DefaultStyles.fill,text:Qn.DefaultStyles.text}),e.vectorStyleOptions&&e.vectorStyleOptions.GPX&&e.vectorStyleOptions.GPX.defaultStyle?this.options.vectorStyleOptions.GPX.defaultStyle=e.vectorStyleOptions.GPX.defaultStyle:this.options.vectorStyleOptions.GPX.defaultStyle=new Style$1({image:Qn.DefaultStyles.image,stroke:Qn.DefaultStyles.stroke,fill:Qn.DefaultStyles.fill,text:Qn.DefaultStyles.text}),e.vectorStyleOptions&&e.vectorStyleOptions.GeoJSON&&e.vectorStyleOptions.GeoJSON.defaultStyle?this.options.vectorStyleOptions.GeoJSON.defaultStyle=e.vectorStyleOptions.GeoJSON.defaultStyle:this.options.vectorStyleOptions.GeoJSON.defaultStyle=new Style$1({image:Qn.DefaultStyles.image,stroke:Qn.DefaultStyles.stroke,fill:Qn.DefaultStyles.fill,text:Qn.DefaultStyles.text}),e.vectorStyleOptions&&e.vectorStyleOptions.MapBox&&e.vectorStyleOptions.MapBox.defaultStyle?this.options.vectorStyleOptions.MapBox.defaultStyle=e.vectorStyleOptions.MapBox.defaultStyle:this.options.vectorStyleOptions.MapBox.defaultStyle=new Style$1({image:Qn.DefaultStyles.image,stroke:Qn.DefaultStyles.stroke,fill:Qn.DefaultStyles.fill,text:Qn.DefaultStyles.text}),e.vectorStyleOptions&&e.vectorStyleOptions.MapBox&&e.vectorStyleOptions.MapBox.editor?this.options.vectorStyleOptions.MapBox.editor=e.vectorStyleOptions.MapBox.editor:this.options.vectorStyleOptions.MapBox.editor={title:!0,collapse:!1,themes:!1,layers:!0,style:!0,filter:!1,legend:!0,group:!1},e.vectorStyleOptions&&e.vectorStyleOptions.MapBox&&e.vectorStyleOptions.MapBox.hasOwnProperty("display")?this.options.vectorStyleOptions.MapBox.display=e.vectorStyleOptions.MapBox.display:this.options.vectorStyleOptions.MapBox.display=!0,Array.isArray(e.layerTypes)){for(var n=[],ei=0;ei<e.layerTypes.length;ei++)n.push(e.layerTypes[ei]);this.options.layerTypes=n}Helper.mergeParams(this.options,e),this.collapsed=this.options.collapsed,this.draggable=this.options.draggable,this._uid=this.options.id||SelectorID.generate(),this._waiting=!1,this._timer=null,this._initImportTypes(),this._initDefaultStyles(),this._showImportButton=null,this._importPanel=null,this._panelCloseButton=null,this._importPanelHeader=null,this._importPanelTitle=null,this._importPanelReturnPicto=null,this._formContainer=null,this._staticLocalImportInput=null,this._staticUrlImportInput=null,this._serviceUrlImportInput=null,this._getCapPanel=null,this._getCapPanelHeader=null,this._getCapResultsListContainer=null,this._mapBoxPanel=null,this._mapBoxPanelHeader=null,this._mapBoxResultsListContainer=null,this._waitingContainer=null,this._loadingContainer=null,this._hasGetCapResults=!1,this._getCapRequestUrl=null,this._getCapResponseWMS=null,this._getCapResponseWMSLayers=[],this._getCapResponseWMTS=null,this._getCapResponseWMTSLayers=[],this._hasMapBoxResults=!1,this.contentStatic=null,this._url=null,this._file=null,this._name=null}_checkInputOptions(e){if(e.layerTypes){var n=e.layerTypes;if(!Array.isArray(n))logger$a.warn(`[ol.control.LayerImport] 'options.layerTypes' parameter should be an array. Set default values ["KML", "GPX", "GeoJSON", "WMS", "WMTS"]`),e.layerTypes=["KML","GPX","GeoJSON","WMS","WMTS","MAPBOX"];else{for(var ei=["KML","GPX","GEOJSON","WMS","WMTS","WFS","MAPBOX"],ti=[],ii=0;ii<n.length;ii++)typeof n[ii]!="string"?(ti.push(ii),logger$a.warn("[ol.control.LayerImport] 'options.layerTypes' elements should be of type string ("+n[ii]+")")):(n[ii]=n[ii].toUpperCase(),ei.indexOf(n[ii])===-1&&(ti.push(ii),logger$a.log("[ol.control.LayerImport] options.layerTypes : "+n[ii]+" is not a supported type")),n[ii]==="GEOJSON"&&(n[ii]="GeoJSON"),n[ii]==="MAPBOX"&&(n[ii]="MAPBOX"));if(ti.length!==0)for(var ri=ti.length-1;ri>=0;ri--)n.splice(ti[ri],1)}}}_initDefaultStyles(){var e=this.options.vectorStyleOptions.KML.defaultStyle;this._defaultKMLStyle=new Style$1({image:e.image,stroke:e.stroke,fill:e.fill,text:e.text});var n=this.options.vectorStyleOptions.GPX.defaultStyle;this._defaultGPXStyle=new Style$1({image:n.image,stroke:n.stroke,fill:n.fill,text:n.text});var ei=this.options.vectorStyleOptions.GeoJSON.defaultStyle;this._defaultGeoJSONStyle=new Style$1({image:ei.image,stroke:ei.stroke,fill:ei.fill,text:ei.text});var ti=this.options.vectorStyleOptions.MapBox.defaultStyle;this._defaultMapBoxStyle=new Style$1({image:ti.image,stroke:ti.stroke,fill:ti.fill,text:ti.text})}_initImportTypes(){this._currentImportType=this.options.layerTypes[0]||"KML",this._currentImportType==="KML"||this._currentImportType==="GPX"||this._currentImportType==="GeoJSON"||this._currentImportType==="MAPBOX"?this._isCurrentImportTypeStatic=!0:(this._currentImportType==="WMS"||this._currentImportType==="WMTS"||this._currentImportType==="WFS")&&(this._isCurrentImportTypeStatic=!1),this._currentStaticImportType="local"}_initContainer(){var e=this._createMainContainerElement(),n=this._showImportButton=this._createShowImportPictoElement();e.appendChild(n);var ei=this._importPanel=this._createImportPanelElement(),ti=this._createImportPanelDivElement();ei.appendChild(ti);var ii=this._importPanelHeader=this._createImportPanelHeaderElement(),ri=this._importPanelReturnPicto=this._createImportPanelReturnPictoElement();ii.appendChild(ri);var ni=this._importPanelTitle=this._createImportPanelTitleElement();ii.appendChild(ni);var si=this._panelCloseButton=this._createImportPanelCloseElement();ii.appendChild(si),ti.appendChild(ii);var ai=this._formContainer=this._initInputFormElement();ti.appendChild(ai);var oi=this._getCapPanel=this._createImportGetCapPanelElement(),li=this._getCapResultsListContainer=this._createImportGetCapResultsContainer();oi.appendChild(li),ti.appendChild(oi);var ci=this._mapBoxPanel=this._createImportMapBoxPanelElement(),ui=this._mapBoxResultsListContainer=this._createImportMapBoxResultsContainer();ci.appendChild(ui);var di=this._loadingContainer=this._createLoadingElement();ci.appendChild(di),ti.appendChild(ci);var fi=this._waitingContainer=this._createImportWaitingElement();return ti.appendChild(fi),e.appendChild(ei),e}_initInputFormElement(){var e=this._createImportPanelFormElement(),n=this._createImportTypeLineElement(this.options.layerTypes);e.appendChild(n);var ei=this._createImportStaticParamsContainer(this.options.layerTypes[0]),ti=this._createStaticNameLabel();ei.appendChild(ti);var ii=this._createStaticModeChoiceDiv(),ri=this._createStaticLocalChoiceDiv();ii.appendChild(ri);var ni=this._createStaticUrlChoiceDiv();ii.appendChild(ni),ei.appendChild(ii);var si=this._createStaticLocalInputDiv();si.appendChild(this._createStaticLocalInputLabel()),this._staticLocalImportInput=this._createStaticLocalInput(),si.appendChild(this._staticLocalImportInput),ei.appendChild(si);var ai=this._createStaticUrlInputDiv();ai.appendChild(this._createStaticUrlInputLabel()),this._staticUrlImportInput=this._createStaticUrlInput(),ai.appendChild(this._staticUrlImportInput),ei.appendChild(ai),e.appendChild(ei);var oi=this._createServiceParamsContainer(this.options.layerTypes[0]),li=this._createServiceUrlDiv();li.appendChild(this._createServiceUrlInputLabel()),this._serviceUrlImportInput=this._createServiceUrlInput(),li.appendChild(this._serviceUrlImportInput),oi.appendChild(li),e.appendChild(oi);var ci=this._createImportSubmitFormElement();return e.appendChild(ci),e}_onShowImportClick(e){var n=this._showImportButton.ariaPressed;n==="true"&&this.onPanelOpen();var ei=this.getMap();Interactions.unset(ei),this.collapsed=n!=="true",this.dispatchEvent("change:collapsed"),this.options.position&&!this.collapsed&&this.updatePosition(this.options.position),this._hasMapBoxResults?(this._mapBoxPanel.classList.replace("GPelementHidden","GPelementVisible"),this._mapBoxPanel.classList.replace("gpf-hidden","gpf-visible"),this._hideFormContainer()):this._hasGetCapResults?(this._getCapPanel.classList.replace("GPelementHidden","GPelementVisible"),this._getCapPanel.classList.replace("gpf-hidden","gpf-visible"),this._hideFormContainer()):(this._getCapPanel.classList.replace("GPelementVisible","GPelementHidden"),this._getCapPanel.classList.replace("gpf-visible","gpf-hidden"),this._mapBoxPanel.classList.replace("GPelementVisible","GPelementHidden"),this._mapBoxPanel.classList.replace("gpf-visible","gpf-hidden"),this._displayFormContainer())}_onImportTypeChange(e){this._currentImportType=e.target.value,this._currentImportType==="KML"||this._currentImportType==="GPX"||this._currentImportType==="GeoJSON"||this._currentImportType==="MAPBOX"?this._isCurrentImportTypeStatic=!0:(this._currentImportType==="WMS"||this._currentImportType==="WMTS"||this._currentImportType==="WFS")&&(this._isCurrentImportTypeStatic=!1)}_onStaticImportTypeChange(e){this._currentStaticImportType=e.target.value}_onGetCapPanelClose(){(this._currentImportType==="WMS"||this._currentImportType==="WMTS"||this._currentImportType==="WFS")&&this.cleanGetCapResultsList()}_onMapBoxPanelClose(){this.cleanMapBoxResultsList(),this._loadingContainer.className="",this._importPanelReturnPicto.classList.replace("GPelementVisible","GPelementHidden"),this._importPanelReturnPicto.classList.replace("gpf-visible","gpf-hidden"),this._mapBoxPanel.classList.replace("GPelementVisible","GPelementHidden"),this._mapBoxPanel.classList.replace("gpf-visible","gpf-hidden")}_onReturnPictoClick(e){this._onGetCapPanelClose(),this._onMapBoxPanelClose(),this._loadingContainer.className=""}_onImportSubmit(){logger$a.log("import d'une couche de type : "+this._currentImportType),this.contentStatic=null,this.contentService=null,this._isCurrentImportTypeStatic?(this.setCollapsed(!0),this._importStaticLayer()):this._importServiceLayers()}_importStaticLayer(){var e,n=document.getElementById(this._addUID("GPimportName"));n&&(e=n.value||"",logger$a.log("import layer name : "+e)),this._currentStaticImportType==="local"?(logger$a.log("import static layer from local file"),this._importStaticLayerFromLocalFile(e)):this._currentStaticImportType==="url"&&(logger$a.log("import static layer from url"),this._importStaticLayerFromUrl(e))}_importStaticLayerFromUrl(e){var n=this._staticUrlImportInput.value;if(logger$a.log("url : ",n),n.length===0){logger$a.error("[ol.control.LayerImport] url parameter is mandatory");return}n.trim&&(n=n.trim()),this._url=n,e||(e=this._url.substring(this._url.lastIndexOf("/")+1,this._url.lastIndexOf("."))),this._name=e,this.options.webServicesOptions&&this.options.webServicesOptions.proxyUrl&&(n=ProxyUtils.proxifyUrl(n,this.options.webServicesOptions));var ei=this;Gp.Protocols.XHR.call({url:n,method:"GET",timeOut:15e3,onResponse:function(ti){ei._hideWaitingContainer(),ei._addFeaturesFromImportStaticLayer(ti,e)},onFailure:function(ti){ei._hideWaitingContainer(),logger$a.error("[ol.control.LayerImport] KML/GPX/GeoJSON/MapBox request failed : ",ti)}})}_importStaticLayerFromLocalFile(e){var n=this._staticLocalImportInput.files[0];if(!n){logger$a.warn("[ol.control.LayerImport] missing file");return}this._file=n,e||(e=this._file.name.substring(this._file.name.lastIndexOf("/")+1,this._file.name.lastIndexOf("."))),this._name=e;var ei=new FileReader,ti=this;ei.onerror=ii=>{ti._hideWaitingContainer(),logger$a.error("error fileReader : ",ii)},ei.onprogress=()=>{logger$a.log("onprogress")},ei.onloadstart=()=>{ti._displayWaitingContainer(),logger$a.log("onloadstart")},ei.onabort=()=>{ti._hideWaitingContainer(),logger$a.log("onabort")},ei.onloadend=ii=>{logger$a.log("onloadend : ",ii)},ei.onload=ii=>{logger$a.log("fileReader onload - file content : ",ii.target.result),ti._hideWaitingContainer(),ti._addFeaturesFromImportStaticLayer(ii.target.result,e)},ei.readAsText(n)}_addFeaturesFromImportStaticLayer(e,n){var ei=this.getMap();if(!(!ei||!e)){var ti=null,ii=null,ri=null,ni=null;if(this.contentStatic=e,this._currentImportType==="MAPBOX"){this._hasMapBoxResults=!0;var si=this,ai=JSON.parse(e);ei.set("mapbox-style",ai);var oi=ai.sources,li=Object.keys(oi).length>1?1:0;for(var ci in oi)if(oi.hasOwnProperty(ci)){var ui="",di="",fi=null,hi=null,pi=null,gi=null;if(ai.metadata){for(var vi in ai.metadata)if(ai.metadata.hasOwnProperty(vi)){var yi=vi.split(":");if(yi[0]==="geoportail"){var _i=yi[1];if(_i==="title"){ui=ai.metadata[vi];continue}if(_i==="description"){di=ai.metadata[vi];continue}if(_i==="quicklookUrl"){fi=ai.metadata[vi];continue}if(_i==="legends"){hi=ai.metadata[vi];continue}if(_i==="metadata"){pi=ai.metadata[vi];continue}if(_i==="originators"){gi=ai.metadata[vi];continue}}}}ui||(ui="Couche MapBox"),di||(di="Couche MapBox"),ui=li?ui+"("+ci+")":ui;var Ai=oi[ci],Ei=Ai.type;if(Ei==="vector"){var Si=Ai.url,wi=Ai.tiles,Oi=ai.sprite;if(Si&&Si.indexOf("mapbox://")===0){var Ii=this._url;if(Ii){if(wi=["a","b","c","d"].map(function(Gi){var gr=Si.replace("mapbox://",""),Br=Ii.split("?")[1];return"https://"+Gi+".tiles.mapbox.com/v4/"+gr+"/{z}/{x}/{y}.vector.pbf?"+Br}),Oi.indexOf("mapbox://")===0){var Li=Ii.split("?");ai.sprite=Li[0]+"/sprite?"+Li[1]}}else logger$a.warn("Not yet implemented, can't use the local import scheme with a 'mapbox://' in the file.!")}if(wi)ri=new MVT({featureClass:Feature}),ii=new VectorTile({attributions:Ai.attribution,format:ri,urls:wi}),ii._title=ui,ii._description=di,ii._quicklookUrl=fi,ii._metadata=pi,ii._legends=hi,ii._originators=gi,ii.on("tileloadstart",function(Gi){si._loadingContainer.className="GPmapLoadingVisible"}),ii.on("tileloadend",function(Gi){si._loadingContainer.className=""}),ii.on("tileloaderror",function(Gi){si._loadingContainer.className=""}),ti=new VectorTileLayer({source:ii,visible:!1,declutter:!0}),ti.id=ci,ti.gpResultLayerId="layerimport:"+this._currentImportType;else if(Si){ri=new MVT({featureClass:Feature}),ti=new VectorTileLayer({visible:!1,declutter:!0}),ti.id=ci,ti.gpResultLayerId="layerimport:"+this._currentImportType;var Di=new TileJSON({url:Si}),Ni=Di.on("change",function(){if(Di.getState()==="ready"){for(var Gi=Di.getTileJSON(),gr=Array.isArray(Gi.tiles)?Gi.tiles:[Gi.tiles],Br=0;Br<gr.length;Br++){var Nr=gr[Br];Nr.indexOf("http")!==0&&(gr[Br]=Si+Nr)}ii=new VectorTile({attributions:Di.getAttributions()||Gi.attribution,format:ri,urls:gr}),ii._title=ui,ii._description=di,ii._quicklookUrl=fi,ii._metadata=pi,ii._legends=hi,ii._originators=gi,ii.on("tileloadstart",function(mr){si._loadingContainer.className="GPmapLoadingVisible"}),ii.on("tileloadend",function(mr){si._loadingContainer.className=""}),ti.setSource(ii),ti.set("mapbox-extension",Gi.vector_layers),unByKey(Ni)}})}}else if(Ei==="geojson"){var $i=Ai.data;ri=new GeoJSON,ii=new VectorTile({attributions:Ai.attribution,format:ri,url:$i}),ii._title=ui,ii._description=di,ii._quicklookUrl=fi,ii._metadata=pi,ii._legends=hi,ii._originators=gi,ti=new VectorTileLayer({source:ii,visible:!1,declutter:!0}),ti.id=ci,ti.gpResultLayerId="layerimport:"+this._currentImportType}else{logger$a.warn("Type MapBox format unknown !");return}var Ki=JSON.parse(JSON.stringify(ai));if(li){for(var er=Ki.layers,Vi=0;Vi<er.length;Vi++){var nr=er[Vi];if(nr.source!==ci){er.splice(Vi,1);continue}}for(var zi in Ki.sources)Ki.sources.hasOwnProperty(zi)&&zi!==ci&&delete Ki.sources[zi]}var Wi={id:ci,styles:Ki,layer:ti,options:{title:n||ui,description:di,quicklookUrl:fi,metadata:pi,legends:hi,originators:gi}};(function(Gi){var gr=()=>{applyStyle(Gi.layer,Gi.styles,{source:Gi.id}).then(function(){var mr=!0;Gi.layer.setVisible(mr);var Mr=1;Gi.layer.setOpacity(Mr)}).then(function(){var mr=ei.getView().getProjection().getCode();ei.getView()&&Gi.styles.center&&Gi.styles.center.length&&ei.getView().setCenter(transform$1(Gi.styles.center,"EPSG:4326",mr)),ei.getView()&&(Gi.styles.zoom||Gi.styles.zoom===0)&&ei.getView().setZoom(Gi.styles.zoom);var Mr=Gi.layer.getSource();if(ei.getView()&&ei.getSize()){var Er=null;Mr&&Mr.getExtent?Er=Mr.getExtent():Er=Mr.getTileGrid().getExtent(),Er&&Er[0]!==1/0&&ei.getView().fit(Er,ei.getSize())}}).then(function(){si._hideFormContainer(),si._importPanelHeader.classList.replace("GPelementVisible","GPelementHidden"),si._importPanelHeader.classList.replace("gpf-visible","gpf-hidden"),si._importPanelTitle.innerHTML="Edition des styles";var mr=new Editor({target:si._mapBoxResultsListContainer,style:JSON.parse(JSON.stringify(Gi.styles)),scope:this,events:{"editor:onloaded":si._onLoadedMapBox,"editor:layer:onclickvisibility":si._onChangeVisibilitySourceMapBox,"editor:style:scale:onchangemin":si._onChangeScaleMinSourceMapBox,"editor:style:scale:onchangemax":si._onChangeScaleMaxSourceMapBox,"editor:legend:onchangevalue":si._onChangeLegendValueSourceMapBox,"editor:legend:onclickedition":si._onDisplayLayerSourceMapBox},tools:si.options.vectorStyleOptions.MapBox.editor});return mr.setContext("map",ei),mr.setContext("layer",Gi.layer),mr.createElement().then(function(){if(mr.getLayers().length===0)throw new Error("Il n'existe pas de styles pour la source demande !?")}).then(function(){si.options.vectorStyleOptions.MapBox.display&&(si._importPanelHeader.classList.replace("GPelementHidden","GPelementVisible"),si._importPanelHeader.classList.replace("gpf-hidden","gpf-visible"),si._mapBoxPanel.classList.replace("GPelementHidden","GPelementVisible"),si._mapBoxPanel.classList.replace("gpf-hidden","gpf-visible"),si._importPanelReturnPicto.classList.replace("GPelementHidden","GPelementVisible"),si._importPanelReturnPicto.classList.replace("gpf-hidden","gpf-visible"))}).then(function(){var Mr=si._mapBoxResultsListContainer.getElementsByClassName("GPEditorMapBoxLayerTitleLabel");for(let Er=0;Er<Mr.length;Er++){const Fr=Mr[Er];Fr.textContent==="bckgrd"&&(Fr.textContent="Couleur de remplissage")}}).then(function(){Gi.layer.set("mapbox-editor",mr.getID()),setTimeout(function(){ei.dispatchEvent({id:mr.getID(),type:"editor:loaded",style:Gi.styles,layer:Gi.layer})},100)}).catch(function(Mr){throw Mr})}).then(function(){ei.dispatchEvent({id:Gi.id,type:"render:success",style:Gi.styles})}).catch(function(mr){logger$a.error(mr),ei.dispatchEvent({id:Gi.id,type:"render:failure",error:mr})})};logger$a.warn(Gi.layer);var Br=ei.get("mapbox-styles")||{},Nr=Gi.id;Br[Nr]=Gi.styles,ei.set("mapbox-styles",Br),Gi.layer.set("mapbox-styles",Gi.styles),ei.addLayer(Gi.layer),si.dispatchEvent({type:"layerimport:mapbox:added",name:n,data:e,layer:Gi.layer,format:si._currentImportType.toLowerCase()||"mapbox"}),Gi.layer.getSource()?gr():Gi.layer.once("change:source",gr),ei.getControls().forEach(mr=>{mr instanceof LayerSwitcher&&mr.addLayer(Gi.layer,Gi.options)})})(Wi)}}else{this._currentImportType==="KML"?(ni=this.options.vectorStyleOptions.KML.defaultStyle,ri=new KML({showPointNames:this.options.vectorStyleOptions.KML.showPointNames,extractStyles:this.options.vectorStyleOptions.KML.extractStyles,defaultStyle:[ni]})):this._currentImportType==="GPX"?(ni=this.options.vectorStyleOptions.GPX.defaultStyle,ri=new GPX({defaultStyle:ni})):this._currentImportType==="GeoJSON"&&(ni=this.options.vectorStyleOptions.GeoJSON.defaultStyle,ri=new GeoJSON({defaultStyle:ni}));var Ti=ri.readProjection(e),ki=this._getMapProjectionCode(),xi=null;xi=ri.readFeatures(e,{dataProjection:Ti,featureProjection:ki}),logger$a.log("loaded features : ",xi),ii=new VectorSource({features:new Collection}),ii.addFeatures(xi),logger$a.trace(ii),ii._title=ii._description=n,ti=new VectorLayer({source:ii,style:ni}),ti.gpResultLayerId="layerimport:"+this._currentImportType;var Mi=ri.readRootExtensions("geoportail:compute");if(Mi&&Object.keys(Mi).length!==0){var Ui={route:{class:Route,name:"itineraire"},isocurve:{class:Isocurve,name:"isocurve"},elevationpath:{class:ElevationPath,name:"profil altimetrique"}},Yi=Mi.type,sr=Mi.transport;if(Yi){var cr=Ui[Yi].name,ir=sr?cr+" ("+sr+")":cr,Zi=Ui[Yi].class;if(Zi){ti.gpResultLayerId="layerimport:COMPUTE",ti.set("control",Yi),ti.set("name",cr),ti.set("graph",sr),ti.set("data",Mi),ti.set("title",ir);var rr=new GeoJSON({defaultStyle:ni}),ar=rr.writeFeatures(xi,{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"});ti.set("geojson",ar),this.getMap().getControls().forEach(Gi=>{Gi instanceof Zi&&(Gi.setData(Mi),Gi.setLayer(ti),Gi.init())})}}}if(ei.addLayer(ti),ei.getView()&&ei.getSize()&&ii.getExtent){var pr=ii.getExtent();pr&&pr[0]!==1/0&&ei.getView().fit(pr,ei.getSize())}this.dispatchEvent({type:"layerimport:vector:added",name:n,data:e,layer:ti,format:this._currentImportType.toLowerCase()})}}}_addFeaturesFromImportStaticLayerUrl(e,n){var ei=this.getMap();if(!(!ei||!e)){var ti,ii,ri;if(this._currentImportType==="MAPBOX"?logger$a.trace("Not yet implemented !"):(this._currentImportType==="KML"?ri=new KML({showPointNames:!0,extractStyles:this.options.vectorStyleOptions.KML.extractStyles,defaultStyle:[this.options.vectorStyleOptions.KML.defaultStyle]}):this._currentImportType==="GPX"?ri=new GPX({defaultStyle:this.options.vectorStyleOptions.GPX.defaultStyle}):this._currentImportType==="GeoJSON"&&(ri=new GeoJSON({defaultStyle:this.options.vectorStyleOptions.GeoJSON.defaultStyle})),ti=new VectorSource({url:e,format:ri}),this._currentImportType==="GPX"&&ti.forEachFeature(function(si){si.getStyle()==null&&(logger$a.log("[ol.control.LayerImport] set default style for GPX feature"),si.setStyle(this.options.vectorStyleOptions.GPX.defaultStyle))}),this._currentImportType==="GeoJSON"&&ti.forEachFeature(function(si){si.getStyle()==null&&(logger$a.log("[ol.control.LayerImport] set default style for GeoJSON feature"),si.setStyle(this.options.vectorStyleOptions.GeoJSON.defaultStyle))}),ti._title=ti._description=n,ii=new VectorLayer({source:ti})),ii.gpResultLayerId="layerimport:"+this._currentImportType,ei.addLayer(ii),ei.getView()&&ei.getSize()&&ti.getExtent){var ni=ti.getExtent();ni&&ni[0]!==1/0&&ei.getView().fit(ni,ei.getSize())}this.dispatchEvent({type:"layerimport:vector:added",name:n,url:e,layer:ii,format:this._currentImportType.toLowerCase()})}}_onLoadedMapBox(e){}_onChangeVisibilitySourceMapBox(e){var n=e.target.data.obj,ei=e.target.srcElement,ti=this.getContext("map"),ii=this.getContext("layer");if(ii.get("mapbox-source")===n.source&&ii.get("mapbox-editor")===e.target.editorID){for(var ri=ii.get("mapbox-styles"),ni,si=ri.layers,ai=0;ai<si.length;ai++)if(si[ai].id===n.id){var oi=si[ai].layout;oi?oi.visibility=ei.checked?"visible":"none":si[ai].layout={visibility:ei.checked?"visible":"none"},ni=si[ai];break}updateMapboxLayer(ti,ni),Promise.resolve()}}_onChangeScaleMinSourceMapBox(e){var n=e.target.data.obj,ei=e.target.srcElement,ti=this.getContext("map"),ii=this.getContext("layer");if(ii.get("mapbox-source")===n.source&&ii.get("mapbox-editor")===e.target.editorID){for(var ri=ii.get("mapbox-styles"),ni,si=ri.layers,ai=0;ai<si.length;ai++)if(si[ai].id===n.id){si[ai].minzoom=ei.value,ei.title=ei.value,ni=si[ai];break}updateMapboxLayer(ti,ni),Promise.resolve()}}_onChangeScaleMaxSourceMapBox(e){var n=e.target.data.obj,ei=e.target.srcElement,ti=this.getContext("map"),ii=this.getContext("layer");if(ii.get("mapbox-source")===n.source&&ii.get("mapbox-editor")===e.target.editorID){for(var ri=ii.get("mapbox-styles"),ni,si=ri.layers,ai=0;ai<si.length;ai++)if(si[ai].id===n.id){si[ai].maxzoom=ei.value,ei.title=ei.value,ni=si[ai];break}updateMapboxLayer(ti,ni),Promise.resolve()}}_onChangeLegendValueSourceMapBox(e){var n=e.target.data.obj,ei=e.target.srcElement,ti=this.getContext("map"),ii=this.getContext("layer");if(ii.get("mapbox-source")===n.source&&ii.get("mapbox-editor")===e.target.editorID){for(var ri=ii.get("mapbox-styles"),ni,si=ri.layers,ai=0;ai<si.length;ai++)if(si[ai].id===n.id){var oi=si[ai].paint;oi&&(oi[ei.dataset.id]=ei.value),ni=si[ai];break}updateMapboxLayer(ti,ni),Promise.resolve()}}_onDisplayLayerSourceMapBox(e){var n=e.target.data.obj,ei=this.getContext("layer");if(ei.get("mapbox-source")===n.source&&ei.get("mapbox-editor")===e.target.editorID){var ti=e.target.currentTarget.parentNode.id,ii=ti.substring(ti.indexOf("-")+1,ti.indexOf("_")),ri=this.getLayer(ii);ri.collapse()}}_importServiceLayers(){if(this._currentImportType==="WFS"){logger$a.warn("[ol.control.LayerImport] WFS layer import is not implemented yet");return}this.cleanGetCapResultsList();var e=this._getCapRequestUrl=this._serviceUrlImportInput.value;if(!e){logger$a.error("[ol.control.LayerImport] url parameter is mandatory");return}logger$a.log("url : ",e),e.trim&&(e=e.trim());var n=e.indexOf("?");n<0?e+="?SERVICE="+this._currentImportType+"&REQUEST=GetCapabilities":n===e.length-1&&(e+="SERVICE="+this._currentImportType+"&REQUEST=GetCapabilities"),this.options.webServicesOptions&&this.options.webServicesOptions.proxyUrl&&(e=ProxyUtils.proxifyUrl(e,this.options.webServicesOptions)),this._displayWaitingContainer();var ei=this;Gp.Protocols.XHR.call({url:e,method:"GET",timeOut:15e3,onResponse:function(ti){ei._hideWaitingContainer(),ei._displayGetCapResponseLayers(ti)},onFailure:function(ti){ei._hideWaitingContainer(),logger$a.error("[ol.control.LayerImport] getCapabilities request failed : ",ti)}})}_displayGetCapResponseLayers(e){var n,ei,ti={content:null,title:null},ii;if(this._getCapResponseWMSLayers=[],this.contentService=e,this._hideFormContainer(),this._getCapPanel.classList.replace("GPelementHidden","GPelementVisible"),this._getCapPanel.classList.replace("gpf-hidden","gpf-visible"),this._importPanelTitle.innerHTML="Couches accessibles",this._importPanelReturnPicto.classList.replace("GPelementHidden","GPelementVisible"),this._importPanelReturnPicto.classList.replace("gpf-hidden","gpf-visible"),this._hasGetCapResults=!0,this._currentImportType==="WMS"){n=new WMSCapabilities;var ri=this._getCapResponseWMS=n.read(e);if(logger$a.log("getCapabilities response : ",ri),ri&&ri.Capability&&ri.Capability.Layer){var ni=ri.Capability.Layer;if(Array.isArray(ni))for(var si=0;si<ni.length;si++)this._displayGetCapResponseWMSLayer(ni[si]);else this._displayGetCapResponseWMSLayer(ni)}}else if(this._currentImportType==="WMTS"){n=new WMTSCapabilities;var ai=this._getCapResponseWMTS=n.read(e);if(logger$a.log("getCapabilities response : ",ai),ai&&ai.Contents&&ai.Contents.Layer&&(ei=ai.Contents.Layer,Array.isArray(ei))){this._getCapResponseWMTSLayers=ei;for(var oi=0;oi<ei.length;oi++)if(ii=this._getWMTSLayerProjection(ei[oi],ai),ii&&typeof ii=="string")if(get$3(ii)||get$3(ii.toUpperCase()))ti={content:ei[oi].Title,title:ei[oi].Abstract||ei[oi].Title},this._getCapResultsListContainer&&this._addImportGetCapResultLayer(ti,oi,this._getCapResultsListContainer);else{logger$a.warn("[ol.control.LayerImport] wmts layer cannot be added to map : unknown projection",ei[oi]);continue}}}}_displayGetCapResponseWMSLayer(e,n){if(!e){logger$a.warn("[ol.control.LayerImport] _displayGetCapResponseWMSLayer : getCapabilities layer object not found");return}logger$a.log("[ol.control.LayerImport] _displayGetCapResponseWMSLayer - layerObj : ",e);var ei=this._getMapProjectionCode(),ti,ii={content:null,title:null};if(n){var ri,ni,si=["CRS","Style"];for(ni=0;ni<si.length;ni++)if(ri=si[ni],Array.isArray(n[ri])&&n[ri].length!==0)if(Array.isArray(e[ri])&&e[ri].length!==0)for(var ai=0;ai<n[ri].length;ai++)e[ri].indexOf(n[ri][ai])===-1&&e[ri].push(n[ri][ai]);else e[ri]=n[ri];var oi=["BoundingBox","EX_GeographicBoundingBox","MaxScaleDenominator","MinScaleDenominator","Attribution","Dimension","queryable","cascaded","opaque","noSubsets","fixedWidth","fixedHeight"];for(ni=0;ni<oi.length;ni++)ri=oi[ni],n[ri]&&!e[ri]&&(e[ri]=n[ri])}else e._isRootLayer=!0,e._container=this._getCapResultsListContainer,e.Title||(e.Title="Liste des couches");if(e.Layer){if(Array.isArray(e.Layer)){var li=e?e._container:n._container,ci=e?e.Title:n.Title;e._container=this._addImportGetCapResultListRubrique(ci,li).lastChild;for(var ui=0;ui<e.Layer.length;ui++){for(var di=!1,fi=e._container.getElementsByClassName("GPimportGetCapRubriqueTitle"),hi=0;hi<fi.length;hi++)fi[hi].title===e.Title&&(di=!0,e.Layer[ui]._container=fi[hi].parentElement);di||(e.Layer[ui]._container=this._addImportGetCapResultRubrique(e.Title,e._container).lastChild),this._displayGetCapResponseWMSLayer(e.Layer[ui],e)}}}else{var pi=this._getCapResponseWMSLayers.length;if(ti=this._getWMSLayerProjection(e,ei),!ti)logger$a.warn("[ol.control.LayerImport] wms layer cannot be added to map : unknown projection",e);else{e._projection=ti,ii={content:e.Title,title:e.Abstract||e.Title};var gi=e._container;gi.localName==="ul"&&(gi=gi.lastChild),this._addImportGetCapResultLayer(ii,pi,gi),this._getCapResponseWMSLayers[pi]=e}}}_onGetCapResponseLayerClick(e){if(e.target&&e.target.id){var n=parseInt(e.target.id.substr(23),10);if(isNaN(n))return;var ei;this._currentImportType==="WMS"?(ei=this._getCapResponseWMSLayers[n],this._addGetCapWMSLayer(ei)):this._currentImportType==="WMTS"&&(ei=this._getCapResponseWMTSLayers[n],this._addGetCapWMTSLayer(ei))}}_addGetCapWMSLayer(e){var n=this.getMap();if(!n){logger$a.warn("[ol.control.LayerImport] _addGetCapWMSLayer error : map is not defined");return}if(!e){logger$a.warn("[ol.control.LayerImport] _addGetCapWMSLayer error : layerInfo is not defined");return}var ei=this._getMapProjectionCode(),ti={},ii=this._getWMSLayerGetMapUrl();if(ii)ti.url=ii;else{var ri=this._getCapRequestUrl.indexOf("?");ri!==-1?ti.url=this._getCapRequestUrl.substring(0,ri):ti.url=this._getCapRequestUrl}if(e.Url=ii||ti.url,ti.params={},e.Name)ti.params.LAYERS=e.Name;else{logger$a.warn("[ol.control.LayerImport] unable to add wms layer : mandatory layer 'name' parameter cannot be found",e);return}ti.params.SERVICE="WMS",this._getCapResponseWMS.version&&(ti.params.VERSION=this._getCapResponseWMS.version),e.Version=this._getCapResponseWMS.version;var ni=e._projection;if(ni)ni!==ei&&(ti.projection=ni);else{logger$a.warn("[ol.control.LayerImport] wms layer cannot be added to map : unknown projection");return}e.Projection=ni||ti.projection;var si;if(e.Style&&Array.isArray(e.Style)){var ai=e.Style[0];ti.params.STYLES=ai.Name,ai.LegendURL&&Array.isArray(ai.LegendURL)&&ai.LegendURL.length!==0&&(si=ai.LegendURL[0].OnlineResource)}var oi=new TileWMS(ti);this._getWMSLayerInfoForLayerSwitcher(e,si,oi);var li={};li.source=oi,this._getWMSLayerMinMaxResolution(e,ei,li),this._getWMSLayerExtent(e,ei,li);var ci=new TileLayer(li);if(ci.setExtent(li.extent),ci.gpResultLayerId="layerimport:WMS",e.queryable&&(ci.gpGFIparams={queryable:!0},this._getCapResponseWMS&&this._getCapResponseWMS.Capability&&this._getCapResponseWMS.Capability.Request&&this._getCapResponseWMS.Capability.Request.GetFeatureInfo&&this._getCapResponseWMS.Capability.Request.GetFeatureInfo.Format&&Array.isArray(this._getCapResponseWMS.Capability.Request.GetFeatureInfo.Format)&&(ci.gpGFIparams.formats=this._getCapResponseWMS.Capability.Request.GetFeatureInfo.Format)),n.addLayer(ci),n.getView()&&n.getSize()&&ci.getExtent){var ui=ci.getExtent();ui&&ui[0]!==1/0&&n.getView().fit(ui,n.getSize())}this.dispatchEvent({type:"layerimport:service:added",name:e.Name,data:e,layer:ci,format:"wms"})}_getWMSLayerGetMapUrl(){var e;if(this._getCapResponseWMS&&this._getCapResponseWMS.Capability&&this._getCapResponseWMS.Capability.Request&&this._getCapResponseWMS.Capability.Request.GetMap){var n=this._getCapResponseWMS.Capability.Request.GetMap;if(n.DCPType&&Array.isArray(n.DCPType)&&n.DCPType.length!==0){var ei=n.DCPType[0];ei&&ei.HTTP&&ei.HTTP.Get&&(e=ei.HTTP.Get.OnlineResource)}}return e}_getWMSLayerProjection(e,n){var ei;if(!e||typeof e!="object"){logger$a.warn("missing layer information (from getCapabilities)");return}var ti=e.CRS;if(Array.isArray(ti)){if(ti.includes(n))return ei=n,ei;var ii,ri;for(ri=0;ri<ti.length;ri++)if(ii=ti[ri],ii&&typeof ii=="string"&&(get$3(ii)||get$3(ii.toUpperCase())))return ei=ii,ei}return ei}_getWMSLayerMinMaxResolution(e,n,ei){var ti=get$3(n).getUnits();if(ti==="m")e.MinScaleDenominator&&(ei.minResolution=e.MinScaleDenominator*28e-5),e.MaxScaleDenominator&&(ei.maxResolution=e.MaxScaleDenominator*28e-5);else if(ti==="degrees"){var ii=.05039999999999999/(Math.PI*6378137);e.MinScaleDenominator&&(ei.minResolution=e.MinScaleDenominator*ii),e.MaxScaleDenominator&&(ei.maxResolution=e.MaxScaleDenominator*ii)}}_getWMSLayerExtent(e,n,ei){if(!e){logger$a.warn("[ol.control.LayerImport] _getWMSLayerExtent error : layerInfo is not defined");return}var ti=e.EX_GeographicBoundingBox,ii=e.BoundingBox;if(ti&&Array.isArray(ti))n==="EPSG:4326"?ei.extent=ti:ei.extent=transformExtent(ti,"EPSG:4326",n);else if(ii&&Array.isArray(ii)){for(var ri,ni,si=0;si<ii.length;si++)if(ri=ii[si].crs,ni=ii[si].extent,ri){if(ri===n){ei.extent=ni;break}else if(typeof ri=="string"){var ai=get$3(ri)?get$3(ri):get$3(ri.toUpperCase());if(ai){if(ai.getUnits()==="degrees"&&ri.toUpperCase().indexOf("EPSG")===0){var oi=[ni[1],ni[0],ni[3],ni[2]];ei.extent=transformExtent(oi,ai,n)}else ei.extent=transformExtent(ni,ai,n);break}}}}}_getWMSLayerInfoForLayerSwitcher(e,n,ei){if(e.Title?(ei._title=e.Title,ei._description=e.Abstract?e.Abstract:e.Title):(ei._title=e.Name,ei._description=e.Abstract?e.Abstract:e.Name),n&&(ei._legends=[{url:n}]),e.MetadataURL&&Array.isArray(e.MetadataURL)){ei._metadata=[];for(var ti=0;ti<e.MetadataURL.length;ti++){var ii=e.MetadataURL[ti].OnlineResource;ii&&ei._metadata.push({url:ii})}}if(e.Attribution){var ri=e.Attribution;ei._originators={},ri.OnlineResource&&(ei._originators.url=ri.OnlineResource),ri.Title&&(ei._originators.name=ei._originators.attribution=ri.Title),ri.LogoURL&&ri.LogoURL.OnlineResource&&(ei._originators.logo=ri.LogoURL.OnlineResource)}}_addGetCapWMTSLayer(e){if(!e||!e.Identifier){logger$a.warn("[ol.control.LayerImport] layer information not found in getCapabilities response for layer ");return}var n=this.getMap();if(n){var ei={};ei.layer=e.Identifier,this._getCapResponseWMTS.version&&(ei.version=this._getCapResponseWMTS.version),e.Version=ei.version;var ti=this._getWMTSLayerGetTileUrl();if(ti)ei.url=ti;else{var ii=this._getCapRequestUrl.indexOf("?");ii!==-1?ei.url=this._getCapRequestUrl.substring(0,ii):ei.url=this._getCapRequestUrl}e.Url=ti||ei.url;var ri=this._getTMSParams(e);ei.matrixSet=ri.tms,ei.projection=ri.projCode,ei.tileGrid=new WMTSTileGrid({resolutions:ri.resolutions,matrixIds:ri.matrixIds,origin:ri.origin}),e.MatrixIds=ri.matrixIds,e.Projection=ei.projection,e.Resolutions=ri.resolutions,e.Origin=ri.origin;var ni,si;if(e.Style&&Array.isArray(e.Style))for(var ai,oi=0;oi<e.Style.length&&(ai=e.Style[oi],ni=ai.Identifier,!ai.isDefault);oi++)ai.LegendURL&&Array.isArray(ai.LegendURL)&&ai.LegendURL.length!==0&&(si=ai.LegendURL[0].href);ni==null&&logger$a.warn("[ol.control.LayerImport] style information not found in getCapabilities response for layer "+e.Identifier),ei.style=ni;var li;e.Format&&Array.isArray(e.Format)&&(li=e.Format[0]),li==null&&logger$a.warn("[ol.control.LayerImport] format information not found in getCapabilities response for layer "+e.Identifier),ei.format=li;var ci=new WMTS$1(ei);e.Title?(ci._title=e.Title,ci._description=e.Abstract?e.Abstract:e.Title):(ci._title=e.Identifier,ci._description=e.Abstract?e.Abstract:e.Identifier),si&&(ci._legends=[{url:si}]);var ui={};ui.source=ci,ui.extent=this._getWMTSLayerExtent(e);var di;try{di=new TileLayer(ui),di.setExtent(ui.extent)}catch(hi){logger$a.warn("[ol.control.LayerImport] an error occured while trying to create ol.layer.Tile from getCapabilities information. error : ",hi);return}if(di.gpResultLayerId="layerimport:WMTS",n.addLayer(di),n.getView()&&n.getSize()&&di.getExtent){var fi=di.getExtent();fi&&fi[0]!==1/0&&n.getView().fit(fi,n.getSize())}this.dispatchEvent({type:"layerimport:service:added",name:e.Identifier,data:e,layer:di,format:"wmts"})}}_getWMTSLayerGetTileUrl(){var e;if(this._getCapResponseWMTS&&this._getCapResponseWMTS.OperationsMetadata&&this._getCapResponseWMTS.OperationsMetadata.GetTile){var n=this._getCapResponseWMTS.OperationsMetadata.GetTile;n.DCP&&n.DCP.HTTP&&n.DCP.HTTP.Get&&Array.isArray(n.DCP.HTTP.Get)&&n.DCP.HTTP.Get.length!==0&&(e=n.DCP.HTTP.Get[0].href)}return e}_getWMTSLayerProjection(e,n){var ei;if(!e||typeof e!="object"){logger$a.warn("missing layer information (from getCapabilities)");return}if(!n||typeof n!="object"){logger$a.warn("missing getCapabilities response");return}if(e.TileMatrixSetLink&&Array.isArray(e.TileMatrixSetLink)){var ti=e.TileMatrixSetLink[0].TileMatrixSet,ii;if(n.Contents&&Array.isArray(n.Contents.TileMatrixSet)){for(var ri=n.Contents.TileMatrixSet,ni=0;ni<ri.length;ni++)if(ri[ni].Identifier===ti&&ri[ni].TileMatrix){var si=ri[ni];ii=si.SupportedCRS,ii&&typeof ii=="string"&&(get$3(ii)||get$3(ii.toUpperCase()))&&(ei=ii);break}}}return ei}_getTMSParams(e){var n={},ei=[],ti=[],ii=[],ri,ni,si,ai=this.getMap();if(ai){if(e.TileMatrixSetLink&&Array.isArray(e.TileMatrixSetLink))if(ri=e.TileMatrixSetLink[0].TileMatrixSet,this._getCapResponseWMTS.Contents&&Array.isArray(this._getCapResponseWMTS.Contents.TileMatrixSet)){for(var oi=this._getCapResponseWMTS.Contents.TileMatrixSet,li=0;li<oi.length;li++)if(oi[li].Identifier===ri&&oi[li].TileMatrix){var ci=oi[li],ui,di,fi,hi,pi;if(ci.SupportedCRS&&(ni=ci.SupportedCRS,si=get$3(ni)),si&&si.getUnits&&(pi=si.getUnits()),Array.isArray(ci.TileMatrix))for(var gi=0;gi<ci.TileMatrix.length;gi++)ui=ci.TileMatrix[gi],ui.Identifier!=null&&(di=parseInt(ui.Identifier,10),ei.push(di)),fi=ui.ScaleDenominator,pi==="degrees"?hi=fi*28e-5*180/(Math.PI*6378137):hi=fi*28e-5,ti.push(hi),ii=ui.TopLeftCorner;ti.sort!==void 0&&ti.sort(function(vi,yi){return yi-vi}),ei.sort!==void 0&&ei.sort(function(vi,yi){return vi-yi})}}else logger$a.warn("[ol.control.LayerImport] TileMatrixSet data not found in getCapabilities response for layer "+e.Identifier);else return;return n.tms=ri,n.projCode=ni,n.matrixIds=ei,n.resolutions=ti,n.origin=ii,n}}_getWMTSLayerExtent(e){var n,ei=this._getMapProjectionCode();return e.WGS84BoundingBox&&Array.isArray(e.WGS84BoundingBox)&&(n=transformExtent(e.WGS84BoundingBox,"EPSG:4326",ei)),n}_getMapProjectionCode(){var e=this.getMap();if(!e||!e.getView||!e.getView().getProjection){logger$a.warn("unable to get layerimport's map");return}var n=e.getView().getProjection().getCode();return n}_displayWaitingContainer(){this._waitingContainer.className="GPwaitingContainer GPwaitingContainerVisible gpf-waiting gpf-waiting--visible",this._waiting=!0,this._timer&&(clearTimeout(this._timer),this._timer=null);var e=this;this._timer=setTimeout(function(){e._waiting===!0?e._hideWaitingContainer():e._timer&&clearTimeout(e._timer)},16e3)}_hideWaitingContainer(){this._waiting&&(this._waitingContainer.className="GPwaitingContainer GPwaitingContainerHidden gpf-waiting gpf-waiting--hidden",this._waiting=!1,clearTimeout(this._timer),this._timer=null)}_displayFormContainer(){this._formContainer.classList.replace("GPelementHidden","GPelementVisible"),this._formContainer.classList.replace("gpf-hidden","gpf-visible"),this._importPanelTitle.innerHTML="Import de donnes"}_hideFormContainer(){this._formContainer.classList.replace("GPelementVisible","GPelementHidden"),this._formContainer.classList.replace("gpf-visible","gpf-hidden")}cleanGetCapResultsList(){if(this._hasGetCapResults=!1,this._getCapRequestUrl=null,this._getCapResponseWMS=null,this._getCapResponseWMTS=null,this._getCapResponseWMSLayers=null,this._getCapResponseWMTSLayers=null,this._getCapResultsListContainer)for(;this._getCapResultsListContainer.firstChild;)this._getCapResultsListContainer.removeChild(this._getCapResultsListContainer.firstChild)}cleanMapBoxResultsList(){if(this._hasMapBoxResults=!1,this._mapBoxResultsListContainer)for(;this._mapBoxResultsListContainer.firstChild;)this._mapBoxResultsListContainer.removeChild(this._mapBoxResultsListContainer.firstChild)}cleanMapBoxResults(e){if(this._hasMapBoxResults=!1,this._mapBoxResultsListContainer){var n=this._mapBoxResultsListContainer.childNodes;for(let ei=0;ei<n.length;ei++){const ti=n[ei];ti.id==="GPEditorMapBoxContainer_ID_"+e&&ti.remove()}}}};qr(Qn,"DefaultStyles",{image:new Icon({src:Marker.lightOrange,anchor:[25.5,38],anchorOrigin:"top-left",anchorXUnits:"pixels",anchorYUnits:"pixels"}),stroke:new Stroke({color:"rgba(0,42,80,0.8)",width:4}),fill:new Fill({color:"rgba(0, 183, 152, 0.5)"}),text:new Text({font:"16px Sans",textAlign:"left",fill:new Fill({color:"rgba(255, 255, 255, 1)"}),stroke:new Stroke({color:"rgba(0, 0, 0, 1)",width:2})})});let LayerImport=Qn;Object.assign(LayerImport.prototype,LayerImportDOM);Object.assign(LayerImport.prototype,Widget);window.ol&&window.ol.control&&(window.ol.control.LayerImport=LayerImport);var logger$9=LoggerByDefault.getLogger("geoportalattribution");class GeoportalAttribution extends Attribution{constructor(e){if(e=e||{},e.collapsible=!0,e.collapsed=!0,super(e),!(this instanceof GeoportalAttribution))throw new TypeError("ERROR CLASS_CONSTRUCTOR");return this}setMap(e){if(e!=null){var n=e.getControls();n.forEach(ei=>{if(!(ei instanceof GeoportalAttribution)&&ei){for(var ti=ei.element.classList,ii=0;ii<ti.length;ii++)if(ti[ii]==="ol-attribution"){n.remove(ei);break}}}),this._updateAttributions(e),e.on("moveend",()=>{this._updateAttributions(e)}),e.getLayers().on("add",()=>{this._updateAttributions(e)}),e.getLayers().on("remove",()=>{this._updateAttributions(e)})}super.setMap(e)}_updateAttributions(e){for(var n={},ei=e.getView(),ti=ei.calculateExtent(e.getSize()),ii=ei.getProjection().getCode(),ri=transformExtent(ti,ii,"EPSG:4326"),ni=[ri[3],ri[0],ri[1],ri[2]],si=ei.getZoom(),ai=e.getLayers().getArray(),oi=0;oi<ai.length;oi++)if(ai[oi].getSource)this._updateLayerAttributions(ai[oi],n,ni,ii,si);else if(ai[oi].getLayers){var li=ai[oi].getLayers();li.forEach(ci=>{ci.getSource?this._updateLayerAttributions(ci,n,ni,ii,si):logger$9.log("cannot find layer source in layergroup ",ai[oi])})}}_updateLayerAttributions(e,n,ei,ti,ii){if(!e){logger$9.trace("layer is null !?");return}var ri=e.getSource();if(!ri){logger$9.trace("source is not yet loaded !");return}n||(n={});var ni=[],si=e.getVisible(),ai=ri._originators;if(typeof ai<"u"&&ri.setAttributions(),ai&&si){for(var oi=LayerUtils.getAttributions({extent:ei,crs:ti,zoom:ii,visibility:si,originators:ai}),li=0;li<oi.length;li++){var ci=oi[li];n.hasOwnProperty(ci)||(ni.push(ci),n[ci]=!0)}ni.length!==0&&(ri.setAttributions(ni),this.dispatchEvent({type:"attributions:update",attributions:ni}))}}}window.ol&&window.ol.control&&(window.ol.control.GeoportalAttribution=GeoportalAttribution);var MeasureLengthDOM={_addUID:function(_t){var e=this._uid?_t+"-"+this._uid:_t;return e},_createMainContainerElement:function(){var _t=document.createElement("div");return _t.id=this._addUID("GPmeasureLength"),_t.className="GPwidget gpf-widget gpf-widget-button",_t},_createShowMeasureLengthPictoElement:function(){var _t=this,e=document.createElement("button"),n=document.createElement("span");return e.appendChild(n),e.id=this._addUID("GPshowMeasureLengthPicto"),e.className="GPshowOpen GPshowAdvancedToolPicto gpf-btn gpf-btn--tertiary gpf-btn-icon gpf-btn-icon-length fr-btn fr-btn--tertiary",e.setAttribute("aria-label","Mesurer une distance"),e.setAttribute("tabindex","0"),e.setAttribute("aria-pressed",!1),e.setAttribute("type","button"),e.addEventListener?e.addEventListener("click",function(ei){var ti=ei.target.ariaPressed==="true";ei.target.setAttribute("aria-pressed",!ti),_t.onShowMeasureLengthClick(ei)}):e.attachEvent&&e.attachEvent("onclick",function(ei){var ti=ei.target.ariaPressed==="true";ei.target.setAttribute("aria-pressed",!ti),_t.onShowMeasureLengthClick(ei)}),e}},logger$8=LoggerByDefault.getLogger("measurelength");class MeasureLength extends ControlExtended{constructor(e){if(e=e||{},super(e),!(this instanceof MeasureLength))throw new TypeError("ERROR CLASS_CONSTRUCTOR");return this.CLASSNAME="MeasureLength",this._uid=e.id||SelectorID.generate(),this._pictoContainer=null,this._initialize(e),this._container=this._initializeContainer(),this.element?this.element.appendChild(this._container):this.element=this._container,this}setMap(e){logger$8.trace("setMap()");var n=this.CLASSNAME;e?!this.options.target&&!this.options.position&&MeasureToolBox.add(e,this):this.clean(),this.tools[n].push({instance:e?this:null,active:!1,map:e?e.getTargetElement():null});var ei=typeof window<"u"?window:typeof self<"u"?self:null;ei&&(ei.gpShareMeasures||(ei.gpShareMeasures={}),ei.gpShareMeasures[n]=this.tools[n]),super.setMap(e),this.options.position&&this.setPosition(this.options.position),this.options.gutter===!1&&this.getContainer().classList.add("gpf-button-no-gutter")}getContainer(){return this._container}_initialize(e){logger$8.trace("call MeasureLength::_initialize() : ",e),this.options={},this.options.geodesic=typeof e.geodesic<"u"?e.geodesic:!0,this.options.unit=typeof e.unit<"u"?e.unit:null,this.options.position=typeof e.position<"u"?e.position:null,this.options.target=typeof e.target<"u"?e.target:null,this.options.render=typeof e.render<"u"?e.render:null,this.options.gutter=typeof e.gutter<"u"?e.gutter:null,this.options.layerDescription=typeof e.layerDescription<"u"?e.layerDescription:{title:"Mesures de distance",description:"Mes mesures"},this.createStylingMeasureInteraction(e.styles)}_initializeContainer(){logger$8.trace("call MeasureLength::_initializeContainer() : ",this._uid);var e=this._createMainContainerElement(),n=this._pictoContainer=this._createShowMeasureLengthPictoElement();return e.appendChild(n),e}addMeasureEvents(){logger$8.trace("call MeasureLength::addMeasureEvents()");var e=this.getMap();e.on("singleclick",n=>this.onPointerMoveHandler(n)),e.on("pointermove",n=>this.onPointerMoveHandler(n)),this.eventLayerRemove=e.getLayers().on("remove",n=>{n.element===this.measureVector&&this.clean()})}removeMeasureEvents(){logger$8.trace("call MeasureLength::removeMeasureEvents()");var e=this.getMap();e.un("singleclick",n=>this.onPointerMoveHandle(n)),e.un("pointermove",n=>this.onPointerMoveHandler(n)),this.eventLayerRemove&&unByKey(this.eventLayerRemove)}format(e){logger$8.trace("call MeasureLength::format()");var n=this.getMap(),ei;if(this.options.geodesic){var ti=e.getCoordinates();ei=0;for(var ii=n.getView().getProjection(),ri=0,ni=ti.length-1;ri<ni;++ri){var si=transform$1(ti[ri],ii,"EPSG:4326"),ai=transform$1(ti[ri+1],ii,"EPSG:4326");ei+=getDistance(si,ai)}}else ei=Math.round(e.getLength()*100)/100;var oi;return this.options.unit==="km"?oi=Math.round(ei/1e3*100)/100+" km":this.options.unit==="m"?oi=Math.round(ei*100)/100+" m":ei>1e3?oi=Math.round(ei/1e3*100)/100+" km":oi=Math.round(ei*100)/100+" m",oi}onShowMeasureLengthClick(e){e.target.ariaPressed==="true"&&this.onPanelOpen(),logger$8.trace("call MeasureLength::onShowMeasureLengthClick()",e),this.onShowMeasureClick(e,"LineString")}}Object.assign(MeasureLength.prototype,Measures);Object.assign(MeasureLength.prototype,MeasureLengthDOM);Object.assign(MeasureLength.prototype,Widget);window.ol&&window.ol.control&&(window.ol.control.MeasureLength=MeasureLength);var MeasureAreaDOM={_addUID:function(_t){var e=this._uid?_t+"-"+this._uid:_t;return e},_createMainContainerElement:function(){var _t=document.createElement("div");return _t.id=this._addUID("GPmeasureArea"),_t.className="GPwidget gpf-widget gpf-widget-button",_t},_createShowMeasureAreaPictoElement:function(){var _t=this,e=document.createElement("button"),n=document.createElement("span");return e.appendChild(n),e.id=this._addUID("GPshowMeasureAreaPicto"),e.className="GPshowOpen GPshowAdvancedToolPicto gpf-btn gpf-btn--tertiary gpf-btn-icon gpf-btn-icon-area fr-btn fr-btn--tertiary",e.setAttribute("aria-label","Mesurer une surface"),e.setAttribute("tabindex","0"),e.setAttribute("aria-pressed",!1),e.setAttribute("type","button"),e.addEventListener?e.addEventListener("click",function(ei){var ti=ei.target.ariaPressed==="true";ei.target.setAttribute("aria-pressed",!ti),_t.onShowMeasureAreaClick(ei)}):e.attachEvent&&e.attachEvent("onclick",function(ei){var ti=ei.target.ariaPressed==="true";ei.target.setAttribute("aria-pressed",!ti),_t.onShowMeasureAreaClick(ei)}),e}},logger$7=LoggerByDefault.getLogger("measurearea");class MeasureArea extends ControlExtended{constructor(e){if(e=e||{},super(e),!(this instanceof MeasureArea))throw new TypeError("ERROR CLASS_CONSTRUCTOR");return this.CLASSNAME="MeasureArea",this._uid=e.id||SelectorID.generate(),this._pictoContainer=null,this._initialize(e),this._container=this._initializeContainer(),this.element?this.element.appendChild(this._container):this.element=this._container,this}setMap(e){logger$7.trace("setMap()");var n=this.CLASSNAME;e?!this.options.target&&!this.options.position&&MeasureToolBox.add(e,this):this.clean(),this.tools[n].push({instance:e?this:null,active:!1,map:e?e.getTargetElement():null});var ei=typeof window<"u"?window:typeof self<"u"?self:null;ei&&(ei.gpShareMeasures||(ei.gpShareMeasures={}),ei.gpShareMeasures[n]=this.tools[n]),super.setMap(e),this.options.position&&this.setPosition(this.options.position),this.options.gutter===!1&&this.getContainer().classList.add("gpf-button-no-gutter")}getContainer(){return this._container}_initialize(e){logger$7.trace("call MeasureArea::_initialize() : ",e),this.options={},this.options.geodesic=typeof e.geodesic<"u"?e.geodesic:!0,this.options.position=typeof e.position<"u"?e.position:null,this.options.target=typeof e.target<"u"?e.target:null,this.options.render=typeof e.render<"u"?e.render:null,this.options.gutter=typeof e.gutter<"u"?e.gutter:null,this.options.layerDescription=typeof e.layerDescription<"u"?e.layerDescription:{title:"Mesures de surface",description:"Mes mesures"},this.createStylingMeasureInteraction(e.styles)}_initializeContainer(){logger$7.trace("call MeasureArea::_initializeContainer() : ",this._uid);var e=this._createMainContainerElement(),n=this._pictoContainer=this._createShowMeasureAreaPictoElement();return e.appendChild(n),e}addMeasureEvents(){logger$7.trace("call MeasureArea::addMeasureEvents()");var e=this.getMap();e.on("singleclick",n=>this.onPointerMoveHandler(n)),e.on("pointermove",n=>this.onPointerMoveHandler(n)),this.eventLayerRemove=e.getLayers().on("remove",n=>{n.element===this.measureVector&&this.clean()})}removeMeasureEvents(){logger$7.trace("call MeasureArea::removeMeasureEvents()");var e=this.getMap();e.un("singleclick",n=>this.onPointerMoveHandler(n)),e.un("pointermove",n=>this.onPointerMoveHandler(n)),this.eventLayerRemove&&unByKey(this.eventLayerRemove)}format(e){logger$7.trace("call MeasureArea::format()");var n;if(this.options.geodesic){var ei=e.clone(),ti=ei.getLinearRing(0).getCoordinates();n=Math.abs(getArea$1(new Polygon([ti])))}else n=e.getArea();var ii;return n>1e6?ii=Math.round(n/1e6*100)/100+" km<sup>2</sup>":n>1e5?ii=Math.round(n/1e6*1e3)/1e3+" km<sup>2</sup>":n>1e3?ii=Math.round(n/10)*10+" m<sup>2</sup>":ii=Math.round(n*100)/100+" m<sup>2</sup>",ii}onShowMeasureAreaClick(e){e.target.ariaPressed==="true"&&this.onPanelOpen(),logger$7.trace("call MeasureArea::onShowMeasureAreaClick()",e),this.onShowMeasureClick(e,"Polygon")}}Object.assign(MeasureArea.prototype,Measures);Object.assign(MeasureArea.prototype,MeasureAreaDOM);Object.assign(MeasureArea.prototype,Widget);window.ol&&window.ol.control&&(window.ol.control.MeasureArea=MeasureArea);var MeasureAzimuthDOM={_addUID:function(_t){var e=this._uid?_t+"-"+this._uid:_t;return e},_createMainContainerElement:function(){var _t=document.createElement("div");return _t.id=this._addUID("GPmeasureAzimuth"),_t.className="GPwidget gpf-widget gpf-widget-button",_t},_createShowMeasureAzimuthPictoElement:function(){var _t=this,e=document.createElement("button"),n=document.createElement("span");return e.appendChild(n),e.id=this._addUID("GPshowMeasureAzimuthPicto"),e.className="GPshowOpen GPshowAdvancedToolPicto gpf-btn gpf-btn--tertiary gpf-btn-icon gpf-btn-icon-azimuth fr-btn fr-btn--tertiary",e.setAttribute("aria-label","Mesurer un angle"),e.setAttribute("tabindex","0"),e.setAttribute("aria-pressed",!1),e.setAttribute("type","button"),e.addEventListener?e.addEventListener("click",function(ei){var ti=ei.target.ariaPressed==="true";ei.target.setAttribute("aria-pressed",!ti),_t.onShowMeasureAzimuthClick(ei)}):e.attachEvent&&e.attachEvent("onclick",function(ei){var ti=ei.target.ariaPressed==="true";ei.target.setAttribute("aria-pressed",!ti),_t.onShowMeasureAzimuthClick(ei)}),e}},logger$6=LoggerByDefault.getLogger("measureazimut");class MeasureAzimuth extends ControlExtended{constructor(e){if(e=e||{},super(e),!(this instanceof MeasureAzimuth))throw new TypeError("ERROR CLASS_CONSTRUCTOR");return this.CLASSNAME="MeasureAzimuth",this._uid=e.id||SelectorID.generate(),this._pictoContainer=null,this._initialize(e),this._container=this._initializeContainer(),this.element?this.element.appendChild(this._container):this.element=this._container,this}setMap(e){logger$6.trace("setMap()");var n=this.CLASSNAME;e?!this.options.target&&!this.options.position&&MeasureToolBox.add(e,this):this.clean(),this.tools[n].push({instance:e?this:null,active:!1,map:e?e.getTargetElement():null});var ei=typeof window<"u"?window:typeof self<"u"?self:null;ei&&(ei.gpShareMeasures||(ei.gpShareMeasures={}),ei.gpShareMeasures[n]=this.tools[n]),super.setMap(e),this.options.position&&this.setPosition(this.options.position),this.options.gutter===!1&&this.getContainer().classList.add("gpf-button-no-gutter")}setGeodesic(e){this.options.geodesic=typeof e<"u"?e:!1}isGeodesic(){return this.options.geodesic}getContainer(){return this._container}_initialize(e){logger$6.trace("call MeasureAzimuth::_initialize() : ",e),this.options={},this.options.geodesic=typeof e.geodesic<"u"?e.geodesic:!1,this.options.position=typeof e.position<"u"?e.position:null,this.options.target=typeof e.target<"u"?e.target:null,this.options.render=typeof e.render<"u"?e.render:null,this.options.gutter=typeof e.gutter<"u"?e.gutter:null,this.options.layerDescription=typeof e.layerDescription<"u"?e.layerDescription:{title:"Mesures d'azimuth",description:"Mes mesures"},this.createStylingMeasureInteraction(e.styles)}_initializeContainer(){logger$6.trace("call MeasureAzimuth::_initializeContainer() : ",this._uid);var e=this._createMainContainerElement(),n=this._pictoContainer=this._createShowMeasureAzimuthPictoElement();return e.appendChild(n),e}addMeasureEvents(){logger$6.trace("call MeasureAzimuth::addMeasureEvents()");var e=this.getMap();e.on("singleclick",n=>this.onPointerMoveAzimutHandler(n)),e.on("pointermove",n=>this.onPointerMoveAzimutHandler(n)),this.eventLayerRemove=e.getLayers().on("remove",n=>{n.element===this.measureVector&&this.clean()})}removeMeasureEvents(){logger$6.trace("call MeasureAzimuth::removeMeasureEvents()");var e=this.getMap();e.un("singleclick",n=>this.onPointerMoveAzimutHandler(n)),e.un("pointermove",n=>this.onPointerMoveAzimutHandler(n)),this.eventLayerRemove&&unByKey(this.eventLayerRemove)}format(e){logger$6.trace("call MeasureAzimuth::format()");var n=this.getMap(),ei=n.getView().getProjection(),ti=transform$1(e.getFirstCoordinate(),ei,"EPSG:4326"),ii=transform$1(e.getLastCoordinate(),ei,"EPSG:4326");if(!this.options.geodesic){var ri=getDistance(ti,ii);if(logger$6.trace("measure between 2 points with geodesic method",ri),ri>500){var ni=500/ri;logger$6.trace("%",ni),ii=transform$1(e.getCoordinateAt(ni),ei,"EPSG:4326")}}var si=Math.PI/180,ai=180/Math.PI,oi=si*ti[0],li=si*ii[0],ci=si*ti[1],ui=si*ii[1],di=Math.sin(li-oi)*Math.cos(ui),fi=Math.cos(ci)*Math.sin(ui)-Math.sin(ci)*Math.cos(ui)*Math.cos(li-oi),hi=Math.atan2(di,fi),pi=ai*hi;logger$6.trace("azimut",pi),pi<0&&(pi+=360);var gi=Math.round(pi*100)/100+" ";return gi}onShowMeasureAzimuthClick(e){e.target.ariaPressed==="true"&&this.onPanelOpen(),logger$6.trace("call MeasureAzimuth::onShowMeasureAzimuthClick()",e),this.onShowMeasureClick(e,"LineString")}onPointerMoveAzimutHandler(e){if(this.onPointerMoveHandler(e),this.sketch){var n=this.sketch.getGeometry();n.getCoordinates().length>2&&this.measureDraw.finishDrawing()}}}Object.assign(MeasureAzimuth.prototype,Measures);Object.assign(MeasureAzimuth.prototype,MeasureAzimuthDOM);Object.assign(MeasureAzimuth.prototype,Widget);window.ol&&window.ol.control&&(window.ol.control.MeasureAzimuth=MeasureAzimuth);LoggerByDefault.getLogger("zoom");class GeoportalZoom extends Zoom{constructor(e){e=e||{};var n="ol-custom-zoom";e.className=n,super(e),this.container=null,this.options=e}_createContainerPosition(e){if(this.container=e.getOverlayContainerStopEvent(),this.options.position){this.options.target=this.container;var n="position-container-"+this.options.position;if(!document.getElementById(n)){var ei=document.createElement("div");ei.id=n,ei.classList.add("position"),ei.classList.add(n),this.container.appendChild(ei)}this.options.target=this.container.children[n]}}_initContainer(){this._uid=this.options.id||SelectorID.generate(),this.element.id="GPzoom-"+this._uid,this.element.classList.add("GPwidget","gpf-widget","gpf-widget-button"),this.element.classList.add(this.options.className),this.element.classList.remove("ol-zoom","ol-unselectable","ol-control");var e=this,n=this.element.childNodes;for(let ti=0;ti<n.length;ti++){const ii=n[ti];if(ii.classList.contains(this.options.className+"-in")){ii.classList.add("GPzoomIn","GPshowOpen","GPshowAdvancedToolPicto","gpf-btn-icon-zoom-in","fr-btn","fr-btn--tertiary","gpf-btn","gpf-btn--tertiary","gpf-btn-icon"),ii.id="GPzoomIn",ii.innerHTML="",ii.removeAttribute("title"),ii.setAttribute("aria-label","Zoomer");var ei=document.createElement("span");ii.appendChild(ei),ii.addEventListener?ii.addEventListener("click",function(){e.dispatchEvent("zoom:in")}):ii.attachEvent&&ii.attachEvent("onclick",function(){e.dispatchEvent("zoom:in")})}if(ii.classList.contains(this.options.className+"-out")){ii.classList.add("GPzoomOut","GPshowOpen","GPshowAdvancedToolPicto","gpf-btn-icon-zoom-out","fr-btn","fr-btn--tertiary","gpf-btn","gpf-btn--tertiary","gpf-btn-icon"),ii.id="GPzoomOut",ii.innerHTML="",ii.removeAttribute("title"),ii.setAttribute("aria-label","Dzoomer");var ei=document.createElement("span");ii.appendChild(ei),ii.addEventListener?ii.addEventListener("click",function(){e.dispatchEvent("zoom:out")}):ii.attachEvent&&ii.attachEvent("onclick",function(){e.dispatchEvent("zoom:out")})}}this.options.position&&(this.element.style.position="unset"),this.options.gutter===!1&&this.element.classList.add("gpf-button-no-gutter")}setMap(e){if(e){this._createContainerPosition(e),this._initContainer();var n=e.getControls();n.forEach(ei=>{ei.element.classList.contains("ol-zoom")&&(ei.element.classList.add("ol-hidden"),ei.element.style.display="none")})}this.setTarget(this.options.target),super.setMap(e)}getContainer(){return this.container}}window.ol&&window.ol.control&&(window.ol.control.GeoportalZoom=GeoportalZoom);const events=["fullscreenchange","webkitfullscreenchange"],FullScreenEventType={ENTERFULLSCREEN:"enterfullscreen",LEAVEFULLSCREEN:"leavefullscreen"};class FullScreen extends Control{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target}),this.on,this.once,this.un,this.keys_=e.keys!==void 0?e.keys:!1,this.source_=e.source,this.isInFullscreen_=!1,this.boundHandleMapTargetChange_=this.handleMapTargetChange_.bind(this),this.cssClassName_=e.className!==void 0?e.className:"ol-full-screen",this.documentListeners_=[],this.activeClassName_=e.activeClassName!==void 0?e.activeClassName.split(" "):[this.cssClassName_+"-true"],this.inactiveClassName_=e.inactiveClassName!==void 0?e.inactiveClassName.split(" "):[this.cssClassName_+"-false"];const n=e.label!==void 0?e.label:"";this.labelNode_=typeof n=="string"?document.createTextNode(n):n;const ei=e.labelActive!==void 0?e.labelActive:"";this.labelActiveNode_=typeof ei=="string"?document.createTextNode(ei):ei;const ti=e.tipLabel?e.tipLabel:"Toggle full-screen";this.button_=document.createElement("button"),this.button_.title=ti,this.button_.setAttribute("type","button"),this.button_.appendChild(this.labelNode_),this.button_.addEventListener(EventType.CLICK,this.handleClick_.bind(this),!1),this.setClassName_(this.button_,this.isInFullscreen_),this.element.className=`${this.cssClassName_} ${CLASS_UNSELECTABLE} ${CLASS_CONTROL}`,this.element.appendChild(this.button_)}handleClick_(e){e.preventDefault(),this.handleFullScreen_()}handleFullScreen_(){const e=this.getMap();if(!e)return;const n=e.getOwnerDocument();if(isFullScreenSupported(n))if(isFullScreen(n))exitFullScreen(n);else{let ei;this.source_?ei=typeof this.source_=="string"?n.getElementById(this.source_):this.source_:ei=e.getTargetElement(),this.keys_?requestFullScreenWithKeys(ei):requestFullScreen(ei)}}handleFullScreenChange_(){const e=this.getMap();if(!e)return;const n=this.isInFullscreen_;this.isInFullscreen_=isFullScreen(e.getOwnerDocument()),n!==this.isInFullscreen_&&(this.setClassName_(this.button_,this.isInFullscreen_),this.isInFullscreen_?(replaceNode(this.labelActiveNode_,this.labelNode_),this.dispatchEvent(FullScreenEventType.ENTERFULLSCREEN)):(replaceNode(this.labelNode_,this.labelActiveNode_),this.dispatchEvent(FullScreenEventType.LEAVEFULLSCREEN)),e.updateSize())}setClassName_(e,n){n?(e.classList.remove(...this.inactiveClassName_),e.classList.add(...this.activeClassName_)):(e.classList.remove(...this.activeClassName_),e.classList.add(...this.inactiveClassName_))}setMap(e){const n=this.getMap();n&&n.removeChangeListener(MapProperty.TARGET,this.boundHandleMapTargetChange_),super.setMap(e),this.handleMapTargetChange_(),e&&e.addChangeListener(MapProperty.TARGET,this.boundHandleMapTargetChange_)}handleMapTargetChange_(){const e=this.documentListeners_;for(let ei=0,ti=e.length;ei<ti;++ei)unlistenByKey(e[ei]);e.length=0;const n=this.getMap();if(n){const ei=n.getOwnerDocument();isFullScreenSupported(ei)?this.element.classList.remove(CLASS_UNSUPPORTED):this.element.classList.add(CLASS_UNSUPPORTED);for(let ti=0,ii=events.length;ti<ii;++ti)e.push(listen(ei,events[ti],this.handleFullScreenChange_,this));this.handleFullScreenChange_()}}}function isFullScreenSupported(_t){const e=_t.body;return!!(e.webkitRequestFullscreen||e.requestFullscreen&&_t.fullscreenEnabled)}function isFullScreen(_t){return!!(_t.webkitIsFullScreen||_t.fullscreenElement)}function requestFullScreen(_t){_t.requestFullscreen?_t.requestFullscreen():_t.webkitRequestFullscreen&&_t.webkitRequestFullscreen()}function requestFullScreenWithKeys(_t){_t.webkitRequestFullscreen?_t.webkitRequestFullscreen():requestFullScreen(_t)}function exitFullScreen(_t){_t.exitFullscreen?_t.exitFullscreen():_t.webkitExitFullscreen&&_t.webkitExitFullscreen()}LoggerByDefault.getLogger("fullscreen");class GeoportalFullScreen extends FullScreen{constructor(e){e=e||{};var n="ol-custom-full-screen";e.className=e.className||n,e.label=e.label||"",e.labelActive=e.labelActive||"",e.activeClassName=e.activeClassName||n+"-true",e.inactiveClassName=e.inactiveClassName||n+"-false",e.tipLabel=e.tipLabel||"Plein cran",super(e),this.CLASSNAME="FullScreen",this.container=null,this.options=e}_createContainerPosition(e){if(this.container=e.getOverlayContainerStopEvent(),this.options.target=this.container,this.options.position){var n="position-container-"+this.options.position;if(!document.getElementById(n)){var ei=document.createElement("div");ei.id=n,ei.classList.add("position"),ei.classList.add(n),this.container.appendChild(ei)}this.options.target=this.container.children[n]}}_initContainer(){this._uid=this.options.id||SelectorID.generate(),this.element.id="GPfullScreen-"+this._uid,this.element.classList.add("GPwidget","gpf-widget","gpf-widget-button"),this.element.classList.add(this.options.className),this.element.classList.remove("ol-full-screen","ol-unselectable","ol-control");var e=this.element.childNodes[0],n=document.createElement("span");e.appendChild(n),e.classList.add("GPshowOpen","GPshowAdvancedToolPicto","GPfullScreenPicto"),e.classList.add("fr-btn","fr-btn--tertiary"),e.classList.add("gpf-btn--tertiary","gpf-btn","gpf-btn-icon"),e.setAttribute("tabindex","0"),e.setAttribute("aria-pressed",!1),e.setAttribute("type","button"),e.removeAttribute("title"),e.setAttribute("aria-label",this.options.tipLabel),e.addEventListener?e.addEventListener("click",function(ei){var ti=ei.target.ariaPressed==="true";ei.target.setAttribute("aria-pressed",!ti)}):e.attachEvent&&e.attachEvent("onclick",function(ei){var ti=ei.target.ariaPressed==="true";ei.target.setAttribute("aria-pressed",!ti)}),this.options.position&&(this.element.style.position="unset"),this.options.gutter===!1&&this.element.classList.add("gpf-button-no-gutter")}setMap(e){if(e){this._createContainerPosition(e),this._initContainer();var n=e.getControls();n.forEach(ei=>{ei.element.classList.contains("ol-full-screen")&&(ei.element.classList.add("ol-hidden"),ei.element.style.display="none")})}this.setTarget(this.options.target),super.setMap(e)}getContainer(){return this.container}}window.ol&&window.ol.control&&(window.ol.control.GeoportalFullScreen=GeoportalFullScreen);const MAX_RATIO=.75,MIN_RATIO=.1;class OverviewMap extends Control{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.boundHandleRotationChanged_=this.handleRotationChanged_.bind(this),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.rotateWithView_=e.rotateWithView!==void 0?e.rotateWithView:!1,this.viewExtent_=void 0;const n=e.className!==void 0?e.className:"ol-overviewmap",ei=e.tipLabel!==void 0?e.tipLabel:"Overview map",ti=e.collapseLabel!==void 0?e.collapseLabel:"";typeof ti=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=ti):this.collapseLabel_=ti;const ii=e.label!==void 0?e.label:"";typeof ii=="string"?(this.label_=document.createElement("span"),this.label_.textContent=ii):this.label_=ii;const ri=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_,ni=document.createElement("button");ni.setAttribute("type","button"),ni.title=ei,ni.appendChild(ri),ni.addEventListener(EventType.CLICK,this.handleClick_.bind(this),!1),this.ovmapDiv_=document.createElement("div"),this.ovmapDiv_.className="ol-overviewmap-map",this.view_=e.view;const si=new Map$1({view:e.view,controls:new Collection,interactions:new Collection});this.ovmap_=si,e.layers&&e.layers.forEach(function(pi){si.addLayer(pi)});const ai=document.createElement("div");ai.className="ol-overviewmap-box",ai.style.boxSizing="border-box",this.boxOverlay_=new Overlay({position:[0,0],positioning:"center-center",element:ai}),this.ovmap_.addOverlay(this.boxOverlay_);const oi=n+" "+CLASS_UNSELECTABLE+" "+CLASS_CONTROL+(this.collapsed_&&this.collapsible_?" "+CLASS_COLLAPSED:"")+(this.collapsible_?"":" ol-uncollapsible"),li=this.element;li.className=oi,li.appendChild(this.ovmapDiv_),li.appendChild(ni);const ci=this.boxOverlay_,ui=this.boxOverlay_.getElement(),di=pi=>({clientX:pi.clientX,clientY:pi.clientY}),fi=function(pi){const gi=di(pi),vi=si.getEventCoordinate(gi);ci.setPosition(vi)},hi=pi=>{const gi=si.getEventCoordinateInternal(pi),vi=this.getMap();vi.getView().setCenterInternal(gi);const yi=vi.getOwnerDocument();yi.removeEventListener("pointermove",fi),yi.removeEventListener("pointerup",hi)};this.ovmapDiv_.addEventListener("pointerdown",pi=>{const gi=this.getMap().getOwnerDocument();pi.target===ui&&gi.addEventListener("pointermove",fi),gi.addEventListener("pointerup",hi)})}setMap(e){const n=this.getMap();if(e!==n){if(n){const ei=n.getView();ei&&this.unbindView_(ei),this.ovmap_.setTarget(null)}if(super.setMap(e),e){this.ovmap_.setTarget(this.ovmapDiv_),this.listenerKeys.push(listen(e,ObjectEventType.PROPERTYCHANGE,this.handleMapPropertyChange_,this));const ei=e.getView();ei&&this.bindView_(ei),this.ovmap_.isRendered()||this.updateBoxAfterOvmapIsRendered_()}}}handleMapPropertyChange_(e){if(e.key===MapProperty.VIEW){const n=e.oldValue;n&&this.unbindView_(n);const ei=this.getMap().getView();this.bindView_(ei)}else!this.ovmap_.isRendered()&&(e.key===MapProperty.TARGET||e.key===MapProperty.SIZE)&&this.ovmap_.updateSize()}bindView_(e){if(!this.view_){const n=new View({projection:e.getProjection()});this.ovmap_.setView(n)}e.addChangeListener(ViewProperty.ROTATION,this.boundHandleRotationChanged_),this.handleRotationChanged_(),e.isDef()&&(this.ovmap_.updateSize(),this.resetExtent_())}unbindView_(e){e.removeChangeListener(ViewProperty.ROTATION,this.boundHandleRotationChanged_)}handleRotationChanged_(){this.rotateWithView_&&this.ovmap_.getView().setRotation(this.getMap().getView().getRotation())}validateExtent_(){const e=this.getMap(),n=this.ovmap_;if(!e.isRendered()||!n.isRendered())return;const ei=e.getSize(),ii=e.getView().calculateExtentInternal(ei);if(this.viewExtent_&&equals$1(ii,this.viewExtent_))return;this.viewExtent_=ii;const ri=n.getSize(),si=n.getView().calculateExtentInternal(ri),ai=n.getPixelFromCoordinateInternal(getTopLeft(ii)),oi=n.getPixelFromCoordinateInternal(getBottomRight(ii)),li=Math.abs(ai[0]-oi[0]),ci=Math.abs(ai[1]-oi[1]),ui=ri[0],di=ri[1];li<ui*MIN_RATIO||ci<di*MIN_RATIO||li>ui*MAX_RATIO||ci>di*MAX_RATIO?this.resetExtent_():containsExtent(si,ii)||this.recenter_()}resetExtent_(){const e=this.getMap(),n=this.ovmap_,ei=e.getSize(),ii=e.getView().calculateExtentInternal(ei),ri=n.getView(),ni=Math.log(MAX_RATIO/MIN_RATIO)/Math.LN2,si=1/(Math.pow(2,ni/2)*MIN_RATIO);scaleFromCenter(ii,si),ri.fitInternal(fromExtent(ii))}recenter_(){const e=this.getMap(),n=this.ovmap_,ei=e.getView();n.getView().setCenterInternal(ei.getCenterInternal())}updateBox_(){const e=this.getMap(),n=this.ovmap_;if(!e.isRendered()||!n.isRendered())return;const ei=e.getSize(),ti=e.getView(),ii=n.getView(),ri=this.rotateWithView_?0:-ti.getRotation(),ni=this.boxOverlay_,si=this.boxOverlay_.getElement(),ai=ti.getCenter(),oi=ti.getResolution(),li=ii.getResolution(),ci=ei[0]*oi/li,ui=ei[1]*oi/li;if(ni.setPosition(ai),si){si.style.width=ci+"px",si.style.height=ui+"px";const di="rotate("+ri+"rad)";si.style.transform=di}}updateBoxAfterOvmapIsRendered_(){this.ovmapPostrenderKey_||(this.ovmapPostrenderKey_=listenOnce(this.ovmap_,MapEventType.POSTRENDER,e=>{delete this.ovmapPostrenderKey_,this.updateBox_()}))}handleClick_(e){e.preventDefault(),this.handleToggle_()}handleToggle_(){this.element.classList.toggle(CLASS_COLLAPSED),this.collapsed_?replaceNode(this.collapseLabel_,this.label_):replaceNode(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_;const e=this.ovmap_;if(!this.collapsed_){if(e.isRendered()){this.viewExtent_=void 0,e.render();return}e.updateSize(),this.resetExtent_(),this.updateBoxAfterOvmapIsRendered_()}}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),!e&&this.collapsed_&&this.handleToggle_())}setCollapsed(e){!this.collapsible_||this.collapsed_===e||this.handleToggle_()}getCollapsed(){return this.collapsed_}getRotateWithView(){return this.rotateWithView_}setRotateWithView(e){this.rotateWithView_!==e&&(this.rotateWithView_=e,this.getMap().getView().getRotation()!==0&&(this.rotateWithView_?this.handleRotationChanged_():this.ovmap_.getView().setRotation(0),this.viewExtent_=void 0,this.validateExtent_(),this.updateBox_()))}getOverviewMap(){return this.ovmap_}render(e){this.validateExtent_(),this.updateBox_()}}LoggerByDefault.getLogger("overviewMap");class GeoportalOverviewMap extends OverviewMap{constructor(e){e=e||{};const n={name:"GEOGRAPHICALGRIDSYSTEMS.MAPS.OVERVIEW",globalConstraint:{maxScaleDenominator:27954113201435894e-8,minScaleDenominator:2.1839150938621787e6,bbox:{left:-179.5,right:179.5,top:75,bottom:-75}},params:{url:"https://data.geopf.fr/wmts",styles:"normal",version:"1.0.0",format:"image/jpeg",projection:"EPSG:3857",minScale:2.1839150938621787e6,maxScale:27954113201435894e-8,extent:{left:-179.5,right:179.5,top:75,bottom:-75},legends:[{format:"image/jpeg",url:"https://data.geopf.fr/annexes/ressources/legendes/LEGEND.jpg",minScaleDenominator:"200"}],title:"Carte Mondiale pour la mini-vue",description:"Carte Mondiale pour la mini-vue",tileMatrixSetLimits:{1:{minTileRow:"0",maxTileRow:"1",minTileCol:"0",maxTileCol:"1"},2:{minTileRow:"0",maxTileRow:"3",minTileCol:"0",maxTileCol:"3"},3:{minTileRow:"1",maxTileRow:"6",minTileCol:"0",maxTileCol:"7"},4:{minTileRow:"2",maxTileRow:"13",minTileCol:"0",maxTileCol:"15"},5:{minTileRow:"5",maxTileRow:"26",minTileCol:"0",maxTileCol:"31"},6:{minTileRow:"11",maxTileRow:"52",minTileCol:"0",maxTileCol:"63"},7:{minTileRow:"22",maxTileRow:"105",minTileCol:"0",maxTileCol:"127"},8:{minTileRow:"45",maxTileRow:"210",minTileCol:"0",maxTileCol:"255"}},TMSLink:"PM_1_8",matrixIds:["1","2","3","4","5","6","7","8"],tileMatrices:{1:{matrixId:"1",matrixHeight:2,matrixWidth:2,scaleDenominator:27954113201435894e-8,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},2:{matrixId:"2",matrixHeight:4,matrixWidth:4,scaleDenominator:1397705660071793e-7,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},3:{matrixId:"3",matrixHeight:8,matrixWidth:8,scaleDenominator:6988528300358965e-8,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},4:{matrixId:"4",matrixHeight:16,matrixWidth:16,scaleDenominator:3494264150179486e-8,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},5:{matrixId:"5",matrixHeight:32,matrixWidth:32,scaleDenominator:1747132075089743e-8,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},6:{matrixId:"6",matrixHeight:64,matrixWidth:64,scaleDenominator:8735660375448715e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},7:{matrixId:"7",matrixHeight:128,matrixWidth:128,scaleDenominator:4.3678301877243575e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},8:{matrixId:"8",matrixHeight:256,matrixWidth:256,scaleDenominator:2.1839150938621787e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}}},nativeResolutions:["78271.51696402048","39135.75848201023","19567.87924100512","9783.939620502561","4891.969810251280","2445.984905125640","1222.992452562820","611.4962262814100"]}};var ei="ol-overviewmap";e.className=e.className||ei,e.collapseLabel=e.collapseLabel||"",e.collapsed=e.collapsed,e.collapsed===void 0&&(e.collapsed=!0),e.label=e.label||"",e.tipLabel="Mini-carte",e.layers=e.layers||[new LayerWMTS({layer:"GEOGRAPHICALGRIDSYSTEMS.MAPS.OVERVIEW",configuration:n})],e.view=e.view||new View({minZoom:1,maxZoom:8}),super(e),this.CLASSNAME="OverviewMap",this.container=null,this.options=e}_createContainerPosition(e){if(this.container=e.getOverlayContainerStopEvent(),this.options.target=this.container,this.options.position){var n="position-container-"+this.options.position;if(!document.getElementById(n)){var ei=document.createElement("div");ei.id=n,ei.classList.add("position"),ei.classList.add(n),this.container.appendChild(ei)}this.options.target=this.container.children[n]}}_initContainer(){this._uid=this.options.id||SelectorID.generate(),this.element.id="GPoverviewMap-"+this._uid,this.element.classList.add("GPwidget","gpf-widget","gpf-widget-button"),this.element.classList.remove("ol-control");var e=this.element.childNodes,n=e[1];n.id="GPshowOverviewMap-"+this._uid,n.classList.add("GPshowOpen","GPshowAdvancedToolPicto","GPshowOverviewMapPicto"),n.classList.add("gpf-btn-icon","gpf-btn--tertiary","gpf-btn-icon-overviewmap"),n.classList.add("fr-btn","fr-btn--tertiary"),n.setAttribute("tabindex","0"),n.setAttribute("aria-pressed",!this.options.collapsed),n.setAttribute("type","button"),n.removeAttribute("title"),n.setAttribute("aria-label",this.options.tipLabel);var ei=this;n.addEventListener?n.addEventListener("click",function(ti){var ii=ti.target.ariaPressed==="true";ti.target.setAttribute("aria-pressed",!ii),ei.dispatchEvent({type:"overviewmap:toggle",status:ii})}):n.attachEvent&&n.attachEvent("onclick",function(ti){var ii=ti.target.ariaPressed==="true";ti.target.setAttribute("aria-pressed",!ii),ei.dispatchEvent({type:"overviewmap:toggle",status:ii})}),this.options.position&&(this.element.style.position="unset"),this.options.gutter===!1&&this.element.classList.add("gpf-button-no-gutter")}setMap(e){e&&(this._createContainerPosition(e),this._initContainer()),this.setTarget(this.options.target),super.setMap(e)}getContainer(){return this.container}}window.ol&&window.ol.control&&(window.ol.control.GeoportalOverviewMap=GeoportalOverviewMap);var LegendsDOM={_addUID:function(_t){var e=this.uid?_t+"-"+this.uid:_t;return e},_createMainContainerElement:function(){var _t=document.createElement("div");return _t.id=this._addUID("GPlegends"),_t.className="GPwidget gpf-widget gpf-widget-button gpf-mobile-fullscreen",_t},_createShowLegendsPictoElement:function(){var _t=this,e=document.createElement("button"),n=document.createElement("span");return e.appendChild(n),e.id=this._addUID("GPshowLegendsPicto"),e.classList.add("GPshowOpen","GPshowAdvancedToolPicto","GPshowLegendsPicto"),e.classList.add("gpf-btn","gpf-btn--tertiary","gpf-btn-icon","gpf-btn-icon-legends"),e.classList.add("fr-btn","fr-btn--tertiary"),e.setAttribute("aria-label","Lgende"),e.setAttribute("tabindex","0"),e.setAttribute("aria-pressed",!1),e.setAttribute("type","button"),e.addEventListener?e.addEventListener("click",function(ei){var ti=ei.target.ariaPressed==="true";ei.target.setAttribute("aria-pressed",!ti),_t.onShowLegendsClick(ei)}):e.attachEvent&&e.attachEvent("onclick",function(ei){var ti=ei.target.ariaPressed==="true";ei.target.setAttribute("aria-pressed",!ti),_t.onShowLegendsClick(ei)}),e},_createLegendsPanelElement:function(){var _t=document.createElement("dialog");return _t.id=this._addUID("GPlegendsPanel"),_t.className="GPpanel gpf-panel fr-modal",_t},_createLegendsPanelDivElement:function(){var _t=document.createElement("div");return _t.className="gpf-panel__legends",_t},_createLegendsPanelHeaderElement:function(){var _t=document.createElement("div");return _t.className="gpf-panel__header_legends",_t},_createLegendsPanelIconElement:function(){var _t=document.createElement("label");return _t.className="gpf-btn-header-legends gpf-btn-icon-header-legends",_t.title="Lgendes",_t},_createLegendsPanelTitleElement:function(){var _t=document.createElement("div");return _t.className="gpf-panel__title_legends",_t.innerHTML="Lgendes",_t},_createLegendsPanelCloseElement:function(){var _t=this,e=document.createElement("button");e.className="gpf-btn gpf-btn-icon-close fr-btn--close fr-btn fr-btn--tertiary-no-outline",e.title="Fermer le panneau";var n=document.createElement("span");return n.className="GPelementHidden gpf-visible",n.innerText="Fermer",e.appendChild(n),e.addEventListener?e.addEventListener("click",function(){document.getElementById(_t._addUID("GPshowLegendsPicto")).click()},!1):e.attachEvent&&e.attachEvent("onclick",function(){document.getElementById(_t._addUID("GPshowLegendsPicto")).click()}),e},_createLegendElement:function(){var _t=document.createElement("div");return _t.className="legends-entries gpf-panel__body fr-modal__body",_t},_createLegendEntry:function(_t){const e=ii=>{var ri=function(){if(!window.DOMParser)return!1;var oi=new DOMParser;try{oi.parseFromString("x","text/html")}catch{return!1}return!0};if(ri()){var ni=new DOMParser,si=ni.parseFromString(ii,"text/html");return si.body}var ai=document.createElement("div");return ai.innerHTML=ii,ai};if(_t&&_t.legends&&_t.legends.length){var n=_t.legends[0].url,ei=e(`
                    <div
                        id="${_t.id}"
                        class="legend-entry-container gpf-panel__content fr-modal__content">
                        <label class="legend-entry-title gpf-label-legends-name fr-label">${_t.title}</label>
                        <button
                            id="GPcollapseLegend_ID_${_t.id}"
                            class="legend-entry-show gpf-btn gpf-btn-icon gpf-btn-icon-legends-collapse fr-btn fr-btn--tertiary gpf-btn--tertiary"
                            type="button"
                            title=""
                            tabindex="0"
                            aria-pressed="false"></button>
                        <div id="GPlegend_ID_${_t.id}" class="legend-entry-image gpf-hidden">
                            <img src="${n}" alt="${_t.desc}">
                        </div>
                    </div>
                `),ti=ei.firstChild.querySelector("button");return ti&&ti.addEventListener("click",ii=>{var ri=ii.target.ariaPressed==="true";ii.target.setAttribute("aria-pressed",!ri);var ni=document.getElementById("GPlegend_ID_"+_t.id);ri?ni.classList.replace("gpf-visible","gpf-hidden"):ni.classList.replace("gpf-hidden","gpf-visible")}),ei.firstChild}}},logger$5=LoggerByDefault.getLogger("legends");class Legends extends ControlExtended{constructor(e){if(e=e||{},super(e),!(this instanceof Legends))throw new TypeError("ERROR CLASS_CONSTRUCTOR");return this.CLASSNAME="Legends",this.initialize(e),this.container=this.initContainer(),this.element?this.element.appendChild(this.container):this.element=this.container,this}setMap(e){if(e){if(this.draggable&&Draggable.dragElement(this.panelLegendsContainer,this.panelLegendsHeaderContainer,e.getTargetElement()),this.collapsed||this.buttonLegendsShow.setAttribute("aria-pressed",!0),this.auto){var n=this;e.getLayers().forEach(ei=>{n.add(ei)})}this.auto&&this.addEventsListeners(e)}else this.auto&&this.removeEventsListeners();super.setMap(e),this.options.position&&this.setPosition(this.options.position),this.options.gutter===!1&&this.getContainer().classList.add("gpf-button-no-gutter")}getContainer(){return this.container}getMetaInformations(e){if(e.hasOwnProperty("name"))return{id:e.name,title:e.getTitle(),legends:e.getLegends(),metadatas:e.getMetadata(),desc:e.getDescription(),url:e.getQuicklookUrl(),partners:e.getOriginators()}}adds(e){if(e)for(let n=0;n<e.length;n++)this.add(e[n])}add(e){if(e){var n=this._createLegendEntry(this.getMetaInformations(e));if(n)return this.exist(n)?!1:(this.panelLegendsEntriesContainer.prepend(n),this.legends.push({obj:e,dom:n}),!0)}return!1}remove(e){var n=!1;if(e)for(let ei=0;ei<this.legends.length;ei++){const ti=this.legends[ei];if(e.name===ti.obj.name&&e.service===ti.obj.service){ti.dom&&this.legends[ei].dom.remove(),this.legends.splice(ei,1),n=!0;break}}return n}exist(e){var n=!1;for(let ei=0;ei<this.legends.length;ei++)if(this.legends[ei].dom.id===e.id){n=!0;break}return n}initialize(e){this.uid=e.id||SelectorID.generate(),this.options={collapsed:!0,draggable:!1,auto:!0,panel:!1},Helper.assign(this.options,e),this.collapsed=this.options.collapsed,this.draggable=this.options.draggable,this.auto=this.options.auto,this.buttonLegendsShow=null,this.panelLegendsContainer=null,this.panelLegendsEntriesContainer=null,this.panelLegendsHeaderContainer=null,this.buttonLegendsClose=null,this.eventsListeners=[],this.legends=[]}initContainer(){var e=this._createMainContainerElement(),n=this.buttonLegendsShow=this._createShowLegendsPictoElement();e.appendChild(n);var ei=this.panelLegendsContainer=this._createLegendsPanelElement(),ti=this._createLegendsPanelDivElement();ei.appendChild(ti);var ii=this.panelLegendsEntriesContainer=this._createLegendElement();if(ei.appendChild(ii),this.options.panel){var ri=this.panelLegendsHeaderContainer=this._createLegendsPanelHeaderElement(),ni=this._createLegendsPanelIconElement();ri.appendChild(ni);var si=this._createLegendsPanelTitleElement();ri.appendChild(si);var ai=this.buttonLegendsClose=this._createLegendsPanelCloseElement();ri.appendChild(ai),ti.appendChild(ri)}return e.appendChild(ei),logger$5.log(e),e}addEventsListeners(e){var n=this;this.eventsListeners["layer:add"]=function(ei){if(logger$5.trace(ei),!n.add(ei.element)){logger$5.error("Layer already added...");return}},this.eventsListeners["layer:remove"]=function(ei){if(logger$5.trace(ei),!n.remove(ei.element)){logger$5.error("Layer already removed...");return}},this.eventsListeners["layer:change:position"]=function(ei){logger$5.trace(ei)},this.eventsListeners["view:change:resolution"]=function(ei){logger$5.trace(ei);var ti=n.getMap();for(let ci=0;ci<n.legends.length;ci++){const ui=n.legends[ci];var ii=n.getMetaInformations(ui.obj);if(ii){var ri=ti.getView().getResolution()||ti.getView().getResolutionForZoom(ti.getZoom()),ni=ri*3570,si=ii.legends.slice(),ai=si[0];for(let di=0;di<si.length;++di){const fi=si[di];fi.minScaleDenominator||(fi.minScaleDenominator=0),(ni>ai.minScaleDenominator&&fi.minScaleDenominator>ai.minScaleDenominator&&fi.minScaleDenominator<ni||ni<ai.minScaleDenominator&&fi.minScaleDenominator<ai.minScaleDenominator)&&(ai=fi)}if(ii.legends[0]!==ai){ii.legends=[],ii.legends.push(ai);var oi=n._createLegendEntry(ii),li=ui.dom;li.replaceWith(oi),ui.dom=oi}}}},e.getLayers().on("add",this.eventsListeners["layer:add"]),e.getLayers().on("remove",this.eventsListeners["layer:remove"]),e.getLayers().on("change:zIndex",this.eventsListeners["layer:change:position"]),e.getView().on("change:resolution",this.eventsListeners["view:change:resolution"])}removeEventsListeners(){var e=this.getMap();e.getLayers().un("add",this.eventsListeners["layer:add"]),e.getLayers().un("remove",this.eventsListeners["layer:remove"]),e.getLayers().un("change:zIndex",this.eventsListeners["layer:change:position"]),e.getView().un("change:resolution",this.eventsListeners["view:change:resolution"]),delete this.eventsListeners["layer:add"],delete this.eventsListeners["layer:remove"],delete this.eventsListeners["layer:change:position"],delete this.eventsListeners["view:change:resolution"]}onShowLegendsClick(e){e.target.ariaPressed==="true"&&this.onPanelOpen(),logger$5.trace(e);var n=this.buttonLegendsShow.ariaPressed;this.collapsed=n!=="true",this.dispatchEvent("change:collapsed"),this.options.position&&!this.collapsed&&this.updatePosition(this.options.position)}}Object.assign(Legends.prototype,LegendsDOM);Object.assign(Legends.prototype,Widget);window.ol&&window.ol.control&&(window.ol.control.Legends=Legends);const PM={projection:"EPSG:3857",nativeResolutions:["156543.0339280410","78271.51696402048","39135.75848201023","19567.87924100512","9783.939620502561","4891.969810251280","2445.984905125640","1222.992452562820","611.4962262814100","305.7481131407048","152.8740565703525","76.43702828517624","38.21851414258813","19.10925707129406","9.554628535647032","4.777314267823516","2.388657133911758","1.194328566955879","0.5971642834779395","0.2985821417389697","0.1492910708694849","0.0746455354347424"],tileMatrices:{0:{matrixId:"0",matrixHeight:1,matrixWidth:1,scaleDenominator:5590822640287179e-7,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},1:{matrixId:"1",matrixHeight:2,matrixWidth:2,scaleDenominator:27954113201435894e-8,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},2:{matrixId:"2",matrixHeight:4,matrixWidth:4,scaleDenominator:1397705660071793e-7,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},3:{matrixId:"3",matrixHeight:8,matrixWidth:8,scaleDenominator:6988528300358965e-8,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},4:{matrixId:"4",matrixHeight:16,matrixWidth:16,scaleDenominator:3494264150179486e-8,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},5:{matrixId:"5",matrixHeight:32,matrixWidth:32,scaleDenominator:1747132075089743e-8,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},6:{matrixId:"6",matrixHeight:64,matrixWidth:64,scaleDenominator:8735660375448715e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},7:{matrixId:"7",matrixHeight:128,matrixWidth:128,scaleDenominator:4.3678301877243575e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},8:{matrixId:"8",matrixHeight:256,matrixWidth:256,scaleDenominator:2.1839150938621787e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},9:{matrixId:"9",matrixHeight:512,matrixWidth:512,scaleDenominator:1.0919575469310894e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},10:{matrixId:"10",matrixHeight:1024,matrixWidth:1024,scaleDenominator:545978.7734655464,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},11:{matrixId:"11",matrixHeight:2048,matrixWidth:2048,scaleDenominator:272989.38673277217,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},12:{matrixId:"12",matrixHeight:4096,matrixWidth:4096,scaleDenominator:136494.69336638608,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},13:{matrixId:"13",matrixHeight:8192,matrixWidth:8192,scaleDenominator:68247.34668319322,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},14:{matrixId:"14",matrixHeight:16384,matrixWidth:16384,scaleDenominator:34123.673341596535,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},15:{matrixId:"15",matrixHeight:32768,matrixWidth:32768,scaleDenominator:17061.83667079829,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},16:{matrixId:"16",matrixHeight:65536,matrixWidth:65536,scaleDenominator:8530.918335399145,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},17:{matrixId:"17",matrixHeight:131072,matrixWidth:131072,scaleDenominator:4265.459167699572,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},18:{matrixId:"18",matrixHeight:262144,matrixWidth:262144,scaleDenominator:2132.7295838497826,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},19:{matrixId:"19",matrixHeight:524288,matrixWidth:524288,scaleDenominator:1066.364791924893,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},20:{matrixId:"20",matrixHeight:1048576,matrixWidth:1048576,scaleDenominator:533.1823959624465,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},21:{matrixId:"21",matrixHeight:2097152,matrixWidth:2097152,scaleDenominator:266.5911979812229,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}}}},PM_0_14={projection:"EPSG:3857",nativeResolutions:["156543.0339280410","78271.51696402048","39135.75848201023","19567.87924100512","9783.939620502561","4891.969810251280","2445.984905125640","1222.992452562820","611.4962262814100","305.7481131407048","152.8740565703525","76.43702828517624","38.21851414258813","19.10925707129406","9.554628535647032"],tileMatrices:{0:{matrixId:"0",matrixHeight:1,matrixWidth:1,scaleDenominator:5590822640287179e-7,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},1:{matrixId:"1",matrixHeight:2,matrixWidth:2,scaleDenominator:27954113201435894e-8,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},2:{matrixId:"2",matrixHeight:4,matrixWidth:4,scaleDenominator:1397705660071793e-7,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},3:{matrixId:"3",matrixHeight:8,matrixWidth:8,scaleDenominator:6988528300358965e-8,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},4:{matrixId:"4",matrixHeight:16,matrixWidth:16,scaleDenominator:3494264150179486e-8,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},5:{matrixId:"5",matrixHeight:32,matrixWidth:32,scaleDenominator:1747132075089743e-8,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},6:{matrixId:"6",matrixHeight:64,matrixWidth:64,scaleDenominator:8735660375448715e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},7:{matrixId:"7",matrixHeight:128,matrixWidth:128,scaleDenominator:4.3678301877243575e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},8:{matrixId:"8",matrixHeight:256,matrixWidth:256,scaleDenominator:2.1839150938621787e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},9:{matrixId:"9",matrixHeight:512,matrixWidth:512,scaleDenominator:1.0919575469310894e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},10:{matrixId:"10",matrixHeight:1024,matrixWidth:1024,scaleDenominator:545978.7734655464,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},11:{matrixId:"11",matrixHeight:2048,matrixWidth:2048,scaleDenominator:272989.38673277217,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},12:{matrixId:"12",matrixHeight:4096,matrixWidth:4096,scaleDenominator:136494.69336638608,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},13:{matrixId:"13",matrixHeight:8192,matrixWidth:8192,scaleDenominator:68247.34668319322,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},14:{matrixId:"14",matrixHeight:16384,matrixWidth:16384,scaleDenominator:34123.673341596535,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}}}},PM_0_16={projection:"EPSG:3857",nativeResolutions:["156543.0339280410","78271.51696402048","39135.75848201023","19567.87924100512","9783.939620502561","4891.969810251280","2445.984905125640","1222.992452562820","611.4962262814100","305.7481131407048","152.8740565703525","76.43702828517624","38.21851414258813","19.10925707129406","9.554628535647032","4.777314267823516","2.388657133911758"],tileMatrices:{0:{matrixId:"0",matrixHeight:1,matrixWidth:1,scaleDenominator:5590822640287179e-7,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},1:{matrixId:"1",matrixHeight:2,matrixWidth:2,scaleDenominator:27954113201435894e-8,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},2:{matrixId:"2",matrixHeight:4,matrixWidth:4,scaleDenominator:1397705660071793e-7,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},3:{matrixId:"3",matrixHeight:8,matrixWidth:8,scaleDenominator:6988528300358965e-8,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},4:{matrixId:"4",matrixHeight:16,matrixWidth:16,scaleDenominator:3494264150179486e-8,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},5:{matrixId:"5",matrixHeight:32,matrixWidth:32,scaleDenominator:1747132075089743e-8,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},6:{matrixId:"6",matrixHeight:64,matrixWidth:64,scaleDenominator:8735660375448715e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},7:{matrixId:"7",matrixHeight:128,matrixWidth:128,scaleDenominator:4.3678301877243575e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},8:{matrixId:"8",matrixHeight:256,matrixWidth:256,scaleDenominator:2.1839150938621787e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},9:{matrixId:"9",matrixHeight:512,matrixWidth:512,scaleDenominator:1.0919575469310894e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},10:{matrixId:"10",matrixHeight:1024,matrixWidth:1024,scaleDenominator:545978.7734655464,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},11:{matrixId:"11",matrixHeight:2048,matrixWidth:2048,scaleDenominator:272989.38673277217,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},12:{matrixId:"12",matrixHeight:4096,matrixWidth:4096,scaleDenominator:136494.69336638608,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},13:{matrixId:"13",matrixHeight:8192,matrixWidth:8192,scaleDenominator:68247.34668319322,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},14:{matrixId:"14",matrixHeight:16384,matrixWidth:16384,scaleDenominator:34123.673341596535,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},15:{matrixId:"15",matrixHeight:32768,matrixWidth:32768,scaleDenominator:17061.83667079829,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},16:{matrixId:"16",matrixHeight:65536,matrixWidth:65536,scaleDenominator:8530.918335399145,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}}}},PM_0_18={projection:"EPSG:3857",nativeResolutions:["156543.0339280410","78271.51696402048","39135.75848201023","19567.87924100512","9783.939620502561","4891.969810251280","2445.984905125640","1222.992452562820","611.4962262814100","305.7481131407048","152.8740565703525","76.43702828517624","38.21851414258813","19.10925707129406","9.554628535647032","4.777314267823516","2.388657133911758","1.194328566955879","0.5971642834779395"],tileMatrices:{0:{matrixId:"0",matrixHeight:1,matrixWidth:1,scaleDenominator:5590822640287179e-7,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},1:{matrixId:"1",matrixHeight:2,matrixWidth:2,scaleDenominator:27954113201435894e-8,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},2:{matrixId:"2",matrixHeight:4,matrixWidth:4,scaleDenominator:1397705660071793e-7,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},3:{matrixId:"3",matrixHeight:8,matrixWidth:8,scaleDenominator:6988528300358965e-8,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},4:{matrixId:"4",matrixHeight:16,matrixWidth:16,scaleDenominator:3494264150179486e-8,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},5:{matrixId:"5",matrixHeight:32,matrixWidth:32,scaleDenominator:1747132075089743e-8,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},6:{matrixId:"6",matrixHeight:64,matrixWidth:64,scaleDenominator:8735660375448715e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},7:{matrixId:"7",matrixHeight:128,matrixWidth:128,scaleDenominator:4.3678301877243575e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},8:{matrixId:"8",matrixHeight:256,matrixWidth:256,scaleDenominator:2.1839150938621787e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},9:{matrixId:"9",matrixHeight:512,matrixWidth:512,scaleDenominator:1.0919575469310894e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},10:{matrixId:"10",matrixHeight:1024,matrixWidth:1024,scaleDenominator:545978.7734655464,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},11:{matrixId:"11",matrixHeight:2048,matrixWidth:2048,scaleDenominator:272989.38673277217,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},12:{matrixId:"12",matrixHeight:4096,matrixWidth:4096,scaleDenominator:136494.69336638608,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},13:{matrixId:"13",matrixHeight:8192,matrixWidth:8192,scaleDenominator:68247.34668319322,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},14:{matrixId:"14",matrixHeight:16384,matrixWidth:16384,scaleDenominator:34123.673341596535,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},15:{matrixId:"15",matrixHeight:32768,matrixWidth:32768,scaleDenominator:17061.83667079829,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},16:{matrixId:"16",matrixHeight:65536,matrixWidth:65536,scaleDenominator:8530.918335399145,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},17:{matrixId:"17",matrixHeight:131072,matrixWidth:131072,scaleDenominator:4265.459167699572,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},18:{matrixId:"18",matrixHeight:262144,matrixWidth:262144,scaleDenominator:2132.7295838497826,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}}}},PM_0_19={projection:"EPSG:3857",nativeResolutions:["156543.0339280410","78271.51696402048","39135.75848201023","19567.87924100512","9783.939620502561","4891.969810251280","2445.984905125640","1222.992452562820","611.4962262814100","305.7481131407048","152.8740565703525","76.43702828517624","38.21851414258813","19.10925707129406","9.554628535647032","4.777314267823516","2.388657133911758","1.194328566955879","0.5971642834779395","0.2985821417389697"],tileMatrices:{0:{matrixId:"0",matrixHeight:1,matrixWidth:1,scaleDenominator:5590822640287179e-7,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},1:{matrixId:"1",matrixHeight:2,matrixWidth:2,scaleDenominator:27954113201435894e-8,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},2:{matrixId:"2",matrixHeight:4,matrixWidth:4,scaleDenominator:1397705660071793e-7,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},3:{matrixId:"3",matrixHeight:8,matrixWidth:8,scaleDenominator:6988528300358965e-8,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},4:{matrixId:"4",matrixHeight:16,matrixWidth:16,scaleDenominator:3494264150179486e-8,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},5:{matrixId:"5",matrixHeight:32,matrixWidth:32,scaleDenominator:1747132075089743e-8,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},6:{matrixId:"6",matrixHeight:64,matrixWidth:64,scaleDenominator:8735660375448715e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},7:{matrixId:"7",matrixHeight:128,matrixWidth:128,scaleDenominator:4.3678301877243575e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},8:{matrixId:"8",matrixHeight:256,matrixWidth:256,scaleDenominator:2.1839150938621787e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},9:{matrixId:"9",matrixHeight:512,matrixWidth:512,scaleDenominator:1.0919575469310894e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},10:{matrixId:"10",matrixHeight:1024,matrixWidth:1024,scaleDenominator:545978.7734655464,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},11:{matrixId:"11",matrixHeight:2048,matrixWidth:2048,scaleDenominator:272989.38673277217,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},12:{matrixId:"12",matrixHeight:4096,matrixWidth:4096,scaleDenominator:136494.69336638608,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},13:{matrixId:"13",matrixHeight:8192,matrixWidth:8192,scaleDenominator:68247.34668319322,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},14:{matrixId:"14",matrixHeight:16384,matrixWidth:16384,scaleDenominator:34123.673341596535,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},15:{matrixId:"15",matrixHeight:32768,matrixWidth:32768,scaleDenominator:17061.83667079829,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},16:{matrixId:"16",matrixHeight:65536,matrixWidth:65536,scaleDenominator:8530.918335399145,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},17:{matrixId:"17",matrixHeight:131072,matrixWidth:131072,scaleDenominator:4265.459167699572,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},18:{matrixId:"18",matrixHeight:262144,matrixWidth:262144,scaleDenominator:2132.7295838497826,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},19:{matrixId:"19",matrixHeight:524288,matrixWidth:524288,scaleDenominator:1066.364791924893,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}}}},PM_0_21={projection:"EPSG:3857",nativeResolutions:["156543.0339280410","78271.51696402048","39135.75848201023","19567.87924100512","9783.939620502561","4891.969810251280","2445.984905125640","1222.992452562820","611.4962262814100","305.7481131407048","152.8740565703525","76.43702828517624","38.21851414258813","19.10925707129406","9.554628535647032","4.777314267823516","2.388657133911758","1.194328566955879","0.5971642834779395","0.2985821417389697","0.1492910708694849","0.0746455354347424"],tileMatrices:{0:{matrixId:"0",matrixHeight:1,matrixWidth:1,scaleDenominator:5590822640287179e-7,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},1:{matrixId:"1",matrixHeight:2,matrixWidth:2,scaleDenominator:27954113201435894e-8,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},2:{matrixId:"2",matrixHeight:4,matrixWidth:4,scaleDenominator:1397705660071793e-7,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},3:{matrixId:"3",matrixHeight:8,matrixWidth:8,scaleDenominator:6988528300358965e-8,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},4:{matrixId:"4",matrixHeight:16,matrixWidth:16,scaleDenominator:3494264150179486e-8,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},5:{matrixId:"5",matrixHeight:32,matrixWidth:32,scaleDenominator:1747132075089743e-8,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},6:{matrixId:"6",matrixHeight:64,matrixWidth:64,scaleDenominator:8735660375448715e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},7:{matrixId:"7",matrixHeight:128,matrixWidth:128,scaleDenominator:4.3678301877243575e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},8:{matrixId:"8",matrixHeight:256,matrixWidth:256,scaleDenominator:2.1839150938621787e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},9:{matrixId:"9",matrixHeight:512,matrixWidth:512,scaleDenominator:1.0919575469310894e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},10:{matrixId:"10",matrixHeight:1024,matrixWidth:1024,scaleDenominator:545978.7734655464,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},11:{matrixId:"11",matrixHeight:2048,matrixWidth:2048,scaleDenominator:272989.38673277217,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},12:{matrixId:"12",matrixHeight:4096,matrixWidth:4096,scaleDenominator:136494.69336638608,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},13:{matrixId:"13",matrixHeight:8192,matrixWidth:8192,scaleDenominator:68247.34668319322,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},14:{matrixId:"14",matrixHeight:16384,matrixWidth:16384,scaleDenominator:34123.673341596535,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},15:{matrixId:"15",matrixHeight:32768,matrixWidth:32768,scaleDenominator:17061.83667079829,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},16:{matrixId:"16",matrixHeight:65536,matrixWidth:65536,scaleDenominator:8530.918335399145,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},17:{matrixId:"17",matrixHeight:131072,matrixWidth:131072,scaleDenominator:4265.459167699572,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},18:{matrixId:"18",matrixHeight:262144,matrixWidth:262144,scaleDenominator:2132.7295838497826,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},19:{matrixId:"19",matrixHeight:524288,matrixWidth:524288,scaleDenominator:1066.364791924893,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},20:{matrixId:"20",matrixHeight:1048576,matrixWidth:1048576,scaleDenominator:533.1823959624465,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},21:{matrixId:"21",matrixHeight:2097152,matrixWidth:2097152,scaleDenominator:266.5911979812229,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}}}},PM_0_6={projection:"EPSG:3857",nativeResolutions:["156543.0339280410","78271.51696402048","39135.75848201023","19567.87924100512","9783.939620502561","4891.969810251280","2445.984905125640"],tileMatrices:{0:{matrixId:"0",matrixHeight:1,matrixWidth:1,scaleDenominator:5590822640287179e-7,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},1:{matrixId:"1",matrixHeight:2,matrixWidth:2,scaleDenominator:27954113201435894e-8,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},2:{matrixId:"2",matrixHeight:4,matrixWidth:4,scaleDenominator:1397705660071793e-7,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},3:{matrixId:"3",matrixHeight:8,matrixWidth:8,scaleDenominator:6988528300358965e-8,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},4:{matrixId:"4",matrixHeight:16,matrixWidth:16,scaleDenominator:3494264150179486e-8,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},5:{matrixId:"5",matrixHeight:32,matrixWidth:32,scaleDenominator:1747132075089743e-8,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},6:{matrixId:"6",matrixHeight:64,matrixWidth:64,scaleDenominator:8735660375448715e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}}}},PM_0_8={projection:"EPSG:3857",nativeResolutions:["156543.0339280410","78271.51696402048","39135.75848201023","19567.87924100512","9783.939620502561","4891.969810251280","2445.984905125640","1222.992452562820","611.4962262814100"],tileMatrices:{0:{matrixId:"0",matrixHeight:1,matrixWidth:1,scaleDenominator:5590822640287179e-7,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},1:{matrixId:"1",matrixHeight:2,matrixWidth:2,scaleDenominator:27954113201435894e-8,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},2:{matrixId:"2",matrixHeight:4,matrixWidth:4,scaleDenominator:1397705660071793e-7,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},3:{matrixId:"3",matrixHeight:8,matrixWidth:8,scaleDenominator:6988528300358965e-8,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},4:{matrixId:"4",matrixHeight:16,matrixWidth:16,scaleDenominator:3494264150179486e-8,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},5:{matrixId:"5",matrixHeight:32,matrixWidth:32,scaleDenominator:1747132075089743e-8,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},6:{matrixId:"6",matrixHeight:64,matrixWidth:64,scaleDenominator:8735660375448715e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},7:{matrixId:"7",matrixHeight:128,matrixWidth:128,scaleDenominator:4.3678301877243575e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},8:{matrixId:"8",matrixHeight:256,matrixWidth:256,scaleDenominator:2.1839150938621787e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}}}},PM_10_12={projection:"EPSG:3857",nativeResolutions:["152.8740565703525","76.43702828517624","38.21851414258813"],tileMatrices:{10:{matrixId:"10",matrixHeight:1024,matrixWidth:1024,scaleDenominator:545978.7734655464,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},11:{matrixId:"11",matrixHeight:2048,matrixWidth:2048,scaleDenominator:272989.38673277217,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},12:{matrixId:"12",matrixHeight:4096,matrixWidth:4096,scaleDenominator:136494.69336638608,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}}}},PM_15_18={projection:"EPSG:3857",nativeResolutions:["4.777314267823516","2.388657133911758","1.194328566955879","0.5971642834779395"],tileMatrices:{15:{matrixId:"15",matrixHeight:32768,matrixWidth:32768,scaleDenominator:17061.83667079829,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},16:{matrixId:"16",matrixHeight:65536,matrixWidth:65536,scaleDenominator:8530.918335399145,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},17:{matrixId:"17",matrixHeight:131072,matrixWidth:131072,scaleDenominator:4265.459167699572,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},18:{matrixId:"18",matrixHeight:262144,matrixWidth:262144,scaleDenominator:2132.7295838497826,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}}}},PM_3_15={projection:"EPSG:3857",nativeResolutions:["19567.87924100512","9783.939620502561","4891.969810251280","2445.984905125640","1222.992452562820","611.4962262814100","305.7481131407048","152.8740565703525","76.43702828517624","38.21851414258813","19.10925707129406","9.554628535647032","4.777314267823516"],tileMatrices:{3:{matrixId:"3",matrixHeight:8,matrixWidth:8,scaleDenominator:6988528300358965e-8,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},4:{matrixId:"4",matrixHeight:16,matrixWidth:16,scaleDenominator:3494264150179486e-8,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},5:{matrixId:"5",matrixHeight:32,matrixWidth:32,scaleDenominator:1747132075089743e-8,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},6:{matrixId:"6",matrixHeight:64,matrixWidth:64,scaleDenominator:8735660375448715e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},7:{matrixId:"7",matrixHeight:128,matrixWidth:128,scaleDenominator:4.3678301877243575e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},8:{matrixId:"8",matrixHeight:256,matrixWidth:256,scaleDenominator:2.1839150938621787e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},9:{matrixId:"9",matrixHeight:512,matrixWidth:512,scaleDenominator:1.0919575469310894e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},10:{matrixId:"10",matrixHeight:1024,matrixWidth:1024,scaleDenominator:545978.7734655464,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},11:{matrixId:"11",matrixHeight:2048,matrixWidth:2048,scaleDenominator:272989.38673277217,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},12:{matrixId:"12",matrixHeight:4096,matrixWidth:4096,scaleDenominator:136494.69336638608,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},13:{matrixId:"13",matrixHeight:8192,matrixWidth:8192,scaleDenominator:68247.34668319322,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},14:{matrixId:"14",matrixHeight:16384,matrixWidth:16384,scaleDenominator:34123.673341596535,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},15:{matrixId:"15",matrixHeight:32768,matrixWidth:32768,scaleDenominator:17061.83667079829,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}}}},PM_4_10={projection:"EPSG:3857",nativeResolutions:["9783.939620502561","4891.969810251280","2445.984905125640","1222.992452562820","611.4962262814100","305.7481131407048","152.8740565703525"],tileMatrices:{4:{matrixId:"4",matrixHeight:16,matrixWidth:16,scaleDenominator:3494264150179486e-8,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},5:{matrixId:"5",matrixHeight:32,matrixWidth:32,scaleDenominator:1747132075089743e-8,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},6:{matrixId:"6",matrixHeight:64,matrixWidth:64,scaleDenominator:8735660375448715e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},7:{matrixId:"7",matrixHeight:128,matrixWidth:128,scaleDenominator:4.3678301877243575e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},8:{matrixId:"8",matrixHeight:256,matrixWidth:256,scaleDenominator:2.1839150938621787e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},9:{matrixId:"9",matrixHeight:512,matrixWidth:512,scaleDenominator:1.0919575469310894e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},10:{matrixId:"10",matrixHeight:1024,matrixWidth:1024,scaleDenominator:545978.7734655464,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}}}},PM_4_18={projection:"EPSG:3857",nativeResolutions:["9783.939620502561","4891.969810251280","2445.984905125640","1222.992452562820","611.4962262814100","305.7481131407048","152.8740565703525","76.43702828517624","38.21851414258813","19.10925707129406","9.554628535647032","4.777314267823516","2.388657133911758","1.194328566955879","0.5971642834779395"],tileMatrices:{4:{matrixId:"4",matrixHeight:16,matrixWidth:16,scaleDenominator:3494264150179486e-8,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},5:{matrixId:"5",matrixHeight:32,matrixWidth:32,scaleDenominator:1747132075089743e-8,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},6:{matrixId:"6",matrixHeight:64,matrixWidth:64,scaleDenominator:8735660375448715e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},7:{matrixId:"7",matrixHeight:128,matrixWidth:128,scaleDenominator:4.3678301877243575e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},8:{matrixId:"8",matrixHeight:256,matrixWidth:256,scaleDenominator:2.1839150938621787e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},9:{matrixId:"9",matrixHeight:512,matrixWidth:512,scaleDenominator:1.0919575469310894e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},10:{matrixId:"10",matrixHeight:1024,matrixWidth:1024,scaleDenominator:545978.7734655464,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},11:{matrixId:"11",matrixHeight:2048,matrixWidth:2048,scaleDenominator:272989.38673277217,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},12:{matrixId:"12",matrixHeight:4096,matrixWidth:4096,scaleDenominator:136494.69336638608,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},13:{matrixId:"13",matrixHeight:8192,matrixWidth:8192,scaleDenominator:68247.34668319322,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},14:{matrixId:"14",matrixHeight:16384,matrixWidth:16384,scaleDenominator:34123.673341596535,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},15:{matrixId:"15",matrixHeight:32768,matrixWidth:32768,scaleDenominator:17061.83667079829,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},16:{matrixId:"16",matrixHeight:65536,matrixWidth:65536,scaleDenominator:8530.918335399145,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},17:{matrixId:"17",matrixHeight:131072,matrixWidth:131072,scaleDenominator:4265.459167699572,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},18:{matrixId:"18",matrixHeight:262144,matrixWidth:262144,scaleDenominator:2132.7295838497826,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}}}},PM_4_19={projection:"EPSG:3857",nativeResolutions:["9783.939620502561","4891.969810251280","2445.984905125640","1222.992452562820","611.4962262814100","305.7481131407048","152.8740565703525","76.43702828517624","38.21851414258813","19.10925707129406","9.554628535647032","4.777314267823516","2.388657133911758","1.194328566955879","0.5971642834779395","0.2985821417389697"],tileMatrices:{4:{matrixId:"4",matrixHeight:16,matrixWidth:16,scaleDenominator:3494264150179486e-8,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},5:{matrixId:"5",matrixHeight:32,matrixWidth:32,scaleDenominator:1747132075089743e-8,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},6:{matrixId:"6",matrixHeight:64,matrixWidth:64,scaleDenominator:8735660375448715e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},7:{matrixId:"7",matrixHeight:128,matrixWidth:128,scaleDenominator:4.3678301877243575e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},8:{matrixId:"8",matrixHeight:256,matrixWidth:256,scaleDenominator:2.1839150938621787e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},9:{matrixId:"9",matrixHeight:512,matrixWidth:512,scaleDenominator:1.0919575469310894e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},10:{matrixId:"10",matrixHeight:1024,matrixWidth:1024,scaleDenominator:545978.7734655464,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},11:{matrixId:"11",matrixHeight:2048,matrixWidth:2048,scaleDenominator:272989.38673277217,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},12:{matrixId:"12",matrixHeight:4096,matrixWidth:4096,scaleDenominator:136494.69336638608,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},13:{matrixId:"13",matrixHeight:8192,matrixWidth:8192,scaleDenominator:68247.34668319322,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},14:{matrixId:"14",matrixHeight:16384,matrixWidth:16384,scaleDenominator:34123.673341596535,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},15:{matrixId:"15",matrixHeight:32768,matrixWidth:32768,scaleDenominator:17061.83667079829,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},16:{matrixId:"16",matrixHeight:65536,matrixWidth:65536,scaleDenominator:8530.918335399145,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},17:{matrixId:"17",matrixHeight:131072,matrixWidth:131072,scaleDenominator:4265.459167699572,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},18:{matrixId:"18",matrixHeight:262144,matrixWidth:262144,scaleDenominator:2132.7295838497826,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},19:{matrixId:"19",matrixHeight:524288,matrixWidth:524288,scaleDenominator:1066.364791924893,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}}}},PM_6_11={projection:"EPSG:3857",nativeResolutions:["2445.984905125640","1222.992452562820","611.4962262814100","305.7481131407048","152.8740565703525","76.43702828517624"],tileMatrices:{6:{matrixId:"6",matrixHeight:64,matrixWidth:64,scaleDenominator:8735660375448715e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},7:{matrixId:"7",matrixHeight:128,matrixWidth:128,scaleDenominator:4.3678301877243575e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},8:{matrixId:"8",matrixHeight:256,matrixWidth:256,scaleDenominator:2.1839150938621787e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},9:{matrixId:"9",matrixHeight:512,matrixWidth:512,scaleDenominator:1.0919575469310894e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},10:{matrixId:"10",matrixHeight:1024,matrixWidth:1024,scaleDenominator:545978.7734655464,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},11:{matrixId:"11",matrixHeight:2048,matrixWidth:2048,scaleDenominator:272989.38673277217,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}}}},PM_6_14={projection:"EPSG:3857",nativeResolutions:["2445.984905125640","1222.992452562820","611.4962262814100","305.7481131407048","152.8740565703525","76.43702828517624","38.21851414258813","19.10925707129406","9.554628535647032"],tileMatrices:{6:{matrixId:"6",matrixHeight:64,matrixWidth:64,scaleDenominator:8735660375448715e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},7:{matrixId:"7",matrixHeight:128,matrixWidth:128,scaleDenominator:4.3678301877243575e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},8:{matrixId:"8",matrixHeight:256,matrixWidth:256,scaleDenominator:2.1839150938621787e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},9:{matrixId:"9",matrixHeight:512,matrixWidth:512,scaleDenominator:1.0919575469310894e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},10:{matrixId:"10",matrixHeight:1024,matrixWidth:1024,scaleDenominator:545978.7734655464,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},11:{matrixId:"11",matrixHeight:2048,matrixWidth:2048,scaleDenominator:272989.38673277217,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},12:{matrixId:"12",matrixHeight:4096,matrixWidth:4096,scaleDenominator:136494.69336638608,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},13:{matrixId:"13",matrixHeight:8192,matrixWidth:8192,scaleDenominator:68247.34668319322,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},14:{matrixId:"14",matrixHeight:16384,matrixWidth:16384,scaleDenominator:34123.673341596535,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}}}},PM_6_15={projection:"EPSG:3857",nativeResolutions:["2445.984905125640","1222.992452562820","611.4962262814100","305.7481131407048","152.8740565703525","76.43702828517624","38.21851414258813","19.10925707129406","9.554628535647032","4.777314267823516"],tileMatrices:{6:{matrixId:"6",matrixHeight:64,matrixWidth:64,scaleDenominator:8735660375448715e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},7:{matrixId:"7",matrixHeight:128,matrixWidth:128,scaleDenominator:4.3678301877243575e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},8:{matrixId:"8",matrixHeight:256,matrixWidth:256,scaleDenominator:2.1839150938621787e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},9:{matrixId:"9",matrixHeight:512,matrixWidth:512,scaleDenominator:1.0919575469310894e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},10:{matrixId:"10",matrixHeight:1024,matrixWidth:1024,scaleDenominator:545978.7734655464,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},11:{matrixId:"11",matrixHeight:2048,matrixWidth:2048,scaleDenominator:272989.38673277217,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},12:{matrixId:"12",matrixHeight:4096,matrixWidth:4096,scaleDenominator:136494.69336638608,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},13:{matrixId:"13",matrixHeight:8192,matrixWidth:8192,scaleDenominator:68247.34668319322,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},14:{matrixId:"14",matrixHeight:16384,matrixWidth:16384,scaleDenominator:34123.673341596535,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},15:{matrixId:"15",matrixHeight:32768,matrixWidth:32768,scaleDenominator:17061.83667079829,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}}}},PM_6_16={projection:"EPSG:3857",nativeResolutions:["2445.984905125640","1222.992452562820","611.4962262814100","305.7481131407048","152.8740565703525","76.43702828517624","38.21851414258813","19.10925707129406","9.554628535647032","4.777314267823516","2.388657133911758"],tileMatrices:{6:{matrixId:"6",matrixHeight:64,matrixWidth:64,scaleDenominator:8735660375448715e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},7:{matrixId:"7",matrixHeight:128,matrixWidth:128,scaleDenominator:4.3678301877243575e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},8:{matrixId:"8",matrixHeight:256,matrixWidth:256,scaleDenominator:2.1839150938621787e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},9:{matrixId:"9",matrixHeight:512,matrixWidth:512,scaleDenominator:1.0919575469310894e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},10:{matrixId:"10",matrixHeight:1024,matrixWidth:1024,scaleDenominator:545978.7734655464,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},11:{matrixId:"11",matrixHeight:2048,matrixWidth:2048,scaleDenominator:272989.38673277217,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},12:{matrixId:"12",matrixHeight:4096,matrixWidth:4096,scaleDenominator:136494.69336638608,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},13:{matrixId:"13",matrixHeight:8192,matrixWidth:8192,scaleDenominator:68247.34668319322,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},14:{matrixId:"14",matrixHeight:16384,matrixWidth:16384,scaleDenominator:34123.673341596535,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},15:{matrixId:"15",matrixHeight:32768,matrixWidth:32768,scaleDenominator:17061.83667079829,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},16:{matrixId:"16",matrixHeight:65536,matrixWidth:65536,scaleDenominator:8530.918335399145,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}}}},PM_6_17={projection:"EPSG:3857",nativeResolutions:["2445.984905125640","1222.992452562820","611.4962262814100","305.7481131407048","152.8740565703525","76.43702828517624","38.21851414258813","19.10925707129406","9.554628535647032","4.777314267823516","2.388657133911758","1.194328566955879"],tileMatrices:{6:{matrixId:"6",matrixHeight:64,matrixWidth:64,scaleDenominator:8735660375448715e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},7:{matrixId:"7",matrixHeight:128,matrixWidth:128,scaleDenominator:4.3678301877243575e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},8:{matrixId:"8",matrixHeight:256,matrixWidth:256,scaleDenominator:2.1839150938621787e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},9:{matrixId:"9",matrixHeight:512,matrixWidth:512,scaleDenominator:1.0919575469310894e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},10:{matrixId:"10",matrixHeight:1024,matrixWidth:1024,scaleDenominator:545978.7734655464,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},11:{matrixId:"11",matrixHeight:2048,matrixWidth:2048,scaleDenominator:272989.38673277217,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},12:{matrixId:"12",matrixHeight:4096,matrixWidth:4096,scaleDenominator:136494.69336638608,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},13:{matrixId:"13",matrixHeight:8192,matrixWidth:8192,scaleDenominator:68247.34668319322,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},14:{matrixId:"14",matrixHeight:16384,matrixWidth:16384,scaleDenominator:34123.673341596535,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},15:{matrixId:"15",matrixHeight:32768,matrixWidth:32768,scaleDenominator:17061.83667079829,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},16:{matrixId:"16",matrixHeight:65536,matrixWidth:65536,scaleDenominator:8530.918335399145,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},17:{matrixId:"17",matrixHeight:131072,matrixWidth:131072,scaleDenominator:4265.459167699572,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}}}},PM_6_18={projection:"EPSG:3857",nativeResolutions:["2445.984905125640","1222.992452562820","611.4962262814100","305.7481131407048","152.8740565703525","76.43702828517624","38.21851414258813","19.10925707129406","9.554628535647032","4.777314267823516","2.388657133911758","1.194328566955879","0.5971642834779395"],tileMatrices:{6:{matrixId:"6",matrixHeight:64,matrixWidth:64,scaleDenominator:8735660375448715e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},7:{matrixId:"7",matrixHeight:128,matrixWidth:128,scaleDenominator:4.3678301877243575e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},8:{matrixId:"8",matrixHeight:256,matrixWidth:256,scaleDenominator:2.1839150938621787e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},9:{matrixId:"9",matrixHeight:512,matrixWidth:512,scaleDenominator:1.0919575469310894e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},10:{matrixId:"10",matrixHeight:1024,matrixWidth:1024,scaleDenominator:545978.7734655464,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},11:{matrixId:"11",matrixHeight:2048,matrixWidth:2048,scaleDenominator:272989.38673277217,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},12:{matrixId:"12",matrixHeight:4096,matrixWidth:4096,scaleDenominator:136494.69336638608,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},13:{matrixId:"13",matrixHeight:8192,matrixWidth:8192,scaleDenominator:68247.34668319322,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},14:{matrixId:"14",matrixHeight:16384,matrixWidth:16384,scaleDenominator:34123.673341596535,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},15:{matrixId:"15",matrixHeight:32768,matrixWidth:32768,scaleDenominator:17061.83667079829,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},16:{matrixId:"16",matrixHeight:65536,matrixWidth:65536,scaleDenominator:8530.918335399145,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},17:{matrixId:"17",matrixHeight:131072,matrixWidth:131072,scaleDenominator:4265.459167699572,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},18:{matrixId:"18",matrixHeight:262144,matrixWidth:262144,scaleDenominator:2132.7295838497826,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}}}},PM_6_19={projection:"EPSG:3857",nativeResolutions:["2445.984905125640","1222.992452562820","611.4962262814100","305.7481131407048","152.8740565703525","76.43702828517624","38.21851414258813","19.10925707129406","9.554628535647032","4.777314267823516","2.388657133911758","1.194328566955879","0.5971642834779395","0.2985821417389697"],tileMatrices:{6:{matrixId:"6",matrixHeight:64,matrixWidth:64,scaleDenominator:8735660375448715e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},7:{matrixId:"7",matrixHeight:128,matrixWidth:128,scaleDenominator:4.3678301877243575e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},8:{matrixId:"8",matrixHeight:256,matrixWidth:256,scaleDenominator:2.1839150938621787e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},9:{matrixId:"9",matrixHeight:512,matrixWidth:512,scaleDenominator:1.0919575469310894e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},10:{matrixId:"10",matrixHeight:1024,matrixWidth:1024,scaleDenominator:545978.7734655464,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},11:{matrixId:"11",matrixHeight:2048,matrixWidth:2048,scaleDenominator:272989.38673277217,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},12:{matrixId:"12",matrixHeight:4096,matrixWidth:4096,scaleDenominator:136494.69336638608,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},13:{matrixId:"13",matrixHeight:8192,matrixWidth:8192,scaleDenominator:68247.34668319322,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},14:{matrixId:"14",matrixHeight:16384,matrixWidth:16384,scaleDenominator:34123.673341596535,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},15:{matrixId:"15",matrixHeight:32768,matrixWidth:32768,scaleDenominator:17061.83667079829,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},16:{matrixId:"16",matrixHeight:65536,matrixWidth:65536,scaleDenominator:8530.918335399145,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},17:{matrixId:"17",matrixHeight:131072,matrixWidth:131072,scaleDenominator:4265.459167699572,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},18:{matrixId:"18",matrixHeight:262144,matrixWidth:262144,scaleDenominator:2132.7295838497826,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},19:{matrixId:"19",matrixHeight:524288,matrixWidth:524288,scaleDenominator:1066.364791924893,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}}}},PM_6_21={projection:"EPSG:3857",nativeResolutions:["2445.984905125640","1222.992452562820","611.4962262814100","305.7481131407048","152.8740565703525","76.43702828517624","38.21851414258813","19.10925707129406","9.554628535647032","4.777314267823516","2.388657133911758","1.194328566955879","0.5971642834779395","0.2985821417389697","0.1492910708694849","0.0746455354347424"],tileMatrices:{6:{matrixId:"6",matrixHeight:64,matrixWidth:64,scaleDenominator:8735660375448715e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},7:{matrixId:"7",matrixHeight:128,matrixWidth:128,scaleDenominator:4.3678301877243575e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},8:{matrixId:"8",matrixHeight:256,matrixWidth:256,scaleDenominator:2.1839150938621787e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},9:{matrixId:"9",matrixHeight:512,matrixWidth:512,scaleDenominator:1.0919575469310894e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},10:{matrixId:"10",matrixHeight:1024,matrixWidth:1024,scaleDenominator:545978.7734655464,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},11:{matrixId:"11",matrixHeight:2048,matrixWidth:2048,scaleDenominator:272989.38673277217,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},12:{matrixId:"12",matrixHeight:4096,matrixWidth:4096,scaleDenominator:136494.69336638608,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},13:{matrixId:"13",matrixHeight:8192,matrixWidth:8192,scaleDenominator:68247.34668319322,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},14:{matrixId:"14",matrixHeight:16384,matrixWidth:16384,scaleDenominator:34123.673341596535,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},15:{matrixId:"15",matrixHeight:32768,matrixWidth:32768,scaleDenominator:17061.83667079829,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},16:{matrixId:"16",matrixHeight:65536,matrixWidth:65536,scaleDenominator:8530.918335399145,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},17:{matrixId:"17",matrixHeight:131072,matrixWidth:131072,scaleDenominator:4265.459167699572,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},18:{matrixId:"18",matrixHeight:262144,matrixWidth:262144,scaleDenominator:2132.7295838497826,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},19:{matrixId:"19",matrixHeight:524288,matrixWidth:524288,scaleDenominator:1066.364791924893,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},20:{matrixId:"20",matrixHeight:1048576,matrixWidth:1048576,scaleDenominator:533.1823959624465,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},21:{matrixId:"21",matrixHeight:2097152,matrixWidth:2097152,scaleDenominator:266.5911979812229,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}}}},PM_6_9={projection:"EPSG:3857",nativeResolutions:["2445.984905125640","1222.992452562820","611.4962262814100","305.7481131407048"],tileMatrices:{6:{matrixId:"6",matrixHeight:64,matrixWidth:64,scaleDenominator:8735660375448715e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},7:{matrixId:"7",matrixHeight:128,matrixWidth:128,scaleDenominator:4.3678301877243575e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},8:{matrixId:"8",matrixHeight:256,matrixWidth:256,scaleDenominator:2.1839150938621787e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},9:{matrixId:"9",matrixHeight:512,matrixWidth:512,scaleDenominator:1.0919575469310894e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}}}},PM_7_17={projection:"EPSG:3857",nativeResolutions:["1222.992452562820","611.4962262814100","305.7481131407048","152.8740565703525","76.43702828517624","38.21851414258813","19.10925707129406","9.554628535647032","4.777314267823516","2.388657133911758","1.194328566955879"],tileMatrices:{7:{matrixId:"7",matrixHeight:128,matrixWidth:128,scaleDenominator:4.3678301877243575e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},8:{matrixId:"8",matrixHeight:256,matrixWidth:256,scaleDenominator:2.1839150938621787e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},9:{matrixId:"9",matrixHeight:512,matrixWidth:512,scaleDenominator:1.0919575469310894e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},10:{matrixId:"10",matrixHeight:1024,matrixWidth:1024,scaleDenominator:545978.7734655464,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},11:{matrixId:"11",matrixHeight:2048,matrixWidth:2048,scaleDenominator:272989.38673277217,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},12:{matrixId:"12",matrixHeight:4096,matrixWidth:4096,scaleDenominator:136494.69336638608,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},13:{matrixId:"13",matrixHeight:8192,matrixWidth:8192,scaleDenominator:68247.34668319322,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},14:{matrixId:"14",matrixHeight:16384,matrixWidth:16384,scaleDenominator:34123.673341596535,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},15:{matrixId:"15",matrixHeight:32768,matrixWidth:32768,scaleDenominator:17061.83667079829,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},16:{matrixId:"16",matrixHeight:65536,matrixWidth:65536,scaleDenominator:8530.918335399145,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},17:{matrixId:"17",matrixHeight:131072,matrixWidth:131072,scaleDenominator:4265.459167699572,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}}}},PM_7_18={projection:"EPSG:3857",nativeResolutions:["1222.992452562820","611.4962262814100","305.7481131407048","152.8740565703525","76.43702828517624","38.21851414258813","19.10925707129406","9.554628535647032","4.777314267823516","2.388657133911758","1.194328566955879","0.5971642834779395"],tileMatrices:{7:{matrixId:"7",matrixHeight:128,matrixWidth:128,scaleDenominator:4.3678301877243575e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},8:{matrixId:"8",matrixHeight:256,matrixWidth:256,scaleDenominator:2.1839150938621787e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},9:{matrixId:"9",matrixHeight:512,matrixWidth:512,scaleDenominator:1.0919575469310894e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},10:{matrixId:"10",matrixHeight:1024,matrixWidth:1024,scaleDenominator:545978.7734655464,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},11:{matrixId:"11",matrixHeight:2048,matrixWidth:2048,scaleDenominator:272989.38673277217,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},12:{matrixId:"12",matrixHeight:4096,matrixWidth:4096,scaleDenominator:136494.69336638608,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},13:{matrixId:"13",matrixHeight:8192,matrixWidth:8192,scaleDenominator:68247.34668319322,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},14:{matrixId:"14",matrixHeight:16384,matrixWidth:16384,scaleDenominator:34123.673341596535,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},15:{matrixId:"15",matrixHeight:32768,matrixWidth:32768,scaleDenominator:17061.83667079829,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},16:{matrixId:"16",matrixHeight:65536,matrixWidth:65536,scaleDenominator:8530.918335399145,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},17:{matrixId:"17",matrixHeight:131072,matrixWidth:131072,scaleDenominator:4265.459167699572,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},18:{matrixId:"18",matrixHeight:262144,matrixWidth:262144,scaleDenominator:2132.7295838497826,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}}}},PM_9_16={projection:"EPSG:3857",nativeResolutions:["305.7481131407048","152.8740565703525","76.43702828517624","38.21851414258813","19.10925707129406","9.554628535647032","4.777314267823516","2.388657133911758"],tileMatrices:{9:{matrixId:"9",matrixHeight:512,matrixWidth:512,scaleDenominator:1.0919575469310894e6,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},10:{matrixId:"10",matrixHeight:1024,matrixWidth:1024,scaleDenominator:545978.7734655464,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},11:{matrixId:"11",matrixHeight:2048,matrixWidth:2048,scaleDenominator:272989.38673277217,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},12:{matrixId:"12",matrixHeight:4096,matrixWidth:4096,scaleDenominator:136494.69336638608,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},13:{matrixId:"13",matrixHeight:8192,matrixWidth:8192,scaleDenominator:68247.34668319322,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},14:{matrixId:"14",matrixHeight:16384,matrixWidth:16384,scaleDenominator:34123.673341596535,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},15:{matrixId:"15",matrixHeight:32768,matrixWidth:32768,scaleDenominator:17061.83667079829,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}},16:{matrixId:"16",matrixHeight:65536,matrixWidth:65536,scaleDenominator:8530.918335399145,tileHeight:256,tileWidth:256,topLeftCorner:{x:-200375083427892e-7,y:200375083427892e-7}}}},TMS={"2154_10cm":{projection:"EPSG:2154",nativeResolutions:["209715.2","104857.6","52428.8","26214.4","13107.2","6553.6","3276.8","1638.4","819.2","409.6","204.8","102.4","51.2","25.6","12.8","6.4","3.2","1.6","0.8","0.4","0.2","0.1"],tileMatrices:{0:{matrixId:"0",matrixHeight:1,matrixWidth:1,scaleDenominator:7489828571428572e-7,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},1:{matrixId:"1",matrixHeight:1,matrixWidth:1,scaleDenominator:3744914285714286e-7,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},2:{matrixId:"2",matrixHeight:1,matrixWidth:1,scaleDenominator:1872457142857143e-7,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},3:{matrixId:"3",matrixHeight:2,matrixWidth:1,scaleDenominator:9362285714285715e-8,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},4:{matrixId:"4",matrixHeight:4,matrixWidth:1,scaleDenominator:46811428571428575e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},5:{matrixId:"5",matrixHeight:7,matrixWidth:1,scaleDenominator:23405714285714287e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},6:{matrixId:"6",matrixHeight:13,matrixWidth:2,scaleDenominator:11702857142857144e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},7:{matrixId:"7",matrixHeight:26,matrixWidth:4,scaleDenominator:5851428571428572e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},8:{matrixId:"8",matrixHeight:52,matrixWidth:7,scaleDenominator:2925714285714286e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},9:{matrixId:"9",matrixHeight:103,matrixWidth:13,scaleDenominator:1462857142857143e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},10:{matrixId:"10",matrixHeight:206,matrixWidth:25,scaleDenominator:731428.5714285715,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},11:{matrixId:"11",matrixHeight:411,matrixWidth:50,scaleDenominator:365714.28571428574,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},12:{matrixId:"12",matrixHeight:822,matrixWidth:99,scaleDenominator:182857.14285714287,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},13:{matrixId:"13",matrixHeight:1643,matrixWidth:197,scaleDenominator:91428.57142857143,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},14:{matrixId:"14",matrixHeight:3285,matrixWidth:394,scaleDenominator:45714.28571428572,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},15:{matrixId:"15",matrixHeight:6569,matrixWidth:788,scaleDenominator:22857.14285714286,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},16:{matrixId:"16",matrixHeight:13138,matrixWidth:1575,scaleDenominator:11428.57142857143,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},17:{matrixId:"17",matrixHeight:26276,matrixWidth:3150,scaleDenominator:5714.285714285715,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},18:{matrixId:"18",matrixHeight:52552,matrixWidth:6300,scaleDenominator:2857.1428571428573,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},19:{matrixId:"19",matrixHeight:105102,matrixWidth:12600,scaleDenominator:1428.5714285714287,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},20:{matrixId:"20",matrixHeight:210205,matrixWidth:25200,scaleDenominator:714.2857142857143,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},21:{matrixId:"21",matrixHeight:420409,matrixWidth:50400,scaleDenominator:357.14285714285717,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}}}},"2154_10cm_10_20":{projection:"EPSG:2154",nativeResolutions:["204.8","102.4","51.2","25.6","12.8","6.4","3.2","1.6","0.8","0.4","0.2"],tileMatrices:{10:{matrixId:"10",matrixHeight:206,matrixWidth:25,scaleDenominator:731428.5714285715,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},11:{matrixId:"11",matrixHeight:411,matrixWidth:50,scaleDenominator:365714.28571428574,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},12:{matrixId:"12",matrixHeight:822,matrixWidth:99,scaleDenominator:182857.14285714287,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},13:{matrixId:"13",matrixHeight:1643,matrixWidth:197,scaleDenominator:91428.57142857143,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},14:{matrixId:"14",matrixHeight:3285,matrixWidth:394,scaleDenominator:45714.28571428572,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},15:{matrixId:"15",matrixHeight:6569,matrixWidth:788,scaleDenominator:22857.14285714286,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},16:{matrixId:"16",matrixHeight:13138,matrixWidth:1575,scaleDenominator:11428.57142857143,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},17:{matrixId:"17",matrixHeight:26276,matrixWidth:3150,scaleDenominator:5714.285714285715,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},18:{matrixId:"18",matrixHeight:52552,matrixWidth:6300,scaleDenominator:2857.1428571428573,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},19:{matrixId:"19",matrixHeight:105102,matrixWidth:12600,scaleDenominator:1428.5714285714287,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},20:{matrixId:"20",matrixHeight:210205,matrixWidth:25200,scaleDenominator:714.2857142857143,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}}}},"2154_10cm_6_19":{projection:"EPSG:2154",nativeResolutions:["3276.8","1638.4","819.2","409.6","204.8","102.4","51.2","25.6","12.8","6.4","3.2","1.6","0.8","0.4"],tileMatrices:{6:{matrixId:"6",matrixHeight:13,matrixWidth:2,scaleDenominator:11702857142857144e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},7:{matrixId:"7",matrixHeight:26,matrixWidth:4,scaleDenominator:5851428571428572e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},8:{matrixId:"8",matrixHeight:52,matrixWidth:7,scaleDenominator:2925714285714286e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},9:{matrixId:"9",matrixHeight:103,matrixWidth:13,scaleDenominator:1462857142857143e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},10:{matrixId:"10",matrixHeight:206,matrixWidth:25,scaleDenominator:731428.5714285715,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},11:{matrixId:"11",matrixHeight:411,matrixWidth:50,scaleDenominator:365714.28571428574,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},12:{matrixId:"12",matrixHeight:822,matrixWidth:99,scaleDenominator:182857.14285714287,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},13:{matrixId:"13",matrixHeight:1643,matrixWidth:197,scaleDenominator:91428.57142857143,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},14:{matrixId:"14",matrixHeight:3285,matrixWidth:394,scaleDenominator:45714.28571428572,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},15:{matrixId:"15",matrixHeight:6569,matrixWidth:788,scaleDenominator:22857.14285714286,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},16:{matrixId:"16",matrixHeight:13138,matrixWidth:1575,scaleDenominator:11428.57142857143,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},17:{matrixId:"17",matrixHeight:26276,matrixWidth:3150,scaleDenominator:5714.285714285715,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},18:{matrixId:"18",matrixHeight:52552,matrixWidth:6300,scaleDenominator:2857.1428571428573,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},19:{matrixId:"19",matrixHeight:105102,matrixWidth:12600,scaleDenominator:1428.5714285714287,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}}}},"2154_10cm_6_20":{projection:"EPSG:2154",nativeResolutions:["3276.8","1638.4","819.2","409.6","204.8","102.4","51.2","25.6","12.8","6.4","3.2","1.6","0.8","0.4","0.2"],tileMatrices:{6:{matrixId:"6",matrixHeight:13,matrixWidth:2,scaleDenominator:11702857142857144e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},7:{matrixId:"7",matrixHeight:26,matrixWidth:4,scaleDenominator:5851428571428572e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},8:{matrixId:"8",matrixHeight:52,matrixWidth:7,scaleDenominator:2925714285714286e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},9:{matrixId:"9",matrixHeight:103,matrixWidth:13,scaleDenominator:1462857142857143e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},10:{matrixId:"10",matrixHeight:206,matrixWidth:25,scaleDenominator:731428.5714285715,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},11:{matrixId:"11",matrixHeight:411,matrixWidth:50,scaleDenominator:365714.28571428574,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},12:{matrixId:"12",matrixHeight:822,matrixWidth:99,scaleDenominator:182857.14285714287,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},13:{matrixId:"13",matrixHeight:1643,matrixWidth:197,scaleDenominator:91428.57142857143,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},14:{matrixId:"14",matrixHeight:3285,matrixWidth:394,scaleDenominator:45714.28571428572,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},15:{matrixId:"15",matrixHeight:6569,matrixWidth:788,scaleDenominator:22857.14285714286,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},16:{matrixId:"16",matrixHeight:13138,matrixWidth:1575,scaleDenominator:11428.57142857143,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},17:{matrixId:"17",matrixHeight:26276,matrixWidth:3150,scaleDenominator:5714.285714285715,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},18:{matrixId:"18",matrixHeight:52552,matrixWidth:6300,scaleDenominator:2857.1428571428573,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},19:{matrixId:"19",matrixHeight:105102,matrixWidth:12600,scaleDenominator:1428.5714285714287,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},20:{matrixId:"20",matrixHeight:210205,matrixWidth:25200,scaleDenominator:714.2857142857143,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}}}},"2154_5cm":{projection:"EPSG:2154",nativeResolutions:["209715.2","104857.6","52428.8","26214.4","13107.2","6553.6","3276.8","1638.4","819.2","409.6","204.8","102.4","51.2","25.6","12.8","6.4","3.2","1.6","0.8","0.4","0.2","0.1","0.05"],tileMatrices:{0:{matrixId:"0",matrixHeight:1,matrixWidth:1,scaleDenominator:7489828571428572e-7,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},1:{matrixId:"1",matrixHeight:1,matrixWidth:1,scaleDenominator:3744914285714286e-7,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},2:{matrixId:"2",matrixHeight:1,matrixWidth:1,scaleDenominator:1872457142857143e-7,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},3:{matrixId:"3",matrixHeight:2,matrixWidth:1,scaleDenominator:9362285714285715e-8,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},4:{matrixId:"4",matrixHeight:4,matrixWidth:1,scaleDenominator:46811428571428575e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},5:{matrixId:"5",matrixHeight:7,matrixWidth:1,scaleDenominator:23405714285714287e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},6:{matrixId:"6",matrixHeight:13,matrixWidth:2,scaleDenominator:11702857142857144e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},7:{matrixId:"7",matrixHeight:26,matrixWidth:4,scaleDenominator:5851428571428572e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},8:{matrixId:"8",matrixHeight:52,matrixWidth:7,scaleDenominator:2925714285714286e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},9:{matrixId:"9",matrixHeight:103,matrixWidth:13,scaleDenominator:1462857142857143e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},10:{matrixId:"10",matrixHeight:206,matrixWidth:25,scaleDenominator:731428.5714285715,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},11:{matrixId:"11",matrixHeight:411,matrixWidth:50,scaleDenominator:365714.28571428574,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},12:{matrixId:"12",matrixHeight:822,matrixWidth:99,scaleDenominator:182857.14285714287,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},13:{matrixId:"13",matrixHeight:1643,matrixWidth:197,scaleDenominator:91428.57142857143,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},14:{matrixId:"14",matrixHeight:3285,matrixWidth:394,scaleDenominator:45714.28571428572,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},15:{matrixId:"15",matrixHeight:6569,matrixWidth:788,scaleDenominator:22857.14285714286,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},16:{matrixId:"16",matrixHeight:13138,matrixWidth:1575,scaleDenominator:11428.57142857143,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},17:{matrixId:"17",matrixHeight:26276,matrixWidth:3150,scaleDenominator:5714.285714285715,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},18:{matrixId:"18",matrixHeight:52552,matrixWidth:6300,scaleDenominator:2857.1428571428573,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},19:{matrixId:"19",matrixHeight:105102,matrixWidth:12600,scaleDenominator:1428.5714285714287,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},20:{matrixId:"20",matrixHeight:210205,matrixWidth:25200,scaleDenominator:714.2857142857143,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},21:{matrixId:"21",matrixHeight:420409,matrixWidth:50400,scaleDenominator:357.14285714285717,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},22:{matrixId:"22",matrixHeight:840818,matrixWidth:100800,scaleDenominator:178.57142857142858,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}}}},"2154_5cm_6_22":{projection:"EPSG:2154",nativeResolutions:["3276.8","1638.4","819.2","409.6","204.8","102.4","51.2","25.6","12.8","6.4","3.2","1.6","0.8","0.4","0.2","0.1","0.05"],tileMatrices:{6:{matrixId:"6",matrixHeight:13,matrixWidth:2,scaleDenominator:11702857142857144e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},7:{matrixId:"7",matrixHeight:26,matrixWidth:4,scaleDenominator:5851428571428572e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},8:{matrixId:"8",matrixHeight:52,matrixWidth:7,scaleDenominator:2925714285714286e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},9:{matrixId:"9",matrixHeight:103,matrixWidth:13,scaleDenominator:1462857142857143e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},10:{matrixId:"10",matrixHeight:206,matrixWidth:25,scaleDenominator:731428.5714285715,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},11:{matrixId:"11",matrixHeight:411,matrixWidth:50,scaleDenominator:365714.28571428574,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},12:{matrixId:"12",matrixHeight:822,matrixWidth:99,scaleDenominator:182857.14285714287,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},13:{matrixId:"13",matrixHeight:1643,matrixWidth:197,scaleDenominator:91428.57142857143,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},14:{matrixId:"14",matrixHeight:3285,matrixWidth:394,scaleDenominator:45714.28571428572,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},15:{matrixId:"15",matrixHeight:6569,matrixWidth:788,scaleDenominator:22857.14285714286,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},16:{matrixId:"16",matrixHeight:13138,matrixWidth:1575,scaleDenominator:11428.57142857143,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},17:{matrixId:"17",matrixHeight:26276,matrixWidth:3150,scaleDenominator:5714.285714285715,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},18:{matrixId:"18",matrixHeight:52552,matrixWidth:6300,scaleDenominator:2857.1428571428573,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},19:{matrixId:"19",matrixHeight:105102,matrixWidth:12600,scaleDenominator:1428.5714285714287,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},20:{matrixId:"20",matrixHeight:210205,matrixWidth:25200,scaleDenominator:714.2857142857143,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},21:{matrixId:"21",matrixHeight:420409,matrixWidth:50400,scaleDenominator:357.14285714285717,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},22:{matrixId:"22",matrixHeight:840818,matrixWidth:100800,scaleDenominator:178.57142857142858,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}}}},"LAMB93_2.5m":{projection:"IGNF:LAMB93",nativeResolutions:["163840","81920","40960","20480","10240","5120","2560","1280","640","320","160","80","40","20","10","5","2.5"],tileMatrices:{0:{matrixId:"0",matrixHeight:1,matrixWidth:1,scaleDenominator:5851428571428572e-7,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},1:{matrixId:"1",matrixHeight:1,matrixWidth:1,scaleDenominator:2925714285714286e-7,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},2:{matrixId:"2",matrixHeight:2,matrixWidth:1,scaleDenominator:1462857142857143e-7,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},3:{matrixId:"3",matrixHeight:3,matrixWidth:1,scaleDenominator:7314285714285715e-8,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},4:{matrixId:"4",matrixHeight:5,matrixWidth:1,scaleDenominator:36571428571428575e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},5:{matrixId:"5",matrixHeight:9,matrixWidth:1,scaleDenominator:18285714285714287e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},6:{matrixId:"6",matrixHeight:17,matrixWidth:2,scaleDenominator:9142857142857144e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},7:{matrixId:"7",matrixHeight:33,matrixWidth:4,scaleDenominator:4571428571428572e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},8:{matrixId:"8",matrixHeight:66,matrixWidth:8,scaleDenominator:2285714285714286e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},9:{matrixId:"9",matrixHeight:132,matrixWidth:16,scaleDenominator:1142857142857143e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},10:{matrixId:"10",matrixHeight:263,matrixWidth:32,scaleDenominator:571428.5714285715,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},11:{matrixId:"11",matrixHeight:526,matrixWidth:63,scaleDenominator:285714.28571428574,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},12:{matrixId:"12",matrixHeight:1051,matrixWidth:126,scaleDenominator:142857.14285714287,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},13:{matrixId:"13",matrixHeight:2102,matrixWidth:252,scaleDenominator:71428.57142857143,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},14:{matrixId:"14",matrixHeight:4204,matrixWidth:504,scaleDenominator:35714.28571428572,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},15:{matrixId:"15",matrixHeight:8408,matrixWidth:1008,scaleDenominator:17857.14285714286,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},16:{matrixId:"16",matrixHeight:16816,matrixWidth:2016,scaleDenominator:8928.57142857143,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}}}},"LAMB93_2.5m_3_16":{projection:"IGNF:LAMB93",nativeResolutions:["20480","10240","5120","2560","1280","640","320","160","80","40","20","10","5","2.5"],tileMatrices:{3:{matrixId:"3",matrixHeight:3,matrixWidth:1,scaleDenominator:7314285714285715e-8,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},4:{matrixId:"4",matrixHeight:5,matrixWidth:1,scaleDenominator:36571428571428575e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},5:{matrixId:"5",matrixHeight:9,matrixWidth:1,scaleDenominator:18285714285714287e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},6:{matrixId:"6",matrixHeight:17,matrixWidth:2,scaleDenominator:9142857142857144e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},7:{matrixId:"7",matrixHeight:33,matrixWidth:4,scaleDenominator:4571428571428572e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},8:{matrixId:"8",matrixHeight:66,matrixWidth:8,scaleDenominator:2285714285714286e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},9:{matrixId:"9",matrixHeight:132,matrixWidth:16,scaleDenominator:1142857142857143e-9,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},10:{matrixId:"10",matrixHeight:263,matrixWidth:32,scaleDenominator:571428.5714285715,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},11:{matrixId:"11",matrixHeight:526,matrixWidth:63,scaleDenominator:285714.28571428574,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},12:{matrixId:"12",matrixHeight:1051,matrixWidth:126,scaleDenominator:142857.14285714287,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},13:{matrixId:"13",matrixHeight:2102,matrixWidth:252,scaleDenominator:71428.57142857143,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},14:{matrixId:"14",matrixHeight:4204,matrixWidth:504,scaleDenominator:35714.28571428572,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},15:{matrixId:"15",matrixHeight:8408,matrixWidth:1008,scaleDenominator:17857.14285714286,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}},16:{matrixId:"16",matrixHeight:16816,matrixWidth:2016,scaleDenominator:8928.57142857143,tileHeight:256,tileWidth:256,topLeftCorner:{x:0,y:12e6}}}},PM,PM_0_14,PM_0_16,PM_0_18,PM_0_19,PM_0_21,PM_0_6,PM_0_8,PM_10_12,PM_15_18,PM_3_15,PM_4_10,PM_4_18,PM_4_19,PM_6_11,PM_6_14,PM_6_15,PM_6_16,PM_6_17,PM_6_18,PM_6_19,PM_6_21,PM_6_9,PM_7_17,PM_7_18,PM_9_16};var LayerConfigUtils={getLayerConfig:function(_t){var e={};if(_t){var n=_t.serviceParams.id.split(/:/)[1],ei=Object.keys(_t.serviceParams.serverUrl)[0];if(e.url=_t.serviceParams.serverUrl[ei],n!=="WFS"&&(/\/v\//.test(e.url)?e.styles=" ":e.styles=_t.styles[0].name),e.version=_t.serviceParams.version,e.format=_t.formats&&_t.formats.length?_t.formats[0].name:"",e.projection=_t.defaultProjection,e.minScale=_t.globalConstraint?_t.globalConstraint.minScaleDenominator:null,e.maxScale=_t.globalConstraint?_t.globalConstraint.maxScaleDenominator:null,e.extent=_t.globalConstraint?_t.globalConstraint.bbox:null,e.legends=_t.legends,e.title=_t.title,e.description=_t.description,n==="WMS"&&(e.metadata=_t.metadata),_t.wmtsOptions){e.tileMatrixSetLimits=_t.wmtsOptions.tileMatrixSetLimits;var ti=_t.wmtsOptions.tileMatrixSetLink;if(ti){e.TMSLink=ti;var ii=this.getTMSConfig(ti);e.matrixIds=Object.keys(ii.tileMatrices),e.tileMatrices=ii.tileMatrices,e.nativeResolutions=ii.nativeResolutions||this.getTMSConfig("PM").nativeResolutions}}}return{params:e}},getTMSConfig:function(_t){return TMS[_t]}};const stringToHTML$2=_t=>{var e=function(){if(!window.DOMParser)return!1;var ii=new DOMParser;try{ii.parseFromString("x","text/html")}catch{return!1}return!0};if(e()){var n=new DOMParser,ei=n.parseFromString(_t,"text/html");return ei.body}var ti=document.createElement("div");return ti.innerHTML=_t,ti};var CatalogDOM={generateID:function(_t){return Math.abs(Array.from(_t).reduce((e,n)=>Math.imul(31,e)+n.charCodeAt(0)|0,0))},_addUID:function(_t){var e=this.uid?_t+"-"+this.uid:_t;return e},_createMainContainerElement:function(){var _t=document.createElement("div");return _t.id=this._addUID("GPcatalog"),_t.className="GPwidget gpf-widget gpf-widget-button gpf-mobile-fullscreen",_t},_createShowCatalogPictoElement:function(){var _t=this,e=document.createElement("button"),n=document.createElement("span");return e.appendChild(n),e.id=this._addUID("GPshowCatalogPicto"),e.classList.add("GPshowOpen","GPshowAdvancedToolPicto","GPshowCatalogPicto"),e.classList.add("gpf-btn","gpf-btn--tertiary","gpf-btn-icon","gpf-btn-icon-catalog"),e.classList.add("fr-btn","fr-btn--tertiary"),e.setAttribute("aria-label","Catalogue de cartes"),e.setAttribute("tabindex","0"),e.setAttribute("aria-pressed",!1),e.setAttribute("type","button"),e.addEventListener?e.addEventListener("click",function(ei){var ti=ei.target.ariaPressed==="true";ei.target.setAttribute("aria-pressed",!ti),_t.onShowCatalogClick(ei)}):e.attachEvent&&e.attachEvent("onclick",function(ei){var ti=ei.target.ariaPressed==="true";ei.target.setAttribute("aria-pressed",!ti),_t.onShowCatalogClick(ei)}),e},_createCatalogPanelElement:function(){var _t=document.createElement("dialog");return _t.id=this._addUID("GPcatalogPanel"),_t.className="GPpanel gpf-panel fr-modal",_t},_createCatalogPanelDivSizeElement:function(_t){_t||(_t="md");var e="";switch(_t){case"sm":e="fr-col-8";break;case"md":e="fr-col-10";break;case"lg":e="fr-col-12";break;case"xl":e="fr-col-14";break}var n=document.createElement("div");return n.className=e,n},_createCatalogPanelDivElement:function(){var _t=document.createElement("div");return _t.className="gpf-panel__body fr-modal__body",_t},_createCatalogPanelContentDivElement:function(){var _t=document.createElement("div");return _t.className="gpf-panel__content fr-modal__content",_t},_createCatalogPanelHeaderElement:function(){var _t=document.createElement("div");return _t.className="GPpanelHeader gpf-panel__header_catalog",_t},_createCatalogPanelTitleElement:function(_t){var e=document.createElement("div");return e.className="GPpanelTitle gpf-panel__title_catalog",e.innerHTML=_t,e},_createCatalogPanelIconElement:function(_t){var e=document.createElement("label");return e.className="gpf-btn-header-catalog gpf-btn-icon-header-catalog",e.title=_t,e},_createCatalogPanelCloseElement:function(){var _t=this,e=document.createElement("button");e.id=this._addUID("GPcatalogPanelClose"),e.className="GPpanelClose GPcatalogPanelClose gpf-btn gpf-btn-icon-close fr-btn--close fr-btn fr-btn--tertiary-no-outline",e.title="Fermer le panneau",e.addEventListener?e.addEventListener("click",function(){document.getElementById(_t._addUID("GPshowCatalogPicto")).click(),_t.onCloseCatalogClick()},!1):e.attachEvent&&e.attachEvent("onclick",function(){document.getElementById(_t._addUID("GPshowCatalogPicto")).click(),_t.onCloseCatalogClick()});var n=document.createElement("span");return n.className="GPelementHidden gpf-hidden",n.innerText="Fermer",e.appendChild(n),e},_createCatalogContentDivElement:function(){var _t=stringToHTML$2('<div class="catalog-container-content" style=""></div>');return _t.firstChild},_createCatalogContentTitleElement:function(_t){var e=stringToHTML$2(`
        <!-- titre -->
        <div class="catalog-container-title">
            <div class="fr-title">
                <h5 style="margin:unset">${_t}</h5>
            </div>
        </div>
        `);return e.firstChild},_createCatalogContentSearchGlobalElement:function(_t){var e=`
        <!-- barre de recherche globale -->
        <!-- https://www.systeme-de-design.gouv.fr/composants-et-modeles/composants/barre-de-recherche -->
        <div class="catalog-container-search-global" style="padding:10px;">
            <div class="fr-search-bar" id="catalog-header-search-global" role="search" style="justify-content: center;">
                <label class="fr-label" for="catalog-input-search-global">
                    Recherche
                </label>
                <div class="input-wrapper" style="width:100%;">
                    <input class="fr-input" placeholder="${_t}" type="text" id="catalog-input-search-global" name="search-input" incremental>
                    <button type="button" id="catalog-button-reset-search-global" class="clear-btn" aria-label="Effacer le texte">
                        <svg viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="10" cy="10" r="9" stroke="currentColor" stroke-opacity="0.8"/>
                            <line x1="6" y1="6" x2="14" y2="14"/>
                            <line x1="14" y1="6" x2="6" y2="14"/>
                        </svg>
                    </button>
                </div>
                <button id="catalog-button-search-global" class="fr-btn" title="${_t}">
                    Rechercher
                </button>
            </div>
        </div>
        `,n=stringToHTML$2(e);const ei=n.attachShadow({mode:"open"});ei.innerHTML=e.trim();var ti=ei.getElementById("catalog-button-search-global");ti&&ti.addEventListener("click",ni=>{ni.target.value=ri.value,this.onSearchGlobalCatalogButtonClick(ni)});var ii=ei.getElementById("catalog-button-reset-search-global");ii&&ii.addEventListener("click",ni=>{ri.value="",this.onSearchGlobalCatalogButtonResetClick(ni)});var ri=ei.getElementById("catalog-input-search-global");return ri&&ri.addEventListener("input",ni=>{ni.target.value.length<3&&ni.target.value.length>0||this.onSearchGlobalCatalogInputChange(ni)}),ei},_createCatalogWaitingElement:function(){var _t=document.createElement("div");_t.id=this._addUID("GPcatalogCalcWaitingContainer"),_t.className="GPwaitingContainerHidden gpf-waiting--hidden";var e=document.createElement("p");return e.className="GPwaitingContainerInfo gpf-waiting_info",e.innerHTML="Recherche en cours...",_t.appendChild(e),_t},_createCatalogContentCategoriesTabs:function(_t,e){var n="",ei=(Si,wi,Oi,Ii)=>{var Li="GPtabButton fr-tabs__tab",Di="false",Ni=-1;return Ii&&(Li="GPtabButton GPtabButtonActive fr-tabs__tab",Di="true",Ni=0),`
            <li class="GPtabList" role="presentation">
                <button 
                    id="tabbutton-${Si}_${wi}" 
                    class="${Li}" 
                    data-category="${wi}"
                    tabindex="${Ni}" 
                    role="tabbutton" 
                    aria-selected="${Di}" 
                    aria-controls="tabpanel-${Si}-panel_${wi}">
                    ${Oi}
                </button>
            </li>
            `},ti=(Si,wi)=>{var Oi="gpf-hidden";return Si&&(Oi="fr-tabs__panel--selected"),`
            <!-- barre de recherche spcifique  la catgorie -->
            <div id="catalog-container-search-specific" class="fr-tabs__list ${Oi}" style="padding:10px;justify-content:center;">
                <div class="fr-search-bar" id="catalog-header-search-specific" role="search" style="width:100%;">
                    <label class="fr-label" for="catalog-input-search-specific">
                        Recherche dans la catgorie
                    </label>
                    <div class="input-wrapper" style="width:100%">
                        <input class="fr-input" placeholder="${wi}" type="text" id="catalog-input-search-specific" name="search-input-specific" incremental>
                        <button type="button" id="catalog-button-reset-search-specific" class="clear-btn" aria-label="Effacer le texte">
                            <svg viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="10" cy="10" r="9" stroke="currentColor" stroke-opacity="0.8"/>
                                <line x1="6" y1="6" x2="14" y2="14"/>
                                <line x1="14" y1="6" x2="6" y2="14"/>
                            </svg>
                        </button>
                    </div>
                    <button id="catalog-button-search-specific" class="fr-btn" title="${wi}">
                        Rechercher
                    </button>
                </div>
            </div>
            `},ii=(Si,wi)=>{var Oi=wi.default?"checked":"";return`
            <div class="fr-fieldset__element fr-fieldset__element--inline">
                <div class="fr-radio-group fr-radio-group--sm">
                    <input 
                        type="radio" 
                        ${Oi} 
                        id="radio-inline_${wi.id}" 
                        data-category="${wi.id}"
                        name="radio-inline-${Si}" 
                        role="radio-inline-section"
                        aria-controls="tabcontent-${wi.id}">
                    <label class="fr-label" for="radio-inline_${wi.id}">
                        ${wi.title}
                    </label>
                </div>
            </div>
            `},ri=(Si,wi)=>{var Oi="",Ii="";for(let Di=0;Di<wi.length;Di++){const Ni=wi[Di];Ii+=ii(Si,Ni);var Li="";Ni.default||(Li="GPelementHidden gpf-hidden"),Oi+=`<div class="tabcontent ${Li}" data-category="${Si}" role="tabpanel-section" id="tabcontent-${Ni.id}"></div>`}return`
            <!-- boutons radio des sous categories -->
            <fieldset class="fr-fieldset" id="radio-inline_${Si}" aria-labelledby="radio-inline-legend radio-inline-messages" style="margin:unset;">
                ${Ii}
                <div class="fr-messages-group" id="radio-inline-messages" aria-live="assertive"></div>
            </fieldset>
            <!-- panneaux des sous categories -->
            ${Oi}
            `},ni="",si=(Si,wi,Oi,Ii,Li,Di)=>{var Ni="GPtabContent fr-tabs__panel",$i=-1;Oi&&(Ni="GPtabContent GPtabContentSelected fr-tabs__panel fr-tabs__panel--selected",$i=0);var Ki=`<div class="tabcontent" data-category="${wi}" style="content-visibility: auto;contain-intrinsic-size:50px;"></div>`;Li&&(Ki=ri(wi,Li));var er="330px";return Di&&!Ii&&(er="390px"),`
            <!-- panneaux -->
            <div id="tabpanel-${Si}-panel_${wi}" 
                class="${Ni}" 
                role="tabpanel" 
                aria-labelledby="tabbutton-${Si}_${wi}" 
                tabindex="${$i}" 
                style="max-height: ${er};overflow-y: auto; padding: 1em; contain: content;">
                ${Ki}
            </div>
            `},ai=!1,oi=!1;for(let Si=0;Si<_t.length;Si++){const wi=_t[Si];wi.search&&(oi=!0),wi.default&&wi.search&&(ai=!0)}for(let Si=0;Si<_t.length;Si++){const wi=_t[Si];n+=ei(Si,wi.id,wi.title,wi.default),ni+=si(Si,wi.id,wi.default,wi.search,wi.items,oi)}var ci=ti(ai,"Rechercher une donne dans la catgorie"),ui="gpf-catalog-tabs-fixe";oi&&(ui="gpf-catalog-tabs-fixe-with-bar");var di=`
        <!-- onglets -->
        <div id="GPcatalogContainerTabs" class="catalog-container-tabs">
            <div class="GPtabs fr-tabs ${e?"":ui}">
                <ul class="GPtabsList fr-tabs__list" role="tablist" aria-label="presentation">
                    ${n}
                </ul>
                ${ci}
                ${ni}
            </div>
        </div>
        `,fi=stringToHTML$2(di.trim());const hi=fi.attachShadow({mode:"open"});hi.innerHTML=di.trim();var pi=hi.querySelectorAll('[role="tabpanel-section"]'),gi=hi.querySelectorAll('[role="radio-inline-section"]');gi&&gi.forEach(Si=>{Si.addEventListener("change",wi=>{for(let Li=0;Li<pi.length;Li++){const Di=pi[Li];var Oi=Di.getAttribute("data-category");Oi===wi.target.name.split("-")[2]&&(Di.classList.add("gpf-hidden"),Di.classList.add("GPelementHidden"))}var Ii=document.getElementById(wi.target.getAttribute("aria-controls"));Ii.classList.remove("gpf-hidden"),Ii.classList.remove("GPelementHidden"),this.onToggleCatalogRadioChange(wi,wi.target.getAttribute("data-category"))})});var vi=hi.querySelectorAll('[role="tabpanel"]'),yi=hi.querySelectorAll('[role="tabbutton"]');yi&&yi.forEach(Si=>{Si.addEventListener("click",wi=>{for(let Ii=0;Ii<yi.length;Ii++){const Li=yi[Ii];Li.setAttribute("tabindex",-1),Li.ariaSelected=!1,Li.classList.remove("GPtabButtonActive")}wi.target.setAttribute("tabindex",0),wi.target.ariaSelected=!0,wi.target.classList.add("GPtabButtonActive");for(let Ii=0;Ii<vi.length;Ii++){const Li=vi[Ii];Li.setAttribute("tabindex",-1),Li.classList.remove("fr-tabs__panel--selected"),Li.classList.remove("GPtabContentSelected"),Li.classList.add("gpf-hidden"),Li.classList.add("GPelementHidden")}var Oi=document.getElementById(wi.target.getAttribute("aria-controls"));Oi.setAttribute("tabindex",0),Oi.classList.add("fr-tabs__panel--selected"),Oi.classList.add("GPtabContentSelected"),Oi.classList.remove("gpf-hidden"),Oi.classList.remove("GPelementHidden"),this.onSelectCatalogTabClick(wi,wi.target.getAttribute("data-category"))})});var _i=hi.getElementById("catalog-button-search-specific");_i&&_i.addEventListener("click",Si=>{Si.target.value=Ei.value,this.onSearchSpecificCatalogButtonClick(Si)});var Ai=hi.getElementById("catalog-button-reset-search-specific");Ai&&Ai.addEventListener("click",Si=>{Ei.value="",this.onSearchSpecificCatalogButtonResetClick(Si)});var Ei=hi.getElementById("catalog-input-search-specific");return Ei&&Ei.addEventListener("input",Si=>{Si.target.value.length<3&&Si.target.value.length>0||this.onSearchSpecificCatalogInputChange(Si)}),hi},_createCatalogContentCategoryTabContent:async function(_t,e,n){var ti=[],ii="",ri=(Ei,Si,wi,Oi,Ii,Li,Di,Ni)=>{var $i=nr=>{if(nr){if(nr.startsWith("data:")||nr.startsWith("http"))return`
                        <div class="catalog-thumbnail" style="width:50px; height:50px; margin-right:10px; flex-shrink:0; display:flex; align-items:center; justify-content:center; overflow:hidden;">
                            <img src="${nr}" alt="Aperu de la couche" style="min-width:100%;min-height:100%;object-fit:cover;"/>
                        </div>
                        `;if(nr="default",nr==="default")return'<div class="catalog-thumbnail-default" style="width:50px; height:50px; margin-right:10px; flex-shrink:0; display:flex; align-items:center; justify-content:center; overflow:hidden;"></div>'}return""},Ki=Li.producers?Li.producers[0].name:"",er=nr=>{if(!nr)return"";var zi="";for(let Wi=0;Wi<nr.length;Wi++){const Ti=nr[Wi];zi+=`
                        <a href="${Ti.url}" target="_blank" class="fr-tag fr-tag--sm fr-icon-arrow-right-line fr-tag--icon-left">
                            ${Ti.name}
                        </a>
                    `}return zi},Vi=nr=>{if(!nr)return"";var zi="";for(let Wi=0;Wi<nr.length;Wi++){const Ti=nr[Wi];if(Ti.includes("catalogue/dataset")||Ti.includes("rechercher-une-donnee/dataset"))return`
                            <a href="${Ti}" target="_blank" class="fr-link fr-icon-arrow-right-line fr-link--icon-right">
                                Voir la fiche dtaille
                            </a>
                        `}return zi};return`
            <div 
                class="fr-fieldset__element" 
                id="fieldset-${Ni}_${Si}-${Oi}"
                style="contain: content;">
                <div class="fr-checkbox-group gpf-flex" style="justify-content:flex-start;padding-top:5px;padding-bottom:5px;box-shadow: inset 0 1px 0 0 var(--border-default-grey),0 0 0 0 var(--border-default-grey);">
                    <input
                        class="fr-input"
                        name="checkboxes-${Ni}"
                        id="checkboxes-${Ni}-${Ei}_${Si}-${Oi}"
                        type="checkbox"
                        data-layer="${Si}:${Oi}"/>
                    <label 
                        for="checkboxes-${Ni}-${Ei}_${Si}-${Oi}"
                        style="position: relative; bottom: 12px;">
                    </label>
                    <div class="catalog-thumbnail-container" style="">
                        ${$i(Di)}
                    </div>
                    <div style="width: 100%;">
                        <label 
                            class="GPlabelActive fr-label"
                            role="label-collapse-more-${Ni}"
                            aria-controls="catalog-collapse-more-${Ei}-${Ni}"
                            title="${wi}"
                            style="display: -webkit-box; width: 100%; text-overflow: ellipsis; overflow: hidden; white-space: normal; cursor: pointer; line-height: 1.9em; -webkit-line-clamp: 2; -webkit-box-orient: vertical;">
                            ${wi}
                        </label>
                        <span class="GPlabelActive fr-label fr-hint-text">${Ki}</span>
                    </div>
                    <button 
                        id="catalog-collapse-more-${Ei}-${Ni}"
                        role="button-collapse-more-${Ni}"
                        class="catalog-collapse-show gpf-btn gpf-btn-icon gpf-btn-icon-catalog-collapse fr-btn fr-btn--tertiary gpf-btn--tertiary" 
                        type="button" 
                        title="En savoir plus sur la couche" 
                        tabindex="0" 
                        aria-pressed="false"
                        aria-controls="catalog-info-more-${Ei}-${Ni}"
                        style="position: relative;">
                    </button>
                </div>
                <div class="gpf-hidden" id="catalog-info-more-${Ei}-${Ni}">
                    <p>
                        <span class="fr-label fr-message" style="word-break: break-all;">${Si} - ${Oi}</span>
                        ${er(Li.producers)}
                    </p>
                    <p>
                        ${Ii}
                    </p>
                    ${Vi(Li.metadatas)}
                </div>
            </div>
            `},ni="",si=(Ei,Si,wi,Oi,Ii,Li)=>{var Di=Oi&&Oi.startsWith("fr-icon")?Oi:"",Ni=`section-accordion-${Si}-${Ei}`;return`
            <!-- section -->
            <section 
                id="section-${Si}-${Ei}" 
                data-category="${Si}"
                data-id="${Ei}"
                class="fr-accordion" style="contain: content;">
                <h3 class="fr-accordion__title">
                    <button class="GPcatalogButtonSection fr-accordion__btn gpf-accordion__btn" role="section-collapse-${Si}" aria-expanded="false" aria-controls="${Ni}">
                        <span class="GPshowCatalogAdvancedTools gpf-hidden"></span>
                        <span class="catalog-section-icon ${Di}" role="section-icon-collapse-${Si}" style="width: calc(100% - 2rem);">${wi}</span>
                        <span class="catalog-section-count" role="section-count-collapse-${Si}" id="section-count-${Si}-${Ei}" style="position: absolute; right: 1.25rem;">${Ii}</span>
                    </button>
                </h3>
                <div class="fr-collapse GPelementHidden" id="${Ni}">
                    ${Li}
                </div>
            </section>
            `},ai=_t.section;ai&&(e=e.sort((Ei,Si)=>Ei[_t.filter.field][0].localeCompare(Si[_t.filter.field][0])));var oi={},li=[];for(let Ei=0;Ei<e.length;Ei+=10){for(let Si=Ei;Si<Math.min(Ei+10,e.length);Si++){const wi=e[Si],Oi={producers:wi.producer_urls,thematics:wi.thematic_urls,metadatas:wi.metadata_urls};var ci=ri(Si,wi.name,wi.label,wi.service,wi.description,Oi,wi.thumbnail,_t.id);if(ai){var ui=wi[_t.filter.field];Array.isArray(ui)&&(ui=ui[0]),ui?(oi.hasOwnProperty(ui)||(oi[ui]=""),oi[ui]+=ci):(oi.hasOwnProperty("Autres")||(oi.Autres=""),oi.Autres+=ci)}else ii+=ci,li.push(ci)}await new Promise(Si=>setTimeout(Si,0))}if(ii!==""){var _i=stringToHTML$2(ii);const Si=_i.attachShadow({mode:"open"});Si.innerHTML=ii.trim(),ti.push({domid:`checkboxes-${_t.id}`,rows:li,fragment:Si,debug:{type:"layers",desc:"liste des couches pour une categorie",title:_t.title}}),n&&(ii="")}if(ai){_t.sections=[];const Ei=Object.entries(oi).sort((Si,wi)=>{const Oi=Si[0],Ii=wi[0];return Oi==="Autres"?1:Ii==="Autres"?-1:Oi.localeCompare(Ii,"fr",{sensitivity:"base"})});for(const[Si,wi]of Ei)if(Object.prototype.hasOwnProperty.call(oi,Si)){var di=[],fi=[...wi.matchAll(/"fr-fieldset__element"/g)];for(let Oi=0;Oi<fi.length;Oi++){const Ii=fi[Oi];di.push(Ii.input)}var hi=fi.length,pi=this.generateID(Si),gi="";if(_t.icon&&_t.iconJson){const Oi=_t.iconJson.find(Ii=>Ii.name===Si);Oi?gi=Oi.icon:gi="fr-icon-folder-2-fill"}var vi=si(pi,_t.id,Si,gi,hi,n?"":wi);if(ni+=vi,_t.sections.push(Si),vi!==""){var _i=stringToHTML$2(wi);const Ii=_i.attachShadow({mode:"open"});Ii.innerHTML=wi.trim(),ti.push({domid:`section-accordion-${_t.id}-${pi}`,rows:di,fragment:Ii,debug:{type:"section",desc:"liste des couches pour une section",title:Si,id:pi,category:_t.id}})}}}var yi=`
            <!-- liste de donnes -->
            <div class="fr-accordions-group" 
                id="checkboxes-${_t.id}" 
                data-category="${_t.id}"
                data-sections="${!!ni}"
                aria-labelledby="checkboxes-legend checkboxes-messages"
                style="contain: content;">
                ${ni||ii}
            </div>
        `,_i=stringToHTML$2(yi);const Ai=_i.attachShadow({mode:"open"});return Ai.innerHTML=yi.trim(),{dom:Ai,blocks:ti}},_updateListenersLayersDOM:function(_t,e){var n=`checkboxes-${e}`,ei=_t.querySelectorAll('[name="'+n+'"]');ei&&ei.forEach(di=>{di.addEventListener("click",fi=>{this.onSelectCatalogEntryClick(fi)})});var ti=`section-collapse-${e}`,ii=_t.querySelectorAll('[role="'+ti+'"]');ii&&ii.forEach(di=>{di.addEventListener("click",fi=>{fi.target.ariaExpanded=fi.target.ariaExpanded!=="true";var hi=fi.target.getAttribute("aria-controls"),pi=document.getElementById(hi);if(pi){var gi=hi.replace("section-accordion","section"),vi=document.getElementById(gi),yi=vi?vi.dataset.category:null;if(fi.target.ariaExpanded==="true"){pi.classList.add("fr-collapse--expanded"),pi.classList.remove("GPelementHidden"),vi&&(vi.classList.add("catalog-section-full"),this.updateVisibilitySectionsByCategory(gi,yi,!1));const _i=di.closest('div[id^="tabpanel-"]'),Ai=di.getBoundingClientRect(),Ei=_i.getBoundingClientRect(),Si=Ai.top-Ei.top;_i.scrollTo({top:_i.scrollTop+Si,behavior:"smooth"})}else pi.classList.remove("fr-collapse--expanded"),pi.classList.add("GPelementHidden"),vi&&(vi.classList.remove("catalog-section-full"),this.updateVisibilitySectionsByCategory(gi,yi,!0));this.onToggleCatalogSectionClick(fi,yi,hi)}},!1)});var ri=`button-collapse-more-${e}`,ni=_t.querySelectorAll('[role="'+ri+'"]');ni&&ni.forEach(di=>{di.addEventListener("click",fi=>{fi.target.ariaPressed=fi.target.ariaPressed!=="true";var hi=document.getElementById(fi.target.getAttribute("aria-controls"));if(hi){if(fi.target.ariaPressed==="true"){hi.classList.add("gpf-visible"),hi.classList.remove("gpf-hidden"),di.closest('div[id^="tabpanel-"]');const pi=di.closest('div[id^="tabpanel-"]'),gi=di.getBoundingClientRect(),vi=pi.getBoundingClientRect(),yi=gi.top-vi.top;pi.scrollTo({top:pi.scrollTop+yi,behavior:"smooth"})}else hi.classList.remove("gpf-visible"),hi.classList.add("gpf-hidden");this.onToggleCatalogMoreLearnClick(fi)}},!1)});var si=`label-collapse-more-${e}`,ai=_t.querySelectorAll('[role="'+si+'"]');ai&&ai.forEach(di=>{di.addEventListener("click",fi=>{var hi=document.getElementById(fi.target.getAttribute("aria-controls"));hi&&hi.click()},!1)});var oi=`section-icon-collapse-${e}`,li=_t.querySelectorAll('[role="'+oi+'"]');li&&li.forEach(di=>{di.addEventListener("click",fi=>{fi.target.parentElement.click()})});var ci=`section-count-collapse-${e}`,ui=_t.querySelectorAll('[role="'+ci+'"]');ui&&ui.forEach(di=>{di.addEventListener("click",fi=>{fi.target.parentElement.click()})})},updateVisibilitySectionsByCategory(_t,e,n){var ei=`[id^="section-${e}-"]`,ti=document.querySelectorAll(ei);for(let si=0;si<ti.length;si++){const ai=ti[si];if(ai.id!==_t)if(n){var ii=`section-count-${e}-${ai.getAttribute("data-id")}`,ri=document.getElementById(ii),ni=parseInt(ri.textContent,10);if(ni===0)continue;ai.classList.remove("gpf-hidden"),ai.classList.remove("GPelementHidden")}else ai.classList.add("gpf-hidden"),ai.classList.add("GPelementHidden")}}};const thematic=[{id:"biota",name:"Biologie, faune et flore",icon:"fr-icon-plant-fill"},{id:"boundaries",name:"Limites politiques et administratives",icon:"fr-icon-france-line"},{id:"climatologyMeteorologyAtmosphere",name:"Climatologie, mtorologie, atmosphre",icon:"fr-icon-heavy-showers-fill"},{id:"economy",name:"conomie",icon:"fr-icon-bar-chart-box-fill"},{id:"elevation",name:"Altimtrie",icon:"fr-icon-line-chart-fill"},{id:"environment",name:"Environnement",icon:"fr-icon-leaf-fill"},{id:"farming",name:"Agriculture",icon:"fr-icon-seedling-fill"},{id:"geoscientificInformation",name:"Sciences de la terre, gosciences",icon:"fr-icon-earth-fill"},{id:"health",name:"Sant",icon:"fr-icon-first-aid-kit-fill"},{id:"imageryBaseMapsEarthCover",name:"Carte de rfrence de la couverture terrestre",icon:"fr-icon-global-fill"},{id:"intelligenceMilitary",name:"Infrastructures militaires",icon:"fr-icon-medal-fill"},{id:"inlandWaters",name:"Eaux intrieures, Hydrographie",icon:"fr-icon-drop-fill"},{id:"location",name:"Localisation",icon:"fr-icon-road-map-fill"},{id:"oceans",name:"Ocans",icon:"fr-icon-fr--submersion-fill"},{id:"planningCadastre",name:"Cadastre, amnagement",icon:"fr-icon-layout-grid-fill"},{id:"society",name:"Socit",icon:"fr-icon-capsule-fill"},{id:"structure",name:"Constructions et ouvrages",icon:"fr-icon-community-fill"},{id:"transportation",name:"Infrastructures de transport",icon:"fr-icon-bus-fill"},{id:"utilitiesCommunication",name:"Tlcommunication, approvisionnement et nergie",icon:"fr-icon-lightbulb-fill"}],service=[{id:"wmts",name:"WMTS",icon:"fr-icon-earth-line"},{id:"wfs",name:"WFS",icon:"fr-icon-earth-fill"},{id:"wms",name:"WMS",icon:"fr-icon-earth-line"},{id:"tms",name:"TMS",icon:"fr-icon-earth-fill"}],producer=[{id:"ign",name:"IGN",icon:"fr-icon-government-fill"}],Topics={thematic,service,producer};function L$2(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var T$1=L$2();function G$1(_t){T$1=_t}var E$1={exec:()=>null};function d$2(_t,e=""){let n=typeof _t=="string"?_t:_t.source,ei={replace:(ti,ii)=>{let ri=typeof ii=="string"?ii:ii.source;return ri=ri.replace(m$1.caret,"$1"),n=n.replace(ti,ri),ei},getRegex:()=>new RegExp(n,e)};return ei}var be$1=(()=>{try{return!!new RegExp("(?<=1)(?<!1)")}catch{return!1}})(),m$1={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:_t=>new RegExp(`^( {0,3}${_t})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:_t=>new RegExp(`^ {0,${Math.min(3,_t-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:_t=>new RegExp(`^ {0,${Math.min(3,_t-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:_t=>new RegExp(`^ {0,${Math.min(3,_t-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:_t=>new RegExp(`^ {0,${Math.min(3,_t-1)}}#`),htmlBeginRegex:_t=>new RegExp(`^ {0,${Math.min(3,_t-1)}}<(?:[a-z].*>|!--)`,"i")},Re=/^(?:[ \t]*(?:\n|$))+/,Te=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,Oe=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,I$2=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,we$1=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,F$1=/(?:[*+-]|\d{1,9}[.)])/,ie$1=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,oe$1=d$2(ie$1).replace(/bull/g,F$1).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),ye$1=d$2(ie$1).replace(/bull/g,F$1).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),j$1=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,Pe$1=/^[^\n]+/,Q$1=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,Se$1=d$2(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",Q$1).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),$e=d$2(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,F$1).getRegex(),v$1="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",U$1=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,_e$1=d$2("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",U$1).replace("tag",v$1).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),ae$1=d$2(j$1).replace("hr",I$2).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",v$1).getRegex(),Le$1=d$2(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",ae$1).getRegex(),K$1={blockquote:Le$1,code:Te,def:Se$1,fences:Oe,heading:we$1,hr:I$2,html:_e$1,lheading:oe$1,list:$e,newline:Re,paragraph:ae$1,table:E$1,text:Pe$1},re$1=d$2("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",I$2).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",v$1).getRegex(),Me={...K$1,lheading:ye$1,table:re$1,paragraph:d$2(j$1).replace("hr",I$2).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",re$1).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",v$1).getRegex()},ze={...K$1,html:d$2(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",U$1).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:E$1,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:d$2(j$1).replace("hr",I$2).replace("heading",` *#{1,6} *[^
]`).replace("lheading",oe$1).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Ae$1=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,Ee=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,le$1=/^( {2,}|\\)\n(?!\s*$)/,Ie$1=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,D$1=/[\p{P}\p{S}]/u,W$1=/[\s\p{P}\p{S}]/u,ue$1=/[^\s\p{P}\p{S}]/u,Ce=d$2(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,W$1).getRegex(),pe$1=/(?!~)[\p{P}\p{S}]/u,Be=/(?!~)[\s\p{P}\p{S}]/u,qe=/(?:[^\s\p{P}\p{S}]|~)/u,ve$1=d$2(/link|precode-code|html/,"g").replace("link",/\[(?:[^\[\]`]|(?<a>`+)[^`]+\k<a>(?!`))*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)/).replace("precode-",be$1?"(?<!`)()":"(^^|[^`])").replace("code",/(?<b>`+)[^`]+\k<b>(?!`)/).replace("html",/<(?! )[^<>]*?>/).getRegex(),ce$1=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,De=d$2(ce$1,"u").replace(/punct/g,D$1).getRegex(),He=d$2(ce$1,"u").replace(/punct/g,pe$1).getRegex(),he$1="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",Ze=d$2(he$1,"gu").replace(/notPunctSpace/g,ue$1).replace(/punctSpace/g,W$1).replace(/punct/g,D$1).getRegex(),Ge=d$2(he$1,"gu").replace(/notPunctSpace/g,qe).replace(/punctSpace/g,Be).replace(/punct/g,pe$1).getRegex(),Ne$1=d$2("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,ue$1).replace(/punctSpace/g,W$1).replace(/punct/g,D$1).getRegex(),Fe$1=d$2(/\\(punct)/,"gu").replace(/punct/g,D$1).getRegex(),je$1=d$2(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),Qe=d$2(U$1).replace("(?:-->|$)","-->").getRegex(),Ue=d$2("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",Qe).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),q$1=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,Ke=d$2(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",q$1).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),de$1=d$2(/^!?\[(label)\]\[(ref)\]/).replace("label",q$1).replace("ref",Q$1).getRegex(),ke$1=d$2(/^!?\[(ref)\](?:\[\])?/).replace("ref",Q$1).getRegex(),We=d$2("reflink|nolink(?!\\()","g").replace("reflink",de$1).replace("nolink",ke$1).getRegex(),se$1=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,X$1={_backpedal:E$1,anyPunctuation:Fe$1,autolink:je$1,blockSkip:ve$1,br:le$1,code:Ee,del:E$1,emStrongLDelim:De,emStrongRDelimAst:Ze,emStrongRDelimUnd:Ne$1,escape:Ae$1,link:Ke,nolink:ke$1,punctuation:Ce,reflink:de$1,reflinkSearch:We,tag:Ue,text:Ie$1,url:E$1},Xe={...X$1,link:d$2(/^!?\[(label)\]\((.*?)\)/).replace("label",q$1).getRegex(),reflink:d$2(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",q$1).getRegex()},N$2={...X$1,emStrongRDelimAst:Ge,emStrongLDelim:He,url:d$2(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",se$1).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:d$2(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",se$1).getRegex()},Je={...N$2,br:d$2(le$1).replace("{2,}","*").getRegex(),text:d$2(N$2.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},C$2={normal:K$1,gfm:Me,pedantic:ze},M$2={normal:X$1,gfm:N$2,breaks:Je,pedantic:Xe},Ve={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ge$1=_t=>Ve[_t];function w$2(_t,e){if(e){if(m$1.escapeTest.test(_t))return _t.replace(m$1.escapeReplace,ge$1)}else if(m$1.escapeTestNoEncode.test(_t))return _t.replace(m$1.escapeReplaceNoEncode,ge$1);return _t}function J$1(_t){try{_t=encodeURI(_t).replace(m$1.percentDecode,"%")}catch{return null}return _t}function V$1(_t,e){var ii;let n=_t.replace(m$1.findPipe,(ri,ni,si)=>{let ai=!1,oi=ni;for(;--oi>=0&&si[oi]==="\\";)ai=!ai;return ai?"|":" |"}),ei=n.split(m$1.splitPipe),ti=0;if(ei[0].trim()||ei.shift(),ei.length>0&&!((ii=ei.at(-1))!=null&&ii.trim())&&ei.pop(),e)if(ei.length>e)ei.splice(e);else for(;ei.length<e;)ei.push("");for(;ti<ei.length;ti++)ei[ti]=ei[ti].trim().replace(m$1.slashPipe,"|");return ei}function z$2(_t,e,n){let ei=_t.length;if(ei===0)return"";let ti=0;for(;ti<ei&&_t.charAt(ei-ti-1)===e;)ti++;return _t.slice(0,ei-ti)}function fe$1(_t,e){if(_t.indexOf(e[1])===-1)return-1;let n=0;for(let ei=0;ei<_t.length;ei++)if(_t[ei]==="\\")ei++;else if(_t[ei]===e[0])n++;else if(_t[ei]===e[1]&&(n--,n<0))return ei;return n>0?-2:-1}function me$1(_t,e,n,ei,ti){let ii=e.href,ri=e.title||null,ni=_t[1].replace(ti.other.outputLinkReplace,"$1");ei.state.inLink=!0;let si={type:_t[0].charAt(0)==="!"?"image":"link",raw:n,href:ii,title:ri,text:ni,tokens:ei.inlineTokens(ni)};return ei.state.inLink=!1,si}function Ye(_t,e,n){let ei=_t.match(n.other.indentCodeCompensation);if(ei===null)return e;let ti=ei[1];return e.split(`
`).map(ii=>{let ri=ii.match(n.other.beginningSpace);if(ri===null)return ii;let[ni]=ri;return ni.length>=ti.length?ii.slice(ti.length):ii}).join(`
`)}var y$2=class{constructor(e){qr(this,"options");qr(this,"rules");qr(this,"lexer");this.options=e||T$1}space(e){let n=this.rules.block.newline.exec(e);if(n&&n[0].length>0)return{type:"space",raw:n[0]}}code(e){let n=this.rules.block.code.exec(e);if(n){let ei=n[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:n[0],codeBlockStyle:"indented",text:this.options.pedantic?ei:z$2(ei,`
`)}}}fences(e){let n=this.rules.block.fences.exec(e);if(n){let ei=n[0],ti=Ye(ei,n[3]||"",this.rules);return{type:"code",raw:ei,lang:n[2]?n[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):n[2],text:ti}}}heading(e){let n=this.rules.block.heading.exec(e);if(n){let ei=n[2].trim();if(this.rules.other.endingHash.test(ei)){let ti=z$2(ei,"#");(this.options.pedantic||!ti||this.rules.other.endingSpaceChar.test(ti))&&(ei=ti.trim())}return{type:"heading",raw:n[0],depth:n[1].length,text:ei,tokens:this.lexer.inline(ei)}}}hr(e){let n=this.rules.block.hr.exec(e);if(n)return{type:"hr",raw:z$2(n[0],`
`)}}blockquote(e){let n=this.rules.block.blockquote.exec(e);if(n){let ei=z$2(n[0],`
`).split(`
`),ti="",ii="",ri=[];for(;ei.length>0;){let ni=!1,si=[],ai;for(ai=0;ai<ei.length;ai++)if(this.rules.other.blockquoteStart.test(ei[ai]))si.push(ei[ai]),ni=!0;else if(!ni)si.push(ei[ai]);else break;ei=ei.slice(ai);let oi=si.join(`
`),li=oi.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");ti=ti?`${ti}
${oi}`:oi,ii=ii?`${ii}
${li}`:li;let ci=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(li,ri,!0),this.lexer.state.top=ci,ei.length===0)break;let ui=ri.at(-1);if((ui==null?void 0:ui.type)==="code")break;if((ui==null?void 0:ui.type)==="blockquote"){let di=ui,fi=di.raw+`
`+ei.join(`
`),hi=this.blockquote(fi);ri[ri.length-1]=hi,ti=ti.substring(0,ti.length-di.raw.length)+hi.raw,ii=ii.substring(0,ii.length-di.text.length)+hi.text;break}else if((ui==null?void 0:ui.type)==="list"){let di=ui,fi=di.raw+`
`+ei.join(`
`),hi=this.list(fi);ri[ri.length-1]=hi,ti=ti.substring(0,ti.length-ui.raw.length)+hi.raw,ii=ii.substring(0,ii.length-di.raw.length)+hi.raw,ei=fi.substring(ri.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:ti,tokens:ri,text:ii}}}list(e){let n=this.rules.block.list.exec(e);if(n){let ei=n[1].trim(),ti=ei.length>1,ii={type:"list",raw:"",ordered:ti,start:ti?+ei.slice(0,-1):"",loose:!1,items:[]};ei=ti?`\\d{1,9}\\${ei.slice(-1)}`:`\\${ei}`,this.options.pedantic&&(ei=ti?ei:"[*+-]");let ri=this.rules.other.listItemRegex(ei),ni=!1;for(;e;){let ai=!1,oi="",li="";if(!(n=ri.exec(e))||this.rules.block.hr.test(e))break;oi=n[0],e=e.substring(oi.length);let ci=n[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,gi=>" ".repeat(3*gi.length)),ui=e.split(`
`,1)[0],di=!ci.trim(),fi=0;if(this.options.pedantic?(fi=2,li=ci.trimStart()):di?fi=n[1].length+1:(fi=n[2].search(this.rules.other.nonSpaceChar),fi=fi>4?1:fi,li=ci.slice(fi),fi+=n[1].length),di&&this.rules.other.blankLine.test(ui)&&(oi+=ui+`
`,e=e.substring(ui.length+1),ai=!0),!ai){let gi=this.rules.other.nextBulletRegex(fi),vi=this.rules.other.hrRegex(fi),yi=this.rules.other.fencesBeginRegex(fi),_i=this.rules.other.headingBeginRegex(fi),Ai=this.rules.other.htmlBeginRegex(fi);for(;e;){let Ei=e.split(`
`,1)[0],Si;if(ui=Ei,this.options.pedantic?(ui=ui.replace(this.rules.other.listReplaceNesting,"  "),Si=ui):Si=ui.replace(this.rules.other.tabCharGlobal,"    "),yi.test(ui)||_i.test(ui)||Ai.test(ui)||gi.test(ui)||vi.test(ui))break;if(Si.search(this.rules.other.nonSpaceChar)>=fi||!ui.trim())li+=`
`+Si.slice(fi);else{if(di||ci.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||yi.test(ci)||_i.test(ci)||vi.test(ci))break;li+=`
`+ui}!di&&!ui.trim()&&(di=!0),oi+=Ei+`
`,e=e.substring(Ei.length+1),ci=Si.slice(fi)}}ii.loose||(ni?ii.loose=!0:this.rules.other.doubleBlankLine.test(oi)&&(ni=!0));let hi=null,pi;this.options.gfm&&(hi=this.rules.other.listIsTask.exec(li),hi&&(pi=hi[0]!=="[ ] ",li=li.replace(this.rules.other.listReplaceTask,""))),ii.items.push({type:"list_item",raw:oi,task:!!hi,checked:pi,loose:!1,text:li,tokens:[]}),ii.raw+=oi}let si=ii.items.at(-1);if(si)si.raw=si.raw.trimEnd(),si.text=si.text.trimEnd();else return;ii.raw=ii.raw.trimEnd();for(let ai=0;ai<ii.items.length;ai++)if(this.lexer.state.top=!1,ii.items[ai].tokens=this.lexer.blockTokens(ii.items[ai].text,[]),!ii.loose){let oi=ii.items[ai].tokens.filter(ci=>ci.type==="space"),li=oi.length>0&&oi.some(ci=>this.rules.other.anyLine.test(ci.raw));ii.loose=li}if(ii.loose)for(let ai=0;ai<ii.items.length;ai++)ii.items[ai].loose=!0;return ii}}html(e){let n=this.rules.block.html.exec(e);if(n)return{type:"html",block:!0,raw:n[0],pre:n[1]==="pre"||n[1]==="script"||n[1]==="style",text:n[0]}}def(e){let n=this.rules.block.def.exec(e);if(n){let ei=n[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),ti=n[2]?n[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",ii=n[3]?n[3].substring(1,n[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):n[3];return{type:"def",tag:ei,raw:n[0],href:ti,title:ii}}}table(e){var ni;let n=this.rules.block.table.exec(e);if(!n||!this.rules.other.tableDelimiter.test(n[2]))return;let ei=V$1(n[1]),ti=n[2].replace(this.rules.other.tableAlignChars,"").split("|"),ii=(ni=n[3])!=null&&ni.trim()?n[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],ri={type:"table",raw:n[0],header:[],align:[],rows:[]};if(ei.length===ti.length){for(let si of ti)this.rules.other.tableAlignRight.test(si)?ri.align.push("right"):this.rules.other.tableAlignCenter.test(si)?ri.align.push("center"):this.rules.other.tableAlignLeft.test(si)?ri.align.push("left"):ri.align.push(null);for(let si=0;si<ei.length;si++)ri.header.push({text:ei[si],tokens:this.lexer.inline(ei[si]),header:!0,align:ri.align[si]});for(let si of ii)ri.rows.push(V$1(si,ri.header.length).map((ai,oi)=>({text:ai,tokens:this.lexer.inline(ai),header:!1,align:ri.align[oi]})));return ri}}lheading(e){let n=this.rules.block.lheading.exec(e);if(n)return{type:"heading",raw:n[0],depth:n[2].charAt(0)==="="?1:2,text:n[1],tokens:this.lexer.inline(n[1])}}paragraph(e){let n=this.rules.block.paragraph.exec(e);if(n){let ei=n[1].charAt(n[1].length-1)===`
`?n[1].slice(0,-1):n[1];return{type:"paragraph",raw:n[0],text:ei,tokens:this.lexer.inline(ei)}}}text(e){let n=this.rules.block.text.exec(e);if(n)return{type:"text",raw:n[0],text:n[0],tokens:this.lexer.inline(n[0])}}escape(e){let n=this.rules.inline.escape.exec(e);if(n)return{type:"escape",raw:n[0],text:n[1]}}tag(e){let n=this.rules.inline.tag.exec(e);if(n)return!this.lexer.state.inLink&&this.rules.other.startATag.test(n[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(n[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(n[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(n[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:n[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:n[0]}}link(e){let n=this.rules.inline.link.exec(e);if(n){let ei=n[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(ei)){if(!this.rules.other.endAngleBracket.test(ei))return;let ri=z$2(ei.slice(0,-1),"\\");if((ei.length-ri.length)%2===0)return}else{let ri=fe$1(n[2],"()");if(ri===-2)return;if(ri>-1){let ni=(n[0].indexOf("!")===0?5:4)+n[1].length+ri;n[2]=n[2].substring(0,ri),n[0]=n[0].substring(0,ni).trim(),n[3]=""}}let ti=n[2],ii="";if(this.options.pedantic){let ri=this.rules.other.pedanticHrefTitle.exec(ti);ri&&(ti=ri[1],ii=ri[3])}else ii=n[3]?n[3].slice(1,-1):"";return ti=ti.trim(),this.rules.other.startAngleBracket.test(ti)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(ei)?ti=ti.slice(1):ti=ti.slice(1,-1)),me$1(n,{href:ti&&ti.replace(this.rules.inline.anyPunctuation,"$1"),title:ii&&ii.replace(this.rules.inline.anyPunctuation,"$1")},n[0],this.lexer,this.rules)}}reflink(e,n){let ei;if((ei=this.rules.inline.reflink.exec(e))||(ei=this.rules.inline.nolink.exec(e))){let ti=(ei[2]||ei[1]).replace(this.rules.other.multipleSpaceGlobal," "),ii=n[ti.toLowerCase()];if(!ii){let ri=ei[0].charAt(0);return{type:"text",raw:ri,text:ri}}return me$1(ei,ii,ei[0],this.lexer,this.rules)}}emStrong(e,n,ei=""){let ti=this.rules.inline.emStrongLDelim.exec(e);if(!(!ti||ti[3]&&ei.match(this.rules.other.unicodeAlphaNumeric))&&(!(ti[1]||ti[2])||!ei||this.rules.inline.punctuation.exec(ei))){let ii=[...ti[0]].length-1,ri,ni,si=ii,ai=0,oi=ti[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(oi.lastIndex=0,n=n.slice(-1*e.length+ii);(ti=oi.exec(n))!=null;){if(ri=ti[1]||ti[2]||ti[3]||ti[4]||ti[5]||ti[6],!ri)continue;if(ni=[...ri].length,ti[3]||ti[4]){si+=ni;continue}else if((ti[5]||ti[6])&&ii%3&&!((ii+ni)%3)){ai+=ni;continue}if(si-=ni,si>0)continue;ni=Math.min(ni,ni+si+ai);let li=[...ti[0]][0].length,ci=e.slice(0,ii+ti.index+li+ni);if(Math.min(ii,ni)%2){let di=ci.slice(1,-1);return{type:"em",raw:ci,text:di,tokens:this.lexer.inlineTokens(di)}}let ui=ci.slice(2,-2);return{type:"strong",raw:ci,text:ui,tokens:this.lexer.inlineTokens(ui)}}}}codespan(e){let n=this.rules.inline.code.exec(e);if(n){let ei=n[2].replace(this.rules.other.newLineCharGlobal," "),ti=this.rules.other.nonSpaceChar.test(ei),ii=this.rules.other.startingSpaceChar.test(ei)&&this.rules.other.endingSpaceChar.test(ei);return ti&&ii&&(ei=ei.substring(1,ei.length-1)),{type:"codespan",raw:n[0],text:ei}}}br(e){let n=this.rules.inline.br.exec(e);if(n)return{type:"br",raw:n[0]}}del(e){let n=this.rules.inline.del.exec(e);if(n)return{type:"del",raw:n[0],text:n[2],tokens:this.lexer.inlineTokens(n[2])}}autolink(e){let n=this.rules.inline.autolink.exec(e);if(n){let ei,ti;return n[2]==="@"?(ei=n[1],ti="mailto:"+ei):(ei=n[1],ti=ei),{type:"link",raw:n[0],text:ei,href:ti,tokens:[{type:"text",raw:ei,text:ei}]}}}url(e){var ei;let n;if(n=this.rules.inline.url.exec(e)){let ti,ii;if(n[2]==="@")ti=n[0],ii="mailto:"+ti;else{let ri;do ri=n[0],n[0]=((ei=this.rules.inline._backpedal.exec(n[0]))==null?void 0:ei[0])??"";while(ri!==n[0]);ti=n[0],n[1]==="www."?ii="http://"+n[0]:ii=n[0]}return{type:"link",raw:n[0],text:ti,href:ii,tokens:[{type:"text",raw:ti,text:ti}]}}}inlineText(e){let n=this.rules.inline.text.exec(e);if(n){let ei=this.lexer.state.inRawBlock;return{type:"text",raw:n[0],text:n[0],escaped:ei}}}},x$3=class nc{constructor(e){qr(this,"tokens");qr(this,"options");qr(this,"state");qr(this,"tokenizer");qr(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||T$1,this.options.tokenizer=this.options.tokenizer||new y$2,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let n={other:m$1,block:C$2.normal,inline:M$2.normal};this.options.pedantic?(n.block=C$2.pedantic,n.inline=M$2.pedantic):this.options.gfm&&(n.block=C$2.gfm,this.options.breaks?n.inline=M$2.breaks:n.inline=M$2.gfm),this.tokenizer.rules=n}static get rules(){return{block:C$2,inline:M$2}}static lex(e,n){return new nc(n).lex(e)}static lexInline(e,n){return new nc(n).inlineTokens(e)}lex(e){e=e.replace(m$1.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let n=0;n<this.inlineQueue.length;n++){let ei=this.inlineQueue[n];this.inlineTokens(ei.src,ei.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,n=[],ei=!1){var ti,ii,ri;for(this.options.pedantic&&(e=e.replace(m$1.tabCharGlobal,"    ").replace(m$1.spaceLine,""));e;){let ni;if((ii=(ti=this.options.extensions)==null?void 0:ti.block)!=null&&ii.some(ai=>(ni=ai.call({lexer:this},e,n))?(e=e.substring(ni.raw.length),n.push(ni),!0):!1))continue;if(ni=this.tokenizer.space(e)){e=e.substring(ni.raw.length);let ai=n.at(-1);ni.raw.length===1&&ai!==void 0?ai.raw+=`
`:n.push(ni);continue}if(ni=this.tokenizer.code(e)){e=e.substring(ni.raw.length);let ai=n.at(-1);(ai==null?void 0:ai.type)==="paragraph"||(ai==null?void 0:ai.type)==="text"?(ai.raw+=(ai.raw.endsWith(`
`)?"":`
`)+ni.raw,ai.text+=`
`+ni.text,this.inlineQueue.at(-1).src=ai.text):n.push(ni);continue}if(ni=this.tokenizer.fences(e)){e=e.substring(ni.raw.length),n.push(ni);continue}if(ni=this.tokenizer.heading(e)){e=e.substring(ni.raw.length),n.push(ni);continue}if(ni=this.tokenizer.hr(e)){e=e.substring(ni.raw.length),n.push(ni);continue}if(ni=this.tokenizer.blockquote(e)){e=e.substring(ni.raw.length),n.push(ni);continue}if(ni=this.tokenizer.list(e)){e=e.substring(ni.raw.length),n.push(ni);continue}if(ni=this.tokenizer.html(e)){e=e.substring(ni.raw.length),n.push(ni);continue}if(ni=this.tokenizer.def(e)){e=e.substring(ni.raw.length);let ai=n.at(-1);(ai==null?void 0:ai.type)==="paragraph"||(ai==null?void 0:ai.type)==="text"?(ai.raw+=(ai.raw.endsWith(`
`)?"":`
`)+ni.raw,ai.text+=`
`+ni.raw,this.inlineQueue.at(-1).src=ai.text):this.tokens.links[ni.tag]||(this.tokens.links[ni.tag]={href:ni.href,title:ni.title},n.push(ni));continue}if(ni=this.tokenizer.table(e)){e=e.substring(ni.raw.length),n.push(ni);continue}if(ni=this.tokenizer.lheading(e)){e=e.substring(ni.raw.length),n.push(ni);continue}let si=e;if((ri=this.options.extensions)!=null&&ri.startBlock){let ai=1/0,oi=e.slice(1),li;this.options.extensions.startBlock.forEach(ci=>{li=ci.call({lexer:this},oi),typeof li=="number"&&li>=0&&(ai=Math.min(ai,li))}),ai<1/0&&ai>=0&&(si=e.substring(0,ai+1))}if(this.state.top&&(ni=this.tokenizer.paragraph(si))){let ai=n.at(-1);ei&&(ai==null?void 0:ai.type)==="paragraph"?(ai.raw+=(ai.raw.endsWith(`
`)?"":`
`)+ni.raw,ai.text+=`
`+ni.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=ai.text):n.push(ni),ei=si.length!==e.length,e=e.substring(ni.raw.length);continue}if(ni=this.tokenizer.text(e)){e=e.substring(ni.raw.length);let ai=n.at(-1);(ai==null?void 0:ai.type)==="text"?(ai.raw+=(ai.raw.endsWith(`
`)?"":`
`)+ni.raw,ai.text+=`
`+ni.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=ai.text):n.push(ni);continue}if(e){let ai="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(ai);break}else throw new Error(ai)}}return this.state.top=!0,n}inline(e,n=[]){return this.inlineQueue.push({src:e,tokens:n}),n}inlineTokens(e,n=[]){var si,ai,oi,li,ci;let ei=e,ti=null;if(this.tokens.links){let ui=Object.keys(this.tokens.links);if(ui.length>0)for(;(ti=this.tokenizer.rules.inline.reflinkSearch.exec(ei))!=null;)ui.includes(ti[0].slice(ti[0].lastIndexOf("[")+1,-1))&&(ei=ei.slice(0,ti.index)+"["+"a".repeat(ti[0].length-2)+"]"+ei.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(ti=this.tokenizer.rules.inline.anyPunctuation.exec(ei))!=null;)ei=ei.slice(0,ti.index)+"++"+ei.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let ii;for(;(ti=this.tokenizer.rules.inline.blockSkip.exec(ei))!=null;)ii=ti[2]?ti[2].length:0,ei=ei.slice(0,ti.index+ii)+"["+"a".repeat(ti[0].length-ii-2)+"]"+ei.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);ei=((ai=(si=this.options.hooks)==null?void 0:si.emStrongMask)==null?void 0:ai.call({lexer:this},ei))??ei;let ri=!1,ni="";for(;e;){ri||(ni=""),ri=!1;let ui;if((li=(oi=this.options.extensions)==null?void 0:oi.inline)!=null&&li.some(fi=>(ui=fi.call({lexer:this},e,n))?(e=e.substring(ui.raw.length),n.push(ui),!0):!1))continue;if(ui=this.tokenizer.escape(e)){e=e.substring(ui.raw.length),n.push(ui);continue}if(ui=this.tokenizer.tag(e)){e=e.substring(ui.raw.length),n.push(ui);continue}if(ui=this.tokenizer.link(e)){e=e.substring(ui.raw.length),n.push(ui);continue}if(ui=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(ui.raw.length);let fi=n.at(-1);ui.type==="text"&&(fi==null?void 0:fi.type)==="text"?(fi.raw+=ui.raw,fi.text+=ui.text):n.push(ui);continue}if(ui=this.tokenizer.emStrong(e,ei,ni)){e=e.substring(ui.raw.length),n.push(ui);continue}if(ui=this.tokenizer.codespan(e)){e=e.substring(ui.raw.length),n.push(ui);continue}if(ui=this.tokenizer.br(e)){e=e.substring(ui.raw.length),n.push(ui);continue}if(ui=this.tokenizer.del(e)){e=e.substring(ui.raw.length),n.push(ui);continue}if(ui=this.tokenizer.autolink(e)){e=e.substring(ui.raw.length),n.push(ui);continue}if(!this.state.inLink&&(ui=this.tokenizer.url(e))){e=e.substring(ui.raw.length),n.push(ui);continue}let di=e;if((ci=this.options.extensions)!=null&&ci.startInline){let fi=1/0,hi=e.slice(1),pi;this.options.extensions.startInline.forEach(gi=>{pi=gi.call({lexer:this},hi),typeof pi=="number"&&pi>=0&&(fi=Math.min(fi,pi))}),fi<1/0&&fi>=0&&(di=e.substring(0,fi+1))}if(ui=this.tokenizer.inlineText(di)){e=e.substring(ui.raw.length),ui.raw.slice(-1)!=="_"&&(ni=ui.raw.slice(-1)),ri=!0;let fi=n.at(-1);(fi==null?void 0:fi.type)==="text"?(fi.raw+=ui.raw,fi.text+=ui.text):n.push(ui);continue}if(e){let fi="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(fi);break}else throw new Error(fi)}}return n}},P$2=class{constructor(e){qr(this,"options");qr(this,"parser");this.options=e||T$1}space(e){return""}code({text:e,lang:n,escaped:ei}){var ri;let ti=(ri=(n||"").match(m$1.notSpaceStart))==null?void 0:ri[0],ii=e.replace(m$1.endingNewline,"")+`
`;return ti?'<pre><code class="language-'+w$2(ti)+'">'+(ei?ii:w$2(ii,!0))+`</code></pre>
`:"<pre><code>"+(ei?ii:w$2(ii,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}def(e){return""}heading({tokens:e,depth:n}){return`<h${n}>${this.parser.parseInline(e)}</h${n}>
`}hr(e){return`<hr>
`}list(e){let n=e.ordered,ei=e.start,ti="";for(let ni=0;ni<e.items.length;ni++){let si=e.items[ni];ti+=this.listitem(si)}let ii=n?"ol":"ul",ri=n&&ei!==1?' start="'+ei+'"':"";return"<"+ii+ri+`>
`+ti+"</"+ii+`>
`}listitem(e){var ei;let n="";if(e.task){let ti=this.checkbox({checked:!!e.checked});e.loose?((ei=e.tokens[0])==null?void 0:ei.type)==="paragraph"?(e.tokens[0].text=ti+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&e.tokens[0].tokens[0].type==="text"&&(e.tokens[0].tokens[0].text=ti+" "+w$2(e.tokens[0].tokens[0].text),e.tokens[0].tokens[0].escaped=!0)):e.tokens.unshift({type:"text",raw:ti+" ",text:ti+" ",escaped:!0}):n+=ti+" "}return n+=this.parser.parse(e.tokens,!!e.loose),`<li>${n}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let n="",ei="";for(let ii=0;ii<e.header.length;ii++)ei+=this.tablecell(e.header[ii]);n+=this.tablerow({text:ei});let ti="";for(let ii=0;ii<e.rows.length;ii++){let ri=e.rows[ii];ei="";for(let ni=0;ni<ri.length;ni++)ei+=this.tablecell(ri[ni]);ti+=this.tablerow({text:ei})}return ti&&(ti=`<tbody>${ti}</tbody>`),`<table>
<thead>
`+n+`</thead>
`+ti+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){let n=this.parser.parseInline(e.tokens),ei=e.header?"th":"td";return(e.align?`<${ei} align="${e.align}">`:`<${ei}>`)+n+`</${ei}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${w$2(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:n,tokens:ei}){let ti=this.parser.parseInline(ei),ii=J$1(e);if(ii===null)return ti;e=ii;let ri='<a href="'+e+'"';return n&&(ri+=' title="'+w$2(n)+'"'),ri+=">"+ti+"</a>",ri}image({href:e,title:n,text:ei,tokens:ti}){ti&&(ei=this.parser.parseInline(ti,this.parser.textRenderer));let ii=J$1(e);if(ii===null)return w$2(ei);e=ii;let ri=`<img src="${e}" alt="${ei}"`;return n&&(ri+=` title="${w$2(n)}"`),ri+=">",ri}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:w$2(e.text)}},$$1=class{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}},b$2=class sc{constructor(e){qr(this,"options");qr(this,"renderer");qr(this,"textRenderer");this.options=e||T$1,this.options.renderer=this.options.renderer||new P$2,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new $$1}static parse(e,n){return new sc(n).parse(e)}static parseInline(e,n){return new sc(n).parseInline(e)}parse(e,n=!0){var ti,ii;let ei="";for(let ri=0;ri<e.length;ri++){let ni=e[ri];if((ii=(ti=this.options.extensions)==null?void 0:ti.renderers)!=null&&ii[ni.type]){let ai=ni,oi=this.options.extensions.renderers[ai.type].call({parser:this},ai);if(oi!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(ai.type)){ei+=oi||"";continue}}let si=ni;switch(si.type){case"space":{ei+=this.renderer.space(si);continue}case"hr":{ei+=this.renderer.hr(si);continue}case"heading":{ei+=this.renderer.heading(si);continue}case"code":{ei+=this.renderer.code(si);continue}case"table":{ei+=this.renderer.table(si);continue}case"blockquote":{ei+=this.renderer.blockquote(si);continue}case"list":{ei+=this.renderer.list(si);continue}case"html":{ei+=this.renderer.html(si);continue}case"def":{ei+=this.renderer.def(si);continue}case"paragraph":{ei+=this.renderer.paragraph(si);continue}case"text":{let ai=si,oi=this.renderer.text(ai);for(;ri+1<e.length&&e[ri+1].type==="text";)ai=e[++ri],oi+=`
`+this.renderer.text(ai);n?ei+=this.renderer.paragraph({type:"paragraph",raw:oi,text:oi,tokens:[{type:"text",raw:oi,text:oi,escaped:!0}]}):ei+=oi;continue}default:{let ai='Token with "'+si.type+'" type was not found.';if(this.options.silent)return console.error(ai),"";throw new Error(ai)}}}return ei}parseInline(e,n=this.renderer){var ti,ii;let ei="";for(let ri=0;ri<e.length;ri++){let ni=e[ri];if((ii=(ti=this.options.extensions)==null?void 0:ti.renderers)!=null&&ii[ni.type]){let ai=this.options.extensions.renderers[ni.type].call({parser:this},ni);if(ai!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(ni.type)){ei+=ai||"";continue}}let si=ni;switch(si.type){case"escape":{ei+=n.text(si);break}case"html":{ei+=n.html(si);break}case"link":{ei+=n.link(si);break}case"image":{ei+=n.image(si);break}case"strong":{ei+=n.strong(si);break}case"em":{ei+=n.em(si);break}case"codespan":{ei+=n.codespan(si);break}case"br":{ei+=n.br(si);break}case"del":{ei+=n.del(si);break}case"text":{ei+=n.text(si);break}default:{let ai='Token with "'+si.type+'" type was not found.';if(this.options.silent)return console.error(ai),"";throw new Error(ai)}}}return ei}},El,S$2=(El=class{constructor(e){qr(this,"options");qr(this,"block");this.options=e||T$1}preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}emStrongMask(e){return e}provideLexer(){return this.block?x$3.lex:x$3.lexInline}provideParser(){return this.block?b$2.parse:b$2.parseInline}},qr(El,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens","emStrongMask"])),qr(El,"passThroughHooksRespectAsync",new Set(["preprocess","postprocess","processAllTokens"])),El),B$1=class{constructor(...e){qr(this,"defaults",L$2());qr(this,"options",this.setOptions);qr(this,"parse",this.parseMarkdown(!0));qr(this,"parseInline",this.parseMarkdown(!1));qr(this,"Parser",b$2);qr(this,"Renderer",P$2);qr(this,"TextRenderer",$$1);qr(this,"Lexer",x$3);qr(this,"Tokenizer",y$2);qr(this,"Hooks",S$2);this.use(...e)}walkTokens(e,n){var ti,ii;let ei=[];for(let ri of e)switch(ei=ei.concat(n.call(this,ri)),ri.type){case"table":{let ni=ri;for(let si of ni.header)ei=ei.concat(this.walkTokens(si.tokens,n));for(let si of ni.rows)for(let ai of si)ei=ei.concat(this.walkTokens(ai.tokens,n));break}case"list":{let ni=ri;ei=ei.concat(this.walkTokens(ni.items,n));break}default:{let ni=ri;(ii=(ti=this.defaults.extensions)==null?void 0:ti.childTokens)!=null&&ii[ni.type]?this.defaults.extensions.childTokens[ni.type].forEach(si=>{let ai=ni[si].flat(1/0);ei=ei.concat(this.walkTokens(ai,n))}):ni.tokens&&(ei=ei.concat(this.walkTokens(ni.tokens,n)))}}return ei}use(...e){let n=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(ei=>{let ti={...ei};if(ti.async=this.defaults.async||ti.async||!1,ei.extensions&&(ei.extensions.forEach(ii=>{if(!ii.name)throw new Error("extension name required");if("renderer"in ii){let ri=n.renderers[ii.name];ri?n.renderers[ii.name]=function(...ni){let si=ii.renderer.apply(this,ni);return si===!1&&(si=ri.apply(this,ni)),si}:n.renderers[ii.name]=ii.renderer}if("tokenizer"in ii){if(!ii.level||ii.level!=="block"&&ii.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let ri=n[ii.level];ri?ri.unshift(ii.tokenizer):n[ii.level]=[ii.tokenizer],ii.start&&(ii.level==="block"?n.startBlock?n.startBlock.push(ii.start):n.startBlock=[ii.start]:ii.level==="inline"&&(n.startInline?n.startInline.push(ii.start):n.startInline=[ii.start]))}"childTokens"in ii&&ii.childTokens&&(n.childTokens[ii.name]=ii.childTokens)}),ti.extensions=n),ei.renderer){let ii=this.defaults.renderer||new P$2(this.defaults);for(let ri in ei.renderer){if(!(ri in ii))throw new Error(`renderer '${ri}' does not exist`);if(["options","parser"].includes(ri))continue;let ni=ri,si=ei.renderer[ni],ai=ii[ni];ii[ni]=(...oi)=>{let li=si.apply(ii,oi);return li===!1&&(li=ai.apply(ii,oi)),li||""}}ti.renderer=ii}if(ei.tokenizer){let ii=this.defaults.tokenizer||new y$2(this.defaults);for(let ri in ei.tokenizer){if(!(ri in ii))throw new Error(`tokenizer '${ri}' does not exist`);if(["options","rules","lexer"].includes(ri))continue;let ni=ri,si=ei.tokenizer[ni],ai=ii[ni];ii[ni]=(...oi)=>{let li=si.apply(ii,oi);return li===!1&&(li=ai.apply(ii,oi)),li}}ti.tokenizer=ii}if(ei.hooks){let ii=this.defaults.hooks||new S$2;for(let ri in ei.hooks){if(!(ri in ii))throw new Error(`hook '${ri}' does not exist`);if(["options","block"].includes(ri))continue;let ni=ri,si=ei.hooks[ni],ai=ii[ni];S$2.passThroughHooks.has(ri)?ii[ni]=oi=>{if(this.defaults.async&&S$2.passThroughHooksRespectAsync.has(ri))return(async()=>{let ci=await si.call(ii,oi);return ai.call(ii,ci)})();let li=si.call(ii,oi);return ai.call(ii,li)}:ii[ni]=(...oi)=>{if(this.defaults.async)return(async()=>{let ci=await si.apply(ii,oi);return ci===!1&&(ci=await ai.apply(ii,oi)),ci})();let li=si.apply(ii,oi);return li===!1&&(li=ai.apply(ii,oi)),li}}ti.hooks=ii}if(ei.walkTokens){let ii=this.defaults.walkTokens,ri=ei.walkTokens;ti.walkTokens=function(ni){let si=[];return si.push(ri.call(this,ni)),ii&&(si=si.concat(ii.call(this,ni))),si}}this.defaults={...this.defaults,...ti}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,n){return x$3.lex(e,n??this.defaults)}parser(e,n){return b$2.parse(e,n??this.defaults)}parseMarkdown(e){return(n,ei)=>{let ti={...ei},ii={...this.defaults,...ti},ri=this.onError(!!ii.silent,!!ii.async);if(this.defaults.async===!0&&ti.async===!1)return ri(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof n>"u"||n===null)return ri(new Error("marked(): input parameter is undefined or null"));if(typeof n!="string")return ri(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(n)+", string expected"));if(ii.hooks&&(ii.hooks.options=ii,ii.hooks.block=e),ii.async)return(async()=>{let ni=ii.hooks?await ii.hooks.preprocess(n):n,si=await(ii.hooks?await ii.hooks.provideLexer():e?x$3.lex:x$3.lexInline)(ni,ii),ai=ii.hooks?await ii.hooks.processAllTokens(si):si;ii.walkTokens&&await Promise.all(this.walkTokens(ai,ii.walkTokens));let oi=await(ii.hooks?await ii.hooks.provideParser():e?b$2.parse:b$2.parseInline)(ai,ii);return ii.hooks?await ii.hooks.postprocess(oi):oi})().catch(ri);try{ii.hooks&&(n=ii.hooks.preprocess(n));let ni=(ii.hooks?ii.hooks.provideLexer():e?x$3.lex:x$3.lexInline)(n,ii);ii.hooks&&(ni=ii.hooks.processAllTokens(ni)),ii.walkTokens&&this.walkTokens(ni,ii.walkTokens);let si=(ii.hooks?ii.hooks.provideParser():e?b$2.parse:b$2.parseInline)(ni,ii);return ii.hooks&&(si=ii.hooks.postprocess(si)),si}catch(ni){return ri(ni)}}}onError(e,n){return ei=>{if(ei.message+=`
Please report this to https://github.com/markedjs/marked.`,e){let ti="<p>An error occurred:</p><pre>"+w$2(ei.message+"",!0)+"</pre>";return n?Promise.resolve(ti):ti}if(n)return Promise.reject(ei);throw ei}}},_$2=new B$1;function k$2(_t,e){return _$2.parse(_t,e)}k$2.options=k$2.setOptions=function(_t){return _$2.setOptions(_t),k$2.defaults=_$2.defaults,G$1(k$2.defaults),k$2};k$2.getDefaults=L$2;k$2.defaults=T$1;k$2.use=function(..._t){return _$2.use(..._t),k$2.defaults=_$2.defaults,G$1(k$2.defaults),k$2};k$2.walkTokens=function(_t,e){return _$2.walkTokens(_t,e)};k$2.parseInline=_$2.parseInline;k$2.Parser=b$2;k$2.parser=b$2.parse;k$2.Renderer=P$2;k$2.TextRenderer=$$1;k$2.Lexer=x$3;k$2.lexer=x$3.lex;k$2.Tokenizer=y$2;k$2.Hooks=S$2;k$2.parse=k$2;k$2.options;k$2.setOptions;k$2.use;k$2.walkTokens;k$2.parseInline;b$2.parse;x$3.lex;var clusterize={exports:{}},hasRequiredClusterize;function requireClusterize(){return hasRequiredClusterize||(hasRequiredClusterize=1,(function(_t){(function(e,n){_t.exports=n()})("Clusterize",function(){var e=(function(){for(var si=3,ai=document.createElement("b"),oi=ai.all||[];ai.innerHTML="<!--[if gt IE "+ ++si+"]><i><![endif]-->",oi[0];);return si>4?si:document.documentMode})(),n=navigator.platform.toLowerCase().indexOf("mac")+1,ei=function(si){if(!(this instanceof ei))return new ei(si);var ai=this,oi={rows_in_block:50,blocks_in_cluster:4,tag:null,show_no_data_row:!0,no_data_class:"clusterize-no-data",no_data_text:"No data",keep_parity:!0,callbacks:{}};ai.options={};for(var li=["rows_in_block","blocks_in_cluster","show_no_data_row","no_data_class","no_data_text","keep_parity","tag","callbacks"],ci=0,ui;ui=li[ci];ci++)ai.options[ui]=typeof si[ui]<"u"&&si[ui]!=null?si[ui]:oi[ui];for(var di=["scroll","content"],ci=0,fi;fi=di[ci];ci++)if(ai[fi+"_elem"]=si[fi+"Id"]?document.getElementById(si[fi+"Id"]):si[fi+"Elem"],!ai[fi+"_elem"])throw new Error("Error! Could not find "+fi+" element");ai.content_elem.hasAttribute("tabindex")||ai.content_elem.setAttribute("tabindex",0);var hi=ri(si.rows)?si.rows:ai.fetchMarkup(),pi={},gi=ai.scroll_elem.scrollTop;ai.insertToDOM(hi,pi),ai.scroll_elem.scrollTop=gi;var vi=!1,yi=0,_i=!1,Ai=function(){n&&(_i||(ai.content_elem.style.pointerEvents="none"),_i=!0,clearTimeout(yi),yi=setTimeout(function(){ai.content_elem.style.pointerEvents="auto",_i=!1},50)),vi!=(vi=ai.getClusterNum(hi))&&ai.insertToDOM(hi,pi),ai.options.callbacks.scrollingProgress&&ai.options.callbacks.scrollingProgress(ai.getScrollProgress())},Ei=0,Si=function(){clearTimeout(Ei),Ei=setTimeout(ai.refresh,100)};ti("scroll",ai.scroll_elem,Ai),ti("resize",window,Si),ai.destroy=function(Oi){ii("scroll",ai.scroll_elem,Ai),ii("resize",window,Si),ai.html((Oi?ai.generateEmptyRow():hi).join(""))},ai.refresh=function(Oi){(ai.getRowsHeight(hi)||Oi)&&ai.update(hi)},ai.update=function(Oi){hi=ri(Oi)?Oi:[];var Ii=ai.scroll_elem.scrollTop;hi.length*ai.options.item_height<Ii&&(ai.scroll_elem.scrollTop=0,vi=0),ai.insertToDOM(hi,pi),ai.scroll_elem.scrollTop=Ii},ai.clear=function(){ai.update([])},ai.getRowsAmount=function(){return hi.length},ai.getScrollProgress=function(){return this.options.scroll_top/(hi.length*this.options.item_height)*100||0};var wi=function(Oi,Ii){var Li=ri(Ii)?Ii:[];Li.length&&(hi=Oi=="append"?hi.concat(Li):Li.concat(hi),ai.insertToDOM(hi,pi))};ai.append=function(Oi){wi("append",Oi)},ai.prepend=function(Oi){wi("prepend",Oi)}};ei.prototype={constructor:ei,fetchMarkup:function(){for(var si=[],ai=this.getChildNodes(this.content_elem);ai.length;)si.push(ai.shift().outerHTML);return si},exploreEnvironment:function(si,ai){var oi=this.options;oi.content_tag=this.content_elem.tagName.toLowerCase(),si.length&&(e&&e<=9&&!oi.tag&&(oi.tag=si[0].match(/<([^>\s/]*)/)[1].toLowerCase()),this.content_elem.children.length<=1&&(ai.data=this.html(si[0]+si[0]+si[0])),oi.tag||(oi.tag=this.content_elem.children[0].tagName.toLowerCase()),this.getRowsHeight(si))},getRowsHeight:function(si){var ai=this.options,oi=ai.item_height;if(ai.cluster_height=0,!!si.length){var li=this.content_elem.children;if(li.length){var ci=li[Math.floor(li.length/2)];if(ai.item_height=ci.offsetHeight,ai.tag=="tr"&&ni("borderCollapse",this.content_elem)!="collapse"&&(ai.item_height+=parseInt(ni("borderSpacing",this.content_elem),10)||0),ai.tag!="tr"){var ui=parseInt(ni("marginTop",ci),10)||0,di=parseInt(ni("marginBottom",ci),10)||0;ai.item_height+=Math.max(ui,di)}return ai.block_height=ai.item_height*ai.rows_in_block,ai.rows_in_cluster=ai.blocks_in_cluster*ai.rows_in_block,ai.cluster_height=ai.blocks_in_cluster*ai.block_height,oi!=ai.item_height}}},getClusterNum:function(si){var ai=this.options;ai.scroll_top=this.scroll_elem.scrollTop;var oi=ai.cluster_height-ai.block_height,li=Math.floor(ai.scroll_top/oi),ci=Math.floor(si.length*ai.item_height/oi);return Math.min(li,ci)},generateEmptyRow:function(){var si=this.options;if(!si.tag||!si.show_no_data_row)return[];var ai=document.createElement(si.tag),oi=document.createTextNode(si.no_data_text),li;return ai.className=si.no_data_class,si.tag=="tr"&&(li=document.createElement("td"),li.colSpan=100,li.appendChild(oi)),ai.appendChild(li||oi),[ai.outerHTML]},generate:function(si){var ai=this.options,oi=si.length;if(oi<ai.rows_in_block)return{top_offset:0,bottom_offset:0,rows_above:0,rows:oi?si:this.generateEmptyRow()};var li=Math.max((ai.rows_in_cluster-ai.rows_in_block)*this.getClusterNum(si),0),ci=li+ai.rows_in_cluster,ui=Math.max(li*ai.item_height,0),di=Math.max((oi-ci)*ai.item_height,0),fi=[],hi=li;ui<1&&hi++;for(var pi=li;pi<ci;pi++)si[pi]&&fi.push(si[pi]);return{top_offset:ui,bottom_offset:di,rows_above:hi,rows:fi}},renderExtraTag:function(si,ai){var oi=document.createElement(this.options.tag),li="clusterize-";return oi.className=[li+"extra-row",li+si].join(" "),ai&&(oi.style.height=ai+"px"),oi.outerHTML},insertToDOM:function(si,ai){this.options.cluster_height||this.exploreEnvironment(si,ai);var oi=this.generate(si),li=oi.rows.join(""),ci=this.checkChanges("data",li,ai),ui=this.checkChanges("top",oi.top_offset,ai),di=this.checkChanges("bottom",oi.bottom_offset,ai),fi=this.options.callbacks,hi=[];ci||ui?(oi.top_offset&&(this.options.keep_parity&&hi.push(this.renderExtraTag("keep-parity")),hi.push(this.renderExtraTag("top-space",oi.top_offset))),hi.push(li),oi.bottom_offset&&hi.push(this.renderExtraTag("bottom-space",oi.bottom_offset)),fi.clusterWillChange&&fi.clusterWillChange(),this.html(hi.join("")),this.options.content_tag=="ol"&&this.content_elem.setAttribute("start",oi.rows_above),this.content_elem.style["counter-increment"]="clusterize-counter "+(oi.rows_above-1),fi.clusterChanged&&fi.clusterChanged()):di&&(this.content_elem.lastChild.style.height=oi.bottom_offset+"px")},html:function(si){var ai=this.content_elem;if(e&&e<=9&&this.options.tag=="tr"){var oi=document.createElement("div"),li;for(oi.innerHTML="<table><tbody>"+si+"</tbody></table>";li=ai.lastChild;)ai.removeChild(li);for(var ci=this.getChildNodes(oi.firstChild.firstChild);ci.length;)ai.appendChild(ci.shift())}else ai.innerHTML=si},getChildNodes:function(si){for(var ai=si.children,oi=[],li=0,ci=ai.length;li<ci;li++)oi.push(ai[li]);return oi},checkChanges:function(si,ai,oi){var li=ai!=oi[si];return oi[si]=ai,li}};function ti(si,ai,oi){return ai.addEventListener?ai.addEventListener(si,oi,!1):ai.attachEvent("on"+si,oi)}function ii(si,ai,oi){return ai.removeEventListener?ai.removeEventListener(si,oi,!1):ai.detachEvent("on"+si,oi)}function ri(si){return Object.prototype.toString.call(si)==="[object Array]"}function ni(si,ai){return window.getComputedStyle?window.getComputedStyle(ai)[si]:ai.currentStyle[si]}return ei})})(clusterize)),clusterize.exports}var clusterizeExports=requireClusterize();const Clusterize=getDefaultExportFromCjs$1(clusterizeExports);Clusterize.default;var logger$4=LoggerByDefault.getLogger("widget");class Catalog extends ControlExtended{constructor(e){if(e=e||{},super(e),!(this instanceof Catalog))throw new TypeError("ERROR CLASS_CONSTRUCTOR");return this.CLASSNAME="Catalog",this.initialize(e),this.container=this.initContainer(),this.element?this.element.appendChild(this.container):this.element=this.container,this.showWaiting(),this.initConfigData().then(n=>{logger$4.trace(this,n),this.hideWaiting(),this.configData=n,this.dispatchEvent({type:this.LOADED_CATALOG_EVENT,data:n})}).catch(n=>{this.hideWaiting(),logger$4.error(n)}),this}setMap(e){e?(this.on("catalog:loaded",this.checkLayersOnMap),this.draggable&&Draggable.dragElement(this.panelCatalogContainer,this.panelCatalogHeaderContainer,e.getTargetElement()),this.collapsed||this.buttonCatalogShow.setAttribute("aria-pressed",!0),this.auto&&this.addEventsListeners(e)):(this.un("catalog:loaded",this.checkLayersOnMap),this.auto&&this.removeEventsListeners()),super.setMap(e),this.options.position&&this.setPosition(this.options.position),this.options.gutter===!1&&this.getContainer().classList.add("gpf-button-no-gutter")}getCollapsed(){return this.collapsed}setCollapsed(e){if(e===void 0){logger$4.error("[ERROR] Catalog:setCollapsed - missing collapsed parameter");return}e&&this.collapsed||!e&&!this.collapsed||(e?this.buttonCatalogClose.click():this.buttonCatalogShow.click(),this.collapsed=e)}addLayerConfig(e){for(const ti in e)if(Object.prototype.hasOwnProperty.call(e,ti)){const ii=e[ti];if(ii.serviceParams){var n=ii.serviceParams.id.split(":").slice(-1)[0];ii.service=n,ii.categories=[],ii.producer_urls=this.createCatalogLinks("producer",ii.producer),ii.thematic_urls=this.createCatalogLinks("thematic",ii.thematic),this.layersList[ti]=ii}}var ei=document.getElementById("GPcatalogContainerTabs");ei&&ei.remove(),this.layersList.sort((ti,ii)=>ti.title.localeCompare(ii.title,"fr",{sensitivity:"base"})),this.createCatalogContentEntries(this.layersList)}activeLayerByID(e){var n=e.split("$")[0],ei=e.split(":").slice(-1)[0];this.activeLayer(n,ei)}disableLayerByID(e){var n=e.split("$")[0],ei=e.split(":").slice(-1)[0];this.disableLayer(n,ei)}activeLayer(e,n){var ei=this.getLayerId(e,n);if(ei){var ti={};this.options.addToMap&&(ti=this.addLayer(e,n)),this.dispatchEvent({type:this.ADD_CATALOG_LAYER_EVENT,name:e,service:n,layer:ti})}}disableLayer(e,n){var ei=this.getLayerId(e,n);if(ei){var ti={};this.options.addToMap&&(ti=this.removeLayer(e,n)),this.dispatchEvent({type:this.REMOVE_CATALOG_LAYER_EVENT,name:e,service:n,layer:ti})}}getLayerId(e,n){if(!this.layersList||typeof this.layersList!="object")return null;var ei=new RegExp(e+".*"+n);for(const ti in this.layersList)if(Object.prototype.hasOwnProperty.call(this.layersList,ti)&&ei.test(ti))return ti;return null}getLayersByCategory(e,n){var ei=Object.values(n).map(ni=>ni);e.order&&(ei=Object.values(n).sort((ni,si)=>ni.title.localeCompare(si.title,"fr",{sensitivity:"base"})));var ti=e.filter;if(ti){var ii=[];for(let ni=0;ni<ei.length;ni++){const si=ei[ni];if(si[ti.field]){var ri=Array.isArray(ti.value)?ti.value.includes(si[ti.field].toString()):ti.value==="*"||si[ti.field].toString()===ti.value;ri&&(ii.push(si),this.layersList[si.key].categories.push(e.id))}}ei=ii}if(e.featured&&this.featuredLayersList&&this.featuredLayersList.length>0){const ni=this.featuredLayersList,si=Object.fromEntries(ei.map(li=>[li.name,li])),ai=ni.map(li=>si[li]).filter(Boolean),oi=ei.filter(li=>!ni.includes(li.name));ei=[...ai,...oi]}return ei}getContainer(){return this.container}initialize(e){this.uid=e.id||SelectorID.generate(),this.clusterOptions={rows_in_block:50,blocks_in_cluster:4},this.options={collapsed:!0,draggable:!1,auto:!0,titlePrimary:"Grer vos couches de donnes",titleSecondary:"",layerLabel:"title",layerThumbnail:!1,tabHeightAuto:!1,optimisation:"none",size:"md",search:{display:!0,label:"Rechercher une donne",criteria:["name","title","description"]},addToMap:!0,categories:[{title:"Donnes",id:"data",order:!1,featured:!1,cluster:!0,clusterOptions:this.clusterOptions,default:!0,filter:null}],configuration:{type:"json",urls:["https://raw.githubusercontent.com/IGNF/geoportal-configuration/new-url/dist/entreeCarto.json"]}};var n=Helper.assign(this.options.search,e.search);Helper.assign(this.options,e),Helper.assign(this.options.search,n),this.collapsed=this.options.collapsed,this.draggable=this.options.draggable,this.auto=this.options.auto,this.eventsListeners=[],this.buttonCatalogShow=null,this.panelCatalogContainer=null,this.panelCatalogHeaderContainer=null,this.buttonCatalogClose=null,this.contentCatalogContainer=null,this.waitingContainer=null,this.configData={},this.layersList={},this.featuredLayersList=[],this.clusterizeRef={},this.clusterizeSections={},this.dataOnDemand={},this.categories=this.options.categories.map(ei=>{var ti=ei.items;return ei.items&&(ti=ei.items.map(ii=>({title:ii.title,id:ii.id||this.generateID(ii.title),default:ii.hasOwnProperty("default")?ii.default:!1,order:ii.hasOwnProperty("order")?ii.order:!1,featured:ii.hasOwnProperty("featured")?ii.featured:!1,section:ii.hasOwnProperty("section")?ii.section:!1,sections:[],subcategory:!0,icon:ii.hasOwnProperty("icon")?ii.icon:!1,iconJson:ii.iconJson||[],cluster:ii.hasOwnProperty("cluster")?ii.cluster:!1,clusterOptions:ii.hasOwnProperty("clusterOptions")?ii.clusterOptions:this.clusterOptions,filter:ii.filter||null}))),{title:ei.title,id:ei.id||this.generateID(ei.title),default:ei.hasOwnProperty("default")?ei.default:!1,order:ei.hasOwnProperty("order")?ei.order:!1,featured:ei.hasOwnProperty("featured")?ei.featured:!1,search:ei.hasOwnProperty("search")?ei.search:!1,cluster:ei.hasOwnProperty("cluster")?ei.cluster:!1,clusterOptions:ei.hasOwnProperty("clusterOptions")?ei.clusterOptions:this.clusterOptions,filter:ei.filter||null,items:ti||null}}),this.categoryId=(()=>{var ei=this.categories.findIndex(ti=>ti.default);return ei===-1&&(ei=0,this.categories[ei].default=!0),this.categories[ei].id})(),this.layersListOnMap={},this._searchTimeout=null,this.ADD_CATALOG_LAYER_EVENT="catalog:layer:add",this.REMOVE_CATALOG_LAYER_EVENT="catalog:layer:remove",this.LOADED_CATALOG_EVENT="catalog:loaded"}initContainer(){var e=this._createMainContainerElement(),n=this.buttonCatalogShow=this._createShowCatalogPictoElement();e.appendChild(n);var ei=this.panelCatalogContainer=this._createCatalogPanelElement(),ti=this._createCatalogPanelDivSizeElement(this.options.size);ei.appendChild(ti);var ii=this._createCatalogPanelDivElement();ti.appendChild(ii);var ri=this.panelCatalogHeaderContainer=this._createCatalogPanelHeaderElement(),ni=this._createCatalogPanelIconElement(this.options.titlePrimary);ri.appendChild(ni);var si=this._createCatalogPanelTitleElement(this.options.titlePrimary);ri.appendChild(si);var ai=this.buttonCatalogClose=this._createCatalogPanelCloseElement();ri.appendChild(ai),ii.appendChild(ri);var oi=this._createCatalogPanelContentDivElement(),li=this.contentCatalogContainer=this._createCatalogContentDivElement();li.appendChild(this._createCatalogContentTitleElement(this.options.titleSecondary)),this.options.search.display&&li.appendChild(this._createCatalogContentSearchGlobalElement(this.options.search.label));var ci=this.waitingContainer=this._createCatalogWaitingElement();return li.appendChild(ci),oi.appendChild(li),ii.appendChild(oi),e.appendChild(ei),e}checkLayersOnMap(){var e=this.getMap();if(e){var n=e.getLayers();n.forEach(ei=>{if(ei.name&&ei.service){this.layersListOnMap[ei.name+":"+ei.service]=ei;var ti=document.querySelectorAll(`input[data-layer="${ei.name}:${ei.service}"]`);ti&&ti.forEach(ii=>{ii.checked=!0})}})}}async initConfigData(){var e=null;if(this.options.configuration.data)return e=this.options.configuration.data||{},Config.isConfigLoaded()&&Helper.mergeParams(e,Config.configuration),this.checkConfigLayers(e.layers),this.layersList=e.layers,this.featuredLayersList=e.featured,this.createCatalogContentEntries(e),new Promise((ei,ti)=>{ei(e)});if(this.options.configuration.urls){var n=[];for(let ei=0;ei<this.options.configuration.urls.length;ei++){const ti=this.options.configuration.urls[ei],ii=function(){return fetch(ti,{}).then(function(ri){if(ri.ok)return ri.json().then(function(si){return si}).catch(si=>{logger$4.warn("fetch json exception :",si)});var ni=new Error("HTTP status code: "+ri.status);throw ni}).catch(ri=>new Promise((ni,si)=>{logger$4.error("fetch json exception :",ri),si(ri)}))};n.push(ii())}try{const ei=await Promise.all(n);e=ei[0];for(let ti=1;ti<ei.length;ti++){const ii=ei[ti];Helper.mergeParams(e,ii)}return Config.isConfigLoaded()&&Helper.mergeParams(e,Config.configuration),this.checkConfigLayers(e.layers),this.layersList=e.layers,this.featuredLayersList=e.featured,this.createCatalogContentEntries(e),await new Promise((ti,ii)=>{ti(e)})}catch(ei){return await new Promise((ti,ii)=>{ii(ei)})}}}checkConfigLayers(e){for(const ei in e)if(Object.prototype.hasOwnProperty.call(e,ei)){const ti=e[ei];if(ti.serviceParams){if((ri=>{const ni=document.createElement("div");return ni.innerHTML=ri.trim(),ni.childNodes.length>0&&ni.firstChild.nodeType===1})(ti.description)){logger$4.error(`layer description contains HTML code, which is not allowed. Layer: ${ei}`),logger$4.error("Please use Markdown syntax for layer descriptions instead."),logger$4.error(ti.description),delete e[ei];continue}var n=ti.serviceParams.id.split(":").slice(-1)[0];ti.service=n,ti.categories=[],ti.key=ei,ti.producer_urls=this.createCatalogProducerLinks(ti.producer),ti.thematic_urls=this.createCatalogThematicLinks(ti.thematic),ti.label=this.options.layerLabel&&ti[this.options.layerLabel]||ti.title,ti.description=k$2.parse(ti.description),this.options.layerThumbnail?ti.thumbnail||(ti.thumbnail="default"):ti.thumbnail&&delete ti.thumbnail}else delete e[ei]}}createCatalogContentEntries(e){var n=this.contentCatalogContainer,ei=this._createCatalogContentCategoriesTabs(this.categories,this.options.tabHeightAuto);n.appendChild(ei);var ti=[];this.categories.forEach(si=>{if(si.items)for(let ai=0;ai<si.items.length;ai++){const oi=si.items[ai];if(oi.icon&&oi.iconJson.length===0&&oi.section&&oi.filter){const li=oi.filter.field;e.topics&&e.topics[li]?oi.iconJson=e.topics[li]:e[li]?oi.iconJson=e[li]:Topics[li]?oi.iconJson=Topics[li]:oi.iconJson=[]}oi.subcategory=!0,ti.push(oi)}else ti.push(si)}),ti.findIndex(si=>si.id===this.categoryId);var ii=n.querySelectorAll(".tabcontent");for(let si=0;si<ii.length;si++){const ai=ii[si];var ri=this.getLayersByCategory(ti[si],e.layers),ni=ti[si].cluster&&this.options.optimisation==="clusterize"||this.options.optimisation==="on-demand";this._createCatalogContentCategoryTabContent(ti[si],ri,ni).then(oi=>{const li=document.createDocumentFragment();if(oi.dom)if(li.appendChild(oi.dom),ai.appendChild(li),console.log(`Content for category ${ti[si].title} created.`),ti[si].cluster&&this.options.optimisation==="clusterize")ti[si].section?(console.warn(`No clustering at initialization for sections : ${ti[si].title} !`),this.clusterizeSections[ti[si].id]=oi.blocks.reduce((ci,ui)=>(ci[ui.domid]=ui.rows,ci),{}),this._updateListenersLayersDOM(ai,ti[si].id)):this.clusterizeRef[ti[si].id]=new Clusterize({scrollId:ai.parentElement.id,contentId:oi.blocks[0].domid,rows:oi.blocks[0].rows,rows_in_block:ti[si].clusterOptions.rows_in_block,blocks_in_cluster:ti[si].clusterOptions.blocks_in_cluster,callbacks:{clusterChanged:()=>{logger$4.trace("cluster changed"),this._updateListenersLayersDOM(ai,ti[si].id),this.checkLayersOnMap()}}});else if(this.options.optimisation==="on-demand"){if(ti[si].section)this.dataOnDemand[ti[si].id]=oi.blocks.reduce((ci,ui)=>(ci[ui.domid]=ui.fragment,ci),{});else if(this.dataOnDemand[ti[si].id]=oi.blocks[0].fragment,ti[si].default){const ui=(di=>{const fi=document.createDocumentFragment();return di.childNodes.forEach(hi=>{fi.appendChild(hi.cloneNode(!0))}),fi})(this.dataOnDemand[ti[si].id]);ai.querySelector(`#checkboxes-${ti[si].id}`).appendChild(ui)}this._updateListenersLayersDOM(ai,ti[si].id),this.checkLayersOnMap()}else this._updateListenersLayersDOM(ai,ti[si].id),this.checkLayersOnMap()})}}createCatalogThematicLinks(e){if(!e)return null;var n="https://cartes.gouv.fr/catalogue/search?",ei=[];for(let ii=0;ii<e.length;ii++){const ri=e[ii];if(ri!=="Autres"){var ti=Topics.thematic.find(ni=>ni.name===ri);ti&&ei.push({name:ri,url:n+"topic="+ti.id})}}return ei.length===0&&(ei=null),ei}createCatalogProducerLinks(e){if(!e)return null;var n="https://cartes.gouv.fr/catalogue/search?",ei=[];for(let ti=0;ti<e.length;ti++){const ii=e[ti];ii!=="Autres"&&ei.push({name:ii,url:n+"organization="+ii})}return ei.length===0&&(ei=null),ei}addEventsListeners(e){var n=this;this.eventsListeners["map:add"]=function(ei){logger$4.trace(ei);var ti=ei.element.name,ii=ei.element.service;n.layersListOnMap[ti+":"+ii]=ei.element;var ri=document.querySelectorAll(`input[data-layer="${ti}:${ii}"]`);ri&&ri.forEach(ni=>{ni.checked=!0})},e.getLayers().on("add",this.eventsListeners["map:add"]),this.eventsListeners["map:remove"]=function(ei){logger$4.trace(ei);var ti=ei.element.name,ii=ei.element.service;delete n.layersListOnMap[ti+":"+ii];var ri=document.querySelectorAll(`input[data-layer="${ti}:${ii}"]`);ri&&ri.forEach(ni=>{ni.checked=!1})},e.getLayers().on("remove",this.eventsListeners["map:remove"])}removeEventsListeners(){var e=this.getMap();e.getLayers().un("add",this.eventsListeners["map:add"]),delete this.eventsListeners["map:add"],e.getLayers().un("remove",this.eventsListeners["map:remove"]),delete this.eventsListeners["map:remove"]}addLayer(e,n){var ei=null,ti=null,ii=this.getLayerId(e,n);if(ii){var ri=Config.isConfigLoaded()?null:LayerConfigUtils.getLayerConfig(this.layersList[ii]);switch(n){case"WMS":ti=new LayerWMS({layer:e,configuration:ri});break;case"WMTS":ti=new LayerWMTS({layer:e,configuration:ri});break;case"TMS":ti=new LayerMapBox({layer:e,configuration:ri},{declutter:!0});break;case"WFS":ti=new LayerWFS({layer:e,configuration:ri});break}if(ti){var ni=this.getMap();ni.addLayer(ti),this.layersListOnMap[e+":"+n]=ti,ei=ti.getConfiguration()}return ei}}removeLayer(e,n){var ei=null,ti=this.layersListOnMap[e+":"+n];if(ti){ei=ti.getConfiguration();var ii=this.getMap();ii.removeLayer(ti),delete this.layersListOnMap[e+":"+n]}return ei}hideWaiting(){this.waitingContainer.className="GPwaitingContainerHidden  gpf-waiting--hidden"}showWaiting(){this.waitingContainer.className="GPwaitingContainerVisible gpf-waiting--visible"}resetFilteredLayersList(){for(const e in this.layersList)if(Object.prototype.hasOwnProperty.call(this.layersList,e)){const n=this.layersList[e];n.hidden=!1,this.updateVisibilityFilteredLayers(n.name,n.service,n.hidden)}}setFilteredLayersList(e){var n=this.options.search.criteria;for(const ti in this.layersList)if(Object.prototype.hasOwnProperty.call(this.layersList,ti)){const ii=this.layersList[ti];var ei="";for(let ri=0;ri<n.length;ri++){const ni=n[ri];ii[ni]&&(ei+=ii[ni].toLowerCase())}ii.hidden=!ei.includes(e.toLowerCase()),ii.hidden||logger$4.info(`Filtering layer ${ii.name} with words : ${ei}`),this.updateVisibilityFilteredLayers(ii.name,ii.service,ii.hidden)}this.updateVisibilityFilteredSections()}updateVisibilityFilteredLayers(e,n,ei){const ti=si=>si.replace(/\./g,"\\.");var ii=[];this.categories.forEach(si=>{if(si.items)for(let ai=0;ai<si.items.length;ai++){const oi=si.items[ai];ii.push(oi)}else ii.push(si)});const ri=(si,ai,oi)=>{var li=document.getElementById(`fieldset-${si.id}_${ai}-${oi}`);if(this.options.optimisation==="on-demand"&&si.section)for(const ui in this.dataOnDemand[si.id]){const di=this.dataOnDemand[si.id][ui];if(di){var ci=ti(`#fieldset-${si.id}_${ai}-${oi}`);if(li=di.querySelector(ci),li)break}}return li};for(let si=0;si<ii.length;si++){const ai=ii[si];var ni=ri(ai,e,n);ni&&(ei?(ni.classList.add("gpf-hidden"),ni.classList.add("GPelementHidden")):(ni.classList.remove("gpf-hidden"),ni.classList.remove("GPelementHidden"),logger$4.info(`Layer ${e}:${n} visibility updated to hidden=${ei} in category ${ai.id} (${ni.id}).`)))}}updateVisibilityFilteredSections(){const e=(ri,ni)=>{var si=0;if(this.options.optimisation==="on-demand"){var ai=this.dataOnDemand[ri][ni];ai&&(si=ai.querySelectorAll(".fr-fieldset__element:not(.gpf-hidden):not(.GPelementHidden)").length)}else{var oi=document.getElementById(ni);if(oi){var li=oi.innerHTML;si=[...li.matchAll(/"fr-fieldset__element"/g)].length}}return si};for(let ri=0;ri<this.categories.length;ri++){const ni=this.categories[ri];if(ni.items)for(let si=0;si<ni.items.length;si++){const ai=ni.items[si];if(ai.section)for(let oi=0;oi<ai.sections.length;oi++){const li=ai.sections[oi];var n=document.getElementById(`section-${ai.id}-${this.generateID(li)}`);if(n){var ei=`section-accordion-${ai.id}-${this.generateID(li)}`,ti=e(ai.id,ei),ii=document.getElementById(`section-count-${ai.id}-${this.generateID(li)}`);ti===0?(n.classList.add("gpf-hidden"),n.classList.add("GPelementHidden"),ii&&(ii.textContent=ti)):(ii&&(ii.textContent=ti),n.classList.remove("gpf-hidden"),n.classList.remove("GPelementHidden"))}}}}}onShowCatalogClick(e){var n=e.target.ariaPressed;n==="true"&&this.onPanelOpen(),this.collapsed=n!=="true",this.dispatchEvent("change:collapsed"),logger$4.trace(e)}onCloseCatalogClick(e){logger$4.trace(e)}onSelectCatalogTabClick(e,n){logger$4.trace(e);var ei=[];this.categories.forEach(fi=>{if(fi.items)for(let hi=0;hi<fi.items.length;hi++){const pi=fi.items[hi];ei.push(pi)}else ei.push(fi)});var ti=document.getElementById(`checkboxes-${this.categoryId}`);if(ti){var ii=ei.find(fi=>fi.id==this.categoryId);this.options.optimisation==="on-demand"&&!ii.section&&(ti.innerHTML="")}this.categoryId=n;var ri=ei.find(fi=>fi.id==n);const ni=fi=>{const hi=document.createDocumentFragment();return fi.childNodes.forEach(pi=>{hi.appendChild(pi.cloneNode(!0))}),hi};var si=e.target.ariaSelected==="true",ai=document.getElementById(`checkboxes-${n}`);if(ai&&ai.children.length===0){if(this.options.optimisation==="on-demand"&&si){var oi=this.dataOnDemand[ri.id];oi&&(ai.appendChild(ni(oi)),this._updateListenersLayersDOM(ai,ri.id),this.checkLayersOnMap())}ri.cluster&&this.options.optimisation}var li=document.getElementById("catalog-container-search-specific");if(li){var ci=this.categories.find(fi=>fi.id==n);ci&&ci.search?(li.classList.remove("gpf-hidden"),li.classList.add("fr-tabs__panel--selected")):(li.classList.add("gpf-hidden"),li.classList.remove("fr-tabs__panel--selected"))}var ui=document.getElementById("catalog-input-search-specific");ui&&ui.value!==""&&(ui.value="",this.setFilteredLayersList(""));var di=document.getElementById("catalog-input-search-global");di&&this.options.optimisation==="on-demand"&&di.value!==""&&this.setFilteredLayersList(di.value)}onSelectCatalogEntryClick(e){logger$4.trace(e);var n=e.target.dataset.layer,ei=n.substring(0,n.lastIndexOf(":")),ti=n.substring(n.lastIndexOf(":")+1),ii={};e.target.checked?(this.options.addToMap&&(ii=this.addLayer(ei,ti)),this.dispatchEvent({type:this.ADD_CATALOG_LAYER_EVENT,name:ei,service:ti,layer:ii})):(this.options.addToMap&&(ii=this.removeLayer(ei,ti)),this.dispatchEvent({type:this.REMOVE_CATALOG_LAYER_EVENT,name:ei,service:ti,layer:ii}))}onToggleCatalogMoreLearnClick(e){logger$4.trace(e)}onToggleCatalogSectionClick(e,n,ei){logger$4.trace(e);const ti=li=>{const ci=document.createDocumentFragment();return li.childNodes.forEach(ui=>{ci.appendChild(ui.cloneNode(!0))}),ci};var ii=[];this.categories.forEach(li=>{if(li.items)for(let ci=0;ci<li.items.length;ci++){const ui=li.items[ci];ii.push(ui)}else ii.push(li)});var ri=ii.find(li=>li.id==n),ni=e.target.ariaExpanded==="true",si=document.getElementById(ei);if(si){if(this.options.optimisation==="on-demand")if(ni){var ai=this.dataOnDemand[ri.id][ei];ai&&(si.appendChild(ti(ai)),this._updateListenersLayersDOM(si,ri.id),this.checkLayersOnMap())}else si.innerHTML="";if(ri.cluster&&this.options.optimisation==="clusterize")if(ni)if(this.clusterizeRef[ri.id]&&this.clusterizeRef[ri.id][ei]&&this.clusterizeRef[ri.id][ei].destroyed)this.clusterizeRef[ri.id][ei].refresh(!0);else{var oi=this.clusterizeSections[ri.id][ei];this.clusterizeRef[ri.id]||(this.clusterizeRef[ri.id]={}),this.clusterizeRef[ri.id][ei]=new Clusterize({scrollId:si.parentElement.id,contentId:ei,rows:oi,rows_in_block:ri.clusterOptions.rows_in_block,blocks_in_cluster:ri.clusterOptions.blocks_in_cluster,callbacks:{clusterChanged:()=>{logger$4.trace("cluster changed"),this._updateListenersLayersDOM(si,ri.id),this.checkLayersOnMap()}}})}else this.clusterizeRef[ri.id]&&this.clusterizeRef[ri.id][ei]&&!this.clusterizeRef[ri.id][ei].destroyed&&this.clusterizeRef[ri.id][ei].destroy(!0)}}onToggleCatalogRadioChange(e,n){logger$4.trace(e,n);var ei=[];this.categories.forEach(ai=>{if(ai.items)for(let oi=0;oi<ai.items.length;oi++){const li=ai.items[oi];ei.push(li)}else ei.push(ai)});var ti=ei.find(ai=>ai.id==n),ii=document.getElementById(`checkboxes-${this.categoryId}`);ii&&!ti.section&&this.options.optimisation==="on-demand"&&(ii.innerHTML=""),this.categoryId=n;const ri=ai=>{const oi=document.createDocumentFragment();return ai.childNodes.forEach(li=>{oi.appendChild(li.cloneNode(!0))}),oi};var ni=document.getElementById(`checkboxes-${n}`);if(ni&&ni.children.length===0){if(this.options.optimisation==="on-demand"&&e.target.checked){var si=this.dataOnDemand[ti.id];si&&(ni.appendChild(ri(si)),this._updateListenersLayersDOM(ni,ti.id),this.checkLayersOnMap())}ti.cluster&&this.options.optimisation}}onSearchGlobalCatalogButtonClick(e){var n=e.target.value;this.setFilteredLayersList(n)}onSearchGlobalCatalogInputChange(e){clearTimeout(this._searchTimeout),this._searchTimeout=setTimeout(()=>{this.onSearchGlobalCatalogButtonClick(e)},200)}onSearchGlobalCatalogButtonResetClick(e){this.resetFilteredLayersList(),this.updateVisibilityFilteredSections()}onSearchSpecificCatalogButtonClick(e){var n=e.target.value;this.setFilteredLayersList(n)}onSearchSpecificCatalogInputChange(e){clearTimeout(this._searchTimeout),this._searchTimeout=setTimeout(()=>{this.onSearchSpecificCatalogButtonClick(e)},200)}onSearchSpecificCatalogButtonResetClick(e){this.resetFilteredLayersList(),this.updateVisibilityFilteredSections()}}Object.assign(Catalog.prototype,CatalogDOM);Object.assign(Catalog.prototype,Widget);window.ol&&window.ol.control&&(window.ol.control.Catalog=Catalog);const TerritoriesJson=[{id:"FXX",title:"France mtropolitaine",description:"",zoom:null,bbox:[-9.86,41.15,10.38,51.56],thumbnail:"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/thumbnails/fxx.png",icon:"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/fxx.svg"},{id:"IDF",title:"Paris petite couronne",description:"",zoom:null,bbox:[2.18,48.77,2.52,48.95],thumbnail:"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/thumbnails/idf.png",icon:"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/idf.svg"},{id:"MTQ",title:"Martinique",description:"",zoom:null,bbox:[-61.4,14.25,-60.67,15.04],thumbnail:"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/thumbnails/mtq.png",icon:"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/mtq.svg"},{id:"GUF",title:"Guyane",description:"",zoom:null,bbox:[-55.65,1.49,-51.2,6.21],thumbnail:"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/thumbnails/guf.png",icon:"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/guf.svg"},{id:"MYT",title:"Mayotte",description:"",zoom:null,bbox:[44.95,-13.049,45.32,-12.57],thumbnail:"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/thumbnails/myt.png",icon:"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/myt.svg"},{id:"GLP",title:"Guadeloupe",description:"",zoom:null,bbox:[-61.97,15.72,-60.93,16.66],thumbnail:"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/thumbnails/glp.png",icon:"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/glp.svg"},{id:"REU",title:"Runion",description:"",zoom:null,bbox:[55.07,-21.46,55.86,-20.79],thumbnail:"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/thumbnails/reu.png",icon:"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/reu.svg"},{id:"SPM",title:"Saint-Pierre-et-Miquelon",description:"",zoom:null,bbox:[-56.48,46.69,-56.07,47.19],thumbnail:"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/thumbnails/spm.png",icon:"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/spm.svg"},{id:"BLM",title:"Saint-Barthlemy",description:"",zoom:null,bbox:[-62.95,17.85,-62.75,17.95],thumbnail:"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/thumbnails/blm.png",icon:"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/blm.svg"},{id:"MAF",title:"Saint-Martin",description:"",zoom:null,bbox:[-63.2,18,-62.9,18.2],thumbnail:"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/thumbnails/maf.png",icon:"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/maf.svg"},{id:"WLF",title:"Wallis-et-Futuna",description:"",zoom:null,bbox:[180.3,-15.2,185.3,-12.25],thumbnail:"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/thumbnails/wlf.png",icon:"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/wlf.svg"},{id:"PYF",title:"Polynsie franaise",description:"",zoom:null,bbox:[-154.83,-27.6,-134.32,-7.25],thumbnail:"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/thumbnails/pyf.png",icon:"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/pyf.svg"},{id:"NCL",title:"Nouvelle Caldonie",description:"",zoom:null,bbox:[163.02,-23.08,167.86,-19.5],thumbnail:"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/thumbnails/ncl.png",icon:"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/ncl.svg"},{id:"ATF",title:"Terres australes et antarctiques franaises",description:"",zoom:null,bbox:[50,-60,90,-45],thumbnail:"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/thumbnails/atf.png",icon:"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/atf.svg"}],stringToHTML$1=_t=>{var e=function(){if(!window.DOMParser)return!1;var ii=new DOMParser;try{ii.parseFromString("x","text/html")}catch{return!1}return!0};if(e()){var n=new DOMParser,ei=n.parseFromString(_t,"text/html");return ei.body}var ti=document.createElement("div");return ti.innerHTML=_t,ti};var TerritoriesDOM={_addUID:function(_t){var e=this.uid?_t+"-"+this.uid:_t;return e},createDraggableElement:function(_t,e){return Sortable.create(_t,{animation:150,handle:".gpf-btn-icon-territories-draggable",draggable:".draggable-territories-view",ghostClass:"gpf-territories-view-ghost",onEnd:function(ei){e.onReorderTerritoriesViews(ei)}})},_createMainContainerElement:function(){var _t=document.createElement("div");return _t.id=this._addUID("GPterritories"),_t.className="GPwidget gpf-widget gpf-widget-button gpf-mobile-fullscreen",_t},_createShowTerritoriesPictoElement:function(){var _t=this,e=document.createElement("button"),n=document.createElement("span");return e.appendChild(n),e.id=this._addUID("GPshowTerritoriesPicto"),e.classList.add("GPshowOpen","GPshowAdvancedToolPicto","GPshowTerritoriesPicto"),e.classList.add("gpf-btn","gpf-btn--tertiary","gpf-btn-icon","gpf-btn-icon-territories"),e.classList.add("fr-icon-france-line"),e.classList.add("fr-btn","fr-btn--tertiary"),e.setAttribute("aria-label","Slectionner un territoire"),e.setAttribute("tabindex","0"),e.setAttribute("aria-pressed",!1),e.setAttribute("type","button"),e.addEventListener?e.addEventListener("click",function(ei){var ti=ei.target.ariaPressed==="true";ei.target.setAttribute("aria-pressed",!ti),_t.onShowTerritoriesClick(ei)}):e.attachEvent&&e.attachEvent("onclick",function(ei){var ti=ei.target.ariaPressed==="true";ei.target.setAttribute("aria-pressed",!ti),_t.onShowTerritoriesClick(ei)}),e},_createTerritoriesPanelElement:function(){var _t=document.createElement("dialog");return _t.id=this._addUID("GPterritoriesPanel"),_t.className="GPpanel gpf-panel fr-modal",_t},_createTerritoriesPanelDivElement:function(){var _t=document.createElement("div");return _t.className="gpf-panel__territories",_t},_createTerritoriesPanelHeaderElement:function(){var _t=document.createElement("div");return _t.className="gpf-panel__header_territories",_t},_createTerritoriesPanelIconElement:function(){var _t=document.createElement("label");return _t.className="gpf-btn-header-territories gpf-btn-icon-header-territories",_t.title="Selecteur de territoires",_t},_createTerritoriesPanelTitleElement:function(_t){var e=document.createElement("div");return e.className="gpf-panel__title_territories",e.innerHTML=_t,e},_createTerritoriesPanelCloseElement:function(){var _t=this,e=document.createElement("button");e.id="GPterritoriesPanelClose",e.className="gpf-btn gpf-btn-icon-close fr-btn--close fr-btn fr-btn--tertiary-no-outline fr-m-1w",e.title="Fermer le panneau";var n=document.createElement("span");return n.className="GPelementHidden gpf-visible",n.innerText="Fermer",e.appendChild(n),e.addEventListener?e.addEventListener("click",function(){document.getElementById(_t._addUID("GPshowTerritoriesPicto")).click(),_t.onCloseTerritoriesClick()},!1):e.attachEvent&&e.attachEvent("onclick",function(){document.getElementById(_t._addUID("GPshowTerritoriesPicto")).click(),_t.onCloseTerritoriesClick()}),e},_createTerritoriesPanelOptionsElement:function(_t,e){var n=this,ei="&#x2630",ti="gpf-territories-button-option-id",ii="gpf-territories-upload-id",ri="gpf-territories-upload-close-id",ni="gpf-territories-toggle-messages",si="gpf-territories-apply-id",ai=`
        <div>
            <button type="button" 
                id="${ti}"
                class="fr-btn fr-btn--tertiary-no-outline" 
                role="territories-button-options" 
                aria-expanded="false" 
                aria-controls="gpf-territories-upload-container-id">
                ${ei}
            </button>
            <dialog id="gpf-territories-upload-container-id" class="fr-modal__body fr-upload-group gpf-hidden">
                <div class="gpf-territories-header-upload">
                    <button 
                        id="${ri}"
                        type="button" 
                        class="gpf-btn gpf-btn-icon-close fr-btn--close fr-btn fr-btn--tertiary-no-outline fr-m-1w"
                        aria-expanded="false"
                        title="Fermer le panneau">
                        <span>Fermer</span>
                    </button>
                </div>
                <label class="fr-label">
                    ${_t}
                    <span class="fr-hint-text">${e}</span>
                </label>
                <fieldset class="fr-fieldset">
                    <div class="fr-fieldset__element">
                        <div class="fr-toggle fr-m-2v">
                            <input 
                                id="${ni}" 
                                class="fr-toggle__input" 
                                type="checkbox" 
                                aria-describedby="gpf-territories-toggle-messages">
                            <label class="fr-toggle__label" for="${ni}">Complter la liste</label>
                            <div class="fr-messages-group" id="gpf-territories-toggle-messages" aria-live="polite"></div>
                        </div>
                    </div>
                    <div class="fr-fieldset__element">
                        <input 
                            id="${ii}" 
                            class="fr-upload" 
                            aria-describedby="gpf-territories-upload-id-messages" 
                            type="file" 
                            name="upload">
                        <div class="fr-messages-group" id="gpf-territories-upload-id-messages" aria-live="polite"></div>
                    </div>
                </fieldset>
                <fieldset class="fr-fieldset">
                    <button 
                        id="${si}" 
                        class="gpf-button gpf-button fr-btn fr-btn--tertiary" 
                        aria-describedby="gpf-territories-apply-id-messages">Appliquer</button>
                    <div class="fr-messages-group" id="gpf-territories-apply-id-messages" aria-live="polite"></div>
                </fieldset>
            </dialog>
        </div>
        `,oi=stringToHTML$1(ai);const li=oi.attachShadow({mode:"open"});li.innerHTML=ai.trim();var ci=li.getElementById(ti);ci&&ci.addEventListener("click",pi=>{pi.target.ariaExpanded=pi.target.ariaExpanded!=="true";var gi=document.getElementById(pi.target.getAttribute("aria-controls"));gi&&(pi.target.ariaExpanded==="true"?(gi.classList.add("gpf-visible"),gi.classList.remove("gpf-hidden")):(gi.classList.remove("gpf-visible"),gi.classList.add("gpf-hidden")))},!1);var ui=li.getElementById(ri);ui&&ui.addEventListener("click",pi=>{pi.target.ariaExpanded=pi.target.ariaExpanded!=="true";var gi=document.getElementById(ti);gi.click()});var di=li.getElementById(ii);di&&di.addEventListener("change",pi=>{n.onUploadFileClick(pi)},!1);var fi=li.getElementById(ni);fi.addEventListener("click",pi=>{console.log(pi.target.checked),n.onUploadToggleClick(pi)});var hi=li.getElementById(si);return hi&&hi.addEventListener("click",pi=>{n.onApplyTerritoriesClick(pi)},!1),li.firstChild},_createTerritoriesPanelMenuViewsDivElement:function(_t,e){var n=document.createElement("div");return n.className="territories-views gpf-panel__menuviews_territories",n.appendChild(this._createTerritoriesButtonOpenMenuViewsElement(_t,e)),n.appendChild(this._createTerritoriesPanelMenuViewsElement(_t)),n},_createTerritoriesButtonOpenMenuViewsElement:function(_t,e){var n=this,ei=document.createElement("button"),ti=document.createElement("span");return ei.appendChild(ti),ei.id="gpf-territories-button-open-views-id",ei.classList.add("gpf-btn","gpf-btn--tertiary","gpf-btn-icon"),ei.classList.add("fr-btn","fr-btn--tertiary"),ei.setAttribute("aria-label",_t),ei.setAttribute("title",e),ei.setAttribute("tabindex","0"),ei.setAttribute("aria-pressed",!1),ei.setAttribute("aria-controls","gpf-territories-views-container-id"),ei.setAttribute("type","button"),ei.innerHTML=_t,ei.addEventListener?ei.addEventListener("click",function(ii){var ri=ii.target.ariaPressed==="true";ii.target.setAttribute("aria-pressed",!ri);var ni=document.getElementById(ii.target.getAttribute("aria-controls"));ni&&(ri?(ni.classList.remove("gpf-visible"),ni.classList.add("gpf-hidden")):(ni.classList.add("gpf-visible"),ni.classList.remove("gpf-hidden")),n.onShowTerritoriesViewsClick(ii))}):ei.attachEvent&&ei.attachEvent("onclick",function(ii){var ri=ii.target.ariaPressed==="true";ii.target.setAttribute("aria-pressed",!ri);var ni=document.getElementById(ii.target.getAttribute("aria-controls"));ni&&(ri?(ni.classList.remove("gpf-visible"),ni.classList.add("gpf-hidden")):(ni.classList.add("gpf-visible"),ni.classList.remove("gpf-hidden")),n.onShowTerritoriesViewsClick(ii))}),ei},_createTerritoriesPanelMenuViewsElement:function(_t){var e=document.createElement("dialog");return e.id="gpf-territories-views-container-id",e.className="fr-modal__body gpf-panel__views_territories-menu gpf-hidden",e.appendChild(this._createTerritoriesMenuAddViewElement(_t)),e.appendChild(this._createTerritoriesMenuListViewElement()),e},_createTerritoriesMenuAddViewElement:function(_t){var e=this,n="gpf-territories-views-back-button-id",ei="gpf-territories-views-input-id",ti="gpf-territories-views-form-id",ii="gpf-territories-views-submit-id",ri=`
        <div>
            <button 
                id="${n}" 
                class="fr-btn fr-icon-arrow-left-line fr-btn--icon-left fr-btn--tertiary-no-outline"
                aria-pressed="false" 
                aria-controls="gpf-territories-views-container-id gpf-territories-button-open-views-id"
                title="Retour au slecteur de territoires" 
                type="button">
                ${_t}
            </button>
            <form id="${ti}">
                <fieldset 
                    class="fr-fieldset" 
                    id="add-view-form-fieldset" 
                    aria-labelledby="add-view-form-fieldset-legend add-view-form-fieldset-messages">
                    <legend 
                        class="fr-fieldset__legend" 
                        id="add-view-form-fieldset-legend"> 
                        Ajouter la vue actuelle 
                    </legend>
                    <div class="fr-fieldset__element">
                        <div class="fr-input-group" id="${ei}-input-group-view">
                            <label class="fr-label" for="${ei}"> Nom </label>
                            <input class="fr-input" aria-describedby="${ei}-messages" id="${ei}" type="text">
                            <div class="fr-messages-group" id="${ei}-messages" aria-live="polite"></div>
                        </div>
                    </div>
                    <div class="fr-messages-group" id="add-view-form-fieldset-messages" aria-live="polite">
                        <p class="fr-message fr-message--error gpf-hidden" id="${ei}-message-error-duplicate-id">Ce nom est dj utilis</p>
                        <p class="fr-message fr-message--error gpf-hidden" id="${ei}-message-error-empty-id">Le nom est vide</p>
                    </div>
                </fieldset>
            </form>
            <input type="submit" id="${ii}" value="Ajouter" class="fr-btn">
            <hr class="fr-m-1v"/>
        </div>
        `,ni=stringToHTML$1(ri);const si=ni.attachShadow({mode:"open"});si.innerHTML=ri.trim();var ai=si.getElementById(n);ai&&ai.addEventListener("click",ci=>{var ui=ci.target.ariaPressed==="true";ci.target.setAttribute("aria-pressed",!ui);var di=ci.target.getAttribute("aria-controls").split(" "),fi=document.getElementById(di[0]);if(fi){fi.classList.remove("gpf-visible"),fi.classList.add("gpf-hidden");var hi=document.getElementById(di[1]);if(hi){hi.setAttribute("aria-pressed","false");var pi=document.getElementById(ei);if(pi){pi.value="";var gi=document.getElementById(ei+"-message-error-empty-id"),vi=document.getElementById(ei+"-message-error-duplicate-id");gi&&gi.classList.add("gpf-hidden"),vi&&vi.classList.add("gpf-hidden")}e.onCloseTerritoriesViewsClick(ci)}}},!1);var oi=si.getElementById(ti);oi&&oi.addEventListener("submit",ci=>{ci.preventDefault();var ui=document.getElementById(ei);ui&&e.onAddTerritoriesViewClick(ci,ui.value)},!1);var li=si.getElementById(ii);return li&&li.addEventListener("click",ci=>{ci.preventDefault();var ui=document.getElementById(ei);if(ui){var di=e.territories.find(pi=>pi.data.title===ui.value),fi=document.getElementById(ei+"-message-error-empty-id"),hi=document.getElementById(ei+"-message-error-duplicate-id");if(ui.value===""){fi&&fi.classList.remove("gpf-hidden"),hi&&hi.classList.add("gpf-hidden");return}if(di){hi&&hi.classList.remove("gpf-hidden"),fi&&fi.classList.add("gpf-hidden");return}fi&&fi.classList.add("gpf-hidden"),hi&&hi.classList.add("gpf-hidden"),e.onAddTerritoriesViewClick(ci,ui.value)}},!1),si.firstChild},_createTerritoriesMenuListViewElement:function(){var _t=this,e="gpf-territories-views-reset-button-id",n="gpf-territories-views-count-id",ei=`
        <div class="gpf-panel__views_territories-listview">
            <!-- Menu de la liste des vues -->
            <div class="gpf-panel__views_territories-listview-header">
                <div class="gpf-panel__views_territories-listview-count">
                    <span class="fr-label" style="padding-right: 10px; font-weight: bolder;"> Territoires </span>
                    <span 
                        class="fr-badge fr-badge--sm fr-badge--info fr-badge--no-icon" 
                        id="${n}"> 0 </span>
                </div>
                <button 
                    id="${e}" 
                    class="fr-btn fr-btn--sm fr-btn--tertiary-no-outline"
                    title="Rinitialiser la liste des territoires" 
                    type="button">
                    Rinitialiser
                </button>
            </div>
            <!-- Liste des vues -->
            <div 
                id="gpf-territories-views-listview-entries-id"
                class="gpf-panel__views_territories-listview-entries">
            </div>
        </div>
        `,ti=stringToHTML$1(ei);const ii=ti.attachShadow({mode:"open"});ii.innerHTML=ei.trim();var ri=ii.getElementById(e);return ri&&ri.addEventListener("click",ni=>{_t.onResetTerritoriesViewClick(ni)},!1),ii.firstChild},_createTerritoriesElement:function(){var _t=document.createElement("div");return _t.className="territories-entries gpf-panel__body_territories fr-modal__body",_t},_createTerritoryEntry:function(_t){var e=this;if(_t){var n="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAsCAYAAAAehFoBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAFvSURBVHgB7ZfBisIwEIb/aIWKHsXH8OCT+lBevHgRjwp6EBEREdRqTbKZLN3FXT20yRyK80FIqJR8mf4drDqfjUWNaKBmiDA3IsyNCHMjwtyIMDcizI0Ic/O5wsYA7bZCkjxfb7UQlWjCnY7CaJRhNtM/0nSAyUQjTRViEU3Yug+t8Tj3ws2mcpVVWCw0Gm4Hmv9Wvioq1jcdRaLbVX6+XCyUK+p0ql2VgevVYjhM/LVQolSYqni7AVlm/aB4UKXT9LvyFI35PE40goVJ9nSiYb0cPfrVyvh1Aa21BjYb4+KCIIKFiwhQNzgcSFphvTb/ugMdZLnULhbq6TBlCcowSex2v7dTRvd74+PxLq90kMEg8dGpQuUKF1GgR01VpvF4AP1+A3lu/frVOB4ttltT+QWsXGHakN7+V5mkQ9zv7++l33s95efS+4ZEIqRNVc1xUDu3UTp4OeTfGjcizI0IcyPC3IgwNyLMjQhzUzvhL49qosB5TImnAAAAAElFTkSuQmCC",ei=_t.thumbnail||n,ti="",ii=_t.icon||n;ii.startsWith("fr-icon-")?ti=`
                <button 
                    type="button" 
                    class="fr-btn fr-btn--lg ${ii} fr-btn--tertiary-no-outline">
                </button>`:ti=`
                <svg>       
                    <image id="icon-${_t.id}" xlink:href="${ii}" style="width:100%;"/>    
                </svg>`;var ri=_t.id.toLowerCase(),ni=stringToHTML$1(`
            <div class="gpf-tile fr-tile fr-tile--sm">
                <div class="fr-tile__body">
                    <div class="fr-tile__content">
                        <p class="fr-tile__title">
                            <label class="gpf-label fr-label" title="${_t.description}">${_t.title}</label>
                        </p>
                    </div>
                </div>
                <div class="gpf-tile__header fr-tile__header">
                    <div class="fr-tile__pictogram fr-tile__thumbnail">
                        <img id="thumbnail-${_t.id}" src="${ei}" width="100%" height="100%" title="${_t.description}"/>
                    </div>
                    <div class="fr-tile__pictogram fr-tile__icon fr-tile__icon--${ri}">
                        ${ti}
                    </div>
                </div>
            </div>
            `),si=ni.firstChild;return si&&si.addEventListener("click",ai=>{e.onImageTerritoriesClick(ai,_t.id)}),ni.firstChild}},_createTerritoryView:function(_t){var e=this,n="gpf-territories-view-entry-button-id-"+_t.id;if(_t){var ei=stringToHTML$1(`
            <div class="gpf-panel__views_territories-listview-entry draggable-territories-view">
                <!-- ${_t.title} -->
                <div style="display: flex;flex-direction: row;align-items: center;">    
                    <span class="gpf-btn gpf-btn-icon-territories-draggable gpf-btn--tertiary"></span>
                    <label class="gpf-label fr-label" title="${_t.description}">${_t.title}</label>
                </div>
                <button 
                    id="${n}" 
                    type="button" 
                    class="fr-btn fr-btn--sm fr-btn--icon-left fr-btn--tertiary-no-outline gpf-btn gpf-btn-icon-territories-remove gpf-btn--tertiary"></button>
            </div>
            `),ti=ei.firstChild;if(ti){ti.addEventListener("click",ri=>{e.onViewTerritoryClick(ri,_t.id)});var ii=ei.querySelector("#"+n);ii&&ii.addEventListener("click",ri=>{ri.stopPropagation(),e.onViewTerritoryRemoveClick(ri,_t.id)})}return ei.firstChild}}};let logger$3=LoggerByDefault.getLogger("territories");class Territories extends ControlExtended{constructor(e){if(e=e||{},super(e),!(this instanceof Territories))throw new TypeError("ERROR CLASS_CONSTRUCTOR");return this.CLASSNAME="Territories",this.initialize(e),this.container=this.initContainer(),this.element?this.element.appendChild(this.container):this.element=this.container,this}setMap(e){if(e){this.draggable&&Draggable.dragElement(this.panelTerritoriesContainer,this.panelTerritoriesHeaderContainer,e.getTargetElement()),this.collapsed||this.buttonTerritoriesShow.setAttribute("aria-pressed",!0);var n=this.auto?TerritoriesJson:this.options.territories;for(let ti=0;ti<n.length;ti++){const ii=n[ti];this.setTerritory(ii)}}super.setMap(e),this.options.position&&this.setPosition(this.options.position),this.options.gutter===!1&&this.getContainer().classList.add("gpf-button-no-gutter");var ei=this;this.createDraggableElement(ei.element.querySelector("#gpf-territories-views-listview-entries-id"),ei),this.dispatchEvent({type:"territories:loaded"})}setTerritory(e,n=!1){var ei=this.territories.some(si=>si.data.id===e.id);if(e&&!ei){var ti=this._createTerritoryEntry(e),ii=this._createTerritoryView(e);if(ti&&ii){this.panelTerritoriesEntriesContainer.appendChild(ti),this.panelTerritoriesViewsContainer.appendChild(ii);var ri=this.element.querySelector("#gpf-territories-views-count-id");if(ri){var ni=this.territories.filter(si=>!si.isRemoved).length+1;ri.innerText=ni}return this.territories.push({isRemoved:!1,isAdded:n,data:e,initialIndex:this.territories.length,domEntry:ti,domView:ii}),!0}}return!1}setTerritories(e){for(let n=0;n<e.length;n++){const ei=e[n];this.setTerritory(ei)}}removeTerritory(e,n=!1){var ei=!1;if(e){for(let ri=0;ri<this.territories.length;ri++)if(this.territories[ri].data.id===e.data.id){n?(this.territories[ri].domEntry.remove(),this.territories[ri].domView.remove(),this.territories.splice(ri,1)):(this.territories[ri].isRemoved=!0,this.territories[ri].domEntry.classList.add("gpf-hidden"),this.territories[ri].domView.style.display="none"),ei=!0;var ti=this.element.querySelector("#gpf-territories-views-count-id");if(ti){var ii=this.territories.filter(si=>!si.isRemoved).length;ti.innerText=ii}break}}return ei}removeTerritories(){for(let e=0;e<this.territories.length;e++){const n=this.territories[e];n.domEntry.remove(),n.domView.remove()}this.territories=[]}setCollapse(e){if(e===void 0){logger$3.log("[ERROR] Territory:setCollapsed - missing collapsed parameter");return}e&&this.collapsed||!e&&!this.collapsed||(e?document.getElementById("GPterritoriesPanelClose").click():this.buttonTerritoriesShow.click(),this.collapsed=e)}setReduce(e){e?this.panelTerritoriesEntriesContainer.classList.add("tiles-reduce"):this.panelTerritoriesEntriesContainer.classList.remove("tiles-reduce")}getContainer(){return this.container}initialize(e){this.uid=e.id||SelectorID.generate(),this.options={collapsed:!0,draggable:!1,panel:!0,upload:{active:!1,title:"Ajouter un fichier de configuration",description:""},view:{active:!1,title:"Modifier les territoires",description:""},title:"Slectionner un territoire",auto:!1,thumbnail:!1,reduce:!1,tiles:3,territories:[]};var n=Helper.assign(this.options.upload,e.upload);Helper.assign(this.options,e),Helper.assign(this.options.upload,n),this.collapsed=this.options.collapsed,this.draggable=this.options.draggable,this.auto=this.options.auto,this.territories=[],this.uploadConfig=null,this.append=!1,this.buttonTerritoriesShow=null,this.panelTerritoriesContainer=null,this.panelTerritoriesHeaderContainer=null,this.buttonTerritoriesClose=null,this.containerTerritoriesOptions=null,this.panelTerritoriesEntriesContainer=null,this.panelTerritoriesViewsContainer=null}initContainer(){var e=this._createMainContainerElement(),n=this.buttonTerritoriesShow=this._createShowTerritoriesPictoElement();e.appendChild(n);var ei=this.panelTerritoriesContainer=this._createTerritoriesPanelElement();ei.classList.add("tiles-direction"),ei.classList.add("tiles-"+this.options.tiles);var ti=this._createTerritoriesPanelDivElement();ei.appendChild(ti);var ii=this._createTerritoriesPanelMenuViewsDivElement(this.options.view.title,this.options.view.description);ei.appendChild(ii),this.panelTerritoriesViewsContainer=ii.querySelector("#gpf-territories-views-listview-entries-id"),this.options.view&&!this.options.view.active&&(ii.style.display="none");var ri=this.panelTerritoriesEntriesContainer=this._createTerritoriesElement();if(ri.classList.add("tiles-direction"),ri.classList.add("tiles-"+this.options.tiles),this.options.reduce&&ri.classList.add("tiles-reduce"),this.options.thumbnail?ri.classList.add("tiles-thumbnail"):ri.classList.add("tiles-icon"),ei.appendChild(ri),this.options.panel){var ni=this.panelTerritoriesHeaderContainer=this._createTerritoriesPanelHeaderElement(),si=this._createTerritoriesPanelIconElement();ni.appendChild(si);var ai=this._createTerritoriesPanelTitleElement(this.options.title);if(ni.appendChild(ai),this.options.upload&&this.options.upload.active){var oi=this.containerTerritoriesOptions=this._createTerritoriesPanelOptionsElement(this.options.upload.title,this.options.upload.description);ni.appendChild(oi)}var li=this.buttonTerritoriesClose=this._createTerritoriesPanelCloseElement();ni.appendChild(li),ti.appendChild(ni)}return e.appendChild(ei),logger$3.log(e),e}closePanelUpLoad(){var e=this.containerTerritoriesOptions.children[0];e&&e.setAttribute("aria-expanded","false");var n=this.containerTerritoriesOptions.children[1];n&&(n.classList.add("gpf-hidden"),n.classList.remove("gpf-visible"))}onShowTerritoriesClick(e){e.target.ariaPressed==="true"&&this.onPanelOpen(),logger$3.trace(e),this.collapsed=!this.collapsed}onCloseTerritoriesClick(e){logger$3.trace(e)}onImageTerritoriesClick(e,n){logger$3.trace(e,n);var ei=this.territories.find(li=>li.data.id===n);if(ei){var ti=ei.data.zoom,ii=ei.data.bbox,ri=ei.data.point;if(ii&&!ii.length||!ri&&!ii)return;var ni=this.getMap(),si=ni.getView().getProjection().getCode();if(ii){var ai=transformExtent(ii,"EPSG:4326",si);ni.getView().fit(ai,{size:ni.getSize()})}if(ri){var oi=transform$1(ri,"EPSG:4326",si);ni.getView().setCenter(oi)}ti&&ni.getView().setZoom(ti),this.setCollapse(!0),this.dispatchEvent({type:"territories:change",territory:ei.data})}}onUploadFileClick(e){var n=e.target.files[0];if(e.target,!n){logger$3.warn("Missing file to upload !");return}var ei=new FileReader,ti=this;ei.onerror=ii=>{logger$3.log("onerror")},ei.onprogress=ii=>{logger$3.log("onprogress")},ei.onloadstart=ii=>{logger$3.log("onloadstart")},ei.onabort=ii=>{logger$3.log("onabort")},ei.onloadend=ii=>{logger$3.log("onloadend : ",ii)},ei.onload=ii=>{logger$3.log("file content : ",ii.target.result);try{if(ti.uploadConfig=JSON.parse(ii.target.result),!ti.uploadConfig){console.error("Invalid configuration file !");return}}catch(ri){console.error("Error parsing configuration file : ",ri);return}},ei.readAsText(n)}onUploadToggleClick(e){this.append=e.target.checked}onApplyTerritoriesClick(e){if(logger$3.trace(e),this.closePanelUpLoad(),!this.uploadConfig){logger$3.error("No configuration to apply !");return}this.append||this.removeTerritories(),this.setTerritories(this.uploadConfig)}onShowTerritoriesViewsClick(e){logger$3.trace(e)}onCloseTerritoriesViewsClick(e){logger$3.trace(e),this.closePanelUpLoad()}onAddTerritoriesViewClick(e,n){logger$3.trace(e,n);var ei=Math.abs(Array.from(n).reduce((ai,oi)=>Math.imul(31,ai)+oi.charCodeAt(0)|0,0)),ti=this.getMap().getView(),ii=ti.getProjection().getCode(),ri=transform$1(ti.getCenter(),ii,"EPSG:4326"),ni=ti.getZoom(),si={id:ei.toString(),title:n,description:"Vue personnalise",point:ri,zoom:ni,thumbnail:"",icon:"fr-icon-map-pin-2-line"};this.setTerritory(si,!0),this.dispatchEvent({type:"territories:add",territory:si})}onResetTerritoriesViewClick(e){logger$3.trace(e);for(const ti of this.territories.slice())ti.isAdded?this.removeTerritory(ti,!0):ti.isRemoved&&(ti.domEntry.classList.remove("gpf-hidden"),ti.domView.style.display="",ti.isRemoved=!1);this.territories.sort((ti,ii)=>ti.initialIndex-ii.initialIndex),this.panelTerritoriesEntriesContainer.innerHTML="",this.territories.forEach(ti=>{this.panelTerritoriesEntriesContainer.appendChild(ti.domEntry)}),this.panelTerritoriesViewsContainer.innerHTML="",this.territories.forEach(ti=>{this.panelTerritoriesViewsContainer.appendChild(ti.domView)});var n=this.element.querySelector("#gpf-territories-views-count-id");if(n){var ei=this.territories.filter(ti=>!ti.isRemoved).length;n.innerText=ei}}onViewTerritoryClick(e,n){logger$3.trace(e,n)}onViewTerritoryRemoveClick(e,n){logger$3.trace(e,n);var ei=this.territories.find(ti=>ti.data.id===n);ei&&(this.removeTerritory(ei,ei.isAdded),this.dispatchEvent({type:"territories:remove",territory:ei.data}))}onReorderTerritoriesViews(e){logger$3.trace(e);const n=Array.from(this.panelTerritoriesViewsContainer.children),ei=[];n.forEach(ti=>{const ii=this.territories.find(ri=>ri.domView===ti);ii&&ei.push(ii)}),this.territories=ei,this.panelTerritoriesEntriesContainer.innerHTML="",this.territories.forEach(ti=>{this.panelTerritoriesEntriesContainer.appendChild(ti.domEntry)})}}Object.assign(Territories.prototype,TerritoriesDOM);Object.assign(Territories.prototype,Widget);window.ol&&window.ol.control&&(window.ol.control.Territories=Territories);var ControlListDOM={_addUID:function(_t){var e=this._uid?_t+"-"+this._uid:_t;return e},_createMainContainerElement:function(){var _t=document.createElement("div");return _t.id=this._addUID("GPcontrolList"),_t.className="GPwidget gpf-widget gpf-widget-button gpf-mobile-fullscreen",_t},_createShowControlListPictoElement:function(){var _t=this,e=document.createElement("button"),n=document.createElement("span");return e.appendChild(n),e.id=this._addUID("GPshowControlListPicto"),e.classList.add("GPshowOpen","GPshowAdvancedToolPicto","GPshowControlListPicto"),e.classList.add("gpf-btn","gpf-btn--tertiary","gpf-btn-icon","gpf-btn-icon-controllist"),e.classList.add("fr-btn","fr-btn--tertiary"),e.setAttribute("aria-label","Afficher plus"),e.setAttribute("tabindex","0"),e.setAttribute("aria-pressed",!1),e.setAttribute("type","button"),e.addEventListener?e.addEventListener("click",function(ei){var ti=ei.target.ariaPressed==="true";ei.target.setAttribute("aria-pressed",!ti),_t.onShowControlListPanelClick(ei)}):e.attachEvent&&e.attachEvent("onclick",function(ei){var ti=ei.target.ariaPressed==="true";ei.target.setAttribute("aria-pressed",!ti),_t.onShowControlListPanelClick(ei)}),e},_createControlListPanelElement:function(){var _t=document.createElement("dialog");return _t.id=this._addUID("GPcontrolListPanel"),_t.className="GPpanel gpf-panel fr-modal",_t},_createControlListPanelDivElement:function(){var _t=document.createElement("div");return _t.className="gpf-panel__body fr-modal__body",_t},_createControlListPanelHeaderElement:function(){var _t=this,e=document.createElement("div");e.className="GPpanelHeader gpf-panel__header fr-modal__header";var n=document.createElement("div");n.className="GPpanelTitle gpf-panel__title fr-modal__title fr-pt-4w",n.innerHTML="Mes outils",e.appendChild(n);var ei=document.createElement("button");ei.id=this._addUID("GPcontrolListPanelClose"),ei.className="GPpanelClose GPcontrolListPanelClose gpf-btn gpf-btn-icon-close fr-btn--close fr-btn fr-btn--tertiary-no-outline fr-m-1w",ei.title="Fermer le panneau",ei.addEventListener?ei.addEventListener("click",function(){document.getElementById(_t._addUID("GPshowControlListPicto")).click()},!1):ei.attachEvent&&ei.attachEvent("onclick",function(){document.getElementById(_t._addUID("GPshowControlListPicto")).click()});var ti=document.createElement("span");return ti.className="GPelementHidden gpf-visible",ti.innerText="Fermer",ei.appendChild(ti),e.appendChild(ei),e},_createControlListPanelContentElement:function(){var _t=document.createElement("div");return _t.className="gpf-panel__content fr-modal__content",_t},_createControlListPanelFooterElement:function(_t){var e=document.createElement("div");e.className="GPpanelFooter gpf-panel__footer fr-modal__footer";var n=document.createElement("button");return n.classList.add("gpf-btn","gpf-btn--tertiary","fr-btn","fr-btn--tertiary"),n.innerText="+ Ajouter plus d'outils",n.addEventListener("click",function(){_t.click()}),e.appendChild(n),e},_createControlListPanelControl:function(_t){let e;try{e=_t.getContainer()}catch{e=_t.container}var n=document.createElement("div"),ei=e.querySelector(".GPshowOpen").cloneNode();ei.id=ei.id+"-controllist",ei.classList.add("inside-control-list"),n.appendChild(ei);var ti=document.createElement("div"),ii=document.createElement("span");if(ti.appendChild(ii),e.querySelector(".GPshowOpen").ariaLabel?ii.innerText=e.querySelector(".GPshowOpen").ariaLabel:e.querySelector(".GPpanelTitle")?ii.innerText=e.querySelector(".GPpanelTitle").innerText:e.querySelector("[class^='gpf-btn-header-']")&&(ii.innerText=e.querySelector("[class^='gpf-btn-header-']").title),_t.description){var ri=document.createElement("span");ri.innerText=_t.description,ti.appendChild(ri)}return n.appendChild(ti),n.addEventListener("click",function(){e.querySelector(".GPshowOpen").click()}),n}},logger$2=LoggerByDefault.getLogger("controlList");class ControlList extends ControlExtended{constructor(e){if(e=e||{},super(e),!(this instanceof ControlList))throw new TypeError("ERROR CLASS_CONSTRUCTOR");return e.controlCatalogElement?this.controlCatalogElement=e.controlCatalogElement:this.controlCatalogElement=null,this.CLASSNAME="ControlList",this.initialize(e),this._container=this._initContainer(),this.element?this.element.appendChild(this._container):this.element=this._container,this}setMap(e){e&&(this.draggable&&Draggable.dragElement(this._ControlListPanelContainer,this._ControlListPanelHeaderContainer,e.getTargetElement()),this.collapsed||this._pictoControlListButton.setAttribute("aria-pressed",!0)),super.setMap(e),this.options.position&&this.setPosition(this.options.position)}getCollapsed(){return this.collapsed}setCollapsed(e){if(e===void 0){logger$2.log("[ERROR] ControlList:setCollapsed - missing collapsed parameter");return}e&&this.collapsed||!e&&!this.collapsed||(e?document.getElementById("GPcontrolListPanelClose-"+this._uid).click():this._pictoIsoButton.click(),this.collapsed=e)}getContainer(){return this._container}clean(){this._clearIsoInputs(),this._originPoint.clearResults(),document.getElementById("GPlocationPoint_1-"+this._uid).style.cssText="",document.getElementById("GPlocationOriginCoords_1-"+this._uid).value="",document.getElementById("GPlocationOrigin_1-"+this._uid).value="",document.getElementById("GPlocationPoint_1-"+this._uid).style.cssText="",document.getElementById("GPlocationOriginPointer_1-"+this._uid).checked=!1,document.getElementById("GPlocationOrigin_1-"+this._uid).className="GPlocationOriginVisible gpf-visible",document.getElementById("GPlocationOriginCoords_1-"+this._uid).className="GPlocationOriginHidden gpf-hidden",this._currentIsoResults=null,this.setLayer()}initialize(e){e.collapsed==="true"&&(e.collapsed=!0),e.collapsed==="false"&&(e.collapsed=!1),this.options={collapsed:!0,draggable:!1},Helper.assign(this.options,e),this.collapsed=this.options.collapsed,this.draggable=this.options.draggable,this._uid=this.options.id||SelectorID.generate()}_initContainer(){var e=this._createMainContainerElement(),n=this._pictoControlListButton=this._createShowControlListPictoElement();e.appendChild(n);var ei=this._ControlListPanelContainer=this._createControlListPanelElement(),ti=this._createControlListPanelDivElement();ei.appendChild(ti);var ii=this._ControlListPanelHeaderContainer=this._createControlListPanelHeaderElement();ti.appendChild(ii);var ri=this._ControlListPanelContentContainer=this._createControlListPanelContentElement();if(ti.appendChild(ri),this.controlCatalogElement){var ni=this._createControlListPanelFooterElement(this.controlCatalogElement);ti.appendChild(ni)}return e.appendChild(ei),e}onShowControlListPanelClick(e){e.target.ariaPressed==="true"&&this.onPanelOpen();var n=this.getMap();Interactions.unset(n);var ei=this._pictoControlListButton.ariaPressed;this.collapsed=ei!=="true",this.dispatchEvent("change:collapsed"),this.options.position&&!this.collapsed&&this.updatePosition(this.options.position),this.collapsed?this._ControlListPanelContentContainer.innerHTML="":this.getMap().getControls().getArray().forEach(ii=>{if(ii.listable){let ri=this._createControlListPanelControl(ii);this._ControlListPanelContentContainer.appendChild(ri)}})}}Object.assign(ControlList.prototype,ControlListDOM);Object.assign(ControlList.prototype,Widget);window.ol&&window.ol.control&&(window.ol.control.ControlList=ControlList);var OGCRequest={computeGenericGPFWFS:async function(_t,e,n=0,ei="geom",ti="",ii=4326,ri=!1,ni,si){let ai=si,oi=ni;ii!==4326&&([ai,oi]=proj4(proj4.defs("EPSG:4326"),proj4.defs(`EPSG:${ii}`),[si,ni]));let li=`INTERSECTS(${ei},Point(${ai}%20${oi}))`;n>0&&(li=`DWITHIN(${ei},Point(${ai}%20${oi}),${n},kilometers)`),ti&&(li+=` ${ti}`);const ui=await(await fetch(`https://data.geopf.fr/wfs/ows?SERVICE=WFS&VERSION=2.0.0&REQUEST=GetFeature&typename=${_t}&outputFormat=json&count=50&CQL_FILTER=${li}`)).json(),di=[];return ui.features.forEach(fi=>{const hi=[];e.forEach(pi=>{hi.push(fi.properties[pi])}),ri&&hi.push(fi.geometry),e.length===1&&hi[0]!==null&&!ri?di.push(hi[0]):(e.length>1||ri)&&di.push(hi)}),di}},title$3="contextMenu",ContextMenuDOM={_addUID:function(_t){var e=this.uid?_t+"-"+this.uid:_t;return e},_createMainContainerElement:function(){var _t=document.createElement("div");return _t.id=this._addUID("GPpointInfo"),_t.className="GPpointInfo GPwidget gpf-widget",_t},_createShowPointInfoPictoElement:function(){var _t=this,e=document.createElement("button");return e.id=this._addUID("GPshowPointInfoPicto"),e.className="GPshowOpen GPshowAdvancedToolPicto GPshowPointInfoPicto gpf-btn gpf-btn-icon gpf-btn-icon-widget fr-btn",e.title=`${title$3}`,e.setAttribute("tabindex","0"),e.setAttribute("aria-pressed",!1),e.setAttribute("type","button"),e.addEventListener?e.addEventListener("click",function(n){var ei=n.target.ariaPressed==="true";n.target.setAttribute("aria-pressed",!ei),_t.onShowPointInfoClick(n)}):e.attachEvent&&e.attachEvent("onclick",function(n){var ei=n.target.ariaPressed==="true";n.target.setAttribute("aria-pressed",!ei),_t.onShowPointInfoClick(n)}),e},_createPointInfoPanelElement:function(){var _t=document.createElement("dialog");return _t.id=this._addUID("GPpointInfoPanel"),_t.className="GPpanel gpf-panel fr-modal",_t},_createPointInfoPanelDivElement:function(){var _t=document.createElement("div");return _t.className="gpf-panel__pointInfo",_t},_createPointInfoPanelHeaderElement:function(){var _t=document.createElement("div");return _t.className="GPpointInfoHeader gpf-panel__header_pointInfo",_t},_createPointInfoPanelIconElement:function(){var _t=document.createElement("label");return _t.className="GPpanelHeader gpf-btn-header-pointInfo gpf-btn-icon-header-pointInfo",_t.title="Adresse et coordonnes",_t},_createPointInfoPanelTitleElement:function(){var _t=document.createElement("div");return _t.className="GPpanelTitle gpf-panel__title_pointInfo fr-pt-4w",_t.innerHTML="Adresse et coordonnes",_t},_createPointInfoPanelCloseElement:function(){var _t=this,e=document.createElement("button");e.className="GPpanelClose GPpointInfoPanelClose gpf-btn gpf-btn-icon-close fr-btn--close fr-btn fr-btn--tertiary-no-outline",e.title="Fermer le panneau";var n=document.createElement("span");return n.className="GPelementHidden gpf-visible",n.innerText="Fermer",e.appendChild(n),e.addEventListener?e.addEventListener("click",function(){document.getElementById(_t._addUID("GPshowPointInfoPicto")).click(),_t.onClosePointInfoClick()},!1):e.attachEvent&&e.attachEvent("onclick",function(){document.getElementById(_t._addUID("GPshowPointInfoPicto")).click(),_t.onClosePointInfoClick()}),e},_createEntriesElement:function(){var _t=document.createElement("div");_t.className="point-info-content gpf-panel__body fr-modal__body";var e=document.createElement("div");return _t.appendChild(e),_t},_createPinDOMOverlay:function(_t){var e=document.createElement("div"),n=document.createElement("img");return n.src=_t,e.appendChild(n),e}};/*!
  * ol-contextmenu - v5.5.0
  * https://github.com/jonataswalker/ol-contextmenu
  * Built: Wed Aug 07 2024 12:29:18 GMT+0000 (Coordinated Universal Time)
  */var k$1=Object.defineProperty,I$1=(_t,e,n)=>e in _t?k$1(_t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):_t[e]=n,a$1=(_t,e,n)=>I$1(_t,typeof e!="symbol"?e+"":e,n),S$1={exports:{}};function x$2(){}x$2.prototype={on:function(_t,e,n){var ei=this.e||(this.e={});return(ei[_t]||(ei[_t]=[])).push({fn:e,ctx:n}),this},once:function(_t,e,n){var ei=this;function ti(){ei.off(_t,ti),e.apply(n,arguments)}return ti._=e,this.on(_t,ti,n)},emit:function(_t){var e=[].slice.call(arguments,1),n=((this.e||(this.e={}))[_t]||[]).slice(),ei=0,ti=n.length;for(ei;ei<ti;ei++)n[ei].fn.apply(n[ei].ctx,e);return this},off:function(_t,e){var n=this.e||(this.e={}),ei=n[_t],ti=[];if(ei&&e)for(var ii=0,ri=ei.length;ii<ri;ii++)ei[ii].fn!==e&&ei[ii].fn._!==e&&ti.push(ei[ii]);return ti.length?n[_t]=ti:delete n[_t],this}};S$1.exports=x$2;var _$1=S$1.exports.TinyEmitter=x$2,L$1=(_t=>(_t.CONTEXTMENU="contextmenu",_t.CLICK="click",_t.DBLCLICK="dblclick",_t))(L$1||{}),p$1=(_t=>(_t.BEFOREOPEN="beforeopen",_t.OPEN="open",_t.CLOSE="close",_t.ADD_MENU_ENTRY="add-menu-entry",_t))(p$1||{});let w$1=class extends MapBrowserEvent{constructor(e){super(e.type,e.map,e.originalEvent)}};const z$1={width:150,scrollAt:4,eventType:L$1.CONTEXTMENU,defaultItems:!0,items:[]},d$1="ol-ctx-menu",r={container:`${d$1}-container`,separator:`${d$1}-separator`,submenu:`${d$1}-submenu`,hidden:`${d$1}-hidden`,icon:`${d$1}-icon`,zoomIn:`${d$1}-zoom-in`,zoomOut:`${d$1}-zoom-out`,unselectable:"ol-unselectable"},C$1=[{text:"Zoom In",classname:`${r.zoomIn} ${r.icon}`,callback:(_t,e)=>{const n=e.getView();n.animate({zoom:Number(n.getZoom())+1,duration:700,center:_t.coordinate})}},{text:"Zoom Out",classname:`${r.zoomOut} ${r.icon}`,callback:(_t,e)=>{const n=e.getView();n.animate({zoom:Number(n.getZoom())-1,duration:700,center:_t.coordinate})}}];function y$1(_t){const e=document.createDocumentFragment(),n=document.createElement("div");for(n.innerHTML=_t;n.firstChild;)e.append(n.firstChild);return e}function P$1(_t){var si,ai;const e=document.importNode(_t),n=_t.offsetWidth;e.style.cssText=`position: fixed; top: 0; left: 0; overflow: auto; visibility: hidden; pointer-events: none; height: unset; max-height: unset; width: ${n}px`;const ei=y$1("<span>Foo</span>"),ti=y$1("<span>Foo</span>"),ii=document.createElement("li"),ri=document.createElement("li");ii.append(ei),ri.append(ti),e.append(ii),e.append(ri),(si=_t.parentNode)==null||si.append(e);const ni=e.offsetHeight/2;return(ai=_t.parentNode)==null||ai.removeChild(e),ni}function N$1({parentNode:_t,item:e,isSubmenu:n=!1,isInsideSubmenu:ei=!1,emitter:ti}){const ii=`_${Math.random().toString(36).slice(2,11)}`;if(typeof e!="string"&&"text"in e){const oi=`<span>${e.text}</span>`,li=y$1(oi),ci=document.createElement("li");e.classname=e.classname||"",e.icon&&(e.classname===""?e.classname=r.icon:e.classname.includes(r.icon)===!1&&(e.classname+=` ${r.icon}`),ci.setAttribute("style",`background-image:url(${e.icon})`)),ci.id=ii,ci.className=e.classname,ci.append(li),_t.append(ci);const ui={id:ii,isSubmenu:n,isInsideSubmenu:ei,isSeparator:!1,callback:"callback"in e?e.callback:null,data:"data"in e?e.data:null};return ti.emit(p$1.ADD_MENU_ENTRY,ui,ci),ci}const ri=`<li id="${ii}" class="${r.separator}"><hr></li>`,ni=y$1(ri);_t.append(ni);const si=_t.lastChild,ai={id:ii,isSubmenu:!1,isInsideSubmenu:!1,isSeparator:!0,callback:null,data:null};return ti.emit(p$1.ADD_MENU_ENTRY,ai,si),si}function M$1({container:_t,items:e,menuWidth:n,isInsideSubmenu:ei,emitter:ti}){e.forEach(ii=>{if(typeof ii!="string"&&"items"in ii&&Array.isArray(ii.items)){const ri=N$1({parentNode:_t,item:ii,isSubmenu:!0,emitter:ti});ri.classList.add(r.submenu);const ni=document.createElement("ul");ni.classList.add(r.container),ni.style.width=`${n}px`,ri.append(ni),M$1({emitter:ti,menuWidth:n,container:ni,items:ii.items,isInsideSubmenu:!0})}else N$1({parentNode:_t,item:ii,isSubmenu:!1,isInsideSubmenu:ei,emitter:ti})})}function b$1(_t,e){if(!_t)throw new Error(e)}let R$1=class extends Control{constructor(e={}){b$1(typeof e=="object","@param `opts` should be object type!");const n=document.createElement("div");super({element:n}),a$1(this,"map"),a$1(this,"emitter",new _$1),a$1(this,"container"),a$1(this,"coordinate",[]),a$1(this,"pixel",[]),a$1(this,"contextMenuEventListener"),a$1(this,"entryCallbackEventListener"),a$1(this,"mapMoveListener"),a$1(this,"lineHeight",0),a$1(this,"disabled"),a$1(this,"opened"),a$1(this,"items",[]),a$1(this,"menuEntries",new Map),a$1(this,"options"),this.options={...z$1,...e};const ei=document.createElement("ul");n.append(ei),n.style.width=`${this.options.width}px`,n.classList.add(r.container,r.unselectable,r.hidden),this.container=n,this.contextMenuEventListener=ti=>{this.handleContextMenu(ti)},this.entryCallbackEventListener=ti=>{this.handleEntryCallback(ti)},this.mapMoveListener=()=>{this.handleMapMove()},this.disabled=!1,this.opened=!1,window.addEventListener("beforeunload",()=>{this.removeListeners()},{once:!0})}clear(){for(const e of this.menuEntries.keys())this.removeMenuEntry(e);this.container.replaceChildren(),this.container.append(document.createElement("ul"))}enable(){this.disabled=!1}disable(){this.disabled=!0}getDefaultItems(){return C$1}countItems(){return this.menuEntries.size}extend(e){b$1(Array.isArray(e),"@param `items` should be an Array."),M$1({items:e,emitter:this.emitter,menuWidth:this.options.width,container:this.container.firstElementChild})}closeMenu(){this.opened=!1,this.container.classList.add(r.hidden),this.dispatchEvent(p$1.CLOSE)}isOpen(){return this.opened}updatePosition(e){b$1(Array.isArray(e),"@param `pixel` should be an Array."),this.isOpen()&&(this.pixel=e,this.positionContainer())}pop(){const e=Array.from(this.menuEntries.keys()).pop();e&&this.removeMenuEntry(e)}shift(){const e=Array.from(this.menuEntries.keys()).shift();e&&this.removeMenuEntry(e)}push(e){e&&this.extend([e])}setMap(e){if(super.setMap(e),e){this.map=e,e.getViewport().addEventListener(this.options.eventType,this.contextMenuEventListener,!1),e.on("movestart",()=>{this.handleMapMove()}),this.emitter.on(p$1.ADD_MENU_ENTRY,(ei,ti)=>{this.handleAddMenuEntry(ei,ti)},this),this.items=this.options.defaultItems?this.options.items.concat(C$1):this.options.items,M$1({items:this.items,emitter:this.emitter,menuWidth:this.options.width,container:this.container.firstElementChild});const n=this.getMenuEntriesLength();this.lineHeight=n>0?this.container.offsetHeight/n:P$1(this.container)}else this.removeListeners(),this.clear()}removeListeners(){this.map.getViewport().removeEventListener(this.options.eventType,this.contextMenuEventListener,!1),this.emitter.off(p$1.ADD_MENU_ENTRY)}removeMenuEntry(e){let n=document.getElementById(e);n==null||n.remove(),n=null,this.menuEntries.delete(e)}handleContextMenu(e){var n;this.coordinate=this.map.getEventCoordinate(e),this.pixel=this.map.getEventPixel(e),this.dispatchEvent(new w$1({map:this.map,originalEvent:e,type:p$1.BEFOREOPEN})),!this.disabled&&(this.options.eventType===L$1.CONTEXTMENU&&(e.stopPropagation(),e.preventDefault()),setTimeout(()=>{this.openMenu(e)}),(n=e.target)==null||n.addEventListener("pointerdown",ei=>{this.opened&&(ei.stopPropagation(),this.closeMenu())},{once:!0}))}openMenu(e){this.opened=!0,this.positionContainer(),this.container.classList.remove(r.hidden),this.dispatchEvent(new w$1({map:this.map,originalEvent:e,type:p$1.OPEN}))}getMenuEntriesLength(){return Array.from(this.menuEntries).filter(([,e])=>e.isSeparator===!1&&e.isSubmenu===!1&&e.isInsideSubmenu===!1).length}positionContainer(){const e=this.map.getSize()||[0,0],n={w:e[0]-this.pixel[0],h:e[1]-this.pixel[1]},ei=this.getMenuEntriesLength(),ti={w:this.container.offsetWidth,h:Math.round(this.lineHeight*ei)},ii=n.w>=ti.w?this.pixel[0]+5:this.pixel[0]-ti.w;this.container.style.left=`${ii}px`,this.container.style.top=n.h>=ti.h?`${this.pixel[1]-10}px`:`${this.pixel[1]-ti.h}px`,this.container.style.right="auto",this.container.style.bottom="auto",n.w-=ti.w;const ri=ai=>Array.from(ai.children).filter(oi=>oi.tagName==="LI"&&oi.classList.contains(r.submenu));let ni=0;const si=(ai,oi)=>{ni+=1,ri(ai).forEach(li=>{const ci=oi>=ti.w?ti.w-8:(ti.w+8)*-1,ui=li.querySelector(`ul.${r.container}`),di=Math.round(this.lineHeight*Array.from(ui.children).filter(fi=>fi.tagName==="LI").length);ui.style.left=`${ci}px`,ui.style.right="auto",ui.style.top=n.h>=di+ti.h?"0":`-${ui.offsetHeight-25}px`,ui.style.bottom="auto",ui.style.zIndex=String(ni),ri(ui).length>0&&si(ui,oi-ti.w)})};si(this.container.firstElementChild,n.w)}handleMapMove(){this.closeMenu()}handleEntryCallback(e){var ii;e.preventDefault(),e.stopPropagation();const n=e.currentTarget,ei=this.menuEntries.get(n.id);if(!ei)return;const ti={data:ei.data,coordinate:this.coordinate};this.closeMenu(),(ii=ei.callback)==null||ii.call(ei,ti,this.map)}handleAddMenuEntry(e,n){this.menuEntries.set(e.id,e),this.positionContainer(),"callback"in e&&typeof e.callback=="function"&&n.addEventListener("click",this.entryCallbackEventListener,!1)}};var logger$1=LoggerByDefault.getLogger("contextMenu");class ContextMenu extends ControlExtended{constructor(e){if(e=e||{},super({element:e.element,target:e.target,render:e.render}),!(this instanceof ContextMenu))throw new TypeError("ERROR CLASS_CONSTRUCTOR");return this.CLASSNAME="ContextMenu",this.initialize(e),this.container=this.initContainer(),this.element?this.element.appendChild(this.container):this.element=this.container,this}setMap(e){e?(e.addControl(this.contextmenu),e.addOverlay(this._marker),this.auto&&this.addEventsListeners()):this.auto&&this.removeEventsListeners(),super.setMap(e)}initialize(e){this.uid=SelectorID.generate(),this.options={collapsed:!0,draggable:!1,auto:!0,panel:!0,contextMenuItemsOptions:[]},Helper.assign(this.options,e),this.collapsed=this.options.collapsed,this.draggable=this.options.draggable,this.auto=this.options.auto,this.buttonContextMenuShow=null,this.panelContextMenuContainer=null,this.panelContextMenuHeaderContainer=null,this.buttonContextMenuClose=null,this.panelContextMenuEntriesContainer=null,this.eventsListeners=[],this.controlList=[],this.itiPoints=new Array(7),this._marker=new Overlay({element:this._createPinDOMOverlay(Marker.lightOrange),stopEvent:!1,offset:Marker.defaultOffset});var n=this.getAvailableContextMenuControls.call(this);this.contextMenuItemsOptions=[],e.contextMenuItemsOptions instanceof Array&&e.contextMenuItemsOptions&&e.contextMenuItemsOptions.length>0&&(this.contextMenuItemsOptions=e.contextMenuItemsOptions.map(ei=>({...ei,classname:"ol-context-menu-custom fr-text--md"}))),this.contextmenu=new R$1({defaultItems:!1,width:250,items:n})}initContainer(){var e=this._createMainContainerElement(),n=this.buttonPointInfoShow=this._createShowPointInfoPictoElement();e.appendChild(n);var ei=this.panelPointInfoContainer=this._createPointInfoPanelElement(),ti=this._createPointInfoPanelDivElement();ei.appendChild(ti);var ii=this.panelPointInfoEntriesContainer=this._createEntriesElement();ei.appendChild(ii);var ri=this.panelPointInfoHeaderContainer=this._createPointInfoPanelHeaderElement(),ni=this._createPointInfoPanelIconElement();ri.appendChild(ni);var si=this._createPointInfoPanelTitleElement();ri.appendChild(si);var ai=this.buttonPointInfoClose=this._createPointInfoPanelCloseElement();return ri.appendChild(ai),ti.appendChild(ri),e.appendChild(ei),logger$1.log(e),e}addEventsListeners(){this.contextmenu.on("open",e=>{e.this=this,this.onOpenContextMenu(e)}),this.contextmenu.on("close",e=>{e.this=this,this.onCloseContextMenu(e)}),document.addEventListener("click",e=>{this.container.contains(e.target)||this.contextmenu.closeMenu()})}removeEventsListeners(){}getAvailableContextMenuControls(){var e=[{text:"Informations sur des couches",classname:"ol-context-menu-custom fr-text--md",callback:this.getFeatureInfo.bind(this),control_CLASSNAME:"GetFeatureInfo"},{text:"Adresse / Coordonnes",classname:"ol-context-menu-custom fr-text--md",callback:this.displayAdressAndCoordinate.bind(this),control_CLASSNAME:"ContextMenu"},{text:"Itinraire depuis ce lieu",classname:"ol-context-menu-custom fr-text--md",callback:this.defineStartPoint.bind(this),control_CLASSNAME:"Route"},{text:"Itinraire vers ce lieu",classname:"ol-context-menu-custom fr-text--md",callback:this.defineEndPoint.bind(this),control_CLASSNAME:"Route"},{text:"Zone selon temps de trajet",classname:"ol-context-menu-custom fr-text--md",callback:this.computeIsochrone.bind(this),control_CLASSNAME:"Isocurve"},{text:"Ajouter des cartes / donnes",classname:"ol-context-menu-custom fr-text--md",callback:this.openCatalogue.bind(this),control_CLASSNAME:"Catalog"},"separator",{text:"Afficher la lgende",classname:"ol-context-menu-custom fr-text--md",callback:this.displayLegend.bind(this),control_CLASSNAME:"Legends"}],n=this.getMap(),ei=[];n&&(ei=n.getControls().getArray());var ti=e.filter(ii=>{if(ei.filter(ni=>ni.CLASSNAME&&ni.CLASSNAME==ii.control_CLASSNAME).length>0||ii=="separator")return ii});return Array.prototype.push.apply(ti,this.contextMenuItemsOptions),ti}defineStartPoint(e){let n=this.to4326(e.coordinate);var ei=this.getMap().getControls().getArray().filter(ti=>ti.CLASSNAME=="Route")[0];ei._showRouteButton.click(),ei._showRouteButton.setAttribute("aria-pressed",!0),this.itiPoints[0]=n,ei.setData({points:this.itiPoints})}defineEndPoint(e){let n=this.to4326(e.coordinate);var ei=this.getMap().getControls().getArray().filter(ti=>ti.CLASSNAME=="Route")[0];ei._showRouteButton.click(),ei._showRouteButton.setAttribute("aria-pressed",!0),this.itiPoints[6]=n,ei.setData({points:this.itiPoints})}to4326(e){return transform$1([parseFloat(e[0]),parseFloat(e[1])],"EPSG:3857","EPSG:4326")}computeIsochrone(e){var n=this.getMap().getControls().getArray().filter(ii=>ii.CLASSNAME=="Isocurve")[0];n._pictoIsoButton.click(),n._pictoIsoButton.setAttribute("aria-pressed",!0);let ei=this.to4326(e.coordinate);var ti=n.getData();ti.point=ei,n.setData(ti)}getFeatureInfo(e){var n=this.getMap().getControls().getArray().filter(ri=>ri.CLASSNAME=="GetFeatureInfo")[0],ei;n.buttonGetFeatureInfoShow.getAttribute("aria-pressed")==="false"&&(ei=!1),n.buttonGetFeatureInfoShow.click(),n.buttonGetFeatureInfoShow.setAttribute("aria-pressed",!0);let ii={pixel:this.getMap().getPixelFromCoordinate(e.coordinate),map:this.getMap(),coordinate:e.coordinate};this.getMap().dispatchEvent({type:"singleclick",...ii}),ei===!1&&n.buttonGetFeatureInfoShow.setAttribute("aria-pressed",!1)}displayLegend(e){var n=this.getMap().getControls().getArray().filter(ei=>ei.CLASSNAME=="Legends")[0];n.buttonLegendsShow.click(),n.buttonLegendsShow.setAttribute("aria-pressed",!0)}openCatalogue(e){var n=this.getMap().getControls().getArray().filter(ei=>ei.CLASSNAME=="Catalog")[0];n.buttonCatalogShow.click(),n.buttonCatalogShow.setAttribute("aria-pressed",!0)}displayAdressAndCoordinate(e){let n=this.to4326(e.coordinate);this.panelPointInfoEntriesContainer.innerHTML="",this._marker.setPosition(fromLonLat(n)),this.buttonPointInfoShow.click(),this.buttonPointInfoShow.setAttribute("aria-pressed",!0);var ei=document.createElement("div");ei.innerHTML=n[1].toFixed(6)+", "+n[0].toFixed(6);var ti=document.createElement("div"),ii=document.createElement("div"),ri=document.createElement("div");this.panelPointInfoEntriesContainer.appendChild(ei),this.panelPointInfoEntriesContainer.appendChild(ti),this.panelPointInfoEntriesContainer.appendChild(ii),this.panelPointInfoEntriesContainer.appendChild(ri);var ni={rawResponse:!1,scope:null,onSuccess:function(li){li.elevations.length>0&&li.elevations[0].z&&(ri.innerHTML="Altitude : "+li.elevations[0].z+"m")},onFailure:function(li){},positions:[{lon:n[0],lat:n[1]}],outputFormat:"json"};Gp.Services.getAltitude(ni);var si={onSuccess:function(li){li.locations.length>0&&(ii.innerHTML="Parcelle : "+li.locations[0].placeAttributes.districtcode+" / "+li.locations[0].placeAttributes.section+" / "+li.locations[0].placeAttributes.number)},onFailure:function(li){},position:{lon:n[1],lat:n[0]},searchGeometry:{type:"Circle",coordinates:[n[1],n[0]],radius:100},index:"CadastralParcel",maximumResponses:1};Gp.Services.reverseGeocode(si);var ai=async function(){let li={layer:"LIMITES_ADMINISTRATIVES_EXPRESS.LATEST:commune",attributes:["code_postal","nom_officiel"]};const ci=await OGCRequest.computeGenericGPFWFS(li.layer,li.attributes,li.around||0,li.geom_name||"geometrie",li.additional_cql||"",li.epsg||4326,li.get_geom||!1,n[0],n[1]);ci.length&&(ti.innerHTML=ci[0].join(", "))},oi={onSuccess:function(li){li.locations.length>0?ti.innerHTML=li.locations[0].placeAttributes.label:ai()},onFailure:function(li){ai()},position:{lon:n[0],lat:n[1]},searchGeometry:{type:"Circle",coordinates:[n[0],n[1]],radius:100},index:"StreetAddress",maximumResponses:1};Gp.Services.reverseGeocode(oi)}onShowPointInfoClick(e){e.target.ariaPressed==="true"&&this.onPanelOpen(),logger$1.trace(e);var n=this.buttonPointInfoShow.ariaPressed;this.collapsed=n!=="true",this.dispatchEvent("change:collapsed"),this.options.position&&!this.collapsed&&this.updatePosition(this.options.position)}onClosePointInfoClick(e){logger$1.trace(e),this._marker.setPosition(void 0)}onCloseContextMenu(e){e.target.clear()}onOpenContextMenu(e){const ei=this.getMap().getViewport().querySelector("canvas");if(!ei||e.originalEvent.target!==ei){this.contextmenu.clear(),this.contextmenu.closeMenu();return}var ti=()=>{e.this.controlList=[];var ri=e.this.getMap().getControls().getArray().filter(ni=>ni.CLASSNAME=="Route");ri.length>0&&ri[0].on("route:newresults",()=>{e.this.itiPoints=new Array(7)})},ii=e.this.getAvailableContextMenuControls();e.target.clear(),e.target.extend(ii),ti()}}Object.assign(ContextMenu.prototype,ContextMenuDOM);Object.assign(ContextMenu.prototype,ContextMenu);Object.assign(ContextMenu.prototype,Widget);window.ol&&window.ol.control&&(window.ol.control.ContextMenu=ContextMenu);var title$2="reporting";const stringToHTML=_t=>{var e=function(){if(!window.DOMParser)return!1;var ii=new DOMParser;try{ii.parseFromString("x","text/html")}catch{return!1}return!0};if(e()){var n=new DOMParser,ei=n.parseFromString(_t,"text/html");return ei.body}var ti=document.createElement("div");return ti.innerHTML=_t,ti};var ReportingDOM={_addUID:function(_t){var e=this.uid?_t+"-"+this.uid:_t;return e},_createMainContainerElement:function(){var _t=document.createElement("div");return _t.id=this._addUID("GPreporting"),_t.className="gpf-widget gpf-widget-button gpf-mobile-fullscreen gpf-button-no-gutter",_t},_createShowReportingPictoElement:function(){var _t=this,e=document.createElement("button"),n=document.createElement("span");return e.appendChild(n),e.id=this._addUID("GPshowReportingPicto"),e.className="gpf-btn gpf-btn--tertiary gpf-btn-icon gpf-btn-icon-reporting fr-btn fr-btn--tertiary ",e.title=`${title$2}`,e.setAttribute("aria-label","Signalement"),e.setAttribute("tabindex","0"),e.setAttribute("aria-pressed",!1),e.setAttribute("type","button"),e.addEventListener?e.addEventListener("click",function(ei){var ti=ei.target.ariaPressed==="true";ei.target.setAttribute("aria-pressed",!ti),_t.onShowReportingClick(ei)}):e.attachEvent&&e.attachEvent("onclick",function(ei){var ti=ei.target.ariaPressed==="true";ei.target.setAttribute("aria-pressed",!ti),_t.onShowReportingClick(ei)}),e},_createReportingPanelElement:function(){var _t=document.createElement("dialog");return _t.id=this._addUID("GPreportingPanel"),_t.className="GPpanel gpf-panel fr-modal",_t},_createReportingPanelDivElement:function(){var _t=document.createElement("div");return _t.className="gpf-panel__body fr-modal__body",_t},_createReportingPanelHeaderElement:function(){var _t=document.createElement("div");return _t.className="gpf-panel__header fr-modal__header gpf-panel__header_reporting",_t},_createReportingPanelIconElement:function(){var _t=this,e=document.createElement("label");return e.className="gpf-btn-header gpf-btn-icon-header-reporting",e.title="Retour  l'tape prcdente",e.addEventListener("click",function(n){_t.onPrevReportingClick(n)}),e},_createReportingPanelTitleElement:function(_t){var e=document.createElement("div");return e.className="gpf-panel__title fr-modal__title fr-pt-4w",e.innerHTML=_t||"",e},_createReportingPanelCloseElement:function(){var _t=this,e=document.createElement("button");e.className="gpf-btn gpf-btn-icon-close fr-btn--close fr-btn fr-btn--tertiary-no-outline fr-m-1w",e.title="Fermer le panneau",e.addEventListener?e.addEventListener("click",function(ei){document.getElementById(_t._addUID("GPshowReportingPicto")).click(),_t.onCloseReportingClick(ei)},!1):e.attachEvent&&e.attachEvent("onclick",function(ei){document.getElementById(_t._addUID("GPshowReportingPicto")).click(),_t.onCloseReportingClick(ei)});var n=document.createElement("span");return n.className="gpf-visible",n.innerText="Fermer",e.appendChild(n),e},_createReportingPanelFooterElement:function(){var _t=document.createElement("div");return _t.className="gpf-panel__footer fr-modal__footer gpf-panel__footer_reporting gpf-visible",_t},_createReportingButtonAnnulerFooterElement:function(){var _t=this,e=document.createElement("button");return e.className="gpf-btn gpf-btn--tertiary gpf-btn-icon-annuler fr-btn fr-btn--tertiary fr-m-1w",e.title="Annuler",e.textContent="Annuler",e.addEventListener?e.addEventListener("click",function(n){_t.onCancelReportingClick(n)},!1):e.attachEvent&&e.attachEvent("onclick",function(n){_t.onCancelReportingClick(n)}),e},_createReportingButtonSuivantFooterElement:function(){var _t=this,e=document.createElement("button");return e.className="gpf-btn gpf-btn--primary gpf-btn-icon-suivant fr-btn fr-btn--primary fr-m-1w",e.title="Suivant",e.textContent="Suivant",e.addEventListener?e.addEventListener("click",function(n){_t.onNextReportingClick(n)},!1):e.attachEvent&&e.attachEvent("onclick",function(n){_t.onNextReportingClick(n)}),e},_createReportingPanelInputElement:function(){var _t=document.createElement("div");_t.id=this._addUID("GPreportingPanelInput"),_t.className="gpf-panel__content fr-modal__content fr-px-3w gpf-hidden";var e=document.createElement("p");return e.innerHTML="Cliquez sur la carte  l'endroit que vous souhaitez corriger.",e.className="gpf-label fr-label",_t.appendChild(e),_t},_createReportingPanelFormElement:function(_t){var e=this,n=document.createElement("form");n.id=this._addUID("GPreportingForm"),n.className="gpf-panel__content fr-modal__content gpf-hidden",n.addEventListener("submit",function(gi){gi.preventDefault();var vi=document.getElementById(ei).value,yi=document.getElementById(ni).value,_i=document.getElementById(ii),Ai=_i.options[_i.selectedIndex].textContent;return e.onReportingFormSubmit({target:gi.target,name:vi,desc:yi,theme:Ai}),!1});var ei=this._addUID("GPreportingFormLabelName"),ti=`
        <div class="fr-input-group">
            <label class="gpf-label fr-label" for="${ei}">Titre (obligatoire)</label>
            <input class="gpf-input fr-input" type="text" id="${ei}" name="GPreportingLabelName" required>
        </div>
        `,ii=this._addUID("GPreportingFormSelectTheme"),ri=`
        <div class="fr-select-group">
            <label class="gpf-label fr-label" for="${ii}">
                Objet du signalement (obligatoire)
            </label>
            <select class="gpf-select fr-select" id="${ii}" name="GPreportingSelectTheme" required>
                <option value="" selected disabled >Slectionner une option</option>
                ${_t.map(gi=>`<option value="${gi}">${gi}</option>`).join("")}
            </select>
        </div>
        `,ni=this._addUID("GPreportingFormTextDesc"),si=`
        <div class="fr-input-group">
            <label class="gpf-label fr-label" for="${ni}">
                Description (obligatoire)
            </label>
            <textarea class="gpf-input fr-input" id="${ni}" name="GPreportingTextDesc" required></textarea>
        </div>
        `,ai=this._addUID("GPreportingFormButtonDrawing"),oi=`
        <div class="gpf-btn-group">
            <button id="${ai}" class="gpf-btn fr-btn fr-btn--secondary fr-btn--icon-left fr-icon-edit-box-line">
                Dessiner sur la carte
            </button>
        </div>
        `,li=`
        <fieldset class="fr-fieldset" id="GPreportingFormFieldset" role="group" aria-labelledby="GPreportingFormFieldsetMessages">
            ${ti}
            ${ri}
            ${si}
            <div class="fr-messages-group gpf-hidden" id="GPreportingFormFieldsetMessages" aria-live="polite">
                <p class="fr-message fr-message--error" id="GPreportingFormFieldsetMessage">Les champs sont obligatoires</p>
            </div>
            ${oi}
        </fieldset>
        `,ci=stringToHTML(li);const ui=ci.attachShadow({mode:"open"});ui.innerHTML=li.trim();var di=ui.getElementById(ai);di&&di.addEventListener("click",gi=>{this.onShowFormDrawingReportingClick(gi)});var fi=ui.getElementById(ei);fi&&fi.addEventListener("change",gi=>{this.onEntryFormNameReportingChange(gi)});var hi=ui.getElementById(ii);hi&&hi.addEventListener("change",gi=>{this.onSelectFormThemeReportingChange(gi)});var pi=ui.getElementById(ni);return pi&&pi.addEventListener("change",gi=>{this.onEntryFormDescReportingChange(gi)}),n.appendChild(ui),n},_createReportingSubmitFormElement:function(){var _t=document.createElement("input");return _t.id=this._addUID("GPreportingSubmit"),_t.className="gpf-btn fr-btn gpf-hidden",_t.type="submit",_t.value="",_t},_createReportingPanelDrawingElement:function(){var _t=document.createElement("div");return _t.id=this._addUID("GPreportingPanelDrawing"),_t.className="gpf-panel__content fr-modal__content gpf-hidden",_t},_createReportingPanelSendElement:function(){var _t=document.createElement("div");_t.id=this._addUID("GPreportingPanelSend"),_t.className="gpf-panel__content fr-modal__content fr-px-3w gpf-hidden";var e=this._addUID("GPreportingLabelEmail"),n=`
        <div class="fr-input-group">
            <label class="gpf-label fr-label" for="${e}">Adresse courriel
                <span class="fr-hint-text">Pour valider le signalement, renseignez votre adresse courriel. Nous vous tiendrons informs de sa prise en compte.</span>
            </label>
            <input class="gpf-input fr-input" type="text" id="${e}" name="GPreportingLabelEmail" required>
        </div>
        `,ei=this._addUID("GPreportingButtonEnvoyer"),ti=`
        <div class="gpf-btn-group fr-pb-1w">
            <button id="${ei}" class="gpf-btn fr-btn fr-btn--primary">
                Envoyer
            </button>
        </div>
        `,ii=`
        <fieldset class="fr-fieldset" id="GPreportingSendFieldset" role="group" aria-labelledby="GPreportingSendFieldsetMessages">
            ${n}
            ${ti}
            <div class="fr-messages-group gpf-hidden" id="GPreportingSendFieldsetMessages" aria-live="polite">
                <p class="fr-message fr-message--error" id="GPreportingSendFieldsetMessage">Le champ est obligatoire</p>
            </div>
        </fieldset>
        `,ri=stringToHTML(ii);const ni=ri.attachShadow({mode:"open"});ni.innerHTML=ii.trim();var si=ni.getElementById(ei);si&&si.addEventListener("click",oi=>{this.onShowSendReportingClick({target:oi.target,mail:document.getElementById(e).value})});var ai=ni.getElementById(e);return ai&&ai.addEventListener("change",oi=>{this.onEntrySendMailReportingChange(oi)}),_t.appendChild(ni),_t},_createReportingErrorSendElement:function(){var _t=this._addUID("GPreportingSpanError"),e=document.createElement("span");return e.id=_t,e.className="gpf-error fr-error fr-error-text gpf-hidden",e.innerHTML="Une erreur est survenue lors de l'envoi du signalement. <br> Veuillez ressayer plus tard.",e}},logger=LoggerByDefault.getLogger("reporting");class InputActionByDefaut{constructor(e){logger.info("InputActionByDefaut constructor"),this.map=e||null,this.data=null,this.coordinate=null,this.listener=null,this.icon="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAzNiIgd2lkdGg9IjQ4IiBoZWlnaHQ9IjQ4Ij48cGF0aCBmaWxsPSIjMDAwMDkxIiBkPSJNMTguMzY0IDMuNjM2YTkgOSAwIDAgMSAwIDEyLjcyOEwxMiAyMi43MjhsLTYuMzY0LTYuMzY0QTkgOSAwIDAgMSAxOC4zNjQgMy42MzZaTTEyIDhhMiAyIDAgMSAwIDAgNCAyIDIgMCAwIDAgMC00WiIvPjwvc3ZnPg=="}setMap(e){logger.info("InputActionByDefaut map"),this.map=e}setIcon(e){logger.info("InputActionByDefaut icon"),e&&(this.icon=e)}getData(){logger.info("InputActionByDefaut data");var e=this.map.getView().getProjection();this.coordinate||(this.coordinate=this.map.getView().getCenter());var n={type:"FeatureCollection",crs:{type:"name",properties:{name:e.getCode()}},features:[{type:"Feature",crs:{type:"name",properties:{name:e.getCode()}},geometry:{type:"Point",coordinates:this.coordinate||[0,0]},properties:{description:"Point de signalement",date:new Date().toISOString(),author:"Anonyme"}}]};return this.data={location:n},this.data||{location:null}}clear(){logger.info("InputActionByDefaut clear"),this.data=null,this.coordinate=null,this.listener&&(unByKey(this.listener),this.listener=null),this.marker!=null&&(this.map.removeOverlay(this.marker),this.marker=null)}active(){this._addEventsListeners()}disable(){this._removeEventsListeners()}_addEventsListeners(){logger.info("InputActionByDefaut active"),this.map&&(this.listener=this.map.on("singleclick",this._handler.bind(this)))}_removeEventsListeners(){logger.info("InputActionByDefaut disable"),this.map&&unByKey(this.listener)}_handler(e){if(logger.info("InputActionByDefaut handler",e),!!this.map){this.coordinate=e.coordinate,this.marker!=null&&(this.map.removeOverlay(this.marker),this.marker=null);var n=document.createElement("img");n.src=this.icon,this.marker=new Overlay({position:this.coordinate,positioning:"center-center",element:n,stopEvent:!1}),this.map.addOverlay(this.marker)}}}class FormActionByDefaut{constructor(e){logger.info("FormActionByDefaut constructor"),this.data=null,this.form=null,this.submit=null,this.error=null,this.message=null}active(){logger.info("FormActionByDefaut active"),this._addEventsListeners()}disable(){logger.info("FormActionByDefaut disable")}setForm(e){logger.info("FormActionByDefaut form"),this.form=e,this.submit=this.form.querySelector('input[type="submit"]'),this.error=this.form.querySelector("#GPreportingFormFieldset"),this.message=this.form.querySelector("#GPreportingFormFieldsetMessages")}getData(){return logger.info("FormActionByDefaut data"),this.submit.click(),this.data?(this.error.classList.remove("fr-fieldset--error"),this.message.classList.replace("gpf-visible","gpf-hidden")):(this.error.classList.add("fr-fieldset--error"),this.message.classList.replace("gpf-hidden","gpf-visible")),this.data}clear(){logger.info("FormActionByDefaut clear"),this.data=null}_addEventsListeners(){this.form.addEventListener("submit",this._handler.bind(this),{once:!0})}_handler(e){logger.info("FormActionByDefaut handler",e),e.preventDefault();var n=new FormData(e.target),ei=n.get("GPreportingLabelName"),ti=n.get("GPreportingTextDesc"),ii=n.get("GPreportingSelectTheme");return ei&&ti&&ii&&(this.data={name:ei,desc:ti,theme:ii}),!1}}class DrawingActionByDefaut{constructor(e){logger.info("DrawingActionByDefaut constructor"),this.data=null,this.format="geojson",this.map=e||null,this.dom=null,this.Drawing=null,this.DrawingBtn=null,this.DrawingPanel=null}active(){logger.info("ServiceActionByDefaut active"),this.Drawing||this._initializeDrawing(),this.Drawing.setCollapsed(!1),this.DrawingPanel.style.position="relative",this.DrawingPanel.style.left="0px",this.DrawingPanel.style.top="0px",this.DrawingPanel.style.bottom="unset",this.DrawingPanel.style.right="unset"}disable(){logger.info("DrawingActionByDefaut disable"),this.Drawing&&this.Drawing.setCollapsed(!0)}clear(){logger.info("DrawingActionByDefaut clear"),this.data=null}getData(){if(logger.info("DrawingActionByDefaut data"),this.Drawing){var e=this.Drawing.exportFeatures();this.data={drawing:this.format.toLowerCase()==="geojson"?JSON.parse(e):e}}return this.data||{drawing:null}}setMap(e){logger.info("DrawingActionByDefaut map"),this.map=e}setTarget(e){if(logger.info("DrawingActionByDefaut target"),!e){logger.warn("DrawingActionByDefaut target is null");return}this.dom=e}setFormat(e){logger.info("DrawingActionByDefaut format"),e&&(this.format=e)}_initializeDrawing(){if(logger.info("DrawingActionByDefaut initializeDrawing"),!!this.map){var e=1e3;this.Drawing=new Drawing({target:this.dom,id:e,layerDescription:{title:"Signalement",description:"Dessin de signalement"},popup:{display:!1},tools:{export:!1}}),this.Drawing.setExportFormat(this.format);var n=this.Drawing.getContainer();n.className="";var ei=this.DrawingBtn=n.querySelector("#GPshowDrawingPicto-"+e);ei&&(ei.style.display="none");var ti=this.DrawingPanel=n.querySelector("#GPdrawingPanel-"+e);ti&&(ti.style.position="relative",ti.style.left="0px",ti.style.top="0px",ti.style.bottom="unset",ti.style.right="unset",ti.style.margin="auto");var ii=n.querySelector(".gpf-panel__header");ii&&(ii.style.display="none"),this.map.addControl(this.Drawing)}}}class ServiceActionByDefaut{constructor(){logger.info("ServiceActionByDefaut constructor")}active(){logger.info("ServiceActionByDefaut active")}disable(){logger.info("ServiceActionByDefaut disable")}send(e){return logger.info("ServiceActionByDefaut send"),Promise.reject(new Error("ServiceActionByDefaut send not implemented"))}clear(){logger.info("ServiceActionByDefaut clear")}}var lo,Zc,Jc;const ac=class ac extends ControlExtended{constructor(n){n=n||{};super({element:n.element,target:n.target,render:n.render});ic(this,lo);if(!(this instanceof ac))throw new TypeError("ERROR CLASS_CONSTRUCTOR");return ea(this,lo,Zc).call(this,n),this.container=ea(this,lo,Jc).call(this),this.element?this.element.appendChild(this.container):this.element=this.container,this}setMap(n){n?(this.setStep(0),this._setComponents(n),this.draggable&&Draggable.dragElement(this.panelReportingContainer,this.panelReportingHeaderContainer,this.options.position?null:n.getTargetElement()),this.collapsed||this.buttonReportingShow.click(),this.auto&&this._addEventsListeners(n)):this.auto&&this._removeEventsListeners(),super.setMap(n),this.options.position&&this.setPosition(this.options.position),this.options.gutter===!1&&this.getContainer().classList.add("gpf-button-no-gutter")}getContainer(){return this.container}getCollapsed(){return this.collapsed}setCollapsed(n){n!==void 0&&(n&&this.collapsed||!n&&!this.collapsed||(n?this.buttonReportingClose.click():this.buttonReportingShow.click(),this.collapsed=n))}_setComponents(n){this.iocInput||(this.iocInput=new InputActionByDefaut),this.iocInput.setMap(n),this.iocInput.setIcon(this.options.icon||null),this.iocForm||(this.iocForm=new FormActionByDefaut),this.iocForm.setForm(this.formReportingContainer),this.iocService||(this.iocService=new ServiceActionByDefaut),this.iocDrawing||(this.iocDrawing=new DrawingActionByDefaut),this.iocDrawing.setFormat(this.options.format||"geojson"),this.iocDrawing.setMap(n),this.iocDrawing.setTarget(this.drawingReportingContainer),this.stepContainer[0].action=this.iocInput,this.stepContainer[1].action=this.iocForm,this.stepContainer[2].action=this.iocService,this.stepContainer[3].action=this.iocDrawing}setComponentInput(n){this.iocInput=n}setComponentForm(n){this.iocForm=n}setComponentService(n){this.iocService=n}setComponentDrawing(n){this.iocDrawing=n}_addEventsListeners(n){this.eventsListeners["custom:action"]=function(ei){logger.trace(ei)},n.getLayers().on("some:event",this.eventsListeners["custom:action"])}_removeEventsListeners(){var n=this.getMap();n.getLayers().un("some:event",this.eventsListeners["custom:action"]),delete this.eventsListeners["custom:action"]}setStep(n){if(n!==void 0){for(let ii=0;ii<this.stepContainer.length;ii++){this.stepContainer[ii].container.classList.replace("gpf-visible","gpf-hidden");var ti=this.stepContainer[ii].action;ti&&(ti.disable(),ti.clear())}this.step=n;var ei=this.stepContainer[n].container;ei.classList.replace("gpf-hidden","gpf-visible");var ti=this.stepContainer[n].action;ti&&ti.active(),this.divReportingTitle.innerHTML=this.stepContainer[n].name,this.panelReportingFooterContainer.style.display=this.stepContainer[n].footer?"flex":"none",this.reportingBtnAnnulerFooter.style.display=this.stepContainer[n].prev===-1?"none":"flex",this.reportingBtnSuivantFooter.style.display=this.stepContainer[n].next===-1?"none":"flex",this.labelReportingIcon.style.display=this.stepContainer[n].prev===-1?"none":"flex"}}nextStep(){var n=this.step,ei=this.stepContainer[n].next;if(ei!==-1){var ti=this.stepContainer[n].action;if(ti){var ii=ti.getData();if(!ii)return;logger.trace("Reporting nextStep",ii),this.data=Object.assign({},this.data,ii),ti.disable(),ti.clear()}this.setStep(ei)}}prevStep(){var n=this.step,ei=this.stepContainer[n].prev;if(ei!==-1){var ti=this.stepContainer[n].action;ti&&ti.clear(),this.setStep(ei)}}clear(){for(let ri=0;ri<this.stepContainer.length;ri++){this.stepContainer[ri].container.classList.replace("gpf-visible","gpf-hidden");var n=this.stepContainer[ri].action;n&&(n.disable(),n.clear())}var ei=this.iocDrawing.Drawing;if(ei){var ti=ei.getLayer(),ii=this.getMap();ti&&(ii.removeLayer(ti),ei.setLayer())}}onShowReportingClick(n){logger.trace("onShowReportingClick",n);var ei=this.buttonReportingShow.ariaPressed;ei==="true"&&this.onPanelOpen(),this.collapsed=ei!=="true",this.dispatchEvent("change:collapsed"),this.collapsed?this.clear():(this.setStep(0),this.dispatchEvent(this.OPENED_REPORTING_EVENT))}onPrevReportingClick(n){logger.trace("onPrevReportingClick",n),this.prevStep()}onNextReportingClick(n){logger.trace("onNextReportingClick",n),this.nextStep()}onCloseReportingClick(n){logger.trace("onCloseReportingClick",n),this.clear()}onCancelReportingClick(n){logger.trace("onCancelReportingClick",n),this.clear(),this.setStep(0)}onReportingFormSubmit(n){logger.trace("onReportingFormSubmit",n)}onShowFormDrawingReportingClick(n){logger.trace("onShowFormDrawingReportingClick",n),this.setStep(3)}onEntryFormNameReportingChange(n){logger.trace("onEntryFormNameReportingChange",n)}onSelectFormThemeReportingChange(n){logger.trace("onSelectFormThemeReportingChange",n)}onEntryFormDescReportingChange(n){logger.trace("onEntryFormDescReportingChange",n)}onEntrySendMailReportingChange(n){logger.trace("onEntrySendMailReportingChange",n)}onShowSendReportingClick(n){logger.trace("onShowSendReportingClick",n),this.data=Object.assign({},this.data,{mail:n.mail});var ei=this.sendReportingContainer.querySelector("#GPreportingSendFieldset"),ti=this.sendReportingContainer.querySelector("#GPreportingSendFieldsetMessages");if(n.mail)ei.classList.remove("fr-fieldset--error"),ti.classList.replace("gpf-visible","gpf-hidden");else{ei.classList.add("fr-fieldset--error"),ti.classList.replace("gpf-hidden","gpf-visible");return}logger.info("Reporting data to send:",this.data),this.iocService.send(this.data).then(()=>{this.data=null;var ii=this.iocDrawing.Drawing;if(ii){var ri=ii.getLayer(),ni=this.getMap();ri&&(ni.removeLayer(ri),ii.setLayer())}}).then(()=>{this.setStep(0)}).then(()=>{this.dispatchEvent({type:this.SEND_REPORTING_EVENT,data:this.data})}).catch(ii=>{this.spanReportingError.classList.replace("gpf-hidden","gpf-visible"),setTimeout(()=>{this.spanReportingError.classList.replace("gpf-visible","gpf-hidden")},5e3),logger.error(ii)})}};lo=new WeakSet,Zc=function(n){this.uid=SelectorID.generate(),this.options={collapsed:!0,draggable:!1,auto:!0,thematics:["Rseau routier","Btiment","Toponyme","Touristique/randonne","Borne cadastrale","Hydrographie","Vgtation","Autre"]},Helper.assign(this.options,n),this.collapsed=this.options.collapsed,this.draggable=this.options.draggable,this.auto=this.options.auto,this.buttonReportingShow=null,this.panelReportingContainer=null,this.panelReportingHeaderContainer=null,this.panelReportingFooterContainer=null,this.reportingBtnAnnulerFooter=null,this.reportingBtnSuivantFooter=null,this.buttonReportingClose=null,this.divReportingTitle=null,this.labelReportingIcon=null,this.buttonReportingSubmit=null,this.spanReportingError=null,this.inputReportingContainer=null,this.formReportingContainer=null,this.sendReportingContainer=null,this.drawingReportingContainer=null,this.step=0,this.stepContainer=[{name:"",footer:!0,header:!0,next:1,prev:-1,action:null,container:null},{name:"Dcrire le signalement",footer:!0,header:!0,next:2,prev:0,action:null,container:null},{name:"Envoyer un signalement",footer:!1,header:!0,next:-1,prev:1,action:null,container:null},{name:"Dessiner sur la carte",footer:!0,header:!0,next:1,prev:1,action:null,container:null}],this.iocInput=null,this.iocForm=null,this.iocService=null,this.iocDrawing=null,this.data=null,this.eventsListeners=[],this.OPENED_REPORTING_EVENT="reporting:opened",this.SEND_REPORTING_EVENT="reporting:sending"},Jc=function(){var n=this._createMainContainerElement(),ei=this.buttonReportingShow=this._createShowReportingPictoElement();n.appendChild(ei);var ti=this.panelReportingContainer=this._createReportingPanelElement(),ii=this._createReportingPanelDivElement();ti.appendChild(ii);var ri=this.panelReportingHeaderContainer=this._createReportingPanelHeaderElement(),ni=this.labelReportingIcon=this._createReportingPanelIconElement();ri.appendChild(ni);var si=this.divReportingTitle=this._createReportingPanelTitleElement();ri.appendChild(si);var ai=this.buttonReportingClose=this._createReportingPanelCloseElement();ri.appendChild(ai);var oi=this.panelReportingFooterContainer=this._createReportingPanelFooterElement(),li=this.reportingBtnAnnulerFooter=this._createReportingButtonAnnulerFooterElement(),ci=this.reportingBtnSuivantFooter=this._createReportingButtonSuivantFooterElement();oi.appendChild(li),oi.appendChild(ci);var ui=this.inputReportingContainer=this._createReportingPanelInputElement();this.stepContainer[0].container=ui;var di=this.formReportingContainer=this._createReportingPanelFormElement(this.options.thematics);this.stepContainer[1].container=di;var fi=this.sendReportingContainer=this._createReportingPanelSendElement();this.stepContainer[2].container=fi;var hi=this.drawingReportingContainer=this._createReportingPanelDrawingElement();this.stepContainer[3].container=hi;var pi=this.buttonReportingSubmit=this._createReportingSubmitFormElement();di.appendChild(pi);var gi=this.spanReportingError=this._createReportingErrorSendElement();return fi.appendChild(gi),ii.appendChild(ri),ii.appendChild(ui),ii.appendChild(di),ii.appendChild(fi),ii.appendChild(hi),ii.appendChild(oi),n.appendChild(ti),logger.log(n),n};let Reporting=ac;Object.assign(Reporting.prototype,ReportingDOM);Object.assign(Reporting.prototype,Widget);window.ol&&window.ol.control&&(window.ol.control.Reporting=Reporting);var ajv={exports:{}},core$1={};const $id$7="https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description="Meta-schema for $data reference (JSON AnySchema extension proposal)",type$7="object",required$5=["$data"],properties$6={$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties$4=!1,require$$9={$id:$id$7,description,type:type$7,required:required$5,properties:properties$6,additionalProperties:additionalProperties$4};var uri={},fastUri={exports:{}},utils,hasRequiredUtils;function requireUtils(){if(hasRequiredUtils)return utils;hasRequiredUtils=1;const _t=RegExp.prototype.test.bind(/^[\da-f]{8}-[\da-f]{4}-[\da-f]{4}-[\da-f]{4}-[\da-f]{12}$/iu),e=RegExp.prototype.test.bind(/^(?:(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)$/u);function n(ci){let ui="",di=0,fi=0;for(fi=0;fi<ci.length;fi++)if(di=ci[fi].charCodeAt(0),di!==48){if(!(di>=48&&di<=57||di>=65&&di<=70||di>=97&&di<=102))return"";ui+=ci[fi];break}for(fi+=1;fi<ci.length;fi++){if(di=ci[fi].charCodeAt(0),!(di>=48&&di<=57||di>=65&&di<=70||di>=97&&di<=102))return"";ui+=ci[fi]}return ui}const ei=RegExp.prototype.test.bind(/[^!"$&'()*+,\-.;=_`a-z{}~]/u);function ti(ci){return ci.length=0,!0}function ii(ci,ui,di){if(ci.length){const fi=n(ci);if(fi!=="")ui.push(fi);else return di.error=!0,!1;ci.length=0}return!0}function ri(ci){let ui=0;const di={error:!1,address:"",zone:""},fi=[],hi=[];let pi=!1,gi=!1,vi=ii;for(let yi=0;yi<ci.length;yi++){const _i=ci[yi];if(!(_i==="["||_i==="]"))if(_i===":"){if(pi===!0&&(gi=!0),!vi(hi,fi,di))break;if(++ui>7){di.error=!0;break}yi>0&&ci[yi-1]===":"&&(pi=!0),fi.push(":");continue}else if(_i==="%"){if(!vi(hi,fi,di))break;vi=ti}else{hi.push(_i);continue}}return hi.length&&(vi===ti?di.zone=hi.join(""):gi?fi.push(hi.join("")):fi.push(n(hi))),di.address=fi.join(""),di}function ni(ci){if(si(ci,":")<2)return{host:ci,isIPV6:!1};const ui=ri(ci);if(ui.error)return{host:ci,isIPV6:!1};{let di=ui.address,fi=ui.address;return ui.zone&&(di+="%"+ui.zone,fi+="%25"+ui.zone),{host:di,isIPV6:!0,escapedHost:fi}}}function si(ci,ui){let di=0;for(let fi=0;fi<ci.length;fi++)ci[fi]===ui&&di++;return di}function ai(ci){let ui=ci;const di=[];let fi=-1,hi=0;for(;hi=ui.length;){if(hi===1){if(ui===".")break;if(ui==="/"){di.push("/");break}else{di.push(ui);break}}else if(hi===2){if(ui[0]==="."){if(ui[1]===".")break;if(ui[1]==="/"){ui=ui.slice(2);continue}}else if(ui[0]==="/"&&(ui[1]==="."||ui[1]==="/")){di.push("/");break}}else if(hi===3&&ui==="/.."){di.length!==0&&di.pop(),di.push("/");break}if(ui[0]==="."){if(ui[1]==="."){if(ui[2]==="/"){ui=ui.slice(3);continue}}else if(ui[1]==="/"){ui=ui.slice(2);continue}}else if(ui[0]==="/"&&ui[1]==="."){if(ui[2]==="/"){ui=ui.slice(2);continue}else if(ui[2]==="."&&ui[3]==="/"){ui=ui.slice(3),di.length!==0&&di.pop();continue}}if((fi=ui.indexOf("/",1))===-1){di.push(ui);break}else di.push(ui.slice(0,fi)),ui=ui.slice(fi)}return di.join("")}function oi(ci,ui){const di=ui!==!0?escape:unescape;return ci.scheme!==void 0&&(ci.scheme=di(ci.scheme)),ci.userinfo!==void 0&&(ci.userinfo=di(ci.userinfo)),ci.host!==void 0&&(ci.host=di(ci.host)),ci.path!==void 0&&(ci.path=di(ci.path)),ci.query!==void 0&&(ci.query=di(ci.query)),ci.fragment!==void 0&&(ci.fragment=di(ci.fragment)),ci}function li(ci){const ui=[];if(ci.userinfo!==void 0&&(ui.push(ci.userinfo),ui.push("@")),ci.host!==void 0){let di=unescape(ci.host);if(!e(di)){const fi=ni(di);fi.isIPV6===!0?di=`[${fi.escapedHost}]`:di=ci.host}ui.push(di)}return(typeof ci.port=="number"||typeof ci.port=="string")&&(ui.push(":"),ui.push(String(ci.port))),ui.length?ui.join(""):void 0}return utils={nonSimpleDomain:ei,recomposeAuthority:li,normalizeComponentEncoding:oi,removeDotSegments:ai,isIPv4:e,isUUID:_t,normalizeIPv6:ni,stringArrayToHexStripped:n},utils}var schemes,hasRequiredSchemes;function requireSchemes(){if(hasRequiredSchemes)return schemes;hasRequiredSchemes=1;const{isUUID:_t}=requireUtils(),e=/([\da-z][\d\-a-z]{0,31}):((?:[\w!$'()*+,\-.:;=@]|%[\da-f]{2})+)/iu,n=["http","https","ws","wss","urn","urn:uuid"];function ei(_i){return n.indexOf(_i)!==-1}function ti(_i){return _i.secure===!0?!0:_i.secure===!1?!1:_i.scheme?_i.scheme.length===3&&(_i.scheme[0]==="w"||_i.scheme[0]==="W")&&(_i.scheme[1]==="s"||_i.scheme[1]==="S")&&(_i.scheme[2]==="s"||_i.scheme[2]==="S"):!1}function ii(_i){return _i.host||(_i.error=_i.error||"HTTP URIs must have a host."),_i}function ri(_i){const Ai=String(_i.scheme).toLowerCase()==="https";return(_i.port===(Ai?443:80)||_i.port==="")&&(_i.port=void 0),_i.path||(_i.path="/"),_i}function ni(_i){return _i.secure=ti(_i),_i.resourceName=(_i.path||"/")+(_i.query?"?"+_i.query:""),_i.path=void 0,_i.query=void 0,_i}function si(_i){if((_i.port===(ti(_i)?443:80)||_i.port==="")&&(_i.port=void 0),typeof _i.secure=="boolean"&&(_i.scheme=_i.secure?"wss":"ws",_i.secure=void 0),_i.resourceName){const[Ai,Ei]=_i.resourceName.split("?");_i.path=Ai&&Ai!=="/"?Ai:void 0,_i.query=Ei,_i.resourceName=void 0}return _i.fragment=void 0,_i}function ai(_i,Ai){if(!_i.path)return _i.error="URN can not be parsed",_i;const Ei=_i.path.match(e);if(Ei){const Si=Ai.scheme||_i.scheme||"urn";_i.nid=Ei[1].toLowerCase(),_i.nss=Ei[2];const wi=`${Si}:${Ai.nid||_i.nid}`,Oi=yi(wi);_i.path=void 0,Oi&&(_i=Oi.parse(_i,Ai))}else _i.error=_i.error||"URN can not be parsed.";return _i}function oi(_i,Ai){if(_i.nid===void 0)throw new Error("URN without nid cannot be serialized");const Ei=Ai.scheme||_i.scheme||"urn",Si=_i.nid.toLowerCase(),wi=`${Ei}:${Ai.nid||Si}`,Oi=yi(wi);Oi&&(_i=Oi.serialize(_i,Ai));const Ii=_i,Li=_i.nss;return Ii.path=`${Si||Ai.nid}:${Li}`,Ai.skipEscape=!0,Ii}function li(_i,Ai){const Ei=_i;return Ei.uuid=Ei.nss,Ei.nss=void 0,!Ai.tolerant&&(!Ei.uuid||!_t(Ei.uuid))&&(Ei.error=Ei.error||"UUID is not valid."),Ei}function ci(_i){const Ai=_i;return Ai.nss=(_i.uuid||"").toLowerCase(),Ai}const ui={scheme:"http",domainHost:!0,parse:ii,serialize:ri},di={scheme:"https",domainHost:ui.domainHost,parse:ii,serialize:ri},fi={scheme:"ws",domainHost:!0,parse:ni,serialize:si},hi={scheme:"wss",domainHost:fi.domainHost,parse:fi.parse,serialize:fi.serialize},vi={http:ui,https:di,ws:fi,wss:hi,urn:{scheme:"urn",parse:ai,serialize:oi,skipNormalize:!0},"urn:uuid":{scheme:"urn:uuid",parse:li,serialize:ci,skipNormalize:!0}};Object.setPrototypeOf(vi,null);function yi(_i){return _i&&(vi[_i]||vi[_i.toLowerCase()])||void 0}return schemes={wsIsSecure:ti,SCHEMES:vi,isValidSchemeName:ei,getSchemeHandler:yi},schemes}var hasRequiredFastUri;function requireFastUri(){if(hasRequiredFastUri)return fastUri.exports;hasRequiredFastUri=1;const{normalizeIPv6:_t,removeDotSegments:e,recomposeAuthority:n,normalizeComponentEncoding:ei,isIPv4:ti,nonSimpleDomain:ii}=requireUtils(),{SCHEMES:ri,getSchemeHandler:ni}=requireSchemes();function si(hi,pi){return typeof hi=="string"?hi=ci(di(hi,pi),pi):typeof hi=="object"&&(hi=di(ci(hi,pi),pi)),hi}function ai(hi,pi,gi){const vi=gi?Object.assign({scheme:"null"},gi):{scheme:"null"},yi=oi(di(hi,vi),di(pi,vi),vi,!0);return vi.skipEscape=!0,ci(yi,vi)}function oi(hi,pi,gi,vi){const yi={};return vi||(hi=di(ci(hi,gi),gi),pi=di(ci(pi,gi),gi)),gi=gi||{},!gi.tolerant&&pi.scheme?(yi.scheme=pi.scheme,yi.userinfo=pi.userinfo,yi.host=pi.host,yi.port=pi.port,yi.path=e(pi.path||""),yi.query=pi.query):(pi.userinfo!==void 0||pi.host!==void 0||pi.port!==void 0?(yi.userinfo=pi.userinfo,yi.host=pi.host,yi.port=pi.port,yi.path=e(pi.path||""),yi.query=pi.query):(pi.path?(pi.path[0]==="/"?yi.path=e(pi.path):((hi.userinfo!==void 0||hi.host!==void 0||hi.port!==void 0)&&!hi.path?yi.path="/"+pi.path:hi.path?yi.path=hi.path.slice(0,hi.path.lastIndexOf("/")+1)+pi.path:yi.path=pi.path,yi.path=e(yi.path)),yi.query=pi.query):(yi.path=hi.path,pi.query!==void 0?yi.query=pi.query:yi.query=hi.query),yi.userinfo=hi.userinfo,yi.host=hi.host,yi.port=hi.port),yi.scheme=hi.scheme),yi.fragment=pi.fragment,yi}function li(hi,pi,gi){return typeof hi=="string"?(hi=unescape(hi),hi=ci(ei(di(hi,gi),!0),{...gi,skipEscape:!0})):typeof hi=="object"&&(hi=ci(ei(hi,!0),{...gi,skipEscape:!0})),typeof pi=="string"?(pi=unescape(pi),pi=ci(ei(di(pi,gi),!0),{...gi,skipEscape:!0})):typeof pi=="object"&&(pi=ci(ei(pi,!0),{...gi,skipEscape:!0})),hi.toLowerCase()===pi.toLowerCase()}function ci(hi,pi){const gi={host:hi.host,scheme:hi.scheme,userinfo:hi.userinfo,port:hi.port,path:hi.path,query:hi.query,nid:hi.nid,nss:hi.nss,uuid:hi.uuid,fragment:hi.fragment,reference:hi.reference,resourceName:hi.resourceName,secure:hi.secure,error:""},vi=Object.assign({},pi),yi=[],_i=ni(vi.scheme||gi.scheme);_i&&_i.serialize&&_i.serialize(gi,vi),gi.path!==void 0&&(vi.skipEscape?gi.path=unescape(gi.path):(gi.path=escape(gi.path),gi.scheme!==void 0&&(gi.path=gi.path.split("%3A").join(":")))),vi.reference!=="suffix"&&gi.scheme&&yi.push(gi.scheme,":");const Ai=n(gi);if(Ai!==void 0&&(vi.reference!=="suffix"&&yi.push("//"),yi.push(Ai),gi.path&&gi.path[0]!=="/"&&yi.push("/")),gi.path!==void 0){let Ei=gi.path;!vi.absolutePath&&(!_i||!_i.absolutePath)&&(Ei=e(Ei)),Ai===void 0&&Ei[0]==="/"&&Ei[1]==="/"&&(Ei="/%2F"+Ei.slice(2)),yi.push(Ei)}return gi.query!==void 0&&yi.push("?",gi.query),gi.fragment!==void 0&&yi.push("#",gi.fragment),yi.join("")}const ui=/^(?:([^#/:?]+):)?(?:\/\/((?:([^#/?@]*)@)?(\[[^#/?\]]+\]|[^#/:?]*)(?::(\d*))?))?([^#?]*)(?:\?([^#]*))?(?:#((?:.|[\n\r])*))?/u;function di(hi,pi){const gi=Object.assign({},pi),vi={scheme:void 0,userinfo:void 0,host:"",port:void 0,path:"",query:void 0,fragment:void 0};let yi=!1;gi.reference==="suffix"&&(gi.scheme?hi=gi.scheme+":"+hi:hi="//"+hi);const _i=hi.match(ui);if(_i){if(vi.scheme=_i[1],vi.userinfo=_i[3],vi.host=_i[4],vi.port=parseInt(_i[5],10),vi.path=_i[6]||"",vi.query=_i[7],vi.fragment=_i[8],isNaN(vi.port)&&(vi.port=_i[5]),vi.host)if(ti(vi.host)===!1){const Si=_t(vi.host);vi.host=Si.host.toLowerCase(),yi=Si.isIPV6}else yi=!0;vi.scheme===void 0&&vi.userinfo===void 0&&vi.host===void 0&&vi.port===void 0&&vi.query===void 0&&!vi.path?vi.reference="same-document":vi.scheme===void 0?vi.reference="relative":vi.fragment===void 0?vi.reference="absolute":vi.reference="uri",gi.reference&&gi.reference!=="suffix"&&gi.reference!==vi.reference&&(vi.error=vi.error||"URI is not a "+gi.reference+" reference.");const Ai=ni(gi.scheme||vi.scheme);if(!gi.unicodeSupport&&(!Ai||!Ai.unicodeSupport)&&vi.host&&(gi.domainHost||Ai&&Ai.domainHost)&&yi===!1&&ii(vi.host))try{vi.host=URL.domainToASCII(vi.host.toLowerCase())}catch(Ei){vi.error=vi.error||"Host's domain name can not be converted to ASCII: "+Ei}(!Ai||Ai&&!Ai.skipNormalize)&&(hi.indexOf("%")!==-1&&(vi.scheme!==void 0&&(vi.scheme=unescape(vi.scheme)),vi.host!==void 0&&(vi.host=unescape(vi.host))),vi.path&&(vi.path=escape(unescape(vi.path))),vi.fragment&&(vi.fragment=encodeURI(decodeURIComponent(vi.fragment)))),Ai&&Ai.parse&&Ai.parse(vi,gi)}else vi.error=vi.error||"URI can not be parsed.";return vi}const fi={SCHEMES:ri,normalize:si,resolve:ai,resolveComponent:oi,equal:li,serialize:ci,parse:di};return fastUri.exports=fi,fastUri.exports.default=fi,fastUri.exports.fastUri=fi,fastUri.exports}var hasRequiredUri;function requireUri(){if(hasRequiredUri)return uri;hasRequiredUri=1,Object.defineProperty(uri,"__esModule",{value:!0});const _t=requireFastUri();return _t.code='require("ajv/dist/runtime/uri").default',uri.default=_t,uri}var hasRequiredCore$1;function requireCore$1(){return hasRequiredCore$1||(hasRequiredCore$1=1,(function(_t){Object.defineProperty(_t,"__esModule",{value:!0}),_t.CodeGen=_t.Name=_t.nil=_t.stringify=_t.str=_t._=_t.KeywordCxt=void 0;var e=requireValidate();Object.defineProperty(_t,"KeywordCxt",{enumerable:!0,get:function(){return e.KeywordCxt}});var n=requireCodegen();Object.defineProperty(_t,"_",{enumerable:!0,get:function(){return n._}}),Object.defineProperty(_t,"str",{enumerable:!0,get:function(){return n.str}}),Object.defineProperty(_t,"stringify",{enumerable:!0,get:function(){return n.stringify}}),Object.defineProperty(_t,"nil",{enumerable:!0,get:function(){return n.nil}}),Object.defineProperty(_t,"Name",{enumerable:!0,get:function(){return n.Name}}),Object.defineProperty(_t,"CodeGen",{enumerable:!0,get:function(){return n.CodeGen}});const ei=requireValidation_error(),ti=requireRef_error(),ii=requireRules(),ri=requireCompile(),ni=requireCodegen(),si=requireResolve(),ai=requireDataType(),oi=requireUtil(),li=require$$9,ci=requireUri(),ui=(zi,Wi)=>new RegExp(zi,Wi);ui.code="new RegExp";const di=["removeAdditional","useDefaults","coerceTypes"],fi=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),hi={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},pi={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},gi=200;function vi(zi){var Wi,Ti,ki,xi,Mi,Ui,Yi,sr,cr,ir,Zi,rr,ar,pr,Gi,gr,Br,Nr,mr,Mr,Er,Fr,or,yr,_r;const Ar=zi.strict,wr=(Wi=zi.code)===null||Wi===void 0?void 0:Wi.optimize,Rr=wr===!0||wr===void 0?1:wr||0,Sr=(ki=(Ti=zi.code)===null||Ti===void 0?void 0:Ti.regExp)!==null&&ki!==void 0?ki:ui,Gr=(xi=zi.uriResolver)!==null&&xi!==void 0?xi:ci.default;return{strictSchema:(Ui=(Mi=zi.strictSchema)!==null&&Mi!==void 0?Mi:Ar)!==null&&Ui!==void 0?Ui:!0,strictNumbers:(sr=(Yi=zi.strictNumbers)!==null&&Yi!==void 0?Yi:Ar)!==null&&sr!==void 0?sr:!0,strictTypes:(ir=(cr=zi.strictTypes)!==null&&cr!==void 0?cr:Ar)!==null&&ir!==void 0?ir:"log",strictTuples:(rr=(Zi=zi.strictTuples)!==null&&Zi!==void 0?Zi:Ar)!==null&&rr!==void 0?rr:"log",strictRequired:(pr=(ar=zi.strictRequired)!==null&&ar!==void 0?ar:Ar)!==null&&pr!==void 0?pr:!1,code:zi.code?{...zi.code,optimize:Rr,regExp:Sr}:{optimize:Rr,regExp:Sr},loopRequired:(Gi=zi.loopRequired)!==null&&Gi!==void 0?Gi:gi,loopEnum:(gr=zi.loopEnum)!==null&&gr!==void 0?gr:gi,meta:(Br=zi.meta)!==null&&Br!==void 0?Br:!0,messages:(Nr=zi.messages)!==null&&Nr!==void 0?Nr:!0,inlineRefs:(mr=zi.inlineRefs)!==null&&mr!==void 0?mr:!0,schemaId:(Mr=zi.schemaId)!==null&&Mr!==void 0?Mr:"$id",addUsedSchema:(Er=zi.addUsedSchema)!==null&&Er!==void 0?Er:!0,validateSchema:(Fr=zi.validateSchema)!==null&&Fr!==void 0?Fr:!0,validateFormats:(or=zi.validateFormats)!==null&&or!==void 0?or:!0,unicodeRegExp:(yr=zi.unicodeRegExp)!==null&&yr!==void 0?yr:!0,int32range:(_r=zi.int32range)!==null&&_r!==void 0?_r:!0,uriResolver:Gr}}class yi{constructor(Wi={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,Wi=this.opts={...Wi,...vi(Wi)};const{es5:Ti,lines:ki}=this.opts.code;this.scope=new ni.ValueScope({scope:{},prefixes:fi,es5:Ti,lines:ki}),this.logger=Li(Wi.logger);const xi=Wi.validateFormats;Wi.validateFormats=!1,this.RULES=(0,ii.getRules)(),_i.call(this,hi,Wi,"NOT SUPPORTED"),_i.call(this,pi,Wi,"DEPRECATED","warn"),this._metaOpts=Oi.call(this),Wi.formats&&Si.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),Wi.keywords&&wi.call(this,Wi.keywords),typeof Wi.meta=="object"&&this.addMetaSchema(Wi.meta),Ei.call(this),Wi.validateFormats=xi}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){const{$data:Wi,meta:Ti,schemaId:ki}=this.opts;let xi=li;ki==="id"&&(xi={...li},xi.id=xi.$id,delete xi.$id),Ti&&Wi&&this.addMetaSchema(xi,xi[ki],!1)}defaultMeta(){const{meta:Wi,schemaId:Ti}=this.opts;return this.opts.defaultMeta=typeof Wi=="object"?Wi[Ti]||Wi:void 0}validate(Wi,Ti){let ki;if(typeof Wi=="string"){if(ki=this.getSchema(Wi),!ki)throw new Error(`no schema with key or ref "${Wi}"`)}else ki=this.compile(Wi);const xi=ki(Ti);return"$async"in ki||(this.errors=ki.errors),xi}compile(Wi,Ti){const ki=this._addSchema(Wi,Ti);return ki.validate||this._compileSchemaEnv(ki)}compileAsync(Wi,Ti){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");const{loadSchema:ki}=this.opts;return xi.call(this,Wi,Ti);async function xi(ir,Zi){await Mi.call(this,ir.$schema);const rr=this._addSchema(ir,Zi);return rr.validate||Ui.call(this,rr)}async function Mi(ir){ir&&!this.getSchema(ir)&&await xi.call(this,{$ref:ir},!0)}async function Ui(ir){try{return this._compileSchemaEnv(ir)}catch(Zi){if(!(Zi instanceof ti.default))throw Zi;return Yi.call(this,Zi),await sr.call(this,Zi.missingSchema),Ui.call(this,ir)}}function Yi({missingSchema:ir,missingRef:Zi}){if(this.refs[ir])throw new Error(`AnySchema ${ir} is loaded but ${Zi} cannot be resolved`)}async function sr(ir){const Zi=await cr.call(this,ir);this.refs[ir]||await Mi.call(this,Zi.$schema),this.refs[ir]||this.addSchema(Zi,ir,Ti)}async function cr(ir){const Zi=this._loading[ir];if(Zi)return Zi;try{return await(this._loading[ir]=ki(ir))}finally{delete this._loading[ir]}}}addSchema(Wi,Ti,ki,xi=this.opts.validateSchema){if(Array.isArray(Wi)){for(const Ui of Wi)this.addSchema(Ui,void 0,ki,xi);return this}let Mi;if(typeof Wi=="object"){const{schemaId:Ui}=this.opts;if(Mi=Wi[Ui],Mi!==void 0&&typeof Mi!="string")throw new Error(`schema ${Ui} must be string`)}return Ti=(0,si.normalizeId)(Ti||Mi),this._checkUnique(Ti),this.schemas[Ti]=this._addSchema(Wi,ki,Ti,xi,!0),this}addMetaSchema(Wi,Ti,ki=this.opts.validateSchema){return this.addSchema(Wi,Ti,!0,ki),this}validateSchema(Wi,Ti){if(typeof Wi=="boolean")return!0;let ki;if(ki=Wi.$schema,ki!==void 0&&typeof ki!="string")throw new Error("$schema must be a string");if(ki=ki||this.opts.defaultMeta||this.defaultMeta(),!ki)return this.logger.warn("meta-schema not available"),this.errors=null,!0;const xi=this.validate(ki,Wi);if(!xi&&Ti){const Mi="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(Mi);else throw new Error(Mi)}return xi}getSchema(Wi){let Ti;for(;typeof(Ti=Ai.call(this,Wi))=="string";)Wi=Ti;if(Ti===void 0){const{schemaId:ki}=this.opts,xi=new ri.SchemaEnv({schema:{},schemaId:ki});if(Ti=ri.resolveSchema.call(this,xi,Wi),!Ti)return;this.refs[Wi]=Ti}return Ti.validate||this._compileSchemaEnv(Ti)}removeSchema(Wi){if(Wi instanceof RegExp)return this._removeAllSchemas(this.schemas,Wi),this._removeAllSchemas(this.refs,Wi),this;switch(typeof Wi){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{const Ti=Ai.call(this,Wi);return typeof Ti=="object"&&this._cache.delete(Ti.schema),delete this.schemas[Wi],delete this.refs[Wi],this}case"object":{const Ti=Wi;this._cache.delete(Ti);let ki=Wi[this.opts.schemaId];return ki&&(ki=(0,si.normalizeId)(ki),delete this.schemas[ki],delete this.refs[ki]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(Wi){for(const Ti of Wi)this.addKeyword(Ti);return this}addKeyword(Wi,Ti){let ki;if(typeof Wi=="string")ki=Wi,typeof Ti=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),Ti.keyword=ki);else if(typeof Wi=="object"&&Ti===void 0){if(Ti=Wi,ki=Ti.keyword,Array.isArray(ki)&&!ki.length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if(Ni.call(this,ki,Ti),!Ti)return(0,oi.eachItem)(ki,Mi=>$i.call(this,Mi)),this;er.call(this,Ti);const xi={...Ti,type:(0,ai.getJSONTypes)(Ti.type),schemaType:(0,ai.getJSONTypes)(Ti.schemaType)};return(0,oi.eachItem)(ki,xi.type.length===0?Mi=>$i.call(this,Mi,xi):Mi=>xi.type.forEach(Ui=>$i.call(this,Mi,xi,Ui))),this}getKeyword(Wi){const Ti=this.RULES.all[Wi];return typeof Ti=="object"?Ti.definition:!!Ti}removeKeyword(Wi){const{RULES:Ti}=this;delete Ti.keywords[Wi],delete Ti.all[Wi];for(const ki of Ti.rules){const xi=ki.rules.findIndex(Mi=>Mi.keyword===Wi);xi>=0&&ki.rules.splice(xi,1)}return this}addFormat(Wi,Ti){return typeof Ti=="string"&&(Ti=new RegExp(Ti)),this.formats[Wi]=Ti,this}errorsText(Wi=this.errors,{separator:Ti=", ",dataVar:ki="data"}={}){return!Wi||Wi.length===0?"No errors":Wi.map(xi=>`${ki}${xi.instancePath} ${xi.message}`).reduce((xi,Mi)=>xi+Ti+Mi)}$dataMetaSchema(Wi,Ti){const ki=this.RULES.all;Wi=JSON.parse(JSON.stringify(Wi));for(const xi of Ti){const Mi=xi.split("/").slice(1);let Ui=Wi;for(const Yi of Mi)Ui=Ui[Yi];for(const Yi in ki){const sr=ki[Yi];if(typeof sr!="object")continue;const{$data:cr}=sr.definition,ir=Ui[Yi];cr&&ir&&(Ui[Yi]=nr(ir))}}return Wi}_removeAllSchemas(Wi,Ti){for(const ki in Wi){const xi=Wi[ki];(!Ti||Ti.test(ki))&&(typeof xi=="string"?delete Wi[ki]:xi&&!xi.meta&&(this._cache.delete(xi.schema),delete Wi[ki]))}}_addSchema(Wi,Ti,ki,xi=this.opts.validateSchema,Mi=this.opts.addUsedSchema){let Ui;const{schemaId:Yi}=this.opts;if(typeof Wi=="object")Ui=Wi[Yi];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof Wi!="boolean")throw new Error("schema must be object or boolean")}let sr=this._cache.get(Wi);if(sr!==void 0)return sr;ki=(0,si.normalizeId)(Ui||ki);const cr=si.getSchemaRefs.call(this,Wi,ki);return sr=new ri.SchemaEnv({schema:Wi,schemaId:Yi,meta:Ti,baseId:ki,localRefs:cr}),this._cache.set(sr.schema,sr),Mi&&!ki.startsWith("#")&&(ki&&this._checkUnique(ki),this.refs[ki]=sr),xi&&this.validateSchema(Wi,!0),sr}_checkUnique(Wi){if(this.schemas[Wi]||this.refs[Wi])throw new Error(`schema with key or id "${Wi}" already exists`)}_compileSchemaEnv(Wi){if(Wi.meta?this._compileMetaSchema(Wi):ri.compileSchema.call(this,Wi),!Wi.validate)throw new Error("ajv implementation error");return Wi.validate}_compileMetaSchema(Wi){const Ti=this.opts;this.opts=this._metaOpts;try{ri.compileSchema.call(this,Wi)}finally{this.opts=Ti}}}yi.ValidationError=ei.default,yi.MissingRefError=ti.default,_t.default=yi;function _i(zi,Wi,Ti,ki="error"){for(const xi in zi){const Mi=xi;Mi in Wi&&this.logger[ki](`${Ti}: option ${xi}. ${zi[Mi]}`)}}function Ai(zi){return zi=(0,si.normalizeId)(zi),this.schemas[zi]||this.refs[zi]}function Ei(){const zi=this.opts.schemas;if(zi)if(Array.isArray(zi))this.addSchema(zi);else for(const Wi in zi)this.addSchema(zi[Wi],Wi)}function Si(){for(const zi in this.opts.formats){const Wi=this.opts.formats[zi];Wi&&this.addFormat(zi,Wi)}}function wi(zi){if(Array.isArray(zi)){this.addVocabulary(zi);return}this.logger.warn("keywords option as map is deprecated, pass array");for(const Wi in zi){const Ti=zi[Wi];Ti.keyword||(Ti.keyword=Wi),this.addKeyword(Ti)}}function Oi(){const zi={...this.opts};for(const Wi of di)delete zi[Wi];return zi}const Ii={log(){},warn(){},error(){}};function Li(zi){if(zi===!1)return Ii;if(zi===void 0)return console;if(zi.log&&zi.warn&&zi.error)return zi;throw new Error("logger must implement log, warn and error methods")}const Di=/^[a-z_$][a-z0-9_$:-]*$/i;function Ni(zi,Wi){const{RULES:Ti}=this;if((0,oi.eachItem)(zi,ki=>{if(Ti.keywords[ki])throw new Error(`Keyword ${ki} is already defined`);if(!Di.test(ki))throw new Error(`Keyword ${ki} has invalid name`)}),!!Wi&&Wi.$data&&!("code"in Wi||"validate"in Wi))throw new Error('$data keyword must have "code" or "validate" function')}function $i(zi,Wi,Ti){var ki;const xi=Wi==null?void 0:Wi.post;if(Ti&&xi)throw new Error('keyword with "post" flag cannot have "type"');const{RULES:Mi}=this;let Ui=xi?Mi.post:Mi.rules.find(({type:sr})=>sr===Ti);if(Ui||(Ui={type:Ti,rules:[]},Mi.rules.push(Ui)),Mi.keywords[zi]=!0,!Wi)return;const Yi={keyword:zi,definition:{...Wi,type:(0,ai.getJSONTypes)(Wi.type),schemaType:(0,ai.getJSONTypes)(Wi.schemaType)}};Wi.before?Ki.call(this,Ui,Yi,Wi.before):Ui.rules.push(Yi),Mi.all[zi]=Yi,(ki=Wi.implements)===null||ki===void 0||ki.forEach(sr=>this.addKeyword(sr))}function Ki(zi,Wi,Ti){const ki=zi.rules.findIndex(xi=>xi.keyword===Ti);ki>=0?zi.rules.splice(ki,0,Wi):(zi.rules.push(Wi),this.logger.warn(`rule ${Ti} is not defined`))}function er(zi){let{metaSchema:Wi}=zi;Wi!==void 0&&(zi.$data&&this.opts.$data&&(Wi=nr(Wi)),zi.validateSchema=this.compile(Wi,!0))}const Vi={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function nr(zi){return{anyOf:[zi,Vi]}}})(core$1)),core$1}var draft7={},core={},id={},hasRequiredId;function requireId(){if(hasRequiredId)return id;hasRequiredId=1,Object.defineProperty(id,"__esModule",{value:!0});const _t={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};return id.default=_t,id}var ref={},hasRequiredRef;function requireRef(){if(hasRequiredRef)return ref;hasRequiredRef=1,Object.defineProperty(ref,"__esModule",{value:!0}),ref.callRef=ref.getValidate=void 0;const _t=requireRef_error(),e=requireCode(),n=requireCodegen(),ei=requireNames(),ti=requireCompile(),ii=requireUtil(),ri={keyword:"$ref",schemaType:"string",code(ai){const{gen:oi,schema:li,it:ci}=ai,{baseId:ui,schemaEnv:di,validateName:fi,opts:hi,self:pi}=ci,{root:gi}=di;if((li==="#"||li==="#/")&&ui===gi.baseId)return yi();const vi=ti.resolveRef.call(pi,gi,ui,li);if(vi===void 0)throw new _t.default(ci.opts.uriResolver,ui,li);if(vi instanceof ti.SchemaEnv)return _i(vi);return Ai(vi);function yi(){if(di===gi)return si(ai,fi,di,di.$async);const Ei=oi.scopeValue("root",{ref:gi});return si(ai,(0,n._)`${Ei}.validate`,gi,gi.$async)}function _i(Ei){const Si=ni(ai,Ei);si(ai,Si,Ei,Ei.$async)}function Ai(Ei){const Si=oi.scopeValue("schema",hi.code.source===!0?{ref:Ei,code:(0,n.stringify)(Ei)}:{ref:Ei}),wi=oi.name("valid"),Oi=ai.subschema({schema:Ei,dataTypes:[],schemaPath:n.nil,topSchemaRef:Si,errSchemaPath:li},wi);ai.mergeEvaluated(Oi),ai.ok(wi)}}};function ni(ai,oi){const{gen:li}=ai;return oi.validate?li.scopeValue("validate",{ref:oi.validate}):(0,n._)`${li.scopeValue("wrapper",{ref:oi})}.validate`}ref.getValidate=ni;function si(ai,oi,li,ci){const{gen:ui,it:di}=ai,{allErrors:fi,schemaEnv:hi,opts:pi}=di,gi=pi.passContext?ei.default.this:n.nil;ci?vi():yi();function vi(){if(!hi.$async)throw new Error("async schema referenced by sync schema");const Ei=ui.let("valid");ui.try(()=>{ui.code((0,n._)`await ${(0,e.callValidateCode)(ai,oi,gi)}`),Ai(oi),fi||ui.assign(Ei,!0)},Si=>{ui.if((0,n._)`!(${Si} instanceof ${di.ValidationError})`,()=>ui.throw(Si)),_i(Si),fi||ui.assign(Ei,!1)}),ai.ok(Ei)}function yi(){ai.result((0,e.callValidateCode)(ai,oi,gi),()=>Ai(oi),()=>_i(oi))}function _i(Ei){const Si=(0,n._)`${Ei}.errors`;ui.assign(ei.default.vErrors,(0,n._)`${ei.default.vErrors} === null ? ${Si} : ${ei.default.vErrors}.concat(${Si})`),ui.assign(ei.default.errors,(0,n._)`${ei.default.vErrors}.length`)}function Ai(Ei){var Si;if(!di.opts.unevaluated)return;const wi=(Si=li==null?void 0:li.validate)===null||Si===void 0?void 0:Si.evaluated;if(di.props!==!0)if(wi&&!wi.dynamicProps)wi.props!==void 0&&(di.props=ii.mergeEvaluated.props(ui,wi.props,di.props));else{const Oi=ui.var("props",(0,n._)`${Ei}.evaluated.props`);di.props=ii.mergeEvaluated.props(ui,Oi,di.props,n.Name)}if(di.items!==!0)if(wi&&!wi.dynamicItems)wi.items!==void 0&&(di.items=ii.mergeEvaluated.items(ui,wi.items,di.items));else{const Oi=ui.var("items",(0,n._)`${Ei}.evaluated.items`);di.items=ii.mergeEvaluated.items(ui,Oi,di.items,n.Name)}}}return ref.callRef=si,ref.default=ri,ref}var hasRequiredCore;function requireCore(){if(hasRequiredCore)return core;hasRequiredCore=1,Object.defineProperty(core,"__esModule",{value:!0});const _t=requireId(),e=requireRef(),n=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",_t.default,e.default];return core.default=n,core}var validation={},limitNumber={},hasRequiredLimitNumber;function requireLimitNumber(){if(hasRequiredLimitNumber)return limitNumber;hasRequiredLimitNumber=1,Object.defineProperty(limitNumber,"__esModule",{value:!0});const _t=requireCodegen(),e=_t.operators,n={maximum:{okStr:"<=",ok:e.LTE,fail:e.GT},minimum:{okStr:">=",ok:e.GTE,fail:e.LT},exclusiveMaximum:{okStr:"<",ok:e.LT,fail:e.GTE},exclusiveMinimum:{okStr:">",ok:e.GT,fail:e.LTE}},ei={message:({keyword:ii,schemaCode:ri})=>(0,_t.str)`must be ${n[ii].okStr} ${ri}`,params:({keyword:ii,schemaCode:ri})=>(0,_t._)`{comparison: ${n[ii].okStr}, limit: ${ri}}`},ti={keyword:Object.keys(n),type:"number",schemaType:"number",$data:!0,error:ei,code(ii){const{keyword:ri,data:ni,schemaCode:si}=ii;ii.fail$data((0,_t._)`${ni} ${n[ri].fail} ${si} || isNaN(${ni})`)}};return limitNumber.default=ti,limitNumber}var multipleOf={},hasRequiredMultipleOf;function requireMultipleOf(){if(hasRequiredMultipleOf)return multipleOf;hasRequiredMultipleOf=1,Object.defineProperty(multipleOf,"__esModule",{value:!0});const _t=requireCodegen(),n={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:{message:({schemaCode:ei})=>(0,_t.str)`must be multiple of ${ei}`,params:({schemaCode:ei})=>(0,_t._)`{multipleOf: ${ei}}`},code(ei){const{gen:ti,data:ii,schemaCode:ri,it:ni}=ei,si=ni.opts.multipleOfPrecision,ai=ti.let("res"),oi=si?(0,_t._)`Math.abs(Math.round(${ai}) - ${ai}) > 1e-${si}`:(0,_t._)`${ai} !== parseInt(${ai})`;ei.fail$data((0,_t._)`(${ri} === 0 || (${ai} = ${ii}/${ri}, ${oi}))`)}};return multipleOf.default=n,multipleOf}var limitLength={},ucs2length={},hasRequiredUcs2length;function requireUcs2length(){if(hasRequiredUcs2length)return ucs2length;hasRequiredUcs2length=1,Object.defineProperty(ucs2length,"__esModule",{value:!0});function _t(e){const n=e.length;let ei=0,ti=0,ii;for(;ti<n;)ei++,ii=e.charCodeAt(ti++),ii>=55296&&ii<=56319&&ti<n&&(ii=e.charCodeAt(ti),(ii&64512)===56320&&ti++);return ei}return ucs2length.default=_t,_t.code='require("ajv/dist/runtime/ucs2length").default',ucs2length}var hasRequiredLimitLength;function requireLimitLength(){if(hasRequiredLimitLength)return limitLength;hasRequiredLimitLength=1,Object.defineProperty(limitLength,"__esModule",{value:!0});const _t=requireCodegen(),e=requireUtil(),n=requireUcs2length(),ti={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:{message({keyword:ii,schemaCode:ri}){const ni=ii==="maxLength"?"more":"fewer";return(0,_t.str)`must NOT have ${ni} than ${ri} characters`},params:({schemaCode:ii})=>(0,_t._)`{limit: ${ii}}`},code(ii){const{keyword:ri,data:ni,schemaCode:si,it:ai}=ii,oi=ri==="maxLength"?_t.operators.GT:_t.operators.LT,li=ai.opts.unicode===!1?(0,_t._)`${ni}.length`:(0,_t._)`${(0,e.useFunc)(ii.gen,n.default)}(${ni})`;ii.fail$data((0,_t._)`${li} ${oi} ${si}`)}};return limitLength.default=ti,limitLength}var pattern={},hasRequiredPattern;function requirePattern(){if(hasRequiredPattern)return pattern;hasRequiredPattern=1,Object.defineProperty(pattern,"__esModule",{value:!0});const _t=requireCode(),e=requireCodegen(),ei={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:{message:({schemaCode:ti})=>(0,e.str)`must match pattern "${ti}"`,params:({schemaCode:ti})=>(0,e._)`{pattern: ${ti}}`},code(ti){const{data:ii,$data:ri,schema:ni,schemaCode:si,it:ai}=ti,oi=ai.opts.unicodeRegExp?"u":"",li=ri?(0,e._)`(new RegExp(${si}, ${oi}))`:(0,_t.usePattern)(ti,ni);ti.fail$data((0,e._)`!${li}.test(${ii})`)}};return pattern.default=ei,pattern}var limitProperties={},hasRequiredLimitProperties;function requireLimitProperties(){if(hasRequiredLimitProperties)return limitProperties;hasRequiredLimitProperties=1,Object.defineProperty(limitProperties,"__esModule",{value:!0});const _t=requireCodegen(),n={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:{message({keyword:ei,schemaCode:ti}){const ii=ei==="maxProperties"?"more":"fewer";return(0,_t.str)`must NOT have ${ii} than ${ti} properties`},params:({schemaCode:ei})=>(0,_t._)`{limit: ${ei}}`},code(ei){const{keyword:ti,data:ii,schemaCode:ri}=ei,ni=ti==="maxProperties"?_t.operators.GT:_t.operators.LT;ei.fail$data((0,_t._)`Object.keys(${ii}).length ${ni} ${ri}`)}};return limitProperties.default=n,limitProperties}var required$4={},hasRequiredRequired;function requireRequired(){if(hasRequiredRequired)return required$4;hasRequiredRequired=1,Object.defineProperty(required$4,"__esModule",{value:!0});const _t=requireCode(),e=requireCodegen(),n=requireUtil(),ti={keyword:"required",type:"object",schemaType:"array",$data:!0,error:{message:({params:{missingProperty:ii}})=>(0,e.str)`must have required property '${ii}'`,params:({params:{missingProperty:ii}})=>(0,e._)`{missingProperty: ${ii}}`},code(ii){const{gen:ri,schema:ni,schemaCode:si,data:ai,$data:oi,it:li}=ii,{opts:ci}=li;if(!oi&&ni.length===0)return;const ui=ni.length>=ci.loopRequired;if(li.allErrors?di():fi(),ci.strictRequired){const gi=ii.parentSchema.properties,{definedProperties:vi}=ii.it;for(const yi of ni)if((gi==null?void 0:gi[yi])===void 0&&!vi.has(yi)){const _i=li.schemaEnv.baseId+li.errSchemaPath,Ai=`required property "${yi}" is not defined at "${_i}" (strictRequired)`;(0,n.checkStrictMode)(li,Ai,li.opts.strictRequired)}}function di(){if(ui||oi)ii.block$data(e.nil,hi);else for(const gi of ni)(0,_t.checkReportMissingProp)(ii,gi)}function fi(){const gi=ri.let("missing");if(ui||oi){const vi=ri.let("valid",!0);ii.block$data(vi,()=>pi(gi,vi)),ii.ok(vi)}else ri.if((0,_t.checkMissingProp)(ii,ni,gi)),(0,_t.reportMissingProp)(ii,gi),ri.else()}function hi(){ri.forOf("prop",si,gi=>{ii.setParams({missingProperty:gi}),ri.if((0,_t.noPropertyInData)(ri,ai,gi,ci.ownProperties),()=>ii.error())})}function pi(gi,vi){ii.setParams({missingProperty:gi}),ri.forOf(gi,si,()=>{ri.assign(vi,(0,_t.propertyInData)(ri,ai,gi,ci.ownProperties)),ri.if((0,e.not)(vi),()=>{ii.error(),ri.break()})},e.nil)}}};return required$4.default=ti,required$4}var limitItems={},hasRequiredLimitItems;function requireLimitItems(){if(hasRequiredLimitItems)return limitItems;hasRequiredLimitItems=1,Object.defineProperty(limitItems,"__esModule",{value:!0});const _t=requireCodegen(),n={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:{message({keyword:ei,schemaCode:ti}){const ii=ei==="maxItems"?"more":"fewer";return(0,_t.str)`must NOT have ${ii} than ${ti} items`},params:({schemaCode:ei})=>(0,_t._)`{limit: ${ei}}`},code(ei){const{keyword:ti,data:ii,schemaCode:ri}=ei,ni=ti==="maxItems"?_t.operators.GT:_t.operators.LT;ei.fail$data((0,_t._)`${ii}.length ${ni} ${ri}`)}};return limitItems.default=n,limitItems}var uniqueItems={},equal={},hasRequiredEqual;function requireEqual(){if(hasRequiredEqual)return equal;hasRequiredEqual=1,Object.defineProperty(equal,"__esModule",{value:!0});const _t=requireFastDeepEqual();return _t.code='require("ajv/dist/runtime/equal").default',equal.default=_t,equal}var hasRequiredUniqueItems;function requireUniqueItems(){if(hasRequiredUniqueItems)return uniqueItems;hasRequiredUniqueItems=1,Object.defineProperty(uniqueItems,"__esModule",{value:!0});const _t=requireDataType(),e=requireCodegen(),n=requireUtil(),ei=requireEqual(),ii={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:{message:({params:{i:ri,j:ni}})=>(0,e.str)`must NOT have duplicate items (items ## ${ni} and ${ri} are identical)`,params:({params:{i:ri,j:ni}})=>(0,e._)`{i: ${ri}, j: ${ni}}`},code(ri){const{gen:ni,data:si,$data:ai,schema:oi,parentSchema:li,schemaCode:ci,it:ui}=ri;if(!ai&&!oi)return;const di=ni.let("valid"),fi=li.items?(0,_t.getSchemaTypes)(li.items):[];ri.block$data(di,hi,(0,e._)`${ci} === false`),ri.ok(di);function hi(){const yi=ni.let("i",(0,e._)`${si}.length`),_i=ni.let("j");ri.setParams({i:yi,j:_i}),ni.assign(di,!0),ni.if((0,e._)`${yi} > 1`,()=>(pi()?gi:vi)(yi,_i))}function pi(){return fi.length>0&&!fi.some(yi=>yi==="object"||yi==="array")}function gi(yi,_i){const Ai=ni.name("item"),Ei=(0,_t.checkDataTypes)(fi,Ai,ui.opts.strictNumbers,_t.DataType.Wrong),Si=ni.const("indices",(0,e._)`{}`);ni.for((0,e._)`;${yi}--;`,()=>{ni.let(Ai,(0,e._)`${si}[${yi}]`),ni.if(Ei,(0,e._)`continue`),fi.length>1&&ni.if((0,e._)`typeof ${Ai} == "string"`,(0,e._)`${Ai} += "_"`),ni.if((0,e._)`typeof ${Si}[${Ai}] == "number"`,()=>{ni.assign(_i,(0,e._)`${Si}[${Ai}]`),ri.error(),ni.assign(di,!1).break()}).code((0,e._)`${Si}[${Ai}] = ${yi}`)})}function vi(yi,_i){const Ai=(0,n.useFunc)(ni,ei.default),Ei=ni.name("outer");ni.label(Ei).for((0,e._)`;${yi}--;`,()=>ni.for((0,e._)`${_i} = ${yi}; ${_i}--;`,()=>ni.if((0,e._)`${Ai}(${si}[${yi}], ${si}[${_i}])`,()=>{ri.error(),ni.assign(di,!1).break(Ei)})))}}};return uniqueItems.default=ii,uniqueItems}var _const={},hasRequired_const;function require_const(){if(hasRequired_const)return _const;hasRequired_const=1,Object.defineProperty(_const,"__esModule",{value:!0});const _t=requireCodegen(),e=requireUtil(),n=requireEqual(),ti={keyword:"const",$data:!0,error:{message:"must be equal to constant",params:({schemaCode:ii})=>(0,_t._)`{allowedValue: ${ii}}`},code(ii){const{gen:ri,data:ni,$data:si,schemaCode:ai,schema:oi}=ii;si||oi&&typeof oi=="object"?ii.fail$data((0,_t._)`!${(0,e.useFunc)(ri,n.default)}(${ni}, ${ai})`):ii.fail((0,_t._)`${oi} !== ${ni}`)}};return _const.default=ti,_const}var _enum={},hasRequired_enum;function require_enum(){if(hasRequired_enum)return _enum;hasRequired_enum=1,Object.defineProperty(_enum,"__esModule",{value:!0});const _t=requireCodegen(),e=requireUtil(),n=requireEqual(),ti={keyword:"enum",schemaType:"array",$data:!0,error:{message:"must be equal to one of the allowed values",params:({schemaCode:ii})=>(0,_t._)`{allowedValues: ${ii}}`},code(ii){const{gen:ri,data:ni,$data:si,schema:ai,schemaCode:oi,it:li}=ii;if(!si&&ai.length===0)throw new Error("enum must have non-empty array");const ci=ai.length>=li.opts.loopEnum;let ui;const di=()=>ui??(ui=(0,e.useFunc)(ri,n.default));let fi;if(ci||si)fi=ri.let("valid"),ii.block$data(fi,hi);else{if(!Array.isArray(ai))throw new Error("ajv implementation error");const gi=ri.const("vSchema",oi);fi=(0,_t.or)(...ai.map((vi,yi)=>pi(gi,yi)))}ii.pass(fi);function hi(){ri.assign(fi,!1),ri.forOf("v",oi,gi=>ri.if((0,_t._)`${di()}(${ni}, ${gi})`,()=>ri.assign(fi,!0).break()))}function pi(gi,vi){const yi=ai[vi];return typeof yi=="object"&&yi!==null?(0,_t._)`${di()}(${ni}, ${gi}[${vi}])`:(0,_t._)`${ni} === ${yi}`}}};return _enum.default=ti,_enum}var hasRequiredValidation;function requireValidation(){if(hasRequiredValidation)return validation;hasRequiredValidation=1,Object.defineProperty(validation,"__esModule",{value:!0});const _t=requireLimitNumber(),e=requireMultipleOf(),n=requireLimitLength(),ei=requirePattern(),ti=requireLimitProperties(),ii=requireRequired(),ri=requireLimitItems(),ni=requireUniqueItems(),si=require_const(),ai=require_enum(),oi=[_t.default,e.default,n.default,ei.default,ti.default,ii.default,ri.default,ni.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},si.default,ai.default];return validation.default=oi,validation}var applicator={},additionalItems={},hasRequiredAdditionalItems;function requireAdditionalItems(){if(hasRequiredAdditionalItems)return additionalItems;hasRequiredAdditionalItems=1,Object.defineProperty(additionalItems,"__esModule",{value:!0}),additionalItems.validateAdditionalItems=void 0;const _t=requireCodegen(),e=requireUtil(),ei={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:{message:({params:{len:ii}})=>(0,_t.str)`must NOT have more than ${ii} items`,params:({params:{len:ii}})=>(0,_t._)`{limit: ${ii}}`},code(ii){const{parentSchema:ri,it:ni}=ii,{items:si}=ri;if(!Array.isArray(si)){(0,e.checkStrictMode)(ni,'"additionalItems" is ignored when "items" is not an array of schemas');return}ti(ii,si)}};function ti(ii,ri){const{gen:ni,schema:si,data:ai,keyword:oi,it:li}=ii;li.items=!0;const ci=ni.const("len",(0,_t._)`${ai}.length`);if(si===!1)ii.setParams({len:ri.length}),ii.pass((0,_t._)`${ci} <= ${ri.length}`);else if(typeof si=="object"&&!(0,e.alwaysValidSchema)(li,si)){const di=ni.var("valid",(0,_t._)`${ci} <= ${ri.length}`);ni.if((0,_t.not)(di),()=>ui(di)),ii.ok(di)}function ui(di){ni.forRange("i",ri.length,ci,fi=>{ii.subschema({keyword:oi,dataProp:fi,dataPropType:e.Type.Num},di),li.allErrors||ni.if((0,_t.not)(di),()=>ni.break())})}}return additionalItems.validateAdditionalItems=ti,additionalItems.default=ei,additionalItems}var prefixItems={},items$1={},hasRequiredItems;function requireItems(){if(hasRequiredItems)return items$1;hasRequiredItems=1,Object.defineProperty(items$1,"__esModule",{value:!0}),items$1.validateTuple=void 0;const _t=requireCodegen(),e=requireUtil(),n=requireCode(),ei={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(ii){const{schema:ri,it:ni}=ii;if(Array.isArray(ri))return ti(ii,"additionalItems",ri);ni.items=!0,!(0,e.alwaysValidSchema)(ni,ri)&&ii.ok((0,n.validateArray)(ii))}};function ti(ii,ri,ni=ii.schema){const{gen:si,parentSchema:ai,data:oi,keyword:li,it:ci}=ii;fi(ai),ci.opts.unevaluated&&ni.length&&ci.items!==!0&&(ci.items=e.mergeEvaluated.items(si,ni.length,ci.items));const ui=si.name("valid"),di=si.const("len",(0,_t._)`${oi}.length`);ni.forEach((hi,pi)=>{(0,e.alwaysValidSchema)(ci,hi)||(si.if((0,_t._)`${di} > ${pi}`,()=>ii.subschema({keyword:li,schemaProp:pi,dataProp:pi},ui)),ii.ok(ui))});function fi(hi){const{opts:pi,errSchemaPath:gi}=ci,vi=ni.length,yi=vi===hi.minItems&&(vi===hi.maxItems||hi[ri]===!1);if(pi.strictTuples&&!yi){const _i=`"${li}" is ${vi}-tuple, but minItems or maxItems/${ri} are not specified or different at path "${gi}"`;(0,e.checkStrictMode)(ci,_i,pi.strictTuples)}}}return items$1.validateTuple=ti,items$1.default=ei,items$1}var hasRequiredPrefixItems;function requirePrefixItems(){if(hasRequiredPrefixItems)return prefixItems;hasRequiredPrefixItems=1,Object.defineProperty(prefixItems,"__esModule",{value:!0});const _t=requireItems(),e={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:n=>(0,_t.validateTuple)(n,"items")};return prefixItems.default=e,prefixItems}var items2020={},hasRequiredItems2020;function requireItems2020(){if(hasRequiredItems2020)return items2020;hasRequiredItems2020=1,Object.defineProperty(items2020,"__esModule",{value:!0});const _t=requireCodegen(),e=requireUtil(),n=requireCode(),ei=requireAdditionalItems(),ii={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:{message:({params:{len:ri}})=>(0,_t.str)`must NOT have more than ${ri} items`,params:({params:{len:ri}})=>(0,_t._)`{limit: ${ri}}`},code(ri){const{schema:ni,parentSchema:si,it:ai}=ri,{prefixItems:oi}=si;ai.items=!0,!(0,e.alwaysValidSchema)(ai,ni)&&(oi?(0,ei.validateAdditionalItems)(ri,oi):ri.ok((0,n.validateArray)(ri)))}};return items2020.default=ii,items2020}var contains={},hasRequiredContains;function requireContains(){if(hasRequiredContains)return contains;hasRequiredContains=1,Object.defineProperty(contains,"__esModule",{value:!0});const _t=requireCodegen(),e=requireUtil(),ei={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:{message:({params:{min:ti,max:ii}})=>ii===void 0?(0,_t.str)`must contain at least ${ti} valid item(s)`:(0,_t.str)`must contain at least ${ti} and no more than ${ii} valid item(s)`,params:({params:{min:ti,max:ii}})=>ii===void 0?(0,_t._)`{minContains: ${ti}}`:(0,_t._)`{minContains: ${ti}, maxContains: ${ii}}`},code(ti){const{gen:ii,schema:ri,parentSchema:ni,data:si,it:ai}=ti;let oi,li;const{minContains:ci,maxContains:ui}=ni;ai.opts.next?(oi=ci===void 0?1:ci,li=ui):oi=1;const di=ii.const("len",(0,_t._)`${si}.length`);if(ti.setParams({min:oi,max:li}),li===void 0&&oi===0){(0,e.checkStrictMode)(ai,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(li!==void 0&&oi>li){(0,e.checkStrictMode)(ai,'"minContains" > "maxContains" is always invalid'),ti.fail();return}if((0,e.alwaysValidSchema)(ai,ri)){let vi=(0,_t._)`${di} >= ${oi}`;li!==void 0&&(vi=(0,_t._)`${vi} && ${di} <= ${li}`),ti.pass(vi);return}ai.items=!0;const fi=ii.name("valid");li===void 0&&oi===1?pi(fi,()=>ii.if(fi,()=>ii.break())):oi===0?(ii.let(fi,!0),li!==void 0&&ii.if((0,_t._)`${si}.length > 0`,hi)):(ii.let(fi,!1),hi()),ti.result(fi,()=>ti.reset());function hi(){const vi=ii.name("_valid"),yi=ii.let("count",0);pi(vi,()=>ii.if(vi,()=>gi(yi)))}function pi(vi,yi){ii.forRange("i",0,di,_i=>{ti.subschema({keyword:"contains",dataProp:_i,dataPropType:e.Type.Num,compositeRule:!0},vi),yi()})}function gi(vi){ii.code((0,_t._)`${vi}++`),li===void 0?ii.if((0,_t._)`${vi} >= ${oi}`,()=>ii.assign(fi,!0).break()):(ii.if((0,_t._)`${vi} > ${li}`,()=>ii.assign(fi,!1).break()),oi===1?ii.assign(fi,!0):ii.if((0,_t._)`${vi} >= ${oi}`,()=>ii.assign(fi,!0)))}}};return contains.default=ei,contains}var dependencies={},hasRequiredDependencies;function requireDependencies(){return hasRequiredDependencies||(hasRequiredDependencies=1,(function(_t){Object.defineProperty(_t,"__esModule",{value:!0}),_t.validateSchemaDeps=_t.validatePropertyDeps=_t.error=void 0;const e=requireCodegen(),n=requireUtil(),ei=requireCode();_t.error={message:({params:{property:si,depsCount:ai,deps:oi}})=>{const li=ai===1?"property":"properties";return(0,e.str)`must have ${li} ${oi} when property ${si} is present`},params:({params:{property:si,depsCount:ai,deps:oi,missingProperty:li}})=>(0,e._)`{property: ${si},
    missingProperty: ${li},
    depsCount: ${ai},
    deps: ${oi}}`};const ti={keyword:"dependencies",type:"object",schemaType:"object",error:_t.error,code(si){const[ai,oi]=ii(si);ri(si,ai),ni(si,oi)}};function ii({schema:si}){const ai={},oi={};for(const li in si){if(li==="__proto__")continue;const ci=Array.isArray(si[li])?ai:oi;ci[li]=si[li]}return[ai,oi]}function ri(si,ai=si.schema){const{gen:oi,data:li,it:ci}=si;if(Object.keys(ai).length===0)return;const ui=oi.let("missing");for(const di in ai){const fi=ai[di];if(fi.length===0)continue;const hi=(0,ei.propertyInData)(oi,li,di,ci.opts.ownProperties);si.setParams({property:di,depsCount:fi.length,deps:fi.join(", ")}),ci.allErrors?oi.if(hi,()=>{for(const pi of fi)(0,ei.checkReportMissingProp)(si,pi)}):(oi.if((0,e._)`${hi} && (${(0,ei.checkMissingProp)(si,fi,ui)})`),(0,ei.reportMissingProp)(si,ui),oi.else())}}_t.validatePropertyDeps=ri;function ni(si,ai=si.schema){const{gen:oi,data:li,keyword:ci,it:ui}=si,di=oi.name("valid");for(const fi in ai)(0,n.alwaysValidSchema)(ui,ai[fi])||(oi.if((0,ei.propertyInData)(oi,li,fi,ui.opts.ownProperties),()=>{const hi=si.subschema({keyword:ci,schemaProp:fi},di);si.mergeValidEvaluated(hi,di)},()=>oi.var(di,!0)),si.ok(di))}_t.validateSchemaDeps=ni,_t.default=ti})(dependencies)),dependencies}var propertyNames={},hasRequiredPropertyNames;function requirePropertyNames(){if(hasRequiredPropertyNames)return propertyNames;hasRequiredPropertyNames=1,Object.defineProperty(propertyNames,"__esModule",{value:!0});const _t=requireCodegen(),e=requireUtil(),ei={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:{message:"property name must be valid",params:({params:ti})=>(0,_t._)`{propertyName: ${ti.propertyName}}`},code(ti){const{gen:ii,schema:ri,data:ni,it:si}=ti;if((0,e.alwaysValidSchema)(si,ri))return;const ai=ii.name("valid");ii.forIn("key",ni,oi=>{ti.setParams({propertyName:oi}),ti.subschema({keyword:"propertyNames",data:oi,dataTypes:["string"],propertyName:oi,compositeRule:!0},ai),ii.if((0,_t.not)(ai),()=>{ti.error(!0),si.allErrors||ii.break()})}),ti.ok(ai)}};return propertyNames.default=ei,propertyNames}var additionalProperties$3={},hasRequiredAdditionalProperties;function requireAdditionalProperties(){if(hasRequiredAdditionalProperties)return additionalProperties$3;hasRequiredAdditionalProperties=1,Object.defineProperty(additionalProperties$3,"__esModule",{value:!0});const _t=requireCode(),e=requireCodegen(),n=requireNames(),ei=requireUtil(),ii={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:{message:"must NOT have additional properties",params:({params:ri})=>(0,e._)`{additionalProperty: ${ri.additionalProperty}}`},code(ri){const{gen:ni,schema:si,parentSchema:ai,data:oi,errsCount:li,it:ci}=ri;if(!li)throw new Error("ajv implementation error");const{allErrors:ui,opts:di}=ci;if(ci.props=!0,di.removeAdditional!=="all"&&(0,ei.alwaysValidSchema)(ci,si))return;const fi=(0,_t.allSchemaProperties)(ai.properties),hi=(0,_t.allSchemaProperties)(ai.patternProperties);pi(),ri.ok((0,e._)`${li} === ${n.default.errors}`);function pi(){ni.forIn("key",oi,Ai=>{!fi.length&&!hi.length?yi(Ai):ni.if(gi(Ai),()=>yi(Ai))})}function gi(Ai){let Ei;if(fi.length>8){const Si=(0,ei.schemaRefOrVal)(ci,ai.properties,"properties");Ei=(0,_t.isOwnProperty)(ni,Si,Ai)}else fi.length?Ei=(0,e.or)(...fi.map(Si=>(0,e._)`${Ai} === ${Si}`)):Ei=e.nil;return hi.length&&(Ei=(0,e.or)(Ei,...hi.map(Si=>(0,e._)`${(0,_t.usePattern)(ri,Si)}.test(${Ai})`))),(0,e.not)(Ei)}function vi(Ai){ni.code((0,e._)`delete ${oi}[${Ai}]`)}function yi(Ai){if(di.removeAdditional==="all"||di.removeAdditional&&si===!1){vi(Ai);return}if(si===!1){ri.setParams({additionalProperty:Ai}),ri.error(),ui||ni.break();return}if(typeof si=="object"&&!(0,ei.alwaysValidSchema)(ci,si)){const Ei=ni.name("valid");di.removeAdditional==="failing"?(_i(Ai,Ei,!1),ni.if((0,e.not)(Ei),()=>{ri.reset(),vi(Ai)})):(_i(Ai,Ei),ui||ni.if((0,e.not)(Ei),()=>ni.break()))}}function _i(Ai,Ei,Si){const wi={keyword:"additionalProperties",dataProp:Ai,dataPropType:ei.Type.Str};Si===!1&&Object.assign(wi,{compositeRule:!0,createErrors:!1,allErrors:!1}),ri.subschema(wi,Ei)}}};return additionalProperties$3.default=ii,additionalProperties$3}var properties$5={},hasRequiredProperties;function requireProperties(){if(hasRequiredProperties)return properties$5;hasRequiredProperties=1,Object.defineProperty(properties$5,"__esModule",{value:!0});const _t=requireValidate(),e=requireCode(),n=requireUtil(),ei=requireAdditionalProperties(),ti={keyword:"properties",type:"object",schemaType:"object",code(ii){const{gen:ri,schema:ni,parentSchema:si,data:ai,it:oi}=ii;oi.opts.removeAdditional==="all"&&si.additionalProperties===void 0&&ei.default.code(new _t.KeywordCxt(oi,ei.default,"additionalProperties"));const li=(0,e.allSchemaProperties)(ni);for(const hi of li)oi.definedProperties.add(hi);oi.opts.unevaluated&&li.length&&oi.props!==!0&&(oi.props=n.mergeEvaluated.props(ri,(0,n.toHash)(li),oi.props));const ci=li.filter(hi=>!(0,n.alwaysValidSchema)(oi,ni[hi]));if(ci.length===0)return;const ui=ri.name("valid");for(const hi of ci)di(hi)?fi(hi):(ri.if((0,e.propertyInData)(ri,ai,hi,oi.opts.ownProperties)),fi(hi),oi.allErrors||ri.else().var(ui,!0),ri.endIf()),ii.it.definedProperties.add(hi),ii.ok(ui);function di(hi){return oi.opts.useDefaults&&!oi.compositeRule&&ni[hi].default!==void 0}function fi(hi){ii.subschema({keyword:"properties",schemaProp:hi,dataProp:hi},ui)}}};return properties$5.default=ti,properties$5}var patternProperties={},hasRequiredPatternProperties;function requirePatternProperties(){if(hasRequiredPatternProperties)return patternProperties;hasRequiredPatternProperties=1,Object.defineProperty(patternProperties,"__esModule",{value:!0});const _t=requireCode(),e=requireCodegen(),n=requireUtil(),ei=requireUtil(),ti={keyword:"patternProperties",type:"object",schemaType:"object",code(ii){const{gen:ri,schema:ni,data:si,parentSchema:ai,it:oi}=ii,{opts:li}=oi,ci=(0,_t.allSchemaProperties)(ni),ui=ci.filter(yi=>(0,n.alwaysValidSchema)(oi,ni[yi]));if(ci.length===0||ui.length===ci.length&&(!oi.opts.unevaluated||oi.props===!0))return;const di=li.strictSchema&&!li.allowMatchingProperties&&ai.properties,fi=ri.name("valid");oi.props!==!0&&!(oi.props instanceof e.Name)&&(oi.props=(0,ei.evaluatedPropsToName)(ri,oi.props));const{props:hi}=oi;pi();function pi(){for(const yi of ci)di&&gi(yi),oi.allErrors?vi(yi):(ri.var(fi,!0),vi(yi),ri.if(fi))}function gi(yi){for(const _i in di)new RegExp(yi).test(_i)&&(0,n.checkStrictMode)(oi,`property ${_i} matches pattern ${yi} (use allowMatchingProperties)`)}function vi(yi){ri.forIn("key",si,_i=>{ri.if((0,e._)`${(0,_t.usePattern)(ii,yi)}.test(${_i})`,()=>{const Ai=ui.includes(yi);Ai||ii.subschema({keyword:"patternProperties",schemaProp:yi,dataProp:_i,dataPropType:ei.Type.Str},fi),oi.opts.unevaluated&&hi!==!0?ri.assign((0,e._)`${hi}[${_i}]`,!0):!Ai&&!oi.allErrors&&ri.if((0,e.not)(fi),()=>ri.break())})})}}};return patternProperties.default=ti,patternProperties}var not={},hasRequiredNot;function requireNot(){if(hasRequiredNot)return not;hasRequiredNot=1,Object.defineProperty(not,"__esModule",{value:!0});const _t=requireUtil(),e={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(n){const{gen:ei,schema:ti,it:ii}=n;if((0,_t.alwaysValidSchema)(ii,ti)){n.fail();return}const ri=ei.name("valid");n.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},ri),n.failResult(ri,()=>n.reset(),()=>n.error())},error:{message:"must NOT be valid"}};return not.default=e,not}var anyOf={},hasRequiredAnyOf;function requireAnyOf(){if(hasRequiredAnyOf)return anyOf;hasRequiredAnyOf=1,Object.defineProperty(anyOf,"__esModule",{value:!0});const e={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:requireCode().validateUnion,error:{message:"must match a schema in anyOf"}};return anyOf.default=e,anyOf}var oneOf={},hasRequiredOneOf;function requireOneOf(){if(hasRequiredOneOf)return oneOf;hasRequiredOneOf=1,Object.defineProperty(oneOf,"__esModule",{value:!0});const _t=requireCodegen(),e=requireUtil(),ei={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:{message:"must match exactly one schema in oneOf",params:({params:ti})=>(0,_t._)`{passingSchemas: ${ti.passing}}`},code(ti){const{gen:ii,schema:ri,parentSchema:ni,it:si}=ti;if(!Array.isArray(ri))throw new Error("ajv implementation error");if(si.opts.discriminator&&ni.discriminator)return;const ai=ri,oi=ii.let("valid",!1),li=ii.let("passing",null),ci=ii.name("_valid");ti.setParams({passing:li}),ii.block(ui),ti.result(oi,()=>ti.reset(),()=>ti.error(!0));function ui(){ai.forEach((di,fi)=>{let hi;(0,e.alwaysValidSchema)(si,di)?ii.var(ci,!0):hi=ti.subschema({keyword:"oneOf",schemaProp:fi,compositeRule:!0},ci),fi>0&&ii.if((0,_t._)`${ci} && ${oi}`).assign(oi,!1).assign(li,(0,_t._)`[${li}, ${fi}]`).else(),ii.if(ci,()=>{ii.assign(oi,!0),ii.assign(li,fi),hi&&ti.mergeEvaluated(hi,_t.Name)})})}}};return oneOf.default=ei,oneOf}var allOf={},hasRequiredAllOf;function requireAllOf(){if(hasRequiredAllOf)return allOf;hasRequiredAllOf=1,Object.defineProperty(allOf,"__esModule",{value:!0});const _t=requireUtil(),e={keyword:"allOf",schemaType:"array",code(n){const{gen:ei,schema:ti,it:ii}=n;if(!Array.isArray(ti))throw new Error("ajv implementation error");const ri=ei.name("valid");ti.forEach((ni,si)=>{if((0,_t.alwaysValidSchema)(ii,ni))return;const ai=n.subschema({keyword:"allOf",schemaProp:si},ri);n.ok(ri),n.mergeEvaluated(ai)})}};return allOf.default=e,allOf}var _if={},hasRequired_if;function require_if(){if(hasRequired_if)return _if;hasRequired_if=1,Object.defineProperty(_if,"__esModule",{value:!0});const _t=requireCodegen(),e=requireUtil(),ei={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:{message:({params:ii})=>(0,_t.str)`must match "${ii.ifClause}" schema`,params:({params:ii})=>(0,_t._)`{failingKeyword: ${ii.ifClause}}`},code(ii){const{gen:ri,parentSchema:ni,it:si}=ii;ni.then===void 0&&ni.else===void 0&&(0,e.checkStrictMode)(si,'"if" without "then" and "else" is ignored');const ai=ti(si,"then"),oi=ti(si,"else");if(!ai&&!oi)return;const li=ri.let("valid",!0),ci=ri.name("_valid");if(ui(),ii.reset(),ai&&oi){const fi=ri.let("ifClause");ii.setParams({ifClause:fi}),ri.if(ci,di("then",fi),di("else",fi))}else ai?ri.if(ci,di("then")):ri.if((0,_t.not)(ci),di("else"));ii.pass(li,()=>ii.error(!0));function ui(){const fi=ii.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},ci);ii.mergeEvaluated(fi)}function di(fi,hi){return()=>{const pi=ii.subschema({keyword:fi},ci);ri.assign(li,ci),ii.mergeValidEvaluated(pi,li),hi?ri.assign(hi,(0,_t._)`${fi}`):ii.setParams({ifClause:fi})}}}};function ti(ii,ri){const ni=ii.schema[ri];return ni!==void 0&&!(0,e.alwaysValidSchema)(ii,ni)}return _if.default=ei,_if}var thenElse={},hasRequiredThenElse;function requireThenElse(){if(hasRequiredThenElse)return thenElse;hasRequiredThenElse=1,Object.defineProperty(thenElse,"__esModule",{value:!0});const _t=requireUtil(),e={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:n,parentSchema:ei,it:ti}){ei.if===void 0&&(0,_t.checkStrictMode)(ti,`"${n}" without "if" is ignored`)}};return thenElse.default=e,thenElse}var hasRequiredApplicator;function requireApplicator(){if(hasRequiredApplicator)return applicator;hasRequiredApplicator=1,Object.defineProperty(applicator,"__esModule",{value:!0});const _t=requireAdditionalItems(),e=requirePrefixItems(),n=requireItems(),ei=requireItems2020(),ti=requireContains(),ii=requireDependencies(),ri=requirePropertyNames(),ni=requireAdditionalProperties(),si=requireProperties(),ai=requirePatternProperties(),oi=requireNot(),li=requireAnyOf(),ci=requireOneOf(),ui=requireAllOf(),di=require_if(),fi=requireThenElse();function hi(pi=!1){const gi=[oi.default,li.default,ci.default,ui.default,di.default,fi.default,ri.default,ni.default,ii.default,si.default,ai.default];return pi?gi.push(e.default,ei.default):gi.push(_t.default,n.default),gi.push(ti.default),gi}return applicator.default=hi,applicator}var format$1={},format={},hasRequiredFormat$1;function requireFormat$1(){if(hasRequiredFormat$1)return format;hasRequiredFormat$1=1,Object.defineProperty(format,"__esModule",{value:!0});const _t=requireCodegen(),n={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:{message:({schemaCode:ei})=>(0,_t.str)`must match format "${ei}"`,params:({schemaCode:ei})=>(0,_t._)`{format: ${ei}}`},code(ei,ti){const{gen:ii,data:ri,$data:ni,schema:si,schemaCode:ai,it:oi}=ei,{opts:li,errSchemaPath:ci,schemaEnv:ui,self:di}=oi;if(!li.validateFormats)return;ni?fi():hi();function fi(){const pi=ii.scopeValue("formats",{ref:di.formats,code:li.code.formats}),gi=ii.const("fDef",(0,_t._)`${pi}[${ai}]`),vi=ii.let("fType"),yi=ii.let("format");ii.if((0,_t._)`typeof ${gi} == "object" && !(${gi} instanceof RegExp)`,()=>ii.assign(vi,(0,_t._)`${gi}.type || "string"`).assign(yi,(0,_t._)`${gi}.validate`),()=>ii.assign(vi,(0,_t._)`"string"`).assign(yi,gi)),ei.fail$data((0,_t.or)(_i(),Ai()));function _i(){return li.strictSchema===!1?_t.nil:(0,_t._)`${ai} && !${yi}`}function Ai(){const Ei=ui.$async?(0,_t._)`(${gi}.async ? await ${yi}(${ri}) : ${yi}(${ri}))`:(0,_t._)`${yi}(${ri})`,Si=(0,_t._)`(typeof ${yi} == "function" ? ${Ei} : ${yi}.test(${ri}))`;return(0,_t._)`${yi} && ${yi} !== true && ${vi} === ${ti} && !${Si}`}}function hi(){const pi=di.formats[si];if(!pi){_i();return}if(pi===!0)return;const[gi,vi,yi]=Ai(pi);gi===ti&&ei.pass(Ei());function _i(){if(li.strictSchema===!1){di.logger.warn(Si());return}throw new Error(Si());function Si(){return`unknown format "${si}" ignored in schema at path "${ci}"`}}function Ai(Si){const wi=Si instanceof RegExp?(0,_t.regexpCode)(Si):li.code.formats?(0,_t._)`${li.code.formats}${(0,_t.getProperty)(si)}`:void 0,Oi=ii.scopeValue("formats",{key:si,ref:Si,code:wi});return typeof Si=="object"&&!(Si instanceof RegExp)?[Si.type||"string",Si.validate,(0,_t._)`${Oi}.validate`]:["string",Si,Oi]}function Ei(){if(typeof pi=="object"&&!(pi instanceof RegExp)&&pi.async){if(!ui.$async)throw new Error("async format in sync schema");return(0,_t._)`await ${yi}(${ri})`}return typeof vi=="function"?(0,_t._)`${yi}(${ri})`:(0,_t._)`${yi}.test(${ri})`}}}};return format.default=n,format}var hasRequiredFormat;function requireFormat(){if(hasRequiredFormat)return format$1;hasRequiredFormat=1,Object.defineProperty(format$1,"__esModule",{value:!0});const e=[requireFormat$1().default];return format$1.default=e,format$1}var metadata={},hasRequiredMetadata;function requireMetadata(){return hasRequiredMetadata||(hasRequiredMetadata=1,Object.defineProperty(metadata,"__esModule",{value:!0}),metadata.contentVocabulary=metadata.metadataVocabulary=void 0,metadata.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"],metadata.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"]),metadata}var hasRequiredDraft7;function requireDraft7(){if(hasRequiredDraft7)return draft7;hasRequiredDraft7=1,Object.defineProperty(draft7,"__esModule",{value:!0});const _t=requireCore(),e=requireValidation(),n=requireApplicator(),ei=requireFormat(),ti=requireMetadata(),ii=[_t.default,e.default,(0,n.default)(),ei.default,ti.metadataVocabulary,ti.contentVocabulary];return draft7.default=ii,draft7}const $schema$6="http://json-schema.org/draft-07/schema#",$id$6="http://json-schema.org/draft-07/schema#",title$1="Core schema meta-schema",definitions={schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type$6=["object","boolean"],properties$4={$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},require$$3={$schema:$schema$6,$id:$id$6,title:title$1,definitions,type:type$6,properties:properties$4,default:!0};var hasRequiredAjv;function requireAjv(){return hasRequiredAjv||(hasRequiredAjv=1,(function(_t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.MissingRefError=e.ValidationError=e.CodeGen=e.Name=e.nil=e.stringify=e.str=e._=e.KeywordCxt=e.Ajv=void 0;const n=requireCore$1(),ei=requireDraft7(),ti=requireDiscriminator(),ii=require$$3,ri=["/properties"],ni="http://json-schema.org/draft-07/schema";class si extends n.default{_addVocabularies(){super._addVocabularies(),ei.default.forEach(di=>this.addVocabulary(di)),this.opts.discriminator&&this.addKeyword(ti.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;const di=this.opts.$data?this.$dataMetaSchema(ii,ri):ii;this.addMetaSchema(di,ni,!1),this.refs["http://json-schema.org/schema"]=ni}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(ni)?ni:void 0)}}e.Ajv=si,_t.exports=e=si,_t.exports.Ajv=si,Object.defineProperty(e,"__esModule",{value:!0}),e.default=si;var ai=requireValidate();Object.defineProperty(e,"KeywordCxt",{enumerable:!0,get:function(){return ai.KeywordCxt}});var oi=requireCodegen();Object.defineProperty(e,"_",{enumerable:!0,get:function(){return oi._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return oi.str}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return oi.stringify}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return oi.nil}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return oi.Name}}),Object.defineProperty(e,"CodeGen",{enumerable:!0,get:function(){return oi.CodeGen}});var li=requireValidation_error();Object.defineProperty(e,"ValidationError",{enumerable:!0,get:function(){return li.default}});var ci=requireRef_error();Object.defineProperty(e,"MissingRefError",{enumerable:!0,get:function(){return ci.default}})})(ajv,ajv.exports)),ajv.exports}var ajvExports=requireAjv();const Ajv=getDefaultExportFromCjs$1(ajvExports);var dist={exports:{}},formats={},hasRequiredFormats;function requireFormats(){return hasRequiredFormats||(hasRequiredFormats=1,(function(_t){Object.defineProperty(_t,"__esModule",{value:!0}),_t.formatNames=_t.fastFormats=_t.fullFormats=void 0;function e(Ii,Li){return{validate:Ii,compare:Li}}_t.fullFormats={date:e(ii,ri),time:e(si(!0),ai),"date-time":e(ci(!0),ui),"iso-time":e(si(),oi),"iso-date-time":e(ci(),di),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri:pi,"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:/^(?:https?|ftp):\/\/(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)(?:\.(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex:Oi,uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,byte:vi,int32:{type:"number",validate:Ai},int64:{type:"number",validate:Ei},float:{type:"number",validate:Si},double:{type:"number",validate:Si},password:!0,binary:!0},_t.fastFormats={..._t.fullFormats,date:e(/^\d\d\d\d-[0-1]\d-[0-3]\d$/,ri),time:e(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,ai),"date-time":e(/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,ui),"iso-time":e(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,oi),"iso-date-time":e(/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,di),uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i},_t.formatNames=Object.keys(_t.fullFormats);function n(Ii){return Ii%4===0&&(Ii%100!==0||Ii%400===0)}const ei=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,ti=[0,31,28,31,30,31,30,31,31,30,31,30,31];function ii(Ii){const Li=ei.exec(Ii);if(!Li)return!1;const Di=+Li[1],Ni=+Li[2],$i=+Li[3];return Ni>=1&&Ni<=12&&$i>=1&&$i<=(Ni===2&&n(Di)?29:ti[Ni])}function ri(Ii,Li){if(Ii&&Li)return Ii>Li?1:Ii<Li?-1:0}const ni=/^(\d\d):(\d\d):(\d\d(?:\.\d+)?)(z|([+-])(\d\d)(?::?(\d\d))?)?$/i;function si(Ii){return function(Di){const Ni=ni.exec(Di);if(!Ni)return!1;const $i=+Ni[1],Ki=+Ni[2],er=+Ni[3],Vi=Ni[4],nr=Ni[5]==="-"?-1:1,zi=+(Ni[6]||0),Wi=+(Ni[7]||0);if(zi>23||Wi>59||Ii&&!Vi)return!1;if($i<=23&&Ki<=59&&er<60)return!0;const Ti=Ki-Wi*nr,ki=$i-zi*nr-(Ti<0?1:0);return(ki===23||ki===-1)&&(Ti===59||Ti===-1)&&er<61}}function ai(Ii,Li){if(!(Ii&&Li))return;const Di=new Date("2020-01-01T"+Ii).valueOf(),Ni=new Date("2020-01-01T"+Li).valueOf();if(Di&&Ni)return Di-Ni}function oi(Ii,Li){if(!(Ii&&Li))return;const Di=ni.exec(Ii),Ni=ni.exec(Li);if(Di&&Ni)return Ii=Di[1]+Di[2]+Di[3],Li=Ni[1]+Ni[2]+Ni[3],Ii>Li?1:Ii<Li?-1:0}const li=/t|\s/i;function ci(Ii){const Li=si(Ii);return function(Ni){const $i=Ni.split(li);return $i.length===2&&ii($i[0])&&Li($i[1])}}function ui(Ii,Li){if(!(Ii&&Li))return;const Di=new Date(Ii).valueOf(),Ni=new Date(Li).valueOf();if(Di&&Ni)return Di-Ni}function di(Ii,Li){if(!(Ii&&Li))return;const[Di,Ni]=Ii.split(li),[$i,Ki]=Li.split(li),er=ri(Di,$i);if(er!==void 0)return er||ai(Ni,Ki)}const fi=/\/|:/,hi=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;function pi(Ii){return fi.test(Ii)&&hi.test(Ii)}const gi=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm;function vi(Ii){return gi.lastIndex=0,gi.test(Ii)}const yi=-2147483648,_i=2**31-1;function Ai(Ii){return Number.isInteger(Ii)&&Ii<=_i&&Ii>=yi}function Ei(Ii){return Number.isInteger(Ii)}function Si(){return!0}const wi=/[^\\]\\Z/;function Oi(Ii){if(wi.test(Ii))return!1;try{return new RegExp(Ii),!0}catch{return!1}}})(formats)),formats}var limit={},hasRequiredLimit;function requireLimit(){return hasRequiredLimit||(hasRequiredLimit=1,(function(_t){Object.defineProperty(_t,"__esModule",{value:!0}),_t.formatLimitDefinition=void 0;const e=requireAjv(),n=requireCodegen(),ei=n.operators,ti={formatMaximum:{okStr:"<=",ok:ei.LTE,fail:ei.GT},formatMinimum:{okStr:">=",ok:ei.GTE,fail:ei.LT},formatExclusiveMaximum:{okStr:"<",ok:ei.LT,fail:ei.GTE},formatExclusiveMinimum:{okStr:">",ok:ei.GT,fail:ei.LTE}},ii={message:({keyword:ni,schemaCode:si})=>(0,n.str)`should be ${ti[ni].okStr} ${si}`,params:({keyword:ni,schemaCode:si})=>(0,n._)`{comparison: ${ti[ni].okStr}, limit: ${si}}`};_t.formatLimitDefinition={keyword:Object.keys(ti),type:"string",schemaType:"string",$data:!0,error:ii,code(ni){const{gen:si,data:ai,schemaCode:oi,keyword:li,it:ci}=ni,{opts:ui,self:di}=ci;if(!ui.validateFormats)return;const fi=new e.KeywordCxt(ci,di.RULES.all.format.definition,"format");fi.$data?hi():pi();function hi(){const vi=si.scopeValue("formats",{ref:di.formats,code:ui.code.formats}),yi=si.const("fmt",(0,n._)`${vi}[${fi.schemaCode}]`);ni.fail$data((0,n.or)((0,n._)`typeof ${yi} != "object"`,(0,n._)`${yi} instanceof RegExp`,(0,n._)`typeof ${yi}.compare != "function"`,gi(yi)))}function pi(){const vi=fi.schema,yi=di.formats[vi];if(!yi||yi===!0)return;if(typeof yi!="object"||yi instanceof RegExp||typeof yi.compare!="function")throw new Error(`"${li}": format "${vi}" does not define "compare" function`);const _i=si.scopeValue("formats",{key:vi,ref:yi,code:ui.code.formats?(0,n._)`${ui.code.formats}${(0,n.getProperty)(vi)}`:void 0});ni.fail$data(gi(_i))}function gi(vi){return(0,n._)`${vi}.compare(${ai}, ${oi}) ${ti[li].fail} 0`}},dependencies:["format"]};const ri=ni=>(ni.addKeyword(_t.formatLimitDefinition),ni);_t.default=ri})(limit)),limit}var hasRequiredDist;function requireDist(){return hasRequiredDist||(hasRequiredDist=1,(function(_t,e){Object.defineProperty(e,"__esModule",{value:!0});const n=requireFormats(),ei=requireLimit(),ti=requireCodegen(),ii=new ti.Name("fullFormats"),ri=new ti.Name("fastFormats"),ni=(ai,oi={keywords:!0})=>{if(Array.isArray(oi))return si(ai,oi,n.fullFormats,ii),ai;const[li,ci]=oi.mode==="fast"?[n.fastFormats,ri]:[n.fullFormats,ii],ui=oi.formats||n.formatNames;return si(ai,ui,li,ci),oi.keywords&&(0,ei.default)(ai),ai};ni.get=(ai,oi="full")=>{const ci=(oi==="fast"?n.fastFormats:n.fullFormats)[ai];if(!ci)throw new Error(`Unknown format "${ai}"`);return ci};function si(ai,oi,li,ci){var ui,di;(ui=(di=ai.opts.code).formats)!==null&&ui!==void 0||(di.formats=(0,ti._)`require("ajv-formats/dist/formats").${ci}`);for(const fi of oi)ai.addFormat(fi,li[fi])}_t.exports=e=ni,Object.defineProperty(e,"__esModule",{value:!0}),e.default=ni})(dist,dist.exports)),dist.exports}var distExports=requireDist();const addFormats=getDefaultExportFromCjs$1(distExports),$id$5="catalog",$schema$5="http://json-schema.org/draft-07/schema#",jsdoc="schema.jsdoc",title="Generated schema for configuration service",type$5="object",properties$3={generalOptions:{type:"object",properties:{apiKeys:{type:"object",properties:{$apikey:{type:"array",items:{}}},required:[]}},required:["apiKeys"]},layers:{type:"object",properties:{"$GEOPORTAIL:OGC:WMTS":{type:"object",properties:{name:{type:"string"},title:{type:"string"},description:{type:"string"},globalConstraint:{type:"object",properties:{maxScaleDenominator:{type:"number"},minScaleDenominator:{type:"number"},bbox:{type:"object",properties:{left:{type:"number"},right:{type:"number"},top:{type:"number"},bottom:{type:"number"}},required:["left","right","top","bottom"]}},required:["maxScaleDenominator","minScaleDenominator","bbox"]},serviceParams:{type:"object",properties:{id:{type:"string"},version:{type:"string"},serverUrl:{type:"object",properties:{$apikey:{type:"string"}},required:["$apikey"]}},required:["id","version","serverUrl"]},defaultProjection:{type:"string"},wmtsOptions:{type:"object",properties:{tileMatrixSetLink:{type:"string"},tileMatrixSetLimits:{type:"object",properties:{$level:{type:"object",properties:{minTileRow:{type:"string"},maxTileRow:{type:"string"},minTileCol:{type:"string"},maxTileCol:{type:"string"}},required:["minTileRow","maxTileRow","minTileCol","maxTileCol"]}},required:["$level"]}},required:["tileMatrixSetLink","tileMatrixSetLimits"]},styles:{type:"array",items:{type:"object",properties:{name:{type:"string"},title:{type:"string"},current:{type:"boolean"},url:{}},required:["name","title","current","url"]}},legends:{type:"array",items:{type:"object",properties:{format:{type:"string"},url:{type:"string"},minScaleDenominator:{type:"string"}},required:["format","url","minScaleDenominator"]}},formats:{type:"array",items:{type:"object",properties:{name:{type:"string"},current:{type:"boolean"}},required:["name","current"]}}},required:["name","title","description","globalConstraint","serviceParams","defaultProjection","wmtsOptions","styles","legends","formats"]},"$GEOPORTAIL:OGC:WMS":{type:"object",properties:{name:{type:"string"},title:{type:"string"},description:{type:"string"},globalConstraint:{type:"object",properties:{minScaleDenominator:{type:"number"},maxScaleDenominator:{type:"number"},bbox:{type:"object",properties:{left:{type:"number"},right:{type:"number"},top:{type:"number"},bottom:{type:"number"}},required:["left","right","top","bottom"]}},required:["minScaleDenominator","maxScaleDenominator","bbox"]},serviceParams:{type:"object",properties:{id:{type:"string"},version:{type:"string"},serverUrl:{type:"object",properties:{$apikey:{type:"string"}},required:["$apikey"]}},required:["id","version","serverUrl"]},defaultProjection:{type:"string"},queryable:{type:"boolean"},metadata:{type:"array",items:{}},styles:{type:"array",items:{type:"object",properties:{name:{type:"string"},title:{type:"string"}},required:["name","title"]}},legends:{type:"array",items:{type:"object",properties:{format:{type:"string"},url:{type:"string"}},required:["format","url"]}},formats:{type:"array",items:{type:"object",properties:{name:{type:"string"},current:{type:"boolean"}},required:["name","current"]}}},required:["name","title","description","globalConstraint","serviceParams","defaultProjection","queryable","metadata","styles","legends","formats"]},"$GEOPORTAIL:GPP:TMS":{type:"object",properties:{hidden:{type:"boolean"},queryable:{type:"boolean"},serviceParams:{type:"object",properties:{id:{type:"string"},version:{type:"string"},serverUrl:{type:"object",properties:{$apikey:{type:"string"}},required:["$apikey"]}},required:["id","version","serverUrl"]},name:{type:"string"},title:{type:"string"},description:{type:"string"},formats:{type:"array",items:{type:"object",properties:{current:{type:"boolean"},name:{type:"string"}},required:["current","name"]}},styles:{type:"array",items:{type:"object",properties:{name:{type:"string"},title:{type:"string"},current:{type:"boolean"},url:{type:"string"}},required:["name","title","current","url"]}},globalConstraint:{type:"object",properties:{crs:{type:"string"},bbox:{type:"object",properties:{left:{type:"number"},right:{type:"number"},top:{type:"number"},bottom:{type:"number"}},required:["left","right","top","bottom"]},minScaleDenominator:{},maxScaleDenominator:{}},required:["crs","bbox","minScaleDenominator","maxScaleDenominator"]},layerId:{type:"string"},defaultProjection:{type:"string"}},required:["hidden","queryable","serviceParams","name","title","description","formats","styles","globalConstraint","layerId","defaultProjection"]}},required:[]},tileMatrixSets:{type:"object",properties:{$tmsid:{type:"object",properties:{projection:{type:"string"},nativeResolutions:{type:"array",items:{type:"string"}},tileMatrices:{type:"object",properties:{$level:{type:"object",properties:{matrixId:{type:"string"},matrixHeight:{type:"number"},matrixWidth:{type:"number"},scaleDenominator:{type:"number"},tileHeight:{type:"number"},tileWidth:{type:"number"},topLeftCorner:{type:"object",properties:{x:{type:"number"},y:{type:"number"}},required:["x","y"]}},required:["matrixId","matrixHeight","matrixWidth","scaleDenominator","tileHeight","tileWidth","topLeftCorner"]}},required:["$level"]}},required:["projection","nativeResolutions","tileMatrices"]}},required:[]}},required$3=["generalOptions","layers","tileMatrixSets"],CatalogSchema={$id:$id$5,$schema:$schema$5,jsdoc,title,type:type$5,properties:properties$3,required:required$3},$id$4="territories",$schema$4="http://json-schema.org/draft-07/schema#",type$4="array",items={type:"object",required:["id","title","description","zoom","thumbnail","icon"],oneOf:[{required:["bbox"]},{required:["point"]}],properties:{id:{type:"string",description:"Code du territoire"},title:{type:"string",description:"Nom affich du territoire"},description:{type:"string"},zoom:{type:["integer","null"],minimum:0},bbox:{type:"array",minItems:4,maxItems:4,items:{type:"number"},description:"Bounding box au format [minX, minY, maxX, maxY]"},point:{type:"array",minItems:2,maxItems:2,items:{type:"number"},description:"Coordonnes"},thumbnail:{anyOf:[{type:"string",format:"uri"},{type:"string"}]},icon:{anyOf:[{type:"string",format:"uri"},{type:"string"}]}},additionalProperties:!1},TerrotoriesSchema={$id:$id$4,$schema:$schema$4,type:type$4,items},$id$3="layer-wmts",$schema$3="http://json-schema.org/draft-07/schema#",type$3="object",required$2=["name","globalConstraint","params"],properties$2={name:{type:"string"},globalConstraint:{type:"object",required:["maxScaleDenominator","minScaleDenominator","bbox"],properties:{maxScaleDenominator:{type:"number"},minScaleDenominator:{type:"number"},bbox:{type:"object",required:["left","right","top","bottom"],properties:{left:{type:"number"},right:{type:"number"},top:{type:"number"},bottom:{type:"number"}},additionalProperties:!1}},additionalProperties:!1},params:{type:"object",required:["url","styles","version","format","projection","minScale","maxScale","extent","legends","title","description","tileMatrixSetLimits","TMSLink","matrixIds","tileMatrices","nativeResolutions"],properties:{url:{type:"string",format:"uri"},styles:{type:"string"},version:{type:"string"},format:{type:"string"},projection:{type:"string"},minScale:{type:"number"},maxScale:{type:"number"},extent:{type:"object",required:["left","right","top","bottom"],properties:{left:{type:"number"},right:{type:"number"},top:{type:"number"},bottom:{type:"number"}},additionalProperties:!1},legends:{type:"array",items:{type:"object",required:["format","url","minScaleDenominator"],properties:{format:{type:"string"},url:{type:"string"},minScaleDenominator:{type:["string","number"]}},additionalProperties:!1}},title:{type:"string"},description:{type:"string"},tileMatrixSetLimits:{type:"object",patternProperties:{"^[0-9]+$":{type:"object",required:["minTileRow","maxTileRow","minTileCol","maxTileCol"],properties:{minTileRow:{type:"string"},maxTileRow:{type:"string"},minTileCol:{type:"string"},maxTileCol:{type:"string"}},additionalProperties:!1}},additionalProperties:!1},TMSLink:{type:"string"},matrixIds:{type:"array",items:{type:"string"}},tileMatrices:{type:"object",patternProperties:{"^[0-9]+$":{type:"object",required:["matrixId","matrixHeight","matrixWidth","scaleDenominator","tileHeight","tileWidth","topLeftCorner"],properties:{matrixId:{type:"string"},matrixHeight:{type:"integer"},matrixWidth:{type:"integer"},scaleDenominator:{type:"number"},tileHeight:{type:"integer"},tileWidth:{type:"integer"},topLeftCorner:{type:"object",required:["x","y"],properties:{x:{type:"number"},y:{type:"number"}},additionalProperties:!1}},additionalProperties:!1}},additionalProperties:!1},nativeResolutions:{type:"array",items:{type:"string"}}},additionalProperties:!1}},additionalProperties$2=!1,LayerWmtsSchema={$id:$id$3,$schema:$schema$3,type:type$3,required:required$2,properties:properties$2,additionalProperties:additionalProperties$2},$id$2="layer-wms",$schema$2="http://json-schema.org/draft-07/schema#",type$2="object",required$1=["name","title","description","globalConstraint","serviceParams","defaultProjection","queryable","metadata","styles","legends","formats","producer","thematic","base","key","position","opacity","visible","grayscale","params"],properties$1={name:{type:"string"},title:{type:"string"},description:{type:"string"},globalConstraint:{type:"object",required:["minScaleDenominator","maxScaleDenominator","bbox"],properties:{minScaleDenominator:{type:"number"},maxScaleDenominator:{type:"number"},bbox:{type:"object",required:["left","right","top","bottom"],properties:{left:{type:"number"},right:{type:"number"},top:{type:"number"},bottom:{type:"number"}},additionalProperties:!1}},additionalProperties:!1},serviceParams:{type:"object",required:["id","version","serverUrl"],properties:{id:{type:"string"},version:{type:"string"},serverUrl:{type:"object",required:["full"],properties:{full:{type:"string",format:"uri"}},additionalProperties:!1}},additionalProperties:!1},defaultProjection:{type:"string"},queryable:{type:"boolean"},metadata:{type:"array",items:{}},styles:{type:"array",items:{type:"object",required:["name","title"],properties:{name:{type:"string"},title:{type:"string"}},additionalProperties:!1}},legends:{type:"array",items:{type:"object",required:["format","url"],properties:{format:{type:"string"},url:{type:"string",format:"uri"}},additionalProperties:!1}},formats:{type:"array",items:{type:"object",required:["name","current"],properties:{name:{type:"string"},current:{type:"boolean"}},additionalProperties:!1}},producer:{type:"array",items:{type:"string"}},thematic:{type:"array",items:{type:"string"}},base:{type:"boolean"},key:{type:"string"},position:{type:"integer"},opacity:{type:"number"},visible:{type:"boolean"},grayscale:{type:"boolean"},params:{type:"object",required:["url","styles","version","format","projection","minScale","maxScale","extent","legends","title","description"],properties:{url:{type:"string",format:"uri"},styles:{type:"string"},version:{type:"string"},format:{type:"string"},projection:{type:"string"},minScale:{type:"number"},maxScale:{type:"number"},extent:{type:"object",required:["left","right","top","bottom"],properties:{left:{type:"number"},right:{type:"number"},top:{type:"number"},bottom:{type:"number"}},additionalProperties:!1},legends:{type:"array",items:{type:"object",required:["format","url"],properties:{format:{type:"string"},url:{type:"string",format:"uri"}},additionalProperties:!1}},title:{type:"string"},description:{type:"string"}},additionalProperties:!1}},additionalProperties$1=!1,LayerWmsSchema={$id:$id$2,$schema:$schema$2,type:type$2,required:required$1,properties:properties$1,additionalProperties:additionalProperties$1},$id$1="layer-wfs",$schema$1="http://json-schema.org/draft-07/schema#",type$1="object",LayerWfsSchema={$id:$id$1,$schema:$schema$1,type:type$1},$id="layer-tms",$schema="http://json-schema.org/draft-07/schema#",type="object",required=["name","title","description","params","formats","styles","globalConstraint"],properties={hidden:{type:"boolean"},queryable:{type:"boolean"},serviceParams:{type:"object",required:["id","version","serverUrl"],properties:{id:{type:"string"},version:{type:"string"},serverUrl:{type:"object",required:["full"],properties:{full:{type:"string",format:"uri"}},additionalProperties:!1}},additionalProperties:!1},name:{type:"string"},title:{type:"string"},description:{type:"string"},formats:{type:"array",items:{type:"object",required:["name","current"],properties:{name:{type:"string"},current:{type:"boolean"}},additionalProperties:!1}},styles:{type:"array",items:{type:"object",required:["name","title","url"],properties:{name:{type:"string"},title:{type:"string"},current:{type:"boolean"},url:{type:"string",format:"uri"}},additionalProperties:!1}},globalConstraint:{type:"object",required:["crs","bbox","minScaleDenominator","maxScaleDenominator"],properties:{crs:{type:"string"},bbox:{type:"object",required:["left","right","top","bottom"],properties:{left:{type:"number"},right:{type:"number"},top:{type:"number"},bottom:{type:"number"}},additionalProperties:!1},minScaleDenominator:{type:"number"},maxScaleDenominator:{type:"number"}},additionalProperties:!1},defaultProjection:{type:"string"},thematic:{type:"array",items:{type:"string"}},base:{type:"boolean"},producer:{type:"array",items:{type:"string"}},key:{type:"string"},position:{type:"integer"},opacity:{type:"number"},visible:{type:"boolean"},grayscale:{type:"boolean"},params:{type:"object",required:["url","styles","version","format","projection","minScale","maxScale","extent","title","description"],properties:{url:{type:"string",format:"uri"},styles:{type:"string"},version:{type:"string"},format:{type:"string"},projection:{type:"string"},minScale:{type:"number"},maxScale:{type:"number"},extent:{type:"object",required:["left","right","top","bottom"],properties:{left:{type:"number"},right:{type:"number"},top:{type:"number"},bottom:{type:"number"}},additionalProperties:!1},title:{type:"string"},description:{type:"string"}},additionalProperties:!1}},additionalProperties=!1,LayerTmsSchema={$id,$schema,type,required,properties,additionalProperties};class JsonValidatorUtils{constructor(){this.ajv=new Ajv({strict:!1,allErrors:!0}),addFormats(this.ajv,{mode:"fast",formats:["uri"],keywords:!0}),this.schemas={},this.loadSchemas()}loadSchemas(){this.ajv.addSchema(CatalogSchema,CatalogSchema.$id),this.schemas[CatalogSchema.$id]=CatalogSchema,this.ajv.addSchema(TerrotoriesSchema,TerrotoriesSchema.$id),this.schemas[TerrotoriesSchema.$id]=TerrotoriesSchema,this.ajv.addSchema(LayerWmtsSchema,LayerWmtsSchema.$id),this.schemas[LayerWmtsSchema.$id]=LayerWmtsSchema,this.ajv.addSchema(LayerWmsSchema,LayerWmsSchema.$id),this.schemas[LayerWmsSchema.$id]=LayerWmsSchema,this.ajv.addSchema(LayerWfsSchema,LayerWfsSchema.$id),this.schemas[LayerWfsSchema.$id]=LayerWfsSchema,this.ajv.addSchema(LayerTmsSchema,LayerTmsSchema.$id),this.schemas[LayerTmsSchema.$id]=LayerTmsSchema}validate(e,n){if(!this.schemas[e])throw new Error(`Aucun schma trouv pour le type "${e}"`);const ei=this.ajv.getSchema(e);return ei(n)?{valid:!0}:{valid:!1,errors:ei.errors}}}window.Gp&&(window.Gp.JsonValidatorUtils=JsonValidatorUtils);const mainMap="mainMap",printMap="printMap",_hoisted_1$2=["id"],__default__$8={name:"Map"},_sfc_main$y=Object.assign(__default__$8,{props:{mapId:String},setup(_t,{expose:e}){const n=useMapStore(),ei=_t,ti=ref$1(null),ii=new Map$1({target:ei.mapId,controls:[],interactions:defaults$3().extend([new MouseWheelZoom({constrainResolution:!0,condition:shiftKeyOnly})])}),ri=new Set,ni=5e3,si=location.origin+location.pathname;function ai(){const ui=setTimeout(()=>{console.warn("Fallback loadend dclench"),oi(),ri.delete(ui)},ni);ri.add(ui)}function oi(){history.pushState(null,"",si)}ii.on("loadstart",ai),ii.on("loadend",()=>{const ui=ri.values().next().value;ui&&(clearTimeout(ui),ri.delete(ui)),oi()}),provide(ei.mapId,ii),onMounted(()=>{CRS.loadByDefault(),ii.setTarget(ti.value);const ui=ti.value.getElementsByTagName("canvas");ui.length&&(ui[0].tabIndex=0),ei.mapId==mainMap&&n.setMap(ii)});const li=()=>{document.activeElement.tagName!=="INPUT"&&document.activeElement.tagName!=="SELECT"&&document.querySelector("button[id^=GPSearchEngine-advanced-btn-]").getAttribute("aria-expanded")!=="true"&&ti.value.focus()};return e({mapRef:ti,updateSize:()=>{ii.updateSize()}}),(ui,di)=>(openBlock(),createElementBlock("div",{id:_t.mapId,ref_key:"mapRef",ref:ti,tabindex:"0",onMouseover:li},[renderSlot(ui.$slots,"default")],40,_hoisted_1$2))}}),__default__$7={name:"View"},_sfc_main$x=Object.assign(__default__$7,{props:{zoom:Number,center:Array,mapId:String},setup(_t){const e=useMapStore(),n=_t,ei=inject(n.mapId),ti=new View({zoom:n.zoom,center:fromLonLat(n.center),minZoom:0,maxZoom:21,projection:"EPSG:3857"});return ti.on("change:center",ii=>{if(n.mapId==mainMap){e.x=ii.target.getCenter()[0],e.y=ii.target.getCenter()[1];var ri=toLonLat(ii.target.getCenter());e.lon=ri[0],e.lat=ri[1]}}),ti.on("change:resolution",ii=>{e.zoom=ti.getZoom()}),onMounted(()=>{ei&&ei.setView(ti)}),(ii,ri)=>null}}),UNITS_PROP="units",LEADING_DIGITS=[1,2,5],DEFAULT_DPI=25.4/.28;class ScaleLine extends Control{constructor(e){e=e||{};const n=document.createElement("div");n.style.pointerEvents="none",super({element:n,render:e.render,target:e.target}),this.on,this.once,this.un;const ei=e.className!==void 0?e.className:e.bar?"ol-scale-bar":"ol-scale-line";this.innerElement_=document.createElement("div"),this.innerElement_.className=ei+"-inner",this.element.className=ei+" "+CLASS_UNSELECTABLE,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=e.minWidth!==void 0?e.minWidth:64,this.maxWidth_=e.maxWidth,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",this.addChangeListener(UNITS_PROP,this.handleUnitsChanged_),this.setUnits(e.units||"metric"),this.scaleBar_=e.bar||!1,this.scaleBarSteps_=e.steps||4,this.scaleBarText_=e.text||!1,this.dpi_=e.dpi||void 0}getUnits(){return this.get(UNITS_PROP)}handleUnitsChanged_(){this.updateElement_()}setUnits(e){this.set(UNITS_PROP,e)}setDpi(e){this.dpi_=e}updateElement_(){const e=this.viewState_;if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const n=e.center,ei=e.projection,ti=this.getUnits(),ii=ti=="degrees"?"degrees":"m";let ri=getPointResolution(ei,e.resolution,n,ii);const ni=this.minWidth_*(this.dpi_||DEFAULT_DPI)/DEFAULT_DPI,si=this.maxWidth_!==void 0?this.maxWidth_*(this.dpi_||DEFAULT_DPI)/DEFAULT_DPI:void 0;let ai=ni*ri,oi="";if(ti=="degrees"){const vi=METERS_PER_UNIT.degrees;ai*=vi,ai<vi/60?(oi="",ri*=3600):ai<vi?(oi="",ri*=60):oi=""}else if(ti=="imperial")ai<.9144?(oi="in",ri/=.0254):ai<1609.344?(oi="ft",ri/=.3048):(oi="mi",ri/=1609.344);else if(ti=="nautical")ri/=1852,oi="NM";else if(ti=="metric")ai<1e-6?(oi="nm",ri*=1e9):ai<.001?(oi="m",ri*=1e6):ai<1?(oi="mm",ri*=1e3):ai<1e3?oi="m":(oi="km",ri/=1e3);else if(ti=="us")ai<.9144?(oi="in",ri*=39.37):ai<1609.344?(oi="ft",ri/=.30480061):(oi="mi",ri/=1609.3472);else throw new Error("Invalid units");let li=3*Math.floor(Math.log(ni*ri)/Math.log(10)),ci,ui,di,fi=0,hi,pi;for(;;){di=Math.floor(li/3);const vi=Math.pow(10,di);if(ci=LEADING_DIGITS[(li%3+3)%3]*vi,ui=Math.round(ci/ri),isNaN(ui)){this.element.style.display="none",this.renderedVisible_=!1;return}if(si!==void 0&&ui>=si){ci=fi,ui=hi,di=pi;break}else if(ui>=ni)break;fi=ci,hi=ui,pi=di,++li}const gi=this.scaleBar_?this.createScaleBar(ui,ci,oi):ci.toFixed(di<0?-di:0)+" "+oi;this.renderedHTML_!=gi&&(this.innerElement_.innerHTML=gi,this.renderedHTML_=gi),this.renderedWidth_!=ui&&(this.innerElement_.style.width=ui+"px",this.renderedWidth_=ui),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}createScaleBar(e,n,ei){const ti=this.getScaleForResolution(),ii=ti<1?Math.round(1/ti).toLocaleString()+" : 1":"1 : "+Math.round(ti).toLocaleString(),ri=this.scaleBarSteps_,ni=e/ri,si=[this.createMarker("absolute")];for(let oi=0;oi<ri;++oi){const li=oi%2===0?"ol-scale-singlebar-odd":"ol-scale-singlebar-even";si.push(`<div><div class="ol-scale-singlebar ${li}" style="width: ${ni}px;"></div>`+this.createMarker("relative")+(oi%2===0||ri===2?this.createStepText(oi,e,!1,n,ei):"")+"</div>")}return si.push(this.createStepText(ri,e,!0,n,ei)),(this.scaleBarText_?`<div class="ol-scale-text" style="width: ${e}px;">`+ii+"</div>":"")+si.join("")}createMarker(e){return`<div class="ol-scale-step-marker" style="position: ${e}; top: ${e==="absolute"?3:-10}px;"></div>`}createStepText(e,n,ei,ti,ii){const ni=(e===0?0:Math.round(ti/this.scaleBarSteps_*e*100)/100)+(e===0?"":" "+ii),si=e===0?-3:n/this.scaleBarSteps_*-1,ai=e===0?0:n/this.scaleBarSteps_*2;return`<div class="ol-scale-step-text" style="margin-left: ${si}px;text-align: ${e===0?"left":"center"};min-width: ${ai}px;left: ${ei?n+"px":"unset"};">`+ni+"</div>"}getScaleForResolution(){const e=getPointResolution(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,"m"),n=this.dpi_||DEFAULT_DPI,ei=1e3/25.4;return e*ei*n}render(e){const n=e.frameState;n?this.viewState_=n.viewState:this.viewState_=null,this.updateElement_()}}const _sfc_main$w={__name:"ScaleLine",props:{mapId:String,visibility:Boolean,analytic:Boolean,scaleLineOptions:Object},setup(_t){const e=_t,n=inject(e.mapId),ei=ref$1(new ScaleLine(e.scaleLineOptions));return onMounted(()=>{e.visibility&&n.addControl(ei.value)}),onBeforeUpdate(()=>{e.visibility||n.removeControl(ei.value)}),onUpdated(()=>{e.visibility&&n.addControl(ei.value)}),(ti,ii)=>null}},_sfc_main$v={__name:"PrintLayers",props:{mainMapId:{type:String,default:""},printMapId:{type:String,default:""}},setup(_t){const e=_t,n=inject(e.mainMapId),ei=inject(e.printMapId);function ti(li){return new TileLayer({source:li.getSource(),visible:li.getVisible(),opacity:li.getOpacity(),zIndex:li.getZIndex(),minResolution:li.getMinResolution(),maxResolution:li.getMaxResolution()})}function ii(li){var ci,ui;return new VectorTileLayer({source:li.getSource(),style:li.getStyle(),visible:li.getVisible(),opacity:li.getOpacity(),zIndex:li.getZIndex(),minResolution:li.getMinResolution(),maxResolution:li.getMaxResolution(),declutter:(ci=li.getDeclutter)==null?void 0:ci.call(li),renderMode:(ui=li.getRenderMode)==null?void 0:ui.call(li)})}function ri(li){const ui=li.getSource().getFeatures().map(fi=>fi.clone()),di=new VectorSource({features:ui});return new VectorLayer({source:di,style:li.getStyle(),visible:li.getVisible(),opacity:li.getOpacity(),zIndex:li.getZIndex(),minResolution:li.getMinResolution(),maxResolution:li.getMaxResolution()})}function ni(li){var ui;const ci=(ui=li.getSource)==null?void 0:ui.call(li);return ci&&typeof ci.getFeatures=="function"}function si(li){var ui;const ci=(ui=li.getSource)==null?void 0:ui.call(li);return ci&&typeof ci.getTileGrid=="function"}function ai(li){const ci=li.getSource&&li.getSource();return ci?typeof ci.getTileGrid=="function"&&li.service=="TMS":!1}function oi(li){if(ai(li))return ii(li);if(ni(li))return ri(li);if(si(li))return ti(li);throw new Error("Type de layer non support")}return onMounted(async()=>{n.getLayers().forEach(ci=>{let ui=oi(ci);ei.addLayer(ui)}),await nextTick(),ei.renderSync()}),(li,ci)=>null}};function computeScaleCoeff(_t,e,n,ei){const ti=_t/e,ii=n/ei;let ri;return ii>ti?ri=_t/n:ri=e/ei,ri}function getMapImgParams(_t,e,n,ei){return{img:_t.toDataURL("image/png"),format:"PNG",imgPosX:e,imgPosY:n+e,imgWidth:ei.width,imgHeight:ei.height}}function getFakeMapCanvas(_t,e,n){if(_t.getElementsByTagName("canvas").length<2){var ei=document.createElement("canvas");ei.classList=["fixedoverlay"],ei.width=e,ei.height=n,_t.getElementsByClassName("ol-overlaycontainer")[0].insertAdjacentElement("beforebegin",ei)}else var ei=_t.getElementsByTagName("canvas")[1];return ei.style.display="none",ei}function drawScale(_t,e,n,ei){const ti=e.getElementsByClassName("ol-scale-line")[0],ii=ti.children[0],ri=getComputedStyle(ti),ni=getComputedStyle(ii),si=parseInt(ri.left),ai=parseInt(ri.bottom),oi=ii.innerHTML,li=parseInt(ni.width),ci=parseInt(ni.lineHeight),ui=ei-ai-ci;_t.beginPath(),_t.fillStyle="rgba(255, 255, 255, 0.75)",_t.rect(si,ui,li,ci),_t.fillRect(si,ui,li,ci),_t.font=ni.font,_t.textAlign="center",_t.fillStyle="#000000",_t.fillText(oi,si+li/2,ui+ci/2),_t.beginPath(),_t.moveTo(si,ui),_t.lineTo(si,ui+ci),_t.lineTo(si,ui+ci),_t.lineTo(si+li,ui+ci),_t.lineTo(si+li,ui),_t.lineWidth=1,_t.lineCap="round",_t.strokeStyle="#666666",_t.stroke()}function drawTitle(_t,e,n,ei,ti){_t.font="1.5rem Marianne",_t.fillStyle="#3a3a3a",_t.textAlign="center",_t.textBaseline="middle",_t.fillText(ti,n/2,e/2,ei)}function _typeof(_t){"@babel/helpers - typeof";return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(_t)}var u8=Uint8Array,u16=Uint16Array,i32=Int32Array,fleb=new u8([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),fdeb=new u8([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),clim=new u8([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),freb=function(_t,e){for(var n=new u16(31),ei=0;ei<31;++ei)n[ei]=e+=1<<_t[ei-1];for(var ti=new i32(n[30]),ei=1;ei<30;++ei)for(var ii=n[ei];ii<n[ei+1];++ii)ti[ii]=ii-n[ei]<<5|ei;return{b:n,r:ti}},_a=freb(fleb,2),fl=_a.b,revfl=_a.r;fl[28]=258,revfl[258]=28;var _b=freb(fdeb,0),revfd=_b.r,rev=new u16(32768);for(var i$1=0;i$1<32768;++i$1){var x$1=(i$1&43690)>>1|(i$1&21845)<<1;x$1=(x$1&52428)>>2|(x$1&13107)<<2,x$1=(x$1&61680)>>4|(x$1&3855)<<4,rev[i$1]=((x$1&65280)>>8|(x$1&255)<<8)>>1}var hMap=(function(_t,e,n){for(var ei=_t.length,ti=0,ii=new u16(e);ti<ei;++ti)_t[ti]&&++ii[_t[ti]-1];var ri=new u16(e);for(ti=1;ti<e;++ti)ri[ti]=ri[ti-1]+ii[ti-1]<<1;var ni;if(n){ni=new u16(1<<e);var si=15-e;for(ti=0;ti<ei;++ti)if(_t[ti])for(var ai=ti<<4|_t[ti],oi=e-_t[ti],li=ri[_t[ti]-1]++<<oi,ci=li|(1<<oi)-1;li<=ci;++li)ni[rev[li]>>si]=ai}else for(ni=new u16(ei),ti=0;ti<ei;++ti)_t[ti]&&(ni[ti]=rev[ri[_t[ti]-1]++]>>15-_t[ti]);return ni}),flt=new u8(288);for(var i$1=0;i$1<144;++i$1)flt[i$1]=8;for(var i$1=144;i$1<256;++i$1)flt[i$1]=9;for(var i$1=256;i$1<280;++i$1)flt[i$1]=7;for(var i$1=280;i$1<288;++i$1)flt[i$1]=8;var fdt=new u8(32);for(var i$1=0;i$1<32;++i$1)fdt[i$1]=5;var flm=hMap(flt,9,0),fdm=hMap(fdt,5,0),shft=function(_t){return(_t+7)/8|0},slc=function(_t,e,n){return(n==null||n>_t.length)&&(n=_t.length),new u8(_t.subarray(e,n))},wbits=function(_t,e,n){n<<=e&7;var ei=e/8|0;_t[ei]|=n,_t[ei+1]|=n>>8},wbits16=function(_t,e,n){n<<=e&7;var ei=e/8|0;_t[ei]|=n,_t[ei+1]|=n>>8,_t[ei+2]|=n>>16},hTree=function(_t,e){for(var n=[],ei=0;ei<_t.length;++ei)_t[ei]&&n.push({s:ei,f:_t[ei]});var ti=n.length,ii=n.slice();if(!ti)return{t:et$1,l:0};if(ti==1){var ri=new u8(n[0].s+1);return ri[n[0].s]=1,{t:ri,l:1}}n.sort(function(_i,Ai){return _i.f-Ai.f}),n.push({s:-1,f:25001});var ni=n[0],si=n[1],ai=0,oi=1,li=2;for(n[0]={s:-1,f:ni.f+si.f,l:ni,r:si};oi!=ti-1;)ni=n[n[ai].f<n[li].f?ai++:li++],si=n[ai!=oi&&n[ai].f<n[li].f?ai++:li++],n[oi++]={s:-1,f:ni.f+si.f,l:ni,r:si};for(var ci=ii[0].s,ei=1;ei<ti;++ei)ii[ei].s>ci&&(ci=ii[ei].s);var ui=new u16(ci+1),di=ln(n[oi-1],ui,0);if(di>e){var ei=0,fi=0,hi=di-e,pi=1<<hi;for(ii.sort(function(Ai,Ei){return ui[Ei.s]-ui[Ai.s]||Ai.f-Ei.f});ei<ti;++ei){var gi=ii[ei].s;if(ui[gi]>e)fi+=pi-(1<<di-ui[gi]),ui[gi]=e;else break}for(fi>>=hi;fi>0;){var vi=ii[ei].s;ui[vi]<e?fi-=1<<e-ui[vi]++-1:++ei}for(;ei>=0&&fi;--ei){var yi=ii[ei].s;ui[yi]==e&&(--ui[yi],++fi)}di=e}return{t:new u8(ui),l:di}},ln=function(_t,e,n){return _t.s==-1?Math.max(ln(_t.l,e,n+1),ln(_t.r,e,n+1)):e[_t.s]=n},lc=function(_t){for(var e=_t.length;e&&!_t[--e];);for(var n=new u16(++e),ei=0,ti=_t[0],ii=1,ri=function(si){n[ei++]=si},ni=1;ni<=e;++ni)if(_t[ni]==ti&&ni!=e)++ii;else{if(!ti&&ii>2){for(;ii>138;ii-=138)ri(32754);ii>2&&(ri(ii>10?ii-11<<5|28690:ii-3<<5|12305),ii=0)}else if(ii>3){for(ri(ti),--ii;ii>6;ii-=6)ri(8304);ii>2&&(ri(ii-3<<5|8208),ii=0)}for(;ii--;)ri(ti);ii=1,ti=_t[ni]}return{c:n.subarray(0,ei),n:e}},clen=function(_t,e){for(var n=0,ei=0;ei<e.length;++ei)n+=_t[ei]*e[ei];return n},wfblk=function(_t,e,n){var ei=n.length,ti=shft(e+2);_t[ti]=ei&255,_t[ti+1]=ei>>8,_t[ti+2]=_t[ti]^255,_t[ti+3]=_t[ti+1]^255;for(var ii=0;ii<ei;++ii)_t[ti+ii+4]=n[ii];return(ti+4+ei)*8},wblk=function(_t,e,n,ei,ti,ii,ri,ni,si,ai,oi){wbits(e,oi++,n),++ti[256];for(var li=hTree(ti,15),ci=li.t,ui=li.l,di=hTree(ii,15),fi=di.t,hi=di.l,pi=lc(ci),gi=pi.c,vi=pi.n,yi=lc(fi),_i=yi.c,Ai=yi.n,Ei=new u16(19),Si=0;Si<gi.length;++Si)++Ei[gi[Si]&31];for(var Si=0;Si<_i.length;++Si)++Ei[_i[Si]&31];for(var wi=hTree(Ei,7),Oi=wi.t,Ii=wi.l,Li=19;Li>4&&!Oi[clim[Li-1]];--Li);var Di=ai+5<<3,Ni=clen(ti,flt)+clen(ii,fdt)+ri,$i=clen(ti,ci)+clen(ii,fi)+ri+14+3*Li+clen(Ei,Oi)+2*Ei[16]+3*Ei[17]+7*Ei[18];if(si>=0&&Di<=Ni&&Di<=$i)return wfblk(e,oi,_t.subarray(si,si+ai));var Ki,er,Vi,nr;if(wbits(e,oi,1+($i<Ni)),oi+=2,$i<Ni){Ki=hMap(ci,ui,0),er=ci,Vi=hMap(fi,hi,0),nr=fi;var zi=hMap(Oi,Ii,0);wbits(e,oi,vi-257),wbits(e,oi+5,Ai-1),wbits(e,oi+10,Li-4),oi+=14;for(var Si=0;Si<Li;++Si)wbits(e,oi+3*Si,Oi[clim[Si]]);oi+=3*Li;for(var Wi=[gi,_i],Ti=0;Ti<2;++Ti)for(var ki=Wi[Ti],Si=0;Si<ki.length;++Si){var xi=ki[Si]&31;wbits(e,oi,zi[xi]),oi+=Oi[xi],xi>15&&(wbits(e,oi,ki[Si]>>5&127),oi+=ki[Si]>>12)}}else Ki=flm,er=flt,Vi=fdm,nr=fdt;for(var Si=0;Si<ni;++Si){var Mi=ei[Si];if(Mi>255){var xi=Mi>>18&31;wbits16(e,oi,Ki[xi+257]),oi+=er[xi+257],xi>7&&(wbits(e,oi,Mi>>23&31),oi+=fleb[xi]);var Ui=Mi&31;wbits16(e,oi,Vi[Ui]),oi+=nr[Ui],Ui>3&&(wbits16(e,oi,Mi>>5&8191),oi+=fdeb[Ui])}else wbits16(e,oi,Ki[Mi]),oi+=er[Mi]}return wbits16(e,oi,Ki[256]),oi+er[256]},deo=new i32([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),et$1=new u8(0),dflt=function(_t,e,n,ei,ti,ii){var ri=ii.z||_t.length,ni=new u8(ei+ri+5*(1+Math.ceil(ri/7e3))+ti),si=ni.subarray(ei,ni.length-ti),ai=ii.l,oi=(ii.r||0)&7;if(e){oi&&(si[0]=ii.r>>3);for(var li=deo[e-1],ci=li>>13,ui=li&8191,di=(1<<n)-1,fi=ii.p||new u16(32768),hi=ii.h||new u16(di+1),pi=Math.ceil(n/3),gi=2*pi,vi=function(pr){return(_t[pr]^_t[pr+1]<<pi^_t[pr+2]<<gi)&di},yi=new i32(25e3),_i=new u16(288),Ai=new u16(32),Ei=0,Si=0,wi=ii.i||0,Oi=0,Ii=ii.w||0,Li=0;wi+2<ri;++wi){var Di=vi(wi),Ni=wi&32767,$i=hi[Di];if(fi[Ni]=$i,hi[Di]=Ni,Ii<=wi){var Ki=ri-wi;if((Ei>7e3||Oi>24576)&&(Ki>423||!ai)){oi=wblk(_t,si,0,yi,_i,Ai,Si,Oi,Li,wi-Li,oi),Oi=Ei=Si=0,Li=wi;for(var er=0;er<286;++er)_i[er]=0;for(var er=0;er<30;++er)Ai[er]=0}var Vi=2,nr=0,zi=ui,Wi=Ni-$i&32767;if(Ki>2&&Di==vi(wi-Wi))for(var Ti=Math.min(ci,Ki)-1,ki=Math.min(32767,wi),xi=Math.min(258,Ki);Wi<=ki&&--zi&&Ni!=$i;){if(_t[wi+Vi]==_t[wi+Vi-Wi]){for(var Mi=0;Mi<xi&&_t[wi+Mi]==_t[wi+Mi-Wi];++Mi);if(Mi>Vi){if(Vi=Mi,nr=Wi,Mi>Ti)break;for(var Ui=Math.min(Wi,Mi-2),Yi=0,er=0;er<Ui;++er){var sr=wi-Wi+er&32767,cr=fi[sr],ir=sr-cr&32767;ir>Yi&&(Yi=ir,$i=sr)}}}Ni=$i,$i=fi[Ni],Wi+=Ni-$i&32767}if(nr){yi[Oi++]=268435456|revfl[Vi]<<18|revfd[nr];var Zi=revfl[Vi]&31,rr=revfd[nr]&31;Si+=fleb[Zi]+fdeb[rr],++_i[257+Zi],++Ai[rr],Ii=wi+Vi,++Ei}else yi[Oi++]=_t[wi],++_i[_t[wi]]}}for(wi=Math.max(wi,Ii);wi<ri;++wi)yi[Oi++]=_t[wi],++_i[_t[wi]];oi=wblk(_t,si,ai,yi,_i,Ai,Si,Oi,Li,wi-Li,oi),ai||(ii.r=oi&7|si[oi/8|0]<<3,oi-=7,ii.h=hi,ii.p=fi,ii.i=wi,ii.w=Ii)}else{for(var wi=ii.w||0;wi<ri+ai;wi+=65535){var ar=wi+65535;ar>=ri&&(si[oi/8|0]=ai,ar=ri),oi=wfblk(si,oi+1,_t.subarray(wi,ar))}ii.i=ri}return slc(ni,0,ei+shft(oi)+ti)},adler=function(){var _t=1,e=0;return{p:function(n){for(var ei=_t,ti=e,ii=n.length|0,ri=0;ri!=ii;){for(var ni=Math.min(ri+2655,ii);ri<ni;++ri)ti+=ei+=n[ri];ei=(ei&65535)+15*(ei>>16),ti=(ti&65535)+15*(ti>>16)}_t=ei,e=ti},d:function(){return _t%=65521,e%=65521,(_t&255)<<24|(_t&65280)<<8|(e&255)<<8|e>>8}}},dopt=function(_t,e,n,ei,ti){if(!ti&&(ti={l:1},e.dictionary)){var ii=e.dictionary.subarray(-32768),ri=new u8(ii.length+_t.length);ri.set(ii),ri.set(_t,ii.length),_t=ri,ti.w=ii.length}return dflt(_t,e.level==null?6:e.level,e.mem==null?ti.l?Math.ceil(Math.max(8,Math.min(13,Math.log(_t.length)))*1.5):20:12+e.mem,n,ei,ti)},wbytes=function(_t,e,n){for(;n;++e)_t[e]=n,n>>>=8},zlh=function(_t,e){var n=e.level,ei=n==0?0:n<6?1:n==9?3:2;if(_t[0]=120,_t[1]=ei<<6|(e.dictionary&&32),_t[1]|=31-(_t[0]<<8|_t[1])%31,e.dictionary){var ti=adler();ti.p(e.dictionary),wbytes(_t,2,ti.d())}};function zlibSync(_t,e){e||(e={});var n=adler();n.p(_t);var ei=dopt(_t,e,e.dictionary?6:2,4);return zlh(ei,e),wbytes(ei,ei.length-4,n.d()),ei}var td=typeof TextDecoder<"u"&&new TextDecoder,tds=0;try{td.decode(et$1,{stream:!0}),tds=1}catch(_t){}function _arrayWithHoles(_t){if(Array.isArray(_t))return _t}function _iterableToArrayLimit(_t,e){var n=_t==null?null:typeof Symbol<"u"&&_t[Symbol.iterator]||_t["@@iterator"];if(n!=null){var ei,ti,ii,ri,ni=[],si=!0,ai=!1;try{if(ii=(n=n.call(_t)).next,e!==0)for(;!(si=(ei=ii.call(n)).done)&&(ni.push(ei.value),ni.length!==e);si=!0);}catch(oi){ai=!0,ti=oi}finally{try{if(!si&&n.return!=null&&(ri=n.return(),Object(ri)!==ri))return}finally{if(ai)throw ti}}return ni}}function _arrayLikeToArray(_t,e){(e==null||e>_t.length)&&(e=_t.length);for(var n=0,ei=Array(e);n<e;n++)ei[n]=_t[n];return ei}function _unsupportedIterableToArray(_t,e){if(_t){if(typeof _t=="string")return _arrayLikeToArray(_t,e);var n={}.toString.call(_t).slice(8,-1);return n==="Object"&&_t.constructor&&(n=_t.constructor.name),n==="Map"||n==="Set"?Array.from(_t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(_t,e):void 0}}function _nonIterableRest(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _slicedToArray(_t,e){return _arrayWithHoles(_t)||_iterableToArrayLimit(_t,e)||_unsupportedIterableToArray(_t,e)||_nonIterableRest()}function decode(_t,e="utf8"){return new TextDecoder(e).decode(_t)}const encoder=new TextEncoder;function encode(_t){return encoder.encode(_t)}const defaultByteLength=1024*8,hostBigEndian=(()=>{const _t=new Uint8Array(4),e=new Uint32Array(_t.buffer);return!((e[0]=1)&_t[0])})(),typedArrays={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class IOBuffer{constructor(e=defaultByteLength,n={}){qr(this,"buffer");qr(this,"byteLength");qr(this,"byteOffset");qr(this,"length");qr(this,"offset");qr(this,"lastWrittenByte");qr(this,"littleEndian");qr(this,"_data");qr(this,"_mark");qr(this,"_marks");let ei=!1;typeof e=="number"?e=new ArrayBuffer(e):(ei=!0,this.lastWrittenByte=e.byteLength);const ti=n.offset?n.offset>>>0:0,ii=e.byteLength-ti;let ri=ti;(ArrayBuffer.isView(e)||e instanceof IOBuffer)&&(e.byteLength!==e.buffer.byteLength&&(ri=e.byteOffset+ti),e=e.buffer),ei?this.lastWrittenByte=ii:this.lastWrittenByte=0,this.buffer=e,this.length=ii,this.byteLength=ii,this.byteOffset=ri,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,ri,ii),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const ei=(this.offset+e)*2,ti=new Uint8Array(ei);ti.set(new Uint8Array(this.buffer)),this.buffer=ti.buffer,this.length=ei,this.byteLength=ei,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,n){const ei=typedArrays[n].BYTES_PER_ELEMENT*e,ti=this.byteOffset+this.offset,ii=this.buffer.slice(ti,ti+ei);if(this.littleEndian===hostBigEndian&&n!=="uint8"&&n!=="int8"){const ni=new Uint8Array(this.buffer.slice(ti,ti+ei));ni.reverse();const si=new typedArrays[n](ni.buffer);return this.offset+=ei,si.reverse(),si}const ri=new typedArrays[n](ii);return this.offset+=ei,ri}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let n="";for(let ei=0;ei<e;ei++)n+=this.readChar();return n}readUtf8(e=1){return decode(this.readBytes(e))}decodeText(e=1,n="utf8"){return decode(this.readBytes(e),n)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let n=0;n<e.length;n++)this._data.setUint8(this.offset++,e[n]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let n=0;n<e.length;n++)this.writeUint8(e.charCodeAt(n));return this}writeUtf8(e){return this.writeBytes(encode(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function zero$1(_t){let e=_t.length;for(;--e>=0;)_t[e]=0}const MIN_MATCH$1=3,MAX_MATCH$1=258,LENGTH_CODES$1=29,LITERALS$1=256,L_CODES$1=LITERALS$1+1+LENGTH_CODES$1,D_CODES$1=30,DIST_CODE_LEN=512,static_ltree=new Array((L_CODES$1+2)*2);zero$1(static_ltree);const static_dtree=new Array(D_CODES$1*2);zero$1(static_dtree);const _dist_code=new Array(DIST_CODE_LEN);zero$1(_dist_code);const _length_code=new Array(MAX_MATCH$1-MIN_MATCH$1+1);zero$1(_length_code);const base_length=new Array(LENGTH_CODES$1);zero$1(base_length);const base_dist=new Array(D_CODES$1);zero$1(base_dist);const adler32=(_t,e,n,ei)=>{let ti=_t&65535|0,ii=_t>>>16&65535|0,ri=0;for(;n!==0;){ri=n>2e3?2e3:n,n-=ri;do ti=ti+e[ei++]|0,ii=ii+ti|0;while(--ri);ti%=65521,ii%=65521}return ti|ii<<16|0};var adler32_1=adler32;const makeTable=()=>{let _t,e=[];for(var n=0;n<256;n++){_t=n;for(var ei=0;ei<8;ei++)_t=_t&1?3988292384^_t>>>1:_t>>>1;e[n]=_t}return e},crcTable$1=new Uint32Array(makeTable()),crc32=(_t,e,n,ei)=>{const ti=crcTable$1,ii=ei+n;_t^=-1;for(let ri=ei;ri<ii;ri++)_t=_t>>>8^ti[(_t^e[ri])&255];return _t^-1};var crc32_1=crc32,messages={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},constants$2={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const _has=(_t,e)=>Object.prototype.hasOwnProperty.call(_t,e);var assign=function(_t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const n=e.shift();if(n){if(typeof n!="object")throw new TypeError(n+"must be non-object");for(const ei in n)_has(n,ei)&&(_t[ei]=n[ei])}}return _t},flattenChunks=_t=>{let e=0;for(let ei=0,ti=_t.length;ei<ti;ei++)e+=_t[ei].length;const n=new Uint8Array(e);for(let ei=0,ti=0,ii=_t.length;ei<ii;ei++){let ri=_t[ei];n.set(ri,ti),ti+=ri.length}return n},common={assign,flattenChunks};let STR_APPLY_UIA_OK=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(_t){STR_APPLY_UIA_OK=!1}const _utf8len=new Uint8Array(256);for(let _t=0;_t<256;_t++)_utf8len[_t]=_t>=252?6:_t>=248?5:_t>=240?4:_t>=224?3:_t>=192?2:1;_utf8len[254]=_utf8len[254]=1;var string2buf=_t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(_t);let e,n,ei,ti,ii,ri=_t.length,ni=0;for(ti=0;ti<ri;ti++)n=_t.charCodeAt(ti),(n&64512)===55296&&ti+1<ri&&(ei=_t.charCodeAt(ti+1),(ei&64512)===56320&&(n=65536+(n-55296<<10)+(ei-56320),ti++)),ni+=n<128?1:n<2048?2:n<65536?3:4;for(e=new Uint8Array(ni),ii=0,ti=0;ii<ni;ti++)n=_t.charCodeAt(ti),(n&64512)===55296&&ti+1<ri&&(ei=_t.charCodeAt(ti+1),(ei&64512)===56320&&(n=65536+(n-55296<<10)+(ei-56320),ti++)),n<128?e[ii++]=n:n<2048?(e[ii++]=192|n>>>6,e[ii++]=128|n&63):n<65536?(e[ii++]=224|n>>>12,e[ii++]=128|n>>>6&63,e[ii++]=128|n&63):(e[ii++]=240|n>>>18,e[ii++]=128|n>>>12&63,e[ii++]=128|n>>>6&63,e[ii++]=128|n&63);return e};const buf2binstring=(_t,e)=>{if(e<65534&&_t.subarray&&STR_APPLY_UIA_OK)return String.fromCharCode.apply(null,_t.length===e?_t:_t.subarray(0,e));let n="";for(let ei=0;ei<e;ei++)n+=String.fromCharCode(_t[ei]);return n};var buf2string=(_t,e)=>{const n=e||_t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(_t.subarray(0,e));let ei,ti;const ii=new Array(n*2);for(ti=0,ei=0;ei<n;){let ri=_t[ei++];if(ri<128){ii[ti++]=ri;continue}let ni=_utf8len[ri];if(ni>4){ii[ti++]=65533,ei+=ni-1;continue}for(ri&=ni===2?31:ni===3?15:7;ni>1&&ei<n;)ri=ri<<6|_t[ei++]&63,ni--;if(ni>1){ii[ti++]=65533;continue}ri<65536?ii[ti++]=ri:(ri-=65536,ii[ti++]=55296|ri>>10&1023,ii[ti++]=56320|ri&1023)}return buf2binstring(ii,ti)},utf8border=(_t,e)=>{e=e||_t.length,e>_t.length&&(e=_t.length);let n=e-1;for(;n>=0&&(_t[n]&192)===128;)n--;return n<0||n===0?e:n+_utf8len[_t[n]]>e?n:e},strings={string2buf,buf2string,utf8border};function ZStream(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var zstream=ZStream;const BAD$1=16209,TYPE$1=16191;var inffast=function _t(e,n){let ei,ti,ii,ri,ni,si,ai,oi,li,ci,ui,di,fi,hi,pi,gi,vi,yi,_i,Ai,Ei,Si,wi,Oi;const Ii=e.state;ei=e.next_in,wi=e.input,ti=ei+(e.avail_in-5),ii=e.next_out,Oi=e.output,ri=ii-(n-e.avail_out),ni=ii+(e.avail_out-257),si=Ii.dmax,ai=Ii.wsize,oi=Ii.whave,li=Ii.wnext,ci=Ii.window,ui=Ii.hold,di=Ii.bits,fi=Ii.lencode,hi=Ii.distcode,pi=(1<<Ii.lenbits)-1,gi=(1<<Ii.distbits)-1;e:do{di<15&&(ui+=wi[ei++]<<di,di+=8,ui+=wi[ei++]<<di,di+=8),vi=fi[ui&pi];t:for(;;){if(yi=vi>>>24,ui>>>=yi,di-=yi,yi=vi>>>16&255,yi===0)Oi[ii++]=vi&65535;else if(yi&16){_i=vi&65535,yi&=15,yi&&(di<yi&&(ui+=wi[ei++]<<di,di+=8),_i+=ui&(1<<yi)-1,ui>>>=yi,di-=yi),di<15&&(ui+=wi[ei++]<<di,di+=8,ui+=wi[ei++]<<di,di+=8),vi=hi[ui&gi];i:for(;;){if(yi=vi>>>24,ui>>>=yi,di-=yi,yi=vi>>>16&255,yi&16){if(Ai=vi&65535,yi&=15,di<yi&&(ui+=wi[ei++]<<di,di+=8,di<yi&&(ui+=wi[ei++]<<di,di+=8)),Ai+=ui&(1<<yi)-1,Ai>si){e.msg="invalid distance too far back",Ii.mode=BAD$1;break e}if(ui>>>=yi,di-=yi,yi=ii-ri,Ai>yi){if(yi=Ai-yi,yi>oi&&Ii.sane){e.msg="invalid distance too far back",Ii.mode=BAD$1;break e}if(Ei=0,Si=ci,li===0){if(Ei+=ai-yi,yi<_i){_i-=yi;do Oi[ii++]=ci[Ei++];while(--yi);Ei=ii-Ai,Si=Oi}}else if(li<yi){if(Ei+=ai+li-yi,yi-=li,yi<_i){_i-=yi;do Oi[ii++]=ci[Ei++];while(--yi);if(Ei=0,li<_i){yi=li,_i-=yi;do Oi[ii++]=ci[Ei++];while(--yi);Ei=ii-Ai,Si=Oi}}}else if(Ei+=li-yi,yi<_i){_i-=yi;do Oi[ii++]=ci[Ei++];while(--yi);Ei=ii-Ai,Si=Oi}for(;_i>2;)Oi[ii++]=Si[Ei++],Oi[ii++]=Si[Ei++],Oi[ii++]=Si[Ei++],_i-=3;_i&&(Oi[ii++]=Si[Ei++],_i>1&&(Oi[ii++]=Si[Ei++]))}else{Ei=ii-Ai;do Oi[ii++]=Oi[Ei++],Oi[ii++]=Oi[Ei++],Oi[ii++]=Oi[Ei++],_i-=3;while(_i>2);_i&&(Oi[ii++]=Oi[Ei++],_i>1&&(Oi[ii++]=Oi[Ei++]))}}else if((yi&64)===0){vi=hi[(vi&65535)+(ui&(1<<yi)-1)];continue i}else{e.msg="invalid distance code",Ii.mode=BAD$1;break e}break}}else if((yi&64)===0){vi=fi[(vi&65535)+(ui&(1<<yi)-1)];continue t}else if(yi&32){Ii.mode=TYPE$1;break e}else{e.msg="invalid literal/length code",Ii.mode=BAD$1;break e}break}}while(ei<ti&&ii<ni);_i=di>>3,ei-=_i,di-=_i<<3,ui&=(1<<di)-1,e.next_in=ei,e.next_out=ii,e.avail_in=ei<ti?5+(ti-ei):5-(ei-ti),e.avail_out=ii<ni?257+(ni-ii):257-(ii-ni),Ii.hold=ui,Ii.bits=di};const MAXBITS=15,ENOUGH_LENS$1=852,ENOUGH_DISTS$1=592,CODES$1=0,LENS$1=1,DISTS$1=2,lbase=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),lext=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),dbase=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),dext=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),inflate_table=(_t,e,n,ei,ti,ii,ri,ni)=>{const si=ni.bits;let ai=0,oi=0,li=0,ci=0,ui=0,di=0,fi=0,hi=0,pi=0,gi=0,vi,yi,_i,Ai,Ei,Si=null,wi;const Oi=new Uint16Array(MAXBITS+1),Ii=new Uint16Array(MAXBITS+1);let Li=null,Di,Ni,$i;for(ai=0;ai<=MAXBITS;ai++)Oi[ai]=0;for(oi=0;oi<ei;oi++)Oi[e[n+oi]]++;for(ui=si,ci=MAXBITS;ci>=1&&Oi[ci]===0;ci--);if(ui>ci&&(ui=ci),ci===0)return ti[ii++]=1<<24|64<<16|0,ti[ii++]=1<<24|64<<16|0,ni.bits=1,0;for(li=1;li<ci&&Oi[li]===0;li++);for(ui<li&&(ui=li),hi=1,ai=1;ai<=MAXBITS;ai++)if(hi<<=1,hi-=Oi[ai],hi<0)return-1;if(hi>0&&(_t===CODES$1||ci!==1))return-1;for(Ii[1]=0,ai=1;ai<MAXBITS;ai++)Ii[ai+1]=Ii[ai]+Oi[ai];for(oi=0;oi<ei;oi++)e[n+oi]!==0&&(ri[Ii[e[n+oi]]++]=oi);if(_t===CODES$1?(Si=Li=ri,wi=20):_t===LENS$1?(Si=lbase,Li=lext,wi=257):(Si=dbase,Li=dext,wi=0),gi=0,oi=0,ai=li,Ei=ii,di=ui,fi=0,_i=-1,pi=1<<ui,Ai=pi-1,_t===LENS$1&&pi>ENOUGH_LENS$1||_t===DISTS$1&&pi>ENOUGH_DISTS$1)return 1;for(;;){Di=ai-fi,ri[oi]+1<wi?(Ni=0,$i=ri[oi]):ri[oi]>=wi?(Ni=Li[ri[oi]-wi],$i=Si[ri[oi]-wi]):(Ni=96,$i=0),vi=1<<ai-fi,yi=1<<di,li=yi;do yi-=vi,ti[Ei+(gi>>fi)+yi]=Di<<24|Ni<<16|$i|0;while(yi!==0);for(vi=1<<ai-1;gi&vi;)vi>>=1;if(vi!==0?(gi&=vi-1,gi+=vi):gi=0,oi++,--Oi[ai]===0){if(ai===ci)break;ai=e[n+ri[oi]]}if(ai>ui&&(gi&Ai)!==_i){for(fi===0&&(fi=ui),Ei+=li,di=ai-fi,hi=1<<di;di+fi<ci&&(hi-=Oi[di+fi],!(hi<=0));)di++,hi<<=1;if(pi+=1<<di,_t===LENS$1&&pi>ENOUGH_LENS$1||_t===DISTS$1&&pi>ENOUGH_DISTS$1)return 1;_i=gi&Ai,ti[_i]=ui<<24|di<<16|Ei-ii|0}}return gi!==0&&(ti[Ei+gi]=ai-fi<<24|64<<16|0),ni.bits=ui,0};var inftrees=inflate_table;const CODES=0,LENS=1,DISTS=2,{Z_FINISH:Z_FINISH$1,Z_BLOCK,Z_TREES,Z_OK:Z_OK$1,Z_STREAM_END:Z_STREAM_END$1,Z_NEED_DICT:Z_NEED_DICT$1,Z_STREAM_ERROR:Z_STREAM_ERROR$1,Z_DATA_ERROR:Z_DATA_ERROR$1,Z_MEM_ERROR:Z_MEM_ERROR$1,Z_BUF_ERROR,Z_DEFLATED}=constants$2,HEAD=16180,FLAGS=16181,TIME=16182,OS=16183,EXLEN=16184,EXTRA=16185,NAME=16186,COMMENT=16187,HCRC=16188,DICTID=16189,DICT=16190,TYPE=16191,TYPEDO=16192,STORED=16193,COPY_=16194,COPY=16195,TABLE=16196,LENLENS=16197,CODELENS=16198,LEN_=16199,LEN=16200,LENEXT=16201,DIST=16202,DISTEXT=16203,MATCH=16204,LIT=16205,CHECK=16206,LENGTH=16207,DONE=16208,BAD=16209,MEM=16210,SYNC=16211,ENOUGH_LENS=852,ENOUGH_DISTS=592,MAX_WBITS=15,DEF_WBITS=MAX_WBITS,zswap32=_t=>(_t>>>24&255)+(_t>>>8&65280)+((_t&65280)<<8)+((_t&255)<<24);function InflateState(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const inflateStateCheck=_t=>{if(!_t)return 1;const e=_t.state;return!e||e.strm!==_t||e.mode<HEAD||e.mode>SYNC?1:0},inflateResetKeep=_t=>{if(inflateStateCheck(_t))return Z_STREAM_ERROR$1;const e=_t.state;return _t.total_in=_t.total_out=e.total=0,_t.msg="",e.wrap&&(_t.adler=e.wrap&1),e.mode=HEAD,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(ENOUGH_LENS),e.distcode=e.distdyn=new Int32Array(ENOUGH_DISTS),e.sane=1,e.back=-1,Z_OK$1},inflateReset=_t=>{if(inflateStateCheck(_t))return Z_STREAM_ERROR$1;const e=_t.state;return e.wsize=0,e.whave=0,e.wnext=0,inflateResetKeep(_t)},inflateReset2=(_t,e)=>{let n;if(inflateStateCheck(_t))return Z_STREAM_ERROR$1;const ei=_t.state;return e<0?(n=0,e=-e):(n=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?Z_STREAM_ERROR$1:(ei.window!==null&&ei.wbits!==e&&(ei.window=null),ei.wrap=n,ei.wbits=e,inflateReset(_t))},inflateInit2=(_t,e)=>{if(!_t)return Z_STREAM_ERROR$1;const n=new InflateState;_t.state=n,n.strm=_t,n.window=null,n.mode=HEAD;const ei=inflateReset2(_t,e);return ei!==Z_OK$1&&(_t.state=null),ei},inflateInit=_t=>inflateInit2(_t,DEF_WBITS);let virgin=!0,lenfix,distfix;const fixedtables=_t=>{if(virgin){lenfix=new Int32Array(512),distfix=new Int32Array(32);let e=0;for(;e<144;)_t.lens[e++]=8;for(;e<256;)_t.lens[e++]=9;for(;e<280;)_t.lens[e++]=7;for(;e<288;)_t.lens[e++]=8;for(inftrees(LENS,_t.lens,0,288,lenfix,0,_t.work,{bits:9}),e=0;e<32;)_t.lens[e++]=5;inftrees(DISTS,_t.lens,0,32,distfix,0,_t.work,{bits:5}),virgin=!1}_t.lencode=lenfix,_t.lenbits=9,_t.distcode=distfix,_t.distbits=5},updatewindow=(_t,e,n,ei)=>{let ti;const ii=_t.state;return ii.window===null&&(ii.wsize=1<<ii.wbits,ii.wnext=0,ii.whave=0,ii.window=new Uint8Array(ii.wsize)),ei>=ii.wsize?(ii.window.set(e.subarray(n-ii.wsize,n),0),ii.wnext=0,ii.whave=ii.wsize):(ti=ii.wsize-ii.wnext,ti>ei&&(ti=ei),ii.window.set(e.subarray(n-ei,n-ei+ti),ii.wnext),ei-=ti,ei?(ii.window.set(e.subarray(n-ei,n),0),ii.wnext=ei,ii.whave=ii.wsize):(ii.wnext+=ti,ii.wnext===ii.wsize&&(ii.wnext=0),ii.whave<ii.wsize&&(ii.whave+=ti))),0},inflate$2=(_t,e)=>{let n,ei,ti,ii,ri,ni,si,ai,oi,li,ci,ui,di,fi,hi=0,pi,gi,vi,yi,_i,Ai,Ei,Si;const wi=new Uint8Array(4);let Oi,Ii;const Li=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(inflateStateCheck(_t)||!_t.output||!_t.input&&_t.avail_in!==0)return Z_STREAM_ERROR$1;n=_t.state,n.mode===TYPE&&(n.mode=TYPEDO),ri=_t.next_out,ti=_t.output,si=_t.avail_out,ii=_t.next_in,ei=_t.input,ni=_t.avail_in,ai=n.hold,oi=n.bits,li=ni,ci=si,Si=Z_OK$1;e:for(;;)switch(n.mode){case HEAD:if(n.wrap===0){n.mode=TYPEDO;break}for(;oi<16;){if(ni===0)break e;ni--,ai+=ei[ii++]<<oi,oi+=8}if(n.wrap&2&&ai===35615){n.wbits===0&&(n.wbits=15),n.check=0,wi[0]=ai&255,wi[1]=ai>>>8&255,n.check=crc32_1(n.check,wi,2,0),ai=0,oi=0,n.mode=FLAGS;break}if(n.head&&(n.head.done=!1),!(n.wrap&1)||(((ai&255)<<8)+(ai>>8))%31){_t.msg="incorrect header check",n.mode=BAD;break}if((ai&15)!==Z_DEFLATED){_t.msg="unknown compression method",n.mode=BAD;break}if(ai>>>=4,oi-=4,Ei=(ai&15)+8,n.wbits===0&&(n.wbits=Ei),Ei>15||Ei>n.wbits){_t.msg="invalid window size",n.mode=BAD;break}n.dmax=1<<n.wbits,n.flags=0,_t.adler=n.check=1,n.mode=ai&512?DICTID:TYPE,ai=0,oi=0;break;case FLAGS:for(;oi<16;){if(ni===0)break e;ni--,ai+=ei[ii++]<<oi,oi+=8}if(n.flags=ai,(n.flags&255)!==Z_DEFLATED){_t.msg="unknown compression method",n.mode=BAD;break}if(n.flags&57344){_t.msg="unknown header flags set",n.mode=BAD;break}n.head&&(n.head.text=ai>>8&1),n.flags&512&&n.wrap&4&&(wi[0]=ai&255,wi[1]=ai>>>8&255,n.check=crc32_1(n.check,wi,2,0)),ai=0,oi=0,n.mode=TIME;case TIME:for(;oi<32;){if(ni===0)break e;ni--,ai+=ei[ii++]<<oi,oi+=8}n.head&&(n.head.time=ai),n.flags&512&&n.wrap&4&&(wi[0]=ai&255,wi[1]=ai>>>8&255,wi[2]=ai>>>16&255,wi[3]=ai>>>24&255,n.check=crc32_1(n.check,wi,4,0)),ai=0,oi=0,n.mode=OS;case OS:for(;oi<16;){if(ni===0)break e;ni--,ai+=ei[ii++]<<oi,oi+=8}n.head&&(n.head.xflags=ai&255,n.head.os=ai>>8),n.flags&512&&n.wrap&4&&(wi[0]=ai&255,wi[1]=ai>>>8&255,n.check=crc32_1(n.check,wi,2,0)),ai=0,oi=0,n.mode=EXLEN;case EXLEN:if(n.flags&1024){for(;oi<16;){if(ni===0)break e;ni--,ai+=ei[ii++]<<oi,oi+=8}n.length=ai,n.head&&(n.head.extra_len=ai),n.flags&512&&n.wrap&4&&(wi[0]=ai&255,wi[1]=ai>>>8&255,n.check=crc32_1(n.check,wi,2,0)),ai=0,oi=0}else n.head&&(n.head.extra=null);n.mode=EXTRA;case EXTRA:if(n.flags&1024&&(ui=n.length,ui>ni&&(ui=ni),ui&&(n.head&&(Ei=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(ei.subarray(ii,ii+ui),Ei)),n.flags&512&&n.wrap&4&&(n.check=crc32_1(n.check,ei,ui,ii)),ni-=ui,ii+=ui,n.length-=ui),n.length))break e;n.length=0,n.mode=NAME;case NAME:if(n.flags&2048){if(ni===0)break e;ui=0;do Ei=ei[ii+ui++],n.head&&Ei&&n.length<65536&&(n.head.name+=String.fromCharCode(Ei));while(Ei&&ui<ni);if(n.flags&512&&n.wrap&4&&(n.check=crc32_1(n.check,ei,ui,ii)),ni-=ui,ii+=ui,Ei)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=COMMENT;case COMMENT:if(n.flags&4096){if(ni===0)break e;ui=0;do Ei=ei[ii+ui++],n.head&&Ei&&n.length<65536&&(n.head.comment+=String.fromCharCode(Ei));while(Ei&&ui<ni);if(n.flags&512&&n.wrap&4&&(n.check=crc32_1(n.check,ei,ui,ii)),ni-=ui,ii+=ui,Ei)break e}else n.head&&(n.head.comment=null);n.mode=HCRC;case HCRC:if(n.flags&512){for(;oi<16;){if(ni===0)break e;ni--,ai+=ei[ii++]<<oi,oi+=8}if(n.wrap&4&&ai!==(n.check&65535)){_t.msg="header crc mismatch",n.mode=BAD;break}ai=0,oi=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),_t.adler=n.check=0,n.mode=TYPE;break;case DICTID:for(;oi<32;){if(ni===0)break e;ni--,ai+=ei[ii++]<<oi,oi+=8}_t.adler=n.check=zswap32(ai),ai=0,oi=0,n.mode=DICT;case DICT:if(n.havedict===0)return _t.next_out=ri,_t.avail_out=si,_t.next_in=ii,_t.avail_in=ni,n.hold=ai,n.bits=oi,Z_NEED_DICT$1;_t.adler=n.check=1,n.mode=TYPE;case TYPE:if(e===Z_BLOCK||e===Z_TREES)break e;case TYPEDO:if(n.last){ai>>>=oi&7,oi-=oi&7,n.mode=CHECK;break}for(;oi<3;){if(ni===0)break e;ni--,ai+=ei[ii++]<<oi,oi+=8}switch(n.last=ai&1,ai>>>=1,oi-=1,ai&3){case 0:n.mode=STORED;break;case 1:if(fixedtables(n),n.mode=LEN_,e===Z_TREES){ai>>>=2,oi-=2;break e}break;case 2:n.mode=TABLE;break;case 3:_t.msg="invalid block type",n.mode=BAD}ai>>>=2,oi-=2;break;case STORED:for(ai>>>=oi&7,oi-=oi&7;oi<32;){if(ni===0)break e;ni--,ai+=ei[ii++]<<oi,oi+=8}if((ai&65535)!==(ai>>>16^65535)){_t.msg="invalid stored block lengths",n.mode=BAD;break}if(n.length=ai&65535,ai=0,oi=0,n.mode=COPY_,e===Z_TREES)break e;case COPY_:n.mode=COPY;case COPY:if(ui=n.length,ui){if(ui>ni&&(ui=ni),ui>si&&(ui=si),ui===0)break e;ti.set(ei.subarray(ii,ii+ui),ri),ni-=ui,ii+=ui,si-=ui,ri+=ui,n.length-=ui;break}n.mode=TYPE;break;case TABLE:for(;oi<14;){if(ni===0)break e;ni--,ai+=ei[ii++]<<oi,oi+=8}if(n.nlen=(ai&31)+257,ai>>>=5,oi-=5,n.ndist=(ai&31)+1,ai>>>=5,oi-=5,n.ncode=(ai&15)+4,ai>>>=4,oi-=4,n.nlen>286||n.ndist>30){_t.msg="too many length or distance symbols",n.mode=BAD;break}n.have=0,n.mode=LENLENS;case LENLENS:for(;n.have<n.ncode;){for(;oi<3;){if(ni===0)break e;ni--,ai+=ei[ii++]<<oi,oi+=8}n.lens[Li[n.have++]]=ai&7,ai>>>=3,oi-=3}for(;n.have<19;)n.lens[Li[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,Oi={bits:n.lenbits},Si=inftrees(CODES,n.lens,0,19,n.lencode,0,n.work,Oi),n.lenbits=Oi.bits,Si){_t.msg="invalid code lengths set",n.mode=BAD;break}n.have=0,n.mode=CODELENS;case CODELENS:for(;n.have<n.nlen+n.ndist;){for(;hi=n.lencode[ai&(1<<n.lenbits)-1],pi=hi>>>24,gi=hi>>>16&255,vi=hi&65535,!(pi<=oi);){if(ni===0)break e;ni--,ai+=ei[ii++]<<oi,oi+=8}if(vi<16)ai>>>=pi,oi-=pi,n.lens[n.have++]=vi;else{if(vi===16){for(Ii=pi+2;oi<Ii;){if(ni===0)break e;ni--,ai+=ei[ii++]<<oi,oi+=8}if(ai>>>=pi,oi-=pi,n.have===0){_t.msg="invalid bit length repeat",n.mode=BAD;break}Ei=n.lens[n.have-1],ui=3+(ai&3),ai>>>=2,oi-=2}else if(vi===17){for(Ii=pi+3;oi<Ii;){if(ni===0)break e;ni--,ai+=ei[ii++]<<oi,oi+=8}ai>>>=pi,oi-=pi,Ei=0,ui=3+(ai&7),ai>>>=3,oi-=3}else{for(Ii=pi+7;oi<Ii;){if(ni===0)break e;ni--,ai+=ei[ii++]<<oi,oi+=8}ai>>>=pi,oi-=pi,Ei=0,ui=11+(ai&127),ai>>>=7,oi-=7}if(n.have+ui>n.nlen+n.ndist){_t.msg="invalid bit length repeat",n.mode=BAD;break}for(;ui--;)n.lens[n.have++]=Ei}}if(n.mode===BAD)break;if(n.lens[256]===0){_t.msg="invalid code -- missing end-of-block",n.mode=BAD;break}if(n.lenbits=9,Oi={bits:n.lenbits},Si=inftrees(LENS,n.lens,0,n.nlen,n.lencode,0,n.work,Oi),n.lenbits=Oi.bits,Si){_t.msg="invalid literal/lengths set",n.mode=BAD;break}if(n.distbits=6,n.distcode=n.distdyn,Oi={bits:n.distbits},Si=inftrees(DISTS,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,Oi),n.distbits=Oi.bits,Si){_t.msg="invalid distances set",n.mode=BAD;break}if(n.mode=LEN_,e===Z_TREES)break e;case LEN_:n.mode=LEN;case LEN:if(ni>=6&&si>=258){_t.next_out=ri,_t.avail_out=si,_t.next_in=ii,_t.avail_in=ni,n.hold=ai,n.bits=oi,inffast(_t,ci),ri=_t.next_out,ti=_t.output,si=_t.avail_out,ii=_t.next_in,ei=_t.input,ni=_t.avail_in,ai=n.hold,oi=n.bits,n.mode===TYPE&&(n.back=-1);break}for(n.back=0;hi=n.lencode[ai&(1<<n.lenbits)-1],pi=hi>>>24,gi=hi>>>16&255,vi=hi&65535,!(pi<=oi);){if(ni===0)break e;ni--,ai+=ei[ii++]<<oi,oi+=8}if(gi&&(gi&240)===0){for(yi=pi,_i=gi,Ai=vi;hi=n.lencode[Ai+((ai&(1<<yi+_i)-1)>>yi)],pi=hi>>>24,gi=hi>>>16&255,vi=hi&65535,!(yi+pi<=oi);){if(ni===0)break e;ni--,ai+=ei[ii++]<<oi,oi+=8}ai>>>=yi,oi-=yi,n.back+=yi}if(ai>>>=pi,oi-=pi,n.back+=pi,n.length=vi,gi===0){n.mode=LIT;break}if(gi&32){n.back=-1,n.mode=TYPE;break}if(gi&64){_t.msg="invalid literal/length code",n.mode=BAD;break}n.extra=gi&15,n.mode=LENEXT;case LENEXT:if(n.extra){for(Ii=n.extra;oi<Ii;){if(ni===0)break e;ni--,ai+=ei[ii++]<<oi,oi+=8}n.length+=ai&(1<<n.extra)-1,ai>>>=n.extra,oi-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=DIST;case DIST:for(;hi=n.distcode[ai&(1<<n.distbits)-1],pi=hi>>>24,gi=hi>>>16&255,vi=hi&65535,!(pi<=oi);){if(ni===0)break e;ni--,ai+=ei[ii++]<<oi,oi+=8}if((gi&240)===0){for(yi=pi,_i=gi,Ai=vi;hi=n.distcode[Ai+((ai&(1<<yi+_i)-1)>>yi)],pi=hi>>>24,gi=hi>>>16&255,vi=hi&65535,!(yi+pi<=oi);){if(ni===0)break e;ni--,ai+=ei[ii++]<<oi,oi+=8}ai>>>=yi,oi-=yi,n.back+=yi}if(ai>>>=pi,oi-=pi,n.back+=pi,gi&64){_t.msg="invalid distance code",n.mode=BAD;break}n.offset=vi,n.extra=gi&15,n.mode=DISTEXT;case DISTEXT:if(n.extra){for(Ii=n.extra;oi<Ii;){if(ni===0)break e;ni--,ai+=ei[ii++]<<oi,oi+=8}n.offset+=ai&(1<<n.extra)-1,ai>>>=n.extra,oi-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){_t.msg="invalid distance too far back",n.mode=BAD;break}n.mode=MATCH;case MATCH:if(si===0)break e;if(ui=ci-si,n.offset>ui){if(ui=n.offset-ui,ui>n.whave&&n.sane){_t.msg="invalid distance too far back",n.mode=BAD;break}ui>n.wnext?(ui-=n.wnext,di=n.wsize-ui):di=n.wnext-ui,ui>n.length&&(ui=n.length),fi=n.window}else fi=ti,di=ri-n.offset,ui=n.length;ui>si&&(ui=si),si-=ui,n.length-=ui;do ti[ri++]=fi[di++];while(--ui);n.length===0&&(n.mode=LEN);break;case LIT:if(si===0)break e;ti[ri++]=n.length,si--,n.mode=LEN;break;case CHECK:if(n.wrap){for(;oi<32;){if(ni===0)break e;ni--,ai|=ei[ii++]<<oi,oi+=8}if(ci-=si,_t.total_out+=ci,n.total+=ci,n.wrap&4&&ci&&(_t.adler=n.check=n.flags?crc32_1(n.check,ti,ci,ri-ci):adler32_1(n.check,ti,ci,ri-ci)),ci=si,n.wrap&4&&(n.flags?ai:zswap32(ai))!==n.check){_t.msg="incorrect data check",n.mode=BAD;break}ai=0,oi=0}n.mode=LENGTH;case LENGTH:if(n.wrap&&n.flags){for(;oi<32;){if(ni===0)break e;ni--,ai+=ei[ii++]<<oi,oi+=8}if(n.wrap&4&&ai!==(n.total&4294967295)){_t.msg="incorrect length check",n.mode=BAD;break}ai=0,oi=0}n.mode=DONE;case DONE:Si=Z_STREAM_END$1;break e;case BAD:Si=Z_DATA_ERROR$1;break e;case MEM:return Z_MEM_ERROR$1;case SYNC:default:return Z_STREAM_ERROR$1}return _t.next_out=ri,_t.avail_out=si,_t.next_in=ii,_t.avail_in=ni,n.hold=ai,n.bits=oi,(n.wsize||ci!==_t.avail_out&&n.mode<BAD&&(n.mode<CHECK||e!==Z_FINISH$1))&&updatewindow(_t,_t.output,_t.next_out,ci-_t.avail_out),li-=_t.avail_in,ci-=_t.avail_out,_t.total_in+=li,_t.total_out+=ci,n.total+=ci,n.wrap&4&&ci&&(_t.adler=n.check=n.flags?crc32_1(n.check,ti,ci,_t.next_out-ci):adler32_1(n.check,ti,ci,_t.next_out-ci)),_t.data_type=n.bits+(n.last?64:0)+(n.mode===TYPE?128:0)+(n.mode===LEN_||n.mode===COPY_?256:0),(li===0&&ci===0||e===Z_FINISH$1)&&Si===Z_OK$1&&(Si=Z_BUF_ERROR),Si},inflateEnd=_t=>{if(inflateStateCheck(_t))return Z_STREAM_ERROR$1;let e=_t.state;return e.window&&(e.window=null),_t.state=null,Z_OK$1},inflateGetHeader=(_t,e)=>{if(inflateStateCheck(_t))return Z_STREAM_ERROR$1;const n=_t.state;return(n.wrap&2)===0?Z_STREAM_ERROR$1:(n.head=e,e.done=!1,Z_OK$1)},inflateSetDictionary=(_t,e)=>{const n=e.length;let ei,ti,ii;return inflateStateCheck(_t)||(ei=_t.state,ei.wrap!==0&&ei.mode!==DICT)?Z_STREAM_ERROR$1:ei.mode===DICT&&(ti=1,ti=adler32_1(ti,e,n,0),ti!==ei.check)?Z_DATA_ERROR$1:(ii=updatewindow(_t,e,n,n),ii?(ei.mode=MEM,Z_MEM_ERROR$1):(ei.havedict=1,Z_OK$1))};var inflateReset_1=inflateReset,inflateReset2_1=inflateReset2,inflateResetKeep_1=inflateResetKeep,inflateInit_1=inflateInit,inflateInit2_1=inflateInit2,inflate_2$1=inflate$2,inflateEnd_1=inflateEnd,inflateGetHeader_1=inflateGetHeader,inflateSetDictionary_1=inflateSetDictionary,inflateInfo="pako inflate (from Nodeca project)",inflate_1$2={inflateReset:inflateReset_1,inflateReset2:inflateReset2_1,inflateResetKeep:inflateResetKeep_1,inflateInit:inflateInit_1,inflateInit2:inflateInit2_1,inflate:inflate_2$1,inflateEnd:inflateEnd_1,inflateGetHeader:inflateGetHeader_1,inflateSetDictionary:inflateSetDictionary_1,inflateInfo};function GZheader(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var gzheader=GZheader;const toString=Object.prototype.toString,{Z_NO_FLUSH,Z_FINISH,Z_OK,Z_STREAM_END,Z_NEED_DICT,Z_STREAM_ERROR,Z_DATA_ERROR,Z_MEM_ERROR}=constants$2;function Inflate$1(_t){this.options=common.assign({chunkSize:1024*64,windowBits:15,to:""},_t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(_t&&_t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)===0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zstream,this.strm.avail_out=0;let n=inflate_1$2.inflateInit2(this.strm,e.windowBits);if(n!==Z_OK)throw new Error(messages[n]);if(this.header=new gzheader,inflate_1$2.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=strings.string2buf(e.dictionary):toString.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(n=inflate_1$2.inflateSetDictionary(this.strm,e.dictionary),n!==Z_OK)))throw new Error(messages[n])}Inflate$1.prototype.push=function(_t,e){const n=this.strm,ei=this.options.chunkSize,ti=this.options.dictionary;let ii,ri,ni;if(this.ended)return!1;for(e===~~e?ri=e:ri=e===!0?Z_FINISH:Z_NO_FLUSH,toString.call(_t)==="[object ArrayBuffer]"?n.input=new Uint8Array(_t):n.input=_t,n.next_in=0,n.avail_in=n.input.length;;){for(n.avail_out===0&&(n.output=new Uint8Array(ei),n.next_out=0,n.avail_out=ei),ii=inflate_1$2.inflate(n,ri),ii===Z_NEED_DICT&&ti&&(ii=inflate_1$2.inflateSetDictionary(n,ti),ii===Z_OK?ii=inflate_1$2.inflate(n,ri):ii===Z_DATA_ERROR&&(ii=Z_NEED_DICT));n.avail_in>0&&ii===Z_STREAM_END&&n.state.wrap>0&&_t[n.next_in]!==0;)inflate_1$2.inflateReset(n),ii=inflate_1$2.inflate(n,ri);switch(ii){case Z_STREAM_ERROR:case Z_DATA_ERROR:case Z_NEED_DICT:case Z_MEM_ERROR:return this.onEnd(ii),this.ended=!0,!1}if(ni=n.avail_out,n.next_out&&(n.avail_out===0||ii===Z_STREAM_END))if(this.options.to==="string"){let si=strings.utf8border(n.output,n.next_out),ai=n.next_out-si,oi=strings.buf2string(n.output,si);n.next_out=ai,n.avail_out=ei-ai,ai&&n.output.set(n.output.subarray(si,si+ai),0),this.onData(oi)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(!(ii===Z_OK&&ni===0)){if(ii===Z_STREAM_END)return ii=inflate_1$2.inflateEnd(this.strm),this.onEnd(ii),this.ended=!0,!0;if(n.avail_in===0)break}}return!0};Inflate$1.prototype.onData=function(_t){this.chunks.push(_t)};Inflate$1.prototype.onEnd=function(_t){_t===Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=common.flattenChunks(this.chunks)),this.chunks=[],this.err=_t,this.msg=this.strm.msg};function inflate$1(_t,e){const n=new Inflate$1(e);if(n.push(_t),n.err)throw n.msg||messages[n.err];return n.result}var Inflate_1$1=Inflate$1,inflate_2=inflate$1,inflate_1$1={Inflate:Inflate_1$1,inflate:inflate_2};const{Inflate,inflate}=inflate_1$1;var Inflate_1=Inflate,inflate_1=inflate;const crcTable=[];for(let _t=0;_t<256;_t++){let e=_t;for(let n=0;n<8;n++)e&1?e=3988292384^e>>>1:e=e>>>1;crcTable[_t]=e}const initialCrc=4294967295;function updateCrc(_t,e,n){let ei=_t;for(let ti=0;ti<n;ti++)ei=crcTable[(ei^e[ti])&255]^ei>>>8;return ei}function crc(_t,e){return(updateCrc(initialCrc,_t,e)^initialCrc)>>>0}function checkCrc(_t,e,n){const ei=_t.readUint32(),ti=crc(new Uint8Array(_t.buffer,_t.byteOffset+_t.offset-e-4,e),e);if(ti!==ei)throw new Error(`CRC mismatch for chunk ${n}. Expected ${ei}, found ${ti}`)}function unfilterNone(_t,e,n){for(let ei=0;ei<n;ei++)e[ei]=_t[ei]}function unfilterSub(_t,e,n,ei){let ti=0;for(;ti<ei;ti++)e[ti]=_t[ti];for(;ti<n;ti++)e[ti]=_t[ti]+e[ti-ei]&255}function unfilterUp(_t,e,n,ei){let ti=0;if(n.length===0)for(;ti<ei;ti++)e[ti]=_t[ti];else for(;ti<ei;ti++)e[ti]=_t[ti]+n[ti]&255}function unfilterAverage(_t,e,n,ei,ti){let ii=0;if(n.length===0){for(;ii<ti;ii++)e[ii]=_t[ii];for(;ii<ei;ii++)e[ii]=_t[ii]+(e[ii-ti]>>1)&255}else{for(;ii<ti;ii++)e[ii]=_t[ii]+(n[ii]>>1)&255;for(;ii<ei;ii++)e[ii]=_t[ii]+(e[ii-ti]+n[ii]>>1)&255}}function unfilterPaeth(_t,e,n,ei,ti){let ii=0;if(n.length===0){for(;ii<ti;ii++)e[ii]=_t[ii];for(;ii<ei;ii++)e[ii]=_t[ii]+e[ii-ti]&255}else{for(;ii<ti;ii++)e[ii]=_t[ii]+n[ii]&255;for(;ii<ei;ii++)e[ii]=_t[ii]+paethPredictor(e[ii-ti],n[ii],n[ii-ti])&255}}function paethPredictor(_t,e,n){const ei=_t+e-n,ti=Math.abs(ei-_t),ii=Math.abs(ei-e),ri=Math.abs(ei-n);return ti<=ii&&ti<=ri?_t:ii<=ri?e:n}function applyUnfilter(_t,e,n,ei,ti,ii){switch(_t){case 0:unfilterNone(e,n,ti);break;case 1:unfilterSub(e,n,ti,ii);break;case 2:unfilterUp(e,n,ei,ti);break;case 3:unfilterAverage(e,n,ei,ti,ii);break;case 4:unfilterPaeth(e,n,ei,ti,ii);break;default:throw new Error(`Unsupported filter: ${_t}`)}}const uint16$1=new Uint16Array([255]),uint8$1=new Uint8Array(uint16$1.buffer),osIsLittleEndian$1=uint8$1[0]===255;function decodeInterlaceAdam7(_t){const{data:e,width:n,height:ei,channels:ti,depth:ii}=_t,ri=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],ni=Math.ceil(ii/8)*ti,si=new Uint8Array(ei*n*ni);let ai=0;for(let oi=0;oi<7;oi++){const li=ri[oi],ci=Math.ceil((n-li.x)/li.xStep),ui=Math.ceil((ei-li.y)/li.yStep);if(ci<=0||ui<=0)continue;const di=ci*ni,fi=new Uint8Array(di);for(let hi=0;hi<ui;hi++){const pi=e[ai++],gi=e.subarray(ai,ai+di);ai+=di;const vi=new Uint8Array(di);applyUnfilter(pi,gi,vi,fi,di,ni),fi.set(vi);for(let yi=0;yi<ci;yi++){const _i=li.x+yi*li.xStep,Ai=li.y+hi*li.yStep;if(!(_i>=n||Ai>=ei))for(let Ei=0;Ei<ni;Ei++)si[(Ai*n+_i)*ni+Ei]=vi[yi*ni+Ei]}}}if(ii===16){const oi=new Uint16Array(si.buffer);if(osIsLittleEndian$1)for(let li=0;li<oi.length;li++)oi[li]=swap16$1(oi[li]);return oi}else return si}function swap16$1(_t){return(_t&255)<<8|_t>>8&255}const uint16=new Uint16Array([255]),uint8=new Uint8Array(uint16.buffer),osIsLittleEndian=uint8[0]===255,empty=new Uint8Array(0);function decodeInterlaceNull(_t){const{data:e,width:n,height:ei,channels:ti,depth:ii}=_t,ri=Math.ceil(ii/8)*ti,ni=Math.ceil(ii/8*ti*n),si=new Uint8Array(ei*ni);let ai=empty,oi=0,li,ci;for(let ui=0;ui<ei;ui++){switch(li=e.subarray(oi+1,oi+1+ni),ci=si.subarray(ui*ni,(ui+1)*ni),e[oi]){case 0:unfilterNone(li,ci,ni);break;case 1:unfilterSub(li,ci,ni,ri);break;case 2:unfilterUp(li,ci,ai,ni);break;case 3:unfilterAverage(li,ci,ai,ni,ri);break;case 4:unfilterPaeth(li,ci,ai,ni,ri);break;default:throw new Error(`Unsupported filter: ${e[oi]}`)}ai=ci,oi+=ni+1}if(ii===16){const ui=new Uint16Array(si.buffer);if(osIsLittleEndian)for(let di=0;di<ui.length;di++)ui[di]=swap16(ui[di]);return ui}else return si}function swap16(_t){return(_t&255)<<8|_t>>8&255}const pngSignature=Uint8Array.of(137,80,78,71,13,10,26,10);function checkSignature(_t){if(!hasPngSignature(_t.readBytes(pngSignature.length)))throw new Error("wrong PNG signature")}function hasPngSignature(_t){if(_t.length<pngSignature.length)return!1;for(let e=0;e<pngSignature.length;e++)if(_t[e]!==pngSignature[e])return!1;return!0}const textChunkName="tEXt",NULL=0,latin1Decoder=new TextDecoder("latin1");function validateKeyword(_t){if(validateLatin1(_t),_t.length===0||_t.length>79)throw new Error("keyword length must be between 1 and 79")}const latin1Regex=/^[\u0000-\u00FF]*$/;function validateLatin1(_t){if(!latin1Regex.test(_t))throw new Error("invalid latin1 text")}function decodetEXt(_t,e,n){const ei=readKeyword(e);_t[ei]=readLatin1(e,n-ei.length-1)}function readKeyword(_t){for(_t.mark();_t.readByte()!==NULL;);const e=_t.offset;_t.reset();const n=latin1Decoder.decode(_t.readBytes(e-_t.offset-1));return _t.skip(1),validateKeyword(n),n}function readLatin1(_t,e){return latin1Decoder.decode(_t.readBytes(e))}const ColorType={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},CompressionMethod={UNKNOWN:-1,DEFLATE:0},FilterMethod={UNKNOWN:-1,ADAPTIVE:0},InterlaceMethod={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},DisposeOpType={NONE:0,BACKGROUND:1,PREVIOUS:2},BlendOpType={SOURCE:0,OVER:1};class PngDecoder extends IOBuffer{constructor(n,ei={}){super(n);qr(this,"_checkCrc");qr(this,"_inflator");qr(this,"_png");qr(this,"_apng");qr(this,"_end");qr(this,"_hasPalette");qr(this,"_palette");qr(this,"_hasTransparency");qr(this,"_transparency");qr(this,"_compressionMethod");qr(this,"_filterMethod");qr(this,"_interlaceMethod");qr(this,"_colorType");qr(this,"_isAnimated");qr(this,"_numberOfFrames");qr(this,"_numberOfPlays");qr(this,"_frames");qr(this,"_writingDataChunks");const{checkCrc:ti=!1}=ei;this._checkCrc=ti,this._inflator=new Inflate_1,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=CompressionMethod.UNKNOWN,this._filterMethod=FilterMethod.UNKNOWN,this._interlaceMethod=InterlaceMethod.UNKNOWN,this._colorType=ColorType.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(checkSignature(this);!this._end;){const n=this.readUint32(),ei=this.readChars(4);this.decodeChunk(n,ei)}return this.decodeImage(),this._png}decodeApng(){for(checkSignature(this);!this._end;){const n=this.readUint32(),ei=this.readChars(4);this.decodeApngChunk(n,ei)}return this.decodeApngImage(),this._apng}decodeChunk(n,ei){const ti=this.offset;switch(ei){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(n);break;case"IDAT":this.decodeIDAT(n);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(n);break;case"iCCP":this.decodeiCCP(n);break;case textChunkName:decodetEXt(this._png.text,this,n);break;case"pHYs":this.decodepHYs();break;default:this.skip(n);break}if(this.offset-ti!==n)throw new Error(`Length mismatch while decoding chunk ${ei}`);this._checkCrc?checkCrc(this,n+4,ei):this.skip(4)}decodeApngChunk(n,ei){const ti=this.offset;switch(ei!=="fdAT"&&ei!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),ei){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(n);break;default:this.decodeChunk(n,ei),this.offset=ti+n;break}if(this.offset-ti!==n)throw new Error(`Length mismatch while decoding chunk ${ei}`);this._checkCrc?checkCrc(this,n+4,ei):this.skip(4)}decodeIHDR(){const n=this._png;n.width=this.readUint32(),n.height=this.readUint32(),n.depth=checkBitDepth(this.readUint8());const ei=this.readUint8();this._colorType=ei;let ti;switch(ei){case ColorType.GREYSCALE:ti=1;break;case ColorType.TRUECOLOUR:ti=3;break;case ColorType.INDEXED_COLOUR:ti=1;break;case ColorType.GREYSCALE_ALPHA:ti=2;break;case ColorType.TRUECOLOUR_ALPHA:ti=4;break;case ColorType.UNKNOWN:default:throw new Error(`Unknown color type: ${ei}`)}if(this._png.channels=ti,this._compressionMethod=this.readUint8(),this._compressionMethod!==CompressionMethod.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const n={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(n)}decodePLTE(n){if(n%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${n}`);const ei=n/3;this._hasPalette=!0;const ti=[];this._palette=ti;for(let ii=0;ii<ei;ii++)ti.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(n){this._writingDataChunks=!0;const ei=n,ti=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,ti,ei)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(n)}decodeFDAT(n){this._writingDataChunks=!0;let ei=n,ti=this.offset+this.byteOffset;if(ti+=4,ei-=4,this._inflator.push(new Uint8Array(this.buffer,ti,ei)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(n)}decodetRNS(n){switch(this._colorType){case ColorType.GREYSCALE:case ColorType.TRUECOLOUR:{if(n%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${n}`);if(n/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${n/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(n/2);for(let ei=0;ei<n/2;ei++)this._transparency[ei]=this.readUint16();break}case ColorType.INDEXED_COLOUR:{if(n>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${n} vs ${this._palette.length})`);let ei=0;for(;ei<n;ei++){const ti=this.readByte();this._palette[ei].push(ti)}for(;ei<this._palette.length;ei++)this._palette[ei].push(255);break}case ColorType.UNKNOWN:case ColorType.GREYSCALE_ALPHA:case ColorType.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(n){const ei=readKeyword(this),ti=this.readUint8();if(ti!==CompressionMethod.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${ti}`);const ii=this.readBytes(n-ei.length-2);this._png.iccEmbeddedProfile={name:ei,profile:inflate_1(ii)}}decodepHYs(){const n=this.readUint32(),ei=this.readUint32(),ti=this.readByte();this._png.resolution={x:n,y:ei,unit:ti}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let n=0;n<this._numberOfFrames;n++){const ei={sequenceNumber:this._frames[n].sequenceNumber,delayNumber:this._frames[n].delayNumber,delayDenominator:this._frames[n].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},ti=this._frames.at(n);if(ti){if(ti.data=decodeInterlaceNull({data:ti.data,width:ti.width,height:ti.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),n===0||ti.xOffset===0&&ti.yOffset===0&&ti.width===this._png.width&&ti.height===this._png.height)ei.data=ti.data;else{const ii=this._apng.frames.at(n-1);this.disposeFrame(ti,ii,ei),this.addFrameDataToCanvas(ei,ti)}this._apng.frames.push(ei)}}return this._apng}disposeFrame(n,ei,ti){switch(n.disposeOp){case DisposeOpType.NONE:break;case DisposeOpType.BACKGROUND:for(let ii=0;ii<this._png.height;ii++)for(let ri=0;ri<this._png.width;ri++){const ni=(ii*n.width+ri)*this._png.channels;for(let si=0;si<this._png.channels;si++)ti.data[ni+si]=0}break;case DisposeOpType.PREVIOUS:ti.data.set(ei.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(n,ei){const ti=1<<this._png.depth,ii=(ri,ni)=>{const si=((ri+ei.yOffset)*this._png.width+ei.xOffset+ni)*this._png.channels,ai=(ri*ei.width+ni)*this._png.channels;return{index:si,frameIndex:ai}};switch(ei.blendOp){case BlendOpType.SOURCE:for(let ri=0;ri<ei.height;ri++)for(let ni=0;ni<ei.width;ni++){const{index:si,frameIndex:ai}=ii(ri,ni);for(let oi=0;oi<this._png.channels;oi++)n.data[si+oi]=ei.data[ai+oi]}break;case BlendOpType.OVER:for(let ri=0;ri<ei.height;ri++)for(let ni=0;ni<ei.width;ni++){const{index:si,frameIndex:ai}=ii(ri,ni);for(let oi=0;oi<this._png.channels;oi++){const li=ei.data[ai+this._png.channels-1]/ti,ci=oi%(this._png.channels-1)===0?1:ei.data[ai+oi],ui=Math.floor(li*ci+(1-li)*n.data[si+oi]);n.data[si+oi]+=ui}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var ei;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const n=this._isAnimated?((ei=this._frames)==null?void 0:ei.at(0)).data:this._inflator.result;if(this._filterMethod!==FilterMethod.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===InterlaceMethod.NO_INTERLACE)this._png.data=decodeInterlaceNull({data:n,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===InterlaceMethod.ADAM7)this._png.data=decodeInterlaceAdam7({data:n,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const n=this._inflator.result,ei=this._frames.at(-1);ei?ei.data=n:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:DisposeOpType.NONE,blendOp:BlendOpType.SOURCE,data:n}),this._inflator=new Inflate_1,this._writingDataChunks=!1}}function checkBitDepth(_t){if(_t!==1&&_t!==2&&_t!==4&&_t!==8&&_t!==16)throw new Error(`invalid bit depth: ${_t}`);return _t}var ResolutionUnitSpecifier;(function(_t){_t[_t.UNKNOWN=0]="UNKNOWN",_t[_t.METRE=1]="METRE"})(ResolutionUnitSpecifier||(ResolutionUnitSpecifier={}));function decodePng(_t,e){return new PngDecoder(_t,e).decode()}var i=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function a(){i.console&&typeof i.console.log=="function"&&i.console.log.apply(i.console,arguments)}var o={log:a,warn:function(_t){i.console&&(typeof i.console.warn=="function"?i.console.warn.apply(i.console,arguments):a.call(null,arguments))},error:function(_t){i.console&&(typeof i.console.error=="function"?i.console.error.apply(i.console,arguments):a(_t))}};function s(_t,e,n){var ei=new XMLHttpRequest;ei.open("GET",_t),ei.responseType="blob",ei.onload=function(){l(ei.response,e,n)},ei.onerror=function(){o.error("could not download file")},ei.send()}function u(_t){var e=new XMLHttpRequest;e.open("HEAD",_t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function c(_t){try{_t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),_t.dispatchEvent(e)}}var l=i.saveAs||((typeof window>"u"?"undefined":_typeof(window))!=="object"||window!==i?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(_t,e,n){var ei=i.URL||i.webkitURL,ti=document.createElement("a");e=e||_t.name||"download",ti.download=e,ti.rel="noopener",typeof _t=="string"?(ti.href=_t,ti.origin!==location.origin?u(ti.href)?s(_t,e,n):c(ti,ti.target="_blank"):c(ti)):(ti.href=ei.createObjectURL(_t),setTimeout(function(){ei.revokeObjectURL(ti.href)},4e4),setTimeout(function(){c(ti)},0))}:"msSaveOrOpenBlob"in navigator?function(_t,e,n){if(e=e||_t.name||"download",typeof _t=="string")if(u(_t))s(_t,e,n);else{var ei=document.createElement("a");ei.href=_t,ei.target="_blank",setTimeout(function(){c(ei)})}else navigator.msSaveOrOpenBlob((function(ti,ii){return ii===void 0?ii={autoBom:!1}:_typeof(ii)!=="object"&&(o.warn("Deprecated: Expected third argument to be a object"),ii={autoBom:!ii}),ii.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(ti.type)?new Blob(["\uFEFF",ti],{type:ti.type}):ti})(_t,n),e)}:function(_t,e,n,ei){if((ei=ei||open("","_blank"))&&(ei.document.title=ei.document.body.innerText="downloading..."),typeof _t=="string")return s(_t,e,n);var ti=_t.type==="application/octet-stream",ii=/constructor/i.test(i.HTMLElement)||i.safari,ri=/CriOS\/[\d]+/.test(navigator.userAgent);if((ri||ti&&ii)&&(typeof FileReader>"u"?"undefined":_typeof(FileReader))==="object"){var ni=new FileReader;ni.onloadend=function(){var oi=ni.result;oi=ri?oi:oi.replace(/^data:[^;]*;/,"data:attachment/file;"),ei?ei.location.href=oi:location=oi,ei=null},ni.readAsDataURL(_t)}else{var si=i.URL||i.webkitURL,ai=si.createObjectURL(_t);ei?ei.location=ai:location.href=ai,ei=null,setTimeout(function(){si.revokeObjectURL(ai)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function h(_t){var e;_t=_t||"",this.ok=!1,_t.charAt(0)=="#"&&(_t=_t.substr(1,6)),_t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[_t=(_t=_t.replace(/ /g,"")).toLowerCase()]||_t;for(var n=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(ni){return[parseInt(ni[1]),parseInt(ni[2]),parseInt(ni[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(ni){return[parseInt(ni[1],16),parseInt(ni[2],16),parseInt(ni[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(ni){return[parseInt(ni[1]+ni[1],16),parseInt(ni[2]+ni[2],16),parseInt(ni[3]+ni[3],16)]}}],ei=0;ei<n.length;ei++){var ti=n[ei].re,ii=n[ei].process,ri=ti.exec(_t);ri&&(e=ii(ri),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var ni=this.r.toString(16),si=this.g.toString(16),ai=this.b.toString(16);return ni.length==1&&(ni="0"+ni),si.length==1&&(si="0"+si),ai.length==1&&(ai="0"+ai),"#"+ni+si+ai}}var f=i.atob.bind(i),d=i.btoa.bind(i);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function p(_t,e){var n=_t[0],ei=_t[1],ti=_t[2],ii=_t[3];n=m(n,ei,ti,ii,e[0],7,-680876936),ii=m(ii,n,ei,ti,e[1],12,-389564586),ti=m(ti,ii,n,ei,e[2],17,606105819),ei=m(ei,ti,ii,n,e[3],22,-1044525330),n=m(n,ei,ti,ii,e[4],7,-176418897),ii=m(ii,n,ei,ti,e[5],12,1200080426),ti=m(ti,ii,n,ei,e[6],17,-1473231341),ei=m(ei,ti,ii,n,e[7],22,-45705983),n=m(n,ei,ti,ii,e[8],7,1770035416),ii=m(ii,n,ei,ti,e[9],12,-1958414417),ti=m(ti,ii,n,ei,e[10],17,-42063),ei=m(ei,ti,ii,n,e[11],22,-1990404162),n=m(n,ei,ti,ii,e[12],7,1804603682),ii=m(ii,n,ei,ti,e[13],12,-40341101),ti=m(ti,ii,n,ei,e[14],17,-1502002290),n=v(n,ei=m(ei,ti,ii,n,e[15],22,1236535329),ti,ii,e[1],5,-165796510),ii=v(ii,n,ei,ti,e[6],9,-1069501632),ti=v(ti,ii,n,ei,e[11],14,643717713),ei=v(ei,ti,ii,n,e[0],20,-373897302),n=v(n,ei,ti,ii,e[5],5,-701558691),ii=v(ii,n,ei,ti,e[10],9,38016083),ti=v(ti,ii,n,ei,e[15],14,-660478335),ei=v(ei,ti,ii,n,e[4],20,-405537848),n=v(n,ei,ti,ii,e[9],5,568446438),ii=v(ii,n,ei,ti,e[14],9,-1019803690),ti=v(ti,ii,n,ei,e[3],14,-187363961),ei=v(ei,ti,ii,n,e[8],20,1163531501),n=v(n,ei,ti,ii,e[13],5,-1444681467),ii=v(ii,n,ei,ti,e[2],9,-51403784),ti=v(ti,ii,n,ei,e[7],14,1735328473),n=b(n,ei=v(ei,ti,ii,n,e[12],20,-1926607734),ti,ii,e[5],4,-378558),ii=b(ii,n,ei,ti,e[8],11,-2022574463),ti=b(ti,ii,n,ei,e[11],16,1839030562),ei=b(ei,ti,ii,n,e[14],23,-35309556),n=b(n,ei,ti,ii,e[1],4,-1530992060),ii=b(ii,n,ei,ti,e[4],11,1272893353),ti=b(ti,ii,n,ei,e[7],16,-155497632),ei=b(ei,ti,ii,n,e[10],23,-1094730640),n=b(n,ei,ti,ii,e[13],4,681279174),ii=b(ii,n,ei,ti,e[0],11,-358537222),ti=b(ti,ii,n,ei,e[3],16,-722521979),ei=b(ei,ti,ii,n,e[6],23,76029189),n=b(n,ei,ti,ii,e[9],4,-640364487),ii=b(ii,n,ei,ti,e[12],11,-421815835),ti=b(ti,ii,n,ei,e[15],16,530742520),n=y(n,ei=b(ei,ti,ii,n,e[2],23,-995338651),ti,ii,e[0],6,-198630844),ii=y(ii,n,ei,ti,e[7],10,1126891415),ti=y(ti,ii,n,ei,e[14],15,-1416354905),ei=y(ei,ti,ii,n,e[5],21,-57434055),n=y(n,ei,ti,ii,e[12],6,1700485571),ii=y(ii,n,ei,ti,e[3],10,-1894986606),ti=y(ti,ii,n,ei,e[10],15,-1051523),ei=y(ei,ti,ii,n,e[1],21,-2054922799),n=y(n,ei,ti,ii,e[8],6,1873313359),ii=y(ii,n,ei,ti,e[15],10,-30611744),ti=y(ti,ii,n,ei,e[6],15,-1560198380),ei=y(ei,ti,ii,n,e[13],21,1309151649),n=y(n,ei,ti,ii,e[4],6,-145523070),ii=y(ii,n,ei,ti,e[11],10,-1120210379),ti=y(ti,ii,n,ei,e[2],15,718787259),ei=y(ei,ti,ii,n,e[9],21,-343485551),_t[0]=P(n,_t[0]),_t[1]=P(ei,_t[1]),_t[2]=P(ti,_t[2]),_t[3]=P(ii,_t[3])}function g(_t,e,n,ei,ti,ii){return e=P(P(e,_t),P(ei,ii)),P(e<<ti|e>>>32-ti,n)}function m(_t,e,n,ei,ti,ii,ri){return g(e&n|~e&ei,_t,e,ti,ii,ri)}function v(_t,e,n,ei,ti,ii,ri){return g(e&ei|n&~ei,_t,e,ti,ii,ri)}function b(_t,e,n,ei,ti,ii,ri){return g(e^n^ei,_t,e,ti,ii,ri)}function y(_t,e,n,ei,ti,ii,ri){return g(n^(e|~ei),_t,e,ti,ii,ri)}function w(_t){var e,n=_t.length,ei=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=_t.length;e+=64)p(ei,N(_t.substring(e-64,e)));_t=_t.substring(e-64);var ti=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<_t.length;e++)ti[e>>2]|=_t.charCodeAt(e)<<(e%4<<3);if(ti[e>>2]|=128<<(e%4<<3),e>55)for(p(ei,ti),e=0;e<16;e++)ti[e]=0;return ti[14]=8*n,p(ei,ti),ei}function N(_t){var e,n=[];for(e=0;e<64;e+=4)n[e>>2]=_t.charCodeAt(e)+(_t.charCodeAt(e+1)<<8)+(_t.charCodeAt(e+2)<<16)+(_t.charCodeAt(e+3)<<24);return n}var L="0123456789abcdef".split("");function x(_t){for(var e="",n=0;n<4;n++)e+=L[_t>>8*n+4&15]+L[_t>>8*n&15];return e}function A(_t){return String.fromCharCode(255&_t,(65280&_t)>>8,(16711680&_t)>>16,(4278190080&_t)>>24)}function S(_t){return w(_t).map(A).join("")}var _=(function(_t){for(var e=0;e<_t.length;e++)_t[e]=x(_t[e]);return _t.join("")})(w("hello"))!="5d41402abc4b2a76b9719d911017c592";function P(_t,e){if(_){var n=(65535&_t)+(65535&e);return(_t>>16)+(e>>16)+(n>>16)<<16|65535&n}return _t+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function k(_t,e){var n,ei,ti,ii;if(_t!==n){for(var ri=(ti=_t,ii=1+(256/_t.length|0),new Array(ii+1).join(ti)),ni=[],si=0;si<256;si++)ni[si]=si;var ai=0;for(si=0;si<256;si++){var oi=ni[si];ai=(ai+oi+ri.charCodeAt(si))%256,ni[si]=ni[ai],ni[ai]=oi}n=_t,ei=ni}else ni=ei;var li=e.length,ci=0,ui=0,di="";for(si=0;si<li;si++)ui=(ui+(oi=ni[ci=(ci+1)%256]))%256,ni[ci]=ni[ui],ni[ui]=oi,ri=ni[(ni[ci]+ni[ui])%256],di+=String.fromCharCode(e.charCodeAt(si)^ri);return di}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var F={print:4,modify:8,copy:16,"annot-forms":32};function I(_t,e,n,ei){this.v=1,this.r=2;var ti=192;_t.forEach(function(ni){if(F.perm!==void 0)throw new Error("Invalid permission: "+ni);ti+=F[ni]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var ii=(e+this.padding).substr(0,32),ri=(n+this.padding).substr(0,32);this.O=this.processOwnerPassword(ii,ri),this.P=-(1+(255^ti)),this.encryptionKey=S(ii+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(ei)).substr(0,5),this.U=k(this.encryptionKey,this.padding)}function j(_t){if(/[^\u0000-\u00ff]/.test(_t))throw new Error("Invalid PDF Name Object: "+_t+", Only accept ASCII characters.");for(var e="",n=_t.length,ei=0;ei<n;ei++){var ti=_t.charCodeAt(ei);e+=ti<33||ti===35||ti===37||ti===40||ti===41||ti===47||ti===60||ti===62||ti===91||ti===93||ti===123||ti===125||ti>126?"#"+("0"+ti.toString(16)).slice(-2):_t[ei]}return e}function C(_t){if(_typeof(_t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(n,ei,ti){if(ti=ti||!1,typeof n!="string"||typeof ei!="function"||typeof ti!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(n)||(e[n]={});var ii=Math.random().toString(35);return e[n][ii]=[ei,!!ti],ii},this.unsubscribe=function(n){for(var ei in e)if(e[ei][n])return delete e[ei][n],Object.keys(e[ei]).length===0&&delete e[ei],!0;return!1},this.publish=function(n){if(e.hasOwnProperty(n)){var ei=Array.prototype.slice.call(arguments,1),ti=[];for(var ii in e[n]){var ri=e[n][ii];try{ri[0].apply(_t,ei)}catch(ni){i.console&&o.error("jsPDF PubSub Error",ni.message,ni)}ri[1]&&ti.push(ii)}ti.length&&ti.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function O(_t){if(!(this instanceof O))return new O(_t);var e="opacity,stroke-opacity".split(",");for(var n in _t)_t.hasOwnProperty(n)&&e.indexOf(n)>=0&&(this[n]=_t[n]);this.id="",this.objectNumber=-1}function B(_t,e){this.gState=_t,this.matrix=e,this.id="",this.objectNumber=-1}function M(_t,e,n,ei,ti){if(!(this instanceof M))return new M(_t,e,n,ei,ti);this.type=_t==="axial"?2:3,this.coords=e,this.colors=n,B.call(this,ei,ti)}function q(_t,e,n,ei,ti){if(!(this instanceof q))return new q(_t,e,n,ei,ti);this.boundingBox=_t,this.xStep=e,this.yStep=n,this.stream="",this.cloneIndex=0,B.call(this,ei,ti)}function E(_t){var e,n=typeof arguments[0]=="string"?arguments[0]:"p",ei=arguments[1],ti=arguments[2],ii=arguments[3],ri=[],ni=1,si=16,ai="S",oi=null;_typeof(_t=_t||{})==="object"&&(n=_t.orientation,ei=_t.unit||ei,ti=_t.format||ti,ii=_t.compress||_t.compressPdf||ii,(oi=_t.encryption||null)!==null&&(oi.userPassword=oi.userPassword||"",oi.ownerPassword=oi.ownerPassword||"",oi.userPermissions=oi.userPermissions||[]),ni=typeof _t.userUnit=="number"?Math.abs(_t.userUnit):1,_t.precision!==void 0&&(e=_t.precision),_t.floatPrecision!==void 0&&(si=_t.floatPrecision),ai=_t.defaultPathOperation||"S"),ri=_t.filters||(ii===!0?["FlateEncode"]:ri),ei=ei||"mm",n=(""+(n||"P")).toLowerCase();var li=_t.putOnlyUsedFonts||!1,ci={},ui={internal:{},__private__:{}};ui.__private__.PubSub=C;var di="1.3",fi=ui.__private__.getPdfVersion=function(){return di};ui.__private__.setPdfVersion=function(bi){di=bi};var hi={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};ui.__private__.getPageFormats=function(){return hi};var pi=ui.__private__.getPageFormat=function(bi){return hi[bi]};ti=ti||"a4";var gi="compat",vi="advanced",yi=gi;function _i(){this.saveGraphicsState(),Gi(new Ur(Gr,0,0,-Gr,0,Ba()*Gr).toString()+" cm"),this.setFontSize(this.getFontSize()/Gr),ai="n",yi=vi}function Ai(){this.restoreGraphicsState(),ai="S",yi=gi}var Ei=ui.__private__.combineFontStyleAndFontWeight=function(bi,Fi){if(bi=="bold"&&Fi=="normal"||bi=="bold"&&Fi==400||bi=="normal"&&Fi=="italic"||bi=="bold"&&Fi=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return Fi&&(bi=Fi==400||Fi==="normal"?bi==="italic"?"italic":"normal":Fi!=700&&Fi!=="bold"||bi!=="normal"?(Fi==700?"bold":Fi)+""+bi:"bold"),bi};ui.advancedAPI=function(bi){var Fi=yi===gi;return Fi&&_i.call(this),typeof bi!="function"||(bi(this),Fi&&Ai.call(this)),this},ui.compatAPI=function(bi){var Fi=yi===vi;return Fi&&Ai.call(this),typeof bi!="function"||(bi(this),Fi&&_i.call(this)),this},ui.isAdvancedAPI=function(){return yi===vi};var Si,wi=function(bi){if(yi!==vi)throw new Error(bi+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},Oi=ui.roundToPrecision=ui.__private__.roundToPrecision=function(bi,Fi){var tr=e||Fi;if(isNaN(bi)||isNaN(tr))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return bi.toFixed(tr).replace(/0+$/,"")};Si=ui.hpf=ui.__private__.hpf=typeof si=="number"?function(bi){if(isNaN(bi))throw new Error("Invalid argument passed to jsPDF.hpf");return Oi(bi,si)}:si==="smart"?function(bi){if(isNaN(bi))throw new Error("Invalid argument passed to jsPDF.hpf");return Oi(bi,bi>-1&&bi<1?16:5)}:function(bi){if(isNaN(bi))throw new Error("Invalid argument passed to jsPDF.hpf");return Oi(bi,16)};var Ii=ui.f2=ui.__private__.f2=function(bi){if(isNaN(bi))throw new Error("Invalid argument passed to jsPDF.f2");return Oi(bi,2)},Li=ui.__private__.f3=function(bi){if(isNaN(bi))throw new Error("Invalid argument passed to jsPDF.f3");return Oi(bi,3)},Di=ui.scale=ui.__private__.scale=function(bi){if(isNaN(bi))throw new Error("Invalid argument passed to jsPDF.scale");return yi===gi?bi*Gr:yi===vi?bi:void 0},Ni=function(bi){return Di((function(Fi){return yi===gi?Ba()-Fi:yi===vi?Fi:void 0})(bi))};ui.__private__.setPrecision=ui.setPrecision=function(bi){typeof parseInt(bi,10)=="number"&&(e=parseInt(bi,10))};var $i,Ki="00000000000000000000000000000000",er=ui.__private__.getFileId=function(){return Ki},Vi=ui.__private__.setFileId=function(bi){return Ki=bi!==void 0&&/^[a-fA-F0-9]{32}$/.test(bi)?bi.toUpperCase():Ki.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),oi!==null&&(es=new I(oi.userPermissions,oi.userPassword,oi.ownerPassword,Ki)),Ki};ui.setFileId=function(bi){return Vi(bi),this},ui.getFileId=function(){return er()};var nr=ui.__private__.convertDateToPDFDate=function(bi){var Fi=bi.getTimezoneOffset(),tr=Fi<0?"+":"-",lr=Math.floor(Math.abs(Fi/60)),hr=Math.abs(Fi%60),xr=[tr,xi(lr),"'",xi(hr),"'"].join("");return["D:",bi.getFullYear(),xi(bi.getMonth()+1),xi(bi.getDate()),xi(bi.getHours()),xi(bi.getMinutes()),xi(bi.getSeconds()),xr].join("")},zi=ui.__private__.convertPDFDateToDate=function(bi){var Fi=parseInt(bi.substr(2,4),10),tr=parseInt(bi.substr(6,2),10)-1,lr=parseInt(bi.substr(8,2),10),hr=parseInt(bi.substr(10,2),10),xr=parseInt(bi.substr(12,2),10),Lr=parseInt(bi.substr(14,2),10);return new Date(Fi,tr,lr,hr,xr,Lr,0)},Wi=ui.__private__.setCreationDate=function(bi){var Fi;if(bi===void 0&&(bi=new Date),bi instanceof Date)Fi=nr(bi);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(bi))throw new Error("Invalid argument passed to jsPDF.setCreationDate");Fi=bi}return $i=Fi},Ti=ui.__private__.getCreationDate=function(bi){var Fi=$i;return bi==="jsDate"&&(Fi=zi($i)),Fi};ui.setCreationDate=function(bi){return Wi(bi),this},ui.getCreationDate=function(bi){return Ti(bi)};var ki,xi=ui.__private__.padd2=function(bi){return("0"+parseInt(bi)).slice(-2)},Mi=ui.__private__.padd2Hex=function(bi){return("00"+(bi=bi.toString())).substr(bi.length)},Ui=0,Yi=[],sr=[],cr=0,ir=[],Zi=[],rr=!1,ar=sr;ui.__private__.setCustomOutputDestination=function(bi){rr=!0,ar=bi};var pr=function(bi){rr||(ar=bi)};ui.__private__.resetCustomOutputDestination=function(){rr=!1,ar=sr};var Gi=ui.__private__.out=function(bi){return bi=bi.toString(),cr+=bi.length+1,ar.push(bi),ar},gr=ui.__private__.write=function(bi){return Gi(arguments.length===1?bi.toString():Array.prototype.join.call(arguments," "))},Br=ui.__private__.getArrayBuffer=function(bi){for(var Fi=bi.length,tr=new ArrayBuffer(Fi),lr=new Uint8Array(tr);Fi--;)lr[Fi]=bi.charCodeAt(Fi);return tr},Nr=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];ui.__private__.getStandardFonts=function(){return Nr};var mr=_t.fontSize||16;ui.__private__.setFontSize=ui.setFontSize=function(bi){return mr=yi===vi?bi/Gr:bi,this};var Mr,Er=ui.__private__.getFontSize=ui.getFontSize=function(){return yi===gi?mr:mr*Gr},Fr=_t.R2L||!1;ui.__private__.setR2L=ui.setR2L=function(bi){return Fr=bi,this},ui.__private__.getR2L=ui.getR2L=function(){return Fr};var or,yr=ui.__private__.setZoomMode=function(bi){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(bi))Mr=bi;else if(isNaN(bi)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(bi)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+bi+'" is not recognized.');Mr=bi}else Mr=parseInt(bi,10)};ui.__private__.getZoomMode=function(){return Mr};var _r,Ar=ui.__private__.setPageMode=function(bi){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(bi)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+bi+'" is not recognized.');or=bi};ui.__private__.getPageMode=function(){return or};var wr=ui.__private__.setLayoutMode=function(bi){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(bi)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+bi+'" is not recognized.');_r=bi};ui.__private__.getLayoutMode=function(){return _r},ui.__private__.setDisplayMode=ui.setDisplayMode=function(bi,Fi,tr){return yr(bi),wr(Fi),Ar(tr),this};var Rr={title:"",subject:"",author:"",keywords:"",creator:""};ui.__private__.getDocumentProperty=function(bi){if(Object.keys(Rr).indexOf(bi)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Rr[bi]},ui.__private__.getDocumentProperties=function(){return Rr},ui.__private__.setDocumentProperties=ui.setProperties=ui.setDocumentProperties=function(bi){for(var Fi in Rr)Rr.hasOwnProperty(Fi)&&bi[Fi]&&(Rr[Fi]=bi[Fi]);return this},ui.__private__.setDocumentProperty=function(bi,Fi){if(Object.keys(Rr).indexOf(bi)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Rr[bi]=Fi};var Sr,Gr,Or,nn,en,Vr={},Xr={},tn=[],Dr={},rn={},jr={},$r={},un=null,sn=0,Wr=[],an=new C(ui),En=_t.hotfixes||[],Pn={},Dn={},Gn=[],Ur=function bi(Fi,tr,lr,hr,xr,Lr){if(!(this instanceof bi))return new bi(Fi,tr,lr,hr,xr,Lr);isNaN(Fi)&&(Fi=1),isNaN(tr)&&(tr=0),isNaN(lr)&&(lr=0),isNaN(hr)&&(hr=1),isNaN(xr)&&(xr=0),isNaN(Lr)&&(Lr=0),this._matrix=[Fi,tr,lr,hr,xr,Lr]};Object.defineProperty(Ur.prototype,"sx",{get:function(){return this._matrix[0]},set:function(bi){this._matrix[0]=bi}}),Object.defineProperty(Ur.prototype,"shy",{get:function(){return this._matrix[1]},set:function(bi){this._matrix[1]=bi}}),Object.defineProperty(Ur.prototype,"shx",{get:function(){return this._matrix[2]},set:function(bi){this._matrix[2]=bi}}),Object.defineProperty(Ur.prototype,"sy",{get:function(){return this._matrix[3]},set:function(bi){this._matrix[3]=bi}}),Object.defineProperty(Ur.prototype,"tx",{get:function(){return this._matrix[4]},set:function(bi){this._matrix[4]=bi}}),Object.defineProperty(Ur.prototype,"ty",{get:function(){return this._matrix[5]},set:function(bi){this._matrix[5]=bi}}),Object.defineProperty(Ur.prototype,"a",{get:function(){return this._matrix[0]},set:function(bi){this._matrix[0]=bi}}),Object.defineProperty(Ur.prototype,"b",{get:function(){return this._matrix[1]},set:function(bi){this._matrix[1]=bi}}),Object.defineProperty(Ur.prototype,"c",{get:function(){return this._matrix[2]},set:function(bi){this._matrix[2]=bi}}),Object.defineProperty(Ur.prototype,"d",{get:function(){return this._matrix[3]},set:function(bi){this._matrix[3]=bi}}),Object.defineProperty(Ur.prototype,"e",{get:function(){return this._matrix[4]},set:function(bi){this._matrix[4]=bi}}),Object.defineProperty(Ur.prototype,"f",{get:function(){return this._matrix[5]},set:function(bi){this._matrix[5]=bi}}),Object.defineProperty(Ur.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Ur.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Ur.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Ur.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Ur.prototype.join=function(bi){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(Si).join(bi)},Ur.prototype.multiply=function(bi){var Fi=bi.sx*this.sx+bi.shy*this.shx,tr=bi.sx*this.shy+bi.shy*this.sy,lr=bi.shx*this.sx+bi.sy*this.shx,hr=bi.shx*this.shy+bi.sy*this.sy,xr=bi.tx*this.sx+bi.ty*this.shx+this.tx,Lr=bi.tx*this.shy+bi.ty*this.sy+this.ty;return new Ur(Fi,tr,lr,hr,xr,Lr)},Ur.prototype.decompose=function(){var bi=this.sx,Fi=this.shy,tr=this.shx,lr=this.sy,hr=this.tx,xr=this.ty,Lr=Math.sqrt(bi*bi+Fi*Fi),Yr=(bi/=Lr)*tr+(Fi/=Lr)*lr;tr-=bi*Yr,lr-=Fi*Yr;var Jr=Math.sqrt(tr*tr+lr*lr);return Yr/=Jr,bi*(lr/=Jr)<Fi*(tr/=Jr)&&(bi=-bi,Fi=-Fi,Yr=-Yr,Lr=-Lr),{scale:new Ur(Lr,0,0,Jr,0,0),translate:new Ur(1,0,0,1,hr,xr),rotate:new Ur(bi,Fi,-Fi,bi,0,0),skew:new Ur(1,0,Yr,1,0,0)}},Ur.prototype.toString=function(bi){return this.join(" ")},Ur.prototype.inversed=function(){var bi=this.sx,Fi=this.shy,tr=this.shx,lr=this.sy,hr=this.tx,xr=this.ty,Lr=1/(bi*lr-Fi*tr),Yr=lr*Lr,Jr=-Fi*Lr,cn=-tr*Lr,fn=bi*Lr;return new Ur(Yr,Jr,cn,fn,-Yr*hr-cn*xr,-Jr*hr-fn*xr)},Ur.prototype.applyToPoint=function(bi){var Fi=bi.x*this.sx+bi.y*this.shx+this.tx,tr=bi.x*this.shy+bi.y*this.sy+this.ty;return new sa(Fi,tr)},Ur.prototype.applyToRectangle=function(bi){var Fi=this.applyToPoint(bi),tr=this.applyToPoint(new sa(bi.x+bi.w,bi.y+bi.h));return new vo(Fi.x,Fi.y,tr.x-Fi.x,tr.y-Fi.y)},Ur.prototype.clone=function(){var bi=this.sx,Fi=this.shy,tr=this.shx,lr=this.sy,hr=this.tx,xr=this.ty;return new Ur(bi,Fi,tr,lr,hr,xr)},ui.Matrix=Ur;var Tn=ui.matrixMult=function(bi,Fi){return Fi.multiply(bi)},$n=new Ur(1,0,0,1,0,0);ui.unitMatrix=ui.identityMatrix=$n;var mn=function(bi,Fi){if(!rn[bi]){var tr=(Fi instanceof M?"Sh":"P")+(Object.keys(Dr).length+1).toString(10);Fi.id=tr,rn[bi]=tr,Dr[tr]=Fi,an.publish("addPattern",Fi)}};ui.ShadingPattern=M,ui.TilingPattern=q,ui.addShadingPattern=function(bi,Fi){return wi("addShadingPattern()"),mn(bi,Fi),this},ui.beginTilingPattern=function(bi){wi("beginTilingPattern()"),_o(bi.boundingBox[0],bi.boundingBox[1],bi.boundingBox[2]-bi.boundingBox[0],bi.boundingBox[3]-bi.boundingBox[1],bi.matrix)},ui.endTilingPattern=function(bi,Fi){wi("endTilingPattern()"),Fi.stream=Zi[ki].join(`
`),mn(bi,Fi),an.publish("endTilingPattern",Fi),Gn.pop().restore()};var bn,yn=ui.__private__.newObject=function(){var bi=Fn();return Ln(bi,!0),bi},Fn=ui.__private__.newObjectDeferred=function(){return Ui++,Yi[Ui]=function(){return cr},Ui},Ln=function(bi,Fi){return Fi=typeof Fi=="boolean"&&Fi,Yi[bi]=cr,Fi&&Gi(bi+" 0 obj"),bi},Is=ui.__private__.newAdditionalObject=function(){var bi={objId:Fn(),content:""};return ir.push(bi),bi},_s=Fn(),Cs=Fn(),ks=ui.__private__.decodeColorString=function(bi){var Fi=bi.split(" ");if(Fi.length!==2||Fi[1]!=="g"&&Fi[1]!=="G")Fi.length!==5||Fi[4]!=="k"&&Fi[4]!=="K"||(Fi=[(1-Fi[0])*(1-Fi[3]),(1-Fi[1])*(1-Fi[3]),(1-Fi[2])*(1-Fi[3]),"r"]);else{var tr=parseFloat(Fi[0]);Fi=[tr,tr,tr,"r"]}for(var lr="#",hr=0;hr<3;hr++)lr+=("0"+Math.floor(255*parseFloat(Fi[hr])).toString(16)).slice(-2);return lr},As=ui.__private__.encodeColorString=function(bi){var Fi;typeof bi=="string"&&(bi={ch1:bi});var tr=bi.ch1,lr=bi.ch2,hr=bi.ch3,xr=bi.ch4,Lr=bi.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof tr=="string"&&tr.charAt(0)!=="#"){var Yr=new h(tr);if(Yr.ok)tr=Yr.toHex();else if(!/^\d*\.?\d*$/.test(tr))throw new Error('Invalid color "'+tr+'" passed to jsPDF.encodeColorString.')}if(typeof tr=="string"&&/^#[0-9A-Fa-f]{3}$/.test(tr)&&(tr="#"+tr[1]+tr[1]+tr[2]+tr[2]+tr[3]+tr[3]),typeof tr=="string"&&/^#[0-9A-Fa-f]{6}$/.test(tr)){var Jr=parseInt(tr.substr(1),16);tr=Jr>>16&255,lr=Jr>>8&255,hr=255&Jr}if(lr===void 0||xr===void 0&&tr===lr&&lr===hr)Fi=typeof tr=="string"?tr+" "+Lr[0]:bi.precision===2?Ii(tr/255)+" "+Lr[0]:Li(tr/255)+" "+Lr[0];else if(xr===void 0||_typeof(xr)==="object"){if(xr&&!isNaN(xr.a)&&xr.a===0)return["1.","1.","1.",Lr[1]].join(" ");Fi=typeof tr=="string"?[tr,lr,hr,Lr[1]].join(" "):bi.precision===2?[Ii(tr/255),Ii(lr/255),Ii(hr/255),Lr[1]].join(" "):[Li(tr/255),Li(lr/255),Li(hr/255),Lr[1]].join(" ")}else Fi=typeof tr=="string"?[tr,lr,hr,xr,Lr[2]].join(" "):bi.precision===2?[Ii(tr),Ii(lr),Ii(hr),Ii(xr),Lr[2]].join(" "):[Li(tr),Li(lr),Li(hr),Li(xr),Lr[2]].join(" ");return Fi},as=ui.__private__.getFilters=function(){return ri},ls=ui.__private__.putStream=function(bi){var Fi=(bi=bi||{}).data||"",tr=bi.filters||as(),lr=bi.alreadyAppliedFilters||[],hr=bi.addLength1||!1,xr=Fi.length,Lr=bi.objectId,Yr=function(ts){return ts};if(oi!==null&&Lr===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");oi!==null&&(Yr=es.encryptor(Lr,0));var Jr={};tr===!0&&(tr=["FlateEncode"]);var cn=bi.additionalKeyValues||[],fn=(Jr=E.API.processDataByFilters!==void 0?E.API.processDataByFilters(Fi,tr):{data:Fi,reverseChain:[]}).reverseChain+(Array.isArray(lr)?lr.join(" "):lr.toString());if(Jr.data.length!==0&&(cn.push({key:"Length",value:Jr.data.length}),hr===!0&&cn.push({key:"Length1",value:xr})),fn.length!=0)if(fn.split("/").length-1==1)cn.push({key:"Filter",value:fn});else{cn.push({key:"Filter",value:"["+fn+"]"});for(var Cn=0;Cn<cn.length;Cn+=1)if(cn[Cn].key==="DecodeParms"){for(var Bn=[],Kn=0;Kn<Jr.reverseChain.split("/").length-1;Kn+=1)Bn.push("null");Bn.push(cn[Cn].value),cn[Cn].value="["+Bn.join(" ")+"]"}}Gi("<<");for(var Nn=0;Nn<cn.length;Nn++)Gi("/"+cn[Nn].key+" "+cn[Nn].value);Gi(">>"),Jr.data.length!==0&&(Gi("stream"),Gi(Yr(Jr.data)),Gi("endstream"))},Na=ui.__private__.putPage=function(bi){var Fi=bi.number,tr=bi.data,lr=bi.objId,hr=bi.contentsObjId;Ln(lr,!0),Gi("<</Type /Page"),Gi("/Parent "+bi.rootDictionaryObjId+" 0 R"),Gi("/Resources "+bi.resourceDictionaryObjId+" 0 R"),Gi("/MediaBox ["+parseFloat(Si(bi.mediaBox.bottomLeftX))+" "+parseFloat(Si(bi.mediaBox.bottomLeftY))+" "+Si(bi.mediaBox.topRightX)+" "+Si(bi.mediaBox.topRightY)+"]"),bi.cropBox!==null&&Gi("/CropBox ["+Si(bi.cropBox.bottomLeftX)+" "+Si(bi.cropBox.bottomLeftY)+" "+Si(bi.cropBox.topRightX)+" "+Si(bi.cropBox.topRightY)+"]"),bi.bleedBox!==null&&Gi("/BleedBox ["+Si(bi.bleedBox.bottomLeftX)+" "+Si(bi.bleedBox.bottomLeftY)+" "+Si(bi.bleedBox.topRightX)+" "+Si(bi.bleedBox.topRightY)+"]"),bi.trimBox!==null&&Gi("/TrimBox ["+Si(bi.trimBox.bottomLeftX)+" "+Si(bi.trimBox.bottomLeftY)+" "+Si(bi.trimBox.topRightX)+" "+Si(bi.trimBox.topRightY)+"]"),bi.artBox!==null&&Gi("/ArtBox ["+Si(bi.artBox.bottomLeftX)+" "+Si(bi.artBox.bottomLeftY)+" "+Si(bi.artBox.topRightX)+" "+Si(bi.artBox.topRightY)+"]"),typeof bi.userUnit=="number"&&bi.userUnit!==1&&Gi("/UserUnit "+bi.userUnit),an.publish("putPage",{objId:lr,pageContext:Wr[Fi],pageNumber:Fi,page:tr}),Gi("/Contents "+hr+" 0 R"),Gi(">>"),Gi("endobj");var xr=tr.join(`
`);return yi===vi&&(xr+=`
Q`),Ln(hr,!0),ls({data:xr,filters:as(),objectId:hr}),Gi("endobj"),lr},Vs=ui.__private__.putPages=function(){var bi,Fi,tr=[];for(bi=1;bi<=sn;bi++)Wr[bi].objId=Fn(),Wr[bi].contentsObjId=Fn();for(bi=1;bi<=sn;bi++)tr.push(Na({number:bi,data:Zi[bi],objId:Wr[bi].objId,contentsObjId:Wr[bi].contentsObjId,mediaBox:Wr[bi].mediaBox,cropBox:Wr[bi].cropBox,bleedBox:Wr[bi].bleedBox,trimBox:Wr[bi].trimBox,artBox:Wr[bi].artBox,userUnit:Wr[bi].userUnit,rootDictionaryObjId:_s,resourceDictionaryObjId:Cs}));Ln(_s,!0),Gi("<</Type /Pages");var lr="/Kids [";for(Fi=0;Fi<sn;Fi++)lr+=tr[Fi]+" 0 R ";Gi(lr+"]"),Gi("/Count "+sn),Gi(">>"),Gi("endobj"),an.publish("postPutPages")},ka=function(bi){an.publish("putFont",{font:bi,out:Gi,newObject:yn,putStream:ls}),bi.isAlreadyPutted!==!0&&(bi.objectNumber=yn(),Gi("<<"),Gi("/Type /Font"),Gi("/BaseFont /"+j(bi.postScriptName)),Gi("/Subtype /Type1"),typeof bi.encoding=="string"&&Gi("/Encoding /"+bi.encoding),Gi("/FirstChar 32"),Gi("/LastChar 255"),Gi(">>"),Gi("endobj"))},Xa=function(bi){bi.objectNumber=yn();var Fi=[];Fi.push({key:"Type",value:"/XObject"}),Fi.push({key:"Subtype",value:"/Form"}),Fi.push({key:"BBox",value:"["+[Si(bi.x),Si(bi.y),Si(bi.x+bi.width),Si(bi.y+bi.height)].join(" ")+"]"}),Fi.push({key:"Matrix",value:"["+bi.matrix.toString()+"]"});var tr=bi.pages[1].join(`
`);ls({data:tr,additionalKeyValues:Fi,objectId:bi.objectNumber}),Gi("endobj")},Ka=function(bi,Fi){Fi||(Fi=21);var tr=yn(),lr=(function(Lr,Yr){var Jr,cn=[],fn=1/(Yr-1);for(Jr=0;Jr<1;Jr+=fn)cn.push(Jr);if(cn.push(1),Lr[0].offset!=0){var Cn={offset:0,color:Lr[0].color};Lr.unshift(Cn)}if(Lr[Lr.length-1].offset!=1){var Bn={offset:1,color:Lr[Lr.length-1].color};Lr.push(Bn)}for(var Kn="",Nn=0,ts=0;ts<cn.length;ts++){for(Jr=cn[ts];Jr>Lr[Nn+1].offset;)Nn++;var Jn=Lr[Nn].offset,cs=(Jr-Jn)/(Lr[Nn+1].offset-Jn),la=Lr[Nn].color,Hs=Lr[Nn+1].color;Kn+=Mi(Math.round((1-cs)*la[0]+cs*Hs[0]).toString(16))+Mi(Math.round((1-cs)*la[1]+cs*Hs[1]).toString(16))+Mi(Math.round((1-cs)*la[2]+cs*Hs[2]).toString(16))}return Kn.trim()})(bi.colors,Fi),hr=[];hr.push({key:"FunctionType",value:"0"}),hr.push({key:"Domain",value:"[0.0 1.0]"}),hr.push({key:"Size",value:"["+Fi+"]"}),hr.push({key:"BitsPerSample",value:"8"}),hr.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),hr.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ls({data:lr,additionalKeyValues:hr,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:tr}),Gi("endobj"),bi.objectNumber=yn(),Gi("<< /ShadingType "+bi.type),Gi("/ColorSpace /DeviceRGB");var xr="/Coords ["+Si(parseFloat(bi.coords[0]))+" "+Si(parseFloat(bi.coords[1]))+" ";bi.type===2?xr+=Si(parseFloat(bi.coords[2]))+" "+Si(parseFloat(bi.coords[3])):xr+=Si(parseFloat(bi.coords[2]))+" "+Si(parseFloat(bi.coords[3]))+" "+Si(parseFloat(bi.coords[4]))+" "+Si(parseFloat(bi.coords[5])),Gi(xr+="]"),bi.matrix&&Gi("/Matrix ["+bi.matrix.toString()+"]"),Gi("/Function "+tr+" 0 R"),Gi("/Extend [true true]"),Gi(">>"),Gi("endobj")},Za=function(bi,Fi){var tr=Fn(),lr=yn();Fi.push({resourcesOid:tr,objectOid:lr}),bi.objectNumber=lr;var hr=[];hr.push({key:"Type",value:"/Pattern"}),hr.push({key:"PatternType",value:"1"}),hr.push({key:"PaintType",value:"1"}),hr.push({key:"TilingType",value:"1"}),hr.push({key:"BBox",value:"["+bi.boundingBox.map(Si).join(" ")+"]"}),hr.push({key:"XStep",value:Si(bi.xStep)}),hr.push({key:"YStep",value:Si(bi.yStep)}),hr.push({key:"Resources",value:tr+" 0 R"}),bi.matrix&&hr.push({key:"Matrix",value:"["+bi.matrix.toString()+"]"}),ls({data:bi.stream,additionalKeyValues:hr,objectId:bi.objectNumber}),Gi("endobj")},Sl=function(bi){for(var Fi in bi.objectNumber=yn(),Gi("<<"),bi)switch(Fi){case"opacity":Gi("/ca "+Ii(bi[Fi]));break;case"stroke-opacity":Gi("/CA "+Ii(bi[Fi]))}Gi(">>"),Gi("endobj")},co=function(bi){Ln(bi.resourcesOid,!0),Gi("<<"),Gi("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var Fi in Gi("/Font <<"),Vr)Vr.hasOwnProperty(Fi)&&(li===!1||li===!0&&ci.hasOwnProperty(Fi))&&Gi("/"+Fi+" "+Vr[Fi].objectNumber+" 0 R");Gi(">>")})(),(function(){if(Object.keys(Dr).length>0){for(var Fi in Gi("/Shading <<"),Dr)Dr.hasOwnProperty(Fi)&&Dr[Fi]instanceof M&&Dr[Fi].objectNumber>=0&&Gi("/"+Fi+" "+Dr[Fi].objectNumber+" 0 R");an.publish("putShadingPatternDict"),Gi(">>")}})(),(function(Fi){if(Object.keys(Dr).length>0){for(var tr in Gi("/Pattern <<"),Dr)Dr.hasOwnProperty(tr)&&Dr[tr]instanceof ui.TilingPattern&&Dr[tr].objectNumber>=0&&Dr[tr].objectNumber<Fi&&Gi("/"+tr+" "+Dr[tr].objectNumber+" 0 R");an.publish("putTilingPatternDict"),Gi(">>")}})(bi.objectOid),(function(){if(Object.keys(jr).length>0){var Fi;for(Fi in Gi("/ExtGState <<"),jr)jr.hasOwnProperty(Fi)&&jr[Fi].objectNumber>=0&&Gi("/"+Fi+" "+jr[Fi].objectNumber+" 0 R");an.publish("putGStateDict"),Gi(">>")}})(),(function(){for(var Fi in Gi("/XObject <<"),Pn)Pn.hasOwnProperty(Fi)&&Pn[Fi].objectNumber>=0&&Gi("/"+Fi+" "+Pn[Fi].objectNumber+" 0 R");an.publish("putXobjectDict"),Gi(">>")})(),Gi(">>"),Gi("endobj")},Bo=function(bi){Xr[bi.fontName]=Xr[bi.fontName]||{},Xr[bi.fontName][bi.fontStyle]=bi.id},Uo=function(bi,Fi,tr,lr,hr){var xr={id:"F"+(Object.keys(Vr).length+1).toString(10),postScriptName:bi,fontName:Fi,fontStyle:tr,encoding:lr,isStandardFont:hr||!1,metadata:{}};return an.publish("addFont",{font:xr,instance:this}),Vr[xr.id]=xr,Bo(xr),xr.id},Os=ui.__private__.pdfEscape=ui.pdfEscape=function(bi,Fi){return(function(tr,lr){var hr,xr,Lr,Yr,Jr,cn,fn,Cn,Bn;if(Lr=(lr=lr||{}).sourceEncoding||"Unicode",Jr=lr.outputEncoding,(lr.autoencode||Jr)&&Vr[Sr].metadata&&Vr[Sr].metadata[Lr]&&Vr[Sr].metadata[Lr].encoding&&(Yr=Vr[Sr].metadata[Lr].encoding,!Jr&&Vr[Sr].encoding&&(Jr=Vr[Sr].encoding),!Jr&&Yr.codePages&&(Jr=Yr.codePages[0]),typeof Jr=="string"&&(Jr=Yr[Jr]),Jr)){for(fn=!1,cn=[],hr=0,xr=tr.length;hr<xr;hr++)(Cn=Jr[tr.charCodeAt(hr)])?cn.push(String.fromCharCode(Cn)):cn.push(tr[hr]),cn[hr].charCodeAt(0)>>8&&(fn=!0);tr=cn.join("")}for(hr=tr.length;fn===void 0&&hr!==0;)tr.charCodeAt(hr-1)>>8&&(fn=!0),hr--;if(!fn)return tr;for(cn=lr.noBOM?[]:[254,255],hr=0,xr=tr.length;hr<xr;hr++){if((Bn=(Cn=tr.charCodeAt(hr))>>8)>>8)throw new Error("Character at position "+hr+" of string '"+tr+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");cn.push(Bn),cn.push(Cn-(Bn<<8))}return String.fromCharCode.apply(void 0,cn)})(bi,Fi).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},uo=ui.__private__.beginPage=function(bi){Zi[++sn]=[],Wr[sn]={objId:0,contentsObjId:0,userUnit:Number(ni),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(bi[0]),topRightY:Number(bi[1])}},$o(sn),pr(Zi[ki])},jo=function(bi,Fi){var tr,lr,hr;switch(n=Fi||n,typeof bi=="string"&&(tr=pi(bi.toLowerCase()),Array.isArray(tr)&&(lr=tr[0],hr=tr[1])),Array.isArray(bi)&&(lr=bi[0]*Gr,hr=bi[1]*Gr),isNaN(lr)&&(lr=ti[0],hr=ti[1]),(lr>14400||hr>14400)&&(o.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),lr=Math.min(14400,lr),hr=Math.min(14400,hr)),ti=[lr,hr],n.substr(0,1)){case"l":hr>lr&&(ti=[hr,lr]);break;case"p":lr>hr&&(ti=[hr,lr])}uo(ti),dn(po),Gi(to),mo!==0&&Gi(mo+" J"),yo!==0&&Gi(yo+" j"),an.publish("addPage",{pageNumber:sn})},ho=function(bi){bi>0&&bi<=sn&&(Zi.splice(bi,1),Wr.splice(bi,1),sn--,ki>sn&&(ki=sn),this.setPage(ki))},$o=function(bi){bi>0&&bi<=sn&&(ki=bi)},Ho=ui.__private__.getNumberOfPages=ui.getNumberOfPages=function(){return Zi.length-1},Wo=function(bi,Fi,tr){var lr,hr=void 0;return tr=tr||{},bi=bi!==void 0?bi:Vr[Sr].fontName,Fi=Fi!==void 0?Fi:Vr[Sr].fontStyle,lr=bi.toLowerCase(),Xr[lr]!==void 0&&Xr[lr][Fi]!==void 0?hr=Xr[lr][Fi]:Xr[bi]!==void 0&&Xr[bi][Fi]!==void 0?hr=Xr[bi][Fi]:tr.disableWarning===!1&&o.warn("Unable to look up font label for font '"+bi+"', '"+Fi+"'. Refer to getFontList() for available fonts."),hr||tr.noFallback||(hr=Xr.times[Fi])==null&&(hr=Xr.times.normal),hr},Ys=ui.__private__.putInfo=function(){var bi=yn(),Fi=function(lr){return lr};for(var tr in oi!==null&&(Fi=es.encryptor(bi,0)),Gi("<<"),Gi("/Producer ("+Os(Fi("jsPDF "+E.version))+")"),Rr)Rr.hasOwnProperty(tr)&&Rr[tr]&&Gi("/"+tr.substr(0,1).toUpperCase()+tr.substr(1)+" ("+Os(Fi(Rr[tr]))+")");Gi("/CreationDate ("+Os(Fi($i))+")"),Gi(">>"),Gi("endobj")},Ja=ui.__private__.putCatalog=function(bi){var Fi=(bi=bi||{}).rootDictionaryObjId||_s;switch(yn(),Gi("<<"),Gi("/Type /Catalog"),Gi("/Pages "+Fi+" 0 R"),Mr||(Mr="fullwidth"),Mr){case"fullwidth":Gi("/OpenAction [3 0 R /FitH null]");break;case"fullheight":Gi("/OpenAction [3 0 R /FitV null]");break;case"fullpage":Gi("/OpenAction [3 0 R /Fit]");break;case"original":Gi("/OpenAction [3 0 R /XYZ null null 1]");break;default:var tr=""+Mr;tr.substr(tr.length-1)==="%"&&(Mr=parseInt(Mr)/100),typeof Mr=="number"&&Gi("/OpenAction [3 0 R /XYZ null null "+Ii(Mr)+"]")}switch(_r||(_r="continuous"),_r){case"continuous":Gi("/PageLayout /OneColumn");break;case"single":Gi("/PageLayout /SinglePage");break;case"two":case"twoleft":Gi("/PageLayout /TwoColumnLeft");break;case"tworight":Gi("/PageLayout /TwoColumnRight")}or&&Gi("/PageMode /"+or),an.publish("putCatalog"),Gi(">>"),Gi("endobj")},Il=ui.__private__.putTrailer=function(){Gi("trailer"),Gi("<<"),Gi("/Size "+(Ui+1)),Gi("/Root "+Ui+" 0 R"),Gi("/Info "+(Ui-1)+" 0 R"),oi!==null&&Gi("/Encrypt "+es.oid+" 0 R"),Gi("/ID [ <"+Ki+"> <"+Ki+"> ]"),Gi(">>")},Vn=ui.__private__.putHeader=function(){Gi("%PDF-"+di),Gi("%")},zo=ui.__private__.putXRef=function(){var bi="0000000000";Gi("xref"),Gi("0 "+(Ui+1)),Gi("0000000000 65535 f ");for(var Fi=1;Fi<=Ui;Fi++)typeof Yi[Fi]=="function"?Gi((bi+Yi[Fi]()).slice(-10)+" 00000 n "):Yi[Fi]!==void 0?Gi((bi+Yi[Fi]).slice(-10)+" 00000 n "):Gi("0000000000 00000 n ")},Xs=ui.__private__.buildDocument=function(){var bi;Ui=0,cr=0,sr=[],Yi=[],ir=[],_s=Fn(),Cs=Fn(),pr(sr),an.publish("buildDocument"),Vn(),Vs(),(function(){an.publish("putAdditionalObjects");for(var tr=0;tr<ir.length;tr++){var lr=ir[tr];Ln(lr.objId,!0),Gi(lr.content),Gi("endobj")}an.publish("postPutAdditionalObjects")})(),bi=[],(function(){for(var tr in Vr)Vr.hasOwnProperty(tr)&&(li===!1||li===!0&&ci.hasOwnProperty(tr))&&ka(Vr[tr])})(),(function(){var tr;for(tr in jr)jr.hasOwnProperty(tr)&&Sl(jr[tr])})(),(function(){for(var tr in Pn)Pn.hasOwnProperty(tr)&&Xa(Pn[tr])})(),(function(tr){var lr;for(lr in Dr)Dr.hasOwnProperty(lr)&&(Dr[lr]instanceof M?Ka(Dr[lr]):Dr[lr]instanceof q&&Za(Dr[lr],tr))})(bi),an.publish("putResources"),bi.forEach(co),co({resourcesOid:Cs,objectOid:Number.MAX_SAFE_INTEGER}),an.publish("postPutResources"),oi!==null&&(es.oid=yn(),Gi("<<"),Gi("/Filter /Standard"),Gi("/V "+es.v),Gi("/R "+es.r),Gi("/U <"+es.toHexString(es.U)+">"),Gi("/O <"+es.toHexString(es.O)+">"),Gi("/P "+es.P),Gi(">>"),Gi("endobj")),Ys(),Ja();var Fi=cr;return zo(),Il(),Gi("startxref"),Gi(""+Fi),Gi("%%EOF"),pr(Zi[ki]),sr.join(`
`)},Qa=ui.__private__.getBlob=function(bi){return new Blob([Br(bi)],{type:"application/pdf"})},qo=ui.output=ui.__private__.output=(bn=function(bi,Fi){switch(typeof(Fi=Fi||{})=="string"?Fi={filename:Fi}:Fi.filename=Fi.filename||"generated.pdf",bi){case void 0:return Xs();case"save":ui.save(Fi.filename);break;case"arraybuffer":return Br(Xs());case"blob":return Qa(Xs());case"bloburi":case"bloburl":if(i.URL!==void 0&&typeof i.URL.createObjectURL=="function")return i.URL&&i.URL.createObjectURL(Qa(Xs()))||void 0;o.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var tr="",lr=Xs();try{tr=d(lr)}catch{tr=d(unescape(encodeURIComponent(lr)))}return"data:application/pdf;filename="+Fi.filename+";base64,"+tr;case"pdfobjectnewwindow":if(Object.prototype.toString.call(i)==="[object Window]"){var hr="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",xr=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';Fi.pdfObjectUrl&&(hr=Fi.pdfObjectUrl,xr="");var Lr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+hr+'"'+xr+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(Fi)+");<\/script></body></html>",Yr=i.open();return Yr!==null&&Yr.document.write(Lr),Yr}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(i)==="[object Window]"){var Jr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(Fi.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+Fi.filename+'" width="500px" height="400px" /></body></html>',cn=i.open();if(cn!==null){cn.document.write(Jr);var fn=this;cn.document.documentElement.querySelector("#pdfViewer").onload=function(){cn.document.title=Fi.filename,cn.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(fn.output("bloburl"))}}return cn}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(i)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Cn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",Fi)+'"></iframe></body></html>',Bn=i.open();if(Bn!==null&&(Bn.document.write(Cn),Bn.document.title=Fi.filename),Bn||typeof safari>"u")return Bn;break;case"datauri":case"dataurl":return i.document.location.href=this.output("datauristring",Fi);default:return null}},bn.foo=function(){try{return bn.apply(this,arguments)}catch(tr){var bi=tr.stack||"";~bi.indexOf(" at ")&&(bi=bi.split(" at ")[1]);var Fi="Error in function "+bi.split(`
`)[0].split("<")[0]+": "+tr.message;if(!i.console)throw new Error(Fi);i.console.error(Fi,tr),i.alert&&alert(Fi)}},bn.foo.bar=bn,bn.foo),Ds=function(bi){return Array.isArray(En)===!0&&En.indexOf(bi)>-1};switch(ei){case"pt":Gr=1;break;case"mm":Gr=72/25.4;break;case"cm":Gr=72/2.54;break;case"in":Gr=72;break;case"px":Gr=Ds("px_scaling")==1?.75:96/72;break;case"pc":case"em":Gr=12;break;case"ex":Gr=6;break;default:if(typeof ei!="number")throw new Error("Invalid unit: "+ei);Gr=ei}var es=null;Wi(),Vi();var ta=ui.__private__.getPageInfo=ui.getPageInfo=function(bi){if(isNaN(bi)||bi%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Wr[bi].objId,pageNumber:bi,pageContext:Wr[bi]}},Vo=ui.__private__.getPageInfoByObjId=function(bi){if(isNaN(bi)||bi%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var Fi in Wr)if(Wr[Fi].objId===bi)break;return ta(Fi)},wl=ui.__private__.getCurrentPageInfo=ui.getCurrentPageInfo=function(){return{objId:Wr[ki].objId,pageNumber:ki,pageContext:Wr[ki]}};ui.addPage=function(){return jo.apply(this,arguments),this},ui.setPage=function(){return $o.apply(this,arguments),pr.call(this,Zi[ki]),this},ui.insertPage=function(bi){return this.addPage(),this.movePage(ki,bi),this},ui.movePage=function(bi,Fi){var tr,lr;if(bi>Fi){tr=Zi[bi],lr=Wr[bi];for(var hr=bi;hr>Fi;hr--)Zi[hr]=Zi[hr-1],Wr[hr]=Wr[hr-1];Zi[Fi]=tr,Wr[Fi]=lr,this.setPage(Fi)}else if(bi<Fi){tr=Zi[bi],lr=Wr[bi];for(var xr=bi;xr<Fi;xr++)Zi[xr]=Zi[xr+1],Wr[xr]=Wr[xr+1];Zi[Fi]=tr,Wr[Fi]=lr,this.setPage(Fi)}return this},ui.deletePage=function(){return ho.apply(this,arguments),this},ui.__private__.text=ui.text=function(bi,Fi,tr,lr,hr){var xr,Lr,Yr,Jr,cn,fn,Cn,Bn,Kn,Nn=(lr=lr||{}).scope||this;if(typeof bi=="number"&&typeof Fi=="number"&&(typeof tr=="string"||Array.isArray(tr))){var ts=tr;tr=Fi,Fi=bi,bi=ts}if(arguments[3]instanceof Ur==0?(Yr=arguments[4],Jr=arguments[5],_typeof(Cn=arguments[3])==="object"&&Cn!==null||(typeof Yr=="string"&&(Jr=Yr,Yr=null),typeof Cn=="string"&&(Jr=Cn,Cn=null),typeof Cn=="number"&&(Yr=Cn,Cn=null),lr={flags:Cn,angle:Yr,align:Jr})):(wi("The transform parameter of text() with a Matrix value"),Kn=hr),isNaN(Fi)||isNaN(tr)||bi==null)throw new Error("Invalid arguments passed to jsPDF.text");if(bi.length===0)return Nn;var Jn,cs="",la=typeof lr.lineHeightFactor=="number"?lr.lineHeightFactor:Da,Hs=Nn.internal.scaleFactor;function ca(Sn){return Sn=Sn.split("	").join(Array(lr.TabLen||9).join(" ")),Os(Sn,Cn)}function Ao(Sn){for(var Rn,Wn=Sn.concat(),is=[],fa=Wn.length;fa--;)typeof(Rn=Wn.shift())=="string"?is.push(Rn):Array.isArray(Sn)&&(Rn.length===1||Rn[1]===void 0&&Rn[2]===void 0)?is.push(Rn[0]):is.push([Rn[0],Rn[1],Rn[2]]);return is}function ro(Sn,Rn){var Wn;if(typeof Sn=="string")Wn=Rn(Sn)[0];else if(Array.isArray(Sn)){for(var is,fa,Ro=Sn.concat(),ao=[],nl=Ro.length;nl--;)typeof(is=Ro.shift())=="string"?ao.push(Rn(is)[0]):Array.isArray(is)&&typeof is[0]=="string"&&(fa=Rn(is[0],is[1],is[2]),ao.push([fa[0],fa[1],fa[2]]));Wn=ao}return Wn}var ya=!1,Ua=!0;if(typeof bi=="string")ya=!0;else if(Array.isArray(bi)){var ja=bi.concat();Lr=[];for(var va,us=ja.length;us--;)(typeof(va=ja.shift())!="string"||Array.isArray(va)&&typeof va[0]!="string")&&(Ua=!1);ya=Ua}if(ya===!1)throw new Error('Type of text must be string or Array. "'+bi+'" is not recognized.');typeof bi=="string"&&(bi=bi.match(/[\r?\n]/)?bi.split(/\r\n|\r|\n/g):[bi]);var $a=mr/Nn.internal.scaleFactor,Ha=$a*(la-1);switch(lr.baseline){case"bottom":tr-=Ha;break;case"top":tr+=$a-Ha;break;case"hanging":tr+=$a-2*Ha;break;case"middle":tr+=$a/2-Ha}if((fn=lr.maxWidth||0)>0&&(typeof bi=="string"?bi=Nn.splitTextToSize(bi,fn):Object.prototype.toString.call(bi)==="[object Array]"&&(bi=bi.reduce(function(Sn,Rn){return Sn.concat(Nn.splitTextToSize(Rn,fn))},[]))),xr={text:bi,x:Fi,y:tr,options:lr,mutex:{pdfEscape:Os,activeFontKey:Sr,fonts:Vr,activeFontSize:mr}},an.publish("preProcessText",xr),bi=xr.text,Yr=(lr=xr.options).angle,Kn instanceof Ur==0&&Yr&&typeof Yr=="number"){Yr*=Math.PI/180,lr.rotationDirection===0&&(Yr=-Yr),yi===vi&&(Yr=-Yr);var Eo=Math.cos(Yr),bo=Math.sin(Yr);Kn=new Ur(Eo,bo,-bo,Eo,0,0)}else Yr&&Yr instanceof Ur&&(Kn=Yr);yi!==vi||Kn||(Kn=$n),(cn=lr.charSpace||na)!==void 0&&(cs+=Si(Di(cn))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Bn=lr.horizontalScale)!==void 0&&(cs+=Si(100*Bn)+` Tz
`),lr.lang;var gs=-1,da=lr.renderingMode!==void 0?lr.renderingMode:lr.stroke,no=Nn.internal.getCurrentPageInfo().pageContext;switch(da){case 0:case!1:case"fill":gs=0;break;case 1:case!0:case"stroke":gs=1;break;case 2:case"fillThenStroke":gs=2;break;case 3:case"invisible":gs=3;break;case 4:case"fillAndAddForClipping":gs=4;break;case 5:case"strokeAndAddPathForClipping":gs=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":gs=6;break;case 7:case"addToPathForClipping":gs=7}var il=no.usedRenderingMode!==void 0?no.usedRenderingMode:-1;gs!==-1?cs+=gs+` Tr
`:il!==-1&&(cs+=`0 Tr
`),gs!==-1&&(no.usedRenderingMode=gs),Jr=lr.align||"left";var Gs,Wa=mr*la,So=Nn.internal.pageSize.getWidth(),Io=Vr[Sr];cn=lr.charSpace||na,fn=lr.maxWidth||0,Cn=Object.assign({autoencode:!0,noBOM:!0},lr.flags);var Ca=[],za=function(Sn){return Nn.getStringUnitWidth(Sn,{font:Io,charSpace:cn,fontSize:mr,doKerning:!1})*mr/Hs};if(Object.prototype.toString.call(bi)==="[object Array]"){var ws;Lr=Ao(bi),Jr!=="left"&&(Gs=Lr.map(za));var xs,Aa=0;if(Jr==="right"){Fi-=Gs[0],bi=[],us=Lr.length;for(var ha=0;ha<us;ha++)ha===0?(xs=ia(Fi),ws=ra(tr)):(xs=Di(Aa-Gs[ha]),ws=-Wa),bi.push([Lr[ha],xs,ws]),Aa=Gs[ha]}else if(Jr==="center"){Fi-=Gs[0]/2,bi=[],us=Lr.length;for(var Ea=0;Ea<us;Ea++)Ea===0?(xs=ia(Fi),ws=ra(tr)):(xs=Di((Aa-Gs[Ea])/2),ws=-Wa),bi.push([Lr[Ea],xs,ws]),Aa=Gs[Ea]}else if(Jr==="left"){bi=[],us=Lr.length;for(var wo=0;wo<us;wo++)bi.push(Lr[wo])}else if(Jr==="justify"&&Io.encoding==="Identity-H"){bi=[],us=Lr.length,fn=fn!==0?fn:So;for(var so=0,Hn=0;Hn<us;Hn++)if(ws=Hn===0?ra(tr):-Wa,xs=Hn===0?ia(Fi):so,Hn<us-1){var rl=Di((fn-Gs[Hn])/(Lr[Hn].split(" ").length-1)),Zs=Lr[Hn].split(" ");bi.push([Zs[0]+" ",xs,ws]),so=0;for(var Js=1;Js<Zs.length;Js++){var xo=(za(Zs[Js-1]+" "+Zs[Js])-za(Zs[Js]))*Hs+rl;Js==Zs.length-1?bi.push([Zs[Js],xo,0]):bi.push([Zs[Js]+" ",xo,0]),so-=xo}}else bi.push([Lr[Hn],xs,ws]);bi.push(["",so,0])}else{if(Jr!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(bi=[],us=Lr.length,fn=fn!==0?fn:So,Hn=0;Hn<us;Hn++){ws=Hn===0?ra(tr):-Wa,xs=Hn===0?ia(Fi):0;var Po=Lr[Hn].split(" ").length-1,Lo=Po>0?(fn-Gs[Hn])/Po:0;Hn<us-1?Ca.push(Si(Di(Lo))):Ca.push(0),bi.push([Lr[Hn],xs,ws])}}}(typeof lr.R2L=="boolean"?lr.R2L:Fr)===!0&&(bi=ro(bi,function(Sn,Rn,Wn){return[Sn.split("").reverse().join(""),Rn,Wn]})),xr={text:bi,x:Fi,y:tr,options:lr,mutex:{pdfEscape:Os,activeFontKey:Sr,fonts:Vr,activeFontSize:mr}},an.publish("postProcessText",xr),bi=xr.text,Jn=xr.mutex.isHex||!1;var To=Vr[Sr].encoding;To!=="WinAnsiEncoding"&&To!=="StandardEncoding"||(bi=ro(bi,function(Sn,Rn,Wn){return[ca(Sn),Rn,Wn]})),Lr=Ao(bi),bi=[];for(var ba,Sa,Ia,qa=Array.isArray(Lr[0])?1:0,wa="",Va=function(Sn,Rn,Wn){var is="";return Wn instanceof Ur?(Wn=typeof lr.angle=="number"?Tn(Wn,new Ur(1,0,0,1,Sn,Rn)):Tn(new Ur(1,0,0,1,Sn,Rn),Wn),yi===vi&&(Wn=Tn(new Ur(1,0,0,-1,0,0),Wn)),is=Wn.join(" ")+` Tm
`):is=Si(Sn)+" "+Si(Rn)+` Td
`,is},Fs=0;Fs<Lr.length;Fs++){switch(wa="",qa){case 1:Ia=(Jn?"<":"(")+Lr[Fs][0]+(Jn?">":")"),ba=parseFloat(Lr[Fs][1]),Sa=parseFloat(Lr[Fs][2]);break;case 0:Ia=(Jn?"<":"(")+Lr[Fs]+(Jn?">":")"),ba=ia(Fi),Sa=ra(tr)}Ca!==void 0&&Ca[Fs]!==void 0&&(wa=Ca[Fs]+` Tw
`),Fs===0?bi.push(wa+Va(ba,Sa,Kn)+Ia):qa===0?bi.push(wa+Ia):qa===1&&bi.push(wa+Va(ba,Sa,Kn)+Ia)}bi=qa===0?bi.join(` Tj
T* `):bi.join(` Tj
`),bi+=` Tj
`;var Qs=`BT
/`;return Qs+=Sr+" "+mr+` Tf
`,Qs+=Si(mr*la)+` TL
`,Qs+=Ga+`
`,Qs+=cs,Qs+=bi,Gi(Qs+="ET"),ci[Sr]=!0,Nn};var xl=ui.__private__.clip=ui.clip=function(bi){return Gi(bi==="evenodd"?"W*":"W"),this};ui.clipEvenOdd=function(){return xl("evenodd")},ui.__private__.discardPath=ui.discardPath=function(){return Gi("n"),this};var Ks=ui.__private__.isValidStyle=function(bi){var Fi=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(bi)!==-1&&(Fi=!0),Fi};ui.__private__.setDefaultPathOperation=ui.setDefaultPathOperation=function(bi){return Ks(bi)&&(ai=bi),this};var Yo=ui.__private__.getStyle=ui.getStyle=function(bi){var Fi=ai;switch(bi){case"D":case"S":Fi="S";break;case"F":Fi="f";break;case"FD":case"DF":Fi="B";break;case"f":case"f*":case"B":case"B*":Fi=bi}return Fi},Xo=ui.close=function(){return Gi("h"),this};ui.stroke=function(){return Gi("S"),this},ui.fill=function(bi){return eo("f",bi),this},ui.fillEvenOdd=function(bi){return eo("f*",bi),this},ui.fillStroke=function(bi){return eo("B",bi),this},ui.fillStrokeEvenOdd=function(bi){return eo("B*",bi),this};var eo=function(bi,Fi){_typeof(Fi)==="object"?Ll(Fi,bi):Gi(bi)},Oa=function(bi){bi===null||yi===vi&&bi===void 0||(bi=Yo(bi),Gi(bi))};function Pl(bi,Fi,tr,lr,hr){var xr=new q(Fi||this.boundingBox,tr||this.xStep,lr||this.yStep,this.gState,hr||this.matrix);xr.stream=this.stream;var Lr=bi+"$$"+this.cloneIndex+++"$$";return mn(Lr,xr),xr}var Ll=function(bi,Fi){var tr=rn[bi.key],lr=Dr[tr];if(lr instanceof M)Gi("q"),Gi(Tl(Fi)),lr.gState&&ui.setGState(lr.gState),Gi(bi.matrix.toString()+" cm"),Gi("/"+tr+" sh"),Gi("Q");else if(lr instanceof q){var hr=new Ur(1,0,0,-1,0,Ba());bi.matrix&&(hr=hr.multiply(bi.matrix||$n),tr=Pl.call(lr,bi.key,bi.boundingBox,bi.xStep,bi.yStep,hr).id),Gi("q"),Gi("/Pattern cs"),Gi("/"+tr+" scn"),lr.gState&&ui.setGState(lr.gState),Gi(Fi),Gi("Q")}},Tl=function(bi){switch(bi){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},fo=ui.moveTo=function(bi,Fi){return Gi(Si(Di(bi))+" "+Si(Ni(Fi))+" m"),this},Ko=ui.lineTo=function(bi,Fi){return Gi(Si(Di(bi))+" "+Si(Ni(Fi))+" l"),this},$s=ui.curveTo=function(bi,Fi,tr,lr,hr,xr){return Gi([Si(Di(bi)),Si(Ni(Fi)),Si(Di(tr)),Si(Ni(lr)),Si(Di(hr)),Si(Ni(xr)),"c"].join(" ")),this};ui.__private__.line=ui.line=function(bi,Fi,tr,lr,hr){if(isNaN(bi)||isNaN(Fi)||isNaN(tr)||isNaN(lr)||!Ks(hr))throw new Error("Invalid arguments passed to jsPDF.line");return yi===gi?this.lines([[tr-bi,lr-Fi]],bi,Fi,[1,1],hr||"S"):this.lines([[tr-bi,lr-Fi]],bi,Fi,[1,1]).stroke()},ui.__private__.lines=ui.lines=function(bi,Fi,tr,lr,hr,xr){var Lr,Yr,Jr,cn,fn,Cn,Bn,Kn,Nn,ts,Jn,cs;if(typeof bi=="number"&&(cs=tr,tr=Fi,Fi=bi,bi=cs),lr=lr||[1,1],xr=xr||!1,isNaN(Fi)||isNaN(tr)||!Array.isArray(bi)||!Array.isArray(lr)||!Ks(hr)||typeof xr!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(fo(Fi,tr),Lr=lr[0],Yr=lr[1],cn=bi.length,ts=Fi,Jn=tr,Jr=0;Jr<cn;Jr++)(fn=bi[Jr]).length===2?(ts=fn[0]*Lr+ts,Jn=fn[1]*Yr+Jn,Ko(ts,Jn)):(Cn=fn[0]*Lr+ts,Bn=fn[1]*Yr+Jn,Kn=fn[2]*Lr+ts,Nn=fn[3]*Yr+Jn,ts=fn[4]*Lr+ts,Jn=fn[5]*Yr+Jn,$s(Cn,Bn,Kn,Nn,ts,Jn));return xr&&Xo(),Oa(hr),this},ui.path=function(bi){for(var Fi=0;Fi<bi.length;Fi++){var tr=bi[Fi],lr=tr.c;switch(tr.op){case"m":fo(lr[0],lr[1]);break;case"l":Ko(lr[0],lr[1]);break;case"c":$s.apply(this,lr);break;case"h":Xo()}}return this},ui.__private__.rect=ui.rect=function(bi,Fi,tr,lr,hr){if(isNaN(bi)||isNaN(Fi)||isNaN(tr)||isNaN(lr)||!Ks(hr))throw new Error("Invalid arguments passed to jsPDF.rect");return yi===gi&&(lr=-lr),Gi([Si(Di(bi)),Si(Ni(Fi)),Si(Di(tr)),Si(Di(lr)),"re"].join(" ")),Oa(hr),this},ui.__private__.triangle=ui.triangle=function(bi,Fi,tr,lr,hr,xr,Lr){if(isNaN(bi)||isNaN(Fi)||isNaN(tr)||isNaN(lr)||isNaN(hr)||isNaN(xr)||!Ks(Lr))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[tr-bi,lr-Fi],[hr-tr,xr-lr],[bi-hr,Fi-xr]],bi,Fi,[1,1],Lr,!0),this},ui.__private__.roundedRect=ui.roundedRect=function(bi,Fi,tr,lr,hr,xr,Lr){if(isNaN(bi)||isNaN(Fi)||isNaN(tr)||isNaN(lr)||isNaN(hr)||isNaN(xr)||!Ks(Lr))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Yr=4/3*(Math.SQRT2-1);return hr=Math.min(hr,.5*tr),xr=Math.min(xr,.5*lr),this.lines([[tr-2*hr,0],[hr*Yr,0,hr,xr-xr*Yr,hr,xr],[0,lr-2*xr],[0,xr*Yr,-hr*Yr,xr,-hr,xr],[2*hr-tr,0],[-hr*Yr,0,-hr,-xr*Yr,-hr,-xr],[0,2*xr-lr],[0,-xr*Yr,hr*Yr,-xr,hr,-xr]],bi+hr,Fi,[1,1],Lr,!0),this},ui.__private__.ellipse=ui.ellipse=function(bi,Fi,tr,lr,hr){if(isNaN(bi)||isNaN(Fi)||isNaN(tr)||isNaN(lr)||!Ks(hr))throw new Error("Invalid arguments passed to jsPDF.ellipse");var xr=4/3*(Math.SQRT2-1)*tr,Lr=4/3*(Math.SQRT2-1)*lr;return fo(bi+tr,Fi),$s(bi+tr,Fi-Lr,bi+xr,Fi-lr,bi,Fi-lr),$s(bi-xr,Fi-lr,bi-tr,Fi-Lr,bi-tr,Fi),$s(bi-tr,Fi+Lr,bi-xr,Fi+lr,bi,Fi+lr),$s(bi+xr,Fi+lr,bi+tr,Fi+Lr,bi+tr,Fi),Oa(hr),this},ui.__private__.circle=ui.circle=function(bi,Fi,tr,lr){if(isNaN(bi)||isNaN(Fi)||isNaN(tr)||!Ks(lr))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(bi,Fi,tr,tr,lr)},ui.setFont=function(bi,Fi,tr){return tr&&(Fi=Ei(Fi,tr)),Sr=Wo(bi,Fi,{disableWarning:!1}),this};var Rl=ui.__private__.getFont=ui.getFont=function(){return Vr[Wo.apply(ui,arguments)]};ui.__private__.getFontList=ui.getFontList=function(){var bi,Fi,tr={};for(bi in Xr)if(Xr.hasOwnProperty(bi))for(Fi in tr[bi]=[],Xr[bi])Xr[bi].hasOwnProperty(Fi)&&tr[bi].push(Fi);return tr},ui.addFont=function(bi,Fi,tr,lr,hr){var xr=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&xr.indexOf(arguments[3])!==-1?hr=arguments[3]:arguments[3]&&xr.indexOf(arguments[3])==-1&&(tr=Ei(tr,lr)),Uo.call(this,bi,Fi,tr,hr=hr||"Identity-H")};var Da,po=_t.lineWidth||.200025,Ml=ui.__private__.getLineWidth=ui.getLineWidth=function(){return po},dn=ui.__private__.setLineWidth=ui.setLineWidth=function(bi){return po=bi,Gi(Si(Di(bi))+" w"),this};ui.__private__.setLineDash=E.API.setLineDash=E.API.setLineDashPattern=function(bi,Fi){if(bi=bi||[],Fi=Fi||0,isNaN(Fi)||!Array.isArray(bi))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return bi=bi.map(function(tr){return Si(Di(tr))}).join(" "),Fi=Si(Di(Fi)),Gi("["+bi+"] "+Fi+" d"),this};var Nl=ui.__private__.getLineHeight=ui.getLineHeight=function(){return mr*Da};ui.__private__.getLineHeight=ui.getLineHeight=function(){return mr*Da};var kl=ui.__private__.setLineHeightFactor=ui.setLineHeightFactor=function(bi){return typeof(bi=bi||1.15)=="number"&&(Da=bi),this},Ol=ui.__private__.getLineHeightFactor=ui.getLineHeightFactor=function(){return Da};kl(_t.lineHeight);var ia=ui.__private__.getHorizontalCoordinate=function(bi){return Di(bi)},ra=ui.__private__.getVerticalCoordinate=function(bi){return yi===vi?bi:Wr[ki].mediaBox.topRightY-Wr[ki].mediaBox.bottomLeftY-Di(bi)},Dl=ui.__private__.getHorizontalCoordinateString=ui.getHorizontalCoordinateString=function(bi){return Si(ia(bi))},Gl=ui.__private__.getVerticalCoordinateString=ui.getVerticalCoordinateString=function(bi){return Si(ra(bi))},to=_t.strokeColor||"0 G";ui.__private__.getStrokeColor=ui.getDrawColor=function(){return ks(to)},ui.__private__.setStrokeColor=ui.setDrawColor=function(bi,Fi,tr,lr){return to=As({ch1:bi,ch2:Fi,ch3:tr,ch4:lr,pdfColorType:"draw",precision:2}),Gi(to),this};var go=_t.fillColor||"0 g";ui.__private__.getFillColor=ui.getFillColor=function(){return ks(go)},ui.__private__.setFillColor=ui.setFillColor=function(bi,Fi,tr,lr){return go=As({ch1:bi,ch2:Fi,ch3:tr,ch4:lr,pdfColorType:"fill",precision:2}),Gi(go),this};var Ga=_t.textColor||"0 g",Fl=ui.__private__.getTextColor=ui.getTextColor=function(){return ks(Ga)};ui.__private__.setTextColor=ui.setTextColor=function(bi,Fi,tr,lr){return Ga=As({ch1:bi,ch2:Fi,ch3:tr,ch4:lr,pdfColorType:"text",precision:3}),this};var na=_t.charSpace,Bl=ui.__private__.getCharSpace=ui.getCharSpace=function(){return parseFloat(na||0)};ui.__private__.setCharSpace=ui.setCharSpace=function(bi){if(isNaN(bi))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return na=bi,this};var mo=0;ui.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},ui.__private__.setLineCap=ui.setLineCap=function(bi){var Fi=ui.CapJoinStyles[bi];if(Fi===void 0)throw new Error("Line cap style of '"+bi+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return mo=Fi,Gi(Fi+" J"),this};var yo=0;ui.__private__.setLineJoin=ui.setLineJoin=function(bi){var Fi=ui.CapJoinStyles[bi];if(Fi===void 0)throw new Error("Line join style of '"+bi+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return yo=Fi,Gi(Fi+" j"),this},ui.__private__.setLineMiterLimit=ui.__private__.setMiterLimit=ui.setLineMiterLimit=ui.setMiterLimit=function(bi){if(bi=bi||0,isNaN(bi))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return Gi(Si(Di(bi))+" M"),this},ui.GState=O,ui.setGState=function(bi){(bi=typeof bi=="string"?jr[$r[bi]]:Zo(null,bi)).equals(un)||(Gi("/"+bi.id+" gs"),un=bi)};var Zo=function(bi,Fi){if(!bi||!$r[bi]){var tr=!1;for(var lr in jr)if(jr.hasOwnProperty(lr)&&jr[lr].equals(Fi)){tr=!0;break}if(tr)Fi=jr[lr];else{var hr="GS"+(Object.keys(jr).length+1).toString(10);jr[hr]=Fi,Fi.id=hr}return bi&&($r[bi]=Fi.id),an.publish("addGState",Fi),Fi}};ui.addGState=function(bi,Fi){return Zo(bi,Fi),this},ui.saveGraphicsState=function(){return Gi("q"),tn.push({key:Sr,size:mr,color:Ga}),this},ui.restoreGraphicsState=function(){Gi("Q");var bi=tn.pop();return Sr=bi.key,mr=bi.size,Ga=bi.color,un=null,this},ui.setCurrentTransformationMatrix=function(bi){return Gi(bi.toString()+" cm"),this},ui.comment=function(bi){return Gi("#"+bi),this};var sa=function(bi,Fi){var tr=bi||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return tr},set:function(xr){isNaN(xr)||(tr=parseFloat(xr))}});var lr=Fi||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return lr},set:function(xr){isNaN(xr)||(lr=parseFloat(xr))}});var hr="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return hr},set:function(xr){hr=xr.toString()}}),this},vo=function(bi,Fi,tr,lr){sa.call(this,bi,Fi),this.type="rect";var hr=tr||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return hr},set:function(Lr){isNaN(Lr)||(hr=parseFloat(Lr))}});var xr=lr||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return xr},set:function(Lr){isNaN(Lr)||(xr=parseFloat(Lr))}}),this},io=function(){this.page=sn,this.currentPage=ki,this.pages=Zi.slice(0),this.pagesContext=Wr.slice(0),this.x=Or,this.y=nn,this.matrix=en,this.width=Co(ki),this.height=Qo(ki),this.outputDestination=ar,this.id="",this.objectNumber=-1};io.prototype.restore=function(){sn=this.page,ki=this.currentPage,Wr=this.pagesContext,Zi=this.pages,Or=this.x,nn=this.y,en=this.matrix,Jo(ki,this.width),aa(ki,this.height),ar=this.outputDestination};var _o=function(bi,Fi,tr,lr,hr){Gn.push(new io),sn=ki=0,Zi=[],Or=bi,nn=Fi,en=hr,uo([tr,lr])};for(var Fa in ui.beginFormObject=function(bi,Fi,tr,lr,hr){return _o(bi,Fi,tr,lr,hr),this},ui.endFormObject=function(bi){return(function(Fi){if(Dn[Fi])Gn.pop().restore();else{var tr=new io,lr="Xo"+(Object.keys(Pn).length+1).toString(10);tr.id=lr,Dn[Fi]=lr,Pn[lr]=tr,an.publish("addFormObject",tr),Gn.pop().restore()}})(bi),this},ui.doFormObject=function(bi,Fi){var tr=Pn[Dn[bi]];return Gi("q"),Gi(Fi.toString()+" cm"),Gi("/"+tr.id+" Do"),Gi("Q"),this},ui.getFormObject=function(bi){var Fi=Pn[Dn[bi]];return{x:Fi.x,y:Fi.y,width:Fi.width,height:Fi.height,matrix:Fi.matrix}},ui.save=function(bi,Fi){return bi=bi||"generated.pdf",(Fi=Fi||{}).returnPromise=Fi.returnPromise||!1,Fi.returnPromise===!1?(l(Qa(Xs()),bi),typeof l.unload=="function"&&i.setTimeout&&setTimeout(l.unload,911),this):new Promise(function(tr,lr){try{var hr=l(Qa(Xs()),bi);typeof l.unload=="function"&&i.setTimeout&&setTimeout(l.unload,911),tr(hr)}catch(xr){lr(xr.message)}})},E.API)E.API.hasOwnProperty(Fa)&&(Fa==="events"&&E.API.events.length?(function(bi,Fi){var tr,lr,hr;for(hr=Fi.length-1;hr!==-1;hr--)tr=Fi[hr][0],lr=Fi[hr][1],bi.subscribe.apply(bi,[tr].concat(typeof lr=="function"?[lr]:lr))})(an,E.API.events):ui[Fa]=E.API[Fa]);function Co(bi){return Wr[bi].mediaBox.topRightX-Wr[bi].mediaBox.bottomLeftX}function Jo(bi,Fi){Wr[bi].mediaBox.topRightX=Fi+Wr[bi].mediaBox.bottomLeftX}function Qo(bi){return Wr[bi].mediaBox.topRightY-Wr[bi].mediaBox.bottomLeftY}function aa(bi,Fi){Wr[bi].mediaBox.topRightY=Fi+Wr[bi].mediaBox.bottomLeftY}var oa=ui.getPageWidth=function(bi){return Co(bi=bi||ki)/Gr},el=ui.setPageWidth=function(bi,Fi){Jo(bi,Fi*Gr)},Ba=ui.getPageHeight=function(bi){return Qo(bi=bi||ki)/Gr},tl=ui.setPageHeight=function(bi,Fi){aa(bi,Fi*Gr)};return ui.internal={pdfEscape:Os,getStyle:Yo,getFont:Rl,getFontSize:Er,getCharSpace:Bl,getTextColor:Fl,getLineHeight:Nl,getLineHeightFactor:Ol,getLineWidth:Ml,write:gr,getHorizontalCoordinate:ia,getVerticalCoordinate:ra,getCoordinateString:Dl,getVerticalCoordinateString:Gl,collections:{},newObject:yn,newAdditionalObject:Is,newObjectDeferred:Fn,newObjectDeferredBegin:Ln,getFilters:as,putStream:ls,events:an,scaleFactor:Gr,pageSize:{getWidth:function(){return oa(ki)},setWidth:function(bi){el(ki,bi)},getHeight:function(){return Ba(ki)},setHeight:function(bi){tl(ki,bi)}},encryptionOptions:oi,encryption:es,getEncryptor:function(bi){return oi!==null?es.encryptor(bi,0):function(Fi){return Fi}},output:qo,getNumberOfPages:Ho,get pages(){return Zi},out:Gi,f2:Ii,f3:Li,getPageInfo:ta,getPageInfoByObjId:Vo,getCurrentPageInfo:wl,getPDFVersion:fi,Point:sa,Rectangle:vo,Matrix:Ur,hasHotfix:Ds},Object.defineProperty(ui.internal.pageSize,"width",{get:function(){return oa(ki)},set:function(bi){el(ki,bi)},enumerable:!0,configurable:!0}),Object.defineProperty(ui.internal.pageSize,"height",{get:function(){return Ba(ki)},set:function(bi){tl(ki,bi)},enumerable:!0,configurable:!0}),(function(bi){for(var Fi=0,tr=Nr.length;Fi<tr;Fi++){var lr=Uo.call(this,bi[Fi][0],bi[Fi][1],bi[Fi][2],Nr[Fi][3],!0);li===!1&&(ci[lr]=!0);var hr=bi[Fi][0].split("-");Bo({id:lr,fontName:hr[0],fontStyle:hr[1]||""})}an.publish("addFonts",{fonts:Vr,dictionary:Xr})}).call(ui,Nr),Sr="F1",jo(ti,n),an.publish("initialized"),ui}I.prototype.lsbFirstWord=function(_t){return String.fromCharCode(255&_t,_t>>8&255,_t>>16&255,_t>>24&255)},I.prototype.toHexString=function(_t){return _t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},I.prototype.hexToBytes=function(_t){for(var e=[],n=0;n<_t.length;n+=2)e.push(String.fromCharCode(parseInt(_t.substr(n,2),16)));return e.join("")},I.prototype.processOwnerPassword=function(_t,e){return k(S(e).substr(0,5),_t)},I.prototype.encryptor=function(_t,e){var n=S(this.encryptionKey+String.fromCharCode(255&_t,_t>>8&255,_t>>16&255,255&e,e>>8&255)).substr(0,10);return function(ei){return k(n,ei)}},O.prototype.equals=function(_t){var e,n="id,objectNumber,equals";if(!_t||_typeof(_t)!==_typeof(this))return!1;var ei=0;for(e in this)if(!(n.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!_t.hasOwnProperty(e)||this[e]!==_t[e])return!1;ei++}for(e in _t)_t.hasOwnProperty(e)&&n.indexOf(e)<0&&ei--;return ei===0},E.API={events:[]},E.version="4.1.0";var R=E.API,D=1,T=function(_t){return _t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},z=function(_t){return _t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},U=function(_t){return _t.toString().replace(/#/g,"#23").replace(/[\s\n\r()<>[\]{}\/%]/g,function(e){var n=e.charCodeAt(0).toString(16).toUpperCase();return"#"+(n.length===1?"0"+n:n)})},H=function(_t){return _t.toFixed(2)},W=function(_t){return _t.toFixed(5)};R.__acroform__={};var V=function(_t,e){_t.prototype=Object.create(e.prototype),_t.prototype.constructor=_t},G=function(_t){return _t*D},Y=function(_t){var e=new lt,n=At.internal.getHeight(_t)||0,ei=At.internal.getWidth(_t)||0;return e.BBox=[0,0,Number(H(ei)),Number(H(n))],e},J=R.__acroform__.setBit=function(_t,e){if(_t=_t||0,e=e||0,isNaN(_t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return _t|1<<e},X=R.__acroform__.clearBit=function(_t,e){if(_t=_t||0,e=e||0,isNaN(_t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return _t&~(1<<e)},K=R.__acroform__.getBit=function(_t,e){if(isNaN(_t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return _t&1<<e?1:0},Z=R.__acroform__.getBitForPdf=function(_t,e){if(isNaN(_t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return K(_t,e-1)},$=R.__acroform__.setBitForPdf=function(_t,e){if(isNaN(_t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return J(_t,e-1)},Q=R.__acroform__.clearBitForPdf=function(_t,e){if(isNaN(_t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return X(_t,e-1)},tt=R.__acroform__.calculateCoordinates=function(_t,e){var n=e.internal.getHorizontalCoordinate,ei=e.internal.getVerticalCoordinate,ti=_t[0],ii=_t[1],ri=_t[2],ni=_t[3],si={};return si.lowerLeft_X=n(ti)||0,si.lowerLeft_Y=ei(ii+ni)||0,si.upperRight_X=n(ti+ri)||0,si.upperRight_Y=ei(ii)||0,[Number(H(si.lowerLeft_X)),Number(H(si.lowerLeft_Y)),Number(H(si.upperRight_X)),Number(H(si.upperRight_Y))]},et=function(_t){if(_t.appearanceStreamContent)return _t.appearanceStreamContent;if(_t.V||_t.DV){var e=[],n=_t._V||_t.DV,ei=rt(_t,n),ti=_t.scope.internal.getFont(_t.fontName,_t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(_t.scope.__private__.encodeColorString(_t.color)),e.push("/"+ti+" "+H(ei.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(ei.text),e.push("ET"),e.push("Q"),e.push("EMC");var ii=Y(_t);return ii.scope=_t.scope,ii.stream=e.join(`
`),ii}},rt=function(_t,e){var n=_t.fontSize===0?_t.maxFontSize:_t.fontSize,ei={text:"",fontSize:""},ti=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");ti=_t.multiline?ti.map(function(Ii){return Ii.split(`
`)}):ti.map(function(Ii){return[Ii]});var ii=n,ri=At.internal.getHeight(_t)||0;ri=ri<0?-ri:ri;var ni=At.internal.getWidth(_t)||0;ni=ni<0?-ni:ni;var si=function(Ii,Li,Di){if(Ii+1<ti.length){var Ni=Li+" "+ti[Ii+1][0];return nt(Ni,_t,Di).width<=ni-4}return!1};ii++;e:for(;ii>0;){e="",ii--;var ai,oi,li=nt("3",_t,ii).height,ci=_t.multiline?ri-ii:(ri-li)/2,ui=ci+=2,di=0,fi=0,hi=0;if(ii<=0){e=`(...) Tj
`,e+="% Width of Text: "+nt(e,_t,ii=12).width+", FieldWidth:"+ni+`
`;break}for(var pi="",gi=0,vi=0;vi<ti.length;vi++)if(ti.hasOwnProperty(vi)){var yi=!1;if(ti[vi].length!==1&&hi!==ti[vi].length-1){if((li+2)*(gi+2)+2>ri)continue e;pi+=ti[vi][hi],yi=!0,fi=vi,vi--}else{pi=(pi+=ti[vi][hi]+" ").substr(pi.length-1)==" "?pi.substr(0,pi.length-1):pi;var _i=parseInt(vi),Ai=si(_i,pi,ii),Ei=vi>=ti.length-1;if(Ai&&!Ei){pi+=" ",hi=0;continue}if(Ai||Ei){if(Ei)fi=_i;else if(_t.multiline&&(li+2)*(gi+2)+2>ri)continue e}else{if(!_t.multiline||(li+2)*(gi+2)+2>ri)continue e;fi=_i}}for(var Si="",wi=di;wi<=fi;wi++){var Oi=ti[wi];if(_t.multiline){if(wi===fi){Si+=Oi[hi]+" ",hi=(hi+1)%Oi.length;continue}if(wi===di){Si+=Oi[Oi.length-1]+" ";continue}}Si+=Oi[0]+" "}switch(Si=Si.substr(Si.length-1)==" "?Si.substr(0,Si.length-1):Si,oi=nt(Si,_t,ii).width,_t.textAlign){case"right":ai=ni-oi-2;break;case"center":ai=(ni-oi)/2;break;default:ai=2}e+=H(ai)+" "+H(ui)+` Td
`,e+="("+T(Si)+`) Tj
`,e+=-H(ai)+` 0 Td
`,ui=-(ii+2),oi=0,di=yi?fi:fi+1,gi++,pi=""}break}return ei.text=e,ei.fontSize=ii,ei},nt=function(_t,e,n){var ei=e.scope.internal.getFont(e.fontName,e.fontStyle),ti=e.scope.getStringUnitWidth(_t,{font:ei,fontSize:parseFloat(n),charSpace:0})*parseFloat(n);return{height:e.scope.getStringUnitWidth("3",{font:ei,fontSize:parseFloat(n),charSpace:0})*parseFloat(n)*1.5,width:ti}},it={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},at=function(_t,e){var n={type:"reference",object:_t};e.internal.getPageInfo(_t.page).pageContext.annotations.find(function(ei){return ei.type===n.type&&ei.object===n.object})===void 0&&e.internal.getPageInfo(_t.page).pageContext.annotations.push(n)},ot=function(_t,e){if(e.scope=_t,_t.internal!==void 0&&(_t.internal.acroformPlugin===void 0||_t.internal.acroformPlugin.isInitialized===!1)){if(ft.FieldNum=0,_t.internal.acroformPlugin=JSON.parse(JSON.stringify(it)),_t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");D=_t.internal.scaleFactor,_t.internal.acroformPlugin.acroFormDictionaryRoot=new ht,_t.internal.acroformPlugin.acroFormDictionaryRoot.scope=_t,_t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=_t.internal.events.subscribe("postPutResources",function(){(function(n){n.internal.events.unsubscribe(n.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete n.internal.acroformPlugin.acroFormDictionaryRoot._eventID,n.internal.acroformPlugin.printedOut=!0})(_t)}),_t.internal.events.subscribe("buildDocument",function(){(function(n){n.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var ei=n.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var ti in ei)if(ei.hasOwnProperty(ti)){var ii=ei[ti];ii.objId=void 0,ii.hasAnnotation&&at(ii,n)}})(_t)}),_t.internal.events.subscribe("putCatalog",function(){(function(n){if(n.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");n.internal.write("/AcroForm "+n.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(_t)}),_t.internal.events.subscribe("postPutPages",function(n){(function(ei,ti){var ii=!ei;for(var ri in ei||(ti.internal.newObjectDeferredBegin(ti.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),ti.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),ei=ei||ti.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(ei.hasOwnProperty(ri)){var ni=ei[ri],si=[],ai=ni.Rect;if(ni.Rect&&(ni.Rect=tt(ni.Rect,ti)),ti.internal.newObjectDeferredBegin(ni.objId,!0),ni.DA=At.createDefaultAppearanceStream(ni),_typeof(ni)==="object"&&typeof ni.getKeyValueListForStream=="function"&&(si=ni.getKeyValueListForStream()),ni.Rect=ai,ni.hasAppearanceStream&&!ni.appearanceStreamContent){var oi=et(ni);si.push({key:"AP",value:"<</N "+oi+">>"}),ti.internal.acroformPlugin.xForms.push(oi)}if(ni.appearanceStreamContent){var li="";for(var ci in ni.appearanceStreamContent)if(ni.appearanceStreamContent.hasOwnProperty(ci)){var ui=ni.appearanceStreamContent[ci];if(li+="/"+ci+" ",li+="<<",Object.keys(ui).length>=1||Array.isArray(ui)){for(var ri in ui)if(ui.hasOwnProperty(ri)){var di=ui[ri];typeof di=="function"&&(di=di.call(ti,ni)),li+="/"+ri+" "+di+" ",ti.internal.acroformPlugin.xForms.indexOf(di)>=0||ti.internal.acroformPlugin.xForms.push(di)}}else typeof(di=ui)=="function"&&(di=di.call(ti,ni)),li+="/"+ri+" "+di,ti.internal.acroformPlugin.xForms.indexOf(di)>=0||ti.internal.acroformPlugin.xForms.push(di);li+=">>"}si.push({key:"AP",value:`<<
`+li+">>"})}ti.internal.putStream({additionalKeyValues:si,objectId:ni.objId}),ti.internal.out("endobj")}ii&&(function(fi,hi){for(var pi in fi)if(fi.hasOwnProperty(pi)){var gi=pi,vi=fi[pi];hi.internal.newObjectDeferredBegin(vi.objId,!0),_typeof(vi)==="object"&&typeof vi.putStream=="function"&&vi.putStream(),delete fi[gi]}})(ti.internal.acroformPlugin.xForms,ti)})(n,_t)}),_t.internal.acroformPlugin.isInitialized=!0}},st=R.__acroform__.arrayToPdfArray=function(_t,e,n){var ei=function(ri){return ri};if(Array.isArray(_t)){for(var ti="[",ii=0;ii<_t.length;ii++)switch(ii!==0&&(ti+=" "),_typeof(_t[ii])){case"boolean":case"number":case"object":ti+=_t[ii].toString();break;case"string":_t[ii].substr(0,1)==="/"?ti+="/"+U(_t[ii].substr(1)):(e!==void 0&&n&&(ei=n.internal.getEncryptor(e)),ti+="("+T(ei(_t[ii].toString()))+")")}return ti+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},ut=function(_t,e,n){var ei=function(ti){return ti};return e!==void 0&&n&&(ei=n.internal.getEncryptor(e)),(_t=_t||"").toString(),"("+T(ei(_t))+")"},ct=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(_t){this._objId=_t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};ct.prototype.toString=function(){return this.objId+" 0 R"},ct.prototype.putStream=function(){var _t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:_t,objectId:this.objId}),this.scope.internal.out("endobj")},ct.prototype.getKeyValueListForStream=function(){var _t=[],e=Object.getOwnPropertyNames(this).filter(function(ii){return ii!="content"&&ii!="appearanceStreamContent"&&ii!="scope"&&ii!="objId"&&ii.substring(0,1)!="_"});for(var n in e)if(Object.getOwnPropertyDescriptor(this,e[n]).configurable===!1){var ei=e[n],ti=this[ei];ti&&(Array.isArray(ti)?_t.push({key:ei,value:st(ti,this.objId,this.scope)}):ti instanceof ct?(ti.scope=this.scope,_t.push({key:ei,value:ti.objId+" 0 R"})):typeof ti!="function"&&_t.push({key:ei,value:ti}))}return _t};var lt=function(){ct.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var _t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(n){_t=n.trim()},get:function(){return _t||null}})};V(lt,ct);var ht=function(){ct.call(this);var _t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(_t){var n=function(ei){return ei};return this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),"("+T(n(_t))+")"}},set:function(n){_t=n}})};V(ht,ct);var ft=function _t(){ct.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(pi){if(isNaN(pi))throw new Error('Invalid value "'+pi+'" for attribute F supplied.');e=pi}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Z(e,3)},set:function(pi){pi?this.F=$(e,3):this.F=Q(e,3)}});var n=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return n},set:function(pi){if(isNaN(pi))throw new Error('Invalid value "'+pi+'" for attribute Ff supplied.');n=pi}});var ei=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(ei.length!==0)return ei},set:function(pi){ei=pi!==void 0?pi:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!ei||isNaN(ei[0])?0:ei[0]},set:function(pi){ei[0]=pi}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!ei||isNaN(ei[1])?0:ei[1]},set:function(pi){ei[1]=pi}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!ei||isNaN(ei[2])?0:ei[2]},set:function(pi){ei[2]=pi}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!ei||isNaN(ei[3])?0:ei[3]},set:function(pi){ei[3]=pi}});var ti="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return ti},set:function(pi){switch(pi){case"/Btn":case"/Tx":case"/Ch":case"/Sig":ti=pi;break;default:throw new Error('Invalid value "'+pi+'" for attribute FT supplied.')}}});var ii=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!ii||ii.length<1){if(this instanceof wt)return;ii="FieldObject"+_t.FieldNum++}var pi=function(gi){return gi};return this.scope&&(pi=this.scope.internal.getEncryptor(this.objId)),"("+T(pi(ii))+")"},set:function(pi){ii=pi.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return ii},set:function(pi){ii=pi}});var ri="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return ri},set:function(pi){ri=pi}});var ni="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return ni},set:function(pi){ni=pi}});var si=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return si},set:function(pi){si=pi}});var ai=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return ai===void 0?50/D:ai},set:function(pi){ai=pi}});var oi="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return oi},set:function(pi){oi=pi}});var li="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!li||this instanceof wt||this instanceof Lt))return ut(li,this.objId,this.scope)},set:function(pi){pi=pi.toString(),li=pi}});var ci=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(ci)return this instanceof vt==0?ut(ci,this.objId,this.scope):ci},set:function(pi){pi=pi.toString(),ci=this instanceof vt==0?pi.substr(0,1)==="("?z(pi.substr(1,pi.length-2)):z(pi):pi}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof vt==1?z(ci.substr(1,ci.length-1)):ci},set:function(pi){pi=pi.toString(),ci=this instanceof vt==1?"/"+U(pi):pi}});var ui=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(ui)return ui},set:function(pi){this.V=pi}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(ui)return this instanceof vt==0?ut(ui,this.objId,this.scope):ui},set:function(pi){pi=pi.toString(),ui=this instanceof vt==0?pi.substr(0,1)==="("?z(pi.substr(1,pi.length-2)):z(pi):pi}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof vt==1?z(ui.substr(1,ui.length-1)):ui},set:function(pi){pi=pi.toString(),ui=this instanceof vt==1?"/"+U(pi):pi}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var di,fi=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return fi},set:function(pi){pi=!!pi,fi=pi}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(di)return di},set:function(pi){di=pi}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Z(this.Ff,1)},set:function(pi){pi?this.Ff=$(this.Ff,1):this.Ff=Q(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Z(this.Ff,2)},set:function(pi){pi?this.Ff=$(this.Ff,2):this.Ff=Q(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Z(this.Ff,3)},set:function(pi){pi?this.Ff=$(this.Ff,3):this.Ff=Q(this.Ff,3)}});var hi=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(hi!==null)return hi},set:function(pi){if([0,1,2].indexOf(pi)===-1)throw new Error('Invalid value "'+pi+'" for attribute Q supplied.');hi=pi}}),Object.defineProperty(this,"textAlign",{get:function(){var pi;switch(hi){case 0:default:pi="left";break;case 1:pi="center";break;case 2:pi="right"}return pi},configurable:!0,enumerable:!0,set:function(pi){switch(pi){case"right":case 2:hi=2;break;case"center":case 1:hi=1;break;default:hi=0}}})};V(ft,ct);var dt=function(){ft.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var _t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return _t},set:function(n){_t=n}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return _t},set:function(n){_t=n}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return st(e,this.objId,this.scope)},set:function(n){var ei,ti;ti=[],typeof(ei=n)=="string"&&(ti=(function(ii,ri,ni){ni||(ni=1);for(var si,ai=[];si=ri.exec(ii);)ai.push(si[ni]);return ai})(ei,/\((.*?)\)/g)),e=ti}}),this.getOptions=function(){return e},this.setOptions=function(n){e=n,this.sort&&e.sort()},this.addOption=function(n){n=(n=n||"").toString(),e.push(n),this.sort&&e.sort()},this.removeOption=function(n,ei){for(ei=ei||!1,n=(n=n||"").toString();e.indexOf(n)!==-1&&(e.splice(e.indexOf(n),1),ei!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Z(this.Ff,18)},set:function(n){n?this.Ff=$(this.Ff,18):this.Ff=Q(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Z(this.Ff,19)},set:function(n){this.combo===!0&&(n?this.Ff=$(this.Ff,19):this.Ff=Q(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Z(this.Ff,20)},set:function(n){n?(this.Ff=$(this.Ff,20),e.sort()):this.Ff=Q(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Z(this.Ff,22)},set:function(n){n?this.Ff=$(this.Ff,22):this.Ff=Q(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Z(this.Ff,23)},set:function(n){n?this.Ff=$(this.Ff,23):this.Ff=Q(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Z(this.Ff,27)},set:function(n){n?this.Ff=$(this.Ff,27):this.Ff=Q(this.Ff,27)}}),this.hasAppearanceStream=!1};V(dt,ft);var pt=function(){dt.call(this),this.fontName="helvetica",this.combo=!1};V(pt,dt);var gt=function(){pt.call(this),this.combo=!0};V(gt,pt);var mt=function(){gt.call(this),this.edit=!0};V(mt,gt);var vt=function(){ft.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Z(this.Ff,15)},set:function(n){n?this.Ff=$(this.Ff,15):this.Ff=Q(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Z(this.Ff,16)},set:function(n){n?this.Ff=$(this.Ff,16):this.Ff=Q(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Z(this.Ff,17)},set:function(n){n?this.Ff=$(this.Ff,17):this.Ff=Q(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Z(this.Ff,26)},set:function(n){n?this.Ff=$(this.Ff,26):this.Ff=Q(this.Ff,26)}});var _t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(ii){return ii};if(this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var ei,ti=[];for(ei in ti.push("<<"),e)ti.push("/"+ei+" ("+T(n(e[ei]))+")");return ti.push(">>"),ti.join(`
`)}},set:function(n){_typeof(n)==="object"&&(e=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(n){typeof n=="string"&&(e.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return _t},set:function(n){_t=n}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return _t.substr(1,_t.length-1)},set:function(n){_t="/"+U(n)}})};V(vt,ft);var bt=function(){vt.call(this),this.pushButton=!0};V(bt,vt);var yt=function(){vt.call(this),this.radio=!0,this.pushButton=!1;var _t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return _t},set:function(e){_t=e!==void 0?e:[]}})};V(yt,vt);var wt=function(){var _t,e;ft.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return _t},set:function(ti){_t=ti}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(ti){e=ti}});var n,ei={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var ti=function(ni){return ni};this.scope&&(ti=this.scope.internal.getEncryptor(this.objId));var ii,ri=[];for(ii in ri.push("<<"),ei)ri.push("/"+ii+" ("+T(ti(ei[ii]))+")");return ri.push(">>"),ri.join(`
`)},set:function(ti){_typeof(ti)==="object"&&(ei=ti)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return ei.CA||""},set:function(ti){typeof ti=="string"&&(ei.CA=ti)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(ti){n=ti}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(ti){n="/"+ti}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=At.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};V(wt,ft),yt.prototype.setAppearance=function(_t){if(!("createAppearanceStream"in _t)||!("getCA"in _t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var n=this.Kids[e];n.appearanceStreamContent=_t.createAppearanceStream(n.optionName),n.caption=_t.getCA()}},yt.prototype.createOption=function(_t){var e=new wt;return e.Parent=this,e.optionName=_t,this.Kids.push(e),St.call(this.scope,e),e};var Nt=function(){vt.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=At.CheckBox.createAppearanceStream()};V(Nt,vt);var Lt=function(){ft.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Z(this.Ff,13)},set:function(e){e?this.Ff=$(this.Ff,13):this.Ff=Q(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Z(this.Ff,21)},set:function(e){e?this.Ff=$(this.Ff,21):this.Ff=Q(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Z(this.Ff,23)},set:function(e){e?this.Ff=$(this.Ff,23):this.Ff=Q(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Z(this.Ff,24)},set:function(e){e?this.Ff=$(this.Ff,24):this.Ff=Q(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Z(this.Ff,25)},set:function(e){e?this.Ff=$(this.Ff,25):this.Ff=Q(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Z(this.Ff,26)},set:function(e){e?this.Ff=$(this.Ff,26):this.Ff=Q(this.Ff,26)}});var _t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return _t},set:function(e){_t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return _t},set:function(e){Number.isInteger(e)&&(_t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};V(Lt,ft);var xt=function(){Lt.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Z(this.Ff,14)},set:function(_t){_t?this.Ff=$(this.Ff,14):this.Ff=Q(this.Ff,14)}}),this.password=!0};V(xt,Lt);var At={CheckBox:{createAppearanceStream:function(){return{N:{On:At.CheckBox.YesNormal},D:{On:At.CheckBox.YesPushDown,Off:At.CheckBox.OffPushDown}}},YesPushDown:function(_t){var e=Y(_t);e.scope=_t.scope;var n=[],ei=_t.scope.internal.getFont(_t.fontName,_t.fontStyle).id,ti=_t.scope.__private__.encodeColorString(_t.color),ii=rt(_t,_t.caption);return n.push("0.749023 g"),n.push("0 0 "+H(At.internal.getWidth(_t))+" "+H(At.internal.getHeight(_t))+" re"),n.push("f"),n.push("BMC"),n.push("q"),n.push("0 0 1 rg"),n.push("/"+ei+" "+H(ii.fontSize)+" Tf "+ti),n.push("BT"),n.push(ii.text),n.push("ET"),n.push("Q"),n.push("EMC"),e.stream=n.join(`
`),e},YesNormal:function(_t){var e=Y(_t);e.scope=_t.scope;var n=_t.scope.internal.getFont(_t.fontName,_t.fontStyle).id,ei=_t.scope.__private__.encodeColorString(_t.color),ti=[],ii=At.internal.getHeight(_t),ri=At.internal.getWidth(_t),ni=rt(_t,_t.caption);return ti.push("1 g"),ti.push("0 0 "+H(ri)+" "+H(ii)+" re"),ti.push("f"),ti.push("q"),ti.push("0 0 1 rg"),ti.push("0 0 "+H(ri-1)+" "+H(ii-1)+" re"),ti.push("W"),ti.push("n"),ti.push("0 g"),ti.push("BT"),ti.push("/"+n+" "+H(ni.fontSize)+" Tf "+ei),ti.push(ni.text),ti.push("ET"),ti.push("Q"),e.stream=ti.join(`
`),e},OffPushDown:function(_t){var e=Y(_t);e.scope=_t.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+H(At.internal.getWidth(_t))+" "+H(At.internal.getHeight(_t))+" re"),n.push("f"),e.stream=n.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(_t){var e={D:{Off:At.RadioButton.Circle.OffPushDown},N:{}};return e.N[_t]=At.RadioButton.Circle.YesNormal,e.D[_t]=At.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(_t){var e=Y(_t);e.scope=_t.scope;var n=[],ei=At.internal.getWidth(_t)<=At.internal.getHeight(_t)?At.internal.getWidth(_t)/4:At.internal.getHeight(_t)/4;ei=Number((.9*ei).toFixed(5));var ti=At.internal.Bezier_C,ii=Number((ei*ti).toFixed(5));return n.push("q"),n.push("1 0 0 1 "+W(At.internal.getWidth(_t)/2)+" "+W(At.internal.getHeight(_t)/2)+" cm"),n.push(ei+" 0 m"),n.push(ei+" "+ii+" "+ii+" "+ei+" 0 "+ei+" c"),n.push("-"+ii+" "+ei+" -"+ei+" "+ii+" -"+ei+" 0 c"),n.push("-"+ei+" -"+ii+" -"+ii+" -"+ei+" 0 -"+ei+" c"),n.push(ii+" -"+ei+" "+ei+" -"+ii+" "+ei+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e},YesPushDown:function(_t){var e=Y(_t);e.scope=_t.scope;var n=[],ei=At.internal.getWidth(_t)<=At.internal.getHeight(_t)?At.internal.getWidth(_t)/4:At.internal.getHeight(_t)/4;ei=Number((.9*ei).toFixed(5));var ti=Number((2*ei).toFixed(5)),ii=Number((ti*At.internal.Bezier_C).toFixed(5)),ri=Number((ei*At.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+W(At.internal.getWidth(_t)/2)+" "+W(At.internal.getHeight(_t)/2)+" cm"),n.push(ti+" 0 m"),n.push(ti+" "+ii+" "+ii+" "+ti+" 0 "+ti+" c"),n.push("-"+ii+" "+ti+" -"+ti+" "+ii+" -"+ti+" 0 c"),n.push("-"+ti+" -"+ii+" -"+ii+" -"+ti+" 0 -"+ti+" c"),n.push(ii+" -"+ti+" "+ti+" -"+ii+" "+ti+" 0 c"),n.push("f"),n.push("Q"),n.push("0 g"),n.push("q"),n.push("1 0 0 1 "+W(At.internal.getWidth(_t)/2)+" "+W(At.internal.getHeight(_t)/2)+" cm"),n.push(ei+" 0 m"),n.push(ei+" "+ri+" "+ri+" "+ei+" 0 "+ei+" c"),n.push("-"+ri+" "+ei+" -"+ei+" "+ri+" -"+ei+" 0 c"),n.push("-"+ei+" -"+ri+" -"+ri+" -"+ei+" 0 -"+ei+" c"),n.push(ri+" -"+ei+" "+ei+" -"+ri+" "+ei+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(_t){var e=Y(_t);e.scope=_t.scope;var n=[],ei=At.internal.getWidth(_t)<=At.internal.getHeight(_t)?At.internal.getWidth(_t)/4:At.internal.getHeight(_t)/4;ei=Number((.9*ei).toFixed(5));var ti=Number((2*ei).toFixed(5)),ii=Number((ti*At.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+W(At.internal.getWidth(_t)/2)+" "+W(At.internal.getHeight(_t)/2)+" cm"),n.push(ti+" 0 m"),n.push(ti+" "+ii+" "+ii+" "+ti+" 0 "+ti+" c"),n.push("-"+ii+" "+ti+" -"+ti+" "+ii+" -"+ti+" 0 c"),n.push("-"+ti+" -"+ii+" -"+ii+" -"+ti+" 0 -"+ti+" c"),n.push(ii+" -"+ti+" "+ti+" -"+ii+" "+ti+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e}},Cross:{createAppearanceStream:function(_t){var e={D:{Off:At.RadioButton.Cross.OffPushDown},N:{}};return e.N[_t]=At.RadioButton.Cross.YesNormal,e.D[_t]=At.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(_t){var e=Y(_t);e.scope=_t.scope;var n=[],ei=At.internal.calculateCross(_t);return n.push("q"),n.push("1 1 "+H(At.internal.getWidth(_t)-2)+" "+H(At.internal.getHeight(_t)-2)+" re"),n.push("W"),n.push("n"),n.push(H(ei.x1.x)+" "+H(ei.x1.y)+" m"),n.push(H(ei.x2.x)+" "+H(ei.x2.y)+" l"),n.push(H(ei.x4.x)+" "+H(ei.x4.y)+" m"),n.push(H(ei.x3.x)+" "+H(ei.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},YesPushDown:function(_t){var e=Y(_t);e.scope=_t.scope;var n=At.internal.calculateCross(_t),ei=[];return ei.push("0.749023 g"),ei.push("0 0 "+H(At.internal.getWidth(_t))+" "+H(At.internal.getHeight(_t))+" re"),ei.push("f"),ei.push("q"),ei.push("1 1 "+H(At.internal.getWidth(_t)-2)+" "+H(At.internal.getHeight(_t)-2)+" re"),ei.push("W"),ei.push("n"),ei.push(H(n.x1.x)+" "+H(n.x1.y)+" m"),ei.push(H(n.x2.x)+" "+H(n.x2.y)+" l"),ei.push(H(n.x4.x)+" "+H(n.x4.y)+" m"),ei.push(H(n.x3.x)+" "+H(n.x3.y)+" l"),ei.push("s"),ei.push("Q"),e.stream=ei.join(`
`),e},OffPushDown:function(_t){var e=Y(_t);e.scope=_t.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+H(At.internal.getWidth(_t))+" "+H(At.internal.getHeight(_t))+" re"),n.push("f"),e.stream=n.join(`
`),e}}},createDefaultAppearanceStream:function(_t){var e=_t.scope.internal.getFont(_t.fontName,_t.fontStyle).id,n=_t.scope.__private__.encodeColorString(_t.color);return"/"+e+" "+_t.fontSize+" Tf "+n}};At.internal={Bezier_C:.551915024494,calculateCross:function(_t){var e=At.internal.getWidth(_t),n=At.internal.getHeight(_t),ei=Math.min(e,n);return{x1:{x:(e-ei)/2,y:(n-ei)/2+ei},x2:{x:(e-ei)/2+ei,y:(n-ei)/2},x3:{x:(e-ei)/2,y:(n-ei)/2},x4:{x:(e-ei)/2+ei,y:(n-ei)/2+ei}}}},At.internal.getWidth=function(_t){var e=0;return _typeof(_t)==="object"&&(e=G(_t.Rect[2])),e},At.internal.getHeight=function(_t){var e=0;return _typeof(_t)==="object"&&(e=G(_t.Rect[3])),e};var St=R.addField=function(_t){if(ot(this,_t),!(_t instanceof ft))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=_t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),_t.page=_t.scope.internal.getCurrentPageInfo().pageNumber,this};R.AcroFormChoiceField=dt,R.AcroFormListBox=pt,R.AcroFormComboBox=gt,R.AcroFormEditBox=mt,R.AcroFormButton=vt,R.AcroFormPushButton=bt,R.AcroFormRadioButton=yt,R.AcroFormCheckBox=Nt,R.AcroFormTextField=Lt,R.AcroFormPasswordField=xt,R.AcroFormAppearance=At,R.AcroForm={ChoiceField:dt,ListBox:pt,ComboBox:gt,EditBox:mt,Button:vt,PushButton:bt,RadioButton:yt,CheckBox:Nt,TextField:Lt,PasswordField:xt,Appearance:At},E.AcroForm={ChoiceField:dt,ListBox:pt,ComboBox:gt,EditBox:mt,Button:vt,PushButton:bt,RadioButton:yt,CheckBox:Nt,TextField:Lt,PasswordField:xt,Appearance:At};E.AcroForm;function Pt(_t){return _t.reduce(function(e,n,ei){return e[n]=ei,e},{})}(function(_t){var e="addImage_";_t.__addimage__={};var n="UNKNOWN",ei={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},ti=_t.__addimage__.getImageFileTypeByImageData=function(Ii,Li){var Di,Ni,$i,Ki,er,Vi=n;if((Li=Li||n)==="RGBA"||Ii.data!==void 0&&Ii.data instanceof Uint8ClampedArray&&"height"in Ii&&"width"in Ii)return"RGBA";if(Ai(Ii))for(er in ei)for($i=ei[er],Di=0;Di<$i.length;Di+=1){for(Ki=!0,Ni=0;Ni<$i[Di].length;Ni+=1)if($i[Di][Ni]!==void 0&&$i[Di][Ni]!==Ii[Ni]){Ki=!1;break}if(Ki===!0){Vi=er;break}}else for(er in ei)for($i=ei[er],Di=0;Di<$i.length;Di+=1){for(Ki=!0,Ni=0;Ni<$i[Di].length;Ni+=1)if($i[Di][Ni]!==void 0&&$i[Di][Ni]!==Ii.charCodeAt(Ni)){Ki=!1;break}if(Ki===!0){Vi=er;break}}return Vi===n&&Li!==n&&(Vi=Li),Vi},ii=function Ii(Li){for(var Di=this.internal.write,Ni=this.internal.putStream,$i=(0,this.internal.getFilters)();$i.indexOf("FlateEncode")!==-1;)$i.splice($i.indexOf("FlateEncode"),1);Li.objectId=this.internal.newObject();var Ki=[];if(Ki.push({key:"Type",value:"/XObject"}),Ki.push({key:"Subtype",value:"/Image"}),Ki.push({key:"Width",value:Li.width}),Ki.push({key:"Height",value:Li.height}),Li.colorSpace===pi.INDEXED?Ki.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(Li.palette.length/3-1)+" "+("sMask"in Li&&Li.sMask!==void 0?Li.objectId+2:Li.objectId+1)+" 0 R]"}):(Ki.push({key:"ColorSpace",value:"/"+Li.colorSpace}),Li.colorSpace===pi.DEVICE_CMYK&&Ki.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),Ki.push({key:"BitsPerComponent",value:Li.bitsPerComponent}),"decodeParameters"in Li&&Li.decodeParameters!==void 0&&Ki.push({key:"DecodeParms",value:"<<"+Li.decodeParameters+">>"}),"transparency"in Li&&Array.isArray(Li.transparency)&&Li.transparency.length>0){for(var er="",Vi=0,nr=Li.transparency.length;Vi<nr;Vi++)er+=Li.transparency[Vi]+" "+Li.transparency[Vi]+" ";Ki.push({key:"Mask",value:"["+er+"]"})}Li.sMask!==void 0&&Ki.push({key:"SMask",value:Li.objectId+1+" 0 R"});var zi=Li.filter!==void 0?["/"+Li.filter]:void 0;if(Ni({data:Li.data,additionalKeyValues:Ki,alreadyAppliedFilters:zi,objectId:Li.objectId}),Di("endobj"),"sMask"in Li&&Li.sMask!==void 0){var Wi,Ti=(Wi=Li.sMaskBitsPerComponent)!==null&&Wi!==void 0?Wi:Li.bitsPerComponent,ki={width:Li.width,height:Li.height,colorSpace:"DeviceGray",bitsPerComponent:Ti,data:Li.sMask};"filter"in Li&&(ki.decodeParameters="/Predictor ".concat(Li.predictor," /Colors 1 /BitsPerComponent ").concat(Ti," /Columns ").concat(Li.width),ki.filter=Li.filter),Ii.call(this,ki)}if(Li.colorSpace===pi.INDEXED){var xi=this.internal.newObject();Ni({data:Si(new Uint8Array(Li.palette)),objectId:xi}),Di("endobj")}},ri=function(){var Ii=this.internal.collections[e+"images"];for(var Li in Ii)ii.call(this,Ii[Li])},ni=function(){var Ii,Li=this.internal.collections[e+"images"],Di=this.internal.write;for(var Ni in Li)Di("/I"+(Ii=Li[Ni]).index,Ii.objectId,"0","R")},si=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",ri),this.internal.events.subscribe("putXobjectDict",ni))},ai=function(){var Ii=this.internal.collections[e+"images"];return si.call(this),Ii},oi=function(){return Object.keys(this.internal.collections[e+"images"]).length},li=function(Ii){return typeof _t["process"+Ii.toUpperCase()]=="function"},ci=function(Ii){return _typeof(Ii)==="object"&&Ii.nodeType===1},ui=function(Ii,Li){if(Ii.nodeName==="IMG"&&Ii.hasAttribute("src")){var Di=""+Ii.getAttribute("src");if(Di.indexOf("data:image/")===0)return f(unescape(Di).split("base64,").pop());var Ni=_t.loadFile(Di,!0);if(Ni!==void 0)return Ni}if(Ii.nodeName==="CANVAS"){if(Ii.width===0||Ii.height===0)throw new Error("Given canvas must have data. Canvas width: "+Ii.width+", height: "+Ii.height);var $i;switch(Li){case"PNG":$i="image/png";break;case"WEBP":$i="image/webp";break;default:$i="image/jpeg"}return f(Ii.toDataURL($i,1).split("base64,").pop())}},di=function(Ii){var Li=this.internal.collections[e+"images"];if(Li){for(var Di in Li)if(Ii===Li[Di].alias)return Li[Di]}},fi=function(Ii,Li,Di){return Ii||Li||(Ii=-96,Li=-96),Ii<0&&(Ii=-1*Di.width*72/Ii/this.internal.scaleFactor),Li<0&&(Li=-1*Di.height*72/Li/this.internal.scaleFactor),Ii===0&&(Ii=Li*Di.width/Di.height),Li===0&&(Li=Ii*Di.height/Di.width),[Ii,Li]},hi=function(Ii,Li,Di,Ni,$i,Ki){var er=fi.call(this,Di,Ni,$i),Vi=this.internal.getCoordinateString,nr=this.internal.getVerticalCoordinateString,zi=ai.call(this);if(Di=er[0],Ni=er[1],zi[$i.index]=$i,Ki){Ki*=Math.PI/180;var Wi=Math.cos(Ki),Ti=Math.sin(Ki),ki=function(Mi){return Mi.toFixed(4)},xi=[ki(Wi),ki(Ti),ki(-1*Ti),ki(Wi),0,0,"cm"]}this.internal.write("q"),Ki?(this.internal.write([1,"0","0",1,Vi(Ii),nr(Li+Ni),"cm"].join(" ")),this.internal.write(xi.join(" ")),this.internal.write([Vi(Di),"0","0",Vi(Ni),"0","0","cm"].join(" "))):this.internal.write([Vi(Di),"0","0",Vi(Ni),Vi(Ii),nr(Li+Ni),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+$i.index+" Do"),this.internal.write("Q")},pi=_t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};_t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var gi=_t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},vi=_t.__addimage__.sHashCode=function(Ii){var Li,Di,Ni=0;if(typeof Ii=="string")for(Di=Ii.length,Li=0;Li<Di;Li++)Ni=(Ni<<5)-Ni+Ii.charCodeAt(Li),Ni|=0;else if(Ai(Ii))for(Di=Ii.byteLength/2,Li=0;Li<Di;Li++)Ni=(Ni<<5)-Ni+Ii[Li],Ni|=0;return Ni},yi=_t.__addimage__.validateStringAsBase64=function(Ii){(Ii=Ii||"").toString().trim();var Li=!0;return Ii.length===0&&(Li=!1),Ii.length%4!=0&&(Li=!1),/^[A-Za-z0-9+/]+$/.test(Ii.substr(0,Ii.length-2))===!1&&(Li=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(Ii.substr(-2))===!1&&(Li=!1),Li},_i=_t.__addimage__.extractImageFromDataUrl=function(Ii){if(Ii==null||!(Ii=Ii.trim()).startsWith("data:"))return null;var Li=Ii.indexOf(",");return Li<0?null:Ii.substring(0,Li).trim().endsWith("base64")?Ii.substring(Li+1):null};_t.__addimage__.isArrayBuffer=function(Ii){return Ii instanceof ArrayBuffer};var Ai=_t.__addimage__.isArrayBufferView=function(Ii){return Ii instanceof Int8Array||Ii instanceof Uint8Array||Ii instanceof Uint8ClampedArray||Ii instanceof Int16Array||Ii instanceof Uint16Array||Ii instanceof Int32Array||Ii instanceof Uint32Array||Ii instanceof Float32Array||Ii instanceof Float64Array},Ei=_t.__addimage__.binaryStringToUint8Array=function(Ii){for(var Li=Ii.length,Di=new Uint8Array(Li),Ni=0;Ni<Li;Ni++)Di[Ni]=Ii.charCodeAt(Ni);return Di},Si=_t.__addimage__.arrayBufferToBinaryString=function(Ii){for(var Li="",Di=Ai(Ii)?Ii:new Uint8Array(Ii),Ni=0;Ni<Di.length;Ni+=8192)Li+=String.fromCharCode.apply(null,Di.subarray(Ni,Ni+8192));return Li};_t.addImage=function(){var Ii,Li,Di,Ni,$i,Ki,er,Vi,nr;if(typeof arguments[1]=="number"?(Li=n,Di=arguments[1],Ni=arguments[2],$i=arguments[3],Ki=arguments[4],er=arguments[5],Vi=arguments[6],nr=arguments[7]):(Li=arguments[1],Di=arguments[2],Ni=arguments[3],$i=arguments[4],Ki=arguments[5],er=arguments[6],Vi=arguments[7],nr=arguments[8]),_typeof(Ii=arguments[0])==="object"&&!ci(Ii)&&"imageData"in Ii){var zi=Ii;Ii=zi.imageData,Li=zi.format||Li||n,Di=zi.x||Di||0,Ni=zi.y||Ni||0,$i=zi.w||zi.width||$i,Ki=zi.h||zi.height||Ki,er=zi.alias||er,Vi=zi.compression||Vi,nr=zi.rotation||zi.angle||nr}var Wi=this.internal.getFilters();if(Vi===void 0&&Wi.indexOf("FlateEncode")!==-1&&(Vi="SLOW"),isNaN(Di)||isNaN(Ni))throw new Error("Invalid coordinates passed to jsPDF.addImage");si.call(this);var Ti=wi.call(this,Ii,Li,er,Vi);return hi.call(this,Di,Ni,$i,Ki,Ti,nr),this};var wi=function(Ii,Li,Di,Ni){var $i,Ki,er;if(typeof Ii=="string"&&ti(Ii)===n){Ii=unescape(Ii);var Vi=Oi(Ii,!1);(Vi!==""||(Vi=_t.loadFile(Ii,!0))!==void 0)&&(Ii=Vi)}if(ci(Ii)&&(Ii=ui(Ii,Li)),Li=ti(Ii,Li),!li(Li))throw new Error("addImage does not support files of type '"+Li+"', please ensure that a plugin for '"+Li+"' support is added.");if(((er=Di)==null||er.length===0)&&(Di=(function(nr){return typeof nr=="string"||Ai(nr)?vi(nr):Ai(nr.data)?vi(nr.data):null})(Ii)),($i=di.call(this,Di))||(Ii instanceof Uint8Array||Li==="RGBA"||(Ki=Ii,Ii=Ei(Ii)),$i=this["process"+Li.toUpperCase()](Ii,oi.call(this),Di,(function(nr){return nr&&typeof nr=="string"&&(nr=nr.toUpperCase()),nr in _t.image_compression?nr:gi.NONE})(Ni),Ki)),!$i)throw new Error("An unknown error occurred whilst processing the image.");return $i},Oi=_t.__addimage__.convertBase64ToBinaryString=function(Ii,Li){Li=typeof Li!="boolean"||Li;var Di,Ni="";if(typeof Ii=="string"){var $i;Di=($i=_i(Ii))!==null&&$i!==void 0?$i:Ii;try{Ni=f(Di)}catch(Ki){if(Li)throw yi(Di)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+Ki.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return Ni};_t.getImageProperties=function(Ii){var Li,Di,Ni="";if(ci(Ii)&&(Ii=ui(Ii)),typeof Ii=="string"&&ti(Ii)===n&&((Ni=Oi(Ii,!1))===""&&(Ni=_t.loadFile(Ii)||""),Ii=Ni),Di=ti(Ii),!li(Di))throw new Error("addImage does not support files of type '"+Di+"', please ensure that a plugin for '"+Di+"' support is added.");if(Ii instanceof Uint8Array||(Ii=Ei(Ii)),!(Li=this["process"+Di.toUpperCase()](Ii)))throw new Error("An unknown error occurred whilst processing the image");return Li.fileType=Di,Li}})(E.API),(function(_t){var e=function(n){if(n!==void 0&&n!="")return!0};E.API.events.push(["addPage",function(n){this.internal.getPageInfo(n.pageNumber).pageContext.annotations=[]}]),_t.events.push(["putPage",function(n){for(var ei,ti,ii,ri=this.internal.getCoordinateString,ni=this.internal.getVerticalCoordinateString,si=this.internal.getPageInfoByObjId(n.objId),ai=n.pageContext.annotations,oi=!1,li=0;li<ai.length&&!oi;li++)switch((ei=ai[li]).type){case"link":(e(ei.options.url)||e(ei.options.pageNumber))&&(oi=!0);break;case"reference":case"text":case"freetext":oi=!0}if(oi!=0){this.internal.write("/Annots [");for(var ci=0;ci<ai.length;ci++){ei=ai[ci];var ui=this.internal.pdfEscape,di=this.internal.getEncryptor(n.objId);switch(ei.type){case"reference":this.internal.write(" "+ei.object.objId+" 0 R ");break;case"text":var fi=this.internal.newAdditionalObject(),hi=this.internal.newAdditionalObject(),pi=this.internal.getEncryptor(fi.objId),gi=ei.title||"Note";ii="<</Type /Annot /Subtype /Text "+(ti="/Rect ["+ri(ei.bounds.x)+" "+ni(ei.bounds.y+ei.bounds.h)+" "+ri(ei.bounds.x+ei.bounds.w)+" "+ni(ei.bounds.y)+"] ")+"/Contents ("+ui(pi(ei.contents))+")",ii+=" /Popup "+hi.objId+" 0 R",ii+=" /P "+si.objId+" 0 R",ii+=" /T ("+ui(pi(gi))+") >>",fi.content=ii;var vi=fi.objId+" 0 R";ii="<</Type /Annot /Subtype /Popup "+(ti="/Rect ["+ri(ei.bounds.x+30)+" "+ni(ei.bounds.y+ei.bounds.h)+" "+ri(ei.bounds.x+ei.bounds.w+30)+" "+ni(ei.bounds.y)+"] ")+" /Parent "+vi,ei.open&&(ii+=" /Open true"),ii+=" >>",hi.content=ii,this.internal.write(fi.objId,"0 R",hi.objId,"0 R");break;case"freetext":ti="/Rect ["+ri(ei.bounds.x)+" "+ni(ei.bounds.y)+" "+ri(ei.bounds.x+ei.bounds.w)+" "+ni(ei.bounds.y+ei.bounds.h)+"] ";var yi=ei.color||"#000000";ii="<</Type /Annot /Subtype /FreeText "+ti+"/Contents ("+ui(di(ei.contents))+")",ii+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+yi+")",ii+=" /Border [0 0 0]",ii+=" >>",this.internal.write(ii);break;case"link":if(ei.options.name){var _i=this.annotations._nameMap[ei.options.name];ei.options.pageNumber=_i.page,ei.options.top=_i.y}else ei.options.top||(ei.options.top=0);if(ti="/Rect ["+ei.finalBounds.x+" "+ei.finalBounds.y+" "+ei.finalBounds.w+" "+ei.finalBounds.h+"] ",ii="",ei.options.url)ii="<</Type /Annot /Subtype /Link "+ti+"/Border [0 0 0] /A <</S /URI /URI ("+ui(di(ei.options.url))+") >>";else if(ei.options.pageNumber)switch(ii="<</Type /Annot /Subtype /Link "+ti+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(ei.options.pageNumber).objId+" 0 R",ei.options.magFactor=ei.options.magFactor||"XYZ",ei.options.magFactor){case"Fit":ii+=" /Fit]";break;case"FitH":ii+=" /FitH "+ei.options.top+"]";break;case"FitV":ei.options.left=ei.options.left||0,ii+=" /FitV "+ei.options.left+"]";break;default:var Ai=ni(ei.options.top);ei.options.left=ei.options.left||0,ei.options.zoom===void 0&&(ei.options.zoom=0),ii+=" /XYZ "+ei.options.left+" "+Ai+" "+ei.options.zoom+"]"}ii!=""&&(ii+=" >>",this.internal.write(ii))}}this.internal.write("]")}}]),_t.createAnnotation=function(n){var ei=this.internal.getCurrentPageInfo();switch(n.type){case"link":this.link(n.bounds.x,n.bounds.y,n.bounds.w,n.bounds.h,n);break;case"text":case"freetext":ei.pageContext.annotations.push(n)}},_t.link=function(n,ei,ti,ii,ri){var ni=this.internal.getCurrentPageInfo(),si=this.internal.getCoordinateString,ai=this.internal.getVerticalCoordinateString;ni.pageContext.annotations.push({finalBounds:{x:si(n),y:ai(ei),w:si(n+ti),h:ai(ei+ii)},options:ri,type:"link"})},_t.textWithLink=function(n,ei,ti,ii){var ri,ni,si=this.getTextWidth(n),ai=this.internal.getLineHeight()/this.internal.scaleFactor;if(ii.maxWidth!==void 0){ni=ii.maxWidth;var oi=this.splitTextToSize(n,ni).length;ri=Math.ceil(ai*oi)}else ni=si,ri=ai;return this.text(n,ei,ti,ii),ti+=.2*ai,ii.align==="center"&&(ei-=si/2),ii.align==="right"&&(ei-=si),this.link(ei,ti-ai,ni,ri,ii),si},_t.getTextWidth=function(n){var ei=this.internal.getFontSize();return this.getStringUnitWidth(n)*ei/this.internal.scaleFactor}})(E.API),(function(_t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},n={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},ei={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},ti=[1570,1571,1573,1575];_t.__arabicParser__={};var ii=_t.__arabicParser__.isInArabicSubstitutionA=function(fi){return e[fi.charCodeAt(0)]!==void 0},ri=_t.__arabicParser__.isArabicLetter=function(fi){return typeof fi=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(fi)},ni=_t.__arabicParser__.isArabicEndLetter=function(fi){return ri(fi)&&ii(fi)&&e[fi.charCodeAt(0)].length<=2},si=_t.__arabicParser__.isArabicAlfLetter=function(fi){return ri(fi)&&ti.indexOf(fi.charCodeAt(0))>=0};_t.__arabicParser__.arabicLetterHasIsolatedForm=function(fi){return ri(fi)&&ii(fi)&&e[fi.charCodeAt(0)].length>=1};var ai=_t.__arabicParser__.arabicLetterHasFinalForm=function(fi){return ri(fi)&&ii(fi)&&e[fi.charCodeAt(0)].length>=2};_t.__arabicParser__.arabicLetterHasInitialForm=function(fi){return ri(fi)&&ii(fi)&&e[fi.charCodeAt(0)].length>=3};var oi=_t.__arabicParser__.arabicLetterHasMedialForm=function(fi){return ri(fi)&&ii(fi)&&e[fi.charCodeAt(0)].length==4},li=_t.__arabicParser__.resolveLigatures=function(fi){var hi=0,pi=n,gi="",vi=0;for(hi=0;hi<fi.length;hi+=1)pi[fi.charCodeAt(hi)]!==void 0?(vi++,typeof(pi=pi[fi.charCodeAt(hi)])=="number"&&(gi+=String.fromCharCode(pi),pi=n,vi=0),hi===fi.length-1&&(pi=n,gi+=fi.charAt(hi-(vi-1)),hi-=vi-1,vi=0)):(pi=n,gi+=fi.charAt(hi-vi),hi-=vi,vi=0);return gi};_t.__arabicParser__.isArabicDiacritic=function(fi){return fi!==void 0&&ei[fi.charCodeAt(0)]!==void 0};var ci=_t.__arabicParser__.getCorrectForm=function(fi,hi,pi){return ri(fi)?ii(fi)===!1?-1:!ai(fi)||!ri(hi)&&!ri(pi)||!ri(pi)&&ni(hi)||ni(fi)&&!ri(hi)||ni(fi)&&si(hi)||ni(fi)&&ni(hi)?0:oi(fi)&&ri(hi)&&!ni(hi)&&ri(pi)&&ai(pi)?3:ni(fi)||!ri(pi)?1:2:-1},ui=function(fi){var hi=0,pi=0,gi=0,vi="",yi="",_i="",Ai=(fi=fi||"").split("\\s+"),Ei=[];for(hi=0;hi<Ai.length;hi+=1){for(Ei.push(""),pi=0;pi<Ai[hi].length;pi+=1)vi=Ai[hi][pi],yi=Ai[hi][pi-1],_i=Ai[hi][pi+1],ri(vi)?(gi=ci(vi,yi,_i),Ei[hi]+=gi!==-1?String.fromCharCode(e[vi.charCodeAt(0)][gi]):vi):Ei[hi]+=vi;Ei[hi]=li(Ei[hi])}return Ei.join(" ")},di=_t.__arabicParser__.processArabic=_t.processArabic=function(){var fi,hi=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,pi=[];if(Array.isArray(hi)){var gi=0;for(pi=[],gi=0;gi<hi.length;gi+=1)Array.isArray(hi[gi])?pi.push([ui(hi[gi][0]),hi[gi][1],hi[gi][2]]):pi.push([ui(hi[gi])]);fi=pi}else fi=ui(hi);return typeof arguments[0]=="string"?fi:(arguments[0].text=fi,arguments[0])};_t.events.push(["preProcessText",di])})(E.API),E.API.autoPrint=function(_t){var e;return(_t=_t||{}).variant=_t.variant||"non-conform",_t.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},(function(_t){var e=function(){var n=void 0;Object.defineProperty(this,"pdf",{get:function(){return n},set:function(ni){n=ni}});var ei=150;Object.defineProperty(this,"width",{get:function(){return ei},set:function(ni){ei=isNaN(ni)||Number.isInteger(ni)===!1||ni<0?150:ni,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=ei+1)}});var ti=300;Object.defineProperty(this,"height",{get:function(){return ti},set:function(ni){ti=isNaN(ni)||Number.isInteger(ni)===!1||ni<0?300:ni,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=ti+1)}});var ii=[];Object.defineProperty(this,"childNodes",{get:function(){return ii},set:function(ni){ii=ni}});var ri={};Object.defineProperty(this,"style",{get:function(){return ri},set:function(ni){ri=ni}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(n,ei){var ti;if((n=n||"2d")!=="2d")return null;for(ti in ei)this.pdf.context2d.hasOwnProperty(ti)&&(this.pdf.context2d[ti]=ei[ti]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},_t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])})(E.API),(function(_t){var e={left:0,top:0,bottom:0,right:0},n=!1,ei=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),ti.call(this))},ti=function(){this.internal.__cell__.lastCell=new ii,this.internal.__cell__.pages=1},ii=function(){var si=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return si},set:function(fi){si=fi}});var ai=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return ai},set:function(fi){ai=fi}});var oi=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return oi},set:function(fi){oi=fi}});var li=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return li},set:function(fi){li=fi}});var ci=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return ci},set:function(fi){ci=fi}});var ui=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return ui},set:function(fi){ui=fi}});var di=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return di},set:function(fi){di=fi}}),this};ii.prototype.clone=function(){return new ii(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},ii.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},_t.setHeaderFunction=function(si){return ei.call(this),this.internal.__cell__.headerFunction=typeof si=="function"?si:void 0,this},_t.getTextDimensions=function(si,ai){ei.call(this);var oi=(ai=ai||{}).fontSize||this.getFontSize(),li=ai.font||this.getFont(),ci=ai.scaleFactor||this.internal.scaleFactor,ui=0,di=0,fi=0,hi=this;if(!Array.isArray(si)&&typeof si!="string"){if(typeof si!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");si=String(si)}var pi=ai.maxWidth;pi>0?typeof si=="string"?si=this.splitTextToSize(si,pi):Object.prototype.toString.call(si)==="[object Array]"&&(si=si.reduce(function(vi,yi){return vi.concat(hi.splitTextToSize(yi,pi))},[])):si=Array.isArray(si)?si:[si];for(var gi=0;gi<si.length;gi++)ui<(fi=this.getStringUnitWidth(si[gi],{font:li})*oi)&&(ui=fi);return ui!==0&&(di=si.length),{w:ui/=ci,h:Math.max((di*oi*this.getLineHeightFactor()-oi*(this.getLineHeightFactor()-1))/ci,0)}},_t.cellAddPage=function(){ei.call(this),this.addPage();var si=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new ii(si.left,si.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var ri=_t.cell=function(){var si;si=arguments[0]instanceof ii?arguments[0]:new ii(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),ei.call(this);var ai=this.internal.__cell__.lastCell,oi=this.internal.__cell__.padding,li=this.internal.__cell__.margins||e,ci=this.internal.__cell__.tableHeaderRow,ui=this.internal.__cell__.printHeaders;return ai.lineNumber!==void 0&&(ai.lineNumber===si.lineNumber?(si.x=(ai.x||0)+(ai.width||0),si.y=ai.y||0):ai.y+ai.height+si.height+li.bottom>this.getPageHeight()?(this.cellAddPage(),si.y=li.top,ui&&ci&&(this.printHeaderRow(si.lineNumber,!0),si.y+=ci[0].height)):si.y=ai.y+ai.height||si.y),si.text[0]!==void 0&&(this.rect(si.x,si.y,si.width,si.height,n===!0?"FD":void 0),si.align==="right"?this.text(si.text,si.x+si.width-oi,si.y+oi,{align:"right",baseline:"top"}):si.align==="center"?this.text(si.text,si.x+si.width/2,si.y+oi,{align:"center",baseline:"top",maxWidth:si.width-oi-oi}):this.text(si.text,si.x+oi,si.y+oi,{align:"left",baseline:"top",maxWidth:si.width-oi-oi})),this.internal.__cell__.lastCell=si,this};_t.table=function(si,ai,oi,li,ci){if(ei.call(this),!oi)throw new Error("No data for PDF table.");var ui,di,fi,hi,pi=[],gi=[],vi=[],yi={},_i={},Ai=[],Ei=[],Si=(ci=ci||{}).autoSize||!1,wi=ci.printHeaders!==!1,Oi=ci.css&&ci.css["font-size"]!==void 0?16*ci.css["font-size"]:ci.fontSize||12,Ii=ci.margins||Object.assign({width:this.getPageWidth()},e),Li=typeof ci.padding=="number"?ci.padding:3,Di=ci.headerBackgroundColor||"#c8c8c8",Ni=ci.headerTextColor||"#000";if(ti.call(this),this.internal.__cell__.printHeaders=wi,this.internal.__cell__.margins=Ii,this.internal.__cell__.table_font_size=Oi,this.internal.__cell__.padding=Li,this.internal.__cell__.headerBackgroundColor=Di,this.internal.__cell__.headerTextColor=Ni,this.setFontSize(Oi),li==null)gi=pi=Object.keys(oi[0]),vi=pi.map(function(){return"left"});else if(Array.isArray(li)&&_typeof(li[0])==="object")for(pi=li.map(function(zi){return zi.name}),gi=li.map(function(zi){return zi.prompt||zi.name||""}),vi=li.map(function(zi){return zi.align||"left"}),ui=0;ui<li.length;ui+=1)_i[li[ui].name]=.7499990551181103*li[ui].width;else Array.isArray(li)&&typeof li[0]=="string"&&(gi=pi=li,vi=pi.map(function(){return"left"}));if(Si||Array.isArray(li)&&typeof li[0]=="string")for(ui=0;ui<pi.length;ui+=1){for(yi[hi=pi[ui]]=oi.map(function(zi){return zi[hi]}),this.setFont(void 0,"bold"),Ai.push(this.getTextDimensions(gi[ui],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),di=yi[hi],this.setFont(void 0,"normal"),fi=0;fi<di.length;fi+=1)Ai.push(this.getTextDimensions(di[fi],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);_i[hi]=Math.max.apply(null,Ai)+Li+Li,Ai=[]}if(wi){var $i={};for(ui=0;ui<pi.length;ui+=1)$i[pi[ui]]={},$i[pi[ui]].text=gi[ui],$i[pi[ui]].align=vi[ui];var Ki=ni.call(this,$i,_i);Ei=pi.map(function(zi){return new ii(si,ai,_i[zi],Ki,$i[zi].text,void 0,$i[zi].align)}),this.setTableHeaderRow(Ei),this.printHeaderRow(1,!1)}var er=li.reduce(function(zi,Wi){return zi[Wi.name]=Wi.align,zi},{});for(ui=0;ui<oi.length;ui+=1){"rowStart"in ci&&ci.rowStart instanceof Function&&ci.rowStart({row:ui,data:oi[ui]},this);var Vi=ni.call(this,oi[ui],_i);for(fi=0;fi<pi.length;fi+=1){var nr=oi[ui][pi[fi]];"cellStart"in ci&&ci.cellStart instanceof Function&&ci.cellStart({row:ui,col:fi,data:nr},this),ri.call(this,new ii(si,ai,_i[pi[fi]],Vi,nr,ui+2,er[pi[fi]]))}}return this.internal.__cell__.table_x=si,this.internal.__cell__.table_y=ai,this};var ni=function(si,ai){var oi=this.internal.__cell__.padding,li=this.internal.__cell__.table_font_size,ci=this.internal.scaleFactor;return Object.keys(si).map(function(ui){var di=si[ui];return this.splitTextToSize(di.hasOwnProperty("text")?di.text:di,ai[ui]-oi-oi)},this).map(function(ui){return this.getLineHeightFactor()*ui.length*li/ci+oi+oi},this).reduce(function(ui,di){return Math.max(ui,di)},0)};_t.setTableHeaderRow=function(si){ei.call(this),this.internal.__cell__.tableHeaderRow=si},_t.printHeaderRow=function(si,ai){if(ei.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var oi;if(n=!0,typeof this.internal.__cell__.headerFunction=="function"){var li=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new ii(li[0],li[1],li[2],li[3],void 0,-1)}this.setFont(void 0,"bold");for(var ci=[],ui=0;ui<this.internal.__cell__.tableHeaderRow.length;ui+=1){oi=this.internal.__cell__.tableHeaderRow[ui].clone(),ai&&(oi.y=this.internal.__cell__.margins.top||0,ci.push(oi)),oi.lineNumber=si;var di=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),ri.call(this,oi),this.setTextColor(di)}ci.length>0&&this.setTableHeaderRow(ci),this.setFont(void 0,"normal"),n=!1}})(E.API);var kt={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},Ft=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],It=Pt(Ft),jt=[100,200,300,400,500,600,700,800,900],Ct=Pt(jt);function Ot(_t){var e=_t.family.replace(/"|'/g,"").toLowerCase(),n=(function(ii){return kt[ii=ii||"normal"]?ii:"normal"})(_t.style),ei=(function(ii){return ii?typeof ii=="number"?ii>=100&&ii<=900&&ii%100==0?ii:400:/^\d00$/.test(ii)?parseInt(ii):ii==="bold"?700:400:400})(_t.weight),ti=(function(ii){return typeof It[ii=ii||"normal"]=="number"?ii:"normal"})(_t.stretch);return{family:e,style:n,weight:ei,stretch:ti,src:_t.src||[],ref:_t.ref||{name:e,style:[ti,n,ei].join(" ")}}}function Bt(_t,e,n,ei){var ti;for(ti=n;ti>=0&&ti<e.length;ti+=ei)if(_t[e[ti]])return _t[e[ti]];for(ti=n;ti>=0&&ti<e.length;ti-=ei)if(_t[e[ti]])return _t[e[ti]]}var Mt={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},qt={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function Et(_t){return[_t.stretch,_t.style,_t.weight,_t.family].join(" ")}function Rt(_t){return _t.trimLeft()}function Dt(_t,e){for(var n=0;n<_t.length;){if(_t.charAt(n)===e)return[_t.substring(0,n),_t.substring(n+1)];n+=1}return null}function Tt(_t){var e=_t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],_t.substring(e[0].length)]}var zt,Ut,Ht,Wt,Vt,Gt=["times"];function Yt(_t,e,n,ei,ti){var ii=4,ri=Kt;switch(ti){case E.API.image_compression.FAST:ii=1,ri=Xt;break;case E.API.image_compression.MEDIUM:ii=6,ri=Zt;break;case E.API.image_compression.SLOW:ii=9,ri=$t}_t=(function(si,ai,oi,li){for(var ci,ui=si.length/ai,di=new Uint8Array(si.length+ui),fi=[Jt,Xt,Kt,Zt,$t],hi=0;hi<ui;hi+=1){var pi=hi*ai,gi=si.subarray(pi,pi+ai);if(li)di.set(li(gi,oi,ci),pi+hi);else{for(var vi=fi.length,yi=[],_i=0;_i<vi;_i+=1)yi[_i]=fi[_i](gi,oi,ci);var Ai=te(yi.concat());di.set(yi[Ai],pi+hi)}ci=gi}return di})(_t,e,Math.ceil(n*ei/8),ri);var ni=zlibSync(_t,{level:ii});return E.API.__addimage__.arrayBufferToBinaryString(ni)}function Jt(_t){var e=Array.apply([],_t);return e.unshift(0),e}function Xt(_t,e){var n=_t.length,ei=[];ei[0]=1;for(var ti=0;ti<n;ti+=1){var ii=_t[ti-e]||0;ei[ti+1]=_t[ti]-ii+256&255}return ei}function Kt(_t,e,n){var ei=_t.length,ti=[];ti[0]=2;for(var ii=0;ii<ei;ii+=1){var ri=n&&n[ii]||0;ti[ii+1]=_t[ii]-ri+256&255}return ti}function Zt(_t,e,n){var ei=_t.length,ti=[];ti[0]=3;for(var ii=0;ii<ei;ii+=1){var ri=_t[ii-e]||0,ni=n&&n[ii]||0;ti[ii+1]=_t[ii]+256-(ri+ni>>>1)&255}return ti}function $t(_t,e,n){var ei=_t.length,ti=[];ti[0]=4;for(var ii=0;ii<ei;ii+=1){var ri=Qt(_t[ii-e]||0,n&&n[ii]||0,n&&n[ii-e]||0);ti[ii+1]=_t[ii]-ri+256&255}return ti}function Qt(_t,e,n){if(_t===e&&e===n)return _t;var ei=Math.abs(e-n),ti=Math.abs(_t-n),ii=Math.abs(_t+e-n-n);return ei<=ti&&ei<=ii?_t:ti<=ii?e:n}function te(_t){var e=_t.map(function(n){return n.reduce(function(ei,ti){return ei+Math.abs(ti)},0)});return e.indexOf(Math.min.apply(null,e))}function ee(_t,e,n){var ei=e*n,ti=Math.floor(ei/8),ii=16-(ei-8*ti+n),ri=(1<<n)-1;return ne(_t,ti)>>ii&ri}function re(_t,e,n,ei){var ti=n*ei,ii=Math.floor(ti/8),ri=16-(ti-8*ii+ei),ni=(1<<ei)-1,si=(e&ni)<<ri;(function(ai,oi,li){if(oi+1<ai.byteLength)ai.setUint16(oi,li,!1);else{var ci=li>>8&255;ai.setUint8(oi,ci)}})(_t,ii,ne(_t,ii)&~(ni<<ri)&65535|si)}function ne(_t,e){return e+1<_t.byteLength?_t.getUint16(e,!1):_t.getUint8(e)<<8}function ie(_t){var e=0;if(_t[e++]!==71||_t[e++]!==73||_t[e++]!==70||_t[e++]!==56||(_t[e++]+1&253)!=56||_t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var n=_t[e++]|_t[e++]<<8,ei=_t[e++]|_t[e++]<<8,ti=_t[e++],ii=ti>>7,ri=1<<1+(7&ti);_t[e++],_t[e++];var ni=null,si=null;ii&&(ni=e,si=ri,e+=3*ri);var ai=!0,oi=[],li=0,ci=null,ui=0,di=null;for(this.width=n,this.height=ei;ai&&e<_t.length;)switch(_t[e++]){case 33:switch(_t[e++]){case 255:if(_t[e]!==11||_t[e+1]==78&&_t[e+2]==69&&_t[e+3]==84&&_t[e+4]==83&&_t[e+5]==67&&_t[e+6]==65&&_t[e+7]==80&&_t[e+8]==69&&_t[e+9]==50&&_t[e+10]==46&&_t[e+11]==48&&_t[e+12]==3&&_t[e+13]==1&&_t[e+16]==0)e+=14,di=_t[e++]|_t[e++]<<8,e++;else for(e+=12;;){if(!((Ii=_t[e++])>=0))throw Error("Invalid block size");if(Ii===0)break;e+=Ii}break;case 249:if(_t[e++]!==4||_t[e+4]!==0)throw new Error("Invalid graphics extension block.");var fi=_t[e++];li=_t[e++]|_t[e++]<<8,ci=_t[e++],1&fi||(ci=null),ui=fi>>2&7,e++;break;case 254:for(;;){if(!((Ii=_t[e++])>=0))throw Error("Invalid block size");if(Ii===0)break;e+=Ii}break;default:throw new Error("Unknown graphic control label: 0x"+_t[e-1].toString(16))}break;case 44:var hi=_t[e++]|_t[e++]<<8,pi=_t[e++]|_t[e++]<<8,gi=_t[e++]|_t[e++]<<8,vi=_t[e++]|_t[e++]<<8,yi=_t[e++],_i=yi>>6&1,Ai=1<<1+(7&yi),Ei=ni,Si=si,wi=!1;yi>>7&&(wi=!0,Ei=e,Si=Ai,e+=3*Ai);var Oi=e;for(e++;;){var Ii;if(!((Ii=_t[e++])>=0))throw Error("Invalid block size");if(Ii===0)break;e+=Ii}oi.push({x:hi,y:pi,width:gi,height:vi,has_local_palette:wi,palette_offset:Ei,palette_size:Si,data_offset:Oi,data_length:e-Oi,transparent_index:ci,interlaced:!!_i,delay:li,disposal:ui});break;case 59:ai=!1;break;default:throw new Error("Unknown gif block: 0x"+_t[e-1].toString(16))}this.numFrames=function(){return oi.length},this.loopCount=function(){return di},this.frameInfo=function(Li){if(Li<0||Li>=oi.length)throw new Error("Frame index out of range.");return oi[Li]},this.decodeAndBlitFrameBGRA=function(Li,Di){var Ni=this.frameInfo(Li),$i=Ni.width*Ni.height,Ki=new Uint8Array($i);ae(_t,Ni.data_offset,Ki,$i);var er=Ni.palette_offset,Vi=Ni.transparent_index;Vi===null&&(Vi=256);var nr=Ni.width,zi=n-nr,Wi=nr,Ti=4*(Ni.y*n+Ni.x),ki=4*((Ni.y+Ni.height)*n+Ni.x),xi=Ti,Mi=4*zi;Ni.interlaced===!0&&(Mi+=4*n*7);for(var Ui=8,Yi=0,sr=Ki.length;Yi<sr;++Yi){var cr=Ki[Yi];if(Wi===0&&(Wi=nr,(xi+=Mi)>=ki&&(Mi=4*zi+4*n*(Ui-1),xi=Ti+(nr+zi)*(Ui<<1),Ui>>=1)),cr===Vi)xi+=4;else{var ir=_t[er+3*cr],Zi=_t[er+3*cr+1],rr=_t[er+3*cr+2];Di[xi++]=rr,Di[xi++]=Zi,Di[xi++]=ir,Di[xi++]=255}--Wi}},this.decodeAndBlitFrameRGBA=function(Li,Di){var Ni=this.frameInfo(Li),$i=Ni.width*Ni.height,Ki=new Uint8Array($i);ae(_t,Ni.data_offset,Ki,$i);var er=Ni.palette_offset,Vi=Ni.transparent_index;Vi===null&&(Vi=256);var nr=Ni.width,zi=n-nr,Wi=nr,Ti=4*(Ni.y*n+Ni.x),ki=4*((Ni.y+Ni.height)*n+Ni.x),xi=Ti,Mi=4*zi;Ni.interlaced===!0&&(Mi+=4*n*7);for(var Ui=8,Yi=0,sr=Ki.length;Yi<sr;++Yi){var cr=Ki[Yi];if(Wi===0&&(Wi=nr,(xi+=Mi)>=ki&&(Mi=4*zi+4*n*(Ui-1),xi=Ti+(nr+zi)*(Ui<<1),Ui>>=1)),cr===Vi)xi+=4;else{var ir=_t[er+3*cr],Zi=_t[er+3*cr+1],rr=_t[er+3*cr+2];Di[xi++]=ir,Di[xi++]=Zi,Di[xi++]=rr,Di[xi++]=255}--Wi}}}function ae(_t,e,n,ei){for(var ti=_t[e++],ii=1<<ti,ri=ii+1,ni=ri+1,si=ti+1,ai=(1<<si)-1,oi=0,li=0,ci=0,ui=_t[e++],di=new Int32Array(4096),fi=null;;){for(;oi<16&&ui!==0;)li|=_t[e++]<<oi,oi+=8,ui===1?ui=_t[e++]:--ui;if(oi<si)break;var hi=li&ai;if(li>>=si,oi-=si,hi!==ii){if(hi===ri)break;for(var pi=hi<ni?hi:fi,gi=0,vi=pi;vi>ii;)vi=di[vi]>>8,++gi;var yi=vi;if(ci+gi+(pi!==hi?1:0)>ei)return void o.log("Warning, gif stream longer than expected.");n[ci++]=yi;var _i=ci+=gi;for(pi!==hi&&(n[ci++]=yi),vi=pi;gi--;)vi=di[vi],n[--_i]=255&vi,vi>>=8;fi!==null&&ni<4096&&(di[ni++]=fi<<8|yi,ni>=ai+1&&si<12&&(++si,ai=ai<<1|1)),fi=hi}else ni=ri+1,ai=(1<<(si=ti+1))-1,fi=null}return ci!==ei&&o.log("Warning, gif stream shorter than expected."),n}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function oe(_t){var e,n,ei,ti,ii,ri=Math.floor,ni=new Array(64),si=new Array(64),ai=new Array(64),oi=new Array(64),li=new Array(65535),ci=new Array(65535),ui=new Array(64),di=new Array(64),fi=[],hi=0,pi=7,gi=new Array(64),vi=new Array(64),yi=new Array(64),_i=new Array(256),Ai=new Array(2048),Ei=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],Si=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],wi=[0,1,2,3,4,5,6,7,8,9,10,11],Oi=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],Ii=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],Li=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],Di=[0,1,2,3,4,5,6,7,8,9,10,11],Ni=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],$i=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function Ki(Ti,ki){for(var xi=0,Mi=0,Ui=new Array,Yi=1;Yi<=16;Yi++){for(var sr=1;sr<=Ti[Yi];sr++)Ui[ki[Mi]]=[],Ui[ki[Mi]][0]=xi,Ui[ki[Mi]][1]=Yi,Mi++,xi++;xi*=2}return Ui}function er(Ti){for(var ki=Ti[0],xi=Ti[1]-1;xi>=0;)ki&1<<xi&&(hi|=1<<pi),xi--,--pi<0&&(hi==255?(Vi(255),Vi(0)):Vi(hi),pi=7,hi=0)}function Vi(Ti){fi.push(Ti)}function nr(Ti){Vi(Ti>>8&255),Vi(255&Ti)}function zi(Ti,ki,xi,Mi,Ui){for(var Yi,sr=Ui[0],cr=Ui[240],ir=(function(mr,Mr){var Er,Fr,or,yr,_r,Ar,wr,Rr,Sr,Gr,Or=0;for(Sr=0;Sr<8;++Sr){Er=mr[Or],Fr=mr[Or+1],or=mr[Or+2],yr=mr[Or+3],_r=mr[Or+4],Ar=mr[Or+5],wr=mr[Or+6];var nn=Er+(Rr=mr[Or+7]),en=Er-Rr,Vr=Fr+wr,Xr=Fr-wr,tn=or+Ar,Dr=or-Ar,rn=yr+_r,jr=yr-_r,$r=nn+rn,un=nn-rn,sn=Vr+tn,Wr=Vr-tn;mr[Or]=$r+sn,mr[Or+4]=$r-sn;var an=.707106781*(Wr+un);mr[Or+2]=un+an,mr[Or+6]=un-an;var En=.382683433*(($r=jr+Dr)-(Wr=Xr+en)),Pn=.5411961*$r+En,Dn=1.306562965*Wr+En,Gn=.707106781*(sn=Dr+Xr),Ur=en+Gn,Tn=en-Gn;mr[Or+5]=Tn+Pn,mr[Or+3]=Tn-Pn,mr[Or+1]=Ur+Dn,mr[Or+7]=Ur-Dn,Or+=8}for(Or=0,Sr=0;Sr<8;++Sr){Er=mr[Or],Fr=mr[Or+8],or=mr[Or+16],yr=mr[Or+24],_r=mr[Or+32],Ar=mr[Or+40],wr=mr[Or+48];var $n=Er+(Rr=mr[Or+56]),mn=Er-Rr,bn=Fr+wr,yn=Fr-wr,Fn=or+Ar,Ln=or-Ar,Is=yr+_r,_s=yr-_r,Cs=$n+Is,ks=$n-Is,As=bn+Fn,as=bn-Fn;mr[Or]=Cs+As,mr[Or+32]=Cs-As;var ls=.707106781*(as+ks);mr[Or+16]=ks+ls,mr[Or+48]=ks-ls;var Na=.382683433*((Cs=_s+Ln)-(as=yn+mn)),Vs=.5411961*Cs+Na,ka=1.306562965*as+Na,Xa=.707106781*(As=Ln+yn),Ka=mn+Xa,Za=mn-Xa;mr[Or+40]=Za+Vs,mr[Or+24]=Za-Vs,mr[Or+8]=Ka+ka,mr[Or+56]=Ka-ka,Or++}for(Sr=0;Sr<64;++Sr)Gr=mr[Sr]*Mr[Sr],ui[Sr]=Gr>0?Gr+.5|0:Gr-.5|0;return ui})(Ti,ki),Zi=0;Zi<64;++Zi)di[Ei[Zi]]=ir[Zi];var rr=di[0]-xi;xi=di[0],rr==0?er(Mi[0]):(er(Mi[ci[Yi=32767+rr]]),er(li[Yi]));for(var ar=63;ar>0&&di[ar]==0;)ar--;if(ar==0)return er(sr),xi;for(var pr,Gi=1;Gi<=ar;){for(var gr=Gi;di[Gi]==0&&Gi<=ar;)++Gi;var Br=Gi-gr;if(Br>=16){pr=Br>>4;for(var Nr=1;Nr<=pr;++Nr)er(cr);Br&=15}Yi=32767+di[Gi],er(Ui[(Br<<4)+ci[Yi]]),er(li[Yi]),Gi++}return ar!=63&&er(sr),xi}function Wi(Ti){Ti=Math.min(Math.max(Ti,1),100),ii!=Ti&&((function(ki){for(var xi=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],Mi=0;Mi<64;Mi++){var Ui=ri((xi[Mi]*ki+50)/100);Ui=Math.min(Math.max(Ui,1),255),ni[Ei[Mi]]=Ui}for(var Yi=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],sr=0;sr<64;sr++){var cr=ri((Yi[sr]*ki+50)/100);cr=Math.min(Math.max(cr,1),255),si[Ei[sr]]=cr}for(var ir=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Zi=0,rr=0;rr<8;rr++)for(var ar=0;ar<8;ar++)ai[Zi]=1/(ni[Ei[Zi]]*ir[rr]*ir[ar]*8),oi[Zi]=1/(si[Ei[Zi]]*ir[rr]*ir[ar]*8),Zi++})(Ti<50?Math.floor(5e3/Ti):Math.floor(200-2*Ti)),ii=Ti)}this.encode=function(Ti,ki){ki&&Wi(ki),fi=new Array,hi=0,pi=7,nr(65496),nr(65504),nr(16),Vi(74),Vi(70),Vi(73),Vi(70),Vi(0),Vi(1),Vi(1),Vi(0),nr(1),nr(1),Vi(0),Vi(0),(function(){nr(65499),nr(132),Vi(0);for(var Fr=0;Fr<64;Fr++)Vi(ni[Fr]);Vi(1);for(var or=0;or<64;or++)Vi(si[or])})(),(function(Fr,or){nr(65472),nr(17),Vi(8),nr(or),nr(Fr),Vi(3),Vi(1),Vi(17),Vi(0),Vi(2),Vi(17),Vi(1),Vi(3),Vi(17),Vi(1)})(Ti.width,Ti.height),(function(){nr(65476),nr(418),Vi(0);for(var Fr=0;Fr<16;Fr++)Vi(Si[Fr+1]);for(var or=0;or<=11;or++)Vi(wi[or]);Vi(16);for(var yr=0;yr<16;yr++)Vi(Oi[yr+1]);for(var _r=0;_r<=161;_r++)Vi(Ii[_r]);Vi(1);for(var Ar=0;Ar<16;Ar++)Vi(Li[Ar+1]);for(var wr=0;wr<=11;wr++)Vi(Di[wr]);Vi(17);for(var Rr=0;Rr<16;Rr++)Vi(Ni[Rr+1]);for(var Sr=0;Sr<=161;Sr++)Vi($i[Sr])})(),nr(65498),nr(12),Vi(3),Vi(1),Vi(0),Vi(2),Vi(17),Vi(3),Vi(17),Vi(0),Vi(63),Vi(0);var xi=0,Mi=0,Ui=0;hi=0,pi=7,this.encode.displayName="_encode_";for(var Yi,sr,cr,ir,Zi,rr,ar,pr,Gi,gr=Ti.data,Br=Ti.width,Nr=Ti.height,mr=4*Br,Mr=0;Mr<Nr;){for(Yi=0;Yi<mr;){for(Zi=mr*Mr+Yi,ar=-1,pr=0,Gi=0;Gi<64;Gi++)rr=Zi+(pr=Gi>>3)*mr+(ar=4*(7&Gi)),Mr+pr>=Nr&&(rr-=mr*(Mr+1+pr-Nr)),Yi+ar>=mr&&(rr-=Yi+ar-mr+4),sr=gr[rr++],cr=gr[rr++],ir=gr[rr++],gi[Gi]=(Ai[sr]+Ai[cr+256|0]+Ai[ir+512|0]>>16)-128,vi[Gi]=(Ai[sr+768|0]+Ai[cr+1024|0]+Ai[ir+1280|0]>>16)-128,yi[Gi]=(Ai[sr+1280|0]+Ai[cr+1536|0]+Ai[ir+1792|0]>>16)-128;xi=zi(gi,ai,xi,e,ei),Mi=zi(vi,oi,Mi,n,ti),Ui=zi(yi,oi,Ui,n,ti),Yi+=32}Mr+=8}if(pi>=0){var Er=[];Er[1]=pi+1,Er[0]=(1<<pi+1)-1,er(Er)}return nr(65497),new Uint8Array(fi)},_t=_t||50,(function(){for(var Ti=String.fromCharCode,ki=0;ki<256;ki++)_i[ki]=Ti(ki)})(),e=Ki(Si,wi),n=Ki(Li,Di),ei=Ki(Oi,Ii),ti=Ki(Ni,$i),(function(){for(var Ti=1,ki=2,xi=1;xi<=15;xi++){for(var Mi=Ti;Mi<ki;Mi++)ci[32767+Mi]=xi,li[32767+Mi]=[],li[32767+Mi][1]=xi,li[32767+Mi][0]=Mi;for(var Ui=-(ki-1);Ui<=-Ti;Ui++)ci[32767+Ui]=xi,li[32767+Ui]=[],li[32767+Ui][1]=xi,li[32767+Ui][0]=ki-1+Ui;Ti<<=1,ki<<=1}})(),(function(){for(var Ti=0;Ti<256;Ti++)Ai[Ti]=19595*Ti,Ai[Ti+256|0]=38470*Ti,Ai[Ti+512|0]=7471*Ti+32768,Ai[Ti+768|0]=-11059*Ti,Ai[Ti+1024|0]=-21709*Ti,Ai[Ti+1280|0]=32768*Ti+8421375,Ai[Ti+1536|0]=-27439*Ti,Ai[Ti+1792|0]=-5329*Ti})(),Wi(_t)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function se(_t,e){if(this.pos=0,this.buffer=_t,this.datav=new DataView(_t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function ue(_t){function e(wi){if(!wi)throw Error("assert :P")}function n(wi,Oi,Ii){for(var Li=0;4>Li;Li++)if(wi[Oi+Li]!=Ii.charCodeAt(Li))return!0;return!1}function ei(wi,Oi,Ii,Li,Di){for(var Ni=0;Ni<Di;Ni++)wi[Oi+Ni]=Ii[Li+Ni]}function ti(wi,Oi,Ii,Li){for(var Di=0;Di<Li;Di++)wi[Oi+Di]=Ii}function ii(wi){return new Int32Array(wi)}function ri(wi,Oi){for(var Ii=[],Li=0;Li<wi;Li++)Ii.push(new Oi);return Ii}function ni(wi,Oi){var Ii=[];return(function Li(Di,Ni,$i){for(var Ki=$i[Ni],er=0;er<Ki&&(Di.push($i.length>Ni+1?[]:new Oi),!($i.length<Ni+1));er++)Li(Di[er],Ni+1,$i)})(Ii,0,wi),Ii}var si=function(){var wi=this;function Oi(mi,Ci){for(var Pi=1<<Ci-1>>>0;mi&Pi;)Pi>>>=1;return Pi?(mi&Pi-1)+Pi:mi}function Ii(mi,Ci,Pi,Ri,Bi){e(!(Ri%Pi));do mi[Ci+(Ri-=Pi)]=Bi;while(0<Ri)}function Li(mi,Ci,Pi,Ri,Bi){if(e(2328>=Bi),512>=Bi)var ji=ii(512);else if((ji=ii(Bi))==null)return 0;return(function(Hi,qi,Xi,Ji,ur,Cr){var Qi,dr,fr=qi,br=1<<Xi,vr=ii(16),Ir=ii(16);for(e(ur!=0),e(Ji!=null),e(Hi!=null),e(0<Xi),dr=0;dr<ur;++dr){if(15<Ji[dr])return 0;++vr[Ji[dr]]}if(vr[0]==ur)return 0;for(Ir[1]=0,Qi=1;15>Qi;++Qi){if(vr[Qi]>1<<Qi)return 0;Ir[Qi+1]=Ir[Qi]+vr[Qi]}for(dr=0;dr<ur;++dr)Qi=Ji[dr],0<Ji[dr]&&(Cr[Ir[Qi]++]=dr);if(Ir[15]==1)return(Ji=new Di).g=0,Ji.value=Cr[0],Ii(Hi,fr,1,br,Ji),br;var Pr,kr=-1,Tr=br-1,Qr=0,zr=1,pn=1,Kr=1<<Xi;for(dr=0,Qi=1,ur=2;Qi<=Xi;++Qi,ur<<=1){if(zr+=pn<<=1,0>(pn-=vr[Qi]))return 0;for(;0<vr[Qi];--vr[Qi])(Ji=new Di).g=Qi,Ji.value=Cr[dr++],Ii(Hi,fr+Qr,ur,Kr,Ji),Qr=Oi(Qr,Qi)}for(Qi=Xi+1,ur=2;15>=Qi;++Qi,ur<<=1){if(zr+=pn<<=1,0>(pn-=vr[Qi]))return 0;for(;0<vr[Qi];--vr[Qi]){if(Ji=new Di,(Qr&Tr)!=kr){for(fr+=Kr,Pr=1<<(kr=Qi)-Xi;15>kr&&!(0>=(Pr-=vr[kr]));)++kr,Pr<<=1;br+=Kr=1<<(Pr=kr-Xi),Hi[qi+(kr=Qr&Tr)].g=Pr+Xi,Hi[qi+kr].value=fr-qi-kr}Ji.g=Qi-Xi,Ji.value=Cr[dr++],Ii(Hi,fr+(Qr>>Xi),ur,Kr,Ji),Qr=Oi(Qr,Qi)}}return zr!=2*Ir[15]-1?0:br})(mi,Ci,Pi,Ri,Bi,ji)}function Di(){this.value=this.g=0}function Ni(){this.value=this.g=0}function $i(){this.G=ri(5,Di),this.H=ii(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=ri(za,Ni)}function Ki(mi,Ci,Pi,Ri){e(mi!=null),e(Ci!=null),e(2147483648>Ri),mi.Ca=254,mi.I=0,mi.b=-8,mi.Ka=0,mi.oa=Ci,mi.pa=Pi,mi.Jd=Ci,mi.Yc=Pi+Ri,mi.Zc=4<=Ri?Pi+Ri-4+1:Pi,sr(mi)}function er(mi,Ci){for(var Pi=0;0<Ci--;)Pi|=ir(mi,128)<<Ci;return Pi}function Vi(mi,Ci){var Pi=er(mi,Ci);return cr(mi)?-Pi:Pi}function nr(mi,Ci,Pi,Ri){var Bi,ji=0;for(e(mi!=null),e(Ci!=null),e(4294967288>Ri),mi.Sb=Ri,mi.Ra=0,mi.u=0,mi.h=0,4<Ri&&(Ri=4),Bi=0;Bi<Ri;++Bi)ji+=Ci[Pi+Bi]<<8*Bi;mi.Ra=ji,mi.bb=Ri,mi.oa=Ci,mi.pa=Pi}function zi(mi){for(;8<=mi.u&&mi.bb<mi.Sb;)mi.Ra>>>=8,mi.Ra+=mi.oa[mi.pa+mi.bb]<<Aa-8>>>0,++mi.bb,mi.u-=8;Mi(mi)&&(mi.h=1,mi.u=0)}function Wi(mi,Ci){if(e(0<=Ci),!mi.h&&Ci<=xs){var Pi=xi(mi)&ws[Ci];return mi.u+=Ci,zi(mi),Pi}return mi.h=1,mi.u=0}function Ti(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function ki(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function xi(mi){return mi.Ra>>>(mi.u&Aa-1)>>>0}function Mi(mi){return e(mi.bb<=mi.Sb),mi.h||mi.bb==mi.Sb&&mi.u>Aa}function Ui(mi,Ci){mi.u=Ci,mi.h=Mi(mi)}function Yi(mi){mi.u>=ha&&(e(mi.u>=ha),zi(mi))}function sr(mi){e(mi!=null&&mi.oa!=null),mi.pa<mi.Zc?(mi.I=(mi.oa[mi.pa++]|mi.I<<8)>>>0,mi.b+=8):(e(mi!=null&&mi.oa!=null),mi.pa<mi.Yc?(mi.b+=8,mi.I=mi.oa[mi.pa++]|mi.I<<8):mi.Ka?mi.b=0:(mi.I<<=8,mi.b+=8,mi.Ka=1))}function cr(mi){return er(mi,1)}function ir(mi,Ci){var Pi=mi.Ca;0>mi.b&&sr(mi);var Ri=mi.b,Bi=Pi*Ci>>>8,ji=(mi.I>>>Ri>Bi)+0;for(ji?(Pi-=Bi,mi.I-=Bi+1<<Ri>>>0):Pi=Bi+1,Ri=Pi,Bi=0;256<=Ri;)Bi+=8,Ri>>=8;return Ri=7^Bi+Ea[Ri],mi.b-=Ri,mi.Ca=(Pi<<Ri)-1,ji}function Zi(mi,Ci,Pi){mi[Ci+0]=Pi>>24&255,mi[Ci+1]=Pi>>16&255,mi[Ci+2]=Pi>>8&255,mi[Ci+3]=255&Pi}function rr(mi,Ci){return mi[Ci+0]|mi[Ci+1]<<8}function ar(mi,Ci){return rr(mi,Ci)|mi[Ci+2]<<16}function pr(mi,Ci){return rr(mi,Ci)|rr(mi,Ci+2)<<16}function Gi(mi,Ci){var Pi=1<<Ci;return e(mi!=null),e(0<Ci),mi.X=ii(Pi),mi.X==null?0:(mi.Mb=32-Ci,mi.Xa=Ci,1)}function gr(mi,Ci){e(mi!=null),e(Ci!=null),e(mi.Xa==Ci.Xa),ei(Ci.X,0,mi.X,0,1<<Ci.Xa)}function Br(){this.X=[],this.Xa=this.Mb=0}function Nr(mi,Ci,Pi,Ri){e(Pi!=null),e(Ri!=null);var Bi=Pi[0],ji=Ri[0];return Bi==0&&(Bi=(mi*ji+Ci/2)/Ci),ji==0&&(ji=(Ci*Bi+mi/2)/mi),0>=Bi||0>=ji?0:(Pi[0]=Bi,Ri[0]=ji,1)}function mr(mi,Ci){return mi+(1<<Ci)-1>>>Ci}function Mr(mi,Ci){return((4278255360&mi)+(4278255360&Ci)>>>0&4278255360)+((16711935&mi)+(16711935&Ci)>>>0&16711935)>>>0}function Er(mi,Ci){wi[Ci]=function(Pi,Ri,Bi,ji,Hi,qi,Xi){var Ji;for(Ji=0;Ji<Hi;++Ji){var ur=wi[mi](qi[Xi+Ji-1],Bi,ji+Ji);qi[Xi+Ji]=Mr(Pi[Ri+Ji],ur)}}}function Fr(){this.ud=this.hd=this.jd=0}function or(mi,Ci){return((4278124286&(mi^Ci))>>>1)+(mi&Ci)>>>0}function yr(mi){return 0<=mi&&256>mi?mi:0>mi?0:255<mi?255:void 0}function _r(mi,Ci){return yr(mi+(mi-Ci+.5>>1))}function Ar(mi,Ci,Pi){return Math.abs(Ci-Pi)-Math.abs(mi-Pi)}function wr(mi,Ci,Pi,Ri,Bi,ji,Hi){for(Ri=ji[Hi-1],Pi=0;Pi<Bi;++Pi)ji[Hi+Pi]=Ri=Mr(mi[Ci+Pi],Ri)}function Rr(mi,Ci,Pi,Ri,Bi){var ji;for(ji=0;ji<Pi;++ji){var Hi=mi[Ci+ji],qi=Hi>>8&255,Xi=16711935&(Xi=(Xi=16711935&Hi)+((qi<<16)+qi));Ri[Bi+ji]=(4278255360&Hi)+Xi>>>0}}function Sr(mi,Ci){Ci.jd=255&mi,Ci.hd=mi>>8&255,Ci.ud=mi>>16&255}function Gr(mi,Ci,Pi,Ri,Bi,ji){var Hi;for(Hi=0;Hi<Ri;++Hi){var qi=Ci[Pi+Hi],Xi=qi>>>8,Ji=qi,ur=255&(ur=(ur=qi>>>16)+((mi.jd<<24>>24)*(Xi<<24>>24)>>>5));Ji=255&(Ji=(Ji+=(mi.hd<<24>>24)*(Xi<<24>>24)>>>5)+((mi.ud<<24>>24)*(ur<<24>>24)>>>5)),Bi[ji+Hi]=(4278255360&qi)+(ur<<16)+Ji}}function Or(mi,Ci,Pi,Ri,Bi){wi[Ci]=function(ji,Hi,qi,Xi,Ji,ur,Cr,Qi,dr){for(Xi=Cr;Xi<Qi;++Xi)for(Cr=0;Cr<dr;++Cr)Ji[ur++]=Bi(qi[Ri(ji[Hi++])])},wi[mi]=function(ji,Hi,qi,Xi,Ji,ur,Cr){var Qi=8>>ji.b,dr=ji.Ea,fr=ji.K[0],br=ji.w;if(8>Qi)for(ji=(1<<ji.b)-1,br=(1<<Qi)-1;Hi<qi;++Hi){var vr,Ir=0;for(vr=0;vr<dr;++vr)vr&ji||(Ir=Ri(Xi[Ji++])),ur[Cr++]=Bi(fr[Ir&br]),Ir>>=Qi}else wi["VP8LMapColor"+Pi](Xi,Ji,fr,br,ur,Cr,Hi,qi,dr)}}function nn(mi,Ci,Pi,Ri,Bi){for(Pi=Ci+Pi;Ci<Pi;){var ji=mi[Ci++];Ri[Bi++]=ji>>16&255,Ri[Bi++]=ji>>8&255,Ri[Bi++]=255&ji}}function en(mi,Ci,Pi,Ri,Bi){for(Pi=Ci+Pi;Ci<Pi;){var ji=mi[Ci++];Ri[Bi++]=ji>>16&255,Ri[Bi++]=ji>>8&255,Ri[Bi++]=255&ji,Ri[Bi++]=ji>>24&255}}function Vr(mi,Ci,Pi,Ri,Bi){for(Pi=Ci+Pi;Ci<Pi;){var ji=(Hi=mi[Ci++])>>16&240|Hi>>12&15,Hi=240&Hi|Hi>>28&15;Ri[Bi++]=ji,Ri[Bi++]=Hi}}function Xr(mi,Ci,Pi,Ri,Bi){for(Pi=Ci+Pi;Ci<Pi;){var ji=(Hi=mi[Ci++])>>16&248|Hi>>13&7,Hi=Hi>>5&224|Hi>>3&31;Ri[Bi++]=ji,Ri[Bi++]=Hi}}function tn(mi,Ci,Pi,Ri,Bi){for(Pi=Ci+Pi;Ci<Pi;){var ji=mi[Ci++];Ri[Bi++]=255&ji,Ri[Bi++]=ji>>8&255,Ri[Bi++]=ji>>16&255}}function Dr(mi,Ci,Pi,Ri,Bi,ji){if(ji==0)for(Pi=Ci+Pi;Ci<Pi;)Zi(Ri,((ji=mi[Ci++])[0]>>24|ji[1]>>8&65280|ji[2]<<8&16711680|ji[3]<<24)>>>0),Bi+=32;else ei(Ri,Bi,mi,Ci,Pi)}function rn(mi,Ci){wi[Ci][0]=wi[mi+"0"],wi[Ci][1]=wi[mi+"1"],wi[Ci][2]=wi[mi+"2"],wi[Ci][3]=wi[mi+"3"],wi[Ci][4]=wi[mi+"4"],wi[Ci][5]=wi[mi+"5"],wi[Ci][6]=wi[mi+"6"],wi[Ci][7]=wi[mi+"7"],wi[Ci][8]=wi[mi+"8"],wi[Ci][9]=wi[mi+"9"],wi[Ci][10]=wi[mi+"10"],wi[Ci][11]=wi[mi+"11"],wi[Ci][12]=wi[mi+"12"],wi[Ci][13]=wi[mi+"13"],wi[Ci][14]=wi[mi+"0"],wi[Ci][15]=wi[mi+"0"]}function jr(mi){return mi==$l||mi==Hl||mi==ul||mi==Wl}function $r(){this.eb=[],this.size=this.A=this.fb=0}function un(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function sn(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new $r,this.f.kb=new un,this.sd=null}function Wr(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function an(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function En(mi){return alert("todo:WebPSamplerProcessPlane"),mi.T}function Pn(mi,Ci){var Pi=mi.T,Ri=Ci.ba.f.RGBA,Bi=Ri.eb,ji=Ri.fb+mi.ka*Ri.A,Hi=Us[Ci.ba.S],qi=mi.y,Xi=mi.O,Ji=mi.f,ur=mi.N,Cr=mi.ea,Qi=mi.W,dr=Ci.cc,fr=Ci.dc,br=Ci.Mc,vr=Ci.Nc,Ir=mi.ka,Pr=mi.ka+mi.T,kr=mi.U,Tr=kr+1>>1;for(Ir==0?Hi(qi,Xi,null,null,Ji,ur,Cr,Qi,Ji,ur,Cr,Qi,Bi,ji,null,null,kr):(Hi(Ci.ec,Ci.fc,qi,Xi,dr,fr,br,vr,Ji,ur,Cr,Qi,Bi,ji-Ri.A,Bi,ji,kr),++Pi);Ir+2<Pr;Ir+=2)dr=Ji,fr=ur,br=Cr,vr=Qi,ur+=mi.Rc,Qi+=mi.Rc,ji+=2*Ri.A,Hi(qi,(Xi+=2*mi.fa)-mi.fa,qi,Xi,dr,fr,br,vr,Ji,ur,Cr,Qi,Bi,ji-Ri.A,Bi,ji,kr);return Xi+=mi.fa,mi.j+Pr<mi.o?(ei(Ci.ec,Ci.fc,qi,Xi,kr),ei(Ci.cc,Ci.dc,Ji,ur,Tr),ei(Ci.Mc,Ci.Nc,Cr,Qi,Tr),Pi--):1&Pr||Hi(qi,Xi,null,null,Ji,ur,Cr,Qi,Ji,ur,Cr,Qi,Bi,ji+Ri.A,null,null,kr),Pi}function Dn(mi,Ci,Pi){var Ri=mi.F,Bi=[mi.J];if(Ri!=null){var ji=mi.U,Hi=Ci.ba.S,qi=Hi==cl||Hi==ul;Ci=Ci.ba.f.RGBA;var Xi=[0],Ji=mi.ka;Xi[0]=mi.T,mi.Kb&&(Ji==0?--Xi[0]:(--Ji,Bi[0]-=mi.width),mi.j+mi.ka+mi.T==mi.o&&(Xi[0]=mi.o-mi.j-Ji));var ur=Ci.eb;Ji=Ci.fb+Ji*Ci.A,mi=gc(Ri,Bi[0],mi.width,ji,Xi,ur,Ji+(qi?0:3),Ci.A),e(Pi==Xi),mi&&jr(Hi)&&Mo(ur,Ji,qi,ji,Xi,Ci.A)}return 0}function Gn(mi){var Ci=mi.ma,Pi=Ci.ba.S,Ri=11>Pi,Bi=Pi==ol||Pi==ll||Pi==cl||Pi==jl||Pi==12||jr(Pi);if(Ci.memory=null,Ci.Ib=null,Ci.Jb=null,Ci.Nd=null,!So(Ci.Oa,mi,Bi?11:12))return 0;if(Bi&&jr(Pi)&&Ao(),mi.da)alert("todo:use_scaling");else{if(Ri){if(Ci.Ib=En,mi.Kb){if(Pi=mi.U+1>>1,Ci.memory=ii(mi.U+2*Pi),Ci.memory==null)return 0;Ci.ec=Ci.memory,Ci.fc=0,Ci.cc=Ci.ec,Ci.dc=Ci.fc+mi.U,Ci.Mc=Ci.cc,Ci.Nc=Ci.dc+Pi,Ci.Ib=Pn,Ao()}}else alert("todo:EmitYUV");Bi&&(Ci.Jb=Dn,Ri&&Hs())}if(Ri&&!Rc){for(mi=0;256>mi;++mi)yu[mi]=89858*(mi-128)+hl>>dl,Cu[mi]=-22014*(mi-128)+hl,_u[mi]=-45773*(mi-128),vu[mi]=113618*(mi-128)+hl>>dl;for(mi=ko;mi<Vl;++mi)Ci=76283*(mi-16)+hl>>dl,Au[mi-ko]=Ys(Ci,255),Eu[mi-ko]=Ys(Ci+8>>4,15);Rc=1}return 1}function Ur(mi){var Ci=mi.ma,Pi=mi.U,Ri=mi.T;return e(!(1&mi.ka)),0>=Pi||0>=Ri?0:(Pi=Ci.Ib(mi,Ci),Ci.Jb!=null&&Ci.Jb(mi,Ci,Pi),Ci.Dc+=Pi,1)}function Tn(mi){mi.ma.memory=null}function $n(mi,Ci,Pi,Ri){return Wi(mi,8)!=47?0:(Ci[0]=Wi(mi,14)+1,Pi[0]=Wi(mi,14)+1,Ri[0]=Wi(mi,1),Wi(mi,3)!=0?0:!mi.h)}function mn(mi,Ci){if(4>mi)return mi+1;var Pi=mi-2>>1;return(2+(1&mi)<<Pi)+Wi(Ci,Pi)+1}function bn(mi,Ci){return 120<Ci?Ci-120:1<=(Pi=((Pi=ru[Ci-1])>>4)*mi+(8-(15&Pi)))?Pi:1;var Pi}function yn(mi,Ci,Pi){var Ri=xi(Pi),Bi=mi[Ci+=255&Ri].g-8;return 0<Bi&&(Ui(Pi,Pi.u+8),Ri=xi(Pi),Ci+=mi[Ci].value,Ci+=Ri&(1<<Bi)-1),Ui(Pi,Pi.u+mi[Ci].g),mi[Ci].value}function Fn(mi,Ci,Pi){return Pi.g+=mi.g,Pi.value+=mi.value<<Ci>>>0,e(8>=Pi.g),mi.g}function Ln(mi,Ci,Pi){var Ri=mi.xc;return e((Ci=Ri==0?0:mi.vc[mi.md*(Pi>>Ri)+(Ci>>Ri)])<mi.Wb),mi.Ya[Ci]}function Is(mi,Ci,Pi,Ri){var Bi=mi.ab,ji=mi.c*Ci,Hi=mi.C;Ci=Hi+Ci;var qi=Pi,Xi=Ri;for(Ri=mi.Ta,Pi=mi.Ua;0<Bi--;){var Ji=mi.gc[Bi],ur=Hi,Cr=Ci,Qi=qi,dr=Xi,fr=(Xi=Ri,qi=Pi,Ji.Ea);switch(e(ur<Cr),e(Cr<=Ji.nc),Ji.hc){case 2:Hn(Qi,dr,(Cr-ur)*fr,Xi,qi);break;case 0:var br=ur,vr=Cr,Ir=Xi,Pr=qi,kr=(Kr=Ji).Ea;br==0&&(wo(Qi,dr,null,null,1,Ir,Pr),wr(Qi,dr+1,0,0,kr-1,Ir,Pr+1),dr+=kr,Pr+=kr,++br);for(var Tr=1<<Kr.b,Qr=Tr-1,zr=mr(kr,Kr.b),pn=Kr.K,Kr=Kr.w+(br>>Kr.b)*zr;br<vr;){var vn=pn,rs=Kr,gn=1;for(so(Qi,dr,Ir,Pr-kr,1,Ir,Pr);gn<kr;){var Zr=(gn&~Qr)+Tr;Zr>kr&&(Zr=kr),(0,Po[vn[rs++]>>8&15])(Qi,dr+ +gn,Ir,Pr+gn-kr,Zr-gn,Ir,Pr+gn),gn=Zr}dr+=kr,Pr+=kr,++br&Qr||(Kr+=zr)}Cr!=Ji.nc&&ei(Xi,qi-fr,Xi,qi+(Cr-ur-1)*fr,fr);break;case 1:for(fr=Qi,vr=dr,kr=(Qi=Ji.Ea)-(Pr=Qi&~(Ir=(dr=1<<Ji.b)-1)),br=mr(Qi,Ji.b),Tr=Ji.K,Ji=Ji.w+(ur>>Ji.b)*br;ur<Cr;){for(Qr=Tr,zr=Ji,pn=new Fr,Kr=vr+Pr,vn=vr+Qi;vr<Kr;)Sr(Qr[zr++],pn),Lo(pn,fr,vr,dr,Xi,qi),vr+=dr,qi+=dr;vr<vn&&(Sr(Qr[zr++],pn),Lo(pn,fr,vr,kr,Xi,qi),vr+=kr,qi+=kr),++ur&Ir||(Ji+=br)}break;case 3:if(Qi==Xi&&dr==qi&&0<Ji.b){for(vr=Xi,Qi=fr=qi+(Cr-ur)*fr-(Pr=(Cr-ur)*mr(Ji.Ea,Ji.b)),dr=Xi,Ir=qi,br=[],Pr=(kr=Pr)-1;0<=Pr;--Pr)br[Pr]=dr[Ir+Pr];for(Pr=kr-1;0<=Pr;--Pr)vr[Qi+Pr]=br[Pr];rl(Ji,ur,Cr,Xi,fr,Xi,qi)}else rl(Ji,ur,Cr,Qi,dr,Xi,qi)}qi=Ri,Xi=Pi}Xi!=Pi&&ei(Ri,Pi,qi,Xi,ji)}function _s(mi,Ci){var Pi=mi.V,Ri=mi.Ba+mi.c*mi.C,Bi=Ci-mi.C;if(e(Ci<=mi.l.o),e(16>=Bi),0<Bi){var ji=mi.l,Hi=mi.Ta,qi=mi.Ua,Xi=ji.width;if(Is(mi,Bi,Pi,Ri),Bi=qi=[qi],e((Pi=mi.C)<(Ri=Ci)),e(ji.v<ji.va),Ri>ji.o&&(Ri=ji.o),Pi<ji.j){var Ji=ji.j-Pi;Pi=ji.j,Bi[0]+=Ji*Xi}if(Pi>=Ri?Pi=0:(Bi[0]+=4*ji.v,ji.ka=Pi-ji.j,ji.U=ji.va-ji.v,ji.T=Ri-Pi,Pi=1),Pi){if(qi=qi[0],11>(Pi=mi.ca).S){var ur=Pi.f.RGBA,Cr=(Ri=Pi.S,Bi=ji.U,ji=ji.T,Ji=ur.eb,ur.A),Qi=ji;for(ur=ur.fb+mi.Ma*ur.A;0<Qi--;){var dr=Hi,fr=qi,br=Bi,vr=Ji,Ir=ur;switch(Ri){case al:To(dr,fr,br,vr,Ir);break;case ol:ba(dr,fr,br,vr,Ir);break;case $l:ba(dr,fr,br,vr,Ir),Mo(vr,Ir,0,br,1,0);break;case Ec:qa(dr,fr,br,vr,Ir);break;case ll:Dr(dr,fr,br,vr,Ir,1);break;case Hl:Dr(dr,fr,br,vr,Ir,1),Mo(vr,Ir,0,br,1,0);break;case cl:Dr(dr,fr,br,vr,Ir,0);break;case ul:Dr(dr,fr,br,vr,Ir,0),Mo(vr,Ir,1,br,1,0);break;case jl:Sa(dr,fr,br,vr,Ir);break;case Wl:Sa(dr,fr,br,vr,Ir),pc(vr,Ir,br,1,0);break;case bc:Ia(dr,fr,br,vr,Ir);break;default:e(0)}qi+=Xi,ur+=Cr}mi.Ma+=ji}else alert("todo:EmitRescaledRowsYUVA");e(mi.Ma<=Pi.height)}}mi.C=Ci,e(mi.C<=mi.i)}function Cs(mi){var Ci;if(0<mi.ua)return 0;for(Ci=0;Ci<mi.Wb;++Ci){var Pi=mi.Ya[Ci].G,Ri=mi.Ya[Ci].H;if(0<Pi[1][Ri[1]+0].g||0<Pi[2][Ri[2]+0].g||0<Pi[3][Ri[3]+0].g)return 0}return 1}function ks(mi,Ci,Pi,Ri,Bi,ji){if(mi.Z!=0){var Hi=mi.qd,qi=mi.rd;for(e(Pa[mi.Z]!=null);Ci<Pi;++Ci)Pa[mi.Z](Hi,qi,Ri,Bi,Ri,Bi,ji),Hi=Ri,qi=Bi,Bi+=ji;mi.qd=Hi,mi.rd=qi}}function As(mi,Ci){var Pi=mi.l.ma,Ri=Pi.Z==0||Pi.Z==1?mi.l.j:mi.C;if(Ri=mi.C<Ri?Ri:mi.C,e(Ci<=mi.l.o),Ci>Ri){var Bi=mi.l.width,ji=Pi.ca,Hi=Pi.tb+Bi*Ri,qi=mi.V,Xi=mi.Ba+mi.c*Ri,Ji=mi.gc;e(mi.ab==1),e(Ji[0].hc==3),Js(Ji[0],Ri,Ci,qi,Xi,ji,Hi),ks(Pi,Ri,Ci,ji,Hi,Bi)}mi.C=mi.Ma=Ci}function as(mi,Ci,Pi,Ri,Bi,ji,Hi){var qi=mi.$/Ri,Xi=mi.$%Ri,Ji=mi.m,ur=mi.s,Cr=Pi+mi.$,Qi=Cr;Bi=Pi+Ri*Bi;var dr=Pi+Ri*ji,fr=280+ur.ua,br=mi.Pb?qi:16777216,vr=0<ur.ua?ur.Wa:null,Ir=ur.wc,Pr=Cr<dr?Ln(ur,Xi,qi):null;e(mi.C<ji),e(dr<=Bi);var kr=!1;e:for(;;){for(;kr||Cr<dr;){var Tr=0;if(qi>=br){var Qr=Cr-Pi;e((br=mi).Pb),br.wd=br.m,br.xd=Qr,0<br.s.ua&&gr(br.s.Wa,br.s.vb),br=qi+su}if(Xi&Ir||(Pr=Ln(ur,Xi,qi)),e(Pr!=null),Pr.Qb&&(Ci[Cr]=Pr.qb,kr=!0),!kr)if(Yi(Ji),Pr.jc){Tr=Ji,Qr=Ci;var zr=Cr,pn=Pr.pd[xi(Tr)&za-1];e(Pr.jc),256>pn.g?(Ui(Tr,Tr.u+pn.g),Qr[zr]=pn.value,Tr=0):(Ui(Tr,Tr.u+pn.g-256),e(256<=pn.value),Tr=pn.value),Tr==0&&(kr=!0)}else Tr=yn(Pr.G[0],Pr.H[0],Ji);if(Ji.h)break;if(kr||256>Tr){if(!kr)if(Pr.nd)Ci[Cr]=(Pr.qb|Tr<<8)>>>0;else{if(Yi(Ji),kr=yn(Pr.G[1],Pr.H[1],Ji),Yi(Ji),Qr=yn(Pr.G[2],Pr.H[2],Ji),zr=yn(Pr.G[3],Pr.H[3],Ji),Ji.h)break;Ci[Cr]=(zr<<24|kr<<16|Tr<<8|Qr)>>>0}if(kr=!1,++Cr,++Xi>=Ri&&(Xi=0,++qi,Hi!=null&&qi<=ji&&!(qi%16)&&Hi(mi,qi),vr!=null))for(;Qi<Cr;)Tr=Ci[Qi++],vr.X[(506832829*Tr&4294967295)>>>vr.Mb]=Tr}else if(280>Tr){if(Tr=mn(Tr-256,Ji),Qr=yn(Pr.G[4],Pr.H[4],Ji),Yi(Ji),Qr=bn(Ri,Qr=mn(Qr,Ji)),Ji.h)break;if(Cr-Pi<Qr||Bi-Cr<Tr)break e;for(zr=0;zr<Tr;++zr)Ci[Cr+zr]=Ci[Cr+zr-Qr];for(Cr+=Tr,Xi+=Tr;Xi>=Ri;)Xi-=Ri,++qi,Hi!=null&&qi<=ji&&!(qi%16)&&Hi(mi,qi);if(e(Cr<=Bi),Xi&Ir&&(Pr=Ln(ur,Xi,qi)),vr!=null)for(;Qi<Cr;)Tr=Ci[Qi++],vr.X[(506832829*Tr&4294967295)>>>vr.Mb]=Tr}else{if(!(Tr<fr))break e;for(kr=Tr-280,e(vr!=null);Qi<Cr;)Tr=Ci[Qi++],vr.X[(506832829*Tr&4294967295)>>>vr.Mb]=Tr;Tr=Cr,e(!(kr>>>(Qr=vr).Xa)),Ci[Tr]=Qr.X[kr],kr=!0}kr||e(Ji.h==Mi(Ji))}if(mi.Pb&&Ji.h&&Cr<Bi)e(mi.m.h),mi.a=5,mi.m=mi.wd,mi.$=mi.xd,0<mi.s.ua&&gr(mi.s.vb,mi.s.Wa);else{if(Ji.h)break e;Hi!=null&&Hi(mi,qi>ji?ji:qi),mi.a=0,mi.$=Cr-Pi}return 1}return mi.a=3,0}function ls(mi){e(mi!=null),mi.vc=null,mi.yc=null,mi.Ya=null;var Ci=mi.Wa;Ci!=null&&(Ci.X=null),mi.vb=null,e(mi!=null)}function Na(){var mi=new cn;return mi==null?null:(mi.a=0,mi.xb=wc,rn("Predictor","VP8LPredictors"),rn("Predictor","VP8LPredictors_C"),rn("PredictorAdd","VP8LPredictorsAdd"),rn("PredictorAdd","VP8LPredictorsAdd_C"),Hn=Rr,Lo=Gr,To=nn,ba=en,Sa=Vr,Ia=Xr,qa=tn,wi.VP8LMapColor32b=Zs,wi.VP8LMapColor8b=xo,mi)}function Vs(mi,Ci,Pi,Ri,Bi){var ji=1,Hi=[mi],qi=[Ci],Xi=Ri.m,Ji=Ri.s,ur=null,Cr=0;e:for(;;){if(Pi)for(;ji&&Wi(Xi,1);){var Qi=Hi,dr=qi,fr=Ri,br=1,vr=fr.m,Ir=fr.gc[fr.ab],Pr=Wi(vr,2);if(fr.Oc&1<<Pr)ji=0;else{switch(fr.Oc|=1<<Pr,Ir.hc=Pr,Ir.Ea=Qi[0],Ir.nc=dr[0],Ir.K=[null],++fr.ab,e(4>=fr.ab),Pr){case 0:case 1:Ir.b=Wi(vr,3)+2,br=Vs(mr(Ir.Ea,Ir.b),mr(Ir.nc,Ir.b),0,fr,Ir.K),Ir.K=Ir.K[0];break;case 3:var kr,Tr=Wi(vr,8)+1,Qr=16<Tr?0:4<Tr?1:2<Tr?2:3;if(Qi[0]=mr(Ir.Ea,Qr),Ir.b=Qr,kr=br=Vs(Tr,1,0,fr,Ir.K)){var zr,pn=Tr,Kr=Ir,vn=1<<(8>>Kr.b),rs=ii(vn);if(rs==null)kr=0;else{var gn=Kr.K[0],Zr=Kr.w;for(rs[0]=Kr.K[0][0],zr=1;zr<1*pn;++zr)rs[zr]=Mr(gn[Zr+zr],rs[zr-1]);for(;zr<4*vn;++zr)rs[zr]=0;Kr.K[0]=null,Kr.K[0]=rs,kr=1}}br=kr;break;case 2:break;default:e(0)}ji=br}}if(Hi=Hi[0],qi=qi[0],ji&&Wi(Xi,1)&&!(ji=1<=(Cr=Wi(Xi,4))&&11>=Cr)){Ri.a=3;break e}var Hr;if(Hr=ji)t:{var zn,hn,_n,On=Ri,ds=Hi,ms=qi,Un=Cr,ps=Pi,ys=On.m,ns=On.s,An=[null],wn=1,jn=0,xn=nu[Un];i:for(;;){if(ps&&Wi(ys,1)){var hs=Wi(ys,3)+2,zs=mr(ds,hs),qn=mr(ms,hs),Es=zs*qn;if(!Vs(zs,qn,0,On,An))break i;for(An=An[0],ns.xc=hs,zn=0;zn<Es;++zn){var Mn=An[zn]>>8&65535;An[zn]=Mn,Mn>=wn&&(wn=Mn+1)}}if(ys.h)break i;for(hn=0;5>hn;++hn){var ss=Sc[hn];!hn&&0<Un&&(ss+=1<<Un),jn<ss&&(jn=ss)}var Ls=ri(wn*xn,Di),vs=wn,Ts=ri(vs,$i);if(Ts==null)var Rs=null;else e(65536>=vs),Rs=Ts;var bs=ii(jn);if(Rs==null||bs==null||Ls==null){On.a=1;break i}var Ms=Ls;for(zn=_n=0;zn<wn;++zn){var kn=Rs[zn],Ns=kn.G,qs=kn.H,Ya=0,ga=1,fs=0;for(hn=0;5>hn;++hn){ss=Sc[hn],Ns[hn]=Ms,qs[hn]=_n,!hn&&0<Un&&(ss+=1<<Un);n:{var gl,Yl=ss,ml=On,Oo=bs,Iu=Ms,wu=_n,Xl=0,La=ml.m,xu=Wi(La,1);if(ti(Oo,0,0,Yl),xu){var Pu=Wi(La,1)+1,Lu=Wi(La,1),kc=Wi(La,Lu==0?1:8);Oo[kc]=1,Pu==2&&(Oo[kc=Wi(La,8)]=1);var yl=1}else{var Oc=ii(19),Dc=Wi(La,4)+4;if(19<Dc){ml.a=3;var vl=0;break n}for(gl=0;gl<Dc;++gl)Oc[iu[gl]]=Wi(La,3);var Kl=void 0,Do=void 0,Gc=ml,Tu=Oc,_l=Yl,Fc=Oo,Zl=0,Ta=Gc.m,Bc=8,Uc=ri(128,Di);r:for(;Li(Uc,0,7,Tu,19);){if(Wi(Ta,1)){var Ru=2+2*Wi(Ta,3);if((Kl=2+Wi(Ta,Ru))>_l)break r}else Kl=_l;for(Do=0;Do<_l&&Kl--;){Yi(Ta);var jc=Uc[0+(127&xi(Ta))];Ui(Ta,Ta.u+jc.g);var oo=jc.value;if(16>oo)Fc[Do++]=oo,oo!=0&&(Bc=oo);else{var Mu=oo==16,$c=oo-16,Nu=eu[$c],Hc=Wi(Ta,Qc[$c])+Nu;if(Do+Hc>_l)break r;for(var ku=Mu?Bc:0;0<Hc--;)Fc[Do++]=ku}}Zl=1;break r}Zl||(Gc.a=3),yl=Zl}(yl=yl&&!La.h)&&(Xl=Li(Iu,wu,8,Oo,Yl)),yl&&Xl!=0?vl=Xl:(ml.a=3,vl=0)}if(vl==0)break i;if(ga&&tu[hn]==1&&(ga=Ms[_n].g==0),Ya+=Ms[_n].g,_n+=vl,3>=hn){var Go,Jl=bs[0];for(Go=1;Go<ss;++Go)bs[Go]>Jl&&(Jl=bs[Go]);fs+=Jl}}if(kn.nd=ga,kn.Qb=0,ga&&(kn.qb=(Ns[3][qs[3]+0].value<<24|Ns[1][qs[1]+0].value<<16|Ns[2][qs[2]+0].value)>>>0,Ya==0&&256>Ns[0][qs[0]+0].value&&(kn.Qb=1,kn.qb+=Ns[0][qs[0]+0].value<<8)),kn.jc=!kn.Qb&&6>fs,kn.jc){var Cl,ma=kn;for(Cl=0;Cl<za;++Cl){var Ra=Cl,Ma=ma.pd[Ra],Al=ma.G[0][ma.H[0]+Ra];256<=Al.value?(Ma.g=Al.g+256,Ma.value=Al.value):(Ma.g=0,Ma.value=0,Ra>>=Fn(Al,8,Ma),Ra>>=Fn(ma.G[1][ma.H[1]+Ra],16,Ma),Ra>>=Fn(ma.G[2][ma.H[2]+Ra],0,Ma),Fn(ma.G[3][ma.H[3]+Ra],24,Ma))}}}ns.vc=An,ns.Wb=wn,ns.Ya=Rs,ns.yc=Ls,Hr=1;break t}Hr=0}if(!(ji=Hr)){Ri.a=3;break e}if(0<Cr){if(Ji.ua=1<<Cr,!Gi(Ji.Wa,Cr)){Ri.a=1,ji=0;break e}}else Ji.ua=0;var Ql=Ri,Wc=Hi,Ou=qi,ec=Ql.s,tc=ec.xc;if(Ql.c=Wc,Ql.i=Ou,ec.md=mr(Wc,tc),ec.wc=tc==0?-1:(1<<tc)-1,Pi){Ri.xb=hu;break e}if((ur=ii(Hi*qi))==null){Ri.a=1,ji=0;break e}ji=(ji=as(Ri,ur,0,Hi,qi,qi,null))&&!Xi.h;break e}return ji?(Bi!=null?Bi[0]=ur:(e(ur==null),e(Pi)),Ri.$=0,Pi||ls(Ji)):ls(Ji),ji}function ka(mi,Ci){var Pi=mi.c*mi.i,Ri=Pi+Ci+16*Ci;return e(mi.c<=Ci),mi.V=ii(Ri),mi.V==null?(mi.Ta=null,mi.Ua=0,mi.a=1,0):(mi.Ta=mi.V,mi.Ua=mi.Ba+Pi+Ci,1)}function Xa(mi,Ci){var Pi=mi.C,Ri=Ci-Pi,Bi=mi.V,ji=mi.Ba+mi.c*Pi;for(e(Ci<=mi.l.o);0<Ri;){var Hi=16<Ri?16:Ri,qi=mi.l.ma,Xi=mi.l.width,Ji=Xi*Hi,ur=qi.ca,Cr=qi.tb+Xi*Pi,Qi=mi.Ta,dr=mi.Ua;Is(mi,Hi,Bi,ji),mc(Qi,dr,ur,Cr,Ji),ks(qi,Pi,Pi+Hi,ur,Cr,Xi),Ri-=Hi,Bi+=Hi*mi.c,Pi+=Hi}e(Pi==Ci),mi.C=mi.Ma=Ci}function Ka(){this.ub=this.yd=this.td=this.Rb=0}function Za(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Sl(){this.Fb=this.Bb=this.Cb=0,this.Zb=ii(4),this.Lb=ii(4)}function co(){this.Yb=(function(){var mi=[];return(function Ci(Pi,Ri,Bi){for(var ji=Bi[Ri],Hi=0;Hi<ji&&(Pi.push(Bi.length>Ri+1?[]:0),!(Bi.length<Ri+1));Hi++)Ci(Pi[Hi],Ri+1,Bi)})(mi,0,[3,11]),mi})()}function Bo(){this.jb=ii(3),this.Wc=ni([4,8],co),this.Xc=ni([4,17],co)}function Uo(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new ii(4),this.od=new ii(4)}function Os(){this.ld=this.La=this.dd=this.tc=0}function uo(){this.Na=this.la=0}function jo(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function ho(){this.ad=ii(384),this.Za=0,this.Ob=ii(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function $o(){this.uc=this.M=this.Nb=0,this.wa=Array(new Os),this.Y=0,this.ya=Array(new ho),this.aa=0,this.l=new Ja}function Ho(){this.y=ii(16),this.f=ii(8),this.ea=ii(8)}function Wo(){this.cb=this.a=0,this.sc="",this.m=new Ti,this.Od=new Ka,this.Kc=new Za,this.ed=new Uo,this.Qa=new Sl,this.Ic=this.$c=this.Aa=0,this.D=new $o,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=ri(8,Ti),this.ia=0,this.pb=ri(4,jo),this.Pa=new Bo,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Ho),this.Hd=0,this.rb=Array(new uo),this.sb=0,this.wa=Array(new Os),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new ho),this.L=this.aa=0,this.gd=ni([4,2],Os),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Ys(mi,Ci){return 0>mi?0:mi>Ci?Ci:mi}function Ja(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Il(){var mi=new Wo;return mi!=null&&(mi.a=0,mi.sc="OK",mi.cb=0,mi.Xb=0,No||(No=Qa)),mi}function Vn(mi,Ci,Pi){return mi.a==0&&(mi.a=Ci,mi.sc=Pi,mi.cb=0),0}function zo(mi,Ci,Pi){return 3<=Pi&&mi[Ci+0]==157&&mi[Ci+1]==1&&mi[Ci+2]==42}function Xs(mi,Ci){if(mi==null)return 0;if(mi.a=0,mi.sc="OK",Ci==null)return Vn(mi,2,"null VP8Io passed to VP8GetHeaders()");var Pi=Ci.data,Ri=Ci.w,Bi=Ci.ha;if(4>Bi)return Vn(mi,7,"Truncated header.");var ji=Pi[Ri+0]|Pi[Ri+1]<<8|Pi[Ri+2]<<16,Hi=mi.Od;if(Hi.Rb=!(1&ji),Hi.td=ji>>1&7,Hi.yd=ji>>4&1,Hi.ub=ji>>5,3<Hi.td)return Vn(mi,3,"Incorrect keyframe parameters.");if(!Hi.yd)return Vn(mi,4,"Frame not displayable.");Ri+=3,Bi-=3;var qi=mi.Kc;if(Hi.Rb){if(7>Bi)return Vn(mi,7,"cannot parse picture header");if(!zo(Pi,Ri,Bi))return Vn(mi,3,"Bad code word");qi.c=16383&(Pi[Ri+4]<<8|Pi[Ri+3]),qi.Td=Pi[Ri+4]>>6,qi.i=16383&(Pi[Ri+6]<<8|Pi[Ri+5]),qi.Ud=Pi[Ri+6]>>6,Ri+=7,Bi-=7,mi.za=qi.c+15>>4,mi.Ub=qi.i+15>>4,Ci.width=qi.c,Ci.height=qi.i,Ci.Da=0,Ci.j=0,Ci.v=0,Ci.va=Ci.width,Ci.o=Ci.height,Ci.da=0,Ci.ib=Ci.width,Ci.hb=Ci.height,Ci.U=Ci.width,Ci.T=Ci.height,ti((ji=mi.Pa).jb,0,255,ji.jb.length),e((ji=mi.Qa)!=null),ji.Cb=0,ji.Bb=0,ji.Fb=1,ti(ji.Zb,0,0,ji.Zb.length),ti(ji.Lb,0,0,ji.Lb)}if(Hi.ub>Bi)return Vn(mi,7,"bad partition length");Ki(ji=mi.m,Pi,Ri,Hi.ub),Ri+=Hi.ub,Bi-=Hi.ub,Hi.Rb&&(qi.Ld=cr(ji),qi.Kd=cr(ji)),qi=mi.Qa;var Xi,Ji=mi.Pa;if(e(ji!=null),e(qi!=null),qi.Cb=cr(ji),qi.Cb){if(qi.Bb=cr(ji),cr(ji)){for(qi.Fb=cr(ji),Xi=0;4>Xi;++Xi)qi.Zb[Xi]=cr(ji)?Vi(ji,7):0;for(Xi=0;4>Xi;++Xi)qi.Lb[Xi]=cr(ji)?Vi(ji,6):0}if(qi.Bb)for(Xi=0;3>Xi;++Xi)Ji.jb[Xi]=cr(ji)?er(ji,8):255}else qi.Bb=0;if(ji.Ka)return Vn(mi,3,"cannot parse segment header");if((qi=mi.ed).zd=cr(ji),qi.Tb=er(ji,6),qi.wb=er(ji,3),qi.Pc=cr(ji),qi.Pc&&cr(ji)){for(Ji=0;4>Ji;++Ji)cr(ji)&&(qi.vd[Ji]=Vi(ji,6));for(Ji=0;4>Ji;++Ji)cr(ji)&&(qi.od[Ji]=Vi(ji,6))}if(mi.L=qi.Tb==0?0:qi.zd?1:2,ji.Ka)return Vn(mi,3,"cannot parse filter header");var ur=Bi;if(Bi=Xi=Ri,Ri=Xi+ur,qi=ur,mi.Xb=(1<<er(mi.m,2))-1,ur<3*(Ji=mi.Xb))Pi=7;else{for(Xi+=3*Ji,qi-=3*Ji,ur=0;ur<Ji;++ur){var Cr=Pi[Bi+0]|Pi[Bi+1]<<8|Pi[Bi+2]<<16;Cr>qi&&(Cr=qi),Ki(mi.Jc[+ur],Pi,Xi,Cr),Xi+=Cr,qi-=Cr,Bi+=3}Ki(mi.Jc[+Ji],Pi,Xi,qi),Pi=Xi<Ri?0:5}if(Pi!=0)return Vn(mi,Pi,"cannot parse partitions");for(Pi=er(Xi=mi.m,7),Bi=cr(Xi)?Vi(Xi,4):0,Ri=cr(Xi)?Vi(Xi,4):0,qi=cr(Xi)?Vi(Xi,4):0,Ji=cr(Xi)?Vi(Xi,4):0,Xi=cr(Xi)?Vi(Xi,4):0,ur=mi.Qa,Cr=0;4>Cr;++Cr){if(ur.Cb){var Qi=ur.Zb[Cr];ur.Fb||(Qi+=Pi)}else{if(0<Cr){mi.pb[Cr]=mi.pb[0];continue}Qi=Pi}var dr=mi.pb[Cr];dr.Sc[0]=zl[Ys(Qi+Bi,127)],dr.Sc[1]=ql[Ys(Qi+0,127)],dr.Eb[0]=2*zl[Ys(Qi+Ri,127)],dr.Eb[1]=101581*ql[Ys(Qi+qi,127)]>>16,8>dr.Eb[1]&&(dr.Eb[1]=8),dr.Qc[0]=zl[Ys(Qi+Ji,117)],dr.Qc[1]=ql[Ys(Qi+Xi,127)],dr.lc=Qi+Xi}if(!Hi.Rb)return Vn(mi,4,"Not a key frame.");for(cr(ji),Hi=mi.Pa,Pi=0;4>Pi;++Pi){for(Bi=0;8>Bi;++Bi)for(Ri=0;3>Ri;++Ri)for(qi=0;11>qi;++qi)Ji=ir(ji,uu[Pi][Bi][Ri][qi])?er(ji,8):lu[Pi][Bi][Ri][qi],Hi.Wc[Pi][Bi].Yb[Ri][qi]=Ji;for(Bi=0;17>Bi;++Bi)Hi.Xc[Pi][Bi]=Hi.Wc[Pi][du[Bi]]}return mi.kc=cr(ji),mi.kc&&(mi.Bd=er(ji,8)),mi.cb=1}function Qa(mi,Ci,Pi,Ri,Bi,ji,Hi){var qi=Ci[Bi].Yb[Pi];for(Pi=0;16>Bi;++Bi){if(!ir(mi,qi[Pi+0]))return Bi;for(;!ir(mi,qi[Pi+1]);)if(qi=Ci[++Bi].Yb[0],Pi=0,Bi==16)return 16;var Xi=Ci[Bi+1].Yb;if(ir(mi,qi[Pi+2])){var Ji=mi,ur=0;if(ir(Ji,(Qi=qi)[(Cr=Pi)+3]))if(ir(Ji,Qi[Cr+6])){for(qi=0,Cr=2*(ur=ir(Ji,Qi[Cr+8]))+(Qi=ir(Ji,Qi[Cr+9+ur])),ur=0,Qi=au[Cr];Qi[qi];++qi)ur+=ur+ir(Ji,Qi[qi]);ur+=3+(8<<Cr)}else ir(Ji,Qi[Cr+7])?(ur=7+2*ir(Ji,165),ur+=ir(Ji,145)):ur=5+ir(Ji,159);else ur=ir(Ji,Qi[Cr+4])?3+ir(Ji,Qi[Cr+5]):2;qi=Xi[2]}else ur=1,qi=Xi[1];Xi=Hi+ou[Bi],0>(Ji=mi).b&&sr(Ji);var Cr,Qi=Ji.b,dr=(Cr=Ji.Ca>>1)-(Ji.I>>Qi)>>31;--Ji.b,Ji.Ca+=dr,Ji.Ca|=1,Ji.I-=(Cr+1&dr)<<Qi,ji[Xi]=((ur^dr)-dr)*Ri[(0<Bi)+0]}return 16}function qo(mi){var Ci=mi.rb[mi.sb-1];Ci.la=0,Ci.Na=0,ti(mi.zc,0,0,mi.zc.length),mi.ja=0}function Ds(mi,Ci,Pi,Ri,Bi){Bi=mi[Ci+Pi+32*Ri]+(Bi>>3),mi[Ci+Pi+32*Ri]=-256&Bi?0>Bi?0:255:Bi}function es(mi,Ci,Pi,Ri,Bi,ji){Ds(mi,Ci,0,Pi,Ri+Bi),Ds(mi,Ci,1,Pi,Ri+ji),Ds(mi,Ci,2,Pi,Ri-ji),Ds(mi,Ci,3,Pi,Ri-Bi)}function ta(mi){return(20091*mi>>16)+mi}function Vo(mi,Ci,Pi,Ri){var Bi,ji=0,Hi=ii(16);for(Bi=0;4>Bi;++Bi){var qi=mi[Ci+0]+mi[Ci+8],Xi=mi[Ci+0]-mi[Ci+8],Ji=(35468*mi[Ci+4]>>16)-ta(mi[Ci+12]),ur=ta(mi[Ci+4])+(35468*mi[Ci+12]>>16);Hi[ji+0]=qi+ur,Hi[ji+1]=Xi+Ji,Hi[ji+2]=Xi-Ji,Hi[ji+3]=qi-ur,ji+=4,Ci++}for(Bi=ji=0;4>Bi;++Bi)qi=(mi=Hi[ji+0]+4)+Hi[ji+8],Xi=mi-Hi[ji+8],Ji=(35468*Hi[ji+4]>>16)-ta(Hi[ji+12]),Ds(Pi,Ri,0,0,qi+(ur=ta(Hi[ji+4])+(35468*Hi[ji+12]>>16))),Ds(Pi,Ri,1,0,Xi+Ji),Ds(Pi,Ri,2,0,Xi-Ji),Ds(Pi,Ri,3,0,qi-ur),ji++,Ri+=32}function wl(mi,Ci,Pi,Ri){var Bi=mi[Ci+0]+4,ji=35468*mi[Ci+4]>>16,Hi=ta(mi[Ci+4]),qi=35468*mi[Ci+1]>>16;es(Pi,Ri,0,Bi+Hi,mi=ta(mi[Ci+1]),qi),es(Pi,Ri,1,Bi+ji,mi,qi),es(Pi,Ri,2,Bi-ji,mi,qi),es(Pi,Ri,3,Bi-Hi,mi,qi)}function xl(mi,Ci,Pi,Ri,Bi){Vo(mi,Ci,Pi,Ri),Bi&&Vo(mi,Ci+16,Pi,Ri+4)}function Ks(mi,Ci,Pi,Ri){Va(mi,Ci+0,Pi,Ri,1),Va(mi,Ci+32,Pi,Ri+128,1)}function Yo(mi,Ci,Pi,Ri){var Bi;for(mi=mi[Ci+0]+4,Bi=0;4>Bi;++Bi)for(Ci=0;4>Ci;++Ci)Ds(Pi,Ri,Ci,Bi,mi)}function Xo(mi,Ci,Pi,Ri){mi[Ci+0]&&Sn(mi,Ci+0,Pi,Ri),mi[Ci+16]&&Sn(mi,Ci+16,Pi,Ri+4),mi[Ci+32]&&Sn(mi,Ci+32,Pi,Ri+128),mi[Ci+48]&&Sn(mi,Ci+48,Pi,Ri+128+4)}function eo(mi,Ci,Pi,Ri){var Bi,ji=ii(16);for(Bi=0;4>Bi;++Bi){var Hi=mi[Ci+0+Bi]+mi[Ci+12+Bi],qi=mi[Ci+4+Bi]+mi[Ci+8+Bi],Xi=mi[Ci+4+Bi]-mi[Ci+8+Bi],Ji=mi[Ci+0+Bi]-mi[Ci+12+Bi];ji[0+Bi]=Hi+qi,ji[8+Bi]=Hi-qi,ji[4+Bi]=Ji+Xi,ji[12+Bi]=Ji-Xi}for(Bi=0;4>Bi;++Bi)Hi=(mi=ji[0+4*Bi]+3)+ji[3+4*Bi],qi=ji[1+4*Bi]+ji[2+4*Bi],Xi=ji[1+4*Bi]-ji[2+4*Bi],Ji=mi-ji[3+4*Bi],Pi[Ri+0]=Hi+qi>>3,Pi[Ri+16]=Ji+Xi>>3,Pi[Ri+32]=Hi-qi>>3,Pi[Ri+48]=Ji-Xi>>3,Ri+=64}function Oa(mi,Ci,Pi){var Ri,Bi=Ci-32,ji=Ps,Hi=255-mi[Bi-1];for(Ri=0;Ri<Pi;++Ri){var qi,Xi=ji,Ji=Hi+mi[Ci-1];for(qi=0;qi<Pi;++qi)mi[Ci+qi]=Xi[Ji+mi[Bi+qi]];Ci+=32}}function Pl(mi,Ci){Oa(mi,Ci,4)}function Ll(mi,Ci){Oa(mi,Ci,8)}function Tl(mi,Ci){Oa(mi,Ci,16)}function fo(mi,Ci){var Pi;for(Pi=0;16>Pi;++Pi)ei(mi,Ci+32*Pi,mi,Ci-32,16)}function Ko(mi,Ci){var Pi;for(Pi=16;0<Pi;--Pi)ti(mi,Ci,mi[Ci-1],16),Ci+=32}function $s(mi,Ci,Pi){var Ri;for(Ri=0;16>Ri;++Ri)ti(Ci,Pi+32*Ri,mi,16)}function Rl(mi,Ci){var Pi,Ri=16;for(Pi=0;16>Pi;++Pi)Ri+=mi[Ci-1+32*Pi]+mi[Ci+Pi-32];$s(Ri>>5,mi,Ci)}function Da(mi,Ci){var Pi,Ri=8;for(Pi=0;16>Pi;++Pi)Ri+=mi[Ci-1+32*Pi];$s(Ri>>4,mi,Ci)}function po(mi,Ci){var Pi,Ri=8;for(Pi=0;16>Pi;++Pi)Ri+=mi[Ci+Pi-32];$s(Ri>>4,mi,Ci)}function Ml(mi,Ci){$s(128,mi,Ci)}function dn(mi,Ci,Pi){return mi+2*Ci+Pi+2>>2}function Nl(mi,Ci){var Pi,Ri=Ci-32;for(Ri=new Uint8Array([dn(mi[Ri-1],mi[Ri+0],mi[Ri+1]),dn(mi[Ri+0],mi[Ri+1],mi[Ri+2]),dn(mi[Ri+1],mi[Ri+2],mi[Ri+3]),dn(mi[Ri+2],mi[Ri+3],mi[Ri+4])]),Pi=0;4>Pi;++Pi)ei(mi,Ci+32*Pi,Ri,0,Ri.length)}function kl(mi,Ci){var Pi=mi[Ci-1],Ri=mi[Ci-1+32],Bi=mi[Ci-1+64],ji=mi[Ci-1+96];Zi(mi,Ci+0,16843009*dn(mi[Ci-1-32],Pi,Ri)),Zi(mi,Ci+32,16843009*dn(Pi,Ri,Bi)),Zi(mi,Ci+64,16843009*dn(Ri,Bi,ji)),Zi(mi,Ci+96,16843009*dn(Bi,ji,ji))}function Ol(mi,Ci){var Pi,Ri=4;for(Pi=0;4>Pi;++Pi)Ri+=mi[Ci+Pi-32]+mi[Ci-1+32*Pi];for(Ri>>=3,Pi=0;4>Pi;++Pi)ti(mi,Ci+32*Pi,Ri,4)}function ia(mi,Ci){var Pi=mi[Ci-1+0],Ri=mi[Ci-1+32],Bi=mi[Ci-1+64],ji=mi[Ci-1-32],Hi=mi[Ci+0-32],qi=mi[Ci+1-32],Xi=mi[Ci+2-32],Ji=mi[Ci+3-32];mi[Ci+0+96]=dn(Ri,Bi,mi[Ci-1+96]),mi[Ci+1+96]=mi[Ci+0+64]=dn(Pi,Ri,Bi),mi[Ci+2+96]=mi[Ci+1+64]=mi[Ci+0+32]=dn(ji,Pi,Ri),mi[Ci+3+96]=mi[Ci+2+64]=mi[Ci+1+32]=mi[Ci+0+0]=dn(Hi,ji,Pi),mi[Ci+3+64]=mi[Ci+2+32]=mi[Ci+1+0]=dn(qi,Hi,ji),mi[Ci+3+32]=mi[Ci+2+0]=dn(Xi,qi,Hi),mi[Ci+3+0]=dn(Ji,Xi,qi)}function ra(mi,Ci){var Pi=mi[Ci+1-32],Ri=mi[Ci+2-32],Bi=mi[Ci+3-32],ji=mi[Ci+4-32],Hi=mi[Ci+5-32],qi=mi[Ci+6-32],Xi=mi[Ci+7-32];mi[Ci+0+0]=dn(mi[Ci+0-32],Pi,Ri),mi[Ci+1+0]=mi[Ci+0+32]=dn(Pi,Ri,Bi),mi[Ci+2+0]=mi[Ci+1+32]=mi[Ci+0+64]=dn(Ri,Bi,ji),mi[Ci+3+0]=mi[Ci+2+32]=mi[Ci+1+64]=mi[Ci+0+96]=dn(Bi,ji,Hi),mi[Ci+3+32]=mi[Ci+2+64]=mi[Ci+1+96]=dn(ji,Hi,qi),mi[Ci+3+64]=mi[Ci+2+96]=dn(Hi,qi,Xi),mi[Ci+3+96]=dn(qi,Xi,Xi)}function Dl(mi,Ci){var Pi=mi[Ci-1+0],Ri=mi[Ci-1+32],Bi=mi[Ci-1+64],ji=mi[Ci-1-32],Hi=mi[Ci+0-32],qi=mi[Ci+1-32],Xi=mi[Ci+2-32],Ji=mi[Ci+3-32];mi[Ci+0+0]=mi[Ci+1+64]=ji+Hi+1>>1,mi[Ci+1+0]=mi[Ci+2+64]=Hi+qi+1>>1,mi[Ci+2+0]=mi[Ci+3+64]=qi+Xi+1>>1,mi[Ci+3+0]=Xi+Ji+1>>1,mi[Ci+0+96]=dn(Bi,Ri,Pi),mi[Ci+0+64]=dn(Ri,Pi,ji),mi[Ci+0+32]=mi[Ci+1+96]=dn(Pi,ji,Hi),mi[Ci+1+32]=mi[Ci+2+96]=dn(ji,Hi,qi),mi[Ci+2+32]=mi[Ci+3+96]=dn(Hi,qi,Xi),mi[Ci+3+32]=dn(qi,Xi,Ji)}function Gl(mi,Ci){var Pi=mi[Ci+0-32],Ri=mi[Ci+1-32],Bi=mi[Ci+2-32],ji=mi[Ci+3-32],Hi=mi[Ci+4-32],qi=mi[Ci+5-32],Xi=mi[Ci+6-32],Ji=mi[Ci+7-32];mi[Ci+0+0]=Pi+Ri+1>>1,mi[Ci+1+0]=mi[Ci+0+64]=Ri+Bi+1>>1,mi[Ci+2+0]=mi[Ci+1+64]=Bi+ji+1>>1,mi[Ci+3+0]=mi[Ci+2+64]=ji+Hi+1>>1,mi[Ci+0+32]=dn(Pi,Ri,Bi),mi[Ci+1+32]=mi[Ci+0+96]=dn(Ri,Bi,ji),mi[Ci+2+32]=mi[Ci+1+96]=dn(Bi,ji,Hi),mi[Ci+3+32]=mi[Ci+2+96]=dn(ji,Hi,qi),mi[Ci+3+64]=dn(Hi,qi,Xi),mi[Ci+3+96]=dn(qi,Xi,Ji)}function to(mi,Ci){var Pi=mi[Ci-1+0],Ri=mi[Ci-1+32],Bi=mi[Ci-1+64],ji=mi[Ci-1+96];mi[Ci+0+0]=Pi+Ri+1>>1,mi[Ci+2+0]=mi[Ci+0+32]=Ri+Bi+1>>1,mi[Ci+2+32]=mi[Ci+0+64]=Bi+ji+1>>1,mi[Ci+1+0]=dn(Pi,Ri,Bi),mi[Ci+3+0]=mi[Ci+1+32]=dn(Ri,Bi,ji),mi[Ci+3+32]=mi[Ci+1+64]=dn(Bi,ji,ji),mi[Ci+3+64]=mi[Ci+2+64]=mi[Ci+0+96]=mi[Ci+1+96]=mi[Ci+2+96]=mi[Ci+3+96]=ji}function go(mi,Ci){var Pi=mi[Ci-1+0],Ri=mi[Ci-1+32],Bi=mi[Ci-1+64],ji=mi[Ci-1+96],Hi=mi[Ci-1-32],qi=mi[Ci+0-32],Xi=mi[Ci+1-32],Ji=mi[Ci+2-32];mi[Ci+0+0]=mi[Ci+2+32]=Pi+Hi+1>>1,mi[Ci+0+32]=mi[Ci+2+64]=Ri+Pi+1>>1,mi[Ci+0+64]=mi[Ci+2+96]=Bi+Ri+1>>1,mi[Ci+0+96]=ji+Bi+1>>1,mi[Ci+3+0]=dn(qi,Xi,Ji),mi[Ci+2+0]=dn(Hi,qi,Xi),mi[Ci+1+0]=mi[Ci+3+32]=dn(Pi,Hi,qi),mi[Ci+1+32]=mi[Ci+3+64]=dn(Ri,Pi,Hi),mi[Ci+1+64]=mi[Ci+3+96]=dn(Bi,Ri,Pi),mi[Ci+1+96]=dn(ji,Bi,Ri)}function Ga(mi,Ci){var Pi;for(Pi=0;8>Pi;++Pi)ei(mi,Ci+32*Pi,mi,Ci-32,8)}function Fl(mi,Ci){var Pi;for(Pi=0;8>Pi;++Pi)ti(mi,Ci,mi[Ci-1],8),Ci+=32}function na(mi,Ci,Pi){var Ri;for(Ri=0;8>Ri;++Ri)ti(Ci,Pi+32*Ri,mi,8)}function Bl(mi,Ci){var Pi,Ri=8;for(Pi=0;8>Pi;++Pi)Ri+=mi[Ci+Pi-32]+mi[Ci-1+32*Pi];na(Ri>>4,mi,Ci)}function mo(mi,Ci){var Pi,Ri=4;for(Pi=0;8>Pi;++Pi)Ri+=mi[Ci+Pi-32];na(Ri>>3,mi,Ci)}function yo(mi,Ci){var Pi,Ri=4;for(Pi=0;8>Pi;++Pi)Ri+=mi[Ci-1+32*Pi];na(Ri>>3,mi,Ci)}function Zo(mi,Ci){na(128,mi,Ci)}function sa(mi,Ci,Pi){var Ri=mi[Ci-Pi],Bi=mi[Ci+0],ji=3*(Bi-Ri)+Ul[1020+mi[Ci-2*Pi]-mi[Ci+Pi]],Hi=sl[112+(ji+4>>3)];mi[Ci-Pi]=Ps[255+Ri+sl[112+(ji+3>>3)]],mi[Ci+0]=Ps[255+Bi-Hi]}function vo(mi,Ci,Pi,Ri){var Bi=mi[Ci+0],ji=mi[Ci+Pi];return Bs[255+mi[Ci-2*Pi]-mi[Ci-Pi]]>Ri||Bs[255+ji-Bi]>Ri}function io(mi,Ci,Pi,Ri){return 4*Bs[255+mi[Ci-Pi]-mi[Ci+0]]+Bs[255+mi[Ci-2*Pi]-mi[Ci+Pi]]<=Ri}function _o(mi,Ci,Pi,Ri,Bi){var ji=mi[Ci-3*Pi],Hi=mi[Ci-2*Pi],qi=mi[Ci-Pi],Xi=mi[Ci+0],Ji=mi[Ci+Pi],ur=mi[Ci+2*Pi],Cr=mi[Ci+3*Pi];return 4*Bs[255+qi-Xi]+Bs[255+Hi-Ji]>Ri?0:Bs[255+mi[Ci-4*Pi]-ji]<=Bi&&Bs[255+ji-Hi]<=Bi&&Bs[255+Hi-qi]<=Bi&&Bs[255+Cr-ur]<=Bi&&Bs[255+ur-Ji]<=Bi&&Bs[255+Ji-Xi]<=Bi}function Fa(mi,Ci,Pi,Ri){var Bi=2*Ri+1;for(Ri=0;16>Ri;++Ri)io(mi,Ci+Ri,Pi,Bi)&&sa(mi,Ci+Ri,Pi)}function Co(mi,Ci,Pi,Ri){var Bi=2*Ri+1;for(Ri=0;16>Ri;++Ri)io(mi,Ci+Ri*Pi,1,Bi)&&sa(mi,Ci+Ri*Pi,1)}function Jo(mi,Ci,Pi,Ri){var Bi;for(Bi=3;0<Bi;--Bi)Fa(mi,Ci+=4*Pi,Pi,Ri)}function Qo(mi,Ci,Pi,Ri){var Bi;for(Bi=3;0<Bi;--Bi)Co(mi,Ci+=4,Pi,Ri)}function aa(mi,Ci,Pi,Ri,Bi,ji,Hi,qi){for(ji=2*ji+1;0<Bi--;){if(_o(mi,Ci,Pi,ji,Hi))if(vo(mi,Ci,Pi,qi))sa(mi,Ci,Pi);else{var Xi=mi,Ji=Ci,ur=Pi,Cr=Xi[Ji-2*ur],Qi=Xi[Ji-ur],dr=Xi[Ji+0],fr=Xi[Ji+ur],br=Xi[Ji+2*ur],vr=27*(Pr=Ul[1020+3*(dr-Qi)+Ul[1020+Cr-fr]])+63>>7,Ir=18*Pr+63>>7,Pr=9*Pr+63>>7;Xi[Ji-3*ur]=Ps[255+Xi[Ji-3*ur]+Pr],Xi[Ji-2*ur]=Ps[255+Cr+Ir],Xi[Ji-ur]=Ps[255+Qi+vr],Xi[Ji+0]=Ps[255+dr-vr],Xi[Ji+ur]=Ps[255+fr-Ir],Xi[Ji+2*ur]=Ps[255+br-Pr]}Ci+=Ri}}function oa(mi,Ci,Pi,Ri,Bi,ji,Hi,qi){for(ji=2*ji+1;0<Bi--;){if(_o(mi,Ci,Pi,ji,Hi))if(vo(mi,Ci,Pi,qi))sa(mi,Ci,Pi);else{var Xi=mi,Ji=Ci,ur=Pi,Cr=Xi[Ji-ur],Qi=Xi[Ji+0],dr=Xi[Ji+ur],fr=sl[112+(4+(br=3*(Qi-Cr))>>3)],br=sl[112+(br+3>>3)],vr=fr+1>>1;Xi[Ji-2*ur]=Ps[255+Xi[Ji-2*ur]+vr],Xi[Ji-ur]=Ps[255+Cr+br],Xi[Ji+0]=Ps[255+Qi-fr],Xi[Ji+ur]=Ps[255+dr-vr]}Ci+=Ri}}function el(mi,Ci,Pi,Ri,Bi,ji){aa(mi,Ci,Pi,1,16,Ri,Bi,ji)}function Ba(mi,Ci,Pi,Ri,Bi,ji){aa(mi,Ci,1,Pi,16,Ri,Bi,ji)}function tl(mi,Ci,Pi,Ri,Bi,ji){var Hi;for(Hi=3;0<Hi;--Hi)oa(mi,Ci+=4*Pi,Pi,1,16,Ri,Bi,ji)}function bi(mi,Ci,Pi,Ri,Bi,ji){var Hi;for(Hi=3;0<Hi;--Hi)oa(mi,Ci+=4,1,Pi,16,Ri,Bi,ji)}function Fi(mi,Ci,Pi,Ri,Bi,ji,Hi,qi){aa(mi,Ci,Bi,1,8,ji,Hi,qi),aa(Pi,Ri,Bi,1,8,ji,Hi,qi)}function tr(mi,Ci,Pi,Ri,Bi,ji,Hi,qi){aa(mi,Ci,1,Bi,8,ji,Hi,qi),aa(Pi,Ri,1,Bi,8,ji,Hi,qi)}function lr(mi,Ci,Pi,Ri,Bi,ji,Hi,qi){oa(mi,Ci+4*Bi,Bi,1,8,ji,Hi,qi),oa(Pi,Ri+4*Bi,Bi,1,8,ji,Hi,qi)}function hr(mi,Ci,Pi,Ri,Bi,ji,Hi,qi){oa(mi,Ci+4,1,Bi,8,ji,Hi,qi),oa(Pi,Ri+4,1,Bi,8,ji,Hi,qi)}function xr(){this.ba=new sn,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new an,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Lr(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Yr(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Jr(){this.ua=0,this.Wa=new Br,this.vb=new Br,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new $i,this.yc=new Di}function cn(){this.xb=this.a=0,this.l=new Ja,this.ca=new sn,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new ki,this.Pb=0,this.wd=new ki,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Jr,this.ab=0,this.gc=ri(4,Yr),this.Oc=0}function fn(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Ja,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Cn(mi,Ci,Pi,Ri,Bi,ji,Hi){for(mi=mi==null?0:mi[Ci+0],Ci=0;Ci<Hi;++Ci)Bi[ji+Ci]=mi+Pi[Ri+Ci]&255,mi=Bi[ji+Ci]}function Bn(mi,Ci,Pi,Ri,Bi,ji,Hi){var qi;if(mi==null)Cn(null,null,Pi,Ri,Bi,ji,Hi);else for(qi=0;qi<Hi;++qi)Bi[ji+qi]=mi[Ci+qi]+Pi[Ri+qi]&255}function Kn(mi,Ci,Pi,Ri,Bi,ji,Hi){if(mi==null)Cn(null,null,Pi,Ri,Bi,ji,Hi);else{var qi,Xi=mi[Ci+0],Ji=Xi,ur=Xi;for(qi=0;qi<Hi;++qi)Ji=ur+(Xi=mi[Ci+qi])-Ji,ur=Pi[Ri+qi]+(-256&Ji?0>Ji?0:255:Ji)&255,Ji=Xi,Bi[ji+qi]=ur}}function Nn(mi,Ci,Pi,Ri){var Bi=Ci.width,ji=Ci.o;if(e(mi!=null&&Ci!=null),0>Pi||0>=Ri||Pi+Ri>ji)return null;if(!mi.Cc){if(mi.ga==null){var Hi;if(mi.ga=new fn,(Hi=mi.ga==null)||(Hi=Ci.width*Ci.o,e(mi.Gb.length==0),mi.Gb=ii(Hi),mi.Uc=0,mi.Gb==null?Hi=0:(mi.mb=mi.Gb,mi.nb=mi.Uc,mi.rc=null,Hi=1),Hi=!Hi),!Hi){Hi=mi.ga;var qi=mi.Fa,Xi=mi.P,Ji=mi.qc,ur=mi.mb,Cr=mi.nb,Qi=Xi+1,dr=Ji-1,fr=Hi.l;if(e(qi!=null&&ur!=null&&Ci!=null),Pa[0]=null,Pa[1]=Cn,Pa[2]=Bn,Pa[3]=Kn,Hi.ca=ur,Hi.tb=Cr,Hi.c=Ci.width,Hi.i=Ci.height,e(0<Hi.c&&0<Hi.i),1>=Ji)Ci=0;else if(Hi.$a=3&qi[Xi+0],Hi.Z=qi[Xi+0]>>2&3,Hi.Lc=qi[Xi+0]>>4&3,Xi=qi[Xi+0]>>6&3,0>Hi.$a||1<Hi.$a||4<=Hi.Z||1<Hi.Lc||Xi)Ci=0;else if(fr.put=Ur,fr.ac=Gn,fr.bc=Tn,fr.ma=Hi,fr.width=Ci.width,fr.height=Ci.height,fr.Da=Ci.Da,fr.v=Ci.v,fr.va=Ci.va,fr.j=Ci.j,fr.o=Ci.o,Hi.$a)e:{e(Hi.$a==1),Ci=Na();t:for(;;){if(Ci==null){Ci=0;break e}if(e(Hi!=null),Hi.mc=Ci,Ci.c=Hi.c,Ci.i=Hi.i,Ci.l=Hi.l,Ci.l.ma=Hi,Ci.l.width=Hi.c,Ci.l.height=Hi.i,Ci.a=0,nr(Ci.m,qi,Qi,dr),!Vs(Hi.c,Hi.i,1,Ci,null)||(Ci.ab==1&&Ci.gc[0].hc==3&&Cs(Ci.s)?(Hi.ic=1,qi=Ci.c*Ci.i,Ci.Ta=null,Ci.Ua=0,Ci.V=ii(qi),Ci.Ba=0,Ci.V==null?(Ci.a=1,Ci=0):Ci=1):(Hi.ic=0,Ci=ka(Ci,Hi.c)),!Ci))break t;Ci=1;break e}Hi.mc=null,Ci=0}else Ci=dr>=Hi.c*Hi.i;Hi=!Ci}if(Hi)return null;mi.ga.Lc!=1?mi.Ga=0:Ri=ji-Pi}e(mi.ga!=null),e(Pi+Ri<=ji);e:{if(Ci=(qi=mi.ga).c,ji=qi.l.o,qi.$a==0){if(Qi=mi.rc,dr=mi.Vc,fr=mi.Fa,Xi=mi.P+1+Pi*Ci,Ji=mi.mb,ur=mi.nb+Pi*Ci,e(Xi<=mi.P+mi.qc),qi.Z!=0)for(e(Pa[qi.Z]!=null),Hi=0;Hi<Ri;++Hi)Pa[qi.Z](Qi,dr,fr,Xi,Ji,ur,Ci),Qi=Ji,dr=ur,ur+=Ci,Xi+=Ci;else for(Hi=0;Hi<Ri;++Hi)ei(Ji,ur,fr,Xi,Ci),Qi=Ji,dr=ur,ur+=Ci,Xi+=Ci;mi.rc=Qi,mi.Vc=dr}else{if(e(qi.mc!=null),Ci=Pi+Ri,e((Hi=qi.mc)!=null),e(Ci<=Hi.i),Hi.C>=Ci)Ci=1;else if(qi.ic||Hs(),qi.ic){qi=Hi.V,Qi=Hi.Ba,dr=Hi.c;var br=Hi.i,vr=(fr=1,Xi=Hi.$/dr,Ji=Hi.$%dr,ur=Hi.m,Cr=Hi.s,Hi.$),Ir=dr*br,Pr=dr*Ci,kr=Cr.wc,Tr=vr<Pr?Ln(Cr,Ji,Xi):null;e(vr<=Ir),e(Ci<=br),e(Cs(Cr));t:for(;;){for(;!ur.h&&vr<Pr;){if(Ji&kr||(Tr=Ln(Cr,Ji,Xi)),e(Tr!=null),Yi(ur),256>(br=yn(Tr.G[0],Tr.H[0],ur)))qi[Qi+vr]=br,++vr,++Ji>=dr&&(Ji=0,++Xi<=Ci&&!(Xi%16)&&As(Hi,Xi));else{if(!(280>br)){fr=0;break t}br=mn(br-256,ur);var Qr,zr=yn(Tr.G[4],Tr.H[4],ur);if(Yi(ur),!(vr>=(zr=bn(dr,zr=mn(zr,ur)))&&Ir-vr>=br)){fr=0;break t}for(Qr=0;Qr<br;++Qr)qi[Qi+vr+Qr]=qi[Qi+vr+Qr-zr];for(vr+=br,Ji+=br;Ji>=dr;)Ji-=dr,++Xi<=Ci&&!(Xi%16)&&As(Hi,Xi);vr<Pr&&Ji&kr&&(Tr=Ln(Cr,Ji,Xi))}e(ur.h==Mi(ur))}As(Hi,Xi>Ci?Ci:Xi);break t}!fr||ur.h&&vr<Ir?(fr=0,Hi.a=ur.h?5:3):Hi.$=vr,Ci=fr}else Ci=as(Hi,Hi.V,Hi.Ba,Hi.c,Hi.i,Ci,Xa);if(!Ci){Ri=0;break e}}Pi+Ri>=ji&&(mi.Cc=1),Ri=1}if(!Ri)return null;if(mi.Cc&&((Ri=mi.ga)!=null&&(Ri.mc=null),mi.ga=null,0<mi.Ga))return alert("todo:WebPDequantizeLevels"),null}return mi.nb+Pi*Bi}function ts(mi,Ci,Pi,Ri,Bi,ji){for(;0<Bi--;){var Hi,qi=mi,Xi=Ci+(Pi?1:0),Ji=mi,ur=Ci+(Pi?0:3);for(Hi=0;Hi<Ri;++Hi){var Cr=Ji[ur+4*Hi];Cr!=255&&(Cr*=32897,qi[Xi+4*Hi+0]=qi[Xi+4*Hi+0]*Cr>>23,qi[Xi+4*Hi+1]=qi[Xi+4*Hi+1]*Cr>>23,qi[Xi+4*Hi+2]=qi[Xi+4*Hi+2]*Cr>>23)}Ci+=ji}}function Jn(mi,Ci,Pi,Ri,Bi){for(;0<Ri--;){var ji;for(ji=0;ji<Pi;++ji){var Hi=mi[Ci+2*ji+0],qi=15&(Ji=mi[Ci+2*ji+1]),Xi=4369*qi,Ji=(240&Ji|Ji>>4)*Xi>>16;mi[Ci+2*ji+0]=(240&Hi|Hi>>4)*Xi>>16&240|(15&Hi|Hi<<4)*Xi>>16>>4&15,mi[Ci+2*ji+1]=240&Ji|qi}Ci+=Bi}}function cs(mi,Ci,Pi,Ri,Bi,ji,Hi,qi){var Xi,Ji,ur=255;for(Ji=0;Ji<Bi;++Ji){for(Xi=0;Xi<Ri;++Xi){var Cr=mi[Ci+Xi];ji[Hi+4*Xi]=Cr,ur&=Cr}Ci+=Pi,Hi+=qi}return ur!=255}function la(mi,Ci,Pi,Ri,Bi){var ji;for(ji=0;ji<Bi;++ji)Pi[Ri+ji]=mi[Ci+ji]>>8}function Hs(){Mo=ts,pc=Jn,gc=cs,mc=la}function ca(mi,Ci,Pi){wi[mi]=function(Ri,Bi,ji,Hi,qi,Xi,Ji,ur,Cr,Qi,dr,fr,br,vr,Ir,Pr,kr){var Tr,Qr=kr-1>>1,zr=qi[Xi+0]|Ji[ur+0]<<16,pn=Cr[Qi+0]|dr[fr+0]<<16;e(Ri!=null);var Kr=3*zr+pn+131074>>2;for(Ci(Ri[Bi+0],255&Kr,Kr>>16,br,vr),ji!=null&&(Kr=3*pn+zr+131074>>2,Ci(ji[Hi+0],255&Kr,Kr>>16,Ir,Pr)),Tr=1;Tr<=Qr;++Tr){var vn=qi[Xi+Tr]|Ji[ur+Tr]<<16,rs=Cr[Qi+Tr]|dr[fr+Tr]<<16,gn=zr+vn+pn+rs+524296,Zr=gn+2*(vn+pn)>>3;Kr=Zr+zr>>1,zr=(gn=gn+2*(zr+rs)>>3)+vn>>1,Ci(Ri[Bi+2*Tr-1],255&Kr,Kr>>16,br,vr+(2*Tr-1)*Pi),Ci(Ri[Bi+2*Tr-0],255&zr,zr>>16,br,vr+(2*Tr-0)*Pi),ji!=null&&(Kr=gn+pn>>1,zr=Zr+rs>>1,Ci(ji[Hi+2*Tr-1],255&Kr,Kr>>16,Ir,Pr+(2*Tr-1)*Pi),Ci(ji[Hi+2*Tr+0],255&zr,zr>>16,Ir,Pr+(2*Tr+0)*Pi)),zr=vn,pn=rs}1&kr||(Kr=3*zr+pn+131074>>2,Ci(Ri[Bi+kr-1],255&Kr,Kr>>16,br,vr+(kr-1)*Pi),ji!=null&&(Kr=3*pn+zr+131074>>2,Ci(ji[Hi+kr-1],255&Kr,Kr>>16,Ir,Pr+(kr-1)*Pi)))}}function Ao(){Us[al]=fu,Us[ol]=xc,Us[Ec]=pu,Us[ll]=Pc,Us[cl]=Lc,Us[jl]=Tc,Us[bc]=gu,Us[$l]=xc,Us[Hl]=Pc,Us[ul]=Lc,Us[Wl]=Tc}function ro(mi){return mi&-16384?0>mi?0:255:mi>>mu}function ya(mi,Ci){return ro((19077*mi>>8)+(26149*Ci>>8)-14234)}function Ua(mi,Ci,Pi){return ro((19077*mi>>8)-(6419*Ci>>8)-(13320*Pi>>8)+8708)}function ja(mi,Ci){return ro((19077*mi>>8)+(33050*Ci>>8)-17685)}function va(mi,Ci,Pi,Ri,Bi){Ri[Bi+0]=ya(mi,Pi),Ri[Bi+1]=Ua(mi,Ci,Pi),Ri[Bi+2]=ja(mi,Ci)}function us(mi,Ci,Pi,Ri,Bi){Ri[Bi+0]=ja(mi,Ci),Ri[Bi+1]=Ua(mi,Ci,Pi),Ri[Bi+2]=ya(mi,Pi)}function $a(mi,Ci,Pi,Ri,Bi){var ji=Ua(mi,Ci,Pi);Ci=ji<<3&224|ja(mi,Ci)>>3,Ri[Bi+0]=248&ya(mi,Pi)|ji>>5,Ri[Bi+1]=Ci}function Ha(mi,Ci,Pi,Ri,Bi){var ji=240&ja(mi,Ci)|15;Ri[Bi+0]=240&ya(mi,Pi)|Ua(mi,Ci,Pi)>>4,Ri[Bi+1]=ji}function Eo(mi,Ci,Pi,Ri,Bi){Ri[Bi+0]=255,va(mi,Ci,Pi,Ri,Bi+1)}function bo(mi,Ci,Pi,Ri,Bi){us(mi,Ci,Pi,Ri,Bi),Ri[Bi+3]=255}function gs(mi,Ci,Pi,Ri,Bi){va(mi,Ci,Pi,Ri,Bi),Ri[Bi+3]=255}function da(mi,Ci,Pi){wi[mi]=function(Ri,Bi,ji,Hi,qi,Xi,Ji,ur,Cr){for(var Qi=ur+(-2&Cr)*Pi;ur!=Qi;)Ci(Ri[Bi+0],ji[Hi+0],qi[Xi+0],Ji,ur),Ci(Ri[Bi+1],ji[Hi+0],qi[Xi+0],Ji,ur+Pi),Bi+=2,++Hi,++Xi,ur+=2*Pi;1&Cr&&Ci(Ri[Bi+0],ji[Hi+0],qi[Xi+0],Ji,ur)}}function no(mi,Ci,Pi){return Pi==0?mi==0?Ci==0?6:5:Ci==0?4:0:Pi}function il(mi,Ci,Pi,Ri,Bi){switch(mi>>>30){case 3:Va(Ci,Pi,Ri,Bi,0);break;case 2:Fs(Ci,Pi,Ri,Bi);break;case 1:Sn(Ci,Pi,Ri,Bi)}}function Gs(mi,Ci){var Pi,Ri,Bi=Ci.M,ji=Ci.Nb,Hi=mi.oc,qi=mi.pc+40,Xi=mi.oc,Ji=mi.pc+584,ur=mi.oc,Cr=mi.pc+600;for(Pi=0;16>Pi;++Pi)Hi[qi+32*Pi-1]=129;for(Pi=0;8>Pi;++Pi)Xi[Ji+32*Pi-1]=129,ur[Cr+32*Pi-1]=129;for(0<Bi?Hi[qi-1-32]=Xi[Ji-1-32]=ur[Cr-1-32]=129:(ti(Hi,qi-32-1,127,21),ti(Xi,Ji-32-1,127,9),ti(ur,Cr-32-1,127,9)),Ri=0;Ri<mi.za;++Ri){var Qi=Ci.ya[Ci.aa+Ri];if(0<Ri){for(Pi=-1;16>Pi;++Pi)ei(Hi,qi+32*Pi-4,Hi,qi+32*Pi+12,4);for(Pi=-1;8>Pi;++Pi)ei(Xi,Ji+32*Pi-4,Xi,Ji+32*Pi+4,4),ei(ur,Cr+32*Pi-4,ur,Cr+32*Pi+4,4)}var dr=mi.Gd,fr=mi.Hd+Ri,br=Qi.ad,vr=Qi.Hc;if(0<Bi&&(ei(Hi,qi-32,dr[fr].y,0,16),ei(Xi,Ji-32,dr[fr].f,0,8),ei(ur,Cr-32,dr[fr].ea,0,8)),Qi.Za){var Ir=Hi,Pr=qi-32+16;for(0<Bi&&(Ri>=mi.za-1?ti(Ir,Pr,dr[fr].y[15],4):ei(Ir,Pr,dr[fr+1].y,0,4)),Pi=0;4>Pi;Pi++)Ir[Pr+128+Pi]=Ir[Pr+256+Pi]=Ir[Pr+384+Pi]=Ir[Pr+0+Pi];for(Pi=0;16>Pi;++Pi,vr<<=2)Ir=Hi,Pr=qi+Mc[Pi],Ws[Qi.Ob[Pi]](Ir,Pr),il(vr,br,16*+Pi,Ir,Pr)}else if(Ir=no(Ri,Bi,Qi.Ob[0]),xa[Ir](Hi,qi),vr!=0)for(Pi=0;16>Pi;++Pi,vr<<=2)il(vr,br,16*+Pi,Hi,qi+Mc[Pi]);for(Pi=Qi.Gc,Ir=no(Ri,Bi,Qi.Dd),pa[Ir](Xi,Ji),pa[Ir](ur,Cr),vr=br,Ir=Xi,Pr=Ji,255&(Qi=0|Pi)&&(170&Qi?Qs(vr,256,Ir,Pr):Rn(vr,256,Ir,Pr)),Qi=ur,vr=Cr,255&(Pi>>=8)&&(170&Pi?Qs(br,320,Qi,vr):Rn(br,320,Qi,vr)),Bi<mi.Ub-1&&(ei(dr[fr].y,0,Hi,qi+480,16),ei(dr[fr].f,0,Xi,Ji+224,8),ei(dr[fr].ea,0,ur,Cr+224,8)),Pi=8*ji*mi.B,dr=mi.sa,fr=mi.ta+16*Ri+16*ji*mi.R,br=mi.qa,Qi=mi.ra+8*Ri+Pi,vr=mi.Ha,Ir=mi.Ia+8*Ri+Pi,Pi=0;16>Pi;++Pi)ei(dr,fr+Pi*mi.R,Hi,qi+32*Pi,16);for(Pi=0;8>Pi;++Pi)ei(br,Qi+Pi*mi.B,Xi,Ji+32*Pi,8),ei(vr,Ir+Pi*mi.B,ur,Cr+32*Pi,8)}}function Wa(mi,Ci,Pi,Ri,Bi,ji,Hi,qi,Xi){var Ji=[0],ur=[0],Cr=0,Qi=Xi!=null?Xi.kd:0,dr=Xi??new Lr;if(mi==null||12>Pi)return 7;dr.data=mi,dr.w=Ci,dr.ha=Pi,Ci=[Ci],Pi=[Pi],dr.gb=[dr.gb];e:{var fr=Ci,br=Pi,vr=dr.gb;if(e(mi!=null),e(br!=null),e(vr!=null),vr[0]=0,12<=br[0]&&!n(mi,fr[0],"RIFF")){if(n(mi,fr[0]+8,"WEBP")){vr=3;break e}var Ir=pr(mi,fr[0]+4);if(12>Ir||4294967286<Ir){vr=3;break e}if(Qi&&Ir>br[0]-8){vr=7;break e}vr[0]=Ir,fr[0]+=12,br[0]-=12}vr=0}if(vr!=0)return vr;for(Ir=0<dr.gb[0],Pi=Pi[0];;){e:{var Pr=mi;br=Ci,vr=Pi;var kr=Ji,Tr=ur,Qr=fr=[0];if((Kr=Cr=[Cr])[0]=0,8>vr[0])vr=7;else{if(!n(Pr,br[0],"VP8X")){if(pr(Pr,br[0]+4)!=10){vr=3;break e}if(18>vr[0]){vr=7;break e}var zr=pr(Pr,br[0]+8),pn=1+ar(Pr,br[0]+12);if(2147483648<=pn*(Pr=1+ar(Pr,br[0]+15))){vr=3;break e}Qr!=null&&(Qr[0]=zr),kr!=null&&(kr[0]=pn),Tr!=null&&(Tr[0]=Pr),br[0]+=18,vr[0]-=18,Kr[0]=1}vr=0}}if(Cr=Cr[0],fr=fr[0],vr!=0)return vr;if(br=!!(2&fr),!Ir&&Cr)return 3;if(ji!=null&&(ji[0]=!!(16&fr)),Hi!=null&&(Hi[0]=br),qi!=null&&(qi[0]=0),Hi=Ji[0],fr=ur[0],Cr&&br&&Xi==null){vr=0;break}if(4>Pi){vr=7;break}if(Ir&&Cr||!Ir&&!Cr&&!n(mi,Ci[0],"ALPH")){Pi=[Pi],dr.na=[dr.na],dr.P=[dr.P],dr.Sa=[dr.Sa];e:{zr=mi,vr=Ci,Ir=Pi;var Kr=dr.gb;kr=dr.na,Tr=dr.P,Qr=dr.Sa,pn=22,e(zr!=null),e(Ir!=null),Pr=vr[0];var vn=Ir[0];for(e(kr!=null),e(Qr!=null),kr[0]=null,Tr[0]=null,Qr[0]=0;;){if(vr[0]=Pr,Ir[0]=vn,8>vn){vr=7;break e}var rs=pr(zr,Pr+4);if(4294967286<rs){vr=3;break e}var gn=8+rs+1&-2;if(pn+=gn,0<Kr&&pn>Kr){vr=3;break e}if(!n(zr,Pr,"VP8 ")||!n(zr,Pr,"VP8L")){vr=0;break e}if(vn[0]<gn){vr=7;break e}n(zr,Pr,"ALPH")||(kr[0]=zr,Tr[0]=Pr+8,Qr[0]=rs),Pr+=gn,vn-=gn}}if(Pi=Pi[0],dr.na=dr.na[0],dr.P=dr.P[0],dr.Sa=dr.Sa[0],vr!=0)break}Pi=[Pi],dr.Ja=[dr.Ja],dr.xa=[dr.xa];e:if(Kr=mi,vr=Ci,Ir=Pi,kr=dr.gb[0],Tr=dr.Ja,Qr=dr.xa,zr=vr[0],Pr=!n(Kr,zr,"VP8 "),pn=!n(Kr,zr,"VP8L"),e(Kr!=null),e(Ir!=null),e(Tr!=null),e(Qr!=null),8>Ir[0])vr=7;else{if(Pr||pn){if(Kr=pr(Kr,zr+4),12<=kr&&Kr>kr-12){vr=3;break e}if(Qi&&Kr>Ir[0]-8){vr=7;break e}Tr[0]=Kr,vr[0]+=8,Ir[0]-=8,Qr[0]=pn}else Qr[0]=5<=Ir[0]&&Kr[zr+0]==47&&!(Kr[zr+4]>>5),Tr[0]=Ir[0];vr=0}if(Pi=Pi[0],dr.Ja=dr.Ja[0],dr.xa=dr.xa[0],Ci=Ci[0],vr!=0)break;if(4294967286<dr.Ja)return 3;if(qi==null||br||(qi[0]=dr.xa?2:1),Hi=[Hi],fr=[fr],dr.xa){if(5>Pi){vr=7;break}qi=Hi,Qi=fr,br=ji,mi==null||5>Pi?mi=0:5<=Pi&&mi[Ci+0]==47&&!(mi[Ci+4]>>5)?(Ir=[0],Kr=[0],kr=[0],nr(Tr=new ki,mi,Ci,Pi),$n(Tr,Ir,Kr,kr)?(qi!=null&&(qi[0]=Ir[0]),Qi!=null&&(Qi[0]=Kr[0]),br!=null&&(br[0]=kr[0]),mi=1):mi=0):mi=0}else{if(10>Pi){vr=7;break}qi=fr,mi==null||10>Pi||!zo(mi,Ci+3,Pi-3)?mi=0:(Qi=mi[Ci+0]|mi[Ci+1]<<8|mi[Ci+2]<<16,br=16383&(mi[Ci+7]<<8|mi[Ci+6]),mi=16383&(mi[Ci+9]<<8|mi[Ci+8]),1&Qi||3<(Qi>>1&7)||!(Qi>>4&1)||Qi>>5>=dr.Ja||!br||!mi?mi=0:(Hi&&(Hi[0]=br),qi&&(qi[0]=mi),mi=1))}if(!mi||(Hi=Hi[0],fr=fr[0],Cr&&(Ji[0]!=Hi||ur[0]!=fr)))return 3;Xi!=null&&(Xi[0]=dr,Xi.offset=Ci-Xi.w,e(4294967286>Ci-Xi.w),e(Xi.offset==Xi.ha-Pi));break}return vr==0||vr==7&&Cr&&Xi==null?(ji!=null&&(ji[0]|=dr.na!=null&&0<dr.na.length),Ri!=null&&(Ri[0]=Hi),Bi!=null&&(Bi[0]=fr),0):vr}function So(mi,Ci,Pi){var Ri=Ci.width,Bi=Ci.height,ji=0,Hi=0,qi=Ri,Xi=Bi;if(Ci.Da=mi!=null&&0<mi.Da,Ci.Da&&(qi=mi.cd,Xi=mi.bd,ji=mi.v,Hi=mi.j,11>Pi||(ji&=-2,Hi&=-2),0>ji||0>Hi||0>=qi||0>=Xi||ji+qi>Ri||Hi+Xi>Bi))return 0;if(Ci.v=ji,Ci.j=Hi,Ci.va=ji+qi,Ci.o=Hi+Xi,Ci.U=qi,Ci.T=Xi,Ci.da=mi!=null&&0<mi.da,Ci.da){if(!Nr(qi,Xi,Pi=[mi.ib],ji=[mi.hb]))return 0;Ci.ib=Pi[0],Ci.hb=ji[0]}return Ci.ob=mi!=null&&mi.ob,Ci.Kb=mi==null||!mi.Sd,Ci.da&&(Ci.ob=Ci.ib<3*Ri/4&&Ci.hb<3*Bi/4,Ci.Kb=0),1}function Io(mi){if(mi==null)return 2;if(11>mi.S){var Ci=mi.f.RGBA;Ci.fb+=(mi.height-1)*Ci.A,Ci.A=-Ci.A}else Ci=mi.f.kb,mi=mi.height,Ci.O+=(mi-1)*Ci.fa,Ci.fa=-Ci.fa,Ci.N+=(mi-1>>1)*Ci.Ab,Ci.Ab=-Ci.Ab,Ci.W+=(mi-1>>1)*Ci.Db,Ci.Db=-Ci.Db,Ci.F!=null&&(Ci.J+=(mi-1)*Ci.lb,Ci.lb=-Ci.lb);return 0}function Ca(mi,Ci,Pi,Ri){if(Ri==null||0>=mi||0>=Ci)return 2;if(Pi!=null){if(Pi.Da){var Bi=Pi.cd,ji=Pi.bd,Hi=-2&Pi.v,qi=-2&Pi.j;if(0>Hi||0>qi||0>=Bi||0>=ji||Hi+Bi>mi||qi+ji>Ci)return 2;mi=Bi,Ci=ji}if(Pi.da){if(!Nr(mi,Ci,Bi=[Pi.ib],ji=[Pi.hb]))return 2;mi=Bi[0],Ci=ji[0]}}Ri.width=mi,Ri.height=Ci;e:{var Xi=Ri.width,Ji=Ri.height;if(mi=Ri.S,0>=Xi||0>=Ji||!(mi>=al&&13>mi))mi=2;else{if(0>=Ri.Rd&&Ri.sd==null){Hi=ji=Bi=Ci=0;var ur=(qi=Xi*Nc[mi])*Ji;if(11>mi||(ji=(Ji+1)/2*(Ci=(Xi+1)/2),mi==12&&(Hi=(Bi=Xi)*Ji)),(Ji=ii(ur+2*ji+Hi))==null){mi=1;break e}Ri.sd=Ji,11>mi?((Xi=Ri.f.RGBA).eb=Ji,Xi.fb=0,Xi.A=qi,Xi.size=ur):((Xi=Ri.f.kb).y=Ji,Xi.O=0,Xi.fa=qi,Xi.Fd=ur,Xi.f=Ji,Xi.N=0+ur,Xi.Ab=Ci,Xi.Cd=ji,Xi.ea=Ji,Xi.W=0+ur+ji,Xi.Db=Ci,Xi.Ed=ji,mi==12&&(Xi.F=Ji,Xi.J=0+ur+2*ji),Xi.Tc=Hi,Xi.lb=Bi)}if(Ci=1,Bi=Ri.S,ji=Ri.width,Hi=Ri.height,Bi>=al&&13>Bi)if(11>Bi)mi=Ri.f.RGBA,Ci&=(qi=Math.abs(mi.A))*(Hi-1)+ji<=mi.size,Ci&=qi>=ji*Nc[Bi],Ci&=mi.eb!=null;else{mi=Ri.f.kb,qi=(ji+1)/2,ur=(Hi+1)/2,Xi=Math.abs(mi.fa),Ji=Math.abs(mi.Ab);var Cr=Math.abs(mi.Db),Qi=Math.abs(mi.lb),dr=Qi*(Hi-1)+ji;Ci&=Xi*(Hi-1)+ji<=mi.Fd,Ci&=Ji*(ur-1)+qi<=mi.Cd,Ci=(Ci&=Cr*(ur-1)+qi<=mi.Ed)&Xi>=ji&Ji>=qi&Cr>=qi,Ci&=mi.y!=null,Ci&=mi.f!=null,Ci&=mi.ea!=null,Bi==12&&(Ci&=Qi>=ji,Ci&=dr<=mi.Tc,Ci&=mi.F!=null)}else Ci=0;mi=Ci?0:2}}return mi!=0||Pi!=null&&Pi.fd&&(mi=Io(Ri)),mi}var za=64,ws=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],xs=24,Aa=32,ha=8,Ea=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Er("Predictor0","PredictorAdd0"),wi.Predictor0=function(){return 4278190080},wi.Predictor1=function(mi){return mi},wi.Predictor2=function(mi,Ci,Pi){return Ci[Pi+0]},wi.Predictor3=function(mi,Ci,Pi){return Ci[Pi+1]},wi.Predictor4=function(mi,Ci,Pi){return Ci[Pi-1]},wi.Predictor5=function(mi,Ci,Pi){return or(or(mi,Ci[Pi+1]),Ci[Pi+0])},wi.Predictor6=function(mi,Ci,Pi){return or(mi,Ci[Pi-1])},wi.Predictor7=function(mi,Ci,Pi){return or(mi,Ci[Pi+0])},wi.Predictor8=function(mi,Ci,Pi){return or(Ci[Pi-1],Ci[Pi+0])},wi.Predictor9=function(mi,Ci,Pi){return or(Ci[Pi+0],Ci[Pi+1])},wi.Predictor10=function(mi,Ci,Pi){return or(or(mi,Ci[Pi-1]),or(Ci[Pi+0],Ci[Pi+1]))},wi.Predictor11=function(mi,Ci,Pi){var Ri=Ci[Pi+0];return 0>=Ar(Ri>>24&255,mi>>24&255,(Ci=Ci[Pi-1])>>24&255)+Ar(Ri>>16&255,mi>>16&255,Ci>>16&255)+Ar(Ri>>8&255,mi>>8&255,Ci>>8&255)+Ar(255&Ri,255&mi,255&Ci)?Ri:mi},wi.Predictor12=function(mi,Ci,Pi){var Ri=Ci[Pi+0];return(yr((mi>>24&255)+(Ri>>24&255)-((Ci=Ci[Pi-1])>>24&255))<<24|yr((mi>>16&255)+(Ri>>16&255)-(Ci>>16&255))<<16|yr((mi>>8&255)+(Ri>>8&255)-(Ci>>8&255))<<8|yr((255&mi)+(255&Ri)-(255&Ci)))>>>0},wi.Predictor13=function(mi,Ci,Pi){var Ri=Ci[Pi-1];return(_r((mi=or(mi,Ci[Pi+0]))>>24&255,Ri>>24&255)<<24|_r(mi>>16&255,Ri>>16&255)<<16|_r(mi>>8&255,Ri>>8&255)<<8|_r(255&mi,255&Ri))>>>0};var wo=wi.PredictorAdd0;wi.PredictorAdd1=wr,Er("Predictor2","PredictorAdd2"),Er("Predictor3","PredictorAdd3"),Er("Predictor4","PredictorAdd4"),Er("Predictor5","PredictorAdd5"),Er("Predictor6","PredictorAdd6"),Er("Predictor7","PredictorAdd7"),Er("Predictor8","PredictorAdd8"),Er("Predictor9","PredictorAdd9"),Er("Predictor10","PredictorAdd10"),Er("Predictor11","PredictorAdd11"),Er("Predictor12","PredictorAdd12"),Er("Predictor13","PredictorAdd13");var so=wi.PredictorAdd2;Or("ColorIndexInverseTransform","MapARGB","32b",function(mi){return mi>>8&255},function(mi){return mi}),Or("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(mi){return mi},function(mi){return mi>>8&255});var Hn,rl=wi.ColorIndexInverseTransform,Zs=wi.MapARGB,Js=wi.VP8LColorIndexInverseTransformAlpha,xo=wi.MapAlpha,Po=wi.VP8LPredictorsAdd=[];Po.length=16,(wi.VP8LPredictors=[]).length=16,(wi.VP8LPredictorsAdd_C=[]).length=16,(wi.VP8LPredictors_C=[]).length=16;var Lo,To,ba,Sa,Ia,qa,wa,Va,Fs,Qs,Sn,Rn,Wn,is,fa,Ro,ao,nl,oc,cc,uc,dc,hc,fc,Mo,pc,gc,mc,yc=ii(511),vc=ii(2041),_c=ii(225),Cc=ii(767),Ac=0,Ul=vc,sl=_c,Ps=Cc,Bs=yc,al=0,ol=1,Ec=2,ll=3,cl=4,jl=5,bc=6,$l=7,Hl=8,ul=9,Wl=10,Qc=[2,3,7],eu=[3,3,11],Sc=[280,256,256,256,40],tu=[0,1,1,1,0],iu=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],ru=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],nu=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],su=8,zl=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],ql=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],No=null,au=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],ou=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Ic=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],lu=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],cu=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],uu=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],du=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],xa=[],Ws=[],pa=[],hu=1,wc=2,Pa=[],Us=[];ca("UpsampleRgbLinePair",va,3),ca("UpsampleBgrLinePair",us,3),ca("UpsampleRgbaLinePair",gs,4),ca("UpsampleBgraLinePair",bo,4),ca("UpsampleArgbLinePair",Eo,4),ca("UpsampleRgba4444LinePair",Ha,2),ca("UpsampleRgb565LinePair",$a,2);var fu=wi.UpsampleRgbLinePair,pu=wi.UpsampleBgrLinePair,xc=wi.UpsampleRgbaLinePair,Pc=wi.UpsampleBgraLinePair,Lc=wi.UpsampleArgbLinePair,Tc=wi.UpsampleRgba4444LinePair,gu=wi.UpsampleRgb565LinePair,dl=16,hl=1<<dl-1,ko=-227,Vl=482,mu=6,Rc=0,yu=ii(256),vu=ii(256),_u=ii(256),Cu=ii(256),Au=ii(Vl-ko),Eu=ii(Vl-ko);da("YuvToRgbRow",va,3),da("YuvToBgrRow",us,3),da("YuvToRgbaRow",gs,4),da("YuvToBgraRow",bo,4),da("YuvToArgbRow",Eo,4),da("YuvToRgba4444Row",Ha,2),da("YuvToRgb565Row",$a,2);var Mc=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],pl=[0,2,8],bu=[8,7,6,4,4,2,2,2,1,1,1,1],Su=1;this.WebPDecodeRGBA=function(mi,Ci,Pi,Ri,Bi){var ji=ol,Hi=new xr,qi=new sn;Hi.ba=qi,qi.S=ji,qi.width=[qi.width],qi.height=[qi.height];var Xi=qi.width,Ji=qi.height,ur=new Wr;if(ur==null||mi==null)var Cr=2;else e(ur!=null),Cr=Wa(mi,Ci,Pi,ur.width,ur.height,ur.Pd,ur.Qd,ur.format,null);if(Cr!=0?Xi=0:(Xi!=null&&(Xi[0]=ur.width[0]),Ji!=null&&(Ji[0]=ur.height[0]),Xi=1),Xi){qi.width=qi.width[0],qi.height=qi.height[0],Ri!=null&&(Ri[0]=qi.width),Bi!=null&&(Bi[0]=qi.height);e:{if(Ri=new Ja,(Bi=new Lr).data=mi,Bi.w=Ci,Bi.ha=Pi,Bi.kd=1,Ci=[0],e(Bi!=null),((mi=Wa(Bi.data,Bi.w,Bi.ha,null,null,null,Ci,null,Bi))==0||mi==7)&&Ci[0]&&(mi=4),(Ci=mi)==0){if(e(Hi!=null),Ri.data=Bi.data,Ri.w=Bi.w+Bi.offset,Ri.ha=Bi.ha-Bi.offset,Ri.put=Ur,Ri.ac=Gn,Ri.bc=Tn,Ri.ma=Hi,Bi.xa){if((mi=Na())==null){Hi=1;break e}if((function(Qi,dr){var fr=[0],br=[0],vr=[0];t:for(;;){if(Qi==null)return 0;if(dr==null)return Qi.a=2,0;if(Qi.l=dr,Qi.a=0,nr(Qi.m,dr.data,dr.w,dr.ha),!$n(Qi.m,fr,br,vr)){Qi.a=3;break t}if(Qi.xb=wc,dr.width=fr[0],dr.height=br[0],!Vs(fr[0],br[0],1,Qi,null))break t;return 1}return e(Qi.a!=0),0})(mi,Ri)){if(Ri=(Ci=Ca(Ri.width,Ri.height,Hi.Oa,Hi.ba))==0){t:{Ri=mi;i:for(;;){if(Ri==null){Ri=0;break t}if(e(Ri.s.yc!=null),e(Ri.s.Ya!=null),e(0<Ri.s.Wb),e((Pi=Ri.l)!=null),e((Bi=Pi.ma)!=null),Ri.xb!=0){if(Ri.ca=Bi.ba,Ri.tb=Bi.tb,e(Ri.ca!=null),!So(Bi.Oa,Pi,ll)){Ri.a=2;break i}if(!ka(Ri,Pi.width)||Pi.da)break i;if((Pi.da||jr(Ri.ca.S))&&Hs(),11>Ri.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),Ri.ca.f.kb.F!=null&&Hs()),Ri.Pb&&0<Ri.s.ua&&Ri.s.vb.X==null&&!Gi(Ri.s.vb,Ri.s.Wa.Xa)){Ri.a=1;break i}Ri.xb=0}if(!as(Ri,Ri.V,Ri.Ba,Ri.c,Ri.i,Pi.o,_s))break i;Bi.Dc=Ri.Ma,Ri=1;break t}e(Ri.a!=0),Ri=0}Ri=!Ri}Ri&&(Ci=mi.a)}else Ci=mi.a}else{if((mi=new Il)==null){Hi=1;break e}if(mi.Fa=Bi.na,mi.P=Bi.P,mi.qc=Bi.Sa,Xs(mi,Ri)){if((Ci=Ca(Ri.width,Ri.height,Hi.Oa,Hi.ba))==0){if(mi.Aa=0,Pi=Hi.Oa,e((Bi=mi)!=null),Pi!=null){if(0<(Xi=0>(Xi=Pi.Md)?0:100<Xi?255:255*Xi/100)){for(Ji=ur=0;4>Ji;++Ji)12>(Cr=Bi.pb[Ji]).lc&&(Cr.ia=Xi*bu[0>Cr.lc?0:Cr.lc]>>3),ur|=Cr.ia;ur&&(alert("todo:VP8InitRandom"),Bi.ia=1)}Bi.Ga=Pi.Id,100<Bi.Ga?Bi.Ga=100:0>Bi.Ga&&(Bi.Ga=0)}(function(Qi,dr){if(Qi==null)return 0;if(dr==null)return Vn(Qi,2,"NULL VP8Io parameter in VP8Decode().");if(!Qi.cb&&!Xs(Qi,dr))return 0;if(e(Qi.cb),dr.ac==null||dr.ac(dr)){dr.ob&&(Qi.L=0);var fr=pl[Qi.L];if(Qi.L==2?(Qi.yb=0,Qi.zb=0):(Qi.yb=dr.v-fr>>4,Qi.zb=dr.j-fr>>4,0>Qi.yb&&(Qi.yb=0),0>Qi.zb&&(Qi.zb=0)),Qi.Va=dr.o+15+fr>>4,Qi.Hb=dr.va+15+fr>>4,Qi.Hb>Qi.za&&(Qi.Hb=Qi.za),Qi.Va>Qi.Ub&&(Qi.Va=Qi.Ub),0<Qi.L){var br=Qi.ed;for(fr=0;4>fr;++fr){var vr;if(Qi.Qa.Cb){var Ir=Qi.Qa.Lb[fr];Qi.Qa.Fb||(Ir+=br.Tb)}else Ir=br.Tb;for(vr=0;1>=vr;++vr){var Pr=Qi.gd[fr][vr],kr=Ir;if(br.Pc&&(kr+=br.vd[0],vr&&(kr+=br.od[0])),0<(kr=0>kr?0:63<kr?63:kr)){var Tr=kr;0<br.wb&&(Tr=4<br.wb?Tr>>2:Tr>>1)>9-br.wb&&(Tr=9-br.wb),1>Tr&&(Tr=1),Pr.dd=Tr,Pr.tc=2*kr+Tr,Pr.ld=40<=kr?2:15<=kr?1:0}else Pr.tc=0;Pr.La=vr}}}fr=0}else Vn(Qi,6,"Frame setup failed"),fr=Qi.a;if(fr=fr==0){if(fr){Qi.$c=0,0<Qi.Aa||(Qi.Ic=Su);t:{fr=Qi.Ic,br=4*(Tr=Qi.za);var Qr=32*Tr,zr=Tr+1,pn=0<Qi.L?Tr*(0<Qi.Aa?2:1):0,Kr=(Qi.Aa==2?2:1)*Tr;if((Pr=br+832+(vr=3*(16*fr+pl[Qi.L])/2*Qr)+(Ir=Qi.Fa!=null&&0<Qi.Fa.length?Qi.Kc.c*Qi.Kc.i:0))!=Pr)fr=0;else{if(Pr>Qi.Vb){if(Qi.Vb=0,Qi.Ec=ii(Pr),Qi.Fc=0,Qi.Ec==null){fr=Vn(Qi,1,"no memory during frame initialization.");break t}Qi.Vb=Pr}Pr=Qi.Ec,kr=Qi.Fc,Qi.Ac=Pr,Qi.Bc=kr,kr+=br,Qi.Gd=ri(Qr,Ho),Qi.Hd=0,Qi.rb=ri(zr+1,uo),Qi.sb=1,Qi.wa=pn?ri(pn,Os):null,Qi.Y=0,Qi.D.Nb=0,Qi.D.wa=Qi.wa,Qi.D.Y=Qi.Y,0<Qi.Aa&&(Qi.D.Y+=Tr),e(!0),Qi.oc=Pr,Qi.pc=kr,kr+=832,Qi.ya=ri(Kr,ho),Qi.aa=0,Qi.D.ya=Qi.ya,Qi.D.aa=Qi.aa,Qi.Aa==2&&(Qi.D.aa+=Tr),Qi.R=16*Tr,Qi.B=8*Tr,Tr=(Qr=pl[Qi.L])*Qi.R,Qr=Qr/2*Qi.B,Qi.sa=Pr,Qi.ta=kr+Tr,Qi.qa=Qi.sa,Qi.ra=Qi.ta+16*fr*Qi.R+Qr,Qi.Ha=Qi.qa,Qi.Ia=Qi.ra+8*fr*Qi.B+Qr,Qi.$c=0,kr+=vr,Qi.mb=Ir?Pr:null,Qi.nb=Ir?kr:null,e(kr+Ir<=Qi.Fc+Qi.Vb),qo(Qi),ti(Qi.Ac,Qi.Bc,0,br),fr=1}}if(fr){if(dr.ka=0,dr.y=Qi.sa,dr.O=Qi.ta,dr.f=Qi.qa,dr.N=Qi.ra,dr.ea=Qi.Ha,dr.Vd=Qi.Ia,dr.fa=Qi.R,dr.Rc=Qi.B,dr.F=null,dr.J=0,!Ac){for(fr=-255;255>=fr;++fr)yc[255+fr]=0>fr?-fr:fr;for(fr=-1020;1020>=fr;++fr)vc[1020+fr]=-128>fr?-128:127<fr?127:fr;for(fr=-112;112>=fr;++fr)_c[112+fr]=-16>fr?-16:15<fr?15:fr;for(fr=-255;510>=fr;++fr)Cc[255+fr]=0>fr?0:255<fr?255:fr;Ac=1}wa=eo,Va=xl,Qs=Ks,Sn=Yo,Rn=Xo,Fs=wl,Wn=el,is=Ba,fa=Fi,Ro=tr,ao=tl,nl=bi,oc=lr,cc=hr,uc=Fa,dc=Co,hc=Jo,fc=Qo,Ws[0]=Ol,Ws[1]=Pl,Ws[2]=Nl,Ws[3]=kl,Ws[4]=ia,Ws[5]=Dl,Ws[6]=ra,Ws[7]=Gl,Ws[8]=go,Ws[9]=to,xa[0]=Rl,xa[1]=Tl,xa[2]=fo,xa[3]=Ko,xa[4]=Da,xa[5]=po,xa[6]=Ml,pa[0]=Bl,pa[1]=Ll,pa[2]=Ga,pa[3]=Fl,pa[4]=yo,pa[5]=mo,pa[6]=Zo,fr=1}else fr=0}fr&&(fr=(function(vn,rs){for(vn.M=0;vn.M<vn.Va;++vn.M){var gn,Zr=vn.Jc[vn.M&vn.Xb],Hr=vn.m,zn=vn;for(gn=0;gn<zn.za;++gn){var hn=Hr,_n=zn,On=_n.Ac,ds=_n.Bc+4*gn,ms=_n.zc,Un=_n.ya[_n.aa+gn];if(_n.Qa.Bb?Un.$b=ir(hn,_n.Pa.jb[0])?2+ir(hn,_n.Pa.jb[2]):ir(hn,_n.Pa.jb[1]):Un.$b=0,_n.kc&&(Un.Ad=ir(hn,_n.Bd)),Un.Za=!ir(hn,145)+0,Un.Za){var ps=Un.Ob,ys=0;for(_n=0;4>_n;++_n){var ns,An=ms[0+_n];for(ns=0;4>ns;++ns){An=cu[On[ds+ns]][An];for(var wn=Ic[ir(hn,An[0])];0<wn;)wn=Ic[2*wn+ir(hn,An[wn])];An=-wn,On[ds+ns]=An}ei(ps,ys,On,ds,4),ys+=4,ms[0+_n]=An}}else An=ir(hn,156)?ir(hn,128)?1:3:ir(hn,163)?2:0,Un.Ob[0]=An,ti(On,ds,An,4),ti(ms,0,An,4);Un.Dd=ir(hn,142)?ir(hn,114)?ir(hn,183)?1:3:2:0}if(zn.m.Ka)return Vn(vn,7,"Premature end-of-partition0 encountered.");for(;vn.ja<vn.za;++vn.ja){if(zn=Zr,hn=(Hr=vn).rb[Hr.sb-1],On=Hr.rb[Hr.sb+Hr.ja],gn=Hr.ya[Hr.aa+Hr.ja],ds=Hr.kc?gn.Ad:0)hn.la=On.la=0,gn.Za||(hn.Na=On.Na=0),gn.Hc=0,gn.Gc=0,gn.ia=0;else{var jn,xn;if(hn=On,On=zn,ds=Hr.Pa.Xc,ms=Hr.ya[Hr.aa+Hr.ja],Un=Hr.pb[ms.$b],_n=ms.ad,ps=0,ys=Hr.rb[Hr.sb-1],An=ns=0,ti(_n,ps,0,384),ms.Za)var hs=0,zs=ds[3];else{wn=ii(16);var qn=hn.Na+ys.Na;if(qn=No(On,ds[1],qn,Un.Eb,0,wn,0),hn.Na=ys.Na=(0<qn)+0,1<qn)wa(wn,0,_n,ps);else{var Es=wn[0]+3>>3;for(wn=0;256>wn;wn+=16)_n[ps+wn]=Es}hs=1,zs=ds[0]}var Mn=15&hn.la,ss=15&ys.la;for(wn=0;4>wn;++wn){var Ls=1&ss;for(Es=xn=0;4>Es;++Es)Mn=Mn>>1|(Ls=(qn=No(On,zs,qn=Ls+(1&Mn),Un.Sc,hs,_n,ps))>hs)<<7,xn=xn<<2|(3<qn?3:1<qn?2:_n[ps+0]!=0),ps+=16;Mn>>=4,ss=ss>>1|Ls<<7,ns=(ns<<8|xn)>>>0}for(zs=Mn,hs=ss>>4,jn=0;4>jn;jn+=2){for(xn=0,Mn=hn.la>>4+jn,ss=ys.la>>4+jn,wn=0;2>wn;++wn){for(Ls=1&ss,Es=0;2>Es;++Es)qn=Ls+(1&Mn),Mn=Mn>>1|(Ls=0<(qn=No(On,ds[2],qn,Un.Qc,0,_n,ps)))<<3,xn=xn<<2|(3<qn?3:1<qn?2:_n[ps+0]!=0),ps+=16;Mn>>=2,ss=ss>>1|Ls<<5}An|=xn<<4*jn,zs|=Mn<<4<<jn,hs|=(240&ss)<<jn}hn.la=zs,ys.la=hs,ms.Hc=ns,ms.Gc=An,ms.ia=43690&An?0:Un.ia,ds=!(ns|An)}if(0<Hr.L&&(Hr.wa[Hr.Y+Hr.ja]=Hr.gd[gn.$b][gn.Za],Hr.wa[Hr.Y+Hr.ja].La|=!ds),zn.Ka)return Vn(vn,7,"Premature end-of-file encountered.")}if(qo(vn),Hr=rs,zn=1,gn=(Zr=vn).D,hn=0<Zr.L&&Zr.M>=Zr.zb&&Zr.M<=Zr.Va,Zr.Aa==0)t:{if(gn.M=Zr.M,gn.uc=hn,Gs(Zr,gn),zn=1,gn=(xn=Zr.D).Nb,hn=(An=pl[Zr.L])*Zr.R,On=An/2*Zr.B,wn=16*gn*Zr.R,Es=8*gn*Zr.B,ds=Zr.sa,ms=Zr.ta-hn+wn,Un=Zr.qa,_n=Zr.ra-On+Es,ps=Zr.Ha,ys=Zr.Ia-On+Es,ss=(Mn=xn.M)==0,ns=Mn>=Zr.Va-1,Zr.Aa==2&&Gs(Zr,xn),xn.uc)for(Ls=(qn=Zr).D.M,e(qn.D.uc),xn=qn.yb;xn<qn.Hb;++xn){hs=xn,zs=Ls;var vs=(Ts=(fs=qn).D).Nb;jn=fs.R;var Ts=Ts.wa[Ts.Y+hs],Rs=fs.sa,bs=fs.ta+16*vs*jn+16*hs,Ms=Ts.dd,kn=Ts.tc;if(kn!=0)if(e(3<=kn),fs.L==1)0<hs&&dc(Rs,bs,jn,kn+4),Ts.La&&fc(Rs,bs,jn,kn),0<zs&&uc(Rs,bs,jn,kn+4),Ts.La&&hc(Rs,bs,jn,kn);else{var Ns=fs.B,qs=fs.qa,Ya=fs.ra+8*vs*Ns+8*hs,ga=fs.Ha,fs=fs.Ia+8*vs*Ns+8*hs;vs=Ts.ld,0<hs&&(is(Rs,bs,jn,kn+4,Ms,vs),Ro(qs,Ya,ga,fs,Ns,kn+4,Ms,vs)),Ts.La&&(nl(Rs,bs,jn,kn,Ms,vs),cc(qs,Ya,ga,fs,Ns,kn,Ms,vs)),0<zs&&(Wn(Rs,bs,jn,kn+4,Ms,vs),fa(qs,Ya,ga,fs,Ns,kn+4,Ms,vs)),Ts.La&&(ao(Rs,bs,jn,kn,Ms,vs),oc(qs,Ya,ga,fs,Ns,kn,Ms,vs))}}if(Zr.ia&&alert("todo:DitherRow"),Hr.put!=null){if(xn=16*Mn,Mn=16*(Mn+1),ss?(Hr.y=Zr.sa,Hr.O=Zr.ta+wn,Hr.f=Zr.qa,Hr.N=Zr.ra+Es,Hr.ea=Zr.Ha,Hr.W=Zr.Ia+Es):(xn-=An,Hr.y=ds,Hr.O=ms,Hr.f=Un,Hr.N=_n,Hr.ea=ps,Hr.W=ys),ns||(Mn-=An),Mn>Hr.o&&(Mn=Hr.o),Hr.F=null,Hr.J=null,Zr.Fa!=null&&0<Zr.Fa.length&&xn<Mn&&(Hr.J=Nn(Zr,Hr,xn,Mn-xn),Hr.F=Zr.mb,Hr.F==null&&Hr.F.length==0)){zn=Vn(Zr,3,"Could not decode alpha data.");break t}xn<Hr.j&&(An=Hr.j-xn,xn=Hr.j,e(!(1&An)),Hr.O+=Zr.R*An,Hr.N+=Zr.B*(An>>1),Hr.W+=Zr.B*(An>>1),Hr.F!=null&&(Hr.J+=Hr.width*An)),xn<Mn&&(Hr.O+=Hr.v,Hr.N+=Hr.v>>1,Hr.W+=Hr.v>>1,Hr.F!=null&&(Hr.J+=Hr.v),Hr.ka=xn-Hr.j,Hr.U=Hr.va-Hr.v,Hr.T=Mn-xn,zn=Hr.put(Hr))}gn+1!=Zr.Ic||ns||(ei(Zr.sa,Zr.ta-hn,ds,ms+16*Zr.R,hn),ei(Zr.qa,Zr.ra-On,Un,_n+8*Zr.B,On),ei(Zr.Ha,Zr.Ia-On,ps,ys+8*Zr.B,On))}if(!zn)return Vn(vn,6,"Output aborted.")}return 1})(Qi,dr)),dr.bc!=null&&dr.bc(dr),fr&=1}return fr?(Qi.cb=0,fr):0})(mi,Ri)||(Ci=mi.a)}}else Ci=mi.a}Ci==0&&Hi.Oa!=null&&Hi.Oa.fd&&(Ci=Io(Hi.ba))}Hi=Ci}ji=Hi!=0?null:11>ji?qi.f.RGBA.eb:qi.f.kb.y}else ji=null;return ji};var Nc=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function ai(wi,Oi){for(var Ii="",Li=0;Li<4;Li++)Ii+=String.fromCharCode(wi[Oi++]);return Ii}function oi(wi,Oi){return wi[Oi+0]|wi[Oi+1]<<8}function li(wi,Oi){return(wi[Oi+0]|wi[Oi+1]<<8|wi[Oi+2]<<16)>>>0}function ci(wi,Oi){return(wi[Oi+0]|wi[Oi+1]<<8|wi[Oi+2]<<16|wi[Oi+3]<<24)>>>0}new si;var ui=[0],di=[0],fi=[],hi=new si,pi=_t,gi=(function(wi,Oi){var Ii={},Li=0,Di=!1,Ni=0,$i=0;if(Ii.frames=[],!(function(Ti,ki){for(var xi=0;xi<4;xi++)if(Ti[ki+xi]!="RIFF".charCodeAt(xi))return!0;return!1})(wi,Oi)){for(ci(wi,Oi+=4),Oi+=8;Oi<wi.length;){var Ki=ai(wi,Oi),er=ci(wi,Oi+=4);Oi+=4;var Vi=er+(1&er);switch(Ki){case"VP8 ":case"VP8L":Ii.frames[Li]===void 0&&(Ii.frames[Li]={}),(Wi=Ii.frames[Li]).src_off=Di?$i:Oi-8,Wi.src_size=Ni+er+8,Li++,Di&&(Di=!1,Ni=0,$i=0);break;case"VP8X":(Wi=Ii.header={}).feature_flags=wi[Oi];var nr=Oi+4;Wi.canvas_width=1+li(wi,nr),nr+=3,Wi.canvas_height=1+li(wi,nr),nr+=3;break;case"ALPH":Di=!0,Ni=Vi+8,$i=Oi-8;break;case"ANIM":(Wi=Ii.header).bgcolor=ci(wi,Oi),nr=Oi+4,Wi.loop_count=oi(wi,nr),nr+=2;break;case"ANMF":var zi,Wi;(Wi=Ii.frames[Li]={}).offset_x=2*li(wi,Oi),Oi+=3,Wi.offset_y=2*li(wi,Oi),Oi+=3,Wi.width=1+li(wi,Oi),Oi+=3,Wi.height=1+li(wi,Oi),Oi+=3,Wi.duration=li(wi,Oi),Oi+=3,zi=wi[Oi++],Wi.dispose=1&zi,Wi.blend=zi>>1&1}Ki!="ANMF"&&(Oi+=Vi)}return Ii}})(pi,0);gi.response=pi,gi.rgbaoutput=!0,gi.dataurl=!1;var vi=gi.header?gi.header:null,yi=gi.frames?gi.frames:null;if(vi){vi.loop_counter=vi.loop_count,ui=[vi.canvas_height],di=[vi.canvas_width];for(var _i=0;_i<yi.length&&yi[_i].blend!=0;_i++);}var Ai=yi[0],Ei=hi.WebPDecodeRGBA(pi,Ai.src_off,Ai.src_size,di,ui);Ai.rgba=Ei,Ai.imgwidth=di[0],Ai.imgheight=ui[0];for(var Si=0;Si<di[0]*ui[0]*4;Si++)fi[Si]=Ei[Si];return this.width=di,this.height=ui,this.data=fi,this}/** ====================================================================
 * @license
 * jsPDF XMP metadata plugin
 * Copyright (c) 2016 Jussi Utunen, u-jussi@suomi24.fi
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 */function ce(){var _t,e=this.internal.__metadata__.metadata,n=unescape(encodeURIComponent(e));_t=this.internal.__metadata__.rawXml?n:'<x:xmpmeta xmlns:x="adobe:ns:meta/"><rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceUri+'"><jspdf:metadata>'+n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")+"</jspdf:metadata></rdf:Description></rdf:RDF></x:xmpmeta>",this.internal.__metadata__.metadataObjectNumber=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+_t.length+" >>"),this.internal.write("stream"),this.internal.write(_t),this.internal.write("endstream"),this.internal.write("endobj")}function le(){this.internal.__metadata__.metadataObjectNumber&&this.internal.write("/Metadata "+this.internal.__metadata__.metadataObjectNumber+" 0 R")}(function(_t){var e,n,ei,ti,ii,ri,ni,si,ai,oi=function(Ti){return Ti=Ti||{},this.isStrokeTransparent=Ti.isStrokeTransparent||!1,this.strokeOpacity=Ti.strokeOpacity||1,this.strokeStyle=Ti.strokeStyle||"#000000",this.fillStyle=Ti.fillStyle||"#000000",this.isFillTransparent=Ti.isFillTransparent||!1,this.fillOpacity=Ti.fillOpacity||1,this.font=Ti.font||"10px sans-serif",this.textBaseline=Ti.textBaseline||"alphabetic",this.textAlign=Ti.textAlign||"left",this.lineWidth=Ti.lineWidth||1,this.lineJoin=Ti.lineJoin||"miter",this.lineCap=Ti.lineCap||"butt",this.path=Ti.path||[],this.transform=Ti.transform!==void 0?Ti.transform.clone():new si,this.globalCompositeOperation=Ti.globalCompositeOperation||"normal",this.globalAlpha=Ti.globalAlpha||1,this.clip_path=Ti.clip_path||[],this.currentPoint=Ti.currentPoint||new ri,this.miterLimit=Ti.miterLimit||10,this.lastPoint=Ti.lastPoint||new ri,this.lineDashOffset=Ti.lineDashOffset||0,this.lineDash=Ti.lineDash||[],this.margin=Ti.margin||[0,0,0,0],this.prevPageLastElemOffset=Ti.prevPageLastElemOffset||0,this.ignoreClearRect=typeof Ti.ignoreClearRect!="boolean"||Ti.ignoreClearRect,this};_t.events.push(["initialized",function(){this.context2d=new li(this),e=this.internal.f2,n=this.internal.getCoordinateString,ei=this.internal.getVerticalCoordinateString,ti=this.internal.getHorizontalCoordinate,ii=this.internal.getVerticalCoordinate,ri=this.internal.Point,ni=this.internal.Rectangle,si=this.internal.Matrix,ai=new oi}]);var li=function(Ti){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var ki=Ti;Object.defineProperty(this,"pdf",{get:function(){return ki}});var xi=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return xi},set:function(Gi){xi=!!Gi}});var Mi=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return Mi},set:function(Gi){Mi=!!Gi}});var Ui=0;Object.defineProperty(this,"posX",{get:function(){return Ui},set:function(Gi){isNaN(Gi)||(Ui=Gi)}});var Yi=0;Object.defineProperty(this,"posY",{get:function(){return Yi},set:function(Gi){isNaN(Gi)||(Yi=Gi)}}),Object.defineProperty(this,"margin",{get:function(){return ai.margin},set:function(Gi){var gr;typeof Gi=="number"?gr=[Gi,Gi,Gi,Gi]:((gr=new Array(4))[0]=Gi[0],gr[1]=Gi.length>=2?Gi[1]:gr[0],gr[2]=Gi.length>=3?Gi[2]:gr[0],gr[3]=Gi.length>=4?Gi[3]:gr[1]),ai.margin=gr}});var sr=!1;Object.defineProperty(this,"autoPaging",{get:function(){return sr},set:function(Gi){sr=Gi}});var cr=0;Object.defineProperty(this,"lastBreak",{get:function(){return cr},set:function(Gi){cr=Gi}});var ir=[];Object.defineProperty(this,"pageBreaks",{get:function(){return ir},set:function(Gi){ir=Gi}}),Object.defineProperty(this,"ctx",{get:function(){return ai},set:function(Gi){Gi instanceof oi&&(ai=Gi)}}),Object.defineProperty(this,"path",{get:function(){return ai.path},set:function(Gi){ai.path=Gi}});var Zi=[];Object.defineProperty(this,"ctxStack",{get:function(){return Zi},set:function(Gi){Zi=Gi}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(Gi){var gr;gr=ci(Gi),this.ctx.fillStyle=gr.style,this.ctx.isFillTransparent=gr.a===0,this.ctx.fillOpacity=gr.a,this.pdf.setFillColor(gr.r,gr.g,gr.b,{a:gr.a}),this.pdf.setTextColor(gr.r,gr.g,gr.b,{a:gr.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(Gi){var gr=ci(Gi);this.ctx.strokeStyle=gr.style,this.ctx.isStrokeTransparent=gr.a===0,this.ctx.strokeOpacity=gr.a,gr.a===0?this.pdf.setDrawColor(255,255,255):(gr.a,this.pdf.setDrawColor(gr.r,gr.g,gr.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(Gi){["butt","round","square"].indexOf(Gi)!==-1&&(this.ctx.lineCap=Gi,this.pdf.setLineCap(Gi))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(Gi){isNaN(Gi)||(this.ctx.lineWidth=Gi,this.pdf.setLineWidth(Gi))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(Gi){["bevel","round","miter"].indexOf(Gi)!==-1&&(this.ctx.lineJoin=Gi,this.pdf.setLineJoin(Gi))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(Gi){isNaN(Gi)||(this.ctx.miterLimit=Gi,this.pdf.setMiterLimit(Gi))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(Gi){this.ctx.textBaseline=Gi}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(Gi){["right","end","center","left","start"].indexOf(Gi)!==-1&&(this.ctx.textAlign=Gi)}});var rr=null,ar=null,pr=null;Object.defineProperty(this,"fontFaces",{get:function(){return pr},set:function(Gi){rr=null,ar=null,pr=Gi}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(Gi){var gr;if(this.ctx.font=Gi,(gr=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(Gi))!==null){var Br=gr[1];gr[2];var Nr=gr[3],mr=gr[4];gr[5];var Mr=gr[6],Er=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(mr)[2];mr=Math.floor(Er==="px"?parseFloat(mr)*this.pdf.internal.scaleFactor:Er==="em"?parseFloat(mr)*this.pdf.getFontSize():parseFloat(mr)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(mr);var Fr=(function(Or){var nn,en,Vr=[],Xr=Or.trim();if(Xr==="")return Gt;if(Xr in qt)return[qt[Xr]];for(;Xr!=="";){switch(en=null,nn=(Xr=Rt(Xr)).charAt(0)){case'"':case"'":en=Dt(Xr.substring(1),nn);break;default:en=Tt(Xr)}if(en===null||(Vr.push(en[0]),(Xr=Rt(en[1]))!==""&&Xr.charAt(0)!==","))return Gt;Xr=Xr.replace(/^,/,"")}return Vr})(Mr);if(this.fontFaces){var or=(function(Or,nn){var en=Or.getFontList(),Vr=JSON.stringify(en);if(rr===null||ar!==Vr){var Xr=(function(tn){var Dr=[];return Object.keys(tn).forEach(function(rn){tn[rn].forEach(function(jr){var $r=null;switch(jr){case"bold":$r={family:rn,weight:"bold"};break;case"italic":$r={family:rn,style:"italic"};break;case"bolditalic":$r={family:rn,weight:"bold",style:"italic"};break;case"":case"normal":$r={family:rn}}$r!==null&&($r.ref={name:rn,style:jr},Dr.push($r))})}),Dr})(en);rr=(function(tn){for(var Dr={},rn=0;rn<tn.length;++rn){var jr=Ot(tn[rn]),$r=jr.family,un=jr.stretch,sn=jr.style,Wr=jr.weight;Dr[$r]=Dr[$r]||{},Dr[$r][un]=Dr[$r][un]||{},Dr[$r][un][sn]=Dr[$r][un][sn]||{},Dr[$r][un][sn][Wr]=jr}return Dr})(Xr.concat(nn)),ar=Vr}return rr})(this.pdf,this.fontFaces),yr=Fr.map(function(Or){return{family:Or,stretch:"normal",weight:Nr,style:Br}}),_r=(function(Or,nn,en){for(var Vr=(en=en||{}).defaultFontFamily||"times",Xr=Object.assign({},Mt,en.genericFontFamilies||{}),tn=null,Dr=null,rn=0;rn<nn.length;++rn)if(Xr[(tn=Ot(nn[rn])).family]&&(tn.family=Xr[tn.family]),Or.hasOwnProperty(tn.family)){Dr=Or[tn.family];break}if(!(Dr=Dr||Or[Vr]))throw new Error("Could not find a font-family for the rule '"+Et(tn)+"' and default family '"+Vr+"'.");if(Dr=(function(jr,$r){if($r[jr])return $r[jr];var un=It[jr],sn=un<=It.normal?-1:1,Wr=Bt($r,Ft,un,sn);if(!Wr)throw new Error("Could not find a matching font-stretch value for "+jr);return Wr})(tn.stretch,Dr),Dr=(function(jr,$r){if($r[jr])return $r[jr];for(var un=kt[jr],sn=0;sn<un.length;++sn)if($r[un[sn]])return $r[un[sn]];throw new Error("Could not find a matching font-style for "+jr)})(tn.style,Dr),!(Dr=(function(jr,$r){if($r[jr])return $r[jr];if(jr===400&&$r[500])return $r[500];if(jr===500&&$r[400])return $r[400];var un=Ct[jr],sn=Bt($r,jt,un,jr<400?-1:1);if(!sn)throw new Error("Could not find a matching font-weight for value "+jr);return sn})(tn.weight,Dr)))throw new Error("Failed to resolve a font for the rule '"+Et(tn)+"'.");return Dr})(or,yr);this.pdf.setFont(_r.ref.name,_r.ref.style)}else{var Ar="";(Nr==="bold"||parseInt(Nr,10)>=700||Br==="bold")&&(Ar="bold"),Br==="italic"&&(Ar+="italic"),Ar.length===0&&(Ar="normal");for(var wr="",Rr={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Sr=0;Sr<Fr.length;Sr++){if(this.pdf.internal.getFont(Fr[Sr],Ar,{noFallback:!0,disableWarning:!0})!==void 0){wr=Fr[Sr];break}if(Ar==="bolditalic"&&this.pdf.internal.getFont(Fr[Sr],"bold",{noFallback:!0,disableWarning:!0})!==void 0)wr=Fr[Sr],Ar="bold";else if(this.pdf.internal.getFont(Fr[Sr],"normal",{noFallback:!0,disableWarning:!0})!==void 0){wr=Fr[Sr],Ar="normal";break}}if(wr===""){for(var Gr=0;Gr<Fr.length;Gr++)if(Rr[Fr[Gr]]){wr=Rr[Fr[Gr]];break}}wr=wr===""?"Times":wr,this.pdf.setFont(wr,Ar)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(Gi){this.ctx.globalCompositeOperation=Gi}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(Gi){this.ctx.globalAlpha=Gi}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(Gi){this.ctx.lineDashOffset=Gi,Wi.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(Gi){this.ctx.lineDash=Gi,Wi.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(Gi){this.ctx.ignoreClearRect=!!Gi}})};li.prototype.setLineDash=function(Ti){this.lineDash=Ti},li.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},li.prototype.fill=function(){yi.call(this,"fill",!1)},li.prototype.stroke=function(){yi.call(this,"stroke",!1)},li.prototype.beginPath=function(){this.path=[{type:"begin"}]},li.prototype.moveTo=function(Ti,ki){if(isNaN(Ti)||isNaN(ki))throw o.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var xi=this.ctx.transform.applyToPoint(new ri(Ti,ki));this.path.push({type:"mt",x:xi.x,y:xi.y}),this.ctx.lastPoint=new ri(Ti,ki)},li.prototype.closePath=function(){var Ti=new ri(0,0),ki=0;for(ki=this.path.length-1;ki!==-1;ki--)if(this.path[ki].type==="begin"&&_typeof(this.path[ki+1])==="object"&&typeof this.path[ki+1].x=="number"){Ti=new ri(this.path[ki+1].x,this.path[ki+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new ri(Ti.x,Ti.y)},li.prototype.lineTo=function(Ti,ki){if(isNaN(Ti)||isNaN(ki))throw o.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var xi=this.ctx.transform.applyToPoint(new ri(Ti,ki));this.path.push({type:"lt",x:xi.x,y:xi.y}),this.ctx.lastPoint=new ri(xi.x,xi.y)},li.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),yi.call(this,null,!0)},li.prototype.quadraticCurveTo=function(Ti,ki,xi,Mi){if(isNaN(xi)||isNaN(Mi)||isNaN(Ti)||isNaN(ki))throw o.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var Ui=this.ctx.transform.applyToPoint(new ri(xi,Mi)),Yi=this.ctx.transform.applyToPoint(new ri(Ti,ki));this.path.push({type:"qct",x1:Yi.x,y1:Yi.y,x:Ui.x,y:Ui.y}),this.ctx.lastPoint=new ri(Ui.x,Ui.y)},li.prototype.bezierCurveTo=function(Ti,ki,xi,Mi,Ui,Yi){if(isNaN(Ui)||isNaN(Yi)||isNaN(Ti)||isNaN(ki)||isNaN(xi)||isNaN(Mi))throw o.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var sr=this.ctx.transform.applyToPoint(new ri(Ui,Yi)),cr=this.ctx.transform.applyToPoint(new ri(Ti,ki)),ir=this.ctx.transform.applyToPoint(new ri(xi,Mi));this.path.push({type:"bct",x1:cr.x,y1:cr.y,x2:ir.x,y2:ir.y,x:sr.x,y:sr.y}),this.ctx.lastPoint=new ri(sr.x,sr.y)},li.prototype.arc=function(Ti,ki,xi,Mi,Ui,Yi){if(isNaN(Ti)||isNaN(ki)||isNaN(xi)||isNaN(Mi)||isNaN(Ui))throw o.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(Yi=!!Yi,!this.ctx.transform.isIdentity){var sr=this.ctx.transform.applyToPoint(new ri(Ti,ki));Ti=sr.x,ki=sr.y;var cr=this.ctx.transform.applyToPoint(new ri(0,xi)),ir=this.ctx.transform.applyToPoint(new ri(0,0));xi=Math.sqrt(Math.pow(cr.x-ir.x,2)+Math.pow(cr.y-ir.y,2))}Math.abs(Ui-Mi)>=2*Math.PI&&(Mi=0,Ui=2*Math.PI),this.path.push({type:"arc",x:Ti,y:ki,radius:xi,startAngle:Mi,endAngle:Ui,counterclockwise:Yi})},li.prototype.arcTo=function(Ti,ki,xi,Mi,Ui){throw new Error("arcTo not implemented.")},li.prototype.rect=function(Ti,ki,xi,Mi){if(isNaN(Ti)||isNaN(ki)||isNaN(xi)||isNaN(Mi))throw o.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(Ti,ki),this.lineTo(Ti+xi,ki),this.lineTo(Ti+xi,ki+Mi),this.lineTo(Ti,ki+Mi),this.lineTo(Ti,ki),this.lineTo(Ti+xi,ki),this.lineTo(Ti,ki)},li.prototype.fillRect=function(Ti,ki,xi,Mi){if(isNaN(Ti)||isNaN(ki)||isNaN(xi)||isNaN(Mi))throw o.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!ui.call(this)){var Ui={};this.lineCap!=="butt"&&(Ui.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(Ui.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(Ti,ki,xi,Mi),this.fill(),Ui.hasOwnProperty("lineCap")&&(this.lineCap=Ui.lineCap),Ui.hasOwnProperty("lineJoin")&&(this.lineJoin=Ui.lineJoin)}},li.prototype.strokeRect=function(Ti,ki,xi,Mi){if(isNaN(Ti)||isNaN(ki)||isNaN(xi)||isNaN(Mi))throw o.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");di.call(this)||(this.beginPath(),this.rect(Ti,ki,xi,Mi),this.stroke())},li.prototype.clearRect=function(Ti,ki,xi,Mi){if(isNaN(Ti)||isNaN(ki)||isNaN(xi)||isNaN(Mi))throw o.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(Ti,ki,xi,Mi))},li.prototype.save=function(Ti){Ti=typeof Ti!="boolean"||Ti;for(var ki=this.pdf.internal.getCurrentPageInfo().pageNumber,xi=0;xi<this.pdf.internal.getNumberOfPages();xi++)this.pdf.setPage(xi+1),this.pdf.internal.out("q");if(this.pdf.setPage(ki),Ti){this.ctx.fontSize=this.pdf.internal.getFontSize();var Mi=new oi(this.ctx);this.ctxStack.push(this.ctx),this.ctx=Mi}},li.prototype.restore=function(Ti){Ti=typeof Ti!="boolean"||Ti;for(var ki=this.pdf.internal.getCurrentPageInfo().pageNumber,xi=0;xi<this.pdf.internal.getNumberOfPages();xi++)this.pdf.setPage(xi+1),this.pdf.internal.out("Q");this.pdf.setPage(ki),Ti&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},li.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var ci=function(Ti){var ki,xi,Mi,Ui;if(Ti.isCanvasGradient===!0&&(Ti=Ti.getColor()),!Ti)return{r:0,g:0,b:0,a:0,style:Ti};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(Ti))ki=0,xi=0,Mi=0,Ui=0;else{var Yi=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(Ti);if(Yi!==null)ki=parseInt(Yi[1]),xi=parseInt(Yi[2]),Mi=parseInt(Yi[3]),Ui=1;else if((Yi=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(Ti))!==null)ki=parseInt(Yi[1]),xi=parseInt(Yi[2]),Mi=parseInt(Yi[3]),Ui=parseFloat(Yi[4]);else{if(Ui=1,typeof Ti=="string"&&Ti.charAt(0)!=="#"){var sr=new h(Ti);Ti=sr.ok?sr.toHex():"#000000"}Ti.length===4?(ki=Ti.substring(1,2),ki+=ki,xi=Ti.substring(2,3),xi+=xi,Mi=Ti.substring(3,4),Mi+=Mi):(ki=Ti.substring(1,3),xi=Ti.substring(3,5),Mi=Ti.substring(5,7)),ki=parseInt(ki,16),xi=parseInt(xi,16),Mi=parseInt(Mi,16)}}return{r:ki,g:xi,b:Mi,a:Ui,style:Ti}},ui=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},di=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};li.prototype.fillText=function(Ti,ki,xi,Mi){if(isNaN(ki)||isNaN(xi)||typeof Ti!="string")throw o.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(Mi=isNaN(Mi)?void 0:Mi,!ui.call(this)){var Ui=Vi(this.ctx.transform.rotation),Yi=this.ctx.transform.scaleX;Li.call(this,{text:Ti,x:ki,y:xi,scale:Yi,angle:Ui,align:this.textAlign,maxWidth:Mi})}},li.prototype.strokeText=function(Ti,ki,xi,Mi){if(isNaN(ki)||isNaN(xi)||typeof Ti!="string")throw o.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!di.call(this)){Mi=isNaN(Mi)?void 0:Mi;var Ui=Vi(this.ctx.transform.rotation),Yi=this.ctx.transform.scaleX;Li.call(this,{text:Ti,x:ki,y:xi,scale:Yi,renderingMode:"stroke",angle:Ui,align:this.textAlign,maxWidth:Mi})}},li.prototype.measureText=function(Ti){if(typeof Ti!="string")throw o.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var ki=this.pdf,xi=this.pdf.internal.scaleFactor,Mi=ki.internal.getFontSize(),Ui=ki.getStringUnitWidth(Ti)*Mi/ki.internal.scaleFactor;return new function(Yi){var sr=(Yi=Yi||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return sr}}),this}({width:Ui*=Math.round(96*xi/72*1e4)/1e4})},li.prototype.scale=function(Ti,ki){if(isNaN(Ti)||isNaN(ki))throw o.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var xi=new si(Ti,0,0,ki,0,0);this.ctx.transform=this.ctx.transform.multiply(xi)},li.prototype.rotate=function(Ti){if(isNaN(Ti))throw o.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var ki=new si(Math.cos(Ti),Math.sin(Ti),-Math.sin(Ti),Math.cos(Ti),0,0);this.ctx.transform=this.ctx.transform.multiply(ki)},li.prototype.translate=function(Ti,ki){if(isNaN(Ti)||isNaN(ki))throw o.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var xi=new si(1,0,0,1,Ti,ki);this.ctx.transform=this.ctx.transform.multiply(xi)},li.prototype.transform=function(Ti,ki,xi,Mi,Ui,Yi){if(isNaN(Ti)||isNaN(ki)||isNaN(xi)||isNaN(Mi)||isNaN(Ui)||isNaN(Yi))throw o.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var sr=new si(Ti,ki,xi,Mi,Ui,Yi);this.ctx.transform=this.ctx.transform.multiply(sr)},li.prototype.setTransform=function(Ti,ki,xi,Mi,Ui,Yi){Ti=isNaN(Ti)?1:Ti,ki=isNaN(ki)?0:ki,xi=isNaN(xi)?0:xi,Mi=isNaN(Mi)?1:Mi,Ui=isNaN(Ui)?0:Ui,Yi=isNaN(Yi)?0:Yi,this.ctx.transform=new si(Ti,ki,xi,Mi,Ui,Yi)};var fi=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};li.prototype.drawImage=function(Ti,ki,xi,Mi,Ui,Yi,sr,cr,ir){var Zi=this.pdf.getImageProperties(Ti),rr=1,ar=1,pr=1,Gi=1;Mi!==void 0&&cr!==void 0&&(pr=cr/Mi,Gi=ir/Ui,rr=Zi.width/Mi*cr/Mi,ar=Zi.height/Ui*ir/Ui),Yi===void 0&&(Yi=ki,sr=xi,ki=0,xi=0),Mi!==void 0&&cr===void 0&&(cr=Mi,ir=Ui),Mi===void 0&&cr===void 0&&(cr=Zi.width,ir=Zi.height);var gr=this.ctx.transform.decompose(),Br=Vi(gr.rotate.shx),Nr=new si,mr=(Nr=(Nr=(Nr=Nr.multiply(gr.translate)).multiply(gr.skew)).multiply(gr.scale)).applyToRectangle(new ni(Yi-ki*pr,sr-xi*Gi,Mi*rr,Ui*ar));if(this.autoPaging){for(var Mr,Er=hi.call(this,mr),Fr=[],or=0;or<Er.length;or+=1)Fr.indexOf(Er[or])===-1&&Fr.push(Er[or]);vi(Fr);for(var yr=Fr[0],_r=Fr[Fr.length-1],Ar=yr;Ar<_r+1;Ar++){this.pdf.setPage(Ar);var wr=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Rr=Ar===1?this.posY+this.margin[0]:this.margin[0],Sr=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Gr=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Or=Ar===1?0:Sr+(Ar-2)*Gr;if(this.ctx.clip_path.length!==0){var nn=this.path;Mr=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=gi(Mr,this.posX+this.margin[3],-Or+Rr+this.ctx.prevPageLastElemOffset),_i.call(this,"fill",!0),this.path=nn}var en=JSON.parse(JSON.stringify(mr));en=gi([en],this.posX+this.margin[3],-Or+Rr+this.ctx.prevPageLastElemOffset)[0];var Vr=(Ar>yr||Ar<_r)&&fi.call(this);Vr&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],wr,Gr,null).clip().discardPath()),this.pdf.addImage(Ti,"JPEG",en.x,en.y,en.w,en.h,null,null,Br),Vr&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(Ti,"JPEG",mr.x,mr.y,mr.w,mr.h,null,null,Br)};var hi=function(Ti,ki,xi){var Mi=[];ki=ki||this.pdf.internal.pageSize.width,xi=xi||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var Ui=this.posY+this.ctx.prevPageLastElemOffset;switch(Ti.type){default:case"mt":case"lt":Mi.push(Math.floor((Ti.y+Ui)/xi)+1);break;case"arc":Mi.push(Math.floor((Ti.y+Ui-Ti.radius)/xi)+1),Mi.push(Math.floor((Ti.y+Ui+Ti.radius)/xi)+1);break;case"qct":var Yi=nr(this.ctx.lastPoint.x,this.ctx.lastPoint.y,Ti.x1,Ti.y1,Ti.x,Ti.y);Mi.push(Math.floor((Yi.y+Ui)/xi)+1),Mi.push(Math.floor((Yi.y+Yi.h+Ui)/xi)+1);break;case"bct":var sr=zi(this.ctx.lastPoint.x,this.ctx.lastPoint.y,Ti.x1,Ti.y1,Ti.x2,Ti.y2,Ti.x,Ti.y);Mi.push(Math.floor((sr.y+Ui)/xi)+1),Mi.push(Math.floor((sr.y+sr.h+Ui)/xi)+1);break;case"rect":Mi.push(Math.floor((Ti.y+Ui)/xi)+1),Mi.push(Math.floor((Ti.y+Ti.h+Ui)/xi)+1)}for(var cr=0;cr<Mi.length;cr+=1)for(;this.pdf.internal.getNumberOfPages()<Mi[cr];)pi.call(this);return Mi},pi=function(){var Ti=this.fillStyle,ki=this.strokeStyle,xi=this.font,Mi=this.lineCap,Ui=this.lineWidth,Yi=this.lineJoin;this.pdf.addPage(),this.fillStyle=Ti,this.strokeStyle=ki,this.font=xi,this.lineCap=Mi,this.lineWidth=Ui,this.lineJoin=Yi},gi=function(Ti,ki,xi){for(var Mi=0;Mi<Ti.length;Mi++)switch(Ti[Mi].type){case"bct":Ti[Mi].x2+=ki,Ti[Mi].y2+=xi;case"qct":Ti[Mi].x1+=ki,Ti[Mi].y1+=xi;default:Ti[Mi].x+=ki,Ti[Mi].y+=xi}return Ti},vi=function(Ti){return Ti.sort(function(ki,xi){return ki-xi})},yi=function(Ti,ki){var xi=this.fillStyle,Mi=this.strokeStyle,Ui=this.lineCap,Yi=this.lineWidth,sr=Math.abs(Yi*this.ctx.transform.scaleX),cr=this.lineJoin;if(this.autoPaging){for(var ir,Zi,rr=JSON.parse(JSON.stringify(this.path)),ar=JSON.parse(JSON.stringify(this.path)),pr=[],Gi=0;Gi<ar.length;Gi++)if(ar[Gi].x!==void 0)for(var gr=hi.call(this,ar[Gi]),Br=0;Br<gr.length;Br+=1)pr.indexOf(gr[Br])===-1&&pr.push(gr[Br]);for(var Nr=0;Nr<pr.length;Nr++)for(;this.pdf.internal.getNumberOfPages()<pr[Nr];)pi.call(this);vi(pr);for(var mr=pr[0],Mr=pr[pr.length-1],Er=mr;Er<Mr+1;Er++){this.pdf.setPage(Er),this.fillStyle=xi,this.strokeStyle=Mi,this.lineCap=Ui,this.lineWidth=sr,this.lineJoin=cr;var Fr=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],or=Er===1?this.posY+this.margin[0]:this.margin[0],yr=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],_r=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ar=Er===1?0:yr+(Er-2)*_r;if(this.ctx.clip_path.length!==0){var wr=this.path;ir=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=gi(ir,this.posX+this.margin[3],-Ar+or+this.ctx.prevPageLastElemOffset),_i.call(this,Ti,!0),this.path=wr}if(Zi=JSON.parse(JSON.stringify(rr)),this.path=gi(Zi,this.posX+this.margin[3],-Ar+or+this.ctx.prevPageLastElemOffset),ki===!1||Er===0){var Rr=(Er>mr||Er<Mr)&&fi.call(this);Rr&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Fr,_r,null).clip().discardPath()),_i.call(this,Ti,ki),Rr&&this.pdf.restoreGraphicsState()}this.lineWidth=Yi}this.path=rr}else this.lineWidth=sr,_i.call(this,Ti,ki),this.lineWidth=Yi},_i=function(Ti,ki){if((Ti!=="stroke"||ki||!di.call(this))&&(Ti==="stroke"||ki||!ui.call(this))){for(var xi,Mi,Ui=[],Yi=this.path,sr=0;sr<Yi.length;sr++){var cr=Yi[sr];switch(cr.type){case"begin":Ui.push({begin:!0});break;case"close":Ui.push({close:!0});break;case"mt":Ui.push({start:cr,deltas:[],abs:[]});break;case"lt":var ir=Ui.length;if(Yi[sr-1]&&!isNaN(Yi[sr-1].x)&&(xi=[cr.x-Yi[sr-1].x,cr.y-Yi[sr-1].y],ir>0)){for(;ir>=0;ir--)if(Ui[ir-1].close!==!0&&Ui[ir-1].begin!==!0){Ui[ir-1].deltas.push(xi),Ui[ir-1].abs.push(cr);break}}break;case"bct":xi=[cr.x1-Yi[sr-1].x,cr.y1-Yi[sr-1].y,cr.x2-Yi[sr-1].x,cr.y2-Yi[sr-1].y,cr.x-Yi[sr-1].x,cr.y-Yi[sr-1].y],Ui[Ui.length-1].deltas.push(xi);break;case"qct":var Zi=Yi[sr-1].x+2/3*(cr.x1-Yi[sr-1].x),rr=Yi[sr-1].y+2/3*(cr.y1-Yi[sr-1].y),ar=cr.x+2/3*(cr.x1-cr.x),pr=cr.y+2/3*(cr.y1-cr.y),Gi=cr.x,gr=cr.y;xi=[Zi-Yi[sr-1].x,rr-Yi[sr-1].y,ar-Yi[sr-1].x,pr-Yi[sr-1].y,Gi-Yi[sr-1].x,gr-Yi[sr-1].y],Ui[Ui.length-1].deltas.push(xi);break;case"arc":Ui.push({deltas:[],abs:[],arc:!0}),Array.isArray(Ui[Ui.length-1].abs)&&Ui[Ui.length-1].abs.push(cr)}}Mi=ki?null:Ti==="stroke"?"stroke":"fill";for(var Br=!1,Nr=0;Nr<Ui.length;Nr++)if(Ui[Nr].arc)for(var mr=Ui[Nr].abs,Mr=0;Mr<mr.length;Mr++){var Er=mr[Mr];Er.type==="arc"?Si.call(this,Er.x,Er.y,Er.radius,Er.startAngle,Er.endAngle,Er.counterclockwise,void 0,ki,!Br):Di.call(this,Er.x,Er.y),Br=!0}else if(Ui[Nr].close===!0)this.pdf.internal.out("h"),Br=!1;else if(Ui[Nr].begin!==!0){var Fr=Ui[Nr].start.x,or=Ui[Nr].start.y;Ni.call(this,Ui[Nr].deltas,Fr,or),Br=!0}Mi&&wi.call(this,Mi),ki&&Oi.call(this)}},Ai=function(Ti){var ki=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,xi=ki*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return Ti-xi;case"top":return Ti+ki-xi;case"hanging":return Ti+ki-2*xi;case"middle":return Ti+ki/2-xi;default:return Ti}},Ei=function(Ti){return Ti+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};li.prototype.createLinearGradient=function(){var Ti=function(){};return Ti.colorStops=[],Ti.addColorStop=function(ki,xi){this.colorStops.push([ki,xi])},Ti.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},Ti.isCanvasGradient=!0,Ti},li.prototype.createPattern=function(){return this.createLinearGradient()},li.prototype.createRadialGradient=function(){return this.createLinearGradient()};var Si=function(Ti,ki,xi,Mi,Ui,Yi,sr,cr,ir){for(var Zi=Ki.call(this,xi,Mi,Ui,Yi),rr=0;rr<Zi.length;rr++){var ar=Zi[rr];rr===0&&(ir?Ii.call(this,ar.x1+Ti,ar.y1+ki):Di.call(this,ar.x1+Ti,ar.y1+ki)),$i.call(this,Ti,ki,ar.x2,ar.y2,ar.x3,ar.y3,ar.x4,ar.y4)}cr?Oi.call(this):wi.call(this,sr)},wi=function(Ti){switch(Ti){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},Oi=function(){this.pdf.clip(),this.pdf.discardPath()},Ii=function(Ti,ki){this.pdf.internal.out(n(Ti)+" "+ei(ki)+" m")},Li=function(Ti){var ki;switch(Ti.align){case"right":case"end":ki="right";break;case"center":ki="center";break;default:ki="left"}var xi,Mi,Ui,Yi=this.pdf.getTextDimensions(Ti.text),sr=Ai.call(this,Ti.y),cr=Ei.call(this,sr)-Yi.h,ir=this.ctx.transform.applyToPoint(new ri(Ti.x,sr));if(this.autoPaging){var Zi=this.ctx.transform.decompose(),rr=new si;rr=(rr=(rr=rr.multiply(Zi.translate)).multiply(Zi.skew)).multiply(Zi.scale);for(var ar=this.ctx.transform.applyToRectangle(new ni(Ti.x,sr,Yi.w,Yi.h)),pr=rr.applyToRectangle(new ni(Ti.x,cr,Yi.w,Yi.h)),Gi=hi.call(this,pr),gr=[],Br=0;Br<Gi.length;Br+=1)gr.indexOf(Gi[Br])===-1&&gr.push(Gi[Br]);vi(gr);for(var Nr=gr[0],mr=gr[gr.length-1],Mr=Nr;Mr<mr+1;Mr++){this.pdf.setPage(Mr);var Er=Mr===1?this.posY+this.margin[0]:this.margin[0],Fr=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],or=this.pdf.internal.pageSize.height-this.margin[2],yr=or-this.margin[0],_r=this.pdf.internal.pageSize.width-this.margin[1],Ar=_r-this.margin[3],wr=Mr===1?0:Fr+(Mr-2)*yr;if(this.ctx.clip_path.length!==0){var Rr=this.path;xi=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=gi(xi,this.posX+this.margin[3],-1*wr+Er),_i.call(this,"fill",!0),this.path=Rr}var Sr=gi([JSON.parse(JSON.stringify(pr))],this.posX+this.margin[3],-wr+Er+this.ctx.prevPageLastElemOffset)[0];Ti.scale>=.01&&(Mi=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Mi*Ti.scale),Ui=this.lineWidth,this.lineWidth=Ui*Ti.scale);var Gr=this.autoPaging!=="text";if(Gr||Sr.y+Sr.h<=or){if(Gr||Sr.y>=Er&&Sr.x<=_r){var Or=Gr?Ti.text:this.pdf.splitTextToSize(Ti.text,Ti.maxWidth||_r-Sr.x)[0],nn=gi([JSON.parse(JSON.stringify(ar))],this.posX+this.margin[3],-wr+Er+this.ctx.prevPageLastElemOffset)[0],en=Gr&&(Mr>Nr||Mr<mr)&&fi.call(this);en&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ar,yr,null).clip().discardPath()),this.pdf.text(Or,nn.x,nn.y,{angle:Ti.angle,align:ki,renderingMode:Ti.renderingMode}),en&&this.pdf.restoreGraphicsState()}}else Sr.y<or&&(this.ctx.prevPageLastElemOffset+=or-Sr.y);Ti.scale>=.01&&(this.pdf.setFontSize(Mi),this.lineWidth=Ui)}}else Ti.scale>=.01&&(Mi=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Mi*Ti.scale),Ui=this.lineWidth,this.lineWidth=Ui*Ti.scale),this.pdf.text(Ti.text,ir.x+this.posX,ir.y+this.posY,{angle:Ti.angle,align:ki,renderingMode:Ti.renderingMode,maxWidth:Ti.maxWidth}),Ti.scale>=.01&&(this.pdf.setFontSize(Mi),this.lineWidth=Ui)},Di=function(Ti,ki,xi,Mi){xi=xi||0,Mi=Mi||0,this.pdf.internal.out(n(Ti+xi)+" "+ei(ki+Mi)+" l")},Ni=function(Ti,ki,xi){return this.pdf.lines(Ti,ki,xi,null,null)},$i=function(Ti,ki,xi,Mi,Ui,Yi,sr,cr){this.pdf.internal.out([e(ti(xi+Ti)),e(ii(Mi+ki)),e(ti(Ui+Ti)),e(ii(Yi+ki)),e(ti(sr+Ti)),e(ii(cr+ki)),"c"].join(" "))},Ki=function(Ti,ki,xi,Mi){for(var Ui=2*Math.PI,Yi=Math.PI/2;ki>xi;)ki-=Ui;var sr=Math.abs(xi-ki);sr<Ui&&Mi&&(sr=Ui-sr);for(var cr=[],ir=Mi?-1:1,Zi=ki;sr>1e-5;){var rr=Zi+ir*Math.min(sr,Yi);cr.push(er.call(this,Ti,Zi,rr)),sr-=Math.abs(rr-Zi),Zi=rr}return cr},er=function(Ti,ki,xi){var Mi=(xi-ki)/2,Ui=Ti*Math.cos(Mi),Yi=Ti*Math.sin(Mi),sr=Ui,cr=-Yi,ir=sr*sr+cr*cr,Zi=ir+sr*Ui+cr*Yi,rr=4/3*(Math.sqrt(2*ir*Zi)-Zi)/(sr*Yi-cr*Ui),ar=sr-rr*cr,pr=cr+rr*sr,Gi=ar,gr=-pr,Br=Mi+ki,Nr=Math.cos(Br),mr=Math.sin(Br);return{x1:Ti*Math.cos(ki),y1:Ti*Math.sin(ki),x2:ar*Nr-pr*mr,y2:ar*mr+pr*Nr,x3:Gi*Nr-gr*mr,y3:Gi*mr+gr*Nr,x4:Ti*Math.cos(xi),y4:Ti*Math.sin(xi)}},Vi=function(Ti){return 180*Ti/Math.PI},nr=function(Ti,ki,xi,Mi,Ui,Yi){var sr=Ti+.5*(xi-Ti),cr=ki+.5*(Mi-ki),ir=Ui+.5*(xi-Ui),Zi=Yi+.5*(Mi-Yi),rr=Math.min(Ti,Ui,sr,ir),ar=Math.max(Ti,Ui,sr,ir),pr=Math.min(ki,Yi,cr,Zi),Gi=Math.max(ki,Yi,cr,Zi);return new ni(rr,pr,ar-rr,Gi-pr)},zi=function(Ti,ki,xi,Mi,Ui,Yi,sr,cr){var ir,Zi,rr,ar,pr,Gi,gr,Br,Nr,mr,Mr,Er,Fr,or,yr=xi-Ti,_r=Mi-ki,Ar=Ui-xi,wr=Yi-Mi,Rr=sr-Ui,Sr=cr-Yi;for(Zi=0;Zi<41;Zi++)Nr=(gr=(rr=Ti+(ir=Zi/40)*yr)+ir*((pr=xi+ir*Ar)-rr))+ir*(pr+ir*(Ui+ir*Rr-pr)-gr),mr=(Br=(ar=ki+ir*_r)+ir*((Gi=Mi+ir*wr)-ar))+ir*(Gi+ir*(Yi+ir*Sr-Gi)-Br),Zi==0?(Mr=Nr,Er=mr,Fr=Nr,or=mr):(Mr=Math.min(Mr,Nr),Er=Math.min(Er,mr),Fr=Math.max(Fr,Nr),or=Math.max(or,mr));return new ni(Math.round(Mr),Math.round(Er),Math.round(Fr-Mr),Math.round(or-Er))},Wi=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var Ti,ki,xi=(Ti=this.ctx.lineDash,ki=this.ctx.lineDashOffset,JSON.stringify({lineDash:Ti,lineDashOffset:ki}));this.prevLineDash!==xi&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=xi)}}})(E.API),(function(_t){var e=function(ri){var ni,si,ai,oi,li,ci,ui,di,fi,hi;for(si=[],ai=0,oi=(ri+=ni="\0\0\0\0".slice(ri.length%4||4)).length;oi>ai;ai+=4)(li=(ri.charCodeAt(ai)<<24)+(ri.charCodeAt(ai+1)<<16)+(ri.charCodeAt(ai+2)<<8)+ri.charCodeAt(ai+3))!==0?(ci=(li=((li=((li=((li=(li-(hi=li%85))/85)-(fi=li%85))/85)-(di=li%85))/85)-(ui=li%85))/85)%85,si.push(ci+33,ui+33,di+33,fi+33,hi+33)):si.push(122);return(function(pi,gi){for(var vi=gi;vi>0;vi--)pi.pop()})(si,ni.length),String.fromCharCode.apply(String,si)+"~>"},n=function(ri){var ni,si,ai,oi,li,ci=String,ui="length",di=255,fi="charCodeAt",hi="slice",pi="replace";for(ri[hi](-2),ri=ri[hi](0,-2)[pi](/\s/g,"")[pi]("z","!!!!!"),ai=[],oi=0,li=(ri+=ni="uuuuu"[hi](ri[ui]%5||5))[ui];li>oi;oi+=5)si=52200625*(ri[fi](oi)-33)+614125*(ri[fi](oi+1)-33)+7225*(ri[fi](oi+2)-33)+85*(ri[fi](oi+3)-33)+(ri[fi](oi+4)-33),ai.push(di&si>>24,di&si>>16,di&si>>8,di&si);return(function(gi,vi){for(var yi=vi;yi>0;yi--)gi.pop()})(ai,ni[ui]),ci.fromCharCode.apply(ci,ai)},ei=function(ri){return ri.split("").map(function(ni){return("0"+ni.charCodeAt().toString(16)).slice(-2)}).join("")+">"},ti=function(ri){var ni=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((ri=ri.replace(/\s/g,"")).indexOf(">")!==-1&&(ri=ri.substr(0,ri.indexOf(">"))),ri.length%2&&(ri+="0"),ni.test(ri)===!1)return"";for(var si="",ai=0;ai<ri.length;ai+=2)si+=String.fromCharCode("0x"+(ri[ai]+ri[ai+1]));return si},ii=function(ri){for(var ni=new Uint8Array(ri.length),si=ri.length;si--;)ni[si]=ri.charCodeAt(si);return(ni=zlibSync(ni)).reduce(function(ai,oi){return ai+String.fromCharCode(oi)},"")};_t.processDataByFilters=function(ri,ni){var si=0,ai=ri||"",oi=[];for(typeof(ni=ni||[])=="string"&&(ni=[ni]),si=0;si<ni.length;si+=1)switch(ni[si]){case"ASCII85Decode":case"/ASCII85Decode":ai=n(ai),oi.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":ai=e(ai),oi.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":ai=ti(ai),oi.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":ai=ei(ai),oi.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":ai=ii(ai),oi.push("/FlateDecode");break;default:throw new Error('The filter: "'+ni[si]+'" is not implemented')}return{data:ai,reverseChain:oi.reverse().join(" ")}}})(E.API),(function(_t){_t.loadFile=function(e,n,ei){return(function(ti,ii,ri){ii=ii!==!1,ri=typeof ri=="function"?ri:function(){};var ni=void 0;try{ni=(function(si,ai,oi){var li=new XMLHttpRequest,ci=0,ui=function(di){var fi=di.length,hi=[],pi=String.fromCharCode;for(ci=0;ci<fi;ci+=1)hi.push(pi(255&di.charCodeAt(ci)));return hi.join("")};if(li.open("GET",si,!ai),li.overrideMimeType("text/plain; charset=x-user-defined"),ai===!1&&(li.onload=function(){li.status===200?oi(ui(this.responseText)):oi(void 0)}),li.send(null),ai&&li.status===200)return ui(li.responseText)})(ti,ii,ri)}catch{}return ni})(e,n,ei)},_t.allowFsRead=void 0,_t.loadImageFile=_t.loadFile})(E.API),(function(_t){function e(){return(i.html2canvas?Promise.resolve(i.html2canvas):__vitePreload(()=>import("./html2canvas.esm-QH1iLAAe.js"),[])).catch(function(ni){return Promise.reject(new Error("Could not load html2canvas: "+ni))}).then(function(ni){return ni.default?ni.default:ni})}function n(){return(i.DOMPurify?Promise.resolve(i.DOMPurify):__vitePreload(()=>import("./purify.es-B9ZVCkUG.js"),[])).catch(function(ni){return Promise.reject(new Error("Could not load dompurify: "+ni))}).then(function(ni){return ni.default?ni.default:ni})}var ei=function(ni){var si=_typeof(ni);return si==="undefined"?"undefined":si==="string"||ni instanceof String?"string":si==="number"||ni instanceof Number?"number":si==="function"||ni instanceof Function?"function":ni&&ni.constructor===Array?"array":ni&&ni.nodeType===1?"element":si==="object"?"object":"unknown"},ti=function(ni,si){var ai=document.createElement(ni);for(var oi in si.className&&(ai.className=si.className),si.innerHTML&&si.dompurify&&(ai.innerHTML=si.dompurify.sanitize(si.innerHTML)),si.style)ai.style[oi]=si.style[oi];return ai},ii=function ni(si,ai){for(var oi=si.nodeType===3?document.createTextNode(si.nodeValue):si.cloneNode(!1),li=si.firstChild;li;li=li.nextSibling)ai!==!0&&li.nodeType===1&&li.nodeName==="SCRIPT"||oi.appendChild(ni(li,ai));return si.nodeType===1&&(si.nodeName==="CANVAS"?(oi.width=si.width,oi.height=si.height,oi.getContext("2d").drawImage(si,0,0)):si.nodeName!=="TEXTAREA"&&si.nodeName!=="SELECT"||(oi.value=si.value),oi.addEventListener("load",function(){oi.scrollTop=si.scrollTop,oi.scrollLeft=si.scrollLeft},!0)),oi},ri=function ni(si){var ai=Object.assign(ni.convert(Promise.resolve()),JSON.parse(JSON.stringify(ni.template))),oi=ni.convert(Promise.resolve(),ai);return(oi=oi.setProgress(1,ni,1,[ni])).set(si)};(ri.prototype=Object.create(Promise.prototype)).constructor=ri,ri.convert=function(ni,si){return ni.__proto__=si||ri.prototype,ni},ri.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},ri.prototype.from=function(ni,si){return this.then(function(){switch(si=si||(function(ai){switch(ei(ai)){case"string":return"string";case"element":return ai.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(ni),si){case"string":return this.then(n).then(function(ai){return this.set({src:ti("div",{innerHTML:ni,dompurify:ai})})});case"element":return this.set({src:ni});case"canvas":return this.set({canvas:ni});case"img":return this.set({img:ni});default:return this.error("Unknown source type.")}})},ri.prototype.to=function(ni){switch(ni){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},ri.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var ni={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},si=ii(this.prop.src,this.opt.html2canvas.javascriptEnabled);si.tagName==="BODY"&&(ni.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=ti("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=ti("div",{className:"html2pdf__container",style:ni}),this.prop.container.appendChild(si),this.prop.container.firstChild.appendChild(ti("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},ri.prototype.toCanvas=function(){var ni=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(ni).then(e).then(function(si){var ai=Object.assign({},this.opt.html2canvas);return delete ai.onrendered,si(this.prop.container,ai)}).then(function(si){(this.opt.html2canvas.onrendered||function(){})(si),this.prop.canvas=si,document.body.removeChild(this.prop.overlay)})},ri.prototype.toContext2d=function(){var ni=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(ni).then(e).then(function(si){var ai=this.opt.jsPDF,oi=this.opt.fontFaces,li=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,ci=Object.assign({async:!0,allowTaint:!0,scale:li,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete ci.onrendered,ai.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,ai.context2d.posX=this.opt.x,ai.context2d.posY=this.opt.y,ai.context2d.margin=this.opt.margin,ai.context2d.fontFaces=oi,oi)for(var ui=0;ui<oi.length;++ui){var di=oi[ui],fi=di.src.find(function(hi){return hi.format==="truetype"});fi&&ai.addFont(fi.url,di.ref.name,di.ref.style)}return ci.windowHeight=ci.windowHeight||0,ci.windowHeight=ci.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):ci.windowHeight,ai.context2d.save(!0),si(this.prop.container,ci)}).then(function(si){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(si),this.prop.canvas=si,document.body.removeChild(this.prop.overlay)})},ri.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var ni=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=ni})},ri.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},ri.prototype.output=function(ni,si,ai){return(ai=ai||"pdf").toLowerCase()==="img"||ai.toLowerCase()==="image"?this.outputImg(ni,si):this.outputPdf(ni,si)},ri.prototype.outputPdf=function(ni,si){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(ni,si)})},ri.prototype.outputImg=function(ni){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(ni){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+ni+'" is not supported.'}})},ri.prototype.save=function(ni){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(ni?{filename:ni}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},ri.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},ri.prototype.set=function(ni){if(ei(ni)!=="object")return this;var si=Object.keys(ni||{}).map(function(ai){if(ai in ri.template.prop)return function(){this.prop[ai]=ni[ai]};switch(ai){case"margin":return this.setMargin.bind(this,ni.margin);case"jsPDF":return function(){return this.opt.jsPDF=ni.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,ni.pageSize);default:return function(){this.opt[ai]=ni[ai]}}},this);return this.then(function(){return this.thenList(si)})},ri.prototype.get=function(ni,si){return this.then(function(){var ai=ni in ri.template.prop?this.prop[ni]:this.opt[ni];return si?si(ai):ai})},ri.prototype.setMargin=function(ni){return this.then(function(){switch(ei(ni)){case"number":ni=[ni,ni,ni,ni];case"array":if(ni.length===2&&(ni=[ni[0],ni[1],ni[0],ni[1]]),ni.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=ni}).then(this.setPageSize)},ri.prototype.setPageSize=function(ni){function si(ai,oi){return Math.floor(ai*oi/72*96)}return this.then(function(){(ni=ni||E.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(ni.inner={width:ni.width-this.opt.margin[1]-this.opt.margin[3],height:ni.height-this.opt.margin[0]-this.opt.margin[2]},ni.inner.px={width:si(ni.inner.width,ni.k),height:si(ni.inner.height,ni.k)},ni.inner.ratio=ni.inner.height/ni.inner.width),this.prop.pageSize=ni})},ri.prototype.setProgress=function(ni,si,ai,oi){return ni!=null&&(this.progress.val=ni),si!=null&&(this.progress.state=si),ai!=null&&(this.progress.n=ai),oi!=null&&(this.progress.stack=oi),this.progress.ratio=this.progress.val/this.progress.state,this},ri.prototype.updateProgress=function(ni,si,ai,oi){return this.setProgress(ni?this.progress.val+ni:null,si||null,ai?this.progress.n+ai:null,oi?this.progress.stack.concat(oi):null)},ri.prototype.then=function(ni,si){var ai=this;return this.thenCore(ni,si,function(oi,li){return ai.updateProgress(null,null,1,[oi]),Promise.prototype.then.call(this,function(ci){return ai.updateProgress(null,oi),ci}).then(oi,li).then(function(ci){return ai.updateProgress(1),ci})})},ri.prototype.thenCore=function(ni,si,ai){ai=ai||Promise.prototype.then;var oi=this;ni&&(ni=ni.bind(oi)),si&&(si=si.bind(oi));var li=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?oi:ri.convert(Object.assign({},oi),Promise.prototype),ci=ai.call(li,ni,si);return ri.convert(ci,oi.__proto__)},ri.prototype.thenExternal=function(ni,si){return Promise.prototype.then.call(this,ni,si)},ri.prototype.thenList=function(ni){var si=this;return ni.forEach(function(ai){si=si.thenCore(ai)}),si},ri.prototype.catch=function(ni){ni&&(ni=ni.bind(this));var si=Promise.prototype.catch.call(this,ni);return ri.convert(si,this)},ri.prototype.catchExternal=function(ni){return Promise.prototype.catch.call(this,ni)},ri.prototype.error=function(ni){return this.then(function(){throw new Error(ni)})},ri.prototype.using=ri.prototype.set,ri.prototype.saveAs=ri.prototype.save,ri.prototype.export=ri.prototype.output,ri.prototype.run=ri.prototype.then,E.getPageSize=function(ni,si,ai){if(_typeof(ni)==="object"){var oi=ni;ni=oi.orientation,si=oi.unit||si,ai=oi.format||ai}si=si||"mm",ai=ai||"a4",ni=(""+(ni||"P")).toLowerCase();var li,ci=(""+ai).toLowerCase(),ui={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(si){case"pt":li=1;break;case"mm":li=72/25.4;break;case"cm":li=72/2.54;break;case"in":li=72;break;case"px":li=.75;break;case"pc":case"em":li=12;break;case"ex":li=6;break;default:throw"Invalid unit: "+si}var di,fi=0,hi=0;if(ui.hasOwnProperty(ci))fi=ui[ci][1]/li,hi=ui[ci][0]/li;else try{fi=ai[1],hi=ai[0]}catch{throw new Error("Invalid format: "+ai)}if(ni==="p"||ni==="portrait")ni="p",hi>fi&&(di=hi,hi=fi,fi=di);else{if(ni!=="l"&&ni!=="landscape")throw"Invalid orientation: "+ni;ni="l",fi>hi&&(di=hi,hi=fi,fi=di)}return{width:hi,height:fi,unit:si,k:li,orientation:ni}},_t.html=function(ni,si){(si=si||{}).callback=si.callback||function(){},si.html2canvas=si.html2canvas||{},si.html2canvas.canvas=si.html2canvas.canvas||this.canvas,si.jsPDF=si.jsPDF||this,si.fontFaces=si.fontFaces?si.fontFaces.map(Ot):null;var ai=new ri(si);return si.worker?ai:ai.from(ni).doCallback()}})(E.API),E.API.addJS=function(_t){var e,n,ei=_t;return this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(e+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),n=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+ei+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){e!==void 0&&n!==void 0&&this.internal.out("/Names <</JavaScript "+e+" 0 R>>")}),this},(function(_t){var e;_t.events.push(["postPutResources",function(){var n=this,ei=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var ti=n.outline.render().split(/\r\n/),ii=0;ii<ti.length;ii++){var ri=ti[ii],ni=ei.exec(ri);if(ni!=null){var si=ni[1];n.internal.newObjectDeferredBegin(si,!1)}n.internal.write(ri)}if(this.outline.createNamedDestinations){var ai=this.internal.pages.length,oi=[];for(ii=0;ii<ai;ii++){var li=n.internal.newObject();oi.push(li);var ci=n.internal.getPageInfo(ii+1);n.internal.write("<< /D["+ci.objId+" 0 R /XYZ null null null]>> endobj")}var ui=n.internal.newObject();for(n.internal.write("<< /Names [ "),ii=0;ii<oi.length;ii++)n.internal.write("(page_"+(ii+1)+")"+oi[ii]+" 0 R");n.internal.write(" ] >>","endobj"),e=n.internal.newObject(),n.internal.write("<< /Dests "+ui+" 0 R"),n.internal.write(">>","endobj")}}]),_t.events.push(["putCatalog",function(){var n=this;n.outline.root.children.length>0&&(n.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&n.internal.write("/Names "+e+" 0 R"))}]),_t.events.push(["initialized",function(){var n=this;n.outline={createNamedDestinations:!1,root:{children:[]}},n.outline.add=function(ei,ti,ii){var ri={title:ti,options:ii,children:[]};return ei==null&&(ei=this.root),ei.children.push(ri),ri},n.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=n,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},n.outline.genIds_r=function(ei){ei.id=n.internal.newObjectDeferred();for(var ti=0;ti<ei.children.length;ti++)this.genIds_r(ei.children[ti])},n.outline.renderRoot=function(ei){this.objStart(ei),this.line("/Type /Outlines"),ei.children.length>0&&(this.line("/First "+this.makeRef(ei.children[0])),this.line("/Last "+this.makeRef(ei.children[ei.children.length-1]))),this.line("/Count "+this.count_r({count:0},ei)),this.objEnd()},n.outline.renderItems=function(ei){for(var ti=this.ctx.pdf.internal.getVerticalCoordinateString,ii=0;ii<ei.children.length;ii++){var ri=ei.children[ii];this.objStart(ri),this.line("/Title "+this.makeString(ri.title)),this.line("/Parent "+this.makeRef(ei)),ii>0&&this.line("/Prev "+this.makeRef(ei.children[ii-1])),ii<ei.children.length-1&&this.line("/Next "+this.makeRef(ei.children[ii+1])),ri.children.length>0&&(this.line("/First "+this.makeRef(ri.children[0])),this.line("/Last "+this.makeRef(ri.children[ri.children.length-1])));var ni=this.count=this.count_r({count:0},ri);if(ni>0&&this.line("/Count "+ni),ri.options&&ri.options.pageNumber){var si=n.internal.getPageInfo(ri.options.pageNumber);this.line("/Dest ["+si.objId+" 0 R /XYZ 0 "+ti(0)+" 0]")}this.objEnd()}for(var ai=0;ai<ei.children.length;ai++)this.renderItems(ei.children[ai])},n.outline.line=function(ei){this.ctx.val+=ei+`\r
`},n.outline.makeRef=function(ei){return ei.id+" 0 R"},n.outline.makeString=function(ei){return"("+n.internal.pdfEscape(ei)+")"},n.outline.objStart=function(ei){this.ctx.val+=`\r
`+ei.id+` 0 obj\r
<<\r
`},n.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},n.outline.count_r=function(ei,ti){for(var ii=0;ii<ti.children.length;ii++)ei.count++,this.count_r(ei,ti.children[ii]);return ei.count}}])})(E.API),(function(_t){var e=[192,193,194,195,196,197,198,199];_t.processJPEG=function(n,ei,ti,ii,ri,ni){var si,ai=this.decode.DCT_DECODE,oi=null;if(typeof n=="string"||this.__addimage__.isArrayBuffer(n)||this.__addimage__.isArrayBufferView(n)){switch(n=ri||n,n=this.__addimage__.isArrayBuffer(n)?new Uint8Array(n):n,si=(function(li){for(var ci,ui=256*li.charCodeAt(4)+li.charCodeAt(5),di=li.length,fi={width:0,height:0,numcomponents:1},hi=4;hi<di;hi+=2){if(hi+=ui,e.indexOf(li.charCodeAt(hi+1))!==-1){ci=256*li.charCodeAt(hi+5)+li.charCodeAt(hi+6),fi={width:256*li.charCodeAt(hi+7)+li.charCodeAt(hi+8),height:ci,numcomponents:li.charCodeAt(hi+9)};break}ui=256*li.charCodeAt(hi+2)+li.charCodeAt(hi+3)}return fi})(n=this.__addimage__.isArrayBufferView(n)?this.__addimage__.arrayBufferToBinaryString(n):n),si.numcomponents){case 1:ni=this.color_spaces.DEVICE_GRAY;break;case 4:ni=this.color_spaces.DEVICE_CMYK;break;case 3:ni=this.color_spaces.DEVICE_RGB}oi={data:n,width:si.width,height:si.height,colorSpace:ni,bitsPerComponent:8,filter:ai,index:ei,alias:ti}}return oi}})(E.API),E.API.processPNG=function(_t,e,n,ei){if(this.__addimage__.isArrayBuffer(_t)&&(_t=new Uint8Array(_t)),this.__addimage__.isArrayBufferView(_t)){var ti,ii=decodePng(_t,{checkCrc:!0}),ri=ii.width,ni=ii.height,si=ii.channels,ai=ii.palette,oi=ii.depth;ti=ai&&si===1?(function(Si){for(var wi=Si.width,Oi=Si.height,Ii=Si.data,Li=Si.palette,Di=Si.depth,Ni=!1,$i=[],Ki=[],er=void 0,Vi=!1,nr=0,zi=0;zi<Li.length;zi++){var Wi=_slicedToArray(Li[zi],4),Ti=Wi[0],ki=Wi[1],xi=Wi[2],Mi=Wi[3];$i.push(Ti,ki,xi),Mi!=null&&(Mi===0?(nr++,Ki.length<1&&Ki.push(zi)):Mi<255&&(Vi=!0))}if(Vi||nr>1){Ni=!0,Ki=void 0;var Ui=wi*Oi;er=new Uint8Array(Ui);for(var Yi=new DataView(Ii.buffer),sr=0;sr<Ui;sr++){var cr=ee(Yi,sr,Di),ir=_slicedToArray(Li[cr],4)[3];er[sr]=ir}}else nr===0&&(Ki=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:Ni?8:void 0,colorBytes:Ii,alphaBytes:er,needSMask:Ni,palette:$i,mask:Ki}})(ii):si===2||si===4?(function(Si){for(var wi=Si.data,Oi=Si.width,Ii=Si.height,Li=Si.channels,Di=Si.depth,Ni=Li===2?"DeviceGray":"DeviceRGB",$i=Li-1,Ki=Oi*Ii,er=$i,Vi=Ki*er,nr=1*Ki,zi=Math.ceil(Vi*Di/8),Wi=Math.ceil(nr*Di/8),Ti=new Uint8Array(zi),ki=new Uint8Array(Wi),xi=new DataView(wi.buffer),Mi=new DataView(Ti.buffer),Ui=new DataView(ki.buffer),Yi=!1,sr=0;sr<Ki;sr++){for(var cr=sr*Li,ir=0;ir<er;ir++)re(Mi,ee(xi,cr+ir,Di),sr*er+ir,Di);var Zi=ee(xi,cr+er,Di);Zi<(1<<Di)-1&&(Yi=!0),re(Ui,Zi,1*sr,Di)}return{colorSpace:Ni,colorsPerPixel:$i,sMaskBitsPerComponent:Yi?Di:void 0,colorBytes:Ti,alphaBytes:ki,needSMask:Yi}})(ii):(function(Si){var wi=Si.data,Oi=Si.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:Oi,colorsPerPixel:Oi==="DeviceGray"?1:3,colorBytes:wi instanceof Uint16Array?(function(Ii){for(var Li=Ii.length,Di=new Uint8Array(2*Li),Ni=new DataView(Di.buffer,Di.byteOffset,Di.byteLength),$i=0;$i<Li;$i++)Ni.setUint16(2*$i,Ii[$i],!1);return Di})(wi):wi,needSMask:!1}})(ii);var li,ci,ui,di=ti,fi=di.colorSpace,hi=di.colorsPerPixel,pi=di.sMaskBitsPerComponent,gi=di.colorBytes,vi=di.alphaBytes,yi=di.needSMask,_i=di.palette,Ai=di.mask,Ei=null;return ei!==E.API.image_compression.NONE&&typeof zlibSync=="function"?(Ei=(function(Si){var wi;switch(Si){case E.API.image_compression.FAST:wi=11;break;case E.API.image_compression.MEDIUM:wi=13;break;case E.API.image_compression.SLOW:wi=14;break;default:wi=12}return wi})(ei),li=this.decode.FLATE_DECODE,ci="/Predictor ".concat(Ei," /Colors ").concat(hi," /BitsPerComponent ").concat(oi," /Columns ").concat(ri),_t=Yt(gi,Math.ceil(ri*hi*oi/8),hi,oi,ei),yi&&(ui=Yt(vi,Math.ceil(ri*pi/8),1,pi,ei))):(li=void 0,ci=void 0,_t=gi,yi&&(ui=vi)),(this.__addimage__.isArrayBuffer(_t)||this.__addimage__.isArrayBufferView(_t))&&(_t=this.__addimage__.arrayBufferToBinaryString(_t)),(ui&&this.__addimage__.isArrayBuffer(ui)||this.__addimage__.isArrayBufferView(ui))&&(ui=this.__addimage__.arrayBufferToBinaryString(ui)),{alias:n,data:_t,index:e,filter:li,decodeParameters:ci,transparency:Ai,palette:_i,sMask:ui,predictor:Ei,width:ri,height:ni,bitsPerComponent:oi,sMaskBitsPerComponent:pi,colorSpace:fi}}},(function(_t){_t.processGIF89A=function(e,n,ei,ti){var ii=new ie(e),ri=ii.width,ni=ii.height,si=[];ii.decodeAndBlitFrameRGBA(0,si);var ai={data:si,width:ri,height:ni},oi=new oe(100).encode(ai,100);return _t.processJPEG.call(this,oi,n,ei,ti)},_t.processGIF87A=_t.processGIF89A})(E.API),se.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var _t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(_t);for(var e=0;e<_t;e++){var n=this.datav.getUint8(this.pos++,!0),ei=this.datav.getUint8(this.pos++,!0),ti=this.datav.getUint8(this.pos++,!0),ii=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:ti,green:ei,blue:n,quad:ii}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},se.prototype.parseBGR=function(){this.pos=this.offset;var _t="bit"+this.bitPP,e=this.width*this.height*4;if(e>536870912)throw new Error("Image dimensions exceed 512MB, which is too large.");this.data=new Uint8Array(e);try{this[_t]()}catch(n){o.log("bit decode error:"+n)}},se.prototype.bit1=function(){var _t,e=Math.ceil(this.width/8),n=e%4;for(_t=this.height-1;_t>=0;_t--){for(var ei=this.bottom_up?_t:this.height-1-_t,ti=0;ti<e;ti++)for(var ii=this.datav.getUint8(this.pos++,!0),ri=ei*this.width*4+8*ti*4,ni=0;ni<8&&8*ti+ni<this.width;ni++){var si=this.palette[ii>>7-ni&1];this.data[ri+4*ni]=si.blue,this.data[ri+4*ni+1]=si.green,this.data[ri+4*ni+2]=si.red,this.data[ri+4*ni+3]=255}n!==0&&(this.pos+=4-n)}},se.prototype.bit4=function(){for(var _t=Math.ceil(this.width/2),e=_t%4,n=this.height-1;n>=0;n--){for(var ei=this.bottom_up?n:this.height-1-n,ti=0;ti<_t;ti++){var ii=this.datav.getUint8(this.pos++,!0),ri=ei*this.width*4+2*ti*4,ni=ii>>4,si=15&ii,ai=this.palette[ni];if(this.data[ri]=ai.blue,this.data[ri+1]=ai.green,this.data[ri+2]=ai.red,this.data[ri+3]=255,2*ti+1>=this.width)break;ai=this.palette[si],this.data[ri+4]=ai.blue,this.data[ri+4+1]=ai.green,this.data[ri+4+2]=ai.red,this.data[ri+4+3]=255}e!==0&&(this.pos+=4-e)}},se.prototype.bit8=function(){for(var _t=this.width%4,e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,ei=0;ei<this.width;ei++){var ti=this.datav.getUint8(this.pos++,!0),ii=n*this.width*4+4*ei;if(ti<this.palette.length){var ri=this.palette[ti];this.data[ii]=ri.red,this.data[ii+1]=ri.green,this.data[ii+2]=ri.blue,this.data[ii+3]=255}else this.data[ii]=255,this.data[ii+1]=255,this.data[ii+2]=255,this.data[ii+3]=255}_t!==0&&(this.pos+=4-_t)}},se.prototype.bit15=function(){for(var _t=this.width%3,e=parseInt("11111",2),n=this.height-1;n>=0;n--){for(var ei=this.bottom_up?n:this.height-1-n,ti=0;ti<this.width;ti++){var ii=this.datav.getUint16(this.pos,!0);this.pos+=2;var ri=(ii&e)/e*255|0,ni=(ii>>5&e)/e*255|0,si=(ii>>10&e)/e*255|0,ai=ii>>15?255:0,oi=ei*this.width*4+4*ti;this.data[oi]=si,this.data[oi+1]=ni,this.data[oi+2]=ri,this.data[oi+3]=ai}this.pos+=_t}},se.prototype.bit16=function(){for(var _t=this.width%3,e=parseInt("11111",2),n=parseInt("111111",2),ei=this.height-1;ei>=0;ei--){for(var ti=this.bottom_up?ei:this.height-1-ei,ii=0;ii<this.width;ii++){var ri=this.datav.getUint16(this.pos,!0);this.pos+=2;var ni=(ri&e)/e*255|0,si=(ri>>5&n)/n*255|0,ai=(ri>>11)/e*255|0,oi=ti*this.width*4+4*ii;this.data[oi]=ai,this.data[oi+1]=si,this.data[oi+2]=ni,this.data[oi+3]=255}this.pos+=_t}},se.prototype.bit24=function(){for(var _t=this.height-1;_t>=0;_t--){for(var e=this.bottom_up?_t:this.height-1-_t,n=0;n<this.width;n++){var ei=this.datav.getUint8(this.pos++,!0),ti=this.datav.getUint8(this.pos++,!0),ii=this.datav.getUint8(this.pos++,!0),ri=e*this.width*4+4*n;this.data[ri]=ii,this.data[ri+1]=ti,this.data[ri+2]=ei,this.data[ri+3]=255}this.pos+=this.width%4}},se.prototype.bit32=function(){for(var _t=this.height-1;_t>=0;_t--)for(var e=this.bottom_up?_t:this.height-1-_t,n=0;n<this.width;n++){var ei=this.datav.getUint8(this.pos++,!0),ti=this.datav.getUint8(this.pos++,!0),ii=this.datav.getUint8(this.pos++,!0),ri=this.datav.getUint8(this.pos++,!0),ni=e*this.width*4+4*n;this.data[ni]=ii,this.data[ni+1]=ti,this.data[ni+2]=ei,this.data[ni+3]=ri}},se.prototype.getData=function(){return this.data},(function(_t){_t.processBMP=function(e,n,ei,ti){var ii=new se(e,!1),ri=ii.width,ni=ii.height,si={data:ii.getData(),width:ri,height:ni},ai=new oe(100).encode(si,100);return _t.processJPEG.call(this,ai,n,ei,ti)}})(E.API),ue.prototype.getData=function(){return this.data},(function(_t){_t.processWEBP=function(e,n,ei,ti){var ii=new ue(e),ri=ii.width,ni=ii.height,si={data:ii.getData(),width:ri,height:ni},ai=new oe(100).encode(si,100);return _t.processJPEG.call(this,ai,n,ei,ti)}})(E.API),E.API.processRGBA=function(_t,e,n){for(var ei=_t.data,ti=ei.length,ii=new Uint8Array(ti/4*3),ri=new Uint8Array(ti/4),ni=0,si=0,ai=0;ai<ti;ai+=4){var oi=ei[ai],li=ei[ai+1],ci=ei[ai+2],ui=ei[ai+3];ii[ni++]=oi,ii[ni++]=li,ii[ni++]=ci,ri[si++]=ui}var di=this.__addimage__.arrayBufferToBinaryString(ii);return{alpha:this.__addimage__.arrayBufferToBinaryString(ri),data:di,index:e,alias:n,colorSpace:"DeviceRGB",bitsPerComponent:8,width:_t.width,height:_t.height}},E.API.setLanguage=function(_t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[_t]!==void 0&&(this.internal.languageSettings.languageCode=_t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},zt=E.API,Ut=zt.getCharWidthsArray=function(_t,e){var n,ei,ti=(e=e||{}).font||this.internal.getFont(),ii=e.fontSize||this.internal.getFontSize(),ri=e.charSpace||this.internal.getCharSpace(),ni=e.widths?e.widths:ti.metadata.Unicode.widths,si=ni.fof?ni.fof:1,ai=e.kerning?e.kerning:ti.metadata.Unicode.kerning,oi=ai.fof?ai.fof:1,li=e.doKerning!==!1,ci=0,ui=_t.length,di=0,fi=ni[0]||si,hi=[];for(n=0;n<ui;n++)ei=_t.charCodeAt(n),typeof ti.metadata.widthOfString=="function"?hi.push((ti.metadata.widthOfGlyph(ti.metadata.characterToGlyph(ei))+ri*(1e3/ii)||0)/1e3):(ci=li&&_typeof(ai[ei])==="object"&&!isNaN(parseInt(ai[ei][di],10))?ai[ei][di]/oi:0,hi.push((ni[ei]||fi)/si+ci)),di=ei;return hi},Ht=zt.getStringUnitWidth=function(_t,e){var n=(e=e||{}).fontSize||this.internal.getFontSize(),ei=e.font||this.internal.getFont(),ti=e.charSpace||this.internal.getCharSpace();return zt.processArabic&&(_t=zt.processArabic(_t)),typeof ei.metadata.widthOfString=="function"?ei.metadata.widthOfString(_t,n,ti)/n:Ut.apply(this,arguments).reduce(function(ii,ri){return ii+ri},0)},Wt=function(_t,e,n,ei){for(var ti=[],ii=0,ri=_t.length,ni=0;ii!==ri&&ni+e[ii]<n;)ni+=e[ii],ii++;ti.push(_t.slice(0,ii));var si=ii;for(ni=0;ii!==ri;)ni+e[ii]>ei&&(ti.push(_t.slice(si,ii)),ni=0,si=ii),ni+=e[ii],ii++;return si!==ii&&ti.push(_t.slice(si,ii)),ti},Vt=function(_t,e,n){n||(n={});var ei,ti,ii,ri,ni,si,ai,oi=[],li=[oi],ci=n.textIndent||0,ui=0,di=0,fi=_t.split(" "),hi=Ut.apply(this,[" ",n])[0];if(si=n.lineIndent===-1?fi[0].length+2:n.lineIndent||0){var pi=Array(si).join(" "),gi=[];fi.map(function(yi){(yi=yi.split(/\s*\n/)).length>1?gi=gi.concat(yi.map(function(_i,Ai){return(Ai&&_i.length?`
`:"")+_i})):gi.push(yi[0])}),fi=gi,si=Ht.apply(this,[pi,n])}for(ii=0,ri=fi.length;ii<ri;ii++){var vi=0;if(ei=fi[ii],si&&ei[0]==`
`&&(ei=ei.substr(1),vi=1),ci+ui+(di=(ti=Ut.apply(this,[ei,n])).reduce(function(yi,_i){return yi+_i},0))>e||vi){if(di>e){for(ni=Wt.apply(this,[ei,ti,e-(ci+ui),e]),oi.push(ni.shift()),oi=[ni.pop()];ni.length;)li.push([ni.shift()]);di=ti.slice(ei.length-(oi[0]?oi[0].length:0)).reduce(function(yi,_i){return yi+_i},0)}else oi=[ei];li.push(oi),ci=di+si,ui=hi}else oi.push(ei),ci+=ui+di,ui=hi}return ai=si?function(yi,_i){return(_i?pi:"")+yi.join(" ")}:function(yi){return yi.join(" ")},li.map(ai)},zt.splitTextToSize=function(_t,e,n){var ei,ti=(n=n||{}).fontSize||this.internal.getFontSize(),ii=(function(oi){if(oi.widths&&oi.kerning)return{widths:oi.widths,kerning:oi.kerning};var li=this.internal.getFont(oi.fontName,oi.fontStyle),ci="Unicode";return li.metadata[ci]?{widths:li.metadata[ci].widths||{0:1},kerning:li.metadata[ci].kerning||{}}:{font:li.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,n);ei=Array.isArray(_t)?_t:String(_t).split(/\r?\n/);var ri=1*this.internal.scaleFactor*e/ti;ii.textIndent=n.textIndent?1*n.textIndent*this.internal.scaleFactor/ti:0,ii.lineIndent=n.lineIndent;var ni,si,ai=[];for(ni=0,si=ei.length;ni<si;ni++)ai=ai.concat(Vt.apply(this,[ei[ni],ri,ii]));return ai},(function(_t){_t.__fontmetrics__=_t.__fontmetrics__||{};for(var e="0123456789abcdef",n="klmnopqrstuvwxyz",ei={},ti={},ii=0;ii<16;ii++)ei[n[ii]]=e[ii],ti[e[ii]]=n[ii];var ri=function(ci){return"0x"+parseInt(ci,10).toString(16)},ni=_t.__fontmetrics__.compress=function(ci){var ui,di,fi,hi,pi=["{"];for(var gi in ci){if(ui=ci[gi],isNaN(parseInt(gi,10))?di="'"+gi+"'":(gi=parseInt(gi,10),di=(di=ri(gi).slice(2)).slice(0,-1)+ti[di.slice(-1)]),typeof ui=="number")ui<0?(fi=ri(ui).slice(3),hi="-"):(fi=ri(ui).slice(2),hi=""),fi=hi+fi.slice(0,-1)+ti[fi.slice(-1)];else{if(_typeof(ui)!=="object")throw new Error("Don't know what to do with value type "+_typeof(ui)+".");fi=ni(ui)}pi.push(di+fi)}return pi.push("}"),pi.join("")},si=_t.__fontmetrics__.uncompress=function(ci){if(typeof ci!="string")throw new Error("Invalid argument passed to uncompress.");for(var ui,di,fi,hi,pi={},gi=1,vi=pi,yi=[],_i="",Ai="",Ei=ci.length-1,Si=1;Si<Ei;Si+=1)(hi=ci[Si])=="'"?ui?(fi=ui.join(""),ui=void 0):ui=[]:ui?ui.push(hi):hi=="{"?(yi.push([vi,fi]),vi={},fi=void 0):hi=="}"?((di=yi.pop())[0][di[1]]=vi,fi=void 0,vi=di[0]):hi=="-"?gi=-1:fi===void 0?ei.hasOwnProperty(hi)?(_i+=ei[hi],fi=parseInt(_i,16)*gi,gi=1,_i=""):_i+=hi:ei.hasOwnProperty(hi)?(Ai+=ei[hi],vi[fi]=parseInt(Ai,16)*gi,gi=1,fi=void 0,Ai=""):Ai+=hi;return pi},ai={codePages:["WinAnsiEncoding"],WinAnsiEncoding:si("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},oi={Unicode:{Courier:ai,"Courier-Bold":ai,"Courier-BoldOblique":ai,"Courier-Oblique":ai,Helvetica:ai,"Helvetica-Bold":ai,"Helvetica-BoldOblique":ai,"Helvetica-Oblique":ai,"Times-Roman":ai,"Times-Bold":ai,"Times-BoldItalic":ai,"Times-Italic":ai}},li={Unicode:{"Courier-Oblique":si("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":si("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":si("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:si("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":si("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":si("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:si("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:si("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":si("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:si("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":si("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":si("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":si("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":si("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};_t.events.push(["addFont",function(ci){var ui=ci.font,di=li.Unicode[ui.postScriptName];di&&(ui.metadata.Unicode={},ui.metadata.Unicode.widths=di.widths,ui.metadata.Unicode.kerning=di.kerning);var fi=oi.Unicode[ui.postScriptName];fi&&(ui.metadata.Unicode.encoding=fi,ui.encoding=fi.codePages[0])}])})(E.API),(function(_t){var e=function(n){for(var ei=n.length,ti=new Uint8Array(ei),ii=0;ii<ei;ii++)ti[ii]=n.charCodeAt(ii);return ti};_t.API.events.push(["addFont",function(n){var ei=void 0,ti=n.font,ii=n.instance;if(!ti.isStandardFont){if(ii===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+ti.postScriptName+"').");if(typeof(ei=ii.existsFileInVFS(ti.postScriptName)===!1?ii.loadFile(ti.postScriptName):ii.getFileFromVFS(ti.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+ti.postScriptName+"').");(function(ri,ni){ni=/^\x00\x01\x00\x00/.test(ni)?e(ni):e(f(ni)),ri.metadata=_t.API.TTFFont.open(ni),ri.metadata.Unicode=ri.metadata.Unicode||{encoding:{},kerning:{},widths:[]},ri.metadata.glyIdsUsed=[0]})(ti,ei)}}])})(E),E.API.addSvgAsImage=function(_t,e,n,ei,ti,ii,ri,ni){if(isNaN(e)||isNaN(n))throw o.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(ei)||isNaN(ti))throw o.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var si=document.createElement("canvas");si.width=ei,si.height=ti;var ai=si.getContext("2d");ai.fillStyle="#fff",ai.fillRect(0,0,si.width,si.height);var oi={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},li=this;return(i.canvg?Promise.resolve(i.canvg):__vitePreload(()=>import("./index.es-VlFfCSRe.js"),__vite__mapDeps([0,1,2]))).catch(function(ci){return Promise.reject(new Error("Could not load canvg: "+ci))}).then(function(ci){return ci.default?ci.default:ci}).then(function(ci){return ci.fromString(ai,_t,oi)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(ci){return ci.render(oi)}).then(function(){li.addImage(si.toDataURL("image/jpeg",1),e,n,ei,ti,ri,ni)})},E.API.putTotalPages=function(_t){var e,n=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(_t,"g"),n=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(_t,this.internal.getFont()),"g"),n=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var ei=1;ei<=this.internal.getNumberOfPages();ei++)for(var ti=0;ti<this.internal.pages[ei].length;ti++)this.internal.pages[ei][ti]=this.internal.pages[ei][ti].replace(e,n);return this},E.API.viewerPreferences=function(_t,e){var n;_t=_t||{},e=e||!1;var ei,ti,ii,ri={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},ni=Object.keys(ri),si=[],ai=0,oi=0,li=0;function ci(di,fi){var hi,pi=!1;for(hi=0;hi<di.length;hi+=1)di[hi]===fi&&(pi=!0);return pi}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(ri)),this.internal.viewerpreferences.isSubscribed=!1),n=this.internal.viewerpreferences.configuration,_t==="reset"||e===!0){var ui=ni.length;for(li=0;li<ui;li+=1)n[ni[li]].value=n[ni[li]].defaultValue,n[ni[li]].explicitSet=!1}if(_typeof(_t)==="object"){for(ti in _t)if(ii=_t[ti],ci(ni,ti)&&ii!==void 0){if(n[ti].type==="boolean"&&typeof ii=="boolean")n[ti].value=ii;else if(n[ti].type==="name"&&ci(n[ti].valueSet,ii))n[ti].value=ii;else if(n[ti].type==="integer"&&Number.isInteger(ii))n[ti].value=ii;else if(n[ti].type==="array"){for(ai=0;ai<ii.length;ai+=1)if(ei=!0,ii[ai].length===1&&typeof ii[ai][0]=="number")si.push(String(ii[ai]-1));else if(ii[ai].length>1){for(oi=0;oi<ii[ai].length;oi+=1)typeof ii[ai][oi]!="number"&&(ei=!1);ei===!0&&si.push([ii[ai][0]-1,ii[ai][1]-1].join(" "))}n[ti].value="["+si.join(" ")+"]"}else n[ti].value=n[ti].defaultValue;n[ti].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var di,fi=[];for(di in n)n[di].explicitSet===!0&&(n[di].type==="name"?fi.push("/"+di+" /"+n[di].value):fi.push("/"+di+" "+n[di].value));fi.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+fi.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=n,this},E.API.addMetadata=function(_t,e){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:_t,namespaceUri:e??"http://jspdf.default.namespaceuri/",rawXml:typeof e=="boolean"&&e},this.internal.events.subscribe("putCatalog",le),this.internal.events.subscribe("postPutResources",ce)),this},(function(_t){var e=_t.API,n=e.pdfEscape16=function(ii,ri){for(var ni,si=ri.metadata.Unicode.widths,ai=["","0","00","000","0000"],oi=[""],li=0,ci=ii.length;li<ci;++li){if(ni=ri.metadata.characterToGlyph(ii.charCodeAt(li)),ri.metadata.glyIdsUsed.push(ni),ri.metadata.toUnicode[ni]=ii.charCodeAt(li),si.indexOf(ni)==-1&&(si.push(ni),si.push([parseInt(ri.metadata.widthOfGlyph(ni),10)])),ni=="0")return oi.join("");ni=ni.toString(16),oi.push(ai[4-ni.length],ni)}return oi.join("")},ei=function(ii){var ri,ni,si,ai,oi,li,ci;for(oi=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,si=[],li=0,ci=(ni=Object.keys(ii).sort(function(ui,di){return ui-di})).length;li<ci;li++)ri=ni[li],si.length>=100&&(oi+=`
`+si.length+` beginbfchar
`+si.join(`
`)+`
endbfchar`,si=[]),ii[ri]!==void 0&&ii[ri]!==null&&typeof ii[ri].toString=="function"&&(ai=("0000"+ii[ri].toString(16)).slice(-4),ri=("0000"+(+ri).toString(16)).slice(-4),si.push("<"+ri+"><"+ai+">"));return si.length&&(oi+=`
`+si.length+` beginbfchar
`+si.join(`
`)+`
endbfchar
`),oi+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(ii){(function(ri){var ni=ri.font,si=ri.out,ai=ri.newObject,oi=ri.putStream;if(ni.metadata instanceof _t.API.TTFFont&&ni.encoding==="Identity-H"){for(var li=ni.metadata.Unicode.widths,ci=ni.metadata.subset.encode(ni.metadata.glyIdsUsed,1),ui="",di=0;di<ci.length;di++)ui+=String.fromCharCode(ci[di]);var fi=ai();oi({data:ui,addLength1:!0,objectId:fi}),si("endobj");var hi=ai();oi({data:ei(ni.metadata.toUnicode),addLength1:!0,objectId:hi}),si("endobj");var pi=ai();si("<<"),si("/Type /FontDescriptor"),si("/FontName /"+j(ni.fontName)),si("/FontFile2 "+fi+" 0 R"),si("/FontBBox "+_t.API.PDFObject.convert(ni.metadata.bbox)),si("/Flags "+ni.metadata.flags),si("/StemV "+ni.metadata.stemV),si("/ItalicAngle "+ni.metadata.italicAngle),si("/Ascent "+ni.metadata.ascender),si("/Descent "+ni.metadata.decender),si("/CapHeight "+ni.metadata.capHeight),si(">>"),si("endobj");var gi=ai();si("<<"),si("/Type /Font"),si("/BaseFont /"+j(ni.fontName)),si("/FontDescriptor "+pi+" 0 R"),si("/W "+_t.API.PDFObject.convert(li)),si("/CIDToGIDMap /Identity"),si("/DW 1000"),si("/Subtype /CIDFontType2"),si("/CIDSystemInfo"),si("<<"),si("/Supplement 0"),si("/Registry (Adobe)"),si("/Ordering ("+ni.encoding+")"),si(">>"),si(">>"),si("endobj"),ni.objectNumber=ai(),si("<<"),si("/Type /Font"),si("/Subtype /Type0"),si("/ToUnicode "+hi+" 0 R"),si("/BaseFont /"+j(ni.fontName)),si("/Encoding /"+ni.encoding),si("/DescendantFonts ["+gi+" 0 R]"),si(">>"),si("endobj"),ni.isAlreadyPutted=!0}})(ii)}]),e.events.push(["putFont",function(ii){(function(ri){var ni=ri.font,si=ri.out,ai=ri.newObject,oi=ri.putStream;if(ni.metadata instanceof _t.API.TTFFont&&ni.encoding==="WinAnsiEncoding"){for(var li=ni.metadata.rawData,ci="",ui=0;ui<li.length;ui++)ci+=String.fromCharCode(li[ui]);var di=ai();oi({data:ci,addLength1:!0,objectId:di}),si("endobj");var fi=ai();oi({data:ei(ni.metadata.toUnicode),addLength1:!0,objectId:fi}),si("endobj");var hi=ai();si("<<"),si("/Descent "+ni.metadata.decender),si("/CapHeight "+ni.metadata.capHeight),si("/StemV "+ni.metadata.stemV),si("/Type /FontDescriptor"),si("/FontFile2 "+di+" 0 R"),si("/Flags 96"),si("/FontBBox "+_t.API.PDFObject.convert(ni.metadata.bbox)),si("/FontName /"+j(ni.fontName)),si("/ItalicAngle "+ni.metadata.italicAngle),si("/Ascent "+ni.metadata.ascender),si(">>"),si("endobj"),ni.objectNumber=ai();for(var pi=0;pi<ni.metadata.hmtx.widths.length;pi++)ni.metadata.hmtx.widths[pi]=parseInt(ni.metadata.hmtx.widths[pi]*(1e3/ni.metadata.head.unitsPerEm));si("<</Subtype/TrueType/Type/Font/ToUnicode "+fi+" 0 R/BaseFont/"+j(ni.fontName)+"/FontDescriptor "+hi+" 0 R/Encoding/"+ni.encoding+" /FirstChar 29 /LastChar 255 /Widths "+_t.API.PDFObject.convert(ni.metadata.hmtx.widths)+">>"),si("endobj"),ni.isAlreadyPutted=!0}})(ii)}]);var ti=function(ii){var ri,ni=ii.text||"",si=ii.x,ai=ii.y,oi=ii.options||{},li=ii.mutex||{},ci=li.pdfEscape,ui=li.activeFontKey,di=li.fonts,fi=ui,hi="",pi=0,gi="",vi=di[fi].encoding;if(di[fi].encoding!=="Identity-H")return{text:ni,x:si,y:ai,options:oi,mutex:li};for(gi=ni,fi=ui,Array.isArray(ni)&&(gi=ni[0]),pi=0;pi<gi.length;pi+=1)di[fi].metadata.hasOwnProperty("cmap")&&(ri=di[fi].metadata.cmap.unicode.codeMap[gi[pi].charCodeAt(0)]),ri||gi[pi].charCodeAt(0)<256&&di[fi].metadata.hasOwnProperty("Unicode")?hi+=gi[pi]:hi+="";var yi="";return parseInt(fi.slice(1))<14||vi==="WinAnsiEncoding"?yi=ci(hi,fi).split("").map(function(_i){return _i.charCodeAt(0).toString(16)}).join(""):vi==="Identity-H"&&(yi=n(hi,di[fi])),li.isHex=!0,{text:yi,x:si,y:ai,options:oi,mutex:li}};e.events.push(["postProcessText",function(ii){var ri=ii.text||"",ni=[],si={text:ri,x:ii.x,y:ii.y,options:ii.options,mutex:ii.mutex};if(Array.isArray(ri)){var ai=0;for(ai=0;ai<ri.length;ai+=1)Array.isArray(ri[ai])&&ri[ai].length===3?ni.push([ti(Object.assign({},si,{text:ri[ai][0]})).text,ri[ai][1],ri[ai][2]]):ni.push(ti(Object.assign({},si,{text:ri[ai]})).text);ii.text=ni}else ii.text=ti(Object.assign({},si,{text:ri})).text}])})(E),(function(_t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};_t.existsFileInVFS=function(n){return e.call(this),this.internal.vFS[n]!==void 0},_t.addFileToVFS=function(n,ei){return e.call(this),this.internal.vFS[n]=ei,this},_t.getFileFromVFS=function(n){return e.call(this),this.internal.vFS[n]!==void 0?this.internal.vFS[n]:null}})(E.API),(function(_t){_t.__bidiEngine__=_t.prototype.__bidiEngine__=function(ei){var ti,ii,ri,ni,si,ai,oi,li=e,ci=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],ui=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],di={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},fi={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},hi=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],pi=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),gi=!1,vi=0;this.__bidiEngine__={};var yi=function(Ii){var Li=Ii.charCodeAt(),Di=Li>>8,Ni=fi[Di];return Ni!==void 0?li[256*Ni+(255&Li)]:Di===252||Di===253?"AL":pi.test(Di)?"L":Di===8?"R":"N"},_i=function(Ii){for(var Li,Di=0;Di<Ii.length;Di++){if((Li=yi(Ii.charAt(Di)))==="L")return!1;if(Li==="R")return!0}return!1},Ai=function(Ii,Li,Di,Ni){var $i,Ki,er,Vi,nr=Li[Ni];switch(nr){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":gi=!1;break;case"N":case"AN":break;case"EN":gi&&(nr="AN");break;case"AL":gi=!0,nr="R";break;case"WS":case"BN":nr="N";break;case"CS":Ni<1||Ni+1>=Li.length||($i=Di[Ni-1])!=="EN"&&$i!=="AN"||(Ki=Li[Ni+1])!=="EN"&&Ki!=="AN"?nr="N":gi&&(Ki="AN"),nr=Ki===$i?Ki:"N";break;case"ES":nr=($i=Ni>0?Di[Ni-1]:"B")==="EN"&&Ni+1<Li.length&&Li[Ni+1]==="EN"?"EN":"N";break;case"ET":if(Ni>0&&Di[Ni-1]==="EN"){nr="EN";break}if(gi){nr="N";break}for(er=Ni+1,Vi=Li.length;er<Vi&&Li[er]==="ET";)er++;nr=er<Vi&&Li[er]==="EN"?"EN":"N";break;case"NSM":if(ri&&!ni){for(Vi=Li.length,er=Ni+1;er<Vi&&Li[er]==="NSM";)er++;if(er<Vi){var zi=Ii[Ni],Wi=zi>=1425&&zi<=2303||zi===64286;if($i=Li[er],Wi&&($i==="R"||$i==="AL")){nr="R";break}}}nr=Ni<1||($i=Li[Ni-1])==="B"?"N":Di[Ni-1];break;case"B":gi=!1,ti=!0,nr=vi;break;case"S":ii=!0,nr="N"}return nr},Ei=function(Ii,Li,Di){var Ni=Ii.split("");return Di&&Si(Ni,Di,{hiLevel:vi}),Ni.reverse(),Li&&Li.reverse(),Ni.join("")},Si=function(Ii,Li,Di){var Ni,$i,Ki,er,Vi,nr=-1,zi=Ii.length,Wi=0,Ti=[],ki=vi?ui:ci,xi=[];for(gi=!1,ti=!1,ii=!1,$i=0;$i<zi;$i++)xi[$i]=yi(Ii[$i]);for(Ki=0;Ki<zi;Ki++){if(Vi=Wi,Ti[Ki]=Ai(Ii,xi,Ti,Ki),Ni=240&(Wi=ki[Vi][di[Ti[Ki]]]),Wi&=15,Li[Ki]=er=ki[Wi][5],Ni>0)if(Ni===16){for($i=nr;$i<Ki;$i++)Li[$i]=1;nr=-1}else nr=-1;if(ki[Wi][6])nr===-1&&(nr=Ki);else if(nr>-1){for($i=nr;$i<Ki;$i++)Li[$i]=er;nr=-1}xi[Ki]==="B"&&(Li[Ki]=0),Di.hiLevel|=er}ii&&(function(Mi,Ui,Yi){for(var sr=0;sr<Yi;sr++)if(Mi[sr]==="S"){Ui[sr]=vi;for(var cr=sr-1;cr>=0&&Mi[cr]==="WS";cr--)Ui[cr]=vi}})(xi,Li,zi)},wi=function(Ii,Li,Di,Ni,$i){if(!($i.hiLevel<Ii)){if(Ii===1&&vi===1&&!ti)return Li.reverse(),void(Di&&Di.reverse());for(var Ki,er,Vi,nr,zi=Li.length,Wi=0;Wi<zi;){if(Ni[Wi]>=Ii){for(Vi=Wi+1;Vi<zi&&Ni[Vi]>=Ii;)Vi++;for(nr=Wi,er=Vi-1;nr<er;nr++,er--)Ki=Li[nr],Li[nr]=Li[er],Li[er]=Ki,Di&&(Ki=Di[nr],Di[nr]=Di[er],Di[er]=Ki);Wi=Vi}Wi++}}},Oi=function(Ii,Li,Di){var Ni=Ii.split(""),$i={hiLevel:vi};return Di||(Di=[]),Si(Ni,Di,$i),(function(Ki,er,Vi){if(Vi.hiLevel!==0&&oi)for(var nr,zi=0;zi<Ki.length;zi++)er[zi]===1&&(nr=hi.indexOf(Ki[zi]))>=0&&(Ki[zi]=hi[nr+1])})(Ni,Di,$i),wi(2,Ni,Li,Di,$i),wi(1,Ni,Li,Di,$i),Ni.join("")};return this.__bidiEngine__.doBidiReorder=function(Ii,Li,Di){if((function($i,Ki){if(Ki)for(var er=0;er<$i.length;er++)Ki[er]=er;ni===void 0&&(ni=_i($i)),ai===void 0&&(ai=_i($i))})(Ii,Li),ri||!si||ai)if(ri&&si&&ni^ai)vi=ni?1:0,Ii=Ei(Ii,Li,Di);else if(!ri&&si&&ai)vi=ni?1:0,Ii=Oi(Ii,Li,Di),Ii=Ei(Ii,Li);else if(!ri||ni||si||ai){if(ri&&!si&&ni^ai)Ii=Ei(Ii,Li),ni?(vi=0,Ii=Oi(Ii,Li,Di)):(vi=1,Ii=Oi(Ii,Li,Di),Ii=Ei(Ii,Li));else if(ri&&ni&&!si&&ai)vi=1,Ii=Oi(Ii,Li,Di),Ii=Ei(Ii,Li);else if(!ri&&!si&&ni^ai){var Ni=oi;ni?(vi=1,Ii=Oi(Ii,Li,Di),vi=0,oi=!1,Ii=Oi(Ii,Li,Di),oi=Ni):(vi=0,Ii=Oi(Ii,Li,Di),Ii=Ei(Ii,Li),vi=1,oi=!1,Ii=Oi(Ii,Li,Di),oi=Ni,Ii=Ei(Ii,Li))}}else vi=0,Ii=Oi(Ii,Li,Di);else vi=ni?1:0,Ii=Oi(Ii,Li,Di);return Ii},this.__bidiEngine__.setOptions=function(Ii){Ii&&(ri=Ii.isInputVisual,si=Ii.isOutputVisual,ni=Ii.isInputRtl,ai=Ii.isOutputRtl,oi=Ii.isSymmetricSwapping)},this.__bidiEngine__.setOptions(ei),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],n=new _t.__bidiEngine__({isInputVisual:!0});_t.API.events.push(["postProcessText",function(ei){var ti=ei.text;ei.x,ei.y;var ii=ei.options||{};ei.mutex,ii.lang;var ri=[];if(ii.isInputVisual=typeof ii.isInputVisual!="boolean"||ii.isInputVisual,n.setOptions(ii),Object.prototype.toString.call(ti)==="[object Array]"){var ni=0;for(ri=[],ni=0;ni<ti.length;ni+=1)Object.prototype.toString.call(ti[ni])==="[object Array]"?ri.push([n.doBidiReorder(ti[ni][0]),ti[ni][1],ti[ni][2]]):ri.push([n.doBidiReorder(ti[ni])]);ei.text=ri}else ei.text=n.doBidiReorder(ti);n.setOptions({isInputVisual:!0})}])})(E),E.API.TTFFont=(function(){function _t(e){var n;if(this.rawData=e,n=this.contents=new fe(e),this.contents.pos=4,n.readString(4)==="ttcf")throw new Error("TTCF not supported.");n.pos=0,this.parse(),this.subset=new je(this),this.registerTTF()}return _t.open=function(e){return new _t(e)},_t.prototype.parse=function(){return this.directory=new de(this.contents),this.head=new me(this),this.name=new xe(this),this.cmap=new be(this),this.toUnicode={},this.hhea=new ye(this),this.maxp=new Ae(this),this.hmtx=new Se(this),this.post=new Ne(this),this.os2=new we(this),this.loca=new Ie(this),this.glyf=new Pe(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},_t.prototype.registerTTF=function(){var e,n,ei,ti,ii;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var ri,ni,si,ai;for(ai=[],ri=0,ni=(si=this.bbox).length;ri<ni;ri++)e=si[ri],ai.push(Math.round(e*this.scaleFactor));return ai}).call(this),this.stemV=0,this.post.exists?(ei=255&(ti=this.post.italic_angle),32768&(n=ti>>16)&&(n=-(1+(65535^n))),this.italicAngle=+(n+"."+ei)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(ii=this.familyClass)===1||ii===2||ii===3||ii===4||ii===5||ii===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},_t.prototype.characterToGlyph=function(e){var n;return((n=this.cmap.unicode)!=null?n.codeMap[e]:void 0)||0},_t.prototype.widthOfGlyph=function(e){var n;return n=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*n},_t.prototype.widthOfString=function(e,n,ei){var ti,ii,ri,ni;for(ri=0,ii=0,ni=(e=""+e).length;0<=ni?ii<ni:ii>ni;ii=0<=ni?++ii:--ii)ti=e.charCodeAt(ii),ri+=this.widthOfGlyph(this.characterToGlyph(ti))+ei*(1e3/n)||0;return ri*(n/1e3)},_t.prototype.lineHeight=function(e,n){var ei;return n==null&&(n=!1),ei=n?this.lineGap:0,(this.ascender+ei-this.decender)/1e3*e},_t})();var he,fe=(function(){function _t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return _t.prototype.readByte=function(){return this.data[this.pos++]},_t.prototype.writeByte=function(e){return this.data[this.pos++]=e},_t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},_t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},_t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},_t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},_t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},_t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},_t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},_t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},_t.prototype.readString=function(e){var n,ei;for(ei=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)ei[n]=String.fromCharCode(this.readByte());return ei.join("")},_t.prototype.writeString=function(e){var n,ei,ti;for(ti=[],n=0,ei=e.length;0<=ei?n<ei:n>ei;n=0<=ei?++n:--n)ti.push(this.writeByte(e.charCodeAt(n)));return ti},_t.prototype.readShort=function(){return this.readInt16()},_t.prototype.writeShort=function(e){return this.writeInt16(e)},_t.prototype.readLongLong=function(){var e,n,ei,ti,ii,ri,ni,si;return e=this.readByte(),n=this.readByte(),ei=this.readByte(),ti=this.readByte(),ii=this.readByte(),ri=this.readByte(),ni=this.readByte(),si=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^n)+1099511627776*(255^ei)+4294967296*(255^ti)+16777216*(255^ii)+65536*(255^ri)+256*(255^ni)+(255^si)+1):72057594037927940*e+281474976710656*n+1099511627776*ei+4294967296*ti+16777216*ii+65536*ri+256*ni+si},_t.prototype.writeLongLong=function(e){var n,ei;return n=Math.floor(e/4294967296),ei=4294967295&e,this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n),this.writeByte(ei>>24&255),this.writeByte(ei>>16&255),this.writeByte(ei>>8&255),this.writeByte(255&ei)},_t.prototype.readInt=function(){return this.readInt32()},_t.prototype.writeInt=function(e){return this.writeInt32(e)},_t.prototype.read=function(e){var n,ei;for(n=[],ei=0;0<=e?ei<e:ei>e;ei=0<=e?++ei:--ei)n.push(this.readByte());return n},_t.prototype.write=function(e){var n,ei,ti,ii;for(ii=[],ei=0,ti=e.length;ei<ti;ei++)n=e[ei],ii.push(this.writeByte(n));return ii},_t})(),de=(function(){var _t;function e(n){var ei,ti,ii;for(this.scalarType=n.readInt(),this.tableCount=n.readShort(),this.searchRange=n.readShort(),this.entrySelector=n.readShort(),this.rangeShift=n.readShort(),this.tables={},ti=0,ii=this.tableCount;0<=ii?ti<ii:ti>ii;ti=0<=ii?++ti:--ti)ei={tag:n.readString(4),checksum:n.readInt(),offset:n.readInt(),length:n.readInt()},this.tables[ei.tag]=ei}return e.prototype.encode=function(n){var ei,ti,ii,ri,ni,si,ai,oi,li,ci,ui,di,fi;for(fi in ui=Object.keys(n).length,si=Math.log(2),li=16*Math.floor(Math.log(ui)/si),ri=Math.floor(li/si),oi=16*ui-li,(ti=new fe).writeInt(this.scalarType),ti.writeShort(ui),ti.writeShort(li),ti.writeShort(ri),ti.writeShort(oi),ii=16*ui,ai=ti.pos+ii,ni=null,di=[],n)for(ci=n[fi],ti.writeString(fi),ti.writeInt(_t(ci)),ti.writeInt(ai),ti.writeInt(ci.length),di=di.concat(ci),fi==="head"&&(ni=ai),ai+=ci.length;ai%4;)di.push(0),ai++;return ti.write(di),ei=2981146554-_t(ti.data),ti.pos=ni+8,ti.writeUInt32(ei),ti.data},_t=function(n){var ei,ti,ii,ri;for(n=_e.call(n);n.length%4;)n.push(0);for(ii=new fe(n),ti=0,ei=0,ri=n.length;ei<ri;ei=ei+=4)ti+=ii.readUInt32();return 4294967295&ti},e})(),pe={}.hasOwnProperty,ge=function(_t,e){for(var n in e)pe.call(e,n)&&(_t[n]=e[n]);function ei(){this.constructor=_t}return ei.prototype=e.prototype,_t.prototype=new ei,_t.__super__=e.prototype,_t};he=(function(){function _t(e){var n;this.file=e,n=this.file.directory.tables[this.tag],this.exists=!!n,n&&(this.offset=n.offset,this.length=n.length,this.parse(this.file.contents))}return _t.prototype.parse=function(){},_t.prototype.encode=function(){},_t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},_t})();var me=(function(){function _t(){return _t.__super__.constructor.apply(this,arguments)}return ge(_t,he),_t.prototype.tag="head",_t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},_t.prototype.encode=function(e){var n;return(n=new fe).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(e),n.writeShort(this.glyphDataFormat),n.data},_t})(),ve=(function(){function _t(e,n){var ei,ti,ii,ri,ni,si,ai,oi,li,ci,ui,di,fi,hi,pi,gi,vi;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=n+e.readInt(),li=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(si=0;si<256;++si)this.codeMap[si]=e.readByte();break;case 4:for(ui=e.readUInt16(),ci=ui/2,e.pos+=6,ii=(function(){var yi,_i;for(_i=[],si=yi=0;0<=ci?yi<ci:yi>ci;si=0<=ci?++yi:--yi)_i.push(e.readUInt16());return _i})(),e.pos+=2,fi=(function(){var yi,_i;for(_i=[],si=yi=0;0<=ci?yi<ci:yi>ci;si=0<=ci?++yi:--yi)_i.push(e.readUInt16());return _i})(),ai=(function(){var yi,_i;for(_i=[],si=yi=0;0<=ci?yi<ci:yi>ci;si=0<=ci?++yi:--yi)_i.push(e.readUInt16());return _i})(),oi=(function(){var yi,_i;for(_i=[],si=yi=0;0<=ci?yi<ci:yi>ci;si=0<=ci?++yi:--yi)_i.push(e.readUInt16());return _i})(),ti=(this.length-e.pos+this.offset)/2,ni=(function(){var yi,_i;for(_i=[],si=yi=0;0<=ti?yi<ti:yi>ti;si=0<=ti?++yi:--yi)_i.push(e.readUInt16());return _i})(),si=pi=0,vi=ii.length;pi<vi;si=++pi)for(hi=ii[si],ei=gi=di=fi[si];di<=hi?gi<=hi:gi>=hi;ei=di<=hi?++gi:--gi)oi[si]===0?ri=ei+ai[si]:(ri=ni[oi[si]/2+(ei-di)-(ci-si)]||0)!==0&&(ri+=ai[si]),this.codeMap[ei]=65535&ri}e.pos=li}return _t.encode=function(e,n){var ei,ti,ii,ri,ni,si,ai,oi,li,ci,ui,di,fi,hi,pi,gi,vi,yi,_i,Ai,Ei,Si,wi,Oi,Ii,Li,Di,Ni,$i,Ki,er,Vi,nr,zi,Wi,Ti,ki,xi,Mi,Ui,Yi,sr,cr,ir,Zi,rr;switch(Ni=new fe,ri=Object.keys(e).sort(function(ar,pr){return ar-pr}),n){case"macroman":for(fi=0,hi=(function(){var ar=[];for(di=0;di<256;++di)ar.push(0);return ar})(),gi={0:0},ii={},$i=0,nr=ri.length;$i<nr;$i++)gi[cr=e[ti=ri[$i]]]==null&&(gi[cr]=++fi),ii[ti]={old:e[ti],new:gi[e[ti]]},hi[ti]=gi[e[ti]];return Ni.writeUInt16(1),Ni.writeUInt16(0),Ni.writeUInt32(12),Ni.writeUInt16(0),Ni.writeUInt16(262),Ni.writeUInt16(0),Ni.write(hi),{charMap:ii,subtable:Ni.data,maxGlyphID:fi+1};case"unicode":for(Li=[],li=[],vi=0,gi={},ei={},pi=ai=null,Ki=0,zi=ri.length;Ki<zi;Ki++)gi[_i=e[ti=ri[Ki]]]==null&&(gi[_i]=++vi),ei[ti]={old:_i,new:gi[_i]},ni=gi[_i]-ti,pi!=null&&ni===ai||(pi&&li.push(pi),Li.push(ti),ai=ni),pi=ti;for(pi&&li.push(pi),li.push(65535),Li.push(65535),Oi=2*(wi=Li.length),Si=2*Math.pow(Math.log(wi)/Math.LN2,2),ci=Math.log(Si/2)/Math.LN2,Ei=2*wi-Si,si=[],Ai=[],ui=[],di=er=0,Wi=Li.length;er<Wi;di=++er){if(Ii=Li[di],oi=li[di],Ii===65535){si.push(0),Ai.push(0);break}if(Ii-(Di=ei[Ii].new)>=32768)for(si.push(0),Ai.push(2*(ui.length+wi-di)),ti=Vi=Ii;Ii<=oi?Vi<=oi:Vi>=oi;ti=Ii<=oi?++Vi:--Vi)ui.push(ei[ti].new);else si.push(Di-Ii),Ai.push(0)}for(Ni.writeUInt16(3),Ni.writeUInt16(1),Ni.writeUInt32(12),Ni.writeUInt16(4),Ni.writeUInt16(16+8*wi+2*ui.length),Ni.writeUInt16(0),Ni.writeUInt16(Oi),Ni.writeUInt16(Si),Ni.writeUInt16(ci),Ni.writeUInt16(Ei),Yi=0,Ti=li.length;Yi<Ti;Yi++)ti=li[Yi],Ni.writeUInt16(ti);for(Ni.writeUInt16(0),sr=0,ki=Li.length;sr<ki;sr++)ti=Li[sr],Ni.writeUInt16(ti);for(ir=0,xi=si.length;ir<xi;ir++)ni=si[ir],Ni.writeUInt16(ni);for(Zi=0,Mi=Ai.length;Zi<Mi;Zi++)yi=Ai[Zi],Ni.writeUInt16(yi);for(rr=0,Ui=ui.length;rr<Ui;rr++)fi=ui[rr],Ni.writeUInt16(fi);return{charMap:ei,subtable:Ni.data,maxGlyphID:vi+1}}},_t})(),be=(function(){function _t(){return _t.__super__.constructor.apply(this,arguments)}return ge(_t,he),_t.prototype.tag="cmap",_t.prototype.parse=function(e){var n,ei,ti;for(e.pos=this.offset,this.version=e.readUInt16(),ti=e.readUInt16(),this.tables=[],this.unicode=null,ei=0;0<=ti?ei<ti:ei>ti;ei=0<=ti?++ei:--ei)n=new ve(e,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},_t.encode=function(e,n){var ei,ti;return n==null&&(n="macroman"),ei=ve.encode(e,n),(ti=new fe).writeUInt16(0),ti.writeUInt16(1),ei.table=ti.data.concat(ei.subtable),ei},_t})(),ye=(function(){function _t(){return _t.__super__.constructor.apply(this,arguments)}return ge(_t,he),_t.prototype.tag="hhea",_t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},_t})(),we=(function(){function _t(){return _t.__super__.constructor.apply(this,arguments)}return ge(_t,he),_t.prototype.tag="OS/2",_t.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=(function(){var n,ei;for(ei=[],n=0;n<10;++n)ei.push(e.readByte());return ei})(),this.charRange=(function(){var n,ei;for(ei=[],n=0;n<4;++n)ei.push(e.readInt());return ei})(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=(function(){var n,ei;for(ei=[],n=0;n<2;n=++n)ei.push(e.readInt());return ei})(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},_t})(),Ne=(function(){function _t(){return _t.__super__.constructor.apply(this,arguments)}return ge(_t,he),_t.prototype.tag="post",_t.prototype.parse=function(e){var n,ei,ti;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var ii;for(ei=e.readUInt16(),this.glyphNameIndex=[],ii=0;0<=ei?ii<ei:ii>ei;ii=0<=ei?++ii:--ii)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],ti=[];e.pos<this.offset+this.length;)n=e.readByte(),ti.push(this.names.push(e.readString(n)));return ti;case 151552:return ei=e.readUInt16(),this.offsets=e.read(ei);case 262144:return this.map=(function(){var ri,ni,si;for(si=[],ii=ri=0,ni=this.file.maxp.numGlyphs;0<=ni?ri<ni:ri>ni;ii=0<=ni?++ri:--ri)si.push(e.readUInt32());return si}).call(this)}},_t})(),Le=function(_t,e){this.raw=_t,this.length=_t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},xe=(function(){function _t(){return _t.__super__.constructor.apply(this,arguments)}return ge(_t,he),_t.prototype.tag="name",_t.prototype.parse=function(e){var n,ei,ti,ii,ri,ni,si,ai,oi,li,ci;for(e.pos=this.offset,e.readShort(),n=e.readShort(),ni=e.readShort(),ei=[],ii=0;0<=n?ii<n:ii>n;ii=0<=n?++ii:--ii)ei.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+ni+e.readShort()});for(si={},ii=oi=0,li=ei.length;oi<li;ii=++oi)ti=ei[ii],e.pos=ti.offset,ai=e.readString(ti.length),ri=new Le(ai,ti),si[ci=ti.nameID]==null&&(si[ci]=[]),si[ti.nameID].push(ri);this.strings=si,this.copyright=si[0],this.fontFamily=si[1],this.fontSubfamily=si[2],this.uniqueSubfamily=si[3],this.fontName=si[4],this.version=si[5];try{this.postscriptName=si[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=si[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=si[7],this.manufacturer=si[8],this.designer=si[9],this.description=si[10],this.vendorUrl=si[11],this.designerUrl=si[12],this.license=si[13],this.licenseUrl=si[14],this.preferredFamily=si[15],this.preferredSubfamily=si[17],this.compatibleFull=si[18],this.sampleText=si[19]},_t})(),Ae=(function(){function _t(){return _t.__super__.constructor.apply(this,arguments)}return ge(_t,he),_t.prototype.tag="maxp",_t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},_t})(),Se=(function(){function _t(){return _t.__super__.constructor.apply(this,arguments)}return ge(_t,he),_t.prototype.tag="hmtx",_t.prototype.parse=function(e){var n,ei,ti,ii,ri,ni,si;for(e.pos=this.offset,this.metrics=[],n=0,ni=this.file.hhea.numberOfMetrics;0<=ni?n<ni:n>ni;n=0<=ni?++n:--n)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(ti=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var ai,oi;for(oi=[],n=ai=0;0<=ti?ai<ti:ai>ti;n=0<=ti?++ai:--ai)oi.push(e.readInt16());return oi})(),this.widths=(function(){var ai,oi,li,ci;for(ci=[],ai=0,oi=(li=this.metrics).length;ai<oi;ai++)ii=li[ai],ci.push(ii.advance);return ci}).call(this),ei=this.widths[this.widths.length-1],si=[],n=ri=0;0<=ti?ri<ti:ri>ti;n=0<=ti?++ri:--ri)si.push(this.widths.push(ei));return si},_t.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},_t})(),_e=[].slice,Pe=(function(){function _t(){return _t.__super__.constructor.apply(this,arguments)}return ge(_t,he),_t.prototype.tag="glyf",_t.prototype.parse=function(){return this.cache={}},_t.prototype.glyphFor=function(e){var n,ei,ti,ii,ri,ni,si,ai,oi,li;return e in this.cache?this.cache[e]:(ii=this.file.loca,n=this.file.contents,ei=ii.indexOf(e),(ti=ii.lengthOf(e))===0?this.cache[e]=null:(n.pos=this.offset+ei,ri=(ni=new fe(n.read(ti))).readShort(),ai=ni.readShort(),li=ni.readShort(),si=ni.readShort(),oi=ni.readShort(),this.cache[e]=ri===-1?new Fe(ni,ai,li,si,oi):new ke(ni,ri,ai,li,si,oi),this.cache[e]))},_t.prototype.encode=function(e,n,ei){var ti,ii,ri,ni,si;for(ri=[],ii=[],ni=0,si=n.length;ni<si;ni++)ti=e[n[ni]],ii.push(ri.length),ti&&(ri=ri.concat(ti.encode(ei)));return ii.push(ri.length),{table:ri,offsets:ii}},_t})(),ke=(function(){function _t(e,n,ei,ti,ii,ri){this.raw=e,this.numberOfContours=n,this.xMin=ei,this.yMin=ti,this.xMax=ii,this.yMax=ri,this.compound=!1}return _t.prototype.encode=function(){return this.raw.data},_t})(),Fe=(function(){function _t(e,n,ei,ti,ii){var ri,ni;for(this.raw=e,this.xMin=n,this.yMin=ei,this.xMax=ti,this.yMax=ii,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],ri=this.raw;ni=ri.readShort(),this.glyphOffsets.push(ri.pos),this.glyphIDs.push(ri.readUInt16()),32&ni;)ri.pos+=1&ni?4:2,128&ni?ri.pos+=8:64&ni?ri.pos+=4:8&ni&&(ri.pos+=2)}return _t.prototype.encode=function(){var e,n,ei;for(n=new fe(_e.call(this.raw.data)),e=0,ei=this.glyphIDs.length;e<ei;++e)n.pos=this.glyphOffsets[e];return n.data},_t})(),Ie=(function(){function _t(){return _t.__super__.constructor.apply(this,arguments)}return ge(_t,he),_t.prototype.tag="loca",_t.prototype.parse=function(e){var n,ei;return e.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var ti,ii;for(ii=[],ei=0,ti=this.length;ei<ti;ei+=2)ii.push(2*e.readUInt16());return ii}).call(this):(function(){var ti,ii;for(ii=[],ei=0,ti=this.length;ei<ti;ei+=4)ii.push(e.readUInt32());return ii}).call(this)},_t.prototype.indexOf=function(e){return this.offsets[e]},_t.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},_t.prototype.encode=function(e,n){for(var ei=new Uint32Array(this.offsets.length),ti=0,ii=0,ri=0;ri<ei.length;++ri)if(ei[ri]=ti,ii<n.length&&n[ii]==ri){++ii,ei[ri]=ti;var ni=this.offsets[ri],si=this.offsets[ri+1]-ni;si>0&&(ti+=si)}for(var ai=new Array(4*ei.length),oi=0;oi<ei.length;++oi)ai[4*oi+3]=255&ei[oi],ai[4*oi+2]=(65280&ei[oi])>>8,ai[4*oi+1]=(16711680&ei[oi])>>16,ai[4*oi]=(4278190080&ei[oi])>>24;return ai},_t})(),je=(function(){function _t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return _t.prototype.generateCmap=function(){var e,n,ei,ti,ii;for(n in ti=this.font.cmap.tables[0].codeMap,e={},ii=this.subset)ei=ii[n],e[n]=ti[ei];return e},_t.prototype.glyphsFor=function(e){var n,ei,ti,ii,ri,ni,si;for(ti={},ri=0,ni=e.length;ri<ni;ri++)ti[ii=e[ri]]=this.font.glyf.glyphFor(ii);for(ii in n=[],ti)(ei=ti[ii])!=null&&ei.compound&&n.push.apply(n,ei.glyphIDs);if(n.length>0)for(ii in si=this.glyphsFor(n))ei=si[ii],ti[ii]=ei;return ti},_t.prototype.encode=function(e,n){var ei,ti,ii,ri,ni,si,ai,oi,li,ci,ui,di,fi,hi,pi;for(ti in ei=be.encode(this.generateCmap(),"unicode"),ri=this.glyphsFor(e),ui={0:0},pi=ei.charMap)ui[(si=pi[ti]).old]=si.new;for(di in ci=ei.maxGlyphID,ri)di in ui||(ui[di]=ci++);return oi=(function(gi){var vi,yi;for(vi in yi={},gi)yi[gi[vi]]=vi;return yi})(ui),li=Object.keys(oi).sort(function(gi,vi){return gi-vi}),fi=(function(){var gi,vi,yi;for(yi=[],gi=0,vi=li.length;gi<vi;gi++)ni=li[gi],yi.push(oi[ni]);return yi})(),ii=this.font.glyf.encode(ri,fi,ui),ai=this.font.loca.encode(ii.offsets,fi),hi={cmap:this.font.cmap.raw(),glyf:ii.table,loca:ai,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(n)},this.font.os2.exists&&(hi["OS/2"]=this.font.os2.raw()),this.font.directory.encode(hi)},_t})();E.API.PDFObject=(function(){var _t;function e(){}return _t=function(n,ei){return(Array(ei+1).join("0")+n).slice(-ei)},e.convert=function(n){var ei,ti,ii,ri;if(Array.isArray(n))return"["+(function(){var ni,si,ai;for(ai=[],ni=0,si=n.length;ni<si;ni++)ei=n[ni],ai.push(e.convert(ei));return ai})().join(" ")+"]";if(typeof n=="string")return"/"+n;if(n!=null&&n.isString)return"("+n+")";if(n instanceof Date)return"(D:"+_t(n.getUTCFullYear(),4)+_t(n.getUTCMonth(),2)+_t(n.getUTCDate(),2)+_t(n.getUTCHours(),2)+_t(n.getUTCMinutes(),2)+_t(n.getUTCSeconds(),2)+"Z)";if({}.toString.call(n)==="[object Object]"){for(ti in ii=["<<"],n)ri=n[ti],ii.push("/"+ti+" "+e.convert(ri));return ii.push(">>"),ii.join(`
`)}return""+n},e})();const _hoisted_1$1={class:"mt-10"},_hoisted_2={class:"mt-10"},_hoisted_3={class:"print-preview-container"},__default__$6={},_sfc_main$u=Object.assign(__default__$6,{__name:"PrintModal",props:{visibility:Boolean},setup(_t,{expose:e}){useCssVars(Ui=>({v6b810fbc:unref(nr).width,v2a5c241e:unref(nr).height,v7a91049e:unref(zi).left,v5688edde:unref(zi).top,v56165775:pi,f89f7e20:unref(Ki).width,v4eee3986:unref(Ki).height,v76eba9fc:unref(Ni)}));const n=useEulerian(),ei=useMapStore(),ti=inject("emitter"),ii=inject(mainMap),ri="Imprimer une carte",ni="xl",si=[{label:"Portrait",value:"portrait",icon:"material-symbols:crop-portrait-outline-sharp"},{label:"Paysage",value:"landscape",icon:"material-symbols:crop-landscape-outline-sharp"}],ai=ref$1(!1),oi=()=>{ti.dispatchEvent("leftmenu:close"),ai.value=!0,n.pause()},li=()=>{ai.value=!1,n.resume(),ii.renderSync()};e({onModalPrintClose:li,onModalPrintOpen:oi});const ci=ref$1(null),ui=ref$1(null),di=ref$1(null),fi=ref$1(null),hi=ref$1(null),pi="10px",gi=.264583333,vi=ref$1(!0),yi=ref$1(!0),_i=ref$1("Ma carte"),Ai=ref$1("portrait"),Ei=ref$1(5),Si=ref$1("A4"),wi=computed(()=>{var Ui={A0:{width:841,height:1189},A1:{width:594,height:841},A2:{width:420,height:594},A3:{width:297,height:420},A4:{width:210,height:297},A5:{width:148,height:210},B4:{width:250,height:353},B5:{width:176,height:250}};if(Ai.value=="portrait")return{width:Ui[Si.value].width,height:Ui[Si.value].height};if(Ai.value=="landscape")return{width:Ui[Si.value].height,height:Ui[Si.value].width}}),Oi=reactive(useElementSize(di,{width:0,height:0},{box:"border-box"})),Ii=reactive(useElementSize(fi,{width:0,height:0},{box:"border-box"})),Li=reactive(useElementSize(ui,{width:0,height:0},{box:"border-box"})),Di=computed(()=>({width:wi.value.width/gi,height:wi.value.height/gi})),Ni=computed(()=>{let Ui=Oi.height,Yi=Oi.width-Ii.width;return computeScaleCoeff(Yi,Ui,Di.value.width,Di.value.height)}),$i=computed(()=>{var Ui=wi.value.width-2*Ei.value,Yi=wi.value.height-2*Ei.value;return yi&&(Yi-=Li.height/Vi.value.height*Yi),{width:Ui,height:Yi}}),Ki=computed(()=>({width:$i.value.width+"mm",height:$i.value.height+"mm"})),er=computed(()=>wi.value.height-$i.value.height-2*Ei.value),Vi=computed(()=>({width:Di.value.width*Ni.value,height:Di.value.height*Ni.value})),nr=computed(()=>({width:Vi.value.width+"px",height:Vi.value.height+"px"})),zi=computed(()=>({left:Ei.value/wi.value.width*Vi.value.width+"px",top:Ei.value/wi.value.height*Vi.value.height+"px"})),Wi=ref$1("PNG");function Ti(){const Ui=ci.value.mapRef.getElementsByTagName("canvas")[0];if(Wi.value==="PDF"){ki();return}xi({canvasMap:Ui,mapMMDimension:$i.value,titleHeightMM:er.value,margin:Ei.value,hasTitle:yi.value,hasScale:vi.value,drawTitle,drawScale,printTitle:_i.value,refMap:ci.value})}const ki=()=>{const Ui={orientation:Ai.value,unit:"mm",format:[wi.value.width,wi.value.height]},Yi=new E(Ui),sr=ci.value.mapRef.getElementsByTagName("canvas")[0];let cr=getMapImgParams(sr,Ei.value,er.value,$i.value);if(Yi.addImage(cr.img,cr.format,cr.imgPosX,cr.imgPosY,cr.imgWidth,cr.imgHeight),vi.value){const ir=getFakeMapCanvas(ci.value.mapRef,sr.width,sr.height);let Zi=ir.getContext("2d");Zi.reset(),drawScale(Zi,ci.value.mapRef,sr.width,sr.height);let rr=getMapImgParams(ir,Ei.value,er.value,$i.value);Yi.addImage(rr.img,rr.format,rr.imgPosX,rr.imgPosY,rr.imgWidth,rr.imgHeight),ir.remove()}if(yi.value){const ir=document.createElement("canvas");ir.width=sr.width,ir.height=er.value/$i.value.height*sr.height;let Zi=ir.getContext("2d");drawTitle(Zi,ir.height,ir.width,$i.value.width-2*Ei.value,_i.value),ci.value.mapRef.getElementsByClassName("ol-overlaycontainer")[0].insertAdjacentElement("beforebegin",ir),hi.value.append(ir);let rr=ir.toDataURL("image/png");Yi.addImage(rr,"PNG",Ei.value,Ei.value,$i.value.width,er.value),ir.remove()}Yi.save("carte.pdf")};function xi({canvasMap:Ui,mapMMDimension:Yi,titleHeightMM:sr,margin:cr,hasTitle:ir,hasScale:Zi,drawTitle:rr,drawScale:ar,printTitle:pr,refMap:Gi}){const gr=Ui.width/Yi.width,Br=cr*gr,Nr=ir?sr*gr:0,mr=Ui.width+Br*2,Mr=Ui.height+Nr+Br*2,Er=document.createElement("canvas");Er.width=mr,Er.height=Mr;const Fr=Er.getContext("2d");Fr.fillStyle="#ffffff",Fr.fillRect(0,0,mr,Mr),ir&&(Fr.save(),Fr.translate(Br,Br),rr(Fr,Nr,Ui.width,Yi.width-2*cr,pr),Fr.restore());const or=Br+Nr;Fr.drawImage(Ui,Br,or),Zi&&ar(Fr,Gi.mapRef,Ui.width,Ui.height+or);const yr=document.createElement("a");Wi.value==="PNG"&&(yr.download="carte.png",yr.href=Er.toDataURL("image/png")),Wi.value==="JPEG"&&(yr.download="carte.jpeg",yr.href=Er.toDataURL("image/jpeg",1)),yr.click(),Er.remove()}const Mi={id:"4",units:"metric",bar:!1};return(Ui,Yi)=>{const sr=DsfrSegmentedSet_default,cr=DsfrSelect_default,ir=DsfrInput_default,Zi=DsfrCheckbox_default,rr=DsfrButton_default,ar=_sfc_main$w,pr=DsfrModal_default;return openBlock(),createBlock(pr,{opened:unref(ai),title:ri,size:ni,onClose:li},{default:withCtx(()=>[createBaseVNode("div",{ref_key:"printPage",ref:di,class:"print-page"},[createBaseVNode("div",{ref_key:"printForm",ref:fi,class:"print-form"},[createVNode(sr,{modelValue:unref(Ai),"onUpdate:modelValue":Yi[0]||(Yi[0]=Gi=>isRef(Ai)?Ai.value=Gi:null),inline:!1,options:si,small:!1,legend:"Mise en Page",class:"mb-20"},{legend:withCtx(()=>[...Yi[7]||(Yi[7]=[createTextVNode(" Mise en Page ",-1)])]),_:1},8,["modelValue"]),createVNode(cr,{modelValue:unref(Si),"onUpdate:modelValue":Yi[1]||(Yi[1]=Gi=>isRef(Si)?Si.value=Gi:null),label:"Dimensions",options:["A0","A1","A2","A3","A4","A5","B4","B5"]},null,8,["modelValue"]),createVNode(cr,{modelValue:unref(Ei),"onUpdate:modelValue":Yi[2]||(Yi[2]=Gi=>isRef(Ei)?Ei.value=Gi:null),modelModifiers:{number:!0},label:"Marge",options:[{value:0,text:"Pas de marge - 0mm"},{value:5,text:"Petite marge - 5mm"},{value:10,text:"Grosse marge - 10mm"}]},null,8,["modelValue"]),createVNode(ir,{modelValue:unref(_i),"onUpdate:modelValue":Yi[3]||(Yi[3]=Gi=>isRef(_i)?_i.value=Gi:null),disabled:!unref(yi),label:"Titre de la carte","label-visible":"",name:"titre",class:"mb-10"},null,8,["modelValue","disabled"]),createBaseVNode("div",_hoisted_1$1,[createVNode(Zi,{modelValue:unref(yi),"onUpdate:modelValue":Yi[4]||(Yi[4]=Gi=>isRef(yi)?yi.value=Gi:null),name:"checkbox-simple",label:unref(yi)?"Dsactiver le titre":"Activer le titre"},null,8,["modelValue","label"])]),createBaseVNode("div",_hoisted_2,[createVNode(Zi,{modelValue:unref(vi),"onUpdate:modelValue":Yi[5]||(Yi[5]=Gi=>isRef(vi)?vi.value=Gi:null),name:"checkbox-simple",label:unref(vi)?"Dsactiver l'chelle":"Afficher l'chelle"},null,8,["modelValue","label"])]),createVNode(cr,{modelValue:unref(Wi),"onUpdate:modelValue":Yi[6]||(Yi[6]=Gi=>isRef(Wi)?Wi.value=Gi:null),label:"Format d'export",options:["PDF","PNG","JPEG"]},null,8,["modelValue"]),createVNode(rr,{id:"print-page-export",label:"Imprimer la carte",title:"Imprimer la carte",icon:"","no-outline":"",onClick:Ti})],512),createBaseVNode("div",_hoisted_3,[createBaseVNode("div",{ref_key:"printPreview",ref:hi,class:"print-preview"},[unref(yi)?(openBlock(),createElementBlock("div",{key:0,id:"map-title",ref_key:"mapTitle",ref:ui,class:"map-title"},toDisplayString(unref(_i)),513)):createCommentVNode("",!0),unref(ai)?(openBlock(),createBlock(_sfc_main$y,{key:1,ref_key:"refMap",ref:ci,class:"map","map-id":unref(printMap)},{default:withCtx(()=>[createVNode(_sfc_main$x,{"map-id":unref(printMap),center:unref(ei).center,zoom:unref(ei).zoom},null,8,["map-id","center","zoom"]),createVNode(_sfc_main$v,{"main-map-id":unref(mainMap),"print-map-id":unref(printMap)},null,8,["main-map-id","print-map-id"]),createVNode(ar,{visibility:unref(vi),"scale-line-options":Mi,"map-id":unref(printMap)},null,8,["visibility","map-id"])]),_:1},8,["map-id"])):createCommentVNode("",!0)],512)])],512)]),_:1},8,["opened"])}}}),__unplugin_components_0=_export_sfc(_sfc_main$u,[["__scopeId","data-v-1d27f9a5"]]),_sfc_main$t={__name:"SearchEngine",props:{mapId:{type:String,default:""},visibility:Boolean,analytic:Boolean,searchEngineOptions:{type:Object,default:()=>({})}},setup(_t){const e=inject("emitter"),n=_t,ei=distExports$1.useLogger(),ti=useMapStore(),ii=inject(n.mapId),ri=ref$1(new InseeAdvancedSearch),ni=ref$1(new LocationAdvancedSearch),si=ref$1(new CoordinateAdvancedSearch),ai=ref$1(new ParcelAdvancedSearch),oi=computed(()=>Object.assign({},n.searchEngineOptions,{advancedSearch:[ri.value,ni.value,si.value,ai.value]})),li=shallowRef(new SearchEngineAdvanced(oi.value));onMounted(()=>{n.visibility&&(ii.addControl(li.value),li.value.on("searchengine:search:click",ci),li.value.on("searchengine:autocomplete:click",ui),li.value.on("searchengine:geocode:click",di),li.value.on("searchengine:coordinates:click",fi),li.value.on("searchengine:geolocation:click",hi),li.value.on("searchengine:geolocation:remove",pi))}),onBeforeUpdate(()=>{n.visibility||ii.removeControl(li.value)}),onUpdated(()=>{n.visibility&&ii.addControl(li.value)});const ci=gi=>{ei.debug("SearchEngineAdvanced - onClickSearch",gi)},ui=gi=>{ei.debug("SearchEngineAdvanced - onClickAutocompletResult",gi)},di=gi=>{ei.debug("SearchEngineAdvanced - onClickGeocodeResult",gi)},fi=gi=>{ei.debug("SearchEngineAdvanced - onClickSearchByCoordinates",gi)},hi=gi=>{ei.debug("SearchEngineAdvanced - onClickSearchGeolocationOpen",gi),ti.geolocation=toLonLat(gi.coordinates).toString(),e.emit("searchengine:geolocation:clicked",gi.coordinates)},pi=gi=>{ei.debug("SearchEngineAdvanced - onClickSearchGeolocationRemove",gi),ti.geolocation="",e.emit("searchengine:geolocation:removed")};return(gi,vi)=>(openBlock(),createElementBlock("div"))}};function useActionButtonEulerian(_t){_t.setAttribute("data-fr-analytics-action",_t.title),_t.setAttribute("data-fr-js-button-actionee",!0)}const _sfc_main$s={__name:"OverviewMap",props:{mapId:String,visibility:Boolean,analytic:Boolean,overviewMapOptions:Object},setup(_t){const e=_t,n=distExports$1.useLogger(),ei=inject(e.mapId),ti=ref$1(new GeoportalOverviewMap(e.overviewMapOptions)),ii=useMatchMedia("SM");watch(ii,()=>{if(e.visibility&&!ii.value){if(ei.addControl(ti.value),e.analytic){var ni=ti.value.element.querySelector("button[id^=GPshowOverviewMap-]");useActionButtonEulerian(ni)}}else ei.removeControl(ti.value)}),onMounted(()=>{if(e.visibility&&!ii.value&&(ei.addControl(ti.value),ti.value.on("overviewmap:toggle",ri),e.analytic)){var ni=ti.value.element.querySelector("button[id^=GPshowOverviewMap-]");useActionButtonEulerian(ni)}}),onBeforeUpdate(()=>{if(e.visibility&&!ii.value){if(ei.addControl(ti.value),e.analytic){var ni=ti.value.element.querySelector("button[id^=GPshowOverviewMap-]");useActionButtonEulerian(ni)}}else ei.removeControl(ti.value)});function ri(ni){n.debug(ni)}return(ni,si)=>null}},_sfc_main$r={__name:"Zoom",props:{mapId:String,visibility:Boolean,analytic:Boolean,zoomOptions:Object},setup(_t){const e=_t,n=distExports$1.useLogger(),ei=inject(e.mapId),ti=ref$1(new GeoportalZoom(e.zoomOptions));onMounted(()=>{e.visibility&&(ei.addControl(ti.value),ti.value.on("zoom:in",ii),ti.value.on("zoom:out",ri))}),onBeforeUpdate(()=>{e.visibility||ei.removeControl(ti.value)}),onUpdated(()=>{e.visibility&&ei.addControl(ti.value)});function ii(ni){n.debug(ni)}function ri(ni){n.debug(ni)}return(ni,si)=>null}},useDataStore=defineStore("data",()=>{const _t=ref$1({}),e=ref$1({}),n=ref$1({}),ei=ref$1({}),ti=ref$1([]),ii=ref$1([]),ri=ref$1([]),ni=ref$1([]),si=ref$1(!1),ai=ref$1(""),oi="WMTS,WMS,TMS",li="IGNF:LAMB93,EPSG:2154",ci=ref$1([]),ui=ref$1([]),di=computed(()=>{let ki=[];return ki=[...new Set(Object.values(_t.value).flatMap(xi=>(xi==null?void 0:xi.thematic)||[]).filter(xi=>typeof xi=="string"))].sort((xi,Mi)=>xi==="Autres"?1:Mi==="Autres"?-1:xi.localeCompare(Mi,"fr",{sensitivity:"base"})),ki=ki.map(xi=>[xi,_i(xi)]),ki}),fi=computed(()=>{let ki=[];return ki=[...new Set(Object.values(_t.value).flatMap(xi=>(xi==null?void 0:xi.producer)||[]).filter(xi=>typeof xi=="string"))].sort((xi,Mi)=>xi==="Autres"?1:Mi==="Autres"?-1:xi.localeCompare(Mi,"fr",{sensitivity:"base"})),ki.map(xi=>[xi,Ei(xi)])});async function hi(){try{var ki=null;try{const sr=window.__ENV__.VITE_GPF_CONF_ALERTS;if(ki=await fetch(sr),!ki.ok)throw new Error("Erreur HTTP")}catch{ki=await fetch("data/alerts.json")}const xi=await ki.json();ri.value=xi;const Mi=window.__ENV__.VITE_GPF_CONF_ENTREE_CARTO,Yi=await(await fetch(Mi)).json();return ti.value=Yi.territories,ei.value=Yi.contacts,ii.value=Yi.featured||[],_t.value=Yi.layers,e.value.apiKeys={...Yi.generalOptions.apiKeys},n.value=Yi.tileMatrixSets,ni.value=Yi.topics||[],this.isLoaded=!0,Yi.layers}catch(xi){console.log(xi),this.isLoaded=!1,ai.value=xi.message}}function pi(){return ti.value}function gi(){return ei.value}function vi(){return ri.value.filter(ki=>ki.visibility.map)}function yi(){return di.value}function _i(ki){return Object.keys(_t.value).filter(xi=>_t.value[xi].thematic.includes(ki)).map(xi=>xi)}function Ai(){return fi.value}function Ei(ki){return Object.keys(_t.value).filter(xi=>_t.value[xi].producer.includes(ki)).map(xi=>xi)}function Si(){return ii.value}function wi(){return _t.value}function Oi(){return Object.fromEntries(Object.entries(_t.value).map(([ki,xi])=>[xi.name,xi.serviceParams.id.split(":")[1]]))}function Ii(ki,xi){for(const Mi in _t.value)if(Object.hasOwnProperty.call(_t.value,Mi)){const Ui=_t.value[Mi];if(Ui.name===ki&&Ui.serviceParams.id.split(":")[1]===xi)return Ui.name+"$GEOPORTAIL:"+Ui.serviceParams.id}}function Li(ki,xi){const Mi=this.getLayerIdByName(ki,xi);return this.getLayerByID(Mi)}function Di(ki){return _t.value[ki]}function Ni(ki){return Object.values(_t.value).filter(xi=>{if(ki&&xi.title==ki)return xi})}function $i(ki){var xi=[],Mi=e.value.apiKeys;for(var Ui in Mi){var Yi=Mi[Ui];Yi.forEach(function(sr){sr===ki&&xi.push(Ui)})}return xi}function Ki(ki,xi){var Mi=null;if((xi==="WMS"||Object.keys(this.getTileMatrixSets()).length!==0)&&Object.keys(this.getLayers()).length!==0){var Ui=this.getLayerIdByName(ki,xi);Mi=this.getLayerParamsByID(Ui)}return Mi}function er(ki){var xi=null;if(ki){xi={};var Mi=this.getLayerByID(ki),Ui=this.getLayerKeysByID(ki);if(Ui.length===0)return;for(var Yi=0;Yi<Ui.length;Yi++)Mi.serviceParams.serverUrl[Ui[Yi]]&&(xi.url=Mi.serviceParams.serverUrl[Ui[Yi]]);if(/\/v\//.test(xi.url)?xi.styles=" ":xi.styles=Mi.styles[0].name,xi.version=Mi.serviceParams.version,xi.format=Mi.formats[0].name,xi.projection=Mi.defaultProjection,xi.minScale=Mi.globalConstraint.minScaleDenominator,xi.maxScale=Mi.globalConstraint.maxScaleDenominator,xi.extent=Mi.globalConstraint.bbox,xi.legends=Mi.legends,xi.title=Mi.title,xi.description=Mi.description,Mi.wmtsOptions){xi.tileMatrixSetLimits=Mi.wmtsOptions.tileMatrixSetLimits;var sr=Mi.wmtsOptions.tileMatrixSetLink;if(sr){xi.TMSLink=sr;var cr=this.getTileMatrixSetByID(sr);xi.matrixIds=Object.keys(cr.tileMatrices),xi.tileMatrices=cr.tileMatrices,xi.nativeResolutions=cr.nativeResolutions}}}return xi}function Vi(ki){var xi=null;if(ki){var Mi=this.getLayerByID(ki);xi={},xi.projection=Mi.globalConstraint.crs,xi.minScale=Mi.globalConstraint.minScaleDenominator,xi.maxScale=Mi.globalConstraint.maxScaleDenominator,xi.extent=Mi.globalConstraint.bbox}return xi}function nr(ki,xi){var Mi=this.getLayerIdByName(ki,xi);return this.getGlobalConstraintsByID(Mi)}function zi(){return n.value}function Wi(ki){return n.value[ki]}function Ti(){return ni.value}return{error:ai,isLoaded:si,filterProjections:li,filterServices:oi,producers:ui,themes:ci,fetchData:hi,getTerritories:pi,getContacts:gi,getAlerts:vi,getLayersByThematic:_i,getThematics:yi,getLayersByProducer:Ei,getProducers:Ai,getFeatured:Si,getLayers:wi,getLayersSignatures:Oi,getLayerKeysByID:$i,getLayerIdByName:Ii,getLayerByName:Li,getLayerByID:Di,getLayerByTitle:Ni,getTileMatrixSets:zi,getTileMatrixSetByID:Wi,getLayerParamsByName:Ki,getLayerParamsByID:er,getGlobalConstraintsByID:Vi,getGlobalConstraintsByName:nr,getTopics:Ti}}),t={auth:{title:"Authentification",not_authentificated:"Vous devez vous authentifier",failed:_t=>`Exception sur l'authentication : ${_t}`},bookmark:{title:"Espace personnel",failed:_t=>`Exception sur l'espace personnel : ${_t}`,success_add_data:_t=>`Ajout sur la carte de la donne de type ${_t}`,failed_add_data:_t=>`Erreur sur l'ajout de la donne : ${_t}`,success_save_map:"La carte est enregistre dans l'espace personnel",failed_save_map:"Une erreur est survenue sur l'enregistrement de la carte",success_copy_permalink:"Le permalien est copi",failed_type_unknow:_t=>`Impossible de determiner le type de donnes : ${_t}`,failed_not_yet_implemented:_t=>`Pas encore implement : ${_t} !`},drawing:{title:"Croquis",save_success:"Le croquis est enregistr dans l'espace personnel",save_failed:"Une erreur est survenue sur l'enregistrement du croquis"},layerimport:{title:"Import de couche",save_success:"L'import est enregistr dans l'espace personnel",save_failed:"Une erreur est survenue sur l'enregistrement de l'import",add_success_service:_t=>`La couche du service ${_t} est ajoute  la carte`,add_failed_service:_t=>`Une erreur est survenue dans l'ajout de la couche ${_t} !`,add_success_mapbox:"La couche MapBox est ajoute  la carte",add_failed_mapbox:"Une erreur est survenue dans l'ajout de la couche MapBox !"},layerswitcher:{title:"Gestionnaire de couche",add_success:"La couche est ajoute  la carte",add_failed:"Une erreur est survenue dans l'ajout de la couche",remove_success:"La couche est supprime de la carte",remove_failed:"Une erreur est survenue dans la suppression de la couche",failed_not_yet_implemented:"L'dition de ce type de donnes n'est pas encore gre !"},route:{title:"Itinraire",failed_import:"La couche importe ne semble pas tre un calcul d'itinraire !",save_already:"Le calcul d'itinraire a dj t enregistr dans l'espace personnel",save_success:"Le calcul d'itinraire est enregistr dans l'espace personnel",save_failed:"Une erreur est survenue sur l'enregistrement du calcul d'itinraire"},iso:{title:"Isochrone",failed_import:"La couche importe ne semble pas tre un calcul d'isochrone !",save_already:"Le calcul d'isochrone a dj t enregistr dans l'espace personnel",save_success:"Le calcul d'isochrone est enregistr dans l'espace personnel",save_failed:"Une erreur est survenue sur l'enregistrement du calcul d'isochrone"},profil:{title:"Profil altimtrique",failed_import:"La couche importe ne semble pas tre un calcul de profil !",save_already:"Le calcul de profil a dj t enregistr dans l'espace personnel",save_success:"Le calcul de profil est enregistr dans l'espace personnel",save_failed:"Une erreur est survenue sur l'enregistrement du calcul de profil"},searchengine:{title:"Recherche de couche"},territories:{title:"Territoires",change:_t=>`Le territoire ${_t} a t modifi`,remove:_t=>`Le territoire ${_t} a t supprim`,add:_t=>`Le territoire ${_t} a t ajout`},ol:{title:"OpenLayers",failed:_t=>`Exception sur OpenLayers : ${_t}`,failed_format:_t=>`Le format n'est pas reconnu : ${_t}`,failed_source:_t=>`Exception sur l'initialisation de la source de type ${_t} !`,failed_layer:_t=>`Exception sur l'initialisation de la couche de type ${_t} !`,failed_mapbox:_t=>`Exception de la couche MapBox : ${_t} !`}},_sfc_main$q={__name:"LayerSwitcher",props:{mapId:{type:String,required:!0},visibility:Boolean,analytic:Boolean,layerSwitcherOptions:{type:Object,default:()=>({})}},setup(_t){const e=_t,n=distExports$1.useLogger(),ei=useMapStore(),ti=useDataStore(),ii=inject("emitter"),ri=inject(e.mapId),ni=ref$1(new LayerSwitcher(e.layerSwitcherOptions));onMounted(()=>{if(e.visibility){if(ri.addControl(ni.value),e.analytic){var pi=ni.value.element.querySelector("button[id^=GPshowLayersListPicto-]");useActionButtonEulerian(pi)}ni.value.on("layerswitcher:add",si),ni.value.on("layerswitcher:remove",ai),ni.value.on("layerswitcher:edit",hi),ni.value.on("layerswitcher:extent",oi),ni.value.on("layerswitcher:change:opacity",li),ni.value.on("layerswitcher:change:visibility",ci),ni.value.on("layerswitcher:change:position",ui),ni.value.on("layerswitcher:change:grayscale",di),ni.value.on("layerswitcher:change:style",fi)}}),onBeforeUpdate(()=>{if(!e.visibility&&(ri.removeControl(ni.value),e.analytic)){var pi=ni.value.element.querySelector("button[id^=GPshowLayersListPicto-]");useActionButtonEulerian(pi)}}),onUpdated(()=>{e.visibility&&ri.addControl(ni.value)});const si=pi=>{n.debug("onAddLayer",pi);var gi=pi.layer,vi=null;if(gi.name&&gi.service){if(vi=ti.getLayerIdByName(gi.name,gi.service),n.debug(gi.name,"| position",gi.layer.getZIndex()),ei.updateLayerProperty(vi,{position:gi.layer.getZIndex()}),gi.service==="TMS"){var yi=gi.layer.styleName,_i=gi.layer.styleUrl;n.debug("TMS",yi,_i),yi&&_i&&ei.updateLayerProperty(vi,{style:yi})}}else{var Ai=gi.layer.gpResultLayerId;vi=Ai,Ai&&(gi.layer.gpResultLayerDiv=gi.div,Ai.startsWith("bookmark")&&(vi=Ai.split(":").pop(),n.debug(vi,"| position",gi.layer.getZIndex()),ei.updateBookmarkPropertyByID(vi,{p:gi.layer.getZIndex()})))}if(n.debug("onAddLayer",vi),vi){if(ei.isPermalink())return;push$1.success({title:t.layerswitcher.title,message:t.layerswitcher.add_success})}else push$1.warning({title:t.layerswitcher.title,message:t.layerswitcher.add_failed})},ai=pi=>{n.debug("onRemoveLayer",pi);var gi=pi.layer,vi=null;if(gi.name&&gi.service)vi=ti.getLayerIdByName(gi.name,gi.service),vi&&ei.removeLayer(vi);else{var yi=gi.layer.gpResultLayerId;yi&&(vi=yi.split(":").pop(),yi.startsWith("bookmark")&&vi&&ei.removeBookmarkByID(vi))}var _i=pi.target._layersOrder;if(_i){for(const Ai in _i)if(Object.prototype.hasOwnProperty.call(_i,Ai)){const Ei=_i[Ai];if(Ei.layer.name&&Ei.layer.service)vi=ti.getLayerIdByName(Ei.layer.name,Ei.layer.service),vi&&ei.updateLayerProperty(vi,{position:Ei.layer.getZIndex()});else{var yi=Ei.layer.gpResultLayerId;yi&&yi.startsWith("bookmark")&&(vi=yi.split(":").pop(),vi&&ei.updateBookmarkPropertyByID(vi,{p:Ei.layer.getZIndex()}))}}}if(n.debug("onRemoveLayer",vi),vi){if(ei.isPermalink())return;push$1.success({title:t.layerswitcher.title,message:t.layerswitcher.remove_success})}else push$1.warning({title:t.layerswitcher.title,message:t.layerswitcher.remove_failed})},oi=pi=>{n.debug("onZoomToExtentLayer",pi);var gi=pi.layer;if(pi.error){var vi=ti.getGlobalConstraintsByName(gi.name,gi.service);if(vi){var yi=ri.getView(),_i=yi.getProjection(),Ai=[vi.extent.left,vi.extent.bottom,vi.extent.right,vi.extent.top],Ei=vi.projection;Ei||(Ei="EPSG:4326");var Si=transformExtent(Ai,Ei,_i);Si&&yi.fit(Si)}}},li=pi=>{n.debug("onChangeOpacityLayer",pi);var gi=pi.layer,vi=null;if(gi.name&&gi.service)vi=ti.getLayerIdByName(gi.name,gi.service),vi&&ei.updateLayerProperty(vi,{opacity:pi.opacity});else{var yi=gi.layer.gpResultLayerId;yi&&yi.startsWith("bookmark")&&(vi=yi.split(":").pop(),vi&&ei.updateBookmarkPropertyByID(vi,{o:pi.opacity}))}},ci=pi=>{n.debug("onChangeVisibilityLayer",pi);var gi=pi.layer,vi=null;if(gi.name&&gi.service)vi=ti.getLayerIdByName(gi.name,gi.service),vi&&ei.updateLayerProperty(vi,{visible:pi.visibility});else{var yi=gi.layer.gpResultLayerId;yi&&yi.startsWith("bookmark")&&(vi=yi.split(":").pop(),vi&&ei.updateBookmarkPropertyByID(vi,{v:pi.visibility}))}},ui=pi=>{n.debug("onChangePositionLayer",pi),ei.updateLayerPosition(pi.layers.reverse().map(gi=>{if(gi.name&&gi.service)return ti.getLayerIdByName(gi.name,gi.service)}))},di=pi=>{n.debug("onChangeGrayScaleLayer",pi);var gi=pi.layer,vi=null;if(gi.name&&gi.service)vi=ti.getLayerIdByName(gi.name,gi.service),vi&&ei.updateLayerProperty(vi,{grayscale:pi.grayscale||!1});else{var yi=gi.layer.gpResultLayerId;yi&&yi.startsWith("bookmark")&&(vi=yi.split(":").pop(),vi&&ei.updateBookmarkPropertyByID(vi,{g:pi.grayscale||!1}))}},fi=pi=>{if(n.debug("onChangeStyleMapboxLayer",pi),pi.layer.name&&pi.layer.service){var gi=ti.getLayerIdByName(pi.layer.name,pi.layer.service),vi=pi.name,yi=pi.url;n.debug("TMS",vi,yi),vi&&yi&&ei.updateLayerProperty(gi,{style:vi})}},hi=pi=>{if(n.debug("onClickEditLayer",pi),pi.layer.gpResultLayerId){var gi=pi.layer.gpResultLayerId.toLowerCase();if(gi){if(gi.toLowerCase().includes("drawing")||gi.toLowerCase().includes("layerimport:kml")||gi.toLowerCase().includes("layerimport:gpx")||gi.toLowerCase().includes("layerimport:geojson")||gi.toLowerCase().includes("bookmark:drawing-kml")||gi.toLowerCase().includes("bookmark:import-kml")||gi.toLowerCase().includes("bookmark:import-gpx")||gi.toLowerCase().includes("bookmark:import-geojson")){ei.addControl("Drawing"),setTimeout(function(){ii.dispatchEvent("vector:edit:clicked",pi)},0);return}if(gi.toLowerCase().includes("bookmark:compute-route")||gi.toLowerCase().includes("compute:pieton$ogc:openls;itineraire")||gi.toLowerCase().includes("compute:voiture$ogc:openls;itineraire")||gi.toLowerCase().includes("layerimport:compute")&&pi.layer.get("control")==="route"){ei.addControl("Route"),setTimeout(function(){ii.dispatchEvent("compute-route:edit:clicked",pi)},0);return}if(gi.toLowerCase().includes("bookmark:compute-isocurve")||gi.toLowerCase().includes("compute:pieton$geoportail:gpp:isocurve")||gi.toLowerCase().includes("compute:voiture$geoportail:gpp:isocurve")||gi.toLowerCase().includes("layerimport:compute")&&pi.layer.get("control")==="isocurve"){ei.addControl("Isocurve"),setTimeout(function(){ii.dispatchEvent("compute-isocurve:edit:clicked",pi)},0);return}if(gi.toLowerCase().includes("bookmark:compute-profil")||gi.toLowerCase().includes("measure:profil")||gi.toLowerCase().includes("layerimport:compute")&&pi.layer.get("control")==="elevationpath"){ei.addControl("ElevationPath"),setTimeout(function(){ii.dispatchEvent("compute-profil:edit:clicked",pi)},0);return}}}push$1.warning({title:t.layerswitcher.title,message:t.layerswitcher.failed_not_yet_implemented})};return(pi,gi)=>(openBlock(),createElementBlock("div"))}},_sfc_main$p={__name:"Legends",props:{mapId:String,visibility:Boolean,analytic:Boolean,legendsOptions:Object},setup(_t){useMatchMedia("SM");const e=_t,n=inject(e.mapId),ei=ref$1(new Legends(e.legendsOptions));return onMounted(()=>{if(e.visibility&&(n.addControl(ei.value),e.analytic)){var ti=ei.value.element.querySelector("button[id^=GPshowLegendsPicto-]");useActionButtonEulerian(ti)}}),onBeforeUpdate(()=>{if(e.visibility){if(n.addControl(ei.value),e.analytic){var ti=ei.value.element.querySelector("button[id^=GPshowLegendsPicto-]");useActionButtonEulerian(ti)}}else n.removeControl(ei.value)}),(ti,ii)=>null}},useCreateDocument=async(_t,e,n)=>{try{const ri=await n.setDocument(_t);var ei=ri.uuid,ti=ri.action;if(_t.layer.gpResultLayerId&&(_t.layer.gpResultLayerId=`bookmark:${_t.type}-${_t.compute||_t.format}:${ei}`),_t.layer.gpResultLayerDiv){var ii=_t.layer.gpResultLayerDiv.querySelector("label[id^=GPname_ID_]");ii&&(ii.innerHTML=_t.name,ii.title=_t.description)}const ni=await n.sharingDocument({uuid:ei,type:_t.type});console.debug(ni);const si=await n.updateMetadataDocument({uuid:ei,type:_t.type,name:_t.name,description:_t.description,extra:{format:_t.format.toLowerCase(),target:"internal",date:new Date().toLocaleDateString()}});return console.debug(si),e.dispatchEvent("document:saved",{uuid:ei,action:ti}),ri}catch(ri){throw console.error(ri),ri}},useUpdateDocument=async(_t,e,n)=>{try{const ri=await n.updateGeometryDocument(_t);var ei=ri.uuid,ti=ri.action;if(_t.layer.gpResultLayerDiv){var ii=_t.layer.gpResultLayerDiv.querySelector("label[id^=GPname_ID_]");ii&&(ii.innerHTML=_t.name,ii.title=_t.description)}const ni=n.find(ei);if(ni&&!ni.public_url){const ai=await n.sharingDocument({uuid:ei,type:_t.type});console.debug(ai)}const si=await n.updateMetadataDocument({uuid:ei,type:_t.type,name:_t.name,description:_t.description,extra:{format:_t.format.toLowerCase(),target:"internal",date:new Date().toLocaleDateString()}});return console.debug(si),e.dispatchEvent("document:updated",{uuid:ei,action:ti}),ri}catch(ri){throw console.error(ri),ri}},toShare=(_t,e)=>{var n=useServiceStore(),ei=n.getService();if(!_t){console.debug("toShare: Document non dfini !");return}var ti=null;if(_t.public_url){ti=_t.public_url;var ii=new URLSearchParams;ii.append("id",_t._id),ii.append("name",_t.name),ii.append("description",_t.description),ii.append("format",_t.labels.find(ri=>ei.labelsFormats.includes(ri))),ii.append("type",_t.labels.find(ri=>ei.labels.includes(ri))),ii.append("target",_t.labels.find(ri=>ei.labelsTarget.includes(ri))),ii.append("kind",_t.labels.find(ri=>ei.labelsService.includes(ri))),ii.append("compute",_t.labels.find(ri=>ei.labelsCompute.includes(ri))),e&&Object.keys(e).forEach(ri=>ii.append(ri,e[ri])),ti+="?"+ii.toString()}if(!ti){console.debug("toShare: URL publique non dfinie !");return}return _reduce(ti)},fromShare=_t=>{var e={};if(!_t){console.debug("toShare: URL publique non dfinie !");return}var n,ei;n=_t.split(SEPARATOR_REDUCED_URL)[0],ei=_t.split(SEPARATOR_REDUCED_URL)[1];var ti=new URLSearchParams(ei);if(ti.forEach((ii,ri)=>{e[ri]=ii}),Object.keys(e).length===0){console.debug("fromShare: Document non dfini !");return}return e.u=n.split("?")[0],e.i=e.i||e.u.split(".")[0],_extend(e)},SEPARATOR_REDUCED_URL="?",SEPARATOR_REDUCED_PARAMS="&",REDUCED_BASE_URL=window.__ENV__.VITE_GPF_BASE_URL_DOCUMENT||"https://data.geopf.fr/documents/",REDUCED_KVP={url:{k:"u",opt:!1},id:{k:"i",opt:!1},name:{k:"n",opt:!1},description:{k:"d",opt:!0},format:{k:"f",opt:!1},type:{k:"t",opt:!1},target:{k:"c",opt:!1},kind:{k:"k",opt:!1},compute:{k:"w",opt:!1},position:{k:"p",opt:!1},opacity:{k:"o",opt:!1},visible:{k:"v",opt:!1},grayscale:{k:"g",opt:!1},stop:{k:"s",opt:!1}},_reduce=_t=>{var e=new URL(_t),n=new URLSearchParams(e.search),ei=new URLSearchParams;n.forEach((ii,ri)=>{if(!(ii===""||ii===void 0||ii==="undefined"))if(REDUCED_KVP[ri]){if(REDUCED_KVP[ri].opt)return;ei.append(REDUCED_KVP[ri].k,ii)}else ei.append(ri,ii)});var ti=(e.origin+e.pathname).replace(REDUCED_BASE_URL,"")+SEPARATOR_REDUCED_URL+""+ei.toString().replace("&",SEPARATOR_REDUCED_PARAMS);return ti},_extend=_t=>{var e={};Object.keys(REDUCED_KVP).forEach(ei=>{e[REDUCED_KVP[ei].k]=ei});var n={};return Object.keys(_t).forEach(ei=>{var ti=_t[ei];e[ei]?n[e[ei]]=ti:n[ei]=ti}),n.url=REDUCED_BASE_URL+n.url,n},__default__$5={name:"Drawing"},_sfc_main$o=Object.assign(__default__$5,{props:{mapId:String,visibility:Boolean,analytic:Boolean,drawingOptions:Object},setup(_t){const e=inject("emitter");var n=inject("services");const ei=useMapStore(),ti=distExports$1.useLogger(),ii=_t,ri=inject(ii.mapId),ni=ref$1(new Drawing(ii.drawingOptions)),si="kml",ai=ref$1(new ButtonExport({title:"Exporter",kind:"secondary",download:!0,name:"Mon croquis",description:"",control:ni.value,menu:!0,menuOptions:{outside:!0,above:!0,selectFormat:!1,labelDesc:!1},direction:"column",format:si,icons:{menu:"",button:"export"}})),oi=ref$1(new ButtonExport({title:"Enregistrer",kind:"primary",download:!1,name:"Mon croquis",description:"",control:ni.value,menu:!1,format:si,icons:{menu:"",button:"save"}}));e.addEventListener("vector:edit:clicked",di=>{ni.value&&(ni.value.setCollapsed(!1),ni.value.setLayer(di.layer),ai.value.inputName.value=di.options.title||"");var fi=di.layer.gpResultLayerId.toLowerCase();if(fi){var hi;fi.includes("drawing")||fi.includes("kml")?hi="kml":fi.includes("geojson")?hi="geojson":fi.includes("gpx")?hi="gpx":hi="kml",ai.value.setFormat(hi),oi.value.setFormat(hi)}}),e.addEventListener("drawing:open:clicked",di=>{ni.value&&ni.value.setCollapsed(!di.open)}),onMounted(()=>{if(ii.visibility){if(ri.addControl(ni.value),ri.addControl(ai.value),window.__ENV__.IAM_DISABLE==="1"&&(oi.value.getContainer().style.display="none"),ri.addControl(oi.value),ii.analytic){var di=ni.value.element.querySelector("button[id^=GPshowDrawingPicto-]");useActionButtonEulerian(di)}oi.value.on("button:clicked",ci),ai.value.on("button:clicked",ui),ni.value.on("change:collapsed",li)}}),onBeforeUpdate(()=>{if(ii.visibility){if(ri.addControl(ni.value),ri.addControl(ai.value),window.__ENV__.IAM_DISABLE==="1"&&(oi.value.getContainer().style.display="none"),ri.addControl(oi.value),ii.analytic){var di=ni.value.element.querySelector("button[id^=GPshowDrawingPicto-]");useActionButtonEulerian(di)}oi.value.on("button:clicked",ci),ai.value.on("button:clicked",ui),ni.value.on("change:collapsed",li)}else ri.removeControl(oi.value),ri.removeControl(ni.value),ri.removeControl(ai.value)});const li=di=>{ti.debug(di),di.target.collapsed&&(ni.value.setLayer(),ai.value.inputName.value="",ai.value.setFormat(si),oi.value.setFormat(si))},ci=di=>{if(ti.debug(di),!n.authenticated){push$1.warning({title:t.auth.title,message:t.auth.not_authentificated});return}var fi=di.layer.gpResultLayerId.toLowerCase(),hi=fi.split(":")[0],pi={layer:di.layer,content:di.content,name:ai.value.inputName.value||di.name,description:di.description,format:di.format.toLowerCase(),target:"internal",type:fi.split(":")[0].replace("layer","")},gi;if(hi!=="bookmark")gi=useCreateDocument(pi,e,n);else{var vi=fi.split(":")[2],hi=fi.split(":")[1].split("-")[0];pi.type=hi,pi.uuid=vi,gi=useUpdateDocument(pi,e,n)}gi.then(yi=>{var _i=n.find(yi.uuid);if(_i){var Ai=toShare(_i,{opacity:pi.layer.get("opacity"),visible:pi.layer.get("visible"),grayscale:pi.layer.get("grayscale"),stop:1});if(yi.action==="added")ei.addBookmark(Ai);else if(yi.action==="updated")ei.updateBookmark(Ai);else throw new Error("Action not yet implemented !")}}).then(()=>{push$1.success({title:t.drawing.title,message:t.drawing.save_success})}).catch(yi=>{console.error(yi),push$1.error({title:t.drawing.title,message:t.drawing.save_failed})})},ui=di=>{};return(di,fi)=>null}});function useActionEdit(_t,e){_t&&(e.get("geojson")&&typeof _t.setGeoJSON=="function"&&_t.setGeoJSON(e.get("geojson")),e.get("data")&&_t.setData(e.get("data")),(e.get("control")==="route"||e.get("control")==="isocurve"||e.get("control")==="elevationpath"||_t.CLASSNAME==="Isocurve"||_t.CLASSNAME==="Route"||_t.CLASSNAME==="ElevationPath")&&(_t.setLayer(e),_t.init()),typeof _t.setCollapsed=="function"&&_t.setCollapsed(!1))}const _sfc_main$n={__name:"Isocurve",props:{mapId:String,visibility:Boolean,analytic:Boolean,isocurveOptions:Object},setup(_t){const e=inject("emitter");var n=inject("services");const ei=_t,ti=distExports$1.useLogger();useDataStore();const ii=useMapStore(),ri=inject(ei.mapId),ni=ref$1(new Isocurve(ei.isocurveOptions)),si=ref$1(new ButtonExport({title:"Exporter",kind:"secondary",download:!0,name:"Mon iso",description:"",control:ni.value,menu:!0,menuOptions:{outside:!0,above:!0,selectFormat:!1,labelDesc:!1},direction:"column",format:"geojson",icons:{menu:"",button:"export"}})),ai=ref$1(new ButtonExport({title:"Enregistrer",kind:"primary",download:!1,control:ni.value,format:"geojson",menu:!1,direction:"column",icons:{menu:"",button:"save"}}));e.addEventListener("compute-isocurve:edit:clicked",hi=>{ti.debug(hi),si.value.inputName.value=hi.options.title||"",useActionEdit(ni.value,hi.layer)}),onMounted(()=>{if(ei.visibility){if(ri.addControl(ni.value),ri.addControl(si.value),window.__ENV__.IAM_DISABLE==="1"&&(ai.value.getContainer().style.display="none"),ri.addControl(ai.value),ei.analytic){var hi=ni.value.element.querySelector("button[id^=GPshowIsochronPicto-]");useActionButtonEulerian(hi)}ni.value.on("isocurve:drawstart",li),ni.value.on("socurve:drawend",ci),ni.value.on("isocurve:compute",ui),ni.value.on("change:collapsed",oi),si.value.on("button:clicked",fi),ai.value.on("button:clicked",di)}}),onBeforeUpdate(()=>{ei.visibility||(ri.removeControl(ni.value),ri.removeControl(ai.value),ri.removeControl(si.value))}),onUpdated(()=>{if(ei.visibility){if(ri.addControl(ni.value),ri.addControl(si.value),window.__ENV__.IAM_DISABLE==="1"&&(ai.value.getContainer().style.display="none"),ri.addControl(ai.value),ei.analytic){var hi=ni.value.element.querySelector("button[id^=GPshowIsochronPicto-]");useActionButtonEulerian(hi)}ni.value.on("isocurve:drawstart",li),ni.value.on("socurve:drawend",ci),ni.value.on("isocurve:compute",ui),ni.value.on("change:collapsed",oi),si.value.on("button:clicked",fi),ai.value.on("button:clicked",di)}});const oi=hi=>{ti.debug(hi),hi.target.collapsed&&ni.value.clean()},li=hi=>{ti.debug(hi)},ci=hi=>{ti.debug(hi)},ui=hi=>{ti.debug(hi);var pi=hi.target,gi=pi.getLayer();gi.set("control",pi.CLASSNAME.toLowerCase()),gi.set("data",pi.getData()),gi.set("geojson",pi.getGeoJSON())},di=hi=>{if(ti.debug(hi),!n.authenticated){push$1.warning({title:t.auth.title,message:t.auth.not_authentificated});return}var pi=hi.layer.gpResultLayerId.toLowerCase(),gi=pi.split(":")[0];if(gi==="layerimport"&&(gi=pi.split(":")[1],gi!=="compute")){push$1.error({title:t.iso.title,message:t.iso.failed_import});return}var vi={layer:hi.layer,content:hi.content,name:si.value.inputName.value||hi.name,description:hi.description,format:hi.format.toLowerCase(),compute:"isocurve",target:"internal",type:gi},yi;if(gi!=="bookmark")yi=useCreateDocument(vi,e,n);else{push$1.info({title:t.iso.title,message:t.iso.save_already});return}yi.then(_i=>{var Ai=n.find(_i.uuid);if(Ai){var Ei=toShare(Ai,{opacity:vi.layer.get("opacity"),visible:vi.layer.get("visible"),grayscale:vi.layer.get("grayscale"),stop:1});if(_i.action==="added")ii.addBookmark(Ei);else throw new Error("Action not yet implemented !")}}).then(()=>{push$1.success({title:t.iso.title,message:t.iso.save_success})}).catch(_i=>{console.error(_i),push$1.error({title:t.iso.title,message:t.iso.save_failed})})},fi=hi=>{ti.debug(hi),si.value.options.name=si.value.inputName.value||hi.name};return(hi,pi)=>null}},_sfc_main$m={__name:"Route",props:{mapId:String,visibility:Boolean,analytic:Boolean,routeOptions:Object},setup(_t){const e=inject("emitter");var n=inject("services");const ei=_t,ti=distExports$1.useLogger();useDataStore();const ii=useMapStore(),ri=inject(ei.mapId),ni=ref$1(new Route(ei.routeOptions)),si=ref$1(new ButtonExport({title:"Exporter",kind:"secondary",download:!0,name:"Mon itineraire",description:"",control:ni.value,menu:!0,menuOptions:{outside:!0,above:!0,selectFormat:!1,labelDesc:!1},direction:"column",format:"geojson",icons:{menu:"",button:"export"}})),ai=ref$1(new ButtonExport({title:"Enregistrer",kind:"primary",download:!1,name:"Mon itineraire",control:ni.value,format:"geojson",menu:!1,direction:"column",icons:{menu:"",button:"save"}}));e.addEventListener("compute-route:edit:clicked",hi=>{ti.debug(hi),si.value.inputName.value=hi.options.title||"",useActionEdit(ni.value,hi.layer)}),onMounted(()=>{if(ei.visibility&&(ri.addControl(ni.value),ri.addControl(si.value),window.__ENV__.IAM_DISABLE==="1"&&(ai.value.getContainer().style.display="none"),ri.addControl(ai.value),ni.value.on("route:drawstart",li),ni.value.on("route:drawend",ci),ni.value.on("route:compute",ui),ni.value.on("change:collapsed",oi),si.value.on("button:clicked",fi),ai.value.on("button:clicked",di),ei.analytic)){var hi=ni.value.element.querySelector("button[id^=GPshowRoutePicto-]");useActionButtonEulerian(hi)}}),onBeforeUpdate(()=>{ei.visibility||(ri.removeControl(ni.value),ri.removeControl(ai.value),ri.removeControl(si.value))}),onUpdated(()=>{if(ei.visibility){if(ri.addControl(ni.value),ri.addControl(si.value),window.__ENV__.IAM_DISABLE==="1"&&(ai.value.getContainer().style.display="none"),ri.addControl(ai.value),ei.analytic){var hi=ni.value.element.querySelector("button[id^=GPshowRoutePicto-]");useActionButtonEulerian(hi)}ni.value.on("route:drawstart",li),ni.value.on("route:drawend",ci),ni.value.on("route:compute",ui),ni.value.on("change:collapsed",oi),si.value.on("button:clicked",fi),ai.value.on("button:clicked",di)}});const oi=hi=>{ti.debug(hi),hi.target.collapsed&&ni.value.clean()},li=hi=>{ti.debug(hi)},ci=hi=>{ti.debug(hi)},ui=hi=>{ti.debug(hi);var pi=hi.target,gi=pi.getLayer();gi.set("control",pi.CLASSNAME.toLowerCase()),gi.set("data",pi.getData()),gi.set("geojson",pi.getGeoJSON())},di=hi=>{if(ti.debug(hi),!n.authenticated){push$1.warning({title:t.auth.title,message:t.auth.not_authentificated});return}var pi=hi.layer.gpResultLayerId.toLowerCase(),gi=pi.split(":")[0];if(gi==="layerimport"&&(gi=pi.split(":")[1],gi!=="compute")){push$1.error({title:t.route.title,message:t.route.failed_import});return}var vi={layer:hi.layer,content:hi.content,name:si.value.inputName.value||hi.name,description:hi.description,format:hi.format.toLowerCase(),compute:"route",target:"internal",type:gi},yi;if(gi!=="bookmark")yi=useCreateDocument(vi,e,n);else{push$1.info({title:t.route.title,message:t.route.save_already});return}yi.then(_i=>{var Ai=n.find(_i.uuid);if(Ai){var Ei=toShare(Ai,{opacity:vi.layer.get("opacity"),visible:vi.layer.get("visible"),grayscale:vi.layer.get("grayscale"),stop:1});if(_i.action==="added")ii.addBookmark(Ei);else throw new Error("Action not yet implemented !")}}).then(()=>{push$1.success({title:t.route.title,message:t.route.save_success})}).catch(_i=>{console.error(_i),push$1.error({title:t.route.title,message:t.route.save_failed})})},fi=hi=>{ti.debug(hi),si.value.options.name=si.value.inputName.value||hi.name};return(hi,pi)=>null}},_sfc_main$l={__name:"MeasureLength",props:{mapId:String,visibility:Boolean,analytic:Boolean,measureLengthOptions:Object},setup(_t){const e=_t,n=inject(e.mapId),ei=ref$1(new MeasureLength(e.measureLengthOptions));return onMounted(()=>{if(e.visibility&&(n.addControl(ei.value),e.analytic)){var ti=ei.value.element.querySelector("button[id^=GPshowMeasureLengthPicto-]");useActionButtonEulerian(ti)}}),onBeforeUpdate(()=>{if(e.visibility){if(n.addControl(ei.value),e.analytic){var ti=ei.value.element.querySelector("button[id^=GPshowMeasureLengthPicto-]");useActionButtonEulerian(ti)}}else n.removeControl(ei.value)}),(ti,ii)=>null}},_sfc_main$k={__name:"MeasureArea",props:{mapId:String,visibility:Boolean,analytic:Boolean,measureAreaOptions:Object},setup(_t){const e=_t,n=inject(e.mapId),ei=ref$1(new MeasureArea(e.measureAreaOptions));return onMounted(()=>{if(e.visibility&&(n.addControl(ei.value),e.analytic)){var ti=ei.value.element.querySelector("button[id^=GPshowMeasureAreaPicto-]");useActionButtonEulerian(ti)}}),onBeforeUpdate(()=>{if(e.visibility){if(n.addControl(ei.value),e.analytic){var ti=ei.value.element.querySelector("button[id^=GPshowMeasureAreaPicto-]");useActionButtonEulerian(ti)}}else n.removeControl(ei.value)}),(ti,ii)=>null}},_sfc_main$j={__name:"MeasureAzimuth",props:{mapId:String,visibility:Boolean,analytic:Boolean,measureAzimuthOptions:Object},setup(_t){const e=_t,n=inject(e.mapId),ei=ref$1(new MeasureAzimuth(e.measureAzimuthOptions));return onMounted(()=>{if(e.visibility&&(n.addControl(ei.value),e.analytic)){var ti=ei.value.element.querySelector("button[id^=GPshowMeasureAzimuthPicto-]");useActionButtonEulerian(ti)}}),onBeforeUpdate(()=>{if(e.visibility){if(n.addControl(ei.value),e.analytic){var ti=ei.value.element.querySelector("button[id^=GPshowMeasureAzimuthPicto-]");useActionButtonEulerian(ti)}}else n.removeControl(ei.value)}),(ti,ii)=>null}},_sfc_main$i={__name:"MousePosition",props:{mapId:String,visibility:Boolean,analytic:Boolean,mousePositionOptions:Object},setup(_t){const e=_t;distExports$1.useLogger();const n=inject(e.mapId),ei=ref$1(new MousePosition(e.mousePositionOptions));return onMounted(()=>{if(e.visibility&&(n.addControl(ei.value),e.analytic)){var ti=ei.value.element.querySelector("button[id^=GPshowMousePositionPicto-]");useActionButtonEulerian(ti)}}),onBeforeUpdate(()=>{e.visibility||n.removeControl(ei.value)}),onUpdated(()=>{if(e.visibility&&(n.addControl(ei.value),e.analytic)){var ti=ei.value.element.querySelector("button[id^=GPshowMousePositionPicto-]");useActionButtonEulerian(ti)}}),(ti,ii)=>null}},_sfc_main$h={__name:"ElevationPath",props:{mapId:String,visibility:Boolean,analytic:Boolean,elevationPathOptions:Object},setup(_t){const e=inject("emitter");var n=inject("services");const ei=_t,ti=distExports$1.useLogger();useDataStore();const ii=useMapStore(),ri=inject(ei.mapId),ni=ref$1(new ElevationPath(ei.elevationPathOptions)),si=ref$1(new ButtonExport({title:"Exporter",kind:"secondary",download:!0,name:"Mon profil",description:"",control:ni.value,menu:!0,menuOptions:{outside:!0,above:!0,selectFormat:!1,labelDesc:!1},direction:"column",format:"geojson",icons:{menu:"",button:"export"}})),ai=ref$1(new ButtonExport({title:"Enregistrer",kind:"primary",name:"Mon profil",download:!1,control:ni.value,format:"geojson",menu:!1,icons:{menu:"",button:"save"}}));e.addEventListener("compute-profil:edit:clicked",hi=>{ti.debug(hi),si.value.inputName.value=hi.options.title||"",useActionEdit(ni.value,hi.layer)}),onMounted(()=>{if(ei.visibility){ri.addControl(ni.value),window.__ENV__.IAM_DISABLE==="1"&&(ai.value.getContainer().style.display="none"),ri.addControl(si.value),ri.addControl(ai.value),ni.value.on("elevationpath:drawstart",li),ni.value.on("elevationpath:drawend",ci),ni.value.on("elevationpath:compute",ui),ni.value.on("change:collapsed",oi),si.value.on("button:clicked",fi),ai.value.on("button:clicked",di);var hi=ni.value.element.querySelector("button[id^=GPshowElevationPathPicto-]");ei.analytic&&useActionButtonEulerian(hi),hi.dataset.removeMeasure="false",hi.dataset.removeLayer="false"}}),onBeforeUpdate(()=>{ei.visibility||(ri.removeControl(ni.value),ri.removeControl(ai.value),ri.removeControl(si.value))}),onUpdated(()=>{if(ei.visibility){ri.addControl(ni.value),ri.addControl(si.value),window.__ENV__.IAM_DISABLE==="1"&&(ai.value.getContainer().style.display="none"),ri.addControl(ai.value);var hi=ni.value.element.querySelector("button[id^=GPshowElevationPathPicto-]");ei.analytic&&useActionButtonEulerian(hi),hi.dataset.removeMeasure="false",hi.dataset.removeLayer="false",ni.value.on("elevationpath:drawstart",li),ni.value.on("elevationpath:drawend",ci),ni.value.on("elevationpath:compute",ui),ni.value.on("change:collapsed",oi),si.value.on("button:clicked",fi),ai.value.on("button:clicked",di)}});const oi=hi=>{ti.debug(hi),hi.target.collapsed&&ni.value.clean(!1)},li=hi=>{ti.debug(hi)},ci=hi=>{ti.debug(hi)},ui=hi=>{ti.debug(hi);var pi=hi.target,gi=pi.getLayer();gi.set("control",pi.CLASSNAME.toLowerCase()),gi.set("data",pi.getData())},di=hi=>{if(ti.debug(hi),!n.authenticated){push$1.warning({title:t.auth.title,message:t.auth.not_authentificated});return}var pi=hi.layer.gpResultLayerId.toLowerCase(),gi=pi.split(":")[0];if(gi==="measure"&&(gi=pi.split(":")[1],gi!=="profil")){push$1.error({title:t.profil.title,message:t.profil.failed_import});return}var vi={layer:hi.layer,content:hi.content,name:si.value.inputName.value||hi.name,description:hi.description,format:hi.format.toLowerCase(),compute:"profil",target:"internal",type:"compute"},yi;if(gi!=="bookmark")yi=useCreateDocument(vi,e,n);else{push$1.info({title:t.iso.title,message:t.iso.save_already});return}yi.then(_i=>{var Ai=n.find(_i.uuid);if(Ai){var Ei=toShare(Ai,{opacity:vi.layer.get("opacity"),visible:vi.layer.get("visible"),grayscale:vi.layer.get("grayscale"),stop:1});if(_i.action==="added")ii.addBookmark(Ei);else throw new Error("Action not yet implemented !")}}).then(()=>{push$1.success({title:t.profil.title,message:t.profil.save_success})}).catch(_i=>{console.error(_i),push$1.error({title:t.profil.title,message:t.profil.save_failed})})},fi=hi=>{ti.debug(hi),si.value.options.name=si.value.inputName.value||hi.name};return(hi,pi)=>null}},_sfc_main$g={__name:"Territories",props:{mapId:String,visibility:Boolean,analytic:Boolean,territoriesOptions:Object},setup(_t){const e=_t,n=distExports$1.useLogger(),ei=useDataStore(),ti=inject(e.mapId),ii=ref$1(new Territories(e.territoriesOptions));function ri(){var oi=ei.getTerritories();for(let li=0;li<oi.length;li++){if(oi[li].id==="ATF"||oi[li].id==="IDF")continue;const ci=oi[li];ii.value.setTerritory(ci)}}onMounted(()=>{if(e.visibility){if(ri(),ti.addControl(ii.value),e.analytic){var oi=ii.value.element.querySelector("button[id^=GPshowTerritoriesPicto-]");useActionButtonEulerian(oi)}ii.value.on("territories:change",ni),ii.value.on("territories:add",si),ii.value.on("territories:remove",ai)}}),onBeforeUpdate(()=>{e.visibility||ti.removeControl(ii.value)}),onUpdated(()=>{if(e.visibility){if(ri(),ti.addControl(ii.value),e.analytic){var oi=ii.value.element.querySelector("button[id^=GPshowTerritoriesPicto-]");useActionButtonEulerian(oi)}ii.value.on("territories:change",ni),ii.value.on("territories:add",si),ii.value.on("territories:remove",ai)}});const ni=oi=>{n.debug(oi)},si=oi=>{n.debug(oi),push$1.info({title:t.territories.title,message:t.territories.add(oi.territory.title)})},ai=oi=>{n.debug(oi),push$1.info({title:t.territories.title,message:t.territories.remove(oi.territory.title)})};return(oi,li)=>(openBlock(),createElementBlock("div"))}},_sfc_main$f={__name:"GetFeatureInfo",props:{mapId:String,visibility:Boolean,analytic:Boolean,getFeatureInfoOptions:Object},setup(_t){const e=_t,n=distExports$1.useLogger(),ei=inject(e.mapId),ti=ref$1(new GetFeatureInfo(e.getFeatureInfoOptions));onMounted(()=>{if(e.visibility&&(ei.addControl(ti.value),ti.value.on("GetFeatureInfo:toggle",ii),e.analytic)){var ri=ti.value.element.querySelector("button[id^=GPgetFeatureInfoPicto-]");useActionButtonEulerian(ri)}}),onBeforeUpdate(()=>{if(e.visibility){if(ei.addControl(ti.value),e.analytic){var ri=ti.value.element.querySelector("button[id^=GPgetFeatureInfoPicto-]");useActionButtonEulerian(ri)}}else ei.removeControl(ti.value)});function ii(ri){n.debug(ri)}return(ri,ni)=>null}},__default__$4={name:"LayerImport"},_sfc_main$e=Object.assign(__default__$4,{props:{mapId:String,visibility:Boolean,analytic:Boolean,layerImportOptions:Object},setup(_t){const e=inject("emitter"),n=inject("services"),ei=inject("refModalLogin"),ti=inject("refModalSave"),ii=_t,ri=useMapStore(),ni=distExports$1.useLogger(),si=inject(ii.mapId),ai=ref$1(new LayerImport(ii.layerImportOptions));e.addEventListener("layerimport:open:clicked",yi=>{ai.value&&ai.value.setCollapsed(!yi.open)}),onMounted(()=>{if(ii.visibility){if(si.addControl(ai.value),ii.analytic){var yi=ai.value.element.querySelector("button[id^=GPshowImportPicto-]");useActionButtonEulerian(yi)}ai.value.on("layerimport:vector:added",ui),ai.value.on("layerimport:service:added",di),ai.value.on("layerimport:mapbox:added",fi),ai.value.on("layerimport:compute:added",hi)}}),onBeforeUpdate(()=>{ii.visibility||si.removeControl(ai.value)}),onUpdated(()=>{if(ii.visibility){if(si.addControl(ai.value),ii.analytic){var yi=ai.value.element.querySelector("button[id^=GPshowImportPicto-]");useActionButtonEulerian(yi)}ai.value.on("layerimport:vector:added",ui),ai.value.on("layerimport:service:added",di),ai.value.on("layerimport:mapbox:added",fi),ai.value.on("layerimport:compute:added",hi)}});const oi=yi=>{ni.debug(yi),ei&&ei.value.openModalLogin(!0)},li=()=>{ti&&ti.value.openModalSave()},ci=yi=>{console.log("saveImportVector",yi);var _i={layer:yi.layer,content:yi.data,name:yi.name,description:"",format:yi.format.toLowerCase(),target:"internal",type:"import"},Ai=useCreateDocument(_i,e,n);Ai.then(Ei=>{var Si=n.find(Ei.uuid);if(Si){var wi=toShare(Si,{opacity:_i.layer.get("opacity"),visible:_i.layer.get("visible"),grayscale:_i.layer.get("grayscale"),stop:1});if(Ei.action==="added")ri.addBookmark(wi);else throw new Error("Action not yet implemented !")}}).then(()=>{ai.value.setCollapsed(!0)}).then(()=>{push$1.success({title:t.layerimport.title,message:t.layerimport.save_success})}).catch(Ei=>{console.error(Ei),push$1.error({title:t.layerimport.title,message:t.layerimport.save_failed})})},ui=yi=>{ni.debug(yi),n.authenticated?(ti.value.onDelegateCbk(()=>{ci(yi)}),n.authenticated&&li()):ri.noLoginInformation||oi(yi)},di=yi=>{if(ni.debug(yi),!!n.authenticated){var _i={};if(yi.format.toLowerCase()==="wmts"&&(_i=gi(yi.data)),yi.format.toLowerCase()==="wms"&&(_i=pi(yi.data)),yi.format.toLowerCase()==="wfs"){console.error("WFS not implemented !");return}if(!_i.url){push$1.error({title:t.layerimport.title,message:t.layerimport.add_failed_service(yi.format.toUpperCase())});return}var Ai={content:JSON.stringify(_i),name:_i.title||yi.name,description:_i.description,format:"json",type:"service",kind:_i.format.toLowerCase(),target:"external",layer:yi.layer};vi(Ai).then(Ei=>{var Si=n.find(Ei.uuid);if(Si){var wi=toShare(Si,{opacity:1,visible:!0,grayscale:!1,stop:1});ri.addBookmark(wi)}}).then(()=>{push$1.success({title:t.layerimport.title,message:t.layerimport.add_success_service(yi.format.toUpperCase())})}).catch(Ei=>{console.error(Ei),push$1.warning({title:t.layerimport.title,message:t.layerimport.add_failed_service(yi.format.toUpperCase())})})}},fi=yi=>{if(ni.debug(yi),!!n.authenticated){var _i={content:yi.data,name:yi.name,description:"Import Mapbox",format:"json",type:"service",kind:"mapbox",target:"internal",layer:yi.layer};vi(_i).then(Ai=>{var Ei=n.find(Ai.uuid);if(Ei){var Si=toShare(Ei,{opacity:1,visible:!0,grayscale:!1,stop:1});ri.addBookmark(Si)}}).then(()=>{push$1.success({title:t.layerimport.title,message:t.layerimport.add_success_mapbox})}).catch(Ai=>{console.error(Ai),push$1.warning({title:t.layerimport.title,message:t.layerimport.add_failed_mapbox})})}},hi=yi=>{ni.debug(yi)},pi=yi=>({url:yi.Url,format:"WMS",title:yi.Title,description:yi.Abstract,layers:[yi.Name],version:yi.Version,stylesName:yi.Style.map(_i=>_i.Name),queryable:yi.queryable,gfiFormat:"text/html",projection:yi.Projection}),gi=yi=>({url:yi.Url,format:"WMTS",version:yi.Version,layer:yi.Identifier,outputFormat:yi.Format[0],styleName:yi.Style[0].Identifier,tileMatrixSet:yi.TileMatrixSetLink[0].TileMatrixSet,topLeftCorner:{x:yi.Origin[0],y:yi.Origin[1]},resolutions:yi.Resolutions,matrixIds:yi.MatrixIds,title:yi.Title,description:yi.Abstract}),vi=async yi=>{try{const Ei=await n.setDocument(yi);var _i=Ei.uuid,Ai=Ei.action;const Si=await n.sharingDocument({uuid:_i,type:yi.type});return console.debug(Si),yi.layer.gpResultLayerId&&(yi.layer.gpResultLayerId=`bookmark:${yi.kind}:${_i}`),e.dispatchEvent("document:saved",{uuid:_i,action:Ai}),Ei}catch(Ei){throw console.error(Ei),Ei}};return(yi,_i)=>null}}),selectedControls=computed(()=>useMapStore().getControls()),_sfc_main$d={__name:"ControlList",props:{mapId:String,visibility:Boolean,analytic:Boolean,controlListOptions:Object},setup(_t){const e=_t;distExports$1.useLogger();const n=inject(e.mapId),ei=ref$1(new ControlList(e.controlListOptions));return watch(selectedControls,()=>{setTimeout(()=>{if(n.removeControl(ei.value),e.visibility&&(n.addControl(ei.value),e.analytic)){var ti=ei.value.element.querySelector("button[id^=GPshowControlListPicto-]");useActionButtonEulerian(ti)}},10)}),onMounted(()=>{if(e.visibility&&(n.addControl(ei.value),e.analytic)){var ti=ei.value.element.querySelector("button[id^=GPshowControlListPicto-]");useActionButtonEulerian(ti)}}),onBeforeUpdate(()=>{e.visibility||n.removeControl(ei.value)}),onUpdated(()=>{if(e.visibility&&(n.addControl(ei.value),e.analytic)){var ti=ei.value.element.querySelector("button[id^=GPshowControlListPicto-]");useActionButtonEulerian(ti)}}),(ti,ii)=>null}},_sfc_main$c={__name:"ContextMenu",props:{mapId:String,visibility:Boolean,analytic:Boolean,contextMenuOptions:Object},setup(_t){const e=_t,n=useMatchMedia("SM"),ei=inject(e.mapId),ti=ref$1(new ContextMenu(e.contextMenuOptions)),ii=ref$1([0,0]);onMounted(()=>{e.visibility&&(ei.addControl(ti.value),ti.value.contextmenu.on("open",ri),ei.on("singleclick",function(ni){const si=ni.pixel;si.value=[90,si[1]]}))}),onBeforeUpdate(()=>{e.visibility?ei.addControl(ti.value):ei.removeControl(ti.value)});const ri=()=>{n.value&&ti.value.contextmenu.updatePosition([90,ii[1]])};return(ni,si)=>null}},_sfc_main$b={__name:"FullScreen",props:{mapId:String,visibility:Boolean,analytic:Boolean,fullscreenOptions:Object},setup(_t){const e=_t,n=inject(e.mapId),ei=ref$1(new GeoportalFullScreen(e.fullscreenOptions));return onMounted(()=>{e.visibility&&n.addControl(ei.value)}),onBeforeUpdate(()=>{e.visibility?n.addControl(ei.value):n.removeControl(ei.value)}),(ti,ii)=>null}},_sfc_main$a={__name:"ReverseGeocode",props:{mapId:String,visibility:Boolean,analytic:Boolean,reverseGeocodeOptions:Object},setup(_t){const e=_t,n=distExports$1.useLogger();useDataStore();const ei=inject(e.mapId),ti=ref$1(new ReverseGeocode(e.reverseGeocodeOptions));onMounted(()=>{if(e.visibility&&(ei.addControl(ti.value),ti.value.on("reverseGeocode:onclickresult",ii),ti.value.on("reverseGeocode:compute",ri),e.analytic)){var ni=ti.value.element.querySelector("button[id^=GPshowReverseGeocodingPicto-]");useActionButtonEulerian(ni)}}),onBeforeUpdate(()=>{e.visibility||ei.removeControl(ti.value)}),onUpdated(()=>{if(e.visibility&&(ei.addControl(ti.value),e.analytic)){var ni=ti.value.element.querySelector("button[id^=GPshowReverseGeocodingPicto-]");useActionButtonEulerian(ni)}});const ii=ni=>{n.debug(ni)},ri=ni=>{n.debug(ni)};return(ni,si)=>null}},__default__$3={name:"ModalReportingSuccessSent"},_sfc_main$9=Object.assign(__default__$3,{setup(_t,{expose:e}){const n=inject("emitter"),ei=useEulerian();useRouter();const ti="Merci de contribuer  amliorer cartes.gouv.fr !",ii="fr-icon-feedback-line",ri=[{label:"Retour  la carte",onClick(){ni.value=!1,n.dispatchEvent("reporting:open:clicked",{open:!1,componentName:"Reporting"})}},{label:"Autre contribution",tertiary:!0,onClick(){ni.value=!1}}],ni=ref$1(!1),si=ref$1({display:"none"});ni.value&&ei.pause();const ai=li=>{si.value=li?{display:"block"}:{display:"none"},ni.value=!0,ei.pause()},oi=()=>{ni.value=!1,ei.resume()};return e({openModalReportingSent:ai,onModalReportingSentClose:oi}),(li,ci)=>{const ui=DsfrModal_default;return openBlock(),createBlock(ui,{opened:unref(ni),title:ti,size:"md",icon:ii,"is-alert":!0,actions:ri,onClose:oi},{default:withCtx(()=>[...ci[0]||(ci[0]=[createBaseVNode("p",null," Nous vous tiendrons inform par courriel de la prise en compte de votre signalement par nos quipes. ",-1)])]),_:1},8,["opened"])}}}),__default__$2={name:"ModalReportingStart"},_sfc_main$8=Object.assign(__default__$2,{setup(_t,{expose:e}){const n=inject("emitter"),ei=useEulerian(),ti=useMapStore(),ii=useDataStore(),ri=`${useBaseUrl()}/faq`,ni="Avant d'effectuer un signalement",si="fr-icon-feedback-line",ai=[{label:"J'ai compris",onClick(){ui()}},{label:"Afficher Plan IGN J+1",tertiary:!0,onClick(){ui();var di=ii.getLayerIdByName("GEOGRAPHICALGRIDSYSTEMS.MAPS.BDUNI.J1","WMTS");ti.addLayer(di)}}],oi=ref$1(!1),li=ref$1({display:"none"});oi.value&&ei.pause();const ci=di=>{li.value=di?{display:"block"}:{display:"none"},oi.value=!0,ei.pause()},ui=()=>{oi.value=!1,ei.resume(),n.dispatchEvent("reporting:open:clicked",{open:!0,componentName:"Reporting"})};return e({openModalReportingStart:ci,onModalReportingStartClose:ui}),(di,fi)=>{const hi=DsfrButtonGroup_default,pi=DsfrModal_default;return openBlock(),createBlock(pi,{id:"reporting-modal",opened:unref(oi),title:ni,size:"md",icon:si,"is-alert":!0,onClose:ui},{default:withCtx(()=>[createBaseVNode("p",null,[fi[0]||(fi[0]=createTextVNode(" Avant de dbuter, nous vous recommandons de prendre connaissance de notre ",-1)),createBaseVNode("a",{href:ri,target:"_blank"},"foire aux questions"),fi[1]||(fi[1]=createTextVNode(" ddie et d'afficher la carte la plus  jour, afin de vrifier que l'anomalie n'a pas dj t prise en compte. ",-1))])]),footer:withCtx(()=>[createVNode(hi,{align:"center",buttons:ai,"inline-layout-when":"large"})]),_:1},8,["opened"])}}});class MyServiceAction{constructor(){console.info("MyServiceAction constructor"),this.url=window.__ENV__.VITE_GPF_SERVICE_ANOMALY||"https://www.geoportail.gouv.fr/wp-json/wp/v2"}active(){console.info("MyServiceAction active")}disable(){console.info("MyServiceAction disable")}send(e){return console.info("MyServiceAction send"),this._send(e)}clear(){console.info("MyServiceAction clear")}async _send(e){console.info("MyServiceAction #send",e);var n=e.location.features[0].geometry.coordinates;e.location.crs.properties.name!=="EPSG::4326"&&(n=transform$1(e.location.features[0].geometry.coordinates,e.location.crs.properties.name,"EPSG:4326"));const ei=`https://cartes.gouv.fr/cartes?c=${n[0]},${n[1]}&p=${n[0]},${n[1]}&z=11&l=GEOGRAPHICALGRIDSYSTEMS.PLANIGNV2$GEOPORTAIL:OGC:WMTS(1;1;1;0)&w=OverviewMap,SearchEngine,ScaleLine,LayerSwitcher,GetFeatureInfo,Legends,Zoom,FullScreen,Share,Print,Territories,LayerImport,ControlList,ContextMenu&permalink=yes`,ti={name:e.name+" (Anomalie) (cartes.gouv.fr)",description:e.desc,theme:e.theme,permalink:ei,id_drawing:"",mail:e.mail};var ii=`
        <kml xmlns="http://www.opengis.net/kml/2.2" xmlns:gx="http://www.google.com/kml/ext/2.2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.opengis.net/kml/2.2 https://developers.google.com/kml/schema/kml22gx.xsd">
          <ExtendedData>
            <Data name="description">"Signalement (cartes.gouv.fr)"</Data>
          </ExtendedData>
          <Placemark>
            <name>Signalement</name>
            <Style>
              <IconStyle>
                <scale>0.03125</scale>
                <Icon>
                  <href>data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR4nGNiYAAAAAkAAxkR2eQAAAAASUVORK5CYII=</href>
                  <gx:w>1</gx:w>
                  <gx:h>1</gx:h>
                </Icon>
                <hotSpot x="0" y="1" xunits="pixels" yunits="pixels"/>
              </IconStyle>
              <LabelStyle>
                <color>ff000000</color>
                <LabelStyleSimpleExtensionGroup fontSize="16px" fontFamily="sans" haloColor="ffffffff" haloRadius="3" haloOpacity="1"/>
              </LabelStyle>
            </Style>
            <Point>
              <coordinates>${n[0]},${n[1]}</coordinates>
            </Point>
          </Placemark>
        </kml>`;const ni={drawing:{is_anomaly:1,kml:e.drawing||ii,layername:e.name,name:e.name}},ai=await(await fetch(this.url+"/drawing",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer undefined"},mode:"cors",credentials:"same-origin",body:JSON.stringify(ni)})).json();ti.id_drawing=ai.drawing[0].id;const oi={anomaly:ti};await fetch(this.url+"/anomaly",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer undefined"},mode:"cors",credentials:"same-origin",body:JSON.stringify(oi)})}}typeof window<"u"&&(window.MyServiceAction=MyServiceAction);const _sfc_main$7={__name:"Reporting",props:{mapId:String,visibility:Boolean,analytic:Boolean,reportingOptions:Object},setup(_t){const e=inject("emitter"),n=_t,ei=distExports$1.useLogger(),ti=inject(n.mapId),ii=ref$1(new Reporting(n.reportingOptions)),ri=ref$1({}),ni=ref$1({});e.addEventListener("reporting:open:clicked",ai=>{ii.value&&ii.value.setCollapsed(!ai.open)}),e.addEventListener("modalreporting:open:clicked",ai=>{ni.value.openModalReportingStart(!0)}),onMounted(()=>{if(n.visibility){if(ii.value.setComponentService(new MyServiceAction),ti.addControl(ii.value),n.analytic){var ai=ii.value.element.querySelector("button[id^=GPshowReportingPicto-]");useActionButtonEulerian(ai)}ii.value.on("reporting:sending",si)}}),onBeforeUpdate(()=>{n.visibility||ti.removeControl(ii.value)}),onUpdated(()=>{if(n.visibility){if(ii.value.setComponentService(new MyServiceAction),ti.addControl(ii.value),n.analytic){var ai=ii.value.element.querySelector("button[id^=GPshowReportingPicto-]");useActionButtonEulerian(ai)}ii.value.on("reporting:sending",si)}});const si=ai=>{ei.debug(ai),ri.value.openModalReportingSent()};return(ai,oi)=>(openBlock(),createElementBlock(Fragment,null,[createVNode(_sfc_main$9,{ref_key:"refModalReportingSent",ref:ri},null,512),createVNode(_sfc_main$8,{ref_key:"refModalReportingStart",ref:ni},null,512)],64))}},_sfc_main$6={__name:"CatalogManager",props:{mapId:{type:String,default:""},visibility:Boolean,analytic:Boolean,catalogManagerOptions:{type:Object,default:()=>({})}},setup(_t){const e=_t,n=distExports$1.useLogger(),ei=useDataStore(),ti=useMapStore(),ii=inject("emitter"),ri=inject(e.mapId),ni=ref$1(new Catalog(e.catalogManagerOptions));ii.addEventListener("catalog:open:clicked",()=>{if(ni.value){var li=ni.value.getCollapsed();ni.value.setCollapsed(!li)}}),onMounted(()=>{if(e.visibility){ri.addControl(ni.value),n.info("CatalogManager mounted",ni.value);var li=ni.value.element.querySelector("button[id^=GPshowCatalogPicto-]");li.classList.remove("fr-btn--tertiary"),li.classList.remove("gpf-btn--tertiary"),li.classList.remove("gpf-btn--icon"),li.classList.add("gpf-btn--primary"),e.analytic&&useActionButtonEulerian(li),ni.value.on("catalog:loaded",si),ni.value.on("catalog:layer:add",ai),ni.value.on("catalog:layer:remove",oi)}}),onBeforeUpdate(()=>{n.info("CatalogManager updated",ni.value),e.visibility||ri.removeControl(ni.value)}),onUpdated(()=>{if(e.visibility){if(ri.addControl(ni.value),n.info("CatalogManager updated",ni.value),e.analytic){var li=ni.value.element.querySelector("button[id^=GPshowCatalogPicto-]");useActionButtonEulerian(li)}ni.value.on("catalog:loaded",si),ni.value.on("catalog:layer:add",ai),ni.value.on("catalog:layer:remove",oi)}});const si=li=>{n.info("catalog:loaded",li)},ai=li=>{n.info("catalog:layer:add",li);var ci=ei.getLayerIdByName(li.name,li.service);ci&&ti.addLayer(ci)},oi=li=>{n.info("catalog:layer:remove",li);var ci=ei.getLayerIdByName(li.name,li.service);ci&&ti.removeLayer(ci)};return(li,ci)=>(openBlock(),createElementBlock("div"))}},IconGeolocationSVG="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2036'%20width='48'%20height='48'%3e%3cpath%20fill='%23000091'%20d='M18.364%203.636a9%209%200%200%201%200%2012.728L12%2022.728l-6.364-6.364A9%209%200%200%201%2018.364%203.636ZM12%208a2%202%200%201%200%200%204%202%202%200%200%200%200-4Z'/%3e%3c/svg%3e",__default__$1={name:"Controls"},_sfc_main$5=Object.assign(__default__$1,{props:{controlOptions:{type:Array,default:()=>[]},mapId:{type:String,default:""}},setup(_t){const e=inject("emitter");LoggerByDefault.enableAll(),window.LoggerUtils=LoggerByDefault;const n=_t;useMapStore();const ei=useDomStore(),ti=useDataStore();distExports$1.useLogger().debug(n.controlOptions);const ri={id:"1",collapsed:!1,collapsible:!1,returnTrueGeometry:!0,autocompleteOptions:{serviceOptions:{maximumResponses:10},prettifyResults:!0,maximumEntries:5},markerUrl:IconGeolocationSVG},ni={options:{id:"2",position:useControlsExtensionPosition().layerSwitcherOptions,collapsed:!0,panel:!0,counter:!0,allowEdit:!0,allowGrayScale:!0}},si={id:"3",position:useControlsExtensionPosition().legendsOptions,panel:!0,auto:!0,draggable:!1},ai={id:"4",units:"metric",bar:!1},oi={id:"5",position:useControlsExtensionPosition().territoriesOptions,panel:!0,title:"Slectionner un territoire",auto:!1,thumbnail:!1,reduce:!1,tiles:3,view:{active:!0,title:"Modifier les territoires",description:"Modifier la vue"}},li={id:"6",position:useControlsExtensionPosition().getFeatureInfoOptions,noDataMessage:"<h6 style='text-align: center;'> Pas d'infos disponibles </h6> <p style='text-align: center;'> Il n'y a pas de donnes interrogeables ici </p>"},ci={id:"7",collapsed:!1,position:useControlsExtensionPosition().overviewMapOptions,layers:[new LayerWMTS({layer:"GEOGRAPHICALGRIDSYSTEMS.PLANIGNV2",configuration:{...ti.getLayerByName("GEOGRAPHICALGRIDSYSTEMS.PLANIGNV2","WMTS"),params:ti.getLayerParamsByName("GEOGRAPHICALGRIDSYSTEMS.PLANIGNV2","WMTS")}})]},ui={id:"8",position:useControlsExtensionPosition().fullscreenOptions,source:"map-and-tools-container"},di={position:useControlsExtensionPosition().zoomOptions,id:"9"},fi={position:useControlsExtensionPosition().controlListOptions,id:"10",gutter:!1,controlCatalogElement:document.getElementById("MenuControl")},hi={id:"11",position:useControlsExtensionPosition().drawingOptions,gutter:!1,listable:!0,tools:{export:!1}},pi={id:"12",position:useControlsExtensionPosition().reverseGeocodeOptions,gutter:!1,listable:!0},gi={position:useControlsExtensionPosition().isocurveOptions,id:"13",gutter:!1,listable:!0},vi={position:useControlsExtensionPosition().routeOptions,id:"14",gutter:!1,listable:!0},yi={id:"15",position:useControlsExtensionPosition().measureLengthOptions,gutter:!1,listable:!0},_i={position:useControlsExtensionPosition().measureAreaOptions,id:"16",gutter:!1,listable:!0},Ai={position:useControlsExtensionPosition().measureAzimuthOptions,gutter:!1,listable:!0,id:"17"},Ei={position:useControlsExtensionPosition().mousePositionOptions,id:"18",gutter:!1,listable:!0,editCoordinates:!0,systems:[{label:"Gographique",crs:"EPSG:4326",type:"Geographical"},{label:"Web Mercator",crs:"EPSG:3857",type:"Metric"},{label:"Lambert 93",crs:"EPSG:2154",type:"Metric",geoBBox:{left:-9.86,bottom:41.15,right:10.38,top:51.56}},{label:"Lambert II tendu",crs:"EPSG:27572",type:"Metric",geoBBox:{left:-4.87,bottom:42.33,right:8.23,top:51.14}},{crs:"EPSG:32620",label:"UTM 20N (Guadeloupe, Martinique)",type:"Metric",geoBBox:{left:-66,bottom:0,right:-60,top:84}},{crs:"EPSG:4467",label:"UTM 21N (Saint-Pierre-et-Miquelon)",type:"Metric",geoBBox:{left:-57.1,bottom:43.41,right:-55.9,top:47.37}},{crs:"EPSG:2972",label:"UTM 22N (Guyane)",type:"Metric",geoBBox:{left:-54.6,bottom:2.11,right:-49.46,top:8.88}},{crs:"EPSG:32630",label:"UTM 30N (France mtropolitaine)",type:"Metric",geoBBox:{left:-6,bottom:0,right:0,top:84}},{crs:"EPSG:32631",label:"UTM 31N (France mtropolitaine)",type:"Metric",geoBBox:{left:0,bottom:0,right:6,top:84}},{crs:"EPSG:32632",label:"UTM 32N (France mtropolitaine)",type:"Metric",geoBBox:{left:6,bottom:0,right:12,top:84}},{crs:"EPSG:4471",label:"UTM 38S (Mayotte)",type:"Metric",geoBBox:{left:43.68,bottom:-14.49,right:46.7,top:-11.33}},{crs:"EPSG:2975",label:"UTM 40S (Runion)",type:"Metric",geoBBox:{left:51.83,bottom:-24.72,right:58.24,top:-18.28}},{crs:"EPSG:3296",label:"UTM 5S (Polynsie)",type:"Metric",geoBBox:{left:-158.13,bottom:-26.7,right:-150,top:-12.5}},{crs:"EPSG:3297",label:"UTM 6S (Polynsie)",type:"Metric",geoBBox:{left:-150,bottom:-31.2,right:-144,top:-7.29}},{crs:"EPSG:32707",label:"UTM 7S (Polynsie)",type:"Metric",geoBBox:{left:-144,bottom:-80,right:-138,top:0}},{crs:"EPSG:32708",label:"UTM 8S (Polynsie)",type:"Metric",geoBBox:{left:-138,bottom:-80,right:-132,top:0}},{crs:"EPSG:26912",label:"UTM 12N (le de Clipperton)",type:"Metric",geoBBox:{left:-109.5,bottom:10.17,right:-109,top:10.5}},{crs:"EPSG:32742",label:"UTM 42S (les Kerguelen)",type:"Metric",geoBBox:{left:66,bottom:-80,right:72,top:0}},{crs:"EPSG:32739",label:"UTM 39S (les Crozet)",type:"Metric",geoBBox:{left:48,bottom:-80,right:54,top:0}},{crs:"EPSG:32743",label:"UTM 43S (les St-Paul et Amsterdam)",type:"Metric",geoBBox:{left:72,bottom:-80,right:78,top:0}},{crs:"EPSG:2986",label:"Strographique polaire (Terre Adlie)",type:"Metric",geoBBox:{left:136,bottom:-67.13,right:142,top:-65.61}},{crs:"EPSG:32737",label:"UTM 37S (les du canal de Mozambique)",type:"Metric",geoBBox:{left:36,bottom:-80,right:42,top:0}},{crs:"EPSG:32738",label:"UTM 38S (les du canal de Mozambique)",type:"Metric",geoBBox:{left:42,bottom:-80,right:48,top:0}},{crs:"EPSG:2988",label:"UTM 1S (Wallis-et-Futuna)",type:"Metric",geoBBox:{left:-176.25,bottom:-13.41,right:-176.07,top:-13.16}},{crs:"EPSG:3163",label:"RGNC91-93 (Nouvelle-Caldonie)",type:"Metric",geoBBox:{left:156.25,bottom:-26.45,right:174.28,top:-14.83}}]},Si={id:"19",position:useControlsExtensionPosition().elevationPathOptions,gutter:!1,listable:!0},wi={id:"20",position:useControlsExtensionPosition().layerImportOptions,gutter:!1,listable:!0},Oi={id:"21",position:useControlsExtensionPosition().reportingOptions,gutter:!1,listable:!0,format:"kml"},Ii={id:"22",position:useControlsExtensionPosition().catalogOptions,gutter:!1,listable:!1,titlePrimary:"Catalogue de cartes",layerLabel:"title",layerThumbnail:!0,size:"xl",tabHeightAuto:!1,addToMap:!1,optimisation:"on-demand",search:{display:!1,criteria:["name","title","description"]},categories:[{title:"Cartes de rfrence",id:"base",order:!1,featured:!0,filter:{field:"base",value:"true"}},{title:"Toutes les cartes",id:"data",search:!0,items:[{title:"Thme",default:!0,order:!0,section:!0,icon:!0,filter:{field:"thematic",value:"*"}},{title:"Producteur",order:!0,section:!0,icon:!1,filter:{field:"producer",value:"*"}}]}],configuration:{type:"json",data:{layers:ti.getLayers(),topics:ti.getTopics(),featured:ti.getFeatured()}}},Li=computed(()=>({contextMenuItemsOptions:[{text:"Signaler une anomalie",callback:()=>{setTimeout(()=>{e.dispatchEvent("modalreporting:open:clicked",{open:!0,componentName:"ModalReportingStart"}),e.dispatchEvent("leftmenu:close",{open:!1,componentName:"ContextMenu"})},0)}}]}));e.addEventListener("printmodal:open",Ni);const Di=ref$1(null);function Ni(){Di.value.onModalPrintOpen()}return onMounted(()=>{ei.setleftControlMenu(document.getElementById("position-container-bottom-left")),ei.setrightControlMenu(document.getElementById("position-container-top-right"))}),($i,Ki)=>{const er=__unplugin_components_0;return openBlock(),createElementBlock(Fragment,null,[createVNode(_sfc_main$6,{visibility:!0,analytic:!1,"catalog-manager-options":Ii,"map-id":_t.mapId},null,8,["map-id"]),_t.controlOptions?(openBlock(),createBlock(_sfc_main$q,{key:0,visibility:n.controlOptions.includes(unref(useControls).LayerSwitcher.id),analytic:unref(useControls).LayerSwitcher.analytic,"layer-switcher-options":ni,"map-id":_t.mapId},null,8,["visibility","analytic","map-id"])):createCommentVNode("",!0),_t.controlOptions?(openBlock(),createBlock(_sfc_main$p,{key:1,visibility:n.controlOptions.includes(unref(useControls).Legends.id),analytic:unref(useControls).Legends.analytic,"legends-options":si,"map-id":_t.mapId},null,8,["visibility","analytic","map-id"])):createCommentVNode("",!0),_t.controlOptions?(openBlock(),createBlock(_sfc_main$m,{key:2,visibility:n.controlOptions.includes(unref(useControls).Route.id),analytic:unref(useControls).Route.analytic,"route-options":vi,"map-id":_t.mapId},null,8,["visibility","analytic","map-id"])):createCommentVNode("",!0),_t.controlOptions?(openBlock(),createBlock(_sfc_main$n,{key:3,visibility:n.controlOptions.includes(unref(useControls).Isocurve.id),analytic:unref(useControls).Isocurve.analytic,"isocurve-options":gi,"map-id":_t.mapId},null,8,["visibility","analytic","map-id"])):createCommentVNode("",!0),_t.controlOptions?(openBlock(),createBlock(_sfc_main$a,{key:4,visibility:n.controlOptions.includes(unref(useControls).ReverseGeocode.id),analytic:unref(useControls).ReverseGeocode.analytic,"reverse-geocode-options":pi,"map-id":_t.mapId},null,8,["visibility","analytic","map-id"])):createCommentVNode("",!0),_t.controlOptions?(openBlock(),createBlock(_sfc_main$b,{key:5,visibility:n.controlOptions.includes(unref(useControls).FullScreen.id),analytic:unref(useControls).FullScreen.analytic,"fullscreen-options":ui,"map-id":_t.mapId},null,8,["visibility","analytic","map-id"])):createCommentVNode("",!0),_t.controlOptions?(openBlock(),createBlock(_sfc_main$r,{key:6,visibility:n.controlOptions.includes(unref(useControls).Zoom.id),analytic:unref(useControls).Zoom.analytic,"zoom-options":di,"map-id":_t.mapId},null,8,["visibility","analytic","map-id"])):createCommentVNode("",!0),_t.controlOptions?(openBlock(),createBlock(_sfc_main$t,{key:7,visibility:n.controlOptions.includes(unref(useControls).SearchEngine.id),analytic:unref(useControls).SearchEngine.analytic,"search-engine-options":ri,"map-id":_t.mapId},null,8,["visibility","analytic","map-id"])):createCommentVNode("",!0),_t.controlOptions?(openBlock(),createBlock(_sfc_main$f,{key:8,visibility:n.controlOptions.includes(unref(useControls).GetFeatureInfo.id),analytic:unref(useControls).GetFeatureInfo.analytic,"get-feature-info-options":li,"map-id":_t.mapId},null,8,["visibility","analytic","map-id"])):createCommentVNode("",!0),_t.controlOptions?(openBlock(),createBlock(_sfc_main$w,{key:9,visibility:n.controlOptions.includes(unref(useControls).ScaleLine.id),analytic:unref(useControls).ScaleLine.analytic,"scale-line-options":ai,"map-id":_t.mapId},null,8,["visibility","analytic","map-id"])):createCommentVNode("",!0),_t.controlOptions?(openBlock(),createBlock(_sfc_main$s,{key:10,visibility:n.controlOptions.includes(unref(useControls).OverviewMap.id),analytic:unref(useControls).OverviewMap.analytic,"overview-map-options":ci,"map-id":_t.mapId},null,8,["visibility","analytic","map-id"])):createCommentVNode("",!0),_t.controlOptions?(openBlock(),createBlock(_sfc_main$g,{key:11,visibility:n.controlOptions.includes(unref(useControls).Territories.id),analytic:unref(useControls).Territories.analytic,"territories-options":oi,"map-id":_t.mapId},null,8,["visibility","analytic","map-id"])):createCommentVNode("",!0),_t.controlOptions?(openBlock(),createBlock(_sfc_main$l,{key:12,visibility:n.controlOptions.includes(unref(useControls).MeasureLength.id),analytic:unref(useControls).MeasureLength.analytic,"measure-length-options":yi,"map-id":_t.mapId},null,8,["visibility","analytic","map-id"])):createCommentVNode("",!0),_t.controlOptions?(openBlock(),createBlock(_sfc_main$k,{key:13,visibility:n.controlOptions.includes(unref(useControls).MeasureArea.id),analytic:unref(useControls).MeasureArea.analytic,"measure-area-options":_i,"map-id":_t.mapId},null,8,["visibility","analytic","map-id"])):createCommentVNode("",!0),_t.controlOptions?(openBlock(),createBlock(_sfc_main$j,{key:14,visibility:n.controlOptions.includes(unref(useControls).MeasureAzimuth.id),analytic:unref(useControls).MeasureAzimuth.analytic,"measure-azimuth-options":Ai,"map-id":_t.mapId},null,8,["visibility","analytic","map-id"])):createCommentVNode("",!0),_t.controlOptions?(openBlock(),createBlock(_sfc_main$i,{key:15,visibility:n.controlOptions.includes(unref(useControls).MousePosition.id),analytic:unref(useControls).MousePosition.analytic,"mouse-position-options":Ei,"map-id":_t.mapId},null,8,["visibility","analytic","map-id"])):createCommentVNode("",!0),_t.controlOptions?(openBlock(),createBlock(_sfc_main$o,{key:16,visibility:n.controlOptions.includes(unref(useControls).Drawing.id),analytic:unref(useControls).Drawing.analytic,"drawing-options":hi,"map-id":_t.mapId},null,8,["visibility","analytic","map-id"])):createCommentVNode("",!0),_t.controlOptions?(openBlock(),createBlock(_sfc_main$h,{key:17,visibility:n.controlOptions.includes(unref(useControls).ElevationPath.id),analytic:unref(useControls).ElevationPath.analytic,"elevation-path-options":Si,"map-id":_t.mapId},null,8,["visibility","analytic","map-id"])):createCommentVNode("",!0),_t.controlOptions?(openBlock(),createBlock(_sfc_main$e,{key:18,visibility:n.controlOptions.includes(unref(useControls).LayerImport.id),analytic:unref(useControls).LayerImport.analytic,"layer-import-options":wi,"map-id":_t.mapId},null,8,["visibility","analytic","map-id"])):createCommentVNode("",!0),_t.controlOptions?(openBlock(),createBlock(_sfc_main$d,{key:19,visibility:n.controlOptions.includes(unref(useControls).ControlList.id),analytic:unref(useControls).ControlList.analytic,"control-list-options":fi,"map-id":_t.mapId},null,8,["visibility","analytic","map-id"])):createCommentVNode("",!0),_t.controlOptions?(openBlock(),createBlock(_sfc_main$c,{key:20,visibility:n.controlOptions.includes(unref(useControls).ContextMenu.id),analytic:unref(useControls).ContextMenu.analytic,"context-menu-options":unref(Li),"map-id":_t.mapId},null,8,["visibility","analytic","context-menu-options","map-id"])):createCommentVNode("",!0),_t.controlOptions?(openBlock(),createBlock(_sfc_main$7,{key:21,visibility:n.controlOptions.includes(unref(useControls).Reporting.id),analytic:unref(useControls).Reporting.analytic,"reporting-options":Oi,"map-id":_t.mapId},null,8,["visibility","analytic","map-id"])):createCommentVNode("",!0),createVNode(er,{ref_key:"refModalPrint",ref:Di},null,512)],64)}}}),DEFAULT_STYLE=new Style$1({image:new Icon({src:Marker.lightOrange,anchor:[25.5,38],anchorOrigin:"top-left",anchorXUnits:"pixels",anchorYUnits:"pixels"}),stroke:new Stroke({color:"rgba(0,42,80,0.8)",width:4}),fill:new Fill({color:"rgba(0, 183, 152, 0.5)"}),text:new Text({font:"16px Sans",textAlign:"left",fill:new Fill({color:"rgba(255, 255, 255, 1)"}),stroke:new Stroke({color:"rgba(0, 0, 0, 1)",width:2})})}),createVectorLayer=_t=>{try{var e=null,n=null,ei=null,ti=_t.extended===void 0?!0:_t.extended;switch(_t.format.toLowerCase()){case"geojson":e=new GeoJSON$1,ti&&(e=new GeoJSON({defaultStyle:DEFAULT_STYLE}));break;case"kml":e=new KML$1,ti&&(e=new KML({defaultStyle:DEFAULT_STYLE}));break;case"gpx":e=new GPX$1,ti&&(e=new GPX({defaultStyle:DEFAULT_STYLE,readExtensions:function(ii,ri){this.readExtensions(ii,ri)}}));break;default:break}if(!e)throw new Error(t.ol.failed_format(_t.format));if(_t.data){const ii=e.readProjection(_t.data);n=new VectorSource({features:e.readFeatures(_t.data,{dataProjection:ii,featureProjection:"EPSG:3857"})})}if(_t.url&&(n=new VectorSource({format:e,url:_t.url})),!n)throw new Error(t.ol.failed_source("vecteur"));if(n._title=_t.name,n._description=_t.description,ei=new VectorLayer({source:n,visible:getVisible(_t.visible),opacity:getOpacity(_t.opacity)}),!ei)throw new Error(t.ol.failed_layer("vecteur"));return ei.gpResultLayerId="bookmark:"+_t.type+"-"+_t.format.toLowerCase()+":"+_t.id,ei.set("permalink",_t.permalink||!1),Promise.resolve(ei)}catch(ii){return Promise.reject(ii)}},createComputeLayer=_t=>{try{var e=null,n=null,ei=null;e=new GeoJSON$1;var ti=_t.extended===void 0?!0:_t.extended;if(ti&&(e=new GeoJSON({defaultStyle:DEFAULT_STYLE})),!e)throw new Error(t.ol.failed_format(_t.format));if(_t.data){const ni=e.readProjection(_t.data);n=new VectorSource({features:e.readFeatures(_t.data,{dataProjection:ni,featureProjection:"EPSG:3857"})})}if(_t.url&&(n=new VectorSource({format:e,loader:function(ni,si,ai,oi,li){const ci=ai.getCode(),ui=new XMLHttpRequest;ui.open("GET",_t.url);const di=function(){n.removeLoadedExtent(ni),li()};ui.onerror=di,ui.onload=function(){if(ui.status===200){var fi=e.readProjection(ui.responseText);const hi=e.readFeatures(ui.responseText,{dataProjection:fi,featureProjection:ci});n.addFeatures(hi),oi(hi)}else di()},ui.send()}})),!n)throw new Error(t.ol.failed_source("compute"));if(n._title=_t.name,n._description=_t.description,ei=new VectorLayer({source:n,visible:getVisible(_t.visible),opacity:getOpacity(_t.opacity)}),!ei)throw new Error(t.ol.failed_layer("compute"));ei.gpResultLayerId="bookmark:"+_t.type+"-"+_t.compute.toLowerCase()+":"+_t.id;const ii=()=>{throw new Error(t.ol.failed_layer("compute"))},ri=ni=>{var si=e.readRootExtensions("geoportail:compute");if(!si||Object.keys(si).length===0)throw new Error(t.ol.failed_layer("compute"));ei.set("control",_t.compute),ei.set("data",si);var ai=new GeoJSON({defaultStyle:DEFAULT_STYLE}),oi=ai.writeFeatures(ni.features,{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"});ei.set("geojson",oi)};return ei.getSource().once("featuresloadend",ri),ei.getSource().once("featuresloaderror",ii),Promise.resolve(ei)}catch(ii){return Promise.reject(ii)}},createServiceLayer=_t=>{var e=ei=>{var ti=null;if(typeof ei.data=="string"&&(ei.data=JSON.parse(ei.data)),ei.kind==="wmts"){const ni=new WMTSTileGrid({origin:[ei.data.topLeftCorner.x,ei.data.topLeftCorner.y],resolutions:ei.data.resolutions,matrixIds:ei.data.matrixIds});var ii=new WMTS$1({url:ei.data.url,version:ei.data.version,layer:ei.data.layer,matrixSet:ei.data.tileMatrixSet,format:ei.data.outputFormat,projection:"EPSG:3857",tileGrid:ni,style:ei.data.styleName,attributions:""});if(!ii)throw new Error(t.ol.failed_source("service wmts"));if(ii._title=ei.data.name||ei.name,ii._description=ei.data.description||ei.description,ti=new TileLayer({source:ii}),!ti)throw new Error(t.ol.failed_layer("service wmts"))}else if(ei.kind==="wms"){var ri=new TileWMS({url:ei.data.url,params:{LAYERS:ei.data.layers,SERVICE:ei.data.format,VERSION:ei.data.version,STYLES:ei.data.stylesName},projection:ei.data.projection||"EPSG:3857",attributions:""});if(!ri)throw new Error(t.ol.failed_source("service wms"));if(ri._title=ei.data.name||ei.name,ri._description=ei.data.description||ei.description,ti=new TileLayer({source:ri}),!ti)throw new Error(t.ol.failed_layer("service wms"));ti.gpGFIparams={queryable:ei.data.queryable,formats:ei.data.gfiFormat}}else throw new Error(t.ol.failed_source("service non reconnu"));if(ti&&!ti.getExtent()){const ni=get$3("EPSG:3857");ti.setExtent(ni.getExtent())}return ti&&(ti.gpResultLayerId="bookmark:"+ei.kind.toLowerCase()+":"+ei.id),ti.setVisible(getVisible(ei.visible)),ti.setOpacity(getOpacity(ei.opacity)),ti};if(_t.url)return fetch(_t.url).then(ei=>{if(ei.ok)return ei.json().then(ti=>e({..._t,data:ti})).catch(ti=>{throw ti})}).catch(ei=>{throw ei});if(_t.data)try{var n=e(_t);return Promise.resolve(n)}catch(ei){return Promise.reject(ei)}},createMapBoxLayer=_t=>{const e=ei=>{var ti=null,ii=ei.data,ri=ii.sources,ni=Object.keys(ri)[0],si=ri[ni],ai=si.type;if(ai==="vector"){var oi=si.tiles;if(!oi)throw new Error("Source 'tiles' uniquement !");var li=new MVT({featureClass:Feature}),ci=new VectorTile({state:"loading",attributions:"",format:li,urls:oi});ci._title=ei.name,ci._description=ei.description,ti=new VectorTileLayer({source:ci,visible:!1,declutter:!0}),ti.gpResultLayerId="bookmark:"+ei.format.toLowerCase()+":"+ei.id,ti.styleUrl=ei.url;var ui=()=>{applyStyle(ti,ii,{source:ni}).then(()=>{ti.getSource().setState("ready"),ti.set("mapbox-styles",ii)}).then(()=>{ti.setVisible(getVisible(ei.visible)),ti.setOpacity(getOpacity(ei.opacity))}).catch(di=>{throw di})};ti.getSource()?ui():ti.once("change:source",ui)}else throw new Error("Type 'vector' uniquement !");return ti};if(_t.url)return fetch(_t.url).then(ei=>{if(ei.ok)return ei.json().then(ti=>e({..._t,data:ti})).catch(ti=>{throw ti})}).catch(ei=>{throw ei});if(_t.data)try{var n=e(_t);return Promise.resolve(n)}catch(ei){return Promise.reject(ei)}},getVisible=_t=>{var e=_t===void 0?!0:_t;return typeof e=="string"&&(e==="true"?e=!0:e==="false"?e=!1:e=!0),e},getOpacity=_t=>{var e=_t===void 0?1:_t;return typeof e=="string"&&(e=parseFloat(e)),isNaN(e)&&(e=1),e<0&&(e=0),e>1&&(e=1),e},_sfc_main$4={__name:"Layer",props:{layerOptions:{type:Object,default:()=>({})},mapId:{type:String,default:""}},emits:["mounted","unmounted"],setup(_t,{emit:e}){const n=_t,ei=distExports$1.useLogger();ei.debug(n.layerOptions);const ti=useDataStore(),ii=useMapStore(),ri=e,ni=inject(n.mapId);var si=null;return onMounted(()=>{if(!n.layerOptions||Object.keys(n.layerOptions).length===0)return;const ai=n.layerOptions.service,oi=n.layerOptions.name,li=n.layerOptions.position;if(oi&&ai){var ci=ti.getLayerByName(n.layerOptions.name,n.layerOptions.service),ui=ti.getLayerParamsByName(n.layerOptions.name,n.layerOptions.service);ci.params=ui;var di={position:n.layerOptions.position,visible:n.layerOptions.visible,opacity:n.layerOptions.opacity,grayscale:n.layerOptions.grayscale,sourceParams:{crossOrigin:"anonymous"},permalink:n.layerOptions.permalink||!1},fi={preload:1/0,cacheSize:1024};switch(ei.debug("layer to add (catalog)",oi,ai,di,ci),ai){case"WMS":si=new LayerWMS({layer:oi,configuration:ci,apiKey:"entree-carto",olParams:Object.assign(di,fi)});break;case"WMTS":si=new LayerWMTS({layer:oi,configuration:ci,apiKey:"entree-carto",olParams:Object.assign(di,fi)});break;case"TMS":di.declutter=!0,di.styleName=n.layerOptions.style||"default",si=new LayerMapBox({layer:oi,style:n.layerOptions.style,configuration:ci,apiKey:"entree-carto"},di);break}si&&(ei.debug(oi,"| position (props - zindex)",li,si.getZIndex()),li!==si.getZIndex()&&(li===-1?ei.debug(oi,"| position auto"):(ei.debug(oi,"| change position",li),si.setZIndex(Number(li)))),ni.addLayer(si),ri("mounted"))}const hi=n.layerOptions.url,pi=n.layerOptions.format;if(hi&&pi){var gi=null;const yi=n.layerOptions.type.toLowerCase();switch(ei.debug("layer to add (bookmark)",oi,yi,pi),yi){case"service":var vi=n.layerOptions.kind.toLowerCase();if(vi==="mapbox")gi=createMapBoxLayer(n.layerOptions);else if(vi==="wmts"||vi==="wms")gi=createServiceLayer(n.layerOptions);else throw new Error("Le service est inconnu !");break;case"carte":throw"Not yet implemented !";case"compute":gi=createComputeLayer(n.layerOptions);break;case"import":pi.toLowerCase()==="mapbox"?gi=createMapBoxLayer(n.layerOptions):gi=createVectorLayer(n.layerOptions);break;case"drawing":gi=createVectorLayer(n.layerOptions);break}gi&&gi.then(_i=>(ni.addLayer(_i),_i)).then(_i=>(ei.debug(oi,"| position (props - zindex)",li,_i.getZIndex()),li!==_i.getZIndex()&&(li===-1?ei.debug(oi,"| position auto"):(ei.debug(oi,"| change position",li),_i.setZIndex(Number(li)))),_i)).then(_i=>{si=_i}).then(()=>{ri("mounted")}).then(()=>{if(!ii.isPermalink){var _i=si.getSource();if(ni.getView()&&ni.getSize()){var Ai=null;_i&&_i.getExtent?Ai=_i.getExtent():_i&&_i.getTileGrid&&(Ai=_i.getTileGrid().getExtent()),Ai&&Ai[0]!==1/0?ni.getView().fit(Ai,ni.getSize()):si.once("change",()=>{si.getSource().getExtent()&&ni.getView().fit(si.getSource().getExtent(),ni.getSize())})}}}).catch(_i=>{throw _i})}}),onUnmounted(()=>{ni&&si&&(ni.removeLayer(si),ri("unmounted"))}),(ai,oi)=>(openBlock(),createElementBlock("div",null,[renderSlot(ai.$slots,"default")]))}},addPermalink=()=>{const _t=new URLSearchParams(window.location.search);_t.set("permalink","yes");var e=`${window.location.pathname}?${_t.toString()}`;window.history.pushState({},"",e)},removePermalink=()=>{const _t=new URLSearchParams(window.location.search);_t.delete("permalink");const e=_t.toString()?`${window.location.pathname}?${_t.toString()}`:window.location.pathname;window.history.pushState({},"",e)},getLayersFromPermalink=_t=>{const e=useMapStore();addPermalink();var n=useUrlParams(_t);for(const ei in n)if(Object.prototype.hasOwnProperty.call(n,ei)){const ti=n[ei];if(ei==="permalink"||ei==="center")continue;e[ei]=ti}setTimeout(()=>{var ei=e.map;ei.getView().setZoom(e.zoom),ei.getView().setCenter([e.x,e.y])},100)},_sfc_main$3={__name:"Layers",props:{selectedLayers:{type:Object,default:()=>({})},selectedBookmarks:{type:Object,default:()=>({})},mapId:{type:String,default:""}},setup(_t){const e=_t,n=distExports$1.useLogger();var ei=computed(()=>toRaw(e.selectedLayers).map(ni=>{n.debug(ni.name,ni.position);var si={name:ni.name,service:ni.service||ni.serviceParams.id.split(":")[1],key:ni.key,position:Object.prototype.hasOwnProperty.call(ni,"position")?ni.position:-1,opacity:Object.prototype.hasOwnProperty.call(ni,"opacity")?ni.opacity:1,visible:Object.prototype.hasOwnProperty.call(ni,"visible")?ni.visible:!0,grayscale:Object.prototype.hasOwnProperty.call(ni,"grayscale")?ni.grayscale:!1};return Object.prototype.hasOwnProperty.call(ni,"style")&&(si.style=ni.style),si})),ti=computed(()=>toRaw(e.selectedBookmarks).map(ni=>(n.debug(ni.name,ni.position),{position:Object.prototype.hasOwnProperty.call(ni,"position")?ni.position:-1,opacity:Object.prototype.hasOwnProperty.call(ni,"opacity")?ni.opacity:1,visible:Object.prototype.hasOwnProperty.call(ni,"visible")?ni.visible:!0,grayscale:Object.prototype.hasOwnProperty.call(ni,"grayscale")?ni.grayscale:!1,...ni})));function ii(ni,si){var ai=[...ei.value,...ti.value];n.debug(`Layer mounted : ${ni.name} (${si} / ${ai.length-1})`),ai.length-1===si&&setTimeout(()=>{n.debug(`Layer last : ${ni.name} (${si})`),removePermalink()})}function ri(ni,si){n.debug(`Layer unmounted : ${ni.name} (${si})`)}return(ni,si)=>(openBlock(!0),createElementBlock(Fragment,null,renderList([...unref(ei),...unref(ti)],(ai,oi)=>(openBlock(),createBlock(_sfc_main$4,{key:ai.key,"layer-options":ai,"map-id":_t.mapId,onMounted:li=>ii(ai,oi),onUnmounted:li=>ri(ai,oi)},null,8,["layer-options","map-id","onMounted","onUnmounted"]))),128))}},__default__={name:"Carto"},_sfc_main$2=Object.assign(__default__,{props:{selectedControls:{type:Array,default:()=>[]},selectedLayers:{type:Object,default:()=>({})},selectedBookmarks:{type:Object,default:()=>({})}},setup(_t){const e=_t,n=useMapStore(),ei=ref$1(null),ti=computed(()=>ei.value&&ei.value.mapRef);return(ii,ri)=>(openBlock(),createBlock(_sfc_main$y,{ref_key:"refMap",ref:ei,class:"map","map-id":unref(mainMap)},{default:withCtx(()=>[createVNode(_sfc_main$x,{"map-id":unref(mainMap),center:unref(n).center,zoom:unref(n).zoom},null,8,["map-id","center","zoom"]),unref(ti)?(openBlock(),createBlock(_sfc_main$5,{key:0,"control-options":e.selectedControls,"map-id":unref(mainMap)},null,8,["control-options","map-id"])):createCommentVNode("",!0),createVNode(_sfc_main$3,{"map-id":unref(mainMap),"selected-layers":e.selectedLayers,"selected-bookmarks":e.selectedBookmarks},null,8,["map-id","selected-layers","selected-bookmarks"])]),_:1},8,["map-id"]))}}),Carto=_export_sfc(_sfc_main$2,[["__scopeId","data-v-b3f3d060"]]),_sfc_main$1={},_hoisted_1={class:"loader"};function _sfc_render(_t,e){return openBlock(),createElementBlock("span",_hoisted_1)}const Patience=_export_sfc(_sfc_main$1,[["render",_sfc_render],["__scopeId","data-v-1ebaa4fc"]]),_sfc_main={__name:"StoreData",props:{},async setup(_t){let e,n;const ei=distExports$1.useLogger(),ti=useDataStore(),{fetchData:ii}=ti,ri=([e,n]=withAsyncContext(()=>ii()),e=await e,n(),e);return ei.debug(ri),(ni,si)=>unref(ti).isLoaded&&!unref(ti).error?renderSlot(ni.$slots,"default",{key:0}):createCommentVNode("",!0)}};export{Carto as C,Patience as P,_sfc_main as _,toShare as a,_typeof as b,fromShare as f,getLayersFromPermalink as g,t,useDataStore as u};
//# sourceMappingURL=StoreData-c4rhttj9.js.map
