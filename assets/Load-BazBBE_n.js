import{t as V,g as Se,a as we,u as se,C as Be,f as xe,_ as De,P as Ee}from"./StoreData-CDOvNxmR.js";import{_ as N,a as Ve,b as v,c as W,d as ve,e as E,f as le,o as y,h as B,i as s,r as oe,w as Ie,v as Ae,j as p,k as w,l as P,n as q,D as K,m as Q,p as re,q as M,s as te,t as z,x as T,y as ke,z as Te,A as H,B as _e,C as j,E as ae,F as ge,G as be,H as ie,I as ce,J as G,K as I,L as de,M as J,N as ye,O as Ne,P as X,Q as Pe,R as ne,S as he,V as Ce,T as Re,U as je,W as ze,X as Z,Y as Me,Z as Ue,$ as We,a0 as ee,a1 as Ge,a2 as He,a3 as ue,a4 as qe,a5 as Fe,a6 as Je,a7 as $e,a8 as Ke,a9 as Y,aa as Qe,ab as Xe}from"./index-DdtqZ2Z0.js";const Ye={class:"menu-content-list"},Ze={class:"menu-collapse-icon-wrapper"},et={class:"menu-content"},tt={name:"MenuLateralWrapper"},nt=Object.assign(tt,{props:re({side:String,visibility:Boolean,id:String,width:Number,padding:Number},{modelValue:!1,modelModifiers:{}}),emits:["update:modelValue"],setup(c,{expose:k}){Ve(b=>({v86a6c710:v(e)?"0px":"4px",v2a3df43b:v(C),v61b35187:v($),v72bcafbe:v(g)}));const r=W(),l=ve().right,e=E(()=>r.getControls().filter(b=>l.includes(b)).length>3),d=c,a="fr-icon-close-line",i=d.width||550,t=d.padding||30,o=le(c,"modelValue",!1),_=M(i),L=M(t),C=E(()=>_.value+"px"),$=E(()=>L.value+"px"),g=E(()=>_.value-L.value+"px"),u=M();function O(){o.value=!1}function S(){const b=document.querySelector(".gp-label-div button.GPpanelClose");b&&b.click();const m=document.querySelector(".gp-styling-div button.GPpanelClose");m&&m.click(),o.value=!0}return k({widthMenu:_,closeMenu:O,openMenu:S}),(b,m)=>{const h=K;return c.visibility?(y(),B("div",{key:0,class:q(["menu-toggle-wrap",`${o.value&&"is_expanded"} ${d.side}`])},[s("div",{ref_key:"menuTabs",ref:u,class:"menu-logo-list"},[oe(b.$slots,"navButtons",{},void 0,!0)],512),Ie(s("div",Ye,[s("div",Ze,[p(h,{id:d.id,tertiary:"","no-outline":"",class:"menu-collapse-icon",onClick:O},{default:w(()=>[m[0]||(m[0]=P(" Fermer ",-1)),s("span",{class:q(a),"aria-hidden":"true"})]),_:1},8,["id"])]),s("div",et,[oe(b.$slots,"content",{},void 0,!0)])],512),[[Ae,o.value]])],2)):Q("",!0)}}}),Le=N(nt,[["__scopeId","data-v-212ebc1a"]]),ot={name:"MenuLateralButton"},at=Object.assign(ot,{props:{icon:{type:[String,Object],default:""},id:String,active:Boolean,title:String,side:String,visibility:Boolean,secondary:Boolean},emits:["tabClicked"],setup(c,{expose:k,emit:r}){const l=W(),e=te(),d=c,a=d.icon,i=r,t=()=>{d.side=="left"&&C(),d.side=="right"&&L(),i("tabClicked",d.id)},o=ve();function _(O){let S=[...O.element.children].filter(b=>{if(b.className.includes("GPshowOpen"))return b});S[0].getAttribute("aria-pressed")==="true"&&S[0].click()}function L(O){l.getMap().getControls().getArray().forEach(S=>{o.right.includes(S.CLASSNAME)&&_(S)})}function C(){l.getMap().getControls().getArray().forEach(O=>{o.left.includes(O.CLASSNAME)&&_(O)})}function $(){console.log("click on button"+d.id),g.value.children[0].click()}const g=M(null),u=M(d.id);return k({clickButton:$,button:g,id:u}),z(()=>{d.id=="MenuCatalogue"&&e.setmenuCatalogueButton(g.value)}),(O,S)=>{const b=K;return y(),B("div",{ref_key:"button",ref:g},[p(b,{id:v(u),secondary:c.secondary,"aria-label":c.title,class:q(`${c.active?"active":""}  navBarIcon ${c.visibility?"":"invisibleNavButton"} navButton`),icon:v(a),"icon-only":!0,onClick:t},null,8,["id","secondary","aria-label","class","icon"])],512)}}}),Oe=N(at,[["__scopeId","data-v-144e6626"]]),st={class:"container"},lt={class:"compact-toggle"},rt={name:"MenuTierce"},it=Object.assign(rt,{emits:["openControl","onModalShareOpen","onModalPrintOpen","onBookMarksOpen"],setup(c,{emit:k}){const r=T("emitter"),l=te(),e=W(),d=k,a=M(l.getIsHeaderCompact());function i(){e.addControl("Reporting"),setTimeout(()=>{r.dispatchEvent("reporting:open:clicked",{open:!0,componentName:"Reporting"}),d("openControl")},0)}function t(g){e.getMap().getControls().getArray().forEach(u=>{u.CLASSNAME===g&&([...u.element.children].filter(S=>{if(S.className.includes("GPshowOpen"))return S})[0].click(),d("openControl"))})}function o(){a.value=!a.value,l.setIsHeaderCompact(a.value)}var _=T("services"),L=E(()=>_.authenticated);const C=M({authenticatedProperty:!L.value}),$=M(null);return z(()=>{l.setBookmarksButton($.value)}),(g,u)=>{const O=K,S=ke;return y(),B("div",st,[s("div",{ref_key:"BookmarksButton",ref:$},[p(O,{tertiary:"","no-outline":"",class:q(v(C)),icon:"ri-bookmark-line",onClick:u[0]||(u[0]=b=>g.$emit("onBookMarksOpen"))},{default:w(()=>[...u[8]||(u[8]=[P(" Mes enregistrements ",-1)])]),_:1},8,["class"])],512),u[14]||(u[14]=s("hr",null,null,-1)),p(O,{tertiary:"","no-outline":"",icon:"ri:file-upload-line",onClick:u[1]||(u[1]=b=>t("LayerImport"))},{default:w(()=>[...u[9]||(u[9]=[P(" Importer des données ",-1)])]),_:1}),p(O,{tertiary:"","no-outline":"",icon:"ri:share-2-fill",onClick:u[2]||(u[2]=b=>g.$emit("onModalShareOpen"))},{default:w(()=>[...u[10]||(u[10]=[P(" Partager, intégrer la carte ",-1)])]),_:1}),p(O,{tertiary:"","no-outline":"",icon:"fr-icon-printer-line",class:"tierce-print",onClick:u[3]||(u[3]=b=>g.$emit("onModalPrintOpen"))},{default:w(()=>[...u[11]||(u[11]=[P(" Imprimer ",-1)])]),_:1}),p(O,{tertiary:"","no-outline":"",icon:"fr-icon-feedback-line",onClick:u[4]||(u[4]=b=>i())},{default:w(()=>[...u[12]||(u[12]=[P(" Signaler une anomalie ",-1)])]),_:1}),u[15]||(u[15]=s("hr",null,null,-1)),p(O,{tertiary:"","no-outline":"",icon:"ri:layout-top-line",onClick:o},{default:w(()=>[s("div",lt,[u[13]||(u[13]=P(" Affichage compact ",-1)),p(S,{modelValue:v(a),"onUpdate:modelValue":u[5]||(u[5]=b=>H(a)?a.value=b:null),"no-text":"","label-left":"",onClick:[u[6]||(u[6]=Te(()=>{},["stop"])),u[7]||(u[7]=b=>v(l).setIsHeaderCompact(!v(a)))]},null,8,["modelValue"])])]),_:1})])}}}),ct=N(it,[["__scopeId","data-v-22347587"]]),dt={class:"fr-container"},ut={class:"bookmark-buttons-container"},mt={name:"MenuBookMarkNoData"},pt=Object.assign(mt,{setup(c){const k=W(),r=T("services"),l=T("emitter"),e=async a=>{try{const o=await r.setDocument(a);var i=o.uuid,t=o.action;return l.dispatchEvent("document:saved",{uuid:i,action:t}),o}catch(o){throw console.error(o),o}},d=[{label:"Enregistrer une carte",icon:"fr-icon-save-line",iconOnly:!1,iconRight:!1,secondary:!0,class:"bookmark-button-container",onclick:()=>{const a="Ma carte";var i=k.permalink;const t={name:a,description:"permalien",format:"json",target:"internal",type:"carte",content:JSON.stringify({name:a,date:new Date().toISOString(),permalink:i})};e(t).then(()=>{j.success({title:V.bookmark.title,message:V.bookmark.success_save_map})}).catch(o=>{console.error(o),j.error({title:V.bookmark.title,message:V.bookmark.failed_save_map})})}},{label:"Annoter la carte",icon:"fr-icon-pencil-line",iconOnly:!1,iconRight:!1,tertiary:!0,class:"bookmark-button-container",onclick:async()=>{k.getControls().includes("Drawing")||(k.addControl("Drawing"),await ae()),l.dispatchEvent("drawing:open:clicked",{open:!0,componentName:"Drawing"})}},{label:"Importer une donnée",icon:"fr-icon-upload-line",iconOnly:!1,iconRight:!1,tertiary:!0,class:"bookmark-button-container",onclick:()=>{l.dispatchEvent("layerimport:open:clicked",{open:!0,componentName:"LayerImport"}),l.dispatchEvent("leftmenu:close",{open:!1,componentName:"LeftMenu"})}}];return(a,i)=>{const t=_e;return y(),B("div",dt,[i[0]||(i[0]=s("div",{class:"bookmark-content-container"},[s("h4",null," Aucun enregistrement pour le moment "),s("div",null," Enregsitrer vos cartes et données créées sur votre espace afin de les retrouver et de les utiliser à tout moment. "),s("div",{id:"location-france"})],-1)),s("div",ut,[p(t,{buttons:d})])])}}}),ft=N(pt,[["__scopeId","data-v-86d86b3b"]]),vt={class:"container-bookmark-entry"},kt={class:"container-bookmark-entry-advanced-options"},_t={class:"container-bookmark-entry-advanced-infos fr-hint-text"},gt={key:0},bt={key:1},yt={key:2},ht={ref:"div-rename",class:"container-bookmark-entry-rename fr-hidden"},Ct={class:"container-bookmark-entry-buttons-rename"},Mt={name:"MenuBookMarkEntry"},pe=Object.assign(Mt,{props:{type:{type:String,default:""},data:{type:Object,default:()=>({})}},setup(c){const k=W(),r=ge.useLogger(),{copy:l}=be({}),e=c,d=T("services"),a=T("emitter"),i=m=>{d.getDocumentById(m.id).then(h=>{var n=null;switch(m.type){case"drawing":n=d.getDrawing;break;case"import":n=d.getImport;break;case"compute":n=d.getCompute;break;case"service":n=d.getService;break;case"carte":n=d.getCartes;break}if(!n)throw new Error(V.bookmark.failed_type_unknow(m.type));var f=!1;n.call(d,m.id).then(x=>{if(m.type==="carte"){Se(x),j.success({title:V.bookmark.title,message:V.bookmark.success_add_data("permalien")});return}if(m.type==="service"&&(f=!0),m.type==="drawing"&&(f=!0),m.type==="import"&&(f=!0),m.type==="compute"&&(f=!0),f){var D=we(h,{opacity:1,visible:!0,grayscale:!1});k.addBookmark(D)}}).then(()=>{k.isPermalink()||j.success({title:V.bookmark.title,message:V.bookmark.success_add_data(h.extra.format)})}).catch(x=>{throw x})}).catch(h=>{console.error(h),j.error({title:V.bookmark.title,message:V.bookmark.failed_add_data(h.message)})})};ie(()=>{}),z(()=>{});const t=ce("div-rename"),o=M(""),_=m=>{console.debug(m),t.value.classList.toggle("fr-hidden"),o.value=e.data.name},L=m=>{console.debug(m);var h={uuid:e.data.id,type:e.data.type};d.deleteDocument(h).then(n=>{a.dispatchEvent("document:deleted",{uuid:n.uuid,action:n.action})}).then(()=>{})},C=m=>{console.debug(m);var h={uuid:e.data.id,type:e.data.type};d.exportDocument(h).then(n=>(a.dispatchEvent("document:exported",{uuid:n.uuid,action:n.action}),n)).then(n=>{var f=n.extra.mimeType,x=n.extra.content,D=n.extra.name,F=n.extra.ext,R=D.includes(F)?D:D+"."+F,U=document.createElement("a"),A="utf-8";if(U.setAttribute("href","data:"+f+";charset="+A+","+encodeURIComponent(x)),U.setAttribute("download",R),document.createEvent){var me=document.createEvent("MouseEvents");me.initEvent("click",!0,!0),U.dispatchEvent(me)}else U.click()})},$=m=>{console.debug(m);var h={uuid:e.data.id,type:e.data.type};d.getCartes(h.uuid).then(n=>{l(n)}).then(()=>{j.success({title:V.bookmark.title,message:V.bookmark.success_copy_permalink})}).catch(n=>{console.error(n),j.error({title:V.bookmark.title,message:V.bookmark.failed_add_data(n.message)})})},g=m=>{r.debug(m);var h={uuid:e.data.id,type:e.data.type,name:o.value};o.value!==e.data.name&&d.renameDocument(h).then(n=>{a.dispatchEvent("document:updated",{uuid:n.uuid,action:n.action})}).then(()=>{t.value.classList.toggle("fr-hidden")}).then(()=>{})},u=m=>{r.debug(m),t.value.classList.toggle("fr-hidden")},O=[{label:"Renommer",icon:"fr-icon-edit-line","data-id":e.data.id,"data-type":e.data.type,"data-name":e.data.name,disabled:!1,iconOnly:!0,iconRight:!1,secondary:!0,noOutline:!0,style:"margin: unset;box-shadow: unset;",class:"bookmark-button-container-advanced",onclick:_},{label:"Supprimer",icon:"fr-icon-delete-line","data-id":e.data.id,"data-type":e.data.type,"data-name":e.data.name,disabled:!1,iconOnly:!0,iconRight:!1,secondary:!0,noOutline:!0,style:"margin: unset;box-shadow: unset;",class:"bookmark-button-container-advanced",onclick:L}],S=[...O,{label:"Copier",icon:"fr-icon-link","data-id":e.data.id,"data-type":e.data.type,"data-name":e.data.name,disabled:!1,iconOnly:!0,iconRight:!1,secondary:!0,noOutline:!0,style:"margin: unset;box-shadow: unset;",class:"bookmark-button-container-advanced",onclick:$}],b=[...O,{label:"Exporter",icon:"fr-icon-download-line","data-id":e.data.id,"data-type":e.data.type,"data-name":e.data.name,disabled:!1,iconOnly:!0,iconRight:!1,secondary:!0,noOutline:!0,style:"margin: unset;box-shadow: unset;",class:"bookmark-button-container-advanced",onclick:C}];return(m,h)=>{const n=K,f=_e,x=de;return y(),B(J,null,[s("div",vt,[p(n,{"data-id":c.data.id,"data-type":c.data.type,title:c.data.name,class:"button-bookmark-entry",tertiary:"","no-outline":"",icon:c.data.icon,onClick:h[0]||(h[0]=D=>i(c.data))},{default:w(()=>[P(G(c.data.name),1)]),_:1},8,["data-id","data-type","title","icon"]),s("div",kt,[c.data.type==="carte"?(y(),I(f,{key:0,buttons:S,"inline-layout-when":"",size:"sm"})):(y(),I(f,{key:1,buttons:b,"inline-layout-when":"",size:"sm"}))])]),s("div",_t,[c.data.type_fr?(y(),B("span",gt,G(c.data.type_fr),1)):Q("",!0),c.data.format?(y(),B("span",bt,G(c.data.format),1)):Q("",!0),c.data.date?(y(),B("span",yt,G(c.data.date),1)):Q("",!0)]),s("div",ht,[p(x,{modelValue:o.value,"onUpdate:modelValue":h[1]||(h[1]=D=>o.value=D),label:"Renommer",placeholder:""},null,8,["modelValue"]),s("div",Ct,[p(n,{size:"sm",icon:"ri:close-line",tertiary:"","no-outline":"",class:"fr-p-1w",onClick:u}),p(n,{size:"sm",icon:"ri:check-line",tertiary:"","no-outline":"",class:"fr-p-1w",onClick:g})])],512),oe(m.$slots,"default")],64)}}}),$t={class:"fr-container fr-p-1w"},Lt={key:0},Ot={class:"search-bookmark fr-p-1w"},St={class:"tabs-bookmark fr-p-1w"},wt={ref:"div-map-name",class:"container-bookmark-map-name fr-hidden"},Bt={class:"container-bookmark-map-buttons-name"},xt={class:"container-bookmark-map-item fr-p-1w"},Dt={class:"container-bookmark-data-item fr-p-1w"},Et={name:"MenuBookMarkDataList"},Vt=Object.assign(Et,{props:{title:String},setup(c){const k=W(),r=T("services"),l=T("emitter"),e=M("");function d(n){e.value=n}const a="Liste des données",i=[{title:"Cartes",tabId:"tab-bookmark-maps",panelId:"tab-content-bookmark-maps"},{title:"Données",tabId:"tab-bookmark-data",panelId:"tab-content-bookmark-data"}],t=M(0),o=n=>{var f="";return r.labels.includes(n)?(n==="drawing"&&(f="ri:pencil-line"),n==="import"&&(f="ri:file-upload-line"),n==="service"&&(f="ri:cloud-line"),n==="compute"&&(f="ri:settings-5-line")):f="ri:pencil-line",f},_=M(null),L=E(()=>{_.value&&console.log("update data !");var n=[];for(const R in r.documents)if(Object.prototype.hasOwnProperty.call(r.documents,R)){if(R==="carte")continue;var f=r.documents[R];if(!f)continue;for(let U=0;U<f.length;U++){var x=f[U],D=[".geojson",".gpx",".kml",".json"],F=D.find(A=>x.name.includes(A));n.push({id:x._id,name:F?x.name.replace(F,"").slice(0,-1):x.name,type:R,type_fr:"",icon:o(R)})}}return n.filter(R=>!e.value||R.name.includes(e.value))}),C=E(()=>{_.value&&console.log("update map !");var n=[];if(r.documents.carte)for(let f=0;f<r.documents.carte.length;f++){const x=r.documents.carte[f];n.push({id:x._id,name:x.name,type:"carte",type_fr:"",icon:"ri-map-2-line"})}return n.filter(f=>!e.value||f.name.includes(e.value))}),$=n=>{console.log(n);var f=Date.now();_.value=Object.assign(n,{timestamp:f})};l.addEventListener("document:saved",$),l.addEventListener("document:updated",$),l.addEventListener("document:deleted",$),l.addEventListener("document:exported",$);const g=()=>{O.value.classList.toggle("fr-hidden")},u=()=>{l.dispatchEvent("layerimport:open:clicked",{open:!0,componentName:"LayerImport"}),l.dispatchEvent("leftmenu:close",{open:!1,componentName:"LeftMenu"})},O=ce("div-map-name"),S=M(""),b=n=>{O.value.classList.toggle("fr-hidden");var f=k.permalink;const x={name:S.value,description:"permalien",format:"json",target:"internal",type:"carte",content:JSON.stringify({name:S.value,date:new Date().toISOString(),permalink:f})};h(x).then(()=>{}).then(()=>{S.value=""}).then(()=>{j.success({title:V.bookmark.title,message:V.bookmark.success_save_map})}).catch(D=>{console.error(D),j.error({title:V.bookmark.title,message:V.bookmark.failed_save_map})})},m=n=>{O.value.classList.toggle("fr-hidden")},h=async n=>{try{const D=await r.setDocument(n);var f=D.uuid,x=D.action;return l.dispatchEvent("document:saved",{uuid:f,action:x}),D}catch(D){throw console.error(D),D}};return ie(()=>{}),z(()=>{}),(n,f)=>{const x=ye,D=K,F=de,R=Ne,U=Pe;return y(),B("div",$t,[c.title?(y(),B("h4",Lt,G(c.title),1)):Q("",!0),s("div",Ot,[p(x,{modelValue:v(e),"onUpdate:modelValue":[f[0]||(f[0]=A=>H(e)?e.value=A:null),d],label:"Rechercher un enregistrement"},null,8,["modelValue"])]),s("div",St,[p(U,{id:"tabs-bookmark",modelValue:v(t),"onUpdate:modelValue":f[4]||(f[4]=A=>H(t)?t.value=A:null),"tab-list-name":a,"tab-titles":i},{default:w(()=>[p(R,{"panel-id":"tab-content-bookmark-maps","tab-id":"tab-bookmark-maps"},{default:w(()=>[p(D,{label:"Enregistrer la carte",tertiary:"",size:"sm",class:"button-action",icon:"fr-icon-save-line",onClick:f[1]||(f[1]=A=>g())}),s("div",wt,[p(F,{modelValue:v(S),"onUpdate:modelValue":f[2]||(f[2]=A=>H(S)?S.value=A:null),label:"Nommer",placeholder:""},null,8,["modelValue"]),s("div",Bt,[p(D,{size:"sm",icon:"ri:close-line",tertiary:"","no-outline":"",class:"fr-p-1w",onClick:m}),p(D,{size:"sm",icon:"ri:check-line",tertiary:"","no-outline":"",class:"fr-p-1w",onClick:b})])],512),(y(!0),B(J,null,X(v(C),A=>(y(),B("div",xt,[p(pe,{data:A,type:"map"},null,8,["data"])]))),256))]),_:1}),p(R,{"panel-id":"tab-content-bookmark-data","tab-id":"tab-bookmark-data"},{default:w(()=>[p(D,{label:"Ajouter une donnée",tertiary:"",size:"sm",class:"button-action",icon:"fr-icon-upload-line",onClick:f[3]||(f[3]=A=>u())}),(y(!0),B(J,null,X(v(L),A=>(y(),B("div",Dt,[p(pe,{data:A,type:"data"},null,8,["data"])]))),256))]),_:1})]),_:1},8,["modelValue"])])])}}}),It=N(Vt,[["__scopeId","data-v-dab14785"]]),At={key:0},Tt={key:1},Nt={name:"MenuBookMarkLoggued"},Pt=Object.assign(Nt,{setup(c){var k=T("services");const r=T("emitter"),l=()=>{var a=!0;for(const i in k.documents)if(Object.prototype.hasOwnProperty.call(k.documents,i)){const t=k.documents[i];t&&t.length&&(a=!1)}return a};var e=M(!1),d=E(()=>{var a=l();return e.value?l():a});return r.addEventListener("service:documents:loaded",a=>{e.value=!e.value}),r.addEventListener("document:saved",a=>{e.value=!e.value}),r.addEventListener("document:deleted",a=>{e.value=!e.value}),r.addEventListener("document:updated",a=>{e.value=!e.value}),z(()=>{}),(a,i)=>v(d)?(y(),B("div",At,[p(ft)])):(y(),B("div",Tt,[p(It,{title:"Mes enregistrements"})]))}}),Rt={class:"container"},jt={name:"MenuBookMarks"},zt=Object.assign(jt,{setup(c){var k=T("services"),r=E(()=>k.authenticated);return(l,e)=>(y(),B("div",Rt,[v(r)?(y(),I(Pt,{key:0})):Q("",!0)]))}}),Ut=N(zt,[["__scopeId","data-v-274c5bc4"]]),Wt={name:"LeftMenuTool"},Gt=Object.assign(Wt,{props:{},emits:["onModalShareOpen","onModalPrintOpen","onModalLoginOpen"],setup(c,{emit:k}){const r=te(),l="left",e=M(),d=M(null),a=E(()=>[{componentName:"MenuTierce",icon:"ri-menu-add-fill",title:"Accéder à d'autres outils",visibility:!0,secondary:!0},{componentName:"MenuBookMarks",icon:"ri-bookmark-line",title:"Mes Enregistrements",visibility:!1,secondary:!0}]),i=M("MenuCatalogueContent"),t=M(null),o=300;function _(m){L(m)&&e.value?t.value.closeMenu():(i.value=m+"Content",m==="MenuBookMarks"?t.value.widthMenu=400:t.value.widthMenu=o,t.value.openMenu())}function L(m){return i.value.replace("Content","")===m}T("emitter").addEventListener("leftmenu:close",m=>{t.value.closeMenu()});var $=T("services"),g=E(()=>$.authenticated);function u(){window.__ENV__.IAM_DISABLE!=="1"&&S.value.forEach(m=>{m.id==="MenuBookMarks"&&(g.value?m.clickButton():b("onModalLoginOpen"))})}function O(){t.value.closeMenu()}const S=ce("tabs"),b=k;return ne(()=>r.getleftControlMenu(),m=>{var h;d.value=m,(h=d.value)==null||h.addEventListener("click",function(n){!n.target.id.includes("OverviewMap")&&n.target.ariaPressed=="true"&&(e.value=!1)})},{immediate:!0}),(m,h)=>(y(),I(Le,{id:"MenuCatalogueContentClose",ref_key:"wrapper",ref:t,modelValue:v(e),"onUpdate:modelValue":h[2]||(h[2]=n=>H(e)?e.value=n:null),side:l,visibility:!0,width:o,padding:16},{content:w(()=>[s("div",{id:"MenuTierceContent",class:q([v(i)==="MenuTierceContent"?"activeTab":"inactiveTab"])},[p(ct,{onOnModalShareOpen:h[0]||(h[0]=n=>m.$emit("onModalShareOpen")),onOnModalPrintOpen:h[1]||(h[1]=n=>m.$emit("onModalPrintOpen")),onOnBookMarksOpen:u,onOpenControl:O})],2),s("div",{id:"MenuBookMarksContent",class:q([v(i)==="MenuBookMarksContent"?"activeTab":"inactiveTab"])},[p(Ut)],2)]),navButtons:w(()=>[(y(!0),B(J,null,X(v(a),n=>(y(),I(Oe,{id:n.componentName,key:n.componentName,ref_for:!0,ref:"tabs",side:l,icon:n.icon,visibility:n.visibility,active:L(n.componentName),title:n.title,secondary:n.secondary,onTabClicked:_},null,8,["id","icon","visibility","active","title","secondary"]))),128))]),_:1},8,["modelValue"]))}}),Ht=N(Gt,[["__scopeId","data-v-449ab415"]]),qt={class:"control-list-element"},Ft={class:"control-list-element-img"},Jt=["innerHTML"],Kt={class:"control-list-element-img"},Qt={name:"ControlListElement"},Xt=Object.assign(Qt,{props:re({controlListElementOptions:{type:Object,default:()=>({})},selectedControls:{type:Array,default:()=>[]}},{modelValue:{type:Array,default:()=>[]},modelModifiers:{}}),emits:["update:modelValue"],setup(c){const k=c,r=le(c,"modelValue"),l=M(),e=E(()=>typeof k.controlListElementOptions.icon=="string"&&k.controlListElementOptions.icon.startsWith("fr-icon-"));ne(l,a=>{a===!0&&!r.value.includes(k.controlListElementOptions.name)&&(r.value=[...r.value,k.controlListElementOptions.name]),a===!1&&(r.value=r.value.filter(i=>i!==k.controlListElementOptions.name))});const d=()=>{l.value=!l.value};return z(()=>{}),he(()=>{}),(a,i)=>{const t=Re,o=ke;return y(),B("tr",qt,[s("td",Ft,[p(t,{"on-hover":"",content:c.controlListElementOptions.tooltip,onClick:i[0]||(i[0]=_=>d())},{default:w(()=>[s("div",null,[c.controlListElementOptions.svg?(y(),B("span",{key:0,class:"custom-svg-icon",innerHTML:c.controlListElementOptions.svg},null,8,Jt)):v(e)?(y(),B("span",{key:2,class:q(c.controlListElementOptions.icon),"aria-hidden":"true"},null,2)):(y(),I(v(Ce),{key:1,scale:"1.25",name:c.controlListElementOptions.icon},null,8,["name"]))])]),_:1},8,["content"])]),s("td",Kt,[p(t,{"on-hover":"",content:c.controlListElementOptions.tooltip},{default:w(()=>[p(o,je({modelValue:v(l),"onUpdate:modelValue":i[1]||(i[1]=_=>H(l)?l.value=_:null),disabled:c.controlListElementOptions.disabled,"input-id":c.controlListElementOptions.id,label:c.controlListElementOptions.label,"label-left":"","model-value":r.value===!0||Array.isArray(r.value)&&r.value.includes(c.controlListElementOptions.name)},a.$attrs,{class:"control-list-element"}),null,16,["modelValue","disabled","input-id","label","model-value"])]),_:1},8,["content"])])])}}}),Yt=N(Xt,[["__scopeId","data-v-59b52858"]]),Zt={class:"control-container"},en={class:"control-search-bar"},tn={class:"control-content"},nn={name:"MenuControl"},on=Object.assign(nn,{props:re({selectedControls:{type:Array,default:()=>[]}},{modelValue:{type:Array,default:()=>[]},modelModifiers:{}}),emits:["update:modelValue"],setup(c){ge.useLogger();const k=W(),r=c,l=le(c,"modelValue"),e=ze(),d=E(()=>e.filter(t=>{if(t.label.toLowerCase().includes(a.value.toLowerCase())||t.hint.toLowerCase().includes(a.value.toLowerCase())||t.name.toLowerCase().includes(a.value.toLowerCase()))return t})),a=M("");function i(t){a.value=t}return ne(l,t=>{k.cleanControls();for(let o=0;o<t.length;o++){const _=t[o];k.addControl(_)}}),z(()=>{}),he(()=>{}),(t,o)=>{const _=ye;return y(),B("div",Zt,[o[1]||(o[1]=s("h4",null,"Gestion d'outils",-1)),s("div",en,[p(_,{"model-value":v(a),"onUpdate:modelValue":i},null,8,["model-value"])]),s("div",tn,[s("table",null,[(y(!0),B(J,null,X(v(d),(L,C)=>(y(),I(Yt,{key:C,modelValue:l.value,"onUpdate:modelValue":o[0]||(o[0]=$=>l.value=$),"model-value":r.selectedControls,"control-list-element-options":L},null,8,["modelValue","model-value","control-list-element-options"]))),128))])])])}}}),an=N(on,[["__scopeId","data-v-ec63f227"]]),sn={name:"RightMenuTool"},ln=Object.assign(sn,{props:{selectedControls:{type:Array,default:()=>[]},selectedLayers:{type:Object,default:()=>({})}},setup(c){const k=te(),r=c,l="right",e=M(),d=M(null),a=E(()=>[{componentName:"MenuControl",icon:"ri:tools-line",title:"Choisir mes outils",visibility:!0,secondary:!0}]),i=M("MenuControlContent"),t=M(null),o=500;function _(C){L(C)&&e.value?t.value.closeMenu():(i.value=C+"Content",C==="MenuBookMarks"?t.value.widthMenu=400:t.value.widthMenu=o,t.value.openMenu())}function L(C){return i.value.replace("Content","")===C}return ne(()=>k.getrightControlMenu(),C=>{var $;d.value=C,($=d.value)==null||$.addEventListener("click",function(g){g.target.ariaPressed=="true"&&(e.value=!1)})},{immediate:!0}),(C,$)=>(y(),I(Le,{id:v(i),ref_key:"wrapper",ref:t,modelValue:v(e),"onUpdate:modelValue":$[0]||($[0]=g=>H(e)?e.value=g:null),side:l,visibility:!0,width:500},{content:w(()=>[s("div",{id:"MenuControlContent",class:q([v(i)==="MenuControlContent"?"activeTab":"inactiveTab"])},[p(an,{"selected-controls":r.selectedControls},null,8,["selected-controls"])],2)]),navButtons:w(()=>[(y(!0),B(J,null,X(v(a),g=>(y(),I(Oe,{id:g.componentName,key:g.componentName,visibility:g.visibility,side:l,icon:g.icon,active:L(g.componentName),title:g.title,secondary:g.secondary,onClick:g.onClick,onTabClicked:_},null,8,["id","visibility","icon","active","title","secondary","onClick"]))),128))]),_:1},8,["id","modelValue"]))}}),rn=N(ln,[["__scopeId","data-v-47ac1c66"]]),cn={name:"ModalLogin"},dn=Object.assign(cn,{setup(c,{expose:k}){const r=Z(),l=Me(),e=W(),d="Se connecter à cartes.gouv.fr",a="fr-icon-account-fill",i=[{label:"Se connecter",onClick(){t.value=!1,l.push({path:"/login"})}},{label:"Annuler",tertiary:!0,onClick(){t.value=!1}}],t=M(!1),o=M({display:"none"}),_=M(!1);t.value&&r.pause();const L=g=>{o.value=g?{display:"block"}:{display:"none"},t.value=!0,r.pause()},C=()=>{t.value=!1,r.resume()},$=g=>{console.log(g),e.noLoginInformation=g};return k({openModalLogin:L,onModalLoginClose:C}),(g,u)=>{const O=We,S=ee;return y(),I(S,{opened:v(t),title:d,size:"md",icon:a,"is-alert":!0,actions:i,onClose:C},{default:w(()=>[u[0]||(u[0]=s("p",null," Pour enregistrer vos données, vous devez vous identifier ou créer un compte sur cartes.gouv.fr ",-1)),s("div",{style:Ue(v(o))},[p(O,{"model-value":v(_),label:"Ne plus afficher ce message","onUpdate:modelValue":$},null,8,["model-value"])],4)]),_:1},8,["opened"])}}}),un={class:"title-copy"},mn={class:"fr-hint-text hint-class"},pn={},fn=Object.assign(pn,{__name:"TextCopyToClipboard",props:{copiedText:String,label:String,description:String},setup(c){const k=Ge("SM"),r=c,{copy:l}=be({}),e="ri:file-copy-line",d="ic:outline-check",a="Copier",i="Copié",t=M(e),o=M(a),_=M(.8325),L=E(()=>typeof t.value=="string"?{scale:_.value,name:t.value}:{scale:_.value,...t.value});function C(){l(r.copiedText),t.value=d,o.value=i,setTimeout(()=>{t.value=e,o.value=a},5e3)}return z(()=>{}),($,g)=>{const u=K;return y(),B("div",null,[s("div",un,[s("div",null,G(c.label),1),p(u,{secondary:"","icon-right":"","icon-only":v(k),icon:v(L),onClick:g[0]||(g[0]=O=>C())},{default:w(()=>[P(G(v(o)),1)]),_:1},8,["icon-only","icon"])]),s("p",mn,G(c.description),1)])}}}),fe=N(fn,[["__scopeId","data-v-9b210566"]]),vn={},kn=Object.assign(vn,{__name:"ShareModal",setup(c,{expose:k}){const r=Z(),l=se(),e=W(),d="Partager une carte",a="lg",i=M(!1),t=()=>{i.value=!0,r.pause()},o=()=>{i.value=!1,r.resume()},_=l.getContacts(),L=E(()=>encodeURI(e.permalink).replaceAll("&","%26")),C=E(()=>({address:_.mail,subject:"Cartes à consulter sur cartes.gouv.fr",body:`Bonjour,%0AJe vous invite à consulter cette carte sur Cartes.gouv.fr :%0A${L.value}`})),$=E(()=>({to:`mailto:${C.value.address}?subject=${C.value.subject}&body=${C.value.body}`,label:"Envoyer un mail"})),g=E(()=>[{name:"facebook",label:"Partager sur Facebook",url:_.networks.facebook+"?display=popup&u="+e.permalink},{name:"linkedin",label:"Partager sur LinkedIn",url:_.networks.linkedin+"?url="+e.permalink+"&title=Ma%20carte%20IGN"},{name:"instagram",label:"Partager sur Instagram",url:_.networks.instagram}]),u=E(()=>`<iframe
    width="600" height="400" frameborder="0" scrolling="no" marginheight="0" marginwidth="0"
    sandbox="allow-forms allow-scripts allow-same-origin"
    src="${e.permalinkShare}"
    allowfullscreen>
  </iframe>`);return z(()=>{ae(function(){})}),ie(()=>{ae(function(){})}),k({onModalShareOpen:t,onModalShareClose:o}),(O,S)=>{const b=He,m=de,h=ee;return y(),I(h,{opened:v(i),title:d,size:a,onClose:o},{default:w(()=>[s("div",null,[s("p",null,[p(b,{mail:v($),networks:v(g),title:"Partages"},null,8,["mail","networks"])])]),s("div",null,[s("p",null,[p(m,{modelValue:v(e).permalink,"onUpdate:modelValue":S[0]||(S[0]=n=>v(e).permalink=n),label:"Lien permanent vers la carte",placeholder:"","label-visible":"",readonly:"","description-id":""},{label:w(()=>[p(fe,{"copied-text":v(e).permalink,label:"Lien permanent",description:"Toute personne ayant ce lien peut visualiser votre carte sans avoir à se créer de compte."},null,8,["copied-text"])]),_:1},8,["modelValue"])]),s("p",null,[p(m,{modelValue:v(u),"onUpdate:modelValue":S[1]||(S[1]=n=>H(u)?u.value=n:null),placeholder:"","is-textarea":"","label-visible":"",readonly:"","description-id":"",style:{height:"200px"}},{label:w(()=>[p(fe,{"copied-text":v(u),label:"Iframe",description:"Insérer directement dans vos mails,  Réseaux sociaux ..."},null,8,["copied-text"])]),_:1},8,["modelValue"])])])]),_:1},8,["opened"])}}}),_n=N(kn,[["__scopeId","data-v-e242b429"]]),gn={name:"ModalSave"},bn=Object.assign(gn,{setup(c,{expose:k}){const r=Z();Me();var l=null;const e="Sauvegarde sur l'espace personnel",d="fr-icon-save-fill",a=[{label:"Sauvegarder",onClick(){i.value=!1,l()}},{label:"Annuler",tertiary:!0,onClick(){i.value=!1,l=null}}],i=M(!1);i.value&&r.pause();const t=()=>{i.value=!0,r.pause()},o=()=>{i.value=!1,r.resume()};return k({openModalSave:t,onModalSaveClose:o,onDelegateCbk:L=>{l=L}}),(L,C)=>{const $=ee;return y(),I($,{opened:v(i),title:e,size:"md",icon:d,"is-alert":!0,actions:a,onClose:o},{default:w(()=>[...C[0]||(C[0]=[s("p",null," Voulez-vous enregistrer sur votre espace personnel la donnée importée ? ",-1)])]),_:1},8,["opened"])}}}),yn={class:"fr-container"},hn={class:"fr-grid-row logo-row"},Cn={class:"fr-grid-row content"},Mn={class:"icon vicon purple-glycine"},$n={class:"fr-grid-row flex-end"},Ln=["href"],On="lg",Sn="République Française",wn=ue({__name:"ModalWelcome",setup(c,{expose:k}){const r=Z(),l=M(!1),e=()=>{l.value=!0,r.pause()},d=()=>{l.value=!1,r.resume()};k({openModalWelcome:e,onWelcomeModalClose:d});const a=M({scale:1.25,name:"ri:map-2-line"});return z(()=>{}),(i,t)=>{const o=qe,_=Ce,L=K,C=ee;return y(),I(C,{ref:"modal",title:"",opened:v(l),size:On,class:"welcome-modal",onClose:d},{default:w(()=>[s("div",yn,[s("div",hn,[p(o,{"logo-text":Sn,"data-testid":"header-logo",class:"maxwidth"}),t[0]||(t[0]=s("img",{src:"https://data.geopf.fr/annexes/ressources/header/cartes-gouv-logo.svg",alt:""},null,-1))]),s("div",Cn,[t[2]||(t[2]=s("h2",null,"Bienvenue sur cartes.gouv.fr",-1)),t[3]||(t[3]=s("p",null,"Retrouvez ici la référence de la cartographie publique pour explorer, connaître et piloter le territoire :",-1)),s("div",null,[s("span",Mn,[p(_,Fe(Je(v(a))),null,16)]),t[1]||(t[1]=P("Accédez à une vaste bibliothèque de cartes et de données",-1))]),t[4]||(t[4]=s("div",null,[s("span",{class:"icon yellow-tournesol"},[s("i",{class:"fr-icon-brush-line"})]),P("Créez et partagez vos propres cartes")],-1)),t[5]||(t[5]=s("div",null,[s("span",{class:"icon green-archipel"},[s("i",{class:"fr-icon-database-line"})]),P("Hébergez vos données et vos cartes en toute autonomie")],-1))])]),s("div",$n,[p(L,{secondary:""},{default:w(()=>[s("a",{href:v($e)()+"/decouvrir"},"En savoir plus",8,Ln)]),_:1}),p(L,{primary:"",icon:"fr-icon-arrow-right-s-line","icon-right":"",onClick:d},{default:w(()=>[...t[6]||(t[6]=[P(" Accéder aux cartes ",-1)])]),_:1})])]),_:1},8,["opened"])}}}),Bn=N(wn,[["__scopeId","data-v-d1157469"]]),xn={id:"map-and-tools-container"},Dn={class:"modal-container"},En=ue({__name:"CartoAndTools",setup(c){const k=W(),r=se(),l=Ke(),e=M(null),d=M(null),a=M(null),i=M(null);Y("refModalShare",d),Y("refModalLogin",e),Y("refModalSave",a),Y("refModalWelcome",i);const t=()=>{d.value.onModalShareOpen()},o=T("emitter"),_=()=>{o.dispatchEvent("printmodal:open")},L=()=>{e.value.openModalLogin(!1)},C=b=>{k.removeLayer(b),j.warning({title:"Exception",message:"La couche "+b+" n'existe pas !"})},$=b=>{k.removeBookmark(b),j.warning({title:"Exception",message:"Le bookmark "+b+" n'existe pas !"})},g=E(()=>{var b=[],m=k.getLayers();for(let x=0;x<m.length;x++){var h=m[x],n=r.getLayerByID(h);if(!n){C(h);continue}var f=k.getLayerProperty(h);n.position=f.position,n.opacity=f.opacity,n.visible=f.visible,n.grayscale=f.grayscale,f.style&&(n.style=f.style),b.push(n)}return b}),u=E(()=>{var b=[],m=k.getBookmarks();for(let f=0;f<m.length;f++){var h=m[f],n=xe(decodeURIComponent(h));if(!n){$(h);continue}n.stop||(n.key=n.id,b.push(n))}return b}),O=E(()=>k.getControls()),S=M(null);return z(()=>{l.siteOpened&&i.value&&i.value.openModalWelcome()}),Y("selectedLayers",g),(b,m)=>(y(),B("div",xn,[p(Ht,{onOnModalShareOpen:t,onOnModalPrintOpen:_,onOnModalLoginOpen:L}),p(Be,{ref_key:"cartoRef",ref:S,"selected-layers":v(g),"selected-controls":v(O),"selected-bookmarks":v(u)},null,8,["selected-layers","selected-controls","selected-bookmarks"]),p(rn,{"selected-layers":v(g),"selected-controls":v(O)},null,8,["selected-layers","selected-controls"]),s("div",Dn,[p(_n,{ref_key:"refModalShare",ref:d},null,512),p(dn,{ref_key:"refModalLogin",ref:e},null,512),p(bn,{ref_key:"refModalSave",ref:a},null,512),p(Bn,{ref_key:"refModalWelcome",ref:i},null,512)])]))}}),Vn=N(En,[["__scopeId","data-v-c4978aed"]]),In=["innerHTML"],An={},Tn=Object.assign(An,{__name:"ModalInformation",setup(c){const k=Z(),r=se(),l="Messages d'informations",e=E(()=>{var o=r.getAlerts();for(let _=0;_<o.length;_++){const L=o[_];L.closed=!1}return o}),d=o=>{var _=o.link.url;_.startsWith("/")&&(_=$e()+o.link.url);var L=`${o.description} - ${o.details} <a href="${_}" title="ouvre une nouvelle fenêtre" target="_blank" class="fr-notice__link">${o.link.label}</a>`;return`${L}`},a=M(e.value.length!==0);a.value&&k.pause();const i=()=>{a.value=!1,k.resume()},t=o=>{e.value.forEach(_=>{_.id===o&&(_.closed=!0)})};return(o,_)=>{const L=Qe,C=ee;return y(),I(C,{opened:v(a),title:l,size:"md",onClose:i},{default:w(()=>[(y(!0),B(J,null,X(v(e),$=>(y(),I(L,{key:`alert-${$.id}`,type:$.severity,title:$.title,closed:$.closed,closeable:!0,onClose:g=>t($.id)},{default:w(()=>[s("div",{innerHTML:d($)},null,8,In)]),_:2},1032,["type","title","closed","onClose"]))),128))]),_:1},8,["opened"])}}}),Nn={class:"fr-container fr-container--fluid fr-container-md"},Pn={class:"patience-container"},zn=ue({__name:"Load",setup(c){return(k,r)=>(y(),I(Xe,null,{fallback:w(()=>[s("div",Pn,[p(Ee)])]),default:w(()=>[p(De,null,{default:w(()=>[s("div",Nn,[p(Tn)]),p(Vn)]),_:1})]),_:1}))}});export{zn as default};
//# sourceMappingURL=Load-BazBBE_n.js.map
