{"version":3,"file":"Login-Dd2lO8zA.js","sources":["../../src/views/Login.vue"],"sourcesContent":["<script lang=\"js\">\n/**\n * @description\n * Redirection sur l'IAM de la geoplateforme\n */\nexport default {};\n</script>\n\n<script setup lang=\"js\">\nimport { inject } from 'vue';\nimport { useRouter } from 'vue-router';\n\nconst router = useRouter();\nconst service = inject('services');\n\nonMounted(() => {\n  const queryString = location.search;\n  const urlParams = new URLSearchParams(queryString);\n\n  // parametres\n  var code = urlParams.get('code');\n  var session = urlParams.get('session_state');\n  var state = urlParams.get('state');\n  var success = urlParams.get('success'); // remote\n  var auth = urlParams.get('authentication_failed'); // remote\n\n  // Si aucun parametre de session dans l'URL de la route '/login',\n  // on redirige vers IAM authentification\n  if (!queryString) {\n    // Lien vers IAM pour se connecter\n    // on sort de l'application !\n    service.getAccessLogin().then((url) => {\n      location.href = url;\n    });\n    return;\n  }\n  // IAM authentification redirige vers la route '/login' apr√©s validation\n  // Et, elle fournit \n  // * le 'code' et la 'session' dans l'url pour le mode 'local'\n  // * 'authentication_failed' ou 'success' pour le mode 'remote'\n  // Puis, on revient dans l'application !\n  var value = 0;\n  if (service.mode === \"local\" && code && session && state) {\n    value = 1;\n  } else if (service.mode === \"remote\" && auth !== null) {\n    value = parseInt(auth, 10);\n  } else if (service.mode === \"remote\" && success !== null) {\n    value = parseInt(success, 10);\n  } else {\n    value = 0;\n  }\n  router.push({ path : '/',  query: { from : 'login', success : value } });\n});\n\n</script>\n\n<template>\n  <slot />\n</template>\n"],"names":["__default__","router","useRouter","service","inject","onMounted","queryString","urlParams","code","session","state","success","auth","url","value","_renderSlot","_ctx"],"mappings":"6DAKA,MAAAA,EAAe,CAAA,6CAOf,MAAMC,EAASC,EAAS,EAClBC,EAAUC,EAAO,UAAU,EAEjC,OAAAC,EAAU,IAAM,CACd,MAAMC,EAAc,SAAS,OACvBC,EAAY,IAAI,gBAAgBD,CAAW,EAGjD,IAAIE,EAAOD,EAAU,IAAI,MAAM,EAC3BE,EAAUF,EAAU,IAAI,eAAe,EACvCG,EAAQH,EAAU,IAAI,OAAO,EAC7BI,EAAUJ,EAAU,IAAI,SAAS,EACjCK,EAAOL,EAAU,IAAI,uBAAuB,EAIhD,GAAI,CAACD,EAAa,CAGhBH,EAAQ,eAAc,EAAG,KAAMU,GAAQ,CACrC,SAAS,KAAOA,CAClB,CAAC,EACD,MACF,CAMA,IAAIC,EAAQ,EACRX,EAAQ,OAAS,SAAWK,GAAQC,GAAWC,EACjDI,EAAQ,EACCX,EAAQ,OAAS,UAAYS,IAAS,KAC/CE,EAAQ,SAASF,EAAM,EAAE,EAChBT,EAAQ,OAAS,UAAYQ,IAAY,KAClDG,EAAQ,SAASH,EAAS,EAAE,EAE5BG,EAAQ,EAEVb,EAAO,KAAK,CAAE,KAAO,IAAM,MAAO,CAAE,KAAO,QAAS,QAAUa,CAAK,CAAE,CAAE,CACzE,CAAC,SAKCC,EAAQC,EAAA,OAAA,SAAA"}